function FI(e,t){for(var a=0;a<t.length;a++){const u=t[a];if(typeof u!="string"&&!Array.isArray(u)){for(const f in u)if(f!=="default"&&!(f in e)){const v=Object.getOwnPropertyDescriptor(u,f);v&&Object.defineProperty(e,f,v.get?v:{enumerable:!0,get:()=>u[f]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))u(f);new MutationObserver(f=>{for(const v of f)if(v.type==="childList")for(const x of v.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&u(x)}).observe(document,{childList:!0,subtree:!0});function a(f){const v={};return f.integrity&&(v.integrity=f.integrity),f.referrerPolicy&&(v.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?v.credentials="include":f.crossOrigin==="anonymous"?v.credentials="omit":v.credentials="same-origin",v}function u(f){if(f.ep)return;f.ep=!0;const v=a(f);fetch(f.href,v)}})();var BI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function v0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Va(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var a=function u(){return this instanceof u?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};a.prototype=t.prototype}else a={};return Object.defineProperty(a,"__esModule",{value:!0}),Object.keys(e).forEach(function(u){var f=Object.getOwnPropertyDescriptor(e,u);Object.defineProperty(a,u,f.get?f:{enumerable:!0,get:function(){return e[u]}})}),a}var Hw={exports:{}},cm={},Ww={exports:{}},Ft={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Md=Symbol.for("react.element"),OI=Symbol.for("react.portal"),NI=Symbol.for("react.fragment"),$I=Symbol.for("react.strict_mode"),UI=Symbol.for("react.profiler"),jI=Symbol.for("react.provider"),VI=Symbol.for("react.context"),qI=Symbol.for("react.forward_ref"),ZI=Symbol.for("react.suspense"),GI=Symbol.for("react.memo"),HI=Symbol.for("react.lazy"),Ex=Symbol.iterator;function WI(e){return e===null||typeof e!="object"?null:(e=Ex&&e[Ex]||e["@@iterator"],typeof e=="function"?e:null)}var Kw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Xw=Object.assign,Yw={};function wc(e,t,a){this.props=e,this.context=t,this.refs=Yw,this.updater=a||Kw}wc.prototype.isReactComponent={};wc.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};wc.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Jw(){}Jw.prototype=wc.prototype;function x0(e,t,a){this.props=e,this.context=t,this.refs=Yw,this.updater=a||Kw}var b0=x0.prototype=new Jw;b0.constructor=x0;Xw(b0,wc.prototype);b0.isPureReactComponent=!0;var Ax=Array.isArray,Qw=Object.prototype.hasOwnProperty,w0={current:null},e2={key:!0,ref:!0,__self:!0,__source:!0};function t2(e,t,a){var u,f={},v=null,x=null;if(t!=null)for(u in t.ref!==void 0&&(x=t.ref),t.key!==void 0&&(v=""+t.key),t)Qw.call(t,u)&&!e2.hasOwnProperty(u)&&(f[u]=t[u]);var h=arguments.length-2;if(h===1)f.children=a;else if(1<h){for(var z=Array(h),B=0;B<h;B++)z[B]=arguments[B+2];f.children=z}if(e&&e.defaultProps)for(u in h=e.defaultProps,h)f[u]===void 0&&(f[u]=h[u]);return{$$typeof:Md,type:e,key:v,ref:x,props:f,_owner:w0.current}}function KI(e,t){return{$$typeof:Md,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function S0(e){return typeof e=="object"&&e!==null&&e.$$typeof===Md}function XI(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(a){return t[a]})}var Px=/\/+/g;function Cy(e,t){return typeof e=="object"&&e!==null&&e.key!=null?XI(""+e.key):t.toString(36)}function mf(e,t,a,u,f){var v=typeof e;(v==="undefined"||v==="boolean")&&(e=null);var x=!1;if(e===null)x=!0;else switch(v){case"string":case"number":x=!0;break;case"object":switch(e.$$typeof){case Md:case OI:x=!0}}if(x)return x=e,f=f(x),e=u===""?"."+Cy(x,0):u,Ax(f)?(a="",e!=null&&(a=e.replace(Px,"$&/")+"/"),mf(f,t,a,"",function(B){return B})):f!=null&&(S0(f)&&(f=KI(f,a+(!f.key||x&&x.key===f.key?"":(""+f.key).replace(Px,"$&/")+"/")+e)),t.push(f)),1;if(x=0,u=u===""?".":u+":",Ax(e))for(var h=0;h<e.length;h++){v=e[h];var z=u+Cy(v,h);x+=mf(v,t,a,z,f)}else if(z=WI(e),typeof z=="function")for(e=z.call(e),h=0;!(v=e.next()).done;)v=v.value,z=u+Cy(v,h++),x+=mf(v,t,a,z,f);else if(v==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return x}function Zp(e,t,a){if(e==null)return e;var u=[],f=0;return mf(e,u,"","",function(v){return t.call(a,v,f++)}),u}function YI(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(a){(e._status===0||e._status===-1)&&(e._status=1,e._result=a)},function(a){(e._status===0||e._status===-1)&&(e._status=2,e._result=a)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var hi={current:null},gf={transition:null},JI={ReactCurrentDispatcher:hi,ReactCurrentBatchConfig:gf,ReactCurrentOwner:w0};function r2(){throw Error("act(...) is not supported in production builds of React.")}Ft.Children={map:Zp,forEach:function(e,t,a){Zp(e,function(){t.apply(this,arguments)},a)},count:function(e){var t=0;return Zp(e,function(){t++}),t},toArray:function(e){return Zp(e,function(t){return t})||[]},only:function(e){if(!S0(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ft.Component=wc;Ft.Fragment=NI;Ft.Profiler=UI;Ft.PureComponent=x0;Ft.StrictMode=$I;Ft.Suspense=ZI;Ft.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=JI;Ft.act=r2;Ft.cloneElement=function(e,t,a){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var u=Xw({},e.props),f=e.key,v=e.ref,x=e._owner;if(t!=null){if(t.ref!==void 0&&(v=t.ref,x=w0.current),t.key!==void 0&&(f=""+t.key),e.type&&e.type.defaultProps)var h=e.type.defaultProps;for(z in t)Qw.call(t,z)&&!e2.hasOwnProperty(z)&&(u[z]=t[z]===void 0&&h!==void 0?h[z]:t[z])}var z=arguments.length-2;if(z===1)u.children=a;else if(1<z){h=Array(z);for(var B=0;B<z;B++)h[B]=arguments[B+2];u.children=h}return{$$typeof:Md,type:e.type,key:f,ref:v,props:u,_owner:x}};Ft.createContext=function(e){return e={$$typeof:VI,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:jI,_context:e},e.Consumer=e};Ft.createElement=t2;Ft.createFactory=function(e){var t=t2.bind(null,e);return t.type=e,t};Ft.createRef=function(){return{current:null}};Ft.forwardRef=function(e){return{$$typeof:qI,render:e}};Ft.isValidElement=S0;Ft.lazy=function(e){return{$$typeof:HI,_payload:{_status:-1,_result:e},_init:YI}};Ft.memo=function(e,t){return{$$typeof:GI,type:e,compare:t===void 0?null:t}};Ft.startTransition=function(e){var t=gf.transition;gf.transition={};try{e()}finally{gf.transition=t}};Ft.unstable_act=r2;Ft.useCallback=function(e,t){return hi.current.useCallback(e,t)};Ft.useContext=function(e){return hi.current.useContext(e)};Ft.useDebugValue=function(){};Ft.useDeferredValue=function(e){return hi.current.useDeferredValue(e)};Ft.useEffect=function(e,t){return hi.current.useEffect(e,t)};Ft.useId=function(){return hi.current.useId()};Ft.useImperativeHandle=function(e,t,a){return hi.current.useImperativeHandle(e,t,a)};Ft.useInsertionEffect=function(e,t){return hi.current.useInsertionEffect(e,t)};Ft.useLayoutEffect=function(e,t){return hi.current.useLayoutEffect(e,t)};Ft.useMemo=function(e,t){return hi.current.useMemo(e,t)};Ft.useReducer=function(e,t,a){return hi.current.useReducer(e,t,a)};Ft.useRef=function(e){return hi.current.useRef(e)};Ft.useState=function(e){return hi.current.useState(e)};Ft.useSyncExternalStore=function(e,t,a){return hi.current.useSyncExternalStore(e,t,a)};Ft.useTransition=function(){return hi.current.useTransition()};Ft.version="18.3.1";Ww.exports=Ft;var He=Ww.exports;const kl=v0(He),o_=FI({__proto__:null,default:kl},[He]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var QI=He,eE=Symbol.for("react.element"),tE=Symbol.for("react.fragment"),rE=Object.prototype.hasOwnProperty,nE=QI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,iE={key:!0,ref:!0,__self:!0,__source:!0};function n2(e,t,a){var u,f={},v=null,x=null;a!==void 0&&(v=""+a),t.key!==void 0&&(v=""+t.key),t.ref!==void 0&&(x=t.ref);for(u in t)rE.call(t,u)&&!iE.hasOwnProperty(u)&&(f[u]=t[u]);if(e&&e.defaultProps)for(u in t=e.defaultProps,t)f[u]===void 0&&(f[u]=t[u]);return{$$typeof:eE,type:e,key:v,ref:x,props:f,_owner:nE.current}}cm.Fragment=tE;cm.jsx=n2;cm.jsxs=n2;Hw.exports=cm;var Kt=Hw.exports,a_={},i2={exports:{}},eo={},o2={exports:{}},a2={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Ve,gt){var yt=Ve.length;Ve.push(gt);e:for(;0<yt;){var Pt=yt-1>>>1,Vt=Ve[Pt];if(0<f(Vt,gt))Ve[Pt]=gt,Ve[yt]=Vt,yt=Pt;else break e}}function a(Ve){return Ve.length===0?null:Ve[0]}function u(Ve){if(Ve.length===0)return null;var gt=Ve[0],yt=Ve.pop();if(yt!==gt){Ve[0]=yt;e:for(var Pt=0,Vt=Ve.length,Jn=Vt>>>1;Pt<Jn;){var _r=2*(Pt+1)-1,qr=Ve[_r],Kr=_r+1,Br=Ve[Kr];if(0>f(qr,yt))Kr<Vt&&0>f(Br,qr)?(Ve[Pt]=Br,Ve[Kr]=yt,Pt=Kr):(Ve[Pt]=qr,Ve[_r]=yt,Pt=_r);else if(Kr<Vt&&0>f(Br,yt))Ve[Pt]=Br,Ve[Kr]=yt,Pt=Kr;else break e}}return gt}function f(Ve,gt){var yt=Ve.sortIndex-gt.sortIndex;return yt!==0?yt:Ve.id-gt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var v=performance;e.unstable_now=function(){return v.now()}}else{var x=Date,h=x.now();e.unstable_now=function(){return x.now()-h}}var z=[],B=[],Z=1,U=null,O=3,de=!1,he=!1,ae=!1,Ae=typeof setTimeout=="function"?setTimeout:null,te=typeof clearTimeout=="function"?clearTimeout:null,H=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ie(Ve){for(var gt=a(B);gt!==null;){if(gt.callback===null)u(B);else if(gt.startTime<=Ve)u(B),gt.sortIndex=gt.expirationTime,t(z,gt);else break;gt=a(B)}}function _e(Ve){if(ae=!1,ie(Ve),!he)if(a(z)!==null)he=!0,Tr(Se);else{var gt=a(B);gt!==null&&Fr(_e,gt.startTime-Ve)}}function Se(Ve,gt){he=!1,ae&&(ae=!1,te(Ze),Ze=-1),de=!0;var yt=O;try{for(ie(gt),U=a(z);U!==null&&(!(U.expirationTime>gt)||Ve&&!ot());){var Pt=U.callback;if(typeof Pt=="function"){U.callback=null,O=U.priorityLevel;var Vt=Pt(U.expirationTime<=gt);gt=e.unstable_now(),typeof Vt=="function"?U.callback=Vt:U===a(z)&&u(z),ie(gt)}else u(z);U=a(z)}if(U!==null)var Jn=!0;else{var _r=a(B);_r!==null&&Fr(_e,_r.startTime-gt),Jn=!1}return Jn}finally{U=null,O=yt,de=!1}}var Ee=!1,ke=null,Ze=-1,mt=5,tt=-1;function ot(){return!(e.unstable_now()-tt<mt)}function $t(){if(ke!==null){var Ve=e.unstable_now();tt=Ve;var gt=!0;try{gt=ke(!0,Ve)}finally{gt?It():(Ee=!1,ke=null)}}else Ee=!1}var It;if(typeof H=="function")It=function(){H($t)};else if(typeof MessageChannel<"u"){var Bt=new MessageChannel,Pr=Bt.port2;Bt.port1.onmessage=$t,It=function(){Pr.postMessage(null)}}else It=function(){Ae($t,0)};function Tr(Ve){ke=Ve,Ee||(Ee=!0,It())}function Fr(Ve,gt){Ze=Ae(function(){Ve(e.unstable_now())},gt)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Ve){Ve.callback=null},e.unstable_continueExecution=function(){he||de||(he=!0,Tr(Se))},e.unstable_forceFrameRate=function(Ve){0>Ve||125<Ve?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):mt=0<Ve?Math.floor(1e3/Ve):5},e.unstable_getCurrentPriorityLevel=function(){return O},e.unstable_getFirstCallbackNode=function(){return a(z)},e.unstable_next=function(Ve){switch(O){case 1:case 2:case 3:var gt=3;break;default:gt=O}var yt=O;O=gt;try{return Ve()}finally{O=yt}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Ve,gt){switch(Ve){case 1:case 2:case 3:case 4:case 5:break;default:Ve=3}var yt=O;O=Ve;try{return gt()}finally{O=yt}},e.unstable_scheduleCallback=function(Ve,gt,yt){var Pt=e.unstable_now();switch(typeof yt=="object"&&yt!==null?(yt=yt.delay,yt=typeof yt=="number"&&0<yt?Pt+yt:Pt):yt=Pt,Ve){case 1:var Vt=-1;break;case 2:Vt=250;break;case 5:Vt=1073741823;break;case 4:Vt=1e4;break;default:Vt=5e3}return Vt=yt+Vt,Ve={id:Z++,callback:gt,priorityLevel:Ve,startTime:yt,expirationTime:Vt,sortIndex:-1},yt>Pt?(Ve.sortIndex=yt,t(B,Ve),a(z)===null&&Ve===a(B)&&(ae?(te(Ze),Ze=-1):ae=!0,Fr(_e,yt-Pt))):(Ve.sortIndex=Vt,t(z,Ve),he||de||(he=!0,Tr(Se))),Ve},e.unstable_shouldYield=ot,e.unstable_wrapCallback=function(Ve){var gt=O;return function(){var yt=O;O=gt;try{return Ve.apply(this,arguments)}finally{O=yt}}}})(a2);o2.exports=a2;var oE=o2.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aE=He,Qi=oE;function Le(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,a=1;a<arguments.length;a++)t+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s2=new Set,ud={};function $l(e,t){fc(e,t),fc(e+"Capture",t)}function fc(e,t){for(ud[e]=t,e=0;e<t.length;e++)s2.add(t[e])}var Oa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),s_=Object.prototype.hasOwnProperty,sE=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Mx={},zx={};function lE(e){return s_.call(zx,e)?!0:s_.call(Mx,e)?!1:sE.test(e)?zx[e]=!0:(Mx[e]=!0,!1)}function uE(e,t,a,u){if(a!==null&&a.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return u?!1:a!==null?!a.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function cE(e,t,a,u){if(t===null||typeof t>"u"||uE(e,t,a,u))return!0;if(u)return!1;if(a!==null)switch(a.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function di(e,t,a,u,f,v,x){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=u,this.attributeNamespace=f,this.mustUseProperty=a,this.propertyName=e,this.type=t,this.sanitizeURL=v,this.removeEmptyString=x}var Fn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Fn[e]=new di(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Fn[t]=new di(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Fn[e]=new di(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Fn[e]=new di(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Fn[e]=new di(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Fn[e]=new di(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Fn[e]=new di(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Fn[e]=new di(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Fn[e]=new di(e,5,!1,e.toLowerCase(),null,!1,!1)});var T0=/[\-:]([a-z])/g;function C0(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(T0,C0);Fn[t]=new di(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(T0,C0);Fn[t]=new di(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(T0,C0);Fn[t]=new di(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Fn[e]=new di(e,1,!1,e.toLowerCase(),null,!1,!1)});Fn.xlinkHref=new di("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Fn[e]=new di(e,1,!1,e.toLowerCase(),null,!0,!0)});function k0(e,t,a,u){var f=Fn.hasOwnProperty(t)?Fn[t]:null;(f!==null?f.type!==0:u||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(cE(t,a,f,u)&&(a=null),u||f===null?lE(t)&&(a===null?e.removeAttribute(t):e.setAttribute(t,""+a)):f.mustUseProperty?e[f.propertyName]=a===null?f.type===3?!1:"":a:(t=f.attributeName,u=f.attributeNamespace,a===null?e.removeAttribute(t):(f=f.type,a=f===3||f===4&&a===!0?"":""+a,u?e.setAttributeNS(u,t,a):e.setAttribute(t,a))))}var qa=aE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Gp=Symbol.for("react.element"),qu=Symbol.for("react.portal"),Zu=Symbol.for("react.fragment"),I0=Symbol.for("react.strict_mode"),l_=Symbol.for("react.profiler"),l2=Symbol.for("react.provider"),u2=Symbol.for("react.context"),E0=Symbol.for("react.forward_ref"),u_=Symbol.for("react.suspense"),c_=Symbol.for("react.suspense_list"),A0=Symbol.for("react.memo"),Is=Symbol.for("react.lazy"),c2=Symbol.for("react.offscreen"),Lx=Symbol.iterator;function Bh(e){return e===null||typeof e!="object"?null:(e=Lx&&e[Lx]||e["@@iterator"],typeof e=="function"?e:null)}var Dr=Object.assign,ky;function Hh(e){if(ky===void 0)try{throw Error()}catch(a){var t=a.stack.trim().match(/\n( *(at )?)/);ky=t&&t[1]||""}return`
`+ky+e}var Iy=!1;function Ey(e,t){if(!e||Iy)return"";Iy=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(B){var u=B}Reflect.construct(e,[],t)}else{try{t.call()}catch(B){u=B}e.call(t.prototype)}else{try{throw Error()}catch(B){u=B}e()}}catch(B){if(B&&u&&typeof B.stack=="string"){for(var f=B.stack.split(`
`),v=u.stack.split(`
`),x=f.length-1,h=v.length-1;1<=x&&0<=h&&f[x]!==v[h];)h--;for(;1<=x&&0<=h;x--,h--)if(f[x]!==v[h]){if(x!==1||h!==1)do if(x--,h--,0>h||f[x]!==v[h]){var z=`
`+f[x].replace(" at new "," at ");return e.displayName&&z.includes("<anonymous>")&&(z=z.replace("<anonymous>",e.displayName)),z}while(1<=x&&0<=h);break}}}finally{Iy=!1,Error.prepareStackTrace=a}return(e=e?e.displayName||e.name:"")?Hh(e):""}function hE(e){switch(e.tag){case 5:return Hh(e.type);case 16:return Hh("Lazy");case 13:return Hh("Suspense");case 19:return Hh("SuspenseList");case 0:case 2:case 15:return e=Ey(e.type,!1),e;case 11:return e=Ey(e.type.render,!1),e;case 1:return e=Ey(e.type,!0),e;default:return""}}function h_(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Zu:return"Fragment";case qu:return"Portal";case l_:return"Profiler";case I0:return"StrictMode";case u_:return"Suspense";case c_:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case u2:return(e.displayName||"Context")+".Consumer";case l2:return(e._context.displayName||"Context")+".Provider";case E0:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case A0:return t=e.displayName||null,t!==null?t:h_(e.type)||"Memo";case Is:t=e._payload,e=e._init;try{return h_(e(t))}catch{}}return null}function dE(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return h_(t);case 8:return t===I0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function js(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function h2(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function pE(e){var t=h2(e)?"checked":"value",a=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),u=""+e[t];if(!e.hasOwnProperty(t)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var f=a.get,v=a.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return f.call(this)},set:function(x){u=""+x,v.call(this,x)}}),Object.defineProperty(e,t,{enumerable:a.enumerable}),{getValue:function(){return u},setValue:function(x){u=""+x},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Hp(e){e._valueTracker||(e._valueTracker=pE(e))}function d2(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var a=t.getValue(),u="";return e&&(u=h2(e)?e.checked?"true":"false":e.value),e=u,e!==a?(t.setValue(e),!0):!1}function Ff(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function d_(e,t){var a=t.checked;return Dr({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:a??e._wrapperState.initialChecked})}function Rx(e,t){var a=t.defaultValue==null?"":t.defaultValue,u=t.checked!=null?t.checked:t.defaultChecked;a=js(t.value!=null?t.value:a),e._wrapperState={initialChecked:u,initialValue:a,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function p2(e,t){t=t.checked,t!=null&&k0(e,"checked",t,!1)}function p_(e,t){p2(e,t);var a=js(t.value),u=t.type;if(a!=null)u==="number"?(a===0&&e.value===""||e.value!=a)&&(e.value=""+a):e.value!==""+a&&(e.value=""+a);else if(u==="submit"||u==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?f_(e,t.type,a):t.hasOwnProperty("defaultValue")&&f_(e,t.type,js(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Dx(e,t,a){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var u=t.type;if(!(u!=="submit"&&u!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,a||t===e.value||(e.value=t),e.defaultValue=t}a=e.name,a!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,a!==""&&(e.name=a)}function f_(e,t,a){(t!=="number"||Ff(e.ownerDocument)!==e)&&(a==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+a&&(e.defaultValue=""+a))}var Wh=Array.isArray;function rc(e,t,a,u){if(e=e.options,t){t={};for(var f=0;f<a.length;f++)t["$"+a[f]]=!0;for(a=0;a<e.length;a++)f=t.hasOwnProperty("$"+e[a].value),e[a].selected!==f&&(e[a].selected=f),f&&u&&(e[a].defaultSelected=!0)}else{for(a=""+js(a),t=null,f=0;f<e.length;f++){if(e[f].value===a){e[f].selected=!0,u&&(e[f].defaultSelected=!0);return}t!==null||e[f].disabled||(t=e[f])}t!==null&&(t.selected=!0)}}function m_(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Le(91));return Dr({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Fx(e,t){var a=t.value;if(a==null){if(a=t.children,t=t.defaultValue,a!=null){if(t!=null)throw Error(Le(92));if(Wh(a)){if(1<a.length)throw Error(Le(93));a=a[0]}t=a}t==null&&(t=""),a=t}e._wrapperState={initialValue:js(a)}}function f2(e,t){var a=js(t.value),u=js(t.defaultValue);a!=null&&(a=""+a,a!==e.value&&(e.value=a),t.defaultValue==null&&e.defaultValue!==a&&(e.defaultValue=a)),u!=null&&(e.defaultValue=""+u)}function Bx(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function m2(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function g_(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?m2(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Wp,g2=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,a,u,f){MSApp.execUnsafeLocalFunction(function(){return e(t,a,u,f)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Wp=Wp||document.createElement("div"),Wp.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Wp.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function cd(e,t){if(t){var a=e.firstChild;if(a&&a===e.lastChild&&a.nodeType===3){a.nodeValue=t;return}}e.textContent=t}var Qh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fE=["Webkit","ms","Moz","O"];Object.keys(Qh).forEach(function(e){fE.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Qh[t]=Qh[e]})});function y2(e,t,a){return t==null||typeof t=="boolean"||t===""?"":a||typeof t!="number"||t===0||Qh.hasOwnProperty(e)&&Qh[e]?(""+t).trim():t+"px"}function _2(e,t){e=e.style;for(var a in t)if(t.hasOwnProperty(a)){var u=a.indexOf("--")===0,f=y2(a,t[a],u);a==="float"&&(a="cssFloat"),u?e.setProperty(a,f):e[a]=f}}var mE=Dr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function y_(e,t){if(t){if(mE[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Le(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Le(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Le(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Le(62))}}function __(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var v_=null;function P0(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var x_=null,nc=null,ic=null;function Ox(e){if(e=Rd(e)){if(typeof x_!="function")throw Error(Le(280));var t=e.stateNode;t&&(t=mm(t),x_(e.stateNode,e.type,t))}}function v2(e){nc?ic?ic.push(e):ic=[e]:nc=e}function x2(){if(nc){var e=nc,t=ic;if(ic=nc=null,Ox(e),t)for(e=0;e<t.length;e++)Ox(t[e])}}function b2(e,t){return e(t)}function w2(){}var Ay=!1;function S2(e,t,a){if(Ay)return e(t,a);Ay=!0;try{return b2(e,t,a)}finally{Ay=!1,(nc!==null||ic!==null)&&(w2(),x2())}}function hd(e,t){var a=e.stateNode;if(a===null)return null;var u=mm(a);if(u===null)return null;a=u[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(e=e.type,u=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!u;break e;default:e=!1}if(e)return null;if(a&&typeof a!="function")throw Error(Le(231,t,typeof a));return a}var b_=!1;if(Oa)try{var Oh={};Object.defineProperty(Oh,"passive",{get:function(){b_=!0}}),window.addEventListener("test",Oh,Oh),window.removeEventListener("test",Oh,Oh)}catch{b_=!1}function gE(e,t,a,u,f,v,x,h,z){var B=Array.prototype.slice.call(arguments,3);try{t.apply(a,B)}catch(Z){this.onError(Z)}}var ed=!1,Bf=null,Of=!1,w_=null,yE={onError:function(e){ed=!0,Bf=e}};function _E(e,t,a,u,f,v,x,h,z){ed=!1,Bf=null,gE.apply(yE,arguments)}function vE(e,t,a,u,f,v,x,h,z){if(_E.apply(this,arguments),ed){if(ed){var B=Bf;ed=!1,Bf=null}else throw Error(Le(198));Of||(Of=!0,w_=B)}}function Ul(e){var t=e,a=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(a=t.return),e=t.return;while(e)}return t.tag===3?a:null}function T2(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Nx(e){if(Ul(e)!==e)throw Error(Le(188))}function xE(e){var t=e.alternate;if(!t){if(t=Ul(e),t===null)throw Error(Le(188));return t!==e?null:e}for(var a=e,u=t;;){var f=a.return;if(f===null)break;var v=f.alternate;if(v===null){if(u=f.return,u!==null){a=u;continue}break}if(f.child===v.child){for(v=f.child;v;){if(v===a)return Nx(f),e;if(v===u)return Nx(f),t;v=v.sibling}throw Error(Le(188))}if(a.return!==u.return)a=f,u=v;else{for(var x=!1,h=f.child;h;){if(h===a){x=!0,a=f,u=v;break}if(h===u){x=!0,u=f,a=v;break}h=h.sibling}if(!x){for(h=v.child;h;){if(h===a){x=!0,a=v,u=f;break}if(h===u){x=!0,u=v,a=f;break}h=h.sibling}if(!x)throw Error(Le(189))}}if(a.alternate!==u)throw Error(Le(190))}if(a.tag!==3)throw Error(Le(188));return a.stateNode.current===a?e:t}function C2(e){return e=xE(e),e!==null?k2(e):null}function k2(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=k2(e);if(t!==null)return t;e=e.sibling}return null}var I2=Qi.unstable_scheduleCallback,$x=Qi.unstable_cancelCallback,bE=Qi.unstable_shouldYield,wE=Qi.unstable_requestPaint,Gr=Qi.unstable_now,SE=Qi.unstable_getCurrentPriorityLevel,M0=Qi.unstable_ImmediatePriority,E2=Qi.unstable_UserBlockingPriority,Nf=Qi.unstable_NormalPriority,TE=Qi.unstable_LowPriority,A2=Qi.unstable_IdlePriority,hm=null,la=null;function CE(e){if(la&&typeof la.onCommitFiberRoot=="function")try{la.onCommitFiberRoot(hm,e,void 0,(e.current.flags&128)===128)}catch{}}var jo=Math.clz32?Math.clz32:EE,kE=Math.log,IE=Math.LN2;function EE(e){return e>>>=0,e===0?32:31-(kE(e)/IE|0)|0}var Kp=64,Xp=4194304;function Kh(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function $f(e,t){var a=e.pendingLanes;if(a===0)return 0;var u=0,f=e.suspendedLanes,v=e.pingedLanes,x=a&268435455;if(x!==0){var h=x&~f;h!==0?u=Kh(h):(v&=x,v!==0&&(u=Kh(v)))}else x=a&~f,x!==0?u=Kh(x):v!==0&&(u=Kh(v));if(u===0)return 0;if(t!==0&&t!==u&&!(t&f)&&(f=u&-u,v=t&-t,f>=v||f===16&&(v&4194240)!==0))return t;if(u&4&&(u|=a&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=u;0<t;)a=31-jo(t),f=1<<a,u|=e[a],t&=~f;return u}function AE(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function PE(e,t){for(var a=e.suspendedLanes,u=e.pingedLanes,f=e.expirationTimes,v=e.pendingLanes;0<v;){var x=31-jo(v),h=1<<x,z=f[x];z===-1?(!(h&a)||h&u)&&(f[x]=AE(h,t)):z<=t&&(e.expiredLanes|=h),v&=~h}}function S_(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function P2(){var e=Kp;return Kp<<=1,!(Kp&4194240)&&(Kp=64),e}function Py(e){for(var t=[],a=0;31>a;a++)t.push(e);return t}function zd(e,t,a){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-jo(t),e[t]=a}function ME(e,t){var a=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var u=e.eventTimes;for(e=e.expirationTimes;0<a;){var f=31-jo(a),v=1<<f;t[f]=0,u[f]=-1,e[f]=-1,a&=~v}}function z0(e,t){var a=e.entangledLanes|=t;for(e=e.entanglements;a;){var u=31-jo(a),f=1<<u;f&t|e[u]&t&&(e[u]|=t),a&=~f}}var sr=0;function M2(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var z2,L0,L2,R2,D2,T_=!1,Yp=[],Rs=null,Ds=null,Fs=null,dd=new Map,pd=new Map,As=[],zE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ux(e,t){switch(e){case"focusin":case"focusout":Rs=null;break;case"dragenter":case"dragleave":Ds=null;break;case"mouseover":case"mouseout":Fs=null;break;case"pointerover":case"pointerout":dd.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":pd.delete(t.pointerId)}}function Nh(e,t,a,u,f,v){return e===null||e.nativeEvent!==v?(e={blockedOn:t,domEventName:a,eventSystemFlags:u,nativeEvent:v,targetContainers:[f]},t!==null&&(t=Rd(t),t!==null&&L0(t)),e):(e.eventSystemFlags|=u,t=e.targetContainers,f!==null&&t.indexOf(f)===-1&&t.push(f),e)}function LE(e,t,a,u,f){switch(t){case"focusin":return Rs=Nh(Rs,e,t,a,u,f),!0;case"dragenter":return Ds=Nh(Ds,e,t,a,u,f),!0;case"mouseover":return Fs=Nh(Fs,e,t,a,u,f),!0;case"pointerover":var v=f.pointerId;return dd.set(v,Nh(dd.get(v)||null,e,t,a,u,f)),!0;case"gotpointercapture":return v=f.pointerId,pd.set(v,Nh(pd.get(v)||null,e,t,a,u,f)),!0}return!1}function F2(e){var t=Il(e.target);if(t!==null){var a=Ul(t);if(a!==null){if(t=a.tag,t===13){if(t=T2(a),t!==null){e.blockedOn=t,D2(e.priority,function(){L2(a)});return}}else if(t===3&&a.stateNode.current.memoizedState.isDehydrated){e.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}e.blockedOn=null}function yf(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var a=C_(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(a===null){a=e.nativeEvent;var u=new a.constructor(a.type,a);v_=u,a.target.dispatchEvent(u),v_=null}else return t=Rd(a),t!==null&&L0(t),e.blockedOn=a,!1;t.shift()}return!0}function jx(e,t,a){yf(e)&&a.delete(t)}function RE(){T_=!1,Rs!==null&&yf(Rs)&&(Rs=null),Ds!==null&&yf(Ds)&&(Ds=null),Fs!==null&&yf(Fs)&&(Fs=null),dd.forEach(jx),pd.forEach(jx)}function $h(e,t){e.blockedOn===t&&(e.blockedOn=null,T_||(T_=!0,Qi.unstable_scheduleCallback(Qi.unstable_NormalPriority,RE)))}function fd(e){function t(f){return $h(f,e)}if(0<Yp.length){$h(Yp[0],e);for(var a=1;a<Yp.length;a++){var u=Yp[a];u.blockedOn===e&&(u.blockedOn=null)}}for(Rs!==null&&$h(Rs,e),Ds!==null&&$h(Ds,e),Fs!==null&&$h(Fs,e),dd.forEach(t),pd.forEach(t),a=0;a<As.length;a++)u=As[a],u.blockedOn===e&&(u.blockedOn=null);for(;0<As.length&&(a=As[0],a.blockedOn===null);)F2(a),a.blockedOn===null&&As.shift()}var oc=qa.ReactCurrentBatchConfig,Uf=!0;function DE(e,t,a,u){var f=sr,v=oc.transition;oc.transition=null;try{sr=1,R0(e,t,a,u)}finally{sr=f,oc.transition=v}}function FE(e,t,a,u){var f=sr,v=oc.transition;oc.transition=null;try{sr=4,R0(e,t,a,u)}finally{sr=f,oc.transition=v}}function R0(e,t,a,u){if(Uf){var f=C_(e,t,a,u);if(f===null)$y(e,t,u,jf,a),Ux(e,u);else if(LE(f,e,t,a,u))u.stopPropagation();else if(Ux(e,u),t&4&&-1<zE.indexOf(e)){for(;f!==null;){var v=Rd(f);if(v!==null&&z2(v),v=C_(e,t,a,u),v===null&&$y(e,t,u,jf,a),v===f)break;f=v}f!==null&&u.stopPropagation()}else $y(e,t,u,null,a)}}var jf=null;function C_(e,t,a,u){if(jf=null,e=P0(u),e=Il(e),e!==null)if(t=Ul(e),t===null)e=null;else if(a=t.tag,a===13){if(e=T2(t),e!==null)return e;e=null}else if(a===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return jf=e,null}function B2(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(SE()){case M0:return 1;case E2:return 4;case Nf:case TE:return 16;case A2:return 536870912;default:return 16}default:return 16}}var zs=null,D0=null,_f=null;function O2(){if(_f)return _f;var e,t=D0,a=t.length,u,f="value"in zs?zs.value:zs.textContent,v=f.length;for(e=0;e<a&&t[e]===f[e];e++);var x=a-e;for(u=1;u<=x&&t[a-u]===f[v-u];u++);return _f=f.slice(e,1<u?1-u:void 0)}function vf(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Jp(){return!0}function Vx(){return!1}function to(e){function t(a,u,f,v,x){this._reactName=a,this._targetInst=f,this.type=u,this.nativeEvent=v,this.target=x,this.currentTarget=null;for(var h in e)e.hasOwnProperty(h)&&(a=e[h],this[h]=a?a(v):v[h]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?Jp:Vx,this.isPropagationStopped=Vx,this}return Dr(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=Jp)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=Jp)},persist:function(){},isPersistent:Jp}),t}var Sc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},F0=to(Sc),Ld=Dr({},Sc,{view:0,detail:0}),BE=to(Ld),My,zy,Uh,dm=Dr({},Ld,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:B0,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Uh&&(Uh&&e.type==="mousemove"?(My=e.screenX-Uh.screenX,zy=e.screenY-Uh.screenY):zy=My=0,Uh=e),My)},movementY:function(e){return"movementY"in e?e.movementY:zy}}),qx=to(dm),OE=Dr({},dm,{dataTransfer:0}),NE=to(OE),$E=Dr({},Ld,{relatedTarget:0}),Ly=to($E),UE=Dr({},Sc,{animationName:0,elapsedTime:0,pseudoElement:0}),jE=to(UE),VE=Dr({},Sc,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),qE=to(VE),ZE=Dr({},Sc,{data:0}),Zx=to(ZE),GE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},HE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},WE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function KE(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=WE[e])?!!t[e]:!1}function B0(){return KE}var XE=Dr({},Ld,{key:function(e){if(e.key){var t=GE[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=vf(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?HE[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:B0,charCode:function(e){return e.type==="keypress"?vf(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?vf(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),YE=to(XE),JE=Dr({},dm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Gx=to(JE),QE=Dr({},Ld,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:B0}),eA=to(QE),tA=Dr({},Sc,{propertyName:0,elapsedTime:0,pseudoElement:0}),rA=to(tA),nA=Dr({},dm,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),iA=to(nA),oA=[9,13,27,32],O0=Oa&&"CompositionEvent"in window,td=null;Oa&&"documentMode"in document&&(td=document.documentMode);var aA=Oa&&"TextEvent"in window&&!td,N2=Oa&&(!O0||td&&8<td&&11>=td),Hx=" ",Wx=!1;function $2(e,t){switch(e){case"keyup":return oA.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function U2(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Gu=!1;function sA(e,t){switch(e){case"compositionend":return U2(t);case"keypress":return t.which!==32?null:(Wx=!0,Hx);case"textInput":return e=t.data,e===Hx&&Wx?null:e;default:return null}}function lA(e,t){if(Gu)return e==="compositionend"||!O0&&$2(e,t)?(e=O2(),_f=D0=zs=null,Gu=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return N2&&t.locale!=="ko"?null:t.data;default:return null}}var uA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Kx(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!uA[e.type]:t==="textarea"}function j2(e,t,a,u){v2(u),t=Vf(t,"onChange"),0<t.length&&(a=new F0("onChange","change",null,a,u),e.push({event:a,listeners:t}))}var rd=null,md=null;function cA(e){Q2(e,0)}function pm(e){var t=Ku(e);if(d2(t))return e}function hA(e,t){if(e==="change")return t}var V2=!1;if(Oa){var Ry;if(Oa){var Dy="oninput"in document;if(!Dy){var Xx=document.createElement("div");Xx.setAttribute("oninput","return;"),Dy=typeof Xx.oninput=="function"}Ry=Dy}else Ry=!1;V2=Ry&&(!document.documentMode||9<document.documentMode)}function Yx(){rd&&(rd.detachEvent("onpropertychange",q2),md=rd=null)}function q2(e){if(e.propertyName==="value"&&pm(md)){var t=[];j2(t,md,e,P0(e)),S2(cA,t)}}function dA(e,t,a){e==="focusin"?(Yx(),rd=t,md=a,rd.attachEvent("onpropertychange",q2)):e==="focusout"&&Yx()}function pA(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return pm(md)}function fA(e,t){if(e==="click")return pm(t)}function mA(e,t){if(e==="input"||e==="change")return pm(t)}function gA(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var qo=typeof Object.is=="function"?Object.is:gA;function gd(e,t){if(qo(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var a=Object.keys(e),u=Object.keys(t);if(a.length!==u.length)return!1;for(u=0;u<a.length;u++){var f=a[u];if(!s_.call(t,f)||!qo(e[f],t[f]))return!1}return!0}function Jx(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Qx(e,t){var a=Jx(e);e=0;for(var u;a;){if(a.nodeType===3){if(u=e+a.textContent.length,e<=t&&u>=t)return{node:a,offset:t-e};e=u}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=Jx(a)}}function Z2(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Z2(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function G2(){for(var e=window,t=Ff();t instanceof e.HTMLIFrameElement;){try{var a=typeof t.contentWindow.location.href=="string"}catch{a=!1}if(a)e=t.contentWindow;else break;t=Ff(e.document)}return t}function N0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function yA(e){var t=G2(),a=e.focusedElem,u=e.selectionRange;if(t!==a&&a&&a.ownerDocument&&Z2(a.ownerDocument.documentElement,a)){if(u!==null&&N0(a)){if(t=u.start,e=u.end,e===void 0&&(e=t),"selectionStart"in a)a.selectionStart=t,a.selectionEnd=Math.min(e,a.value.length);else if(e=(t=a.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var f=a.textContent.length,v=Math.min(u.start,f);u=u.end===void 0?v:Math.min(u.end,f),!e.extend&&v>u&&(f=u,u=v,v=f),f=Qx(a,v);var x=Qx(a,u);f&&x&&(e.rangeCount!==1||e.anchorNode!==f.node||e.anchorOffset!==f.offset||e.focusNode!==x.node||e.focusOffset!==x.offset)&&(t=t.createRange(),t.setStart(f.node,f.offset),e.removeAllRanges(),v>u?(e.addRange(t),e.extend(x.node,x.offset)):(t.setEnd(x.node,x.offset),e.addRange(t)))}}for(t=[],e=a;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof a.focus=="function"&&a.focus(),a=0;a<t.length;a++)e=t[a],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var _A=Oa&&"documentMode"in document&&11>=document.documentMode,Hu=null,k_=null,nd=null,I_=!1;function eb(e,t,a){var u=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;I_||Hu==null||Hu!==Ff(u)||(u=Hu,"selectionStart"in u&&N0(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),nd&&gd(nd,u)||(nd=u,u=Vf(k_,"onSelect"),0<u.length&&(t=new F0("onSelect","select",null,t,a),e.push({event:t,listeners:u}),t.target=Hu)))}function Qp(e,t){var a={};return a[e.toLowerCase()]=t.toLowerCase(),a["Webkit"+e]="webkit"+t,a["Moz"+e]="moz"+t,a}var Wu={animationend:Qp("Animation","AnimationEnd"),animationiteration:Qp("Animation","AnimationIteration"),animationstart:Qp("Animation","AnimationStart"),transitionend:Qp("Transition","TransitionEnd")},Fy={},H2={};Oa&&(H2=document.createElement("div").style,"AnimationEvent"in window||(delete Wu.animationend.animation,delete Wu.animationiteration.animation,delete Wu.animationstart.animation),"TransitionEvent"in window||delete Wu.transitionend.transition);function fm(e){if(Fy[e])return Fy[e];if(!Wu[e])return e;var t=Wu[e],a;for(a in t)if(t.hasOwnProperty(a)&&a in H2)return Fy[e]=t[a];return e}var W2=fm("animationend"),K2=fm("animationiteration"),X2=fm("animationstart"),Y2=fm("transitionend"),J2=new Map,tb="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function qs(e,t){J2.set(e,t),$l(t,[e])}for(var By=0;By<tb.length;By++){var Oy=tb[By],vA=Oy.toLowerCase(),xA=Oy[0].toUpperCase()+Oy.slice(1);qs(vA,"on"+xA)}qs(W2,"onAnimationEnd");qs(K2,"onAnimationIteration");qs(X2,"onAnimationStart");qs("dblclick","onDoubleClick");qs("focusin","onFocus");qs("focusout","onBlur");qs(Y2,"onTransitionEnd");fc("onMouseEnter",["mouseout","mouseover"]);fc("onMouseLeave",["mouseout","mouseover"]);fc("onPointerEnter",["pointerout","pointerover"]);fc("onPointerLeave",["pointerout","pointerover"]);$l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));$l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));$l("onBeforeInput",["compositionend","keypress","textInput","paste"]);$l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));$l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));$l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),bA=new Set("cancel close invalid load scroll toggle".split(" ").concat(Xh));function rb(e,t,a){var u=e.type||"unknown-event";e.currentTarget=a,vE(u,t,void 0,e),e.currentTarget=null}function Q2(e,t){t=(t&4)!==0;for(var a=0;a<e.length;a++){var u=e[a],f=u.event;u=u.listeners;e:{var v=void 0;if(t)for(var x=u.length-1;0<=x;x--){var h=u[x],z=h.instance,B=h.currentTarget;if(h=h.listener,z!==v&&f.isPropagationStopped())break e;rb(f,h,B),v=z}else for(x=0;x<u.length;x++){if(h=u[x],z=h.instance,B=h.currentTarget,h=h.listener,z!==v&&f.isPropagationStopped())break e;rb(f,h,B),v=z}}}if(Of)throw e=w_,Of=!1,w_=null,e}function wr(e,t){var a=t[z_];a===void 0&&(a=t[z_]=new Set);var u=e+"__bubble";a.has(u)||(eS(t,e,2,!1),a.add(u))}function Ny(e,t,a){var u=0;t&&(u|=4),eS(a,e,u,t)}var ef="_reactListening"+Math.random().toString(36).slice(2);function yd(e){if(!e[ef]){e[ef]=!0,s2.forEach(function(a){a!=="selectionchange"&&(bA.has(a)||Ny(a,!1,e),Ny(a,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[ef]||(t[ef]=!0,Ny("selectionchange",!1,t))}}function eS(e,t,a,u){switch(B2(t)){case 1:var f=DE;break;case 4:f=FE;break;default:f=R0}a=f.bind(null,t,a,e),f=void 0,!b_||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(f=!0),u?f!==void 0?e.addEventListener(t,a,{capture:!0,passive:f}):e.addEventListener(t,a,!0):f!==void 0?e.addEventListener(t,a,{passive:f}):e.addEventListener(t,a,!1)}function $y(e,t,a,u,f){var v=u;if(!(t&1)&&!(t&2)&&u!==null)e:for(;;){if(u===null)return;var x=u.tag;if(x===3||x===4){var h=u.stateNode.containerInfo;if(h===f||h.nodeType===8&&h.parentNode===f)break;if(x===4)for(x=u.return;x!==null;){var z=x.tag;if((z===3||z===4)&&(z=x.stateNode.containerInfo,z===f||z.nodeType===8&&z.parentNode===f))return;x=x.return}for(;h!==null;){if(x=Il(h),x===null)return;if(z=x.tag,z===5||z===6){u=v=x;continue e}h=h.parentNode}}u=u.return}S2(function(){var B=v,Z=P0(a),U=[];e:{var O=J2.get(e);if(O!==void 0){var de=F0,he=e;switch(e){case"keypress":if(vf(a)===0)break e;case"keydown":case"keyup":de=YE;break;case"focusin":he="focus",de=Ly;break;case"focusout":he="blur",de=Ly;break;case"beforeblur":case"afterblur":de=Ly;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":de=qx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":de=NE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":de=eA;break;case W2:case K2:case X2:de=jE;break;case Y2:de=rA;break;case"scroll":de=BE;break;case"wheel":de=iA;break;case"copy":case"cut":case"paste":de=qE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":de=Gx}var ae=(t&4)!==0,Ae=!ae&&e==="scroll",te=ae?O!==null?O+"Capture":null:O;ae=[];for(var H=B,ie;H!==null;){ie=H;var _e=ie.stateNode;if(ie.tag===5&&_e!==null&&(ie=_e,te!==null&&(_e=hd(H,te),_e!=null&&ae.push(_d(H,_e,ie)))),Ae)break;H=H.return}0<ae.length&&(O=new de(O,he,null,a,Z),U.push({event:O,listeners:ae}))}}if(!(t&7)){e:{if(O=e==="mouseover"||e==="pointerover",de=e==="mouseout"||e==="pointerout",O&&a!==v_&&(he=a.relatedTarget||a.fromElement)&&(Il(he)||he[Na]))break e;if((de||O)&&(O=Z.window===Z?Z:(O=Z.ownerDocument)?O.defaultView||O.parentWindow:window,de?(he=a.relatedTarget||a.toElement,de=B,he=he?Il(he):null,he!==null&&(Ae=Ul(he),he!==Ae||he.tag!==5&&he.tag!==6)&&(he=null)):(de=null,he=B),de!==he)){if(ae=qx,_e="onMouseLeave",te="onMouseEnter",H="mouse",(e==="pointerout"||e==="pointerover")&&(ae=Gx,_e="onPointerLeave",te="onPointerEnter",H="pointer"),Ae=de==null?O:Ku(de),ie=he==null?O:Ku(he),O=new ae(_e,H+"leave",de,a,Z),O.target=Ae,O.relatedTarget=ie,_e=null,Il(Z)===B&&(ae=new ae(te,H+"enter",he,a,Z),ae.target=ie,ae.relatedTarget=Ae,_e=ae),Ae=_e,de&&he)t:{for(ae=de,te=he,H=0,ie=ae;ie;ie=Bu(ie))H++;for(ie=0,_e=te;_e;_e=Bu(_e))ie++;for(;0<H-ie;)ae=Bu(ae),H--;for(;0<ie-H;)te=Bu(te),ie--;for(;H--;){if(ae===te||te!==null&&ae===te.alternate)break t;ae=Bu(ae),te=Bu(te)}ae=null}else ae=null;de!==null&&nb(U,O,de,ae,!1),he!==null&&Ae!==null&&nb(U,Ae,he,ae,!0)}}e:{if(O=B?Ku(B):window,de=O.nodeName&&O.nodeName.toLowerCase(),de==="select"||de==="input"&&O.type==="file")var Se=hA;else if(Kx(O))if(V2)Se=mA;else{Se=pA;var Ee=dA}else(de=O.nodeName)&&de.toLowerCase()==="input"&&(O.type==="checkbox"||O.type==="radio")&&(Se=fA);if(Se&&(Se=Se(e,B))){j2(U,Se,a,Z);break e}Ee&&Ee(e,O,B),e==="focusout"&&(Ee=O._wrapperState)&&Ee.controlled&&O.type==="number"&&f_(O,"number",O.value)}switch(Ee=B?Ku(B):window,e){case"focusin":(Kx(Ee)||Ee.contentEditable==="true")&&(Hu=Ee,k_=B,nd=null);break;case"focusout":nd=k_=Hu=null;break;case"mousedown":I_=!0;break;case"contextmenu":case"mouseup":case"dragend":I_=!1,eb(U,a,Z);break;case"selectionchange":if(_A)break;case"keydown":case"keyup":eb(U,a,Z)}var ke;if(O0)e:{switch(e){case"compositionstart":var Ze="onCompositionStart";break e;case"compositionend":Ze="onCompositionEnd";break e;case"compositionupdate":Ze="onCompositionUpdate";break e}Ze=void 0}else Gu?$2(e,a)&&(Ze="onCompositionEnd"):e==="keydown"&&a.keyCode===229&&(Ze="onCompositionStart");Ze&&(N2&&a.locale!=="ko"&&(Gu||Ze!=="onCompositionStart"?Ze==="onCompositionEnd"&&Gu&&(ke=O2()):(zs=Z,D0="value"in zs?zs.value:zs.textContent,Gu=!0)),Ee=Vf(B,Ze),0<Ee.length&&(Ze=new Zx(Ze,e,null,a,Z),U.push({event:Ze,listeners:Ee}),ke?Ze.data=ke:(ke=U2(a),ke!==null&&(Ze.data=ke)))),(ke=aA?sA(e,a):lA(e,a))&&(B=Vf(B,"onBeforeInput"),0<B.length&&(Z=new Zx("onBeforeInput","beforeinput",null,a,Z),U.push({event:Z,listeners:B}),Z.data=ke))}Q2(U,t)})}function _d(e,t,a){return{instance:e,listener:t,currentTarget:a}}function Vf(e,t){for(var a=t+"Capture",u=[];e!==null;){var f=e,v=f.stateNode;f.tag===5&&v!==null&&(f=v,v=hd(e,a),v!=null&&u.unshift(_d(e,v,f)),v=hd(e,t),v!=null&&u.push(_d(e,v,f))),e=e.return}return u}function Bu(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function nb(e,t,a,u,f){for(var v=t._reactName,x=[];a!==null&&a!==u;){var h=a,z=h.alternate,B=h.stateNode;if(z!==null&&z===u)break;h.tag===5&&B!==null&&(h=B,f?(z=hd(a,v),z!=null&&x.unshift(_d(a,z,h))):f||(z=hd(a,v),z!=null&&x.push(_d(a,z,h)))),a=a.return}x.length!==0&&e.push({event:t,listeners:x})}var wA=/\r\n?/g,SA=/\u0000|\uFFFD/g;function ib(e){return(typeof e=="string"?e:""+e).replace(wA,`
`).replace(SA,"")}function tf(e,t,a){if(t=ib(t),ib(e)!==t&&a)throw Error(Le(425))}function qf(){}var E_=null,A_=null;function P_(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var M_=typeof setTimeout=="function"?setTimeout:void 0,TA=typeof clearTimeout=="function"?clearTimeout:void 0,ob=typeof Promise=="function"?Promise:void 0,CA=typeof queueMicrotask=="function"?queueMicrotask:typeof ob<"u"?function(e){return ob.resolve(null).then(e).catch(kA)}:M_;function kA(e){setTimeout(function(){throw e})}function Uy(e,t){var a=t,u=0;do{var f=a.nextSibling;if(e.removeChild(a),f&&f.nodeType===8)if(a=f.data,a==="/$"){if(u===0){e.removeChild(f),fd(t);return}u--}else a!=="$"&&a!=="$?"&&a!=="$!"||u++;a=f}while(a);fd(t)}function Bs(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function ab(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var a=e.data;if(a==="$"||a==="$!"||a==="$?"){if(t===0)return e;t--}else a==="/$"&&t++}e=e.previousSibling}return null}var Tc=Math.random().toString(36).slice(2),sa="__reactFiber$"+Tc,vd="__reactProps$"+Tc,Na="__reactContainer$"+Tc,z_="__reactEvents$"+Tc,IA="__reactListeners$"+Tc,EA="__reactHandles$"+Tc;function Il(e){var t=e[sa];if(t)return t;for(var a=e.parentNode;a;){if(t=a[Na]||a[sa]){if(a=t.alternate,t.child!==null||a!==null&&a.child!==null)for(e=ab(e);e!==null;){if(a=e[sa])return a;e=ab(e)}return t}e=a,a=e.parentNode}return null}function Rd(e){return e=e[sa]||e[Na],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ku(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Le(33))}function mm(e){return e[vd]||null}var L_=[],Xu=-1;function Zs(e){return{current:e}}function Sr(e){0>Xu||(e.current=L_[Xu],L_[Xu]=null,Xu--)}function vr(e,t){Xu++,L_[Xu]=e.current,e.current=t}var Vs={},Yn=Zs(Vs),Ci=Zs(!1),Dl=Vs;function mc(e,t){var a=e.type.contextTypes;if(!a)return Vs;var u=e.stateNode;if(u&&u.__reactInternalMemoizedUnmaskedChildContext===t)return u.__reactInternalMemoizedMaskedChildContext;var f={},v;for(v in a)f[v]=t[v];return u&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=f),f}function ki(e){return e=e.childContextTypes,e!=null}function Zf(){Sr(Ci),Sr(Yn)}function sb(e,t,a){if(Yn.current!==Vs)throw Error(Le(168));vr(Yn,t),vr(Ci,a)}function tS(e,t,a){var u=e.stateNode;if(t=t.childContextTypes,typeof u.getChildContext!="function")return a;u=u.getChildContext();for(var f in u)if(!(f in t))throw Error(Le(108,dE(e)||"Unknown",f));return Dr({},a,u)}function Gf(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Vs,Dl=Yn.current,vr(Yn,e),vr(Ci,Ci.current),!0}function lb(e,t,a){var u=e.stateNode;if(!u)throw Error(Le(169));a?(e=tS(e,t,Dl),u.__reactInternalMemoizedMergedChildContext=e,Sr(Ci),Sr(Yn),vr(Yn,e)):Sr(Ci),vr(Ci,a)}var Ra=null,gm=!1,jy=!1;function rS(e){Ra===null?Ra=[e]:Ra.push(e)}function AA(e){gm=!0,rS(e)}function Gs(){if(!jy&&Ra!==null){jy=!0;var e=0,t=sr;try{var a=Ra;for(sr=1;e<a.length;e++){var u=a[e];do u=u(!0);while(u!==null)}Ra=null,gm=!1}catch(f){throw Ra!==null&&(Ra=Ra.slice(e+1)),I2(M0,Gs),f}finally{sr=t,jy=!1}}return null}var Yu=[],Ju=0,Hf=null,Wf=0,vo=[],xo=0,Fl=null,Da=1,Fa="";function wl(e,t){Yu[Ju++]=Wf,Yu[Ju++]=Hf,Hf=e,Wf=t}function nS(e,t,a){vo[xo++]=Da,vo[xo++]=Fa,vo[xo++]=Fl,Fl=e;var u=Da;e=Fa;var f=32-jo(u)-1;u&=~(1<<f),a+=1;var v=32-jo(t)+f;if(30<v){var x=f-f%5;v=(u&(1<<x)-1).toString(32),u>>=x,f-=x,Da=1<<32-jo(t)+f|a<<f|u,Fa=v+e}else Da=1<<v|a<<f|u,Fa=e}function $0(e){e.return!==null&&(wl(e,1),nS(e,1,0))}function U0(e){for(;e===Hf;)Hf=Yu[--Ju],Yu[Ju]=null,Wf=Yu[--Ju],Yu[Ju]=null;for(;e===Fl;)Fl=vo[--xo],vo[xo]=null,Fa=vo[--xo],vo[xo]=null,Da=vo[--xo],vo[xo]=null}var Yi=null,Xi=null,Ar=!1,Uo=null;function iS(e,t){var a=wo(5,null,null,0);a.elementType="DELETED",a.stateNode=t,a.return=e,t=e.deletions,t===null?(e.deletions=[a],e.flags|=16):t.push(a)}function ub(e,t){switch(e.tag){case 5:var a=e.type;return t=t.nodeType!==1||a.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Yi=e,Xi=Bs(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Yi=e,Xi=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(a=Fl!==null?{id:Da,overflow:Fa}:null,e.memoizedState={dehydrated:t,treeContext:a,retryLane:1073741824},a=wo(18,null,null,0),a.stateNode=t,a.return=e,e.child=a,Yi=e,Xi=null,!0):!1;default:return!1}}function R_(e){return(e.mode&1)!==0&&(e.flags&128)===0}function D_(e){if(Ar){var t=Xi;if(t){var a=t;if(!ub(e,t)){if(R_(e))throw Error(Le(418));t=Bs(a.nextSibling);var u=Yi;t&&ub(e,t)?iS(u,a):(e.flags=e.flags&-4097|2,Ar=!1,Yi=e)}}else{if(R_(e))throw Error(Le(418));e.flags=e.flags&-4097|2,Ar=!1,Yi=e}}}function cb(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Yi=e}function rf(e){if(e!==Yi)return!1;if(!Ar)return cb(e),Ar=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!P_(e.type,e.memoizedProps)),t&&(t=Xi)){if(R_(e))throw oS(),Error(Le(418));for(;t;)iS(e,t),t=Bs(t.nextSibling)}if(cb(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Le(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var a=e.data;if(a==="/$"){if(t===0){Xi=Bs(e.nextSibling);break e}t--}else a!=="$"&&a!=="$!"&&a!=="$?"||t++}e=e.nextSibling}Xi=null}}else Xi=Yi?Bs(e.stateNode.nextSibling):null;return!0}function oS(){for(var e=Xi;e;)e=Bs(e.nextSibling)}function gc(){Xi=Yi=null,Ar=!1}function j0(e){Uo===null?Uo=[e]:Uo.push(e)}var PA=qa.ReactCurrentBatchConfig;function jh(e,t,a){if(e=a.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(a._owner){if(a=a._owner,a){if(a.tag!==1)throw Error(Le(309));var u=a.stateNode}if(!u)throw Error(Le(147,e));var f=u,v=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===v?t.ref:(t=function(x){var h=f.refs;x===null?delete h[v]:h[v]=x},t._stringRef=v,t)}if(typeof e!="string")throw Error(Le(284));if(!a._owner)throw Error(Le(290,e))}return e}function nf(e,t){throw e=Object.prototype.toString.call(t),Error(Le(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function hb(e){var t=e._init;return t(e._payload)}function aS(e){function t(te,H){if(e){var ie=te.deletions;ie===null?(te.deletions=[H],te.flags|=16):ie.push(H)}}function a(te,H){if(!e)return null;for(;H!==null;)t(te,H),H=H.sibling;return null}function u(te,H){for(te=new Map;H!==null;)H.key!==null?te.set(H.key,H):te.set(H.index,H),H=H.sibling;return te}function f(te,H){return te=Us(te,H),te.index=0,te.sibling=null,te}function v(te,H,ie){return te.index=ie,e?(ie=te.alternate,ie!==null?(ie=ie.index,ie<H?(te.flags|=2,H):ie):(te.flags|=2,H)):(te.flags|=1048576,H)}function x(te){return e&&te.alternate===null&&(te.flags|=2),te}function h(te,H,ie,_e){return H===null||H.tag!==6?(H=Ky(ie,te.mode,_e),H.return=te,H):(H=f(H,ie),H.return=te,H)}function z(te,H,ie,_e){var Se=ie.type;return Se===Zu?Z(te,H,ie.props.children,_e,ie.key):H!==null&&(H.elementType===Se||typeof Se=="object"&&Se!==null&&Se.$$typeof===Is&&hb(Se)===H.type)?(_e=f(H,ie.props),_e.ref=jh(te,H,ie),_e.return=te,_e):(_e=kf(ie.type,ie.key,ie.props,null,te.mode,_e),_e.ref=jh(te,H,ie),_e.return=te,_e)}function B(te,H,ie,_e){return H===null||H.tag!==4||H.stateNode.containerInfo!==ie.containerInfo||H.stateNode.implementation!==ie.implementation?(H=Xy(ie,te.mode,_e),H.return=te,H):(H=f(H,ie.children||[]),H.return=te,H)}function Z(te,H,ie,_e,Se){return H===null||H.tag!==7?(H=zl(ie,te.mode,_e,Se),H.return=te,H):(H=f(H,ie),H.return=te,H)}function U(te,H,ie){if(typeof H=="string"&&H!==""||typeof H=="number")return H=Ky(""+H,te.mode,ie),H.return=te,H;if(typeof H=="object"&&H!==null){switch(H.$$typeof){case Gp:return ie=kf(H.type,H.key,H.props,null,te.mode,ie),ie.ref=jh(te,null,H),ie.return=te,ie;case qu:return H=Xy(H,te.mode,ie),H.return=te,H;case Is:var _e=H._init;return U(te,_e(H._payload),ie)}if(Wh(H)||Bh(H))return H=zl(H,te.mode,ie,null),H.return=te,H;nf(te,H)}return null}function O(te,H,ie,_e){var Se=H!==null?H.key:null;if(typeof ie=="string"&&ie!==""||typeof ie=="number")return Se!==null?null:h(te,H,""+ie,_e);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case Gp:return ie.key===Se?z(te,H,ie,_e):null;case qu:return ie.key===Se?B(te,H,ie,_e):null;case Is:return Se=ie._init,O(te,H,Se(ie._payload),_e)}if(Wh(ie)||Bh(ie))return Se!==null?null:Z(te,H,ie,_e,null);nf(te,ie)}return null}function de(te,H,ie,_e,Se){if(typeof _e=="string"&&_e!==""||typeof _e=="number")return te=te.get(ie)||null,h(H,te,""+_e,Se);if(typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case Gp:return te=te.get(_e.key===null?ie:_e.key)||null,z(H,te,_e,Se);case qu:return te=te.get(_e.key===null?ie:_e.key)||null,B(H,te,_e,Se);case Is:var Ee=_e._init;return de(te,H,ie,Ee(_e._payload),Se)}if(Wh(_e)||Bh(_e))return te=te.get(ie)||null,Z(H,te,_e,Se,null);nf(H,_e)}return null}function he(te,H,ie,_e){for(var Se=null,Ee=null,ke=H,Ze=H=0,mt=null;ke!==null&&Ze<ie.length;Ze++){ke.index>Ze?(mt=ke,ke=null):mt=ke.sibling;var tt=O(te,ke,ie[Ze],_e);if(tt===null){ke===null&&(ke=mt);break}e&&ke&&tt.alternate===null&&t(te,ke),H=v(tt,H,Ze),Ee===null?Se=tt:Ee.sibling=tt,Ee=tt,ke=mt}if(Ze===ie.length)return a(te,ke),Ar&&wl(te,Ze),Se;if(ke===null){for(;Ze<ie.length;Ze++)ke=U(te,ie[Ze],_e),ke!==null&&(H=v(ke,H,Ze),Ee===null?Se=ke:Ee.sibling=ke,Ee=ke);return Ar&&wl(te,Ze),Se}for(ke=u(te,ke);Ze<ie.length;Ze++)mt=de(ke,te,Ze,ie[Ze],_e),mt!==null&&(e&&mt.alternate!==null&&ke.delete(mt.key===null?Ze:mt.key),H=v(mt,H,Ze),Ee===null?Se=mt:Ee.sibling=mt,Ee=mt);return e&&ke.forEach(function(ot){return t(te,ot)}),Ar&&wl(te,Ze),Se}function ae(te,H,ie,_e){var Se=Bh(ie);if(typeof Se!="function")throw Error(Le(150));if(ie=Se.call(ie),ie==null)throw Error(Le(151));for(var Ee=Se=null,ke=H,Ze=H=0,mt=null,tt=ie.next();ke!==null&&!tt.done;Ze++,tt=ie.next()){ke.index>Ze?(mt=ke,ke=null):mt=ke.sibling;var ot=O(te,ke,tt.value,_e);if(ot===null){ke===null&&(ke=mt);break}e&&ke&&ot.alternate===null&&t(te,ke),H=v(ot,H,Ze),Ee===null?Se=ot:Ee.sibling=ot,Ee=ot,ke=mt}if(tt.done)return a(te,ke),Ar&&wl(te,Ze),Se;if(ke===null){for(;!tt.done;Ze++,tt=ie.next())tt=U(te,tt.value,_e),tt!==null&&(H=v(tt,H,Ze),Ee===null?Se=tt:Ee.sibling=tt,Ee=tt);return Ar&&wl(te,Ze),Se}for(ke=u(te,ke);!tt.done;Ze++,tt=ie.next())tt=de(ke,te,Ze,tt.value,_e),tt!==null&&(e&&tt.alternate!==null&&ke.delete(tt.key===null?Ze:tt.key),H=v(tt,H,Ze),Ee===null?Se=tt:Ee.sibling=tt,Ee=tt);return e&&ke.forEach(function($t){return t(te,$t)}),Ar&&wl(te,Ze),Se}function Ae(te,H,ie,_e){if(typeof ie=="object"&&ie!==null&&ie.type===Zu&&ie.key===null&&(ie=ie.props.children),typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case Gp:e:{for(var Se=ie.key,Ee=H;Ee!==null;){if(Ee.key===Se){if(Se=ie.type,Se===Zu){if(Ee.tag===7){a(te,Ee.sibling),H=f(Ee,ie.props.children),H.return=te,te=H;break e}}else if(Ee.elementType===Se||typeof Se=="object"&&Se!==null&&Se.$$typeof===Is&&hb(Se)===Ee.type){a(te,Ee.sibling),H=f(Ee,ie.props),H.ref=jh(te,Ee,ie),H.return=te,te=H;break e}a(te,Ee);break}else t(te,Ee);Ee=Ee.sibling}ie.type===Zu?(H=zl(ie.props.children,te.mode,_e,ie.key),H.return=te,te=H):(_e=kf(ie.type,ie.key,ie.props,null,te.mode,_e),_e.ref=jh(te,H,ie),_e.return=te,te=_e)}return x(te);case qu:e:{for(Ee=ie.key;H!==null;){if(H.key===Ee)if(H.tag===4&&H.stateNode.containerInfo===ie.containerInfo&&H.stateNode.implementation===ie.implementation){a(te,H.sibling),H=f(H,ie.children||[]),H.return=te,te=H;break e}else{a(te,H);break}else t(te,H);H=H.sibling}H=Xy(ie,te.mode,_e),H.return=te,te=H}return x(te);case Is:return Ee=ie._init,Ae(te,H,Ee(ie._payload),_e)}if(Wh(ie))return he(te,H,ie,_e);if(Bh(ie))return ae(te,H,ie,_e);nf(te,ie)}return typeof ie=="string"&&ie!==""||typeof ie=="number"?(ie=""+ie,H!==null&&H.tag===6?(a(te,H.sibling),H=f(H,ie),H.return=te,te=H):(a(te,H),H=Ky(ie,te.mode,_e),H.return=te,te=H),x(te)):a(te,H)}return Ae}var yc=aS(!0),sS=aS(!1),Kf=Zs(null),Xf=null,Qu=null,V0=null;function q0(){V0=Qu=Xf=null}function Z0(e){var t=Kf.current;Sr(Kf),e._currentValue=t}function F_(e,t,a){for(;e!==null;){var u=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,u!==null&&(u.childLanes|=t)):u!==null&&(u.childLanes&t)!==t&&(u.childLanes|=t),e===a)break;e=e.return}}function ac(e,t){Xf=e,V0=Qu=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Ti=!0),e.firstContext=null)}function To(e){var t=e._currentValue;if(V0!==e)if(e={context:e,memoizedValue:t,next:null},Qu===null){if(Xf===null)throw Error(Le(308));Qu=e,Xf.dependencies={lanes:0,firstContext:e}}else Qu=Qu.next=e;return t}var El=null;function G0(e){El===null?El=[e]:El.push(e)}function lS(e,t,a,u){var f=t.interleaved;return f===null?(a.next=a,G0(t)):(a.next=f.next,f.next=a),t.interleaved=a,$a(e,u)}function $a(e,t){e.lanes|=t;var a=e.alternate;for(a!==null&&(a.lanes|=t),a=e,e=e.return;e!==null;)e.childLanes|=t,a=e.alternate,a!==null&&(a.childLanes|=t),a=e,e=e.return;return a.tag===3?a.stateNode:null}var Es=!1;function H0(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function uS(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ba(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Os(e,t,a){var u=e.updateQueue;if(u===null)return null;if(u=u.shared,Gt&2){var f=u.pending;return f===null?t.next=t:(t.next=f.next,f.next=t),u.pending=t,$a(e,a)}return f=u.interleaved,f===null?(t.next=t,G0(u)):(t.next=f.next,f.next=t),u.interleaved=t,$a(e,a)}function xf(e,t,a){if(t=t.updateQueue,t!==null&&(t=t.shared,(a&4194240)!==0)){var u=t.lanes;u&=e.pendingLanes,a|=u,t.lanes=a,z0(e,a)}}function db(e,t){var a=e.updateQueue,u=e.alternate;if(u!==null&&(u=u.updateQueue,a===u)){var f=null,v=null;if(a=a.firstBaseUpdate,a!==null){do{var x={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null};v===null?f=v=x:v=v.next=x,a=a.next}while(a!==null);v===null?f=v=t:v=v.next=t}else f=v=t;a={baseState:u.baseState,firstBaseUpdate:f,lastBaseUpdate:v,shared:u.shared,effects:u.effects},e.updateQueue=a;return}e=a.lastBaseUpdate,e===null?a.firstBaseUpdate=t:e.next=t,a.lastBaseUpdate=t}function Yf(e,t,a,u){var f=e.updateQueue;Es=!1;var v=f.firstBaseUpdate,x=f.lastBaseUpdate,h=f.shared.pending;if(h!==null){f.shared.pending=null;var z=h,B=z.next;z.next=null,x===null?v=B:x.next=B,x=z;var Z=e.alternate;Z!==null&&(Z=Z.updateQueue,h=Z.lastBaseUpdate,h!==x&&(h===null?Z.firstBaseUpdate=B:h.next=B,Z.lastBaseUpdate=z))}if(v!==null){var U=f.baseState;x=0,Z=B=z=null,h=v;do{var O=h.lane,de=h.eventTime;if((u&O)===O){Z!==null&&(Z=Z.next={eventTime:de,lane:0,tag:h.tag,payload:h.payload,callback:h.callback,next:null});e:{var he=e,ae=h;switch(O=t,de=a,ae.tag){case 1:if(he=ae.payload,typeof he=="function"){U=he.call(de,U,O);break e}U=he;break e;case 3:he.flags=he.flags&-65537|128;case 0:if(he=ae.payload,O=typeof he=="function"?he.call(de,U,O):he,O==null)break e;U=Dr({},U,O);break e;case 2:Es=!0}}h.callback!==null&&h.lane!==0&&(e.flags|=64,O=f.effects,O===null?f.effects=[h]:O.push(h))}else de={eventTime:de,lane:O,tag:h.tag,payload:h.payload,callback:h.callback,next:null},Z===null?(B=Z=de,z=U):Z=Z.next=de,x|=O;if(h=h.next,h===null){if(h=f.shared.pending,h===null)break;O=h,h=O.next,O.next=null,f.lastBaseUpdate=O,f.shared.pending=null}}while(!0);if(Z===null&&(z=U),f.baseState=z,f.firstBaseUpdate=B,f.lastBaseUpdate=Z,t=f.shared.interleaved,t!==null){f=t;do x|=f.lane,f=f.next;while(f!==t)}else v===null&&(f.shared.lanes=0);Ol|=x,e.lanes=x,e.memoizedState=U}}function pb(e,t,a){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var u=e[t],f=u.callback;if(f!==null){if(u.callback=null,u=a,typeof f!="function")throw Error(Le(191,f));f.call(u)}}}var Dd={},ua=Zs(Dd),xd=Zs(Dd),bd=Zs(Dd);function Al(e){if(e===Dd)throw Error(Le(174));return e}function W0(e,t){switch(vr(bd,t),vr(xd,e),vr(ua,Dd),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:g_(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=g_(t,e)}Sr(ua),vr(ua,t)}function _c(){Sr(ua),Sr(xd),Sr(bd)}function cS(e){Al(bd.current);var t=Al(ua.current),a=g_(t,e.type);t!==a&&(vr(xd,e),vr(ua,a))}function K0(e){xd.current===e&&(Sr(ua),Sr(xd))}var Lr=Zs(0);function Jf(e){for(var t=e;t!==null;){if(t.tag===13){var a=t.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||a.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Vy=[];function X0(){for(var e=0;e<Vy.length;e++)Vy[e]._workInProgressVersionPrimary=null;Vy.length=0}var bf=qa.ReactCurrentDispatcher,qy=qa.ReactCurrentBatchConfig,Bl=0,Rr=null,cn=null,bn=null,Qf=!1,id=!1,wd=0,MA=0;function Hn(){throw Error(Le(321))}function Y0(e,t){if(t===null)return!1;for(var a=0;a<t.length&&a<e.length;a++)if(!qo(e[a],t[a]))return!1;return!0}function J0(e,t,a,u,f,v){if(Bl=v,Rr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,bf.current=e===null||e.memoizedState===null?DA:FA,e=a(u,f),id){v=0;do{if(id=!1,wd=0,25<=v)throw Error(Le(301));v+=1,bn=cn=null,t.updateQueue=null,bf.current=BA,e=a(u,f)}while(id)}if(bf.current=em,t=cn!==null&&cn.next!==null,Bl=0,bn=cn=Rr=null,Qf=!1,t)throw Error(Le(300));return e}function Q0(){var e=wd!==0;return wd=0,e}function na(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return bn===null?Rr.memoizedState=bn=e:bn=bn.next=e,bn}function Co(){if(cn===null){var e=Rr.alternate;e=e!==null?e.memoizedState:null}else e=cn.next;var t=bn===null?Rr.memoizedState:bn.next;if(t!==null)bn=t,cn=e;else{if(e===null)throw Error(Le(310));cn=e,e={memoizedState:cn.memoizedState,baseState:cn.baseState,baseQueue:cn.baseQueue,queue:cn.queue,next:null},bn===null?Rr.memoizedState=bn=e:bn=bn.next=e}return bn}function Sd(e,t){return typeof t=="function"?t(e):t}function Zy(e){var t=Co(),a=t.queue;if(a===null)throw Error(Le(311));a.lastRenderedReducer=e;var u=cn,f=u.baseQueue,v=a.pending;if(v!==null){if(f!==null){var x=f.next;f.next=v.next,v.next=x}u.baseQueue=f=v,a.pending=null}if(f!==null){v=f.next,u=u.baseState;var h=x=null,z=null,B=v;do{var Z=B.lane;if((Bl&Z)===Z)z!==null&&(z=z.next={lane:0,action:B.action,hasEagerState:B.hasEagerState,eagerState:B.eagerState,next:null}),u=B.hasEagerState?B.eagerState:e(u,B.action);else{var U={lane:Z,action:B.action,hasEagerState:B.hasEagerState,eagerState:B.eagerState,next:null};z===null?(h=z=U,x=u):z=z.next=U,Rr.lanes|=Z,Ol|=Z}B=B.next}while(B!==null&&B!==v);z===null?x=u:z.next=h,qo(u,t.memoizedState)||(Ti=!0),t.memoizedState=u,t.baseState=x,t.baseQueue=z,a.lastRenderedState=u}if(e=a.interleaved,e!==null){f=e;do v=f.lane,Rr.lanes|=v,Ol|=v,f=f.next;while(f!==e)}else f===null&&(a.lanes=0);return[t.memoizedState,a.dispatch]}function Gy(e){var t=Co(),a=t.queue;if(a===null)throw Error(Le(311));a.lastRenderedReducer=e;var u=a.dispatch,f=a.pending,v=t.memoizedState;if(f!==null){a.pending=null;var x=f=f.next;do v=e(v,x.action),x=x.next;while(x!==f);qo(v,t.memoizedState)||(Ti=!0),t.memoizedState=v,t.baseQueue===null&&(t.baseState=v),a.lastRenderedState=v}return[v,u]}function hS(){}function dS(e,t){var a=Rr,u=Co(),f=t(),v=!qo(u.memoizedState,f);if(v&&(u.memoizedState=f,Ti=!0),u=u.queue,ev(mS.bind(null,a,u,e),[e]),u.getSnapshot!==t||v||bn!==null&&bn.memoizedState.tag&1){if(a.flags|=2048,Td(9,fS.bind(null,a,u,f,t),void 0,null),Sn===null)throw Error(Le(349));Bl&30||pS(a,t,f)}return f}function pS(e,t,a){e.flags|=16384,e={getSnapshot:t,value:a},t=Rr.updateQueue,t===null?(t={lastEffect:null,stores:null},Rr.updateQueue=t,t.stores=[e]):(a=t.stores,a===null?t.stores=[e]:a.push(e))}function fS(e,t,a,u){t.value=a,t.getSnapshot=u,gS(t)&&yS(e)}function mS(e,t,a){return a(function(){gS(t)&&yS(e)})}function gS(e){var t=e.getSnapshot;e=e.value;try{var a=t();return!qo(e,a)}catch{return!0}}function yS(e){var t=$a(e,1);t!==null&&Vo(t,e,1,-1)}function fb(e){var t=na();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Sd,lastRenderedState:e},t.queue=e,e=e.dispatch=RA.bind(null,Rr,e),[t.memoizedState,e]}function Td(e,t,a,u){return e={tag:e,create:t,destroy:a,deps:u,next:null},t=Rr.updateQueue,t===null?(t={lastEffect:null,stores:null},Rr.updateQueue=t,t.lastEffect=e.next=e):(a=t.lastEffect,a===null?t.lastEffect=e.next=e:(u=a.next,a.next=e,e.next=u,t.lastEffect=e)),e}function _S(){return Co().memoizedState}function wf(e,t,a,u){var f=na();Rr.flags|=e,f.memoizedState=Td(1|t,a,void 0,u===void 0?null:u)}function ym(e,t,a,u){var f=Co();u=u===void 0?null:u;var v=void 0;if(cn!==null){var x=cn.memoizedState;if(v=x.destroy,u!==null&&Y0(u,x.deps)){f.memoizedState=Td(t,a,v,u);return}}Rr.flags|=e,f.memoizedState=Td(1|t,a,v,u)}function mb(e,t){return wf(8390656,8,e,t)}function ev(e,t){return ym(2048,8,e,t)}function vS(e,t){return ym(4,2,e,t)}function xS(e,t){return ym(4,4,e,t)}function bS(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function wS(e,t,a){return a=a!=null?a.concat([e]):null,ym(4,4,bS.bind(null,t,e),a)}function tv(){}function SS(e,t){var a=Co();t=t===void 0?null:t;var u=a.memoizedState;return u!==null&&t!==null&&Y0(t,u[1])?u[0]:(a.memoizedState=[e,t],e)}function TS(e,t){var a=Co();t=t===void 0?null:t;var u=a.memoizedState;return u!==null&&t!==null&&Y0(t,u[1])?u[0]:(e=e(),a.memoizedState=[e,t],e)}function CS(e,t,a){return Bl&21?(qo(a,t)||(a=P2(),Rr.lanes|=a,Ol|=a,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Ti=!0),e.memoizedState=a)}function zA(e,t){var a=sr;sr=a!==0&&4>a?a:4,e(!0);var u=qy.transition;qy.transition={};try{e(!1),t()}finally{sr=a,qy.transition=u}}function kS(){return Co().memoizedState}function LA(e,t,a){var u=$s(e);if(a={lane:u,action:a,hasEagerState:!1,eagerState:null,next:null},IS(e))ES(t,a);else if(a=lS(e,t,a,u),a!==null){var f=ci();Vo(a,e,u,f),AS(a,t,u)}}function RA(e,t,a){var u=$s(e),f={lane:u,action:a,hasEagerState:!1,eagerState:null,next:null};if(IS(e))ES(t,f);else{var v=e.alternate;if(e.lanes===0&&(v===null||v.lanes===0)&&(v=t.lastRenderedReducer,v!==null))try{var x=t.lastRenderedState,h=v(x,a);if(f.hasEagerState=!0,f.eagerState=h,qo(h,x)){var z=t.interleaved;z===null?(f.next=f,G0(t)):(f.next=z.next,z.next=f),t.interleaved=f;return}}catch{}finally{}a=lS(e,t,f,u),a!==null&&(f=ci(),Vo(a,e,u,f),AS(a,t,u))}}function IS(e){var t=e.alternate;return e===Rr||t!==null&&t===Rr}function ES(e,t){id=Qf=!0;var a=e.pending;a===null?t.next=t:(t.next=a.next,a.next=t),e.pending=t}function AS(e,t,a){if(a&4194240){var u=t.lanes;u&=e.pendingLanes,a|=u,t.lanes=a,z0(e,a)}}var em={readContext:To,useCallback:Hn,useContext:Hn,useEffect:Hn,useImperativeHandle:Hn,useInsertionEffect:Hn,useLayoutEffect:Hn,useMemo:Hn,useReducer:Hn,useRef:Hn,useState:Hn,useDebugValue:Hn,useDeferredValue:Hn,useTransition:Hn,useMutableSource:Hn,useSyncExternalStore:Hn,useId:Hn,unstable_isNewReconciler:!1},DA={readContext:To,useCallback:function(e,t){return na().memoizedState=[e,t===void 0?null:t],e},useContext:To,useEffect:mb,useImperativeHandle:function(e,t,a){return a=a!=null?a.concat([e]):null,wf(4194308,4,bS.bind(null,t,e),a)},useLayoutEffect:function(e,t){return wf(4194308,4,e,t)},useInsertionEffect:function(e,t){return wf(4,2,e,t)},useMemo:function(e,t){var a=na();return t=t===void 0?null:t,e=e(),a.memoizedState=[e,t],e},useReducer:function(e,t,a){var u=na();return t=a!==void 0?a(t):t,u.memoizedState=u.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},u.queue=e,e=e.dispatch=LA.bind(null,Rr,e),[u.memoizedState,e]},useRef:function(e){var t=na();return e={current:e},t.memoizedState=e},useState:fb,useDebugValue:tv,useDeferredValue:function(e){return na().memoizedState=e},useTransition:function(){var e=fb(!1),t=e[0];return e=zA.bind(null,e[1]),na().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,a){var u=Rr,f=na();if(Ar){if(a===void 0)throw Error(Le(407));a=a()}else{if(a=t(),Sn===null)throw Error(Le(349));Bl&30||pS(u,t,a)}f.memoizedState=a;var v={value:a,getSnapshot:t};return f.queue=v,mb(mS.bind(null,u,v,e),[e]),u.flags|=2048,Td(9,fS.bind(null,u,v,a,t),void 0,null),a},useId:function(){var e=na(),t=Sn.identifierPrefix;if(Ar){var a=Fa,u=Da;a=(u&~(1<<32-jo(u)-1)).toString(32)+a,t=":"+t+"R"+a,a=wd++,0<a&&(t+="H"+a.toString(32)),t+=":"}else a=MA++,t=":"+t+"r"+a.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},FA={readContext:To,useCallback:SS,useContext:To,useEffect:ev,useImperativeHandle:wS,useInsertionEffect:vS,useLayoutEffect:xS,useMemo:TS,useReducer:Zy,useRef:_S,useState:function(){return Zy(Sd)},useDebugValue:tv,useDeferredValue:function(e){var t=Co();return CS(t,cn.memoizedState,e)},useTransition:function(){var e=Zy(Sd)[0],t=Co().memoizedState;return[e,t]},useMutableSource:hS,useSyncExternalStore:dS,useId:kS,unstable_isNewReconciler:!1},BA={readContext:To,useCallback:SS,useContext:To,useEffect:ev,useImperativeHandle:wS,useInsertionEffect:vS,useLayoutEffect:xS,useMemo:TS,useReducer:Gy,useRef:_S,useState:function(){return Gy(Sd)},useDebugValue:tv,useDeferredValue:function(e){var t=Co();return cn===null?t.memoizedState=e:CS(t,cn.memoizedState,e)},useTransition:function(){var e=Gy(Sd)[0],t=Co().memoizedState;return[e,t]},useMutableSource:hS,useSyncExternalStore:dS,useId:kS,unstable_isNewReconciler:!1};function No(e,t){if(e&&e.defaultProps){t=Dr({},t),e=e.defaultProps;for(var a in e)t[a]===void 0&&(t[a]=e[a]);return t}return t}function B_(e,t,a,u){t=e.memoizedState,a=a(u,t),a=a==null?t:Dr({},t,a),e.memoizedState=a,e.lanes===0&&(e.updateQueue.baseState=a)}var _m={isMounted:function(e){return(e=e._reactInternals)?Ul(e)===e:!1},enqueueSetState:function(e,t,a){e=e._reactInternals;var u=ci(),f=$s(e),v=Ba(u,f);v.payload=t,a!=null&&(v.callback=a),t=Os(e,v,f),t!==null&&(Vo(t,e,f,u),xf(t,e,f))},enqueueReplaceState:function(e,t,a){e=e._reactInternals;var u=ci(),f=$s(e),v=Ba(u,f);v.tag=1,v.payload=t,a!=null&&(v.callback=a),t=Os(e,v,f),t!==null&&(Vo(t,e,f,u),xf(t,e,f))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var a=ci(),u=$s(e),f=Ba(a,u);f.tag=2,t!=null&&(f.callback=t),t=Os(e,f,u),t!==null&&(Vo(t,e,u,a),xf(t,e,u))}};function gb(e,t,a,u,f,v,x){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(u,v,x):t.prototype&&t.prototype.isPureReactComponent?!gd(a,u)||!gd(f,v):!0}function PS(e,t,a){var u=!1,f=Vs,v=t.contextType;return typeof v=="object"&&v!==null?v=To(v):(f=ki(t)?Dl:Yn.current,u=t.contextTypes,v=(u=u!=null)?mc(e,f):Vs),t=new t(a,v),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=_m,e.stateNode=t,t._reactInternals=e,u&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=f,e.__reactInternalMemoizedMaskedChildContext=v),t}function yb(e,t,a,u){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(a,u),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(a,u),t.state!==e&&_m.enqueueReplaceState(t,t.state,null)}function O_(e,t,a,u){var f=e.stateNode;f.props=a,f.state=e.memoizedState,f.refs={},H0(e);var v=t.contextType;typeof v=="object"&&v!==null?f.context=To(v):(v=ki(t)?Dl:Yn.current,f.context=mc(e,v)),f.state=e.memoizedState,v=t.getDerivedStateFromProps,typeof v=="function"&&(B_(e,t,v,a),f.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(t=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),t!==f.state&&_m.enqueueReplaceState(f,f.state,null),Yf(e,a,f,u),f.state=e.memoizedState),typeof f.componentDidMount=="function"&&(e.flags|=4194308)}function vc(e,t){try{var a="",u=t;do a+=hE(u),u=u.return;while(u);var f=a}catch(v){f=`
Error generating stack: `+v.message+`
`+v.stack}return{value:e,source:t,stack:f,digest:null}}function Hy(e,t,a){return{value:e,source:null,stack:a??null,digest:t??null}}function N_(e,t){try{console.error(t.value)}catch(a){setTimeout(function(){throw a})}}var OA=typeof WeakMap=="function"?WeakMap:Map;function MS(e,t,a){a=Ba(-1,a),a.tag=3,a.payload={element:null};var u=t.value;return a.callback=function(){rm||(rm=!0,K_=u),N_(e,t)},a}function zS(e,t,a){a=Ba(-1,a),a.tag=3;var u=e.type.getDerivedStateFromError;if(typeof u=="function"){var f=t.value;a.payload=function(){return u(f)},a.callback=function(){N_(e,t)}}var v=e.stateNode;return v!==null&&typeof v.componentDidCatch=="function"&&(a.callback=function(){N_(e,t),typeof u!="function"&&(Ns===null?Ns=new Set([this]):Ns.add(this));var x=t.stack;this.componentDidCatch(t.value,{componentStack:x!==null?x:""})}),a}function _b(e,t,a){var u=e.pingCache;if(u===null){u=e.pingCache=new OA;var f=new Set;u.set(t,f)}else f=u.get(t),f===void 0&&(f=new Set,u.set(t,f));f.has(a)||(f.add(a),e=JA.bind(null,e,t,a),t.then(e,e))}function vb(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function xb(e,t,a,u,f){return e.mode&1?(e.flags|=65536,e.lanes=f,e):(e===t?e.flags|=65536:(e.flags|=128,a.flags|=131072,a.flags&=-52805,a.tag===1&&(a.alternate===null?a.tag=17:(t=Ba(-1,1),t.tag=2,Os(a,t,1))),a.lanes|=1),e)}var NA=qa.ReactCurrentOwner,Ti=!1;function ui(e,t,a,u){t.child=e===null?sS(t,null,a,u):yc(t,e.child,a,u)}function bb(e,t,a,u,f){a=a.render;var v=t.ref;return ac(t,f),u=J0(e,t,a,u,v,f),a=Q0(),e!==null&&!Ti?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~f,Ua(e,t,f)):(Ar&&a&&$0(t),t.flags|=1,ui(e,t,u,f),t.child)}function wb(e,t,a,u,f){if(e===null){var v=a.type;return typeof v=="function"&&!uv(v)&&v.defaultProps===void 0&&a.compare===null&&a.defaultProps===void 0?(t.tag=15,t.type=v,LS(e,t,v,u,f)):(e=kf(a.type,null,u,t,t.mode,f),e.ref=t.ref,e.return=t,t.child=e)}if(v=e.child,!(e.lanes&f)){var x=v.memoizedProps;if(a=a.compare,a=a!==null?a:gd,a(x,u)&&e.ref===t.ref)return Ua(e,t,f)}return t.flags|=1,e=Us(v,u),e.ref=t.ref,e.return=t,t.child=e}function LS(e,t,a,u,f){if(e!==null){var v=e.memoizedProps;if(gd(v,u)&&e.ref===t.ref)if(Ti=!1,t.pendingProps=u=v,(e.lanes&f)!==0)e.flags&131072&&(Ti=!0);else return t.lanes=e.lanes,Ua(e,t,f)}return $_(e,t,a,u,f)}function RS(e,t,a){var u=t.pendingProps,f=u.children,v=e!==null?e.memoizedState:null;if(u.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},vr(tc,Wi),Wi|=a;else{if(!(a&1073741824))return e=v!==null?v.baseLanes|a:a,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,vr(tc,Wi),Wi|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},u=v!==null?v.baseLanes:a,vr(tc,Wi),Wi|=u}else v!==null?(u=v.baseLanes|a,t.memoizedState=null):u=a,vr(tc,Wi),Wi|=u;return ui(e,t,f,a),t.child}function DS(e,t){var a=t.ref;(e===null&&a!==null||e!==null&&e.ref!==a)&&(t.flags|=512,t.flags|=2097152)}function $_(e,t,a,u,f){var v=ki(a)?Dl:Yn.current;return v=mc(t,v),ac(t,f),a=J0(e,t,a,u,v,f),u=Q0(),e!==null&&!Ti?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~f,Ua(e,t,f)):(Ar&&u&&$0(t),t.flags|=1,ui(e,t,a,f),t.child)}function Sb(e,t,a,u,f){if(ki(a)){var v=!0;Gf(t)}else v=!1;if(ac(t,f),t.stateNode===null)Sf(e,t),PS(t,a,u),O_(t,a,u,f),u=!0;else if(e===null){var x=t.stateNode,h=t.memoizedProps;x.props=h;var z=x.context,B=a.contextType;typeof B=="object"&&B!==null?B=To(B):(B=ki(a)?Dl:Yn.current,B=mc(t,B));var Z=a.getDerivedStateFromProps,U=typeof Z=="function"||typeof x.getSnapshotBeforeUpdate=="function";U||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(h!==u||z!==B)&&yb(t,x,u,B),Es=!1;var O=t.memoizedState;x.state=O,Yf(t,u,x,f),z=t.memoizedState,h!==u||O!==z||Ci.current||Es?(typeof Z=="function"&&(B_(t,a,Z,u),z=t.memoizedState),(h=Es||gb(t,a,h,u,O,z,B))?(U||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(t.flags|=4194308)):(typeof x.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=u,t.memoizedState=z),x.props=u,x.state=z,x.context=B,u=h):(typeof x.componentDidMount=="function"&&(t.flags|=4194308),u=!1)}else{x=t.stateNode,uS(e,t),h=t.memoizedProps,B=t.type===t.elementType?h:No(t.type,h),x.props=B,U=t.pendingProps,O=x.context,z=a.contextType,typeof z=="object"&&z!==null?z=To(z):(z=ki(a)?Dl:Yn.current,z=mc(t,z));var de=a.getDerivedStateFromProps;(Z=typeof de=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(h!==U||O!==z)&&yb(t,x,u,z),Es=!1,O=t.memoizedState,x.state=O,Yf(t,u,x,f);var he=t.memoizedState;h!==U||O!==he||Ci.current||Es?(typeof de=="function"&&(B_(t,a,de,u),he=t.memoizedState),(B=Es||gb(t,a,B,u,O,he,z)||!1)?(Z||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(u,he,z),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(u,he,z)),typeof x.componentDidUpdate=="function"&&(t.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof x.componentDidUpdate!="function"||h===e.memoizedProps&&O===e.memoizedState||(t.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||h===e.memoizedProps&&O===e.memoizedState||(t.flags|=1024),t.memoizedProps=u,t.memoizedState=he),x.props=u,x.state=he,x.context=z,u=B):(typeof x.componentDidUpdate!="function"||h===e.memoizedProps&&O===e.memoizedState||(t.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||h===e.memoizedProps&&O===e.memoizedState||(t.flags|=1024),u=!1)}return U_(e,t,a,u,v,f)}function U_(e,t,a,u,f,v){DS(e,t);var x=(t.flags&128)!==0;if(!u&&!x)return f&&lb(t,a,!1),Ua(e,t,v);u=t.stateNode,NA.current=t;var h=x&&typeof a.getDerivedStateFromError!="function"?null:u.render();return t.flags|=1,e!==null&&x?(t.child=yc(t,e.child,null,v),t.child=yc(t,null,h,v)):ui(e,t,h,v),t.memoizedState=u.state,f&&lb(t,a,!0),t.child}function FS(e){var t=e.stateNode;t.pendingContext?sb(e,t.pendingContext,t.pendingContext!==t.context):t.context&&sb(e,t.context,!1),W0(e,t.containerInfo)}function Tb(e,t,a,u,f){return gc(),j0(f),t.flags|=256,ui(e,t,a,u),t.child}var j_={dehydrated:null,treeContext:null,retryLane:0};function V_(e){return{baseLanes:e,cachePool:null,transitions:null}}function BS(e,t,a){var u=t.pendingProps,f=Lr.current,v=!1,x=(t.flags&128)!==0,h;if((h=x)||(h=e!==null&&e.memoizedState===null?!1:(f&2)!==0),h?(v=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(f|=1),vr(Lr,f&1),e===null)return D_(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(x=u.children,e=u.fallback,v?(u=t.mode,v=t.child,x={mode:"hidden",children:x},!(u&1)&&v!==null?(v.childLanes=0,v.pendingProps=x):v=bm(x,u,0,null),e=zl(e,u,a,null),v.return=t,e.return=t,v.sibling=e,t.child=v,t.child.memoizedState=V_(a),t.memoizedState=j_,e):rv(t,x));if(f=e.memoizedState,f!==null&&(h=f.dehydrated,h!==null))return $A(e,t,x,u,h,f,a);if(v){v=u.fallback,x=t.mode,f=e.child,h=f.sibling;var z={mode:"hidden",children:u.children};return!(x&1)&&t.child!==f?(u=t.child,u.childLanes=0,u.pendingProps=z,t.deletions=null):(u=Us(f,z),u.subtreeFlags=f.subtreeFlags&14680064),h!==null?v=Us(h,v):(v=zl(v,x,a,null),v.flags|=2),v.return=t,u.return=t,u.sibling=v,t.child=u,u=v,v=t.child,x=e.child.memoizedState,x=x===null?V_(a):{baseLanes:x.baseLanes|a,cachePool:null,transitions:x.transitions},v.memoizedState=x,v.childLanes=e.childLanes&~a,t.memoizedState=j_,u}return v=e.child,e=v.sibling,u=Us(v,{mode:"visible",children:u.children}),!(t.mode&1)&&(u.lanes=a),u.return=t,u.sibling=null,e!==null&&(a=t.deletions,a===null?(t.deletions=[e],t.flags|=16):a.push(e)),t.child=u,t.memoizedState=null,u}function rv(e,t){return t=bm({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function of(e,t,a,u){return u!==null&&j0(u),yc(t,e.child,null,a),e=rv(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function $A(e,t,a,u,f,v,x){if(a)return t.flags&256?(t.flags&=-257,u=Hy(Error(Le(422))),of(e,t,x,u)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(v=u.fallback,f=t.mode,u=bm({mode:"visible",children:u.children},f,0,null),v=zl(v,f,x,null),v.flags|=2,u.return=t,v.return=t,u.sibling=v,t.child=u,t.mode&1&&yc(t,e.child,null,x),t.child.memoizedState=V_(x),t.memoizedState=j_,v);if(!(t.mode&1))return of(e,t,x,null);if(f.data==="$!"){if(u=f.nextSibling&&f.nextSibling.dataset,u)var h=u.dgst;return u=h,v=Error(Le(419)),u=Hy(v,u,void 0),of(e,t,x,u)}if(h=(x&e.childLanes)!==0,Ti||h){if(u=Sn,u!==null){switch(x&-x){case 4:f=2;break;case 16:f=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:f=32;break;case 536870912:f=268435456;break;default:f=0}f=f&(u.suspendedLanes|x)?0:f,f!==0&&f!==v.retryLane&&(v.retryLane=f,$a(e,f),Vo(u,e,f,-1))}return lv(),u=Hy(Error(Le(421))),of(e,t,x,u)}return f.data==="$?"?(t.flags|=128,t.child=e.child,t=QA.bind(null,e),f._reactRetry=t,null):(e=v.treeContext,Xi=Bs(f.nextSibling),Yi=t,Ar=!0,Uo=null,e!==null&&(vo[xo++]=Da,vo[xo++]=Fa,vo[xo++]=Fl,Da=e.id,Fa=e.overflow,Fl=t),t=rv(t,u.children),t.flags|=4096,t)}function Cb(e,t,a){e.lanes|=t;var u=e.alternate;u!==null&&(u.lanes|=t),F_(e.return,t,a)}function Wy(e,t,a,u,f){var v=e.memoizedState;v===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:u,tail:a,tailMode:f}:(v.isBackwards=t,v.rendering=null,v.renderingStartTime=0,v.last=u,v.tail=a,v.tailMode=f)}function OS(e,t,a){var u=t.pendingProps,f=u.revealOrder,v=u.tail;if(ui(e,t,u.children,a),u=Lr.current,u&2)u=u&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Cb(e,a,t);else if(e.tag===19)Cb(e,a,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}u&=1}if(vr(Lr,u),!(t.mode&1))t.memoizedState=null;else switch(f){case"forwards":for(a=t.child,f=null;a!==null;)e=a.alternate,e!==null&&Jf(e)===null&&(f=a),a=a.sibling;a=f,a===null?(f=t.child,t.child=null):(f=a.sibling,a.sibling=null),Wy(t,!1,f,a,v);break;case"backwards":for(a=null,f=t.child,t.child=null;f!==null;){if(e=f.alternate,e!==null&&Jf(e)===null){t.child=f;break}e=f.sibling,f.sibling=a,a=f,f=e}Wy(t,!0,a,null,v);break;case"together":Wy(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Sf(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ua(e,t,a){if(e!==null&&(t.dependencies=e.dependencies),Ol|=t.lanes,!(a&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Le(153));if(t.child!==null){for(e=t.child,a=Us(e,e.pendingProps),t.child=a,a.return=t;e.sibling!==null;)e=e.sibling,a=a.sibling=Us(e,e.pendingProps),a.return=t;a.sibling=null}return t.child}function UA(e,t,a){switch(t.tag){case 3:FS(t),gc();break;case 5:cS(t);break;case 1:ki(t.type)&&Gf(t);break;case 4:W0(t,t.stateNode.containerInfo);break;case 10:var u=t.type._context,f=t.memoizedProps.value;vr(Kf,u._currentValue),u._currentValue=f;break;case 13:if(u=t.memoizedState,u!==null)return u.dehydrated!==null?(vr(Lr,Lr.current&1),t.flags|=128,null):a&t.child.childLanes?BS(e,t,a):(vr(Lr,Lr.current&1),e=Ua(e,t,a),e!==null?e.sibling:null);vr(Lr,Lr.current&1);break;case 19:if(u=(a&t.childLanes)!==0,e.flags&128){if(u)return OS(e,t,a);t.flags|=128}if(f=t.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),vr(Lr,Lr.current),u)break;return null;case 22:case 23:return t.lanes=0,RS(e,t,a)}return Ua(e,t,a)}var NS,q_,$S,US;NS=function(e,t){for(var a=t.child;a!==null;){if(a.tag===5||a.tag===6)e.appendChild(a.stateNode);else if(a.tag!==4&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===t)break;for(;a.sibling===null;){if(a.return===null||a.return===t)return;a=a.return}a.sibling.return=a.return,a=a.sibling}};q_=function(){};$S=function(e,t,a,u){var f=e.memoizedProps;if(f!==u){e=t.stateNode,Al(ua.current);var v=null;switch(a){case"input":f=d_(e,f),u=d_(e,u),v=[];break;case"select":f=Dr({},f,{value:void 0}),u=Dr({},u,{value:void 0}),v=[];break;case"textarea":f=m_(e,f),u=m_(e,u),v=[];break;default:typeof f.onClick!="function"&&typeof u.onClick=="function"&&(e.onclick=qf)}y_(a,u);var x;a=null;for(B in f)if(!u.hasOwnProperty(B)&&f.hasOwnProperty(B)&&f[B]!=null)if(B==="style"){var h=f[B];for(x in h)h.hasOwnProperty(x)&&(a||(a={}),a[x]="")}else B!=="dangerouslySetInnerHTML"&&B!=="children"&&B!=="suppressContentEditableWarning"&&B!=="suppressHydrationWarning"&&B!=="autoFocus"&&(ud.hasOwnProperty(B)?v||(v=[]):(v=v||[]).push(B,null));for(B in u){var z=u[B];if(h=f!=null?f[B]:void 0,u.hasOwnProperty(B)&&z!==h&&(z!=null||h!=null))if(B==="style")if(h){for(x in h)!h.hasOwnProperty(x)||z&&z.hasOwnProperty(x)||(a||(a={}),a[x]="");for(x in z)z.hasOwnProperty(x)&&h[x]!==z[x]&&(a||(a={}),a[x]=z[x])}else a||(v||(v=[]),v.push(B,a)),a=z;else B==="dangerouslySetInnerHTML"?(z=z?z.__html:void 0,h=h?h.__html:void 0,z!=null&&h!==z&&(v=v||[]).push(B,z)):B==="children"?typeof z!="string"&&typeof z!="number"||(v=v||[]).push(B,""+z):B!=="suppressContentEditableWarning"&&B!=="suppressHydrationWarning"&&(ud.hasOwnProperty(B)?(z!=null&&B==="onScroll"&&wr("scroll",e),v||h===z||(v=[])):(v=v||[]).push(B,z))}a&&(v=v||[]).push("style",a);var B=v;(t.updateQueue=B)&&(t.flags|=4)}};US=function(e,t,a,u){a!==u&&(t.flags|=4)};function Vh(e,t){if(!Ar)switch(e.tailMode){case"hidden":t=e.tail;for(var a=null;t!==null;)t.alternate!==null&&(a=t),t=t.sibling;a===null?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var u=null;a!==null;)a.alternate!==null&&(u=a),a=a.sibling;u===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:u.sibling=null}}function Wn(e){var t=e.alternate!==null&&e.alternate.child===e.child,a=0,u=0;if(t)for(var f=e.child;f!==null;)a|=f.lanes|f.childLanes,u|=f.subtreeFlags&14680064,u|=f.flags&14680064,f.return=e,f=f.sibling;else for(f=e.child;f!==null;)a|=f.lanes|f.childLanes,u|=f.subtreeFlags,u|=f.flags,f.return=e,f=f.sibling;return e.subtreeFlags|=u,e.childLanes=a,t}function jA(e,t,a){var u=t.pendingProps;switch(U0(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wn(t),null;case 1:return ki(t.type)&&Zf(),Wn(t),null;case 3:return u=t.stateNode,_c(),Sr(Ci),Sr(Yn),X0(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(e===null||e.child===null)&&(rf(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Uo!==null&&(J_(Uo),Uo=null))),q_(e,t),Wn(t),null;case 5:K0(t);var f=Al(bd.current);if(a=t.type,e!==null&&t.stateNode!=null)$S(e,t,a,u,f),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!u){if(t.stateNode===null)throw Error(Le(166));return Wn(t),null}if(e=Al(ua.current),rf(t)){u=t.stateNode,a=t.type;var v=t.memoizedProps;switch(u[sa]=t,u[vd]=v,e=(t.mode&1)!==0,a){case"dialog":wr("cancel",u),wr("close",u);break;case"iframe":case"object":case"embed":wr("load",u);break;case"video":case"audio":for(f=0;f<Xh.length;f++)wr(Xh[f],u);break;case"source":wr("error",u);break;case"img":case"image":case"link":wr("error",u),wr("load",u);break;case"details":wr("toggle",u);break;case"input":Rx(u,v),wr("invalid",u);break;case"select":u._wrapperState={wasMultiple:!!v.multiple},wr("invalid",u);break;case"textarea":Fx(u,v),wr("invalid",u)}y_(a,v),f=null;for(var x in v)if(v.hasOwnProperty(x)){var h=v[x];x==="children"?typeof h=="string"?u.textContent!==h&&(v.suppressHydrationWarning!==!0&&tf(u.textContent,h,e),f=["children",h]):typeof h=="number"&&u.textContent!==""+h&&(v.suppressHydrationWarning!==!0&&tf(u.textContent,h,e),f=["children",""+h]):ud.hasOwnProperty(x)&&h!=null&&x==="onScroll"&&wr("scroll",u)}switch(a){case"input":Hp(u),Dx(u,v,!0);break;case"textarea":Hp(u),Bx(u);break;case"select":case"option":break;default:typeof v.onClick=="function"&&(u.onclick=qf)}u=f,t.updateQueue=u,u!==null&&(t.flags|=4)}else{x=f.nodeType===9?f:f.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=m2(a)),e==="http://www.w3.org/1999/xhtml"?a==="script"?(e=x.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof u.is=="string"?e=x.createElement(a,{is:u.is}):(e=x.createElement(a),a==="select"&&(x=e,u.multiple?x.multiple=!0:u.size&&(x.size=u.size))):e=x.createElementNS(e,a),e[sa]=t,e[vd]=u,NS(e,t,!1,!1),t.stateNode=e;e:{switch(x=__(a,u),a){case"dialog":wr("cancel",e),wr("close",e),f=u;break;case"iframe":case"object":case"embed":wr("load",e),f=u;break;case"video":case"audio":for(f=0;f<Xh.length;f++)wr(Xh[f],e);f=u;break;case"source":wr("error",e),f=u;break;case"img":case"image":case"link":wr("error",e),wr("load",e),f=u;break;case"details":wr("toggle",e),f=u;break;case"input":Rx(e,u),f=d_(e,u),wr("invalid",e);break;case"option":f=u;break;case"select":e._wrapperState={wasMultiple:!!u.multiple},f=Dr({},u,{value:void 0}),wr("invalid",e);break;case"textarea":Fx(e,u),f=m_(e,u),wr("invalid",e);break;default:f=u}y_(a,f),h=f;for(v in h)if(h.hasOwnProperty(v)){var z=h[v];v==="style"?_2(e,z):v==="dangerouslySetInnerHTML"?(z=z?z.__html:void 0,z!=null&&g2(e,z)):v==="children"?typeof z=="string"?(a!=="textarea"||z!=="")&&cd(e,z):typeof z=="number"&&cd(e,""+z):v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&v!=="autoFocus"&&(ud.hasOwnProperty(v)?z!=null&&v==="onScroll"&&wr("scroll",e):z!=null&&k0(e,v,z,x))}switch(a){case"input":Hp(e),Dx(e,u,!1);break;case"textarea":Hp(e),Bx(e);break;case"option":u.value!=null&&e.setAttribute("value",""+js(u.value));break;case"select":e.multiple=!!u.multiple,v=u.value,v!=null?rc(e,!!u.multiple,v,!1):u.defaultValue!=null&&rc(e,!!u.multiple,u.defaultValue,!0);break;default:typeof f.onClick=="function"&&(e.onclick=qf)}switch(a){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}}u&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Wn(t),null;case 6:if(e&&t.stateNode!=null)US(e,t,e.memoizedProps,u);else{if(typeof u!="string"&&t.stateNode===null)throw Error(Le(166));if(a=Al(bd.current),Al(ua.current),rf(t)){if(u=t.stateNode,a=t.memoizedProps,u[sa]=t,(v=u.nodeValue!==a)&&(e=Yi,e!==null))switch(e.tag){case 3:tf(u.nodeValue,a,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&tf(u.nodeValue,a,(e.mode&1)!==0)}v&&(t.flags|=4)}else u=(a.nodeType===9?a:a.ownerDocument).createTextNode(u),u[sa]=t,t.stateNode=u}return Wn(t),null;case 13:if(Sr(Lr),u=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ar&&Xi!==null&&t.mode&1&&!(t.flags&128))oS(),gc(),t.flags|=98560,v=!1;else if(v=rf(t),u!==null&&u.dehydrated!==null){if(e===null){if(!v)throw Error(Le(318));if(v=t.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(Le(317));v[sa]=t}else gc(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Wn(t),v=!1}else Uo!==null&&(J_(Uo),Uo=null),v=!0;if(!v)return t.flags&65536?t:null}return t.flags&128?(t.lanes=a,t):(u=u!==null,u!==(e!==null&&e.memoizedState!==null)&&u&&(t.child.flags|=8192,t.mode&1&&(e===null||Lr.current&1?hn===0&&(hn=3):lv())),t.updateQueue!==null&&(t.flags|=4),Wn(t),null);case 4:return _c(),q_(e,t),e===null&&yd(t.stateNode.containerInfo),Wn(t),null;case 10:return Z0(t.type._context),Wn(t),null;case 17:return ki(t.type)&&Zf(),Wn(t),null;case 19:if(Sr(Lr),v=t.memoizedState,v===null)return Wn(t),null;if(u=(t.flags&128)!==0,x=v.rendering,x===null)if(u)Vh(v,!1);else{if(hn!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(x=Jf(e),x!==null){for(t.flags|=128,Vh(v,!1),u=x.updateQueue,u!==null&&(t.updateQueue=u,t.flags|=4),t.subtreeFlags=0,u=a,a=t.child;a!==null;)v=a,e=u,v.flags&=14680066,x=v.alternate,x===null?(v.childLanes=0,v.lanes=e,v.child=null,v.subtreeFlags=0,v.memoizedProps=null,v.memoizedState=null,v.updateQueue=null,v.dependencies=null,v.stateNode=null):(v.childLanes=x.childLanes,v.lanes=x.lanes,v.child=x.child,v.subtreeFlags=0,v.deletions=null,v.memoizedProps=x.memoizedProps,v.memoizedState=x.memoizedState,v.updateQueue=x.updateQueue,v.type=x.type,e=x.dependencies,v.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),a=a.sibling;return vr(Lr,Lr.current&1|2),t.child}e=e.sibling}v.tail!==null&&Gr()>xc&&(t.flags|=128,u=!0,Vh(v,!1),t.lanes=4194304)}else{if(!u)if(e=Jf(x),e!==null){if(t.flags|=128,u=!0,a=e.updateQueue,a!==null&&(t.updateQueue=a,t.flags|=4),Vh(v,!0),v.tail===null&&v.tailMode==="hidden"&&!x.alternate&&!Ar)return Wn(t),null}else 2*Gr()-v.renderingStartTime>xc&&a!==1073741824&&(t.flags|=128,u=!0,Vh(v,!1),t.lanes=4194304);v.isBackwards?(x.sibling=t.child,t.child=x):(a=v.last,a!==null?a.sibling=x:t.child=x,v.last=x)}return v.tail!==null?(t=v.tail,v.rendering=t,v.tail=t.sibling,v.renderingStartTime=Gr(),t.sibling=null,a=Lr.current,vr(Lr,u?a&1|2:a&1),t):(Wn(t),null);case 22:case 23:return sv(),u=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==u&&(t.flags|=8192),u&&t.mode&1?Wi&1073741824&&(Wn(t),t.subtreeFlags&6&&(t.flags|=8192)):Wn(t),null;case 24:return null;case 25:return null}throw Error(Le(156,t.tag))}function VA(e,t){switch(U0(t),t.tag){case 1:return ki(t.type)&&Zf(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return _c(),Sr(Ci),Sr(Yn),X0(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return K0(t),null;case 13:if(Sr(Lr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Le(340));gc()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Sr(Lr),null;case 4:return _c(),null;case 10:return Z0(t.type._context),null;case 22:case 23:return sv(),null;case 24:return null;default:return null}}var af=!1,Xn=!1,qA=typeof WeakSet=="function"?WeakSet:Set,it=null;function ec(e,t){var a=e.ref;if(a!==null)if(typeof a=="function")try{a(null)}catch(u){Vr(e,t,u)}else a.current=null}function Z_(e,t,a){try{a()}catch(u){Vr(e,t,u)}}var kb=!1;function ZA(e,t){if(E_=Uf,e=G2(),N0(e)){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else e:{a=(a=e.ownerDocument)&&a.defaultView||window;var u=a.getSelection&&a.getSelection();if(u&&u.rangeCount!==0){a=u.anchorNode;var f=u.anchorOffset,v=u.focusNode;u=u.focusOffset;try{a.nodeType,v.nodeType}catch{a=null;break e}var x=0,h=-1,z=-1,B=0,Z=0,U=e,O=null;t:for(;;){for(var de;U!==a||f!==0&&U.nodeType!==3||(h=x+f),U!==v||u!==0&&U.nodeType!==3||(z=x+u),U.nodeType===3&&(x+=U.nodeValue.length),(de=U.firstChild)!==null;)O=U,U=de;for(;;){if(U===e)break t;if(O===a&&++B===f&&(h=x),O===v&&++Z===u&&(z=x),(de=U.nextSibling)!==null)break;U=O,O=U.parentNode}U=de}a=h===-1||z===-1?null:{start:h,end:z}}else a=null}a=a||{start:0,end:0}}else a=null;for(A_={focusedElem:e,selectionRange:a},Uf=!1,it=t;it!==null;)if(t=it,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,it=e;else for(;it!==null;){t=it;try{var he=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(he!==null){var ae=he.memoizedProps,Ae=he.memoizedState,te=t.stateNode,H=te.getSnapshotBeforeUpdate(t.elementType===t.type?ae:No(t.type,ae),Ae);te.__reactInternalSnapshotBeforeUpdate=H}break;case 3:var ie=t.stateNode.containerInfo;ie.nodeType===1?ie.textContent="":ie.nodeType===9&&ie.documentElement&&ie.removeChild(ie.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Le(163))}}catch(_e){Vr(t,t.return,_e)}if(e=t.sibling,e!==null){e.return=t.return,it=e;break}it=t.return}return he=kb,kb=!1,he}function od(e,t,a){var u=t.updateQueue;if(u=u!==null?u.lastEffect:null,u!==null){var f=u=u.next;do{if((f.tag&e)===e){var v=f.destroy;f.destroy=void 0,v!==void 0&&Z_(t,a,v)}f=f.next}while(f!==u)}}function vm(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var a=t=t.next;do{if((a.tag&e)===e){var u=a.create;a.destroy=u()}a=a.next}while(a!==t)}}function G_(e){var t=e.ref;if(t!==null){var a=e.stateNode;switch(e.tag){case 5:e=a;break;default:e=a}typeof t=="function"?t(e):t.current=e}}function jS(e){var t=e.alternate;t!==null&&(e.alternate=null,jS(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[sa],delete t[vd],delete t[z_],delete t[IA],delete t[EA])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function VS(e){return e.tag===5||e.tag===3||e.tag===4}function Ib(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||VS(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function H_(e,t,a){var u=e.tag;if(u===5||u===6)e=e.stateNode,t?a.nodeType===8?a.parentNode.insertBefore(e,t):a.insertBefore(e,t):(a.nodeType===8?(t=a.parentNode,t.insertBefore(e,a)):(t=a,t.appendChild(e)),a=a._reactRootContainer,a!=null||t.onclick!==null||(t.onclick=qf));else if(u!==4&&(e=e.child,e!==null))for(H_(e,t,a),e=e.sibling;e!==null;)H_(e,t,a),e=e.sibling}function W_(e,t,a){var u=e.tag;if(u===5||u===6)e=e.stateNode,t?a.insertBefore(e,t):a.appendChild(e);else if(u!==4&&(e=e.child,e!==null))for(W_(e,t,a),e=e.sibling;e!==null;)W_(e,t,a),e=e.sibling}var Mn=null,$o=!1;function ks(e,t,a){for(a=a.child;a!==null;)qS(e,t,a),a=a.sibling}function qS(e,t,a){if(la&&typeof la.onCommitFiberUnmount=="function")try{la.onCommitFiberUnmount(hm,a)}catch{}switch(a.tag){case 5:Xn||ec(a,t);case 6:var u=Mn,f=$o;Mn=null,ks(e,t,a),Mn=u,$o=f,Mn!==null&&($o?(e=Mn,a=a.stateNode,e.nodeType===8?e.parentNode.removeChild(a):e.removeChild(a)):Mn.removeChild(a.stateNode));break;case 18:Mn!==null&&($o?(e=Mn,a=a.stateNode,e.nodeType===8?Uy(e.parentNode,a):e.nodeType===1&&Uy(e,a),fd(e)):Uy(Mn,a.stateNode));break;case 4:u=Mn,f=$o,Mn=a.stateNode.containerInfo,$o=!0,ks(e,t,a),Mn=u,$o=f;break;case 0:case 11:case 14:case 15:if(!Xn&&(u=a.updateQueue,u!==null&&(u=u.lastEffect,u!==null))){f=u=u.next;do{var v=f,x=v.destroy;v=v.tag,x!==void 0&&(v&2||v&4)&&Z_(a,t,x),f=f.next}while(f!==u)}ks(e,t,a);break;case 1:if(!Xn&&(ec(a,t),u=a.stateNode,typeof u.componentWillUnmount=="function"))try{u.props=a.memoizedProps,u.state=a.memoizedState,u.componentWillUnmount()}catch(h){Vr(a,t,h)}ks(e,t,a);break;case 21:ks(e,t,a);break;case 22:a.mode&1?(Xn=(u=Xn)||a.memoizedState!==null,ks(e,t,a),Xn=u):ks(e,t,a);break;default:ks(e,t,a)}}function Eb(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var a=e.stateNode;a===null&&(a=e.stateNode=new qA),t.forEach(function(u){var f=eP.bind(null,e,u);a.has(u)||(a.add(u),u.then(f,f))})}}function Oo(e,t){var a=t.deletions;if(a!==null)for(var u=0;u<a.length;u++){var f=a[u];try{var v=e,x=t,h=x;e:for(;h!==null;){switch(h.tag){case 5:Mn=h.stateNode,$o=!1;break e;case 3:Mn=h.stateNode.containerInfo,$o=!0;break e;case 4:Mn=h.stateNode.containerInfo,$o=!0;break e}h=h.return}if(Mn===null)throw Error(Le(160));qS(v,x,f),Mn=null,$o=!1;var z=f.alternate;z!==null&&(z.return=null),f.return=null}catch(B){Vr(f,t,B)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)ZS(t,e),t=t.sibling}function ZS(e,t){var a=e.alternate,u=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Oo(t,e),ra(e),u&4){try{od(3,e,e.return),vm(3,e)}catch(ae){Vr(e,e.return,ae)}try{od(5,e,e.return)}catch(ae){Vr(e,e.return,ae)}}break;case 1:Oo(t,e),ra(e),u&512&&a!==null&&ec(a,a.return);break;case 5:if(Oo(t,e),ra(e),u&512&&a!==null&&ec(a,a.return),e.flags&32){var f=e.stateNode;try{cd(f,"")}catch(ae){Vr(e,e.return,ae)}}if(u&4&&(f=e.stateNode,f!=null)){var v=e.memoizedProps,x=a!==null?a.memoizedProps:v,h=e.type,z=e.updateQueue;if(e.updateQueue=null,z!==null)try{h==="input"&&v.type==="radio"&&v.name!=null&&p2(f,v),__(h,x);var B=__(h,v);for(x=0;x<z.length;x+=2){var Z=z[x],U=z[x+1];Z==="style"?_2(f,U):Z==="dangerouslySetInnerHTML"?g2(f,U):Z==="children"?cd(f,U):k0(f,Z,U,B)}switch(h){case"input":p_(f,v);break;case"textarea":f2(f,v);break;case"select":var O=f._wrapperState.wasMultiple;f._wrapperState.wasMultiple=!!v.multiple;var de=v.value;de!=null?rc(f,!!v.multiple,de,!1):O!==!!v.multiple&&(v.defaultValue!=null?rc(f,!!v.multiple,v.defaultValue,!0):rc(f,!!v.multiple,v.multiple?[]:"",!1))}f[vd]=v}catch(ae){Vr(e,e.return,ae)}}break;case 6:if(Oo(t,e),ra(e),u&4){if(e.stateNode===null)throw Error(Le(162));f=e.stateNode,v=e.memoizedProps;try{f.nodeValue=v}catch(ae){Vr(e,e.return,ae)}}break;case 3:if(Oo(t,e),ra(e),u&4&&a!==null&&a.memoizedState.isDehydrated)try{fd(t.containerInfo)}catch(ae){Vr(e,e.return,ae)}break;case 4:Oo(t,e),ra(e);break;case 13:Oo(t,e),ra(e),f=e.child,f.flags&8192&&(v=f.memoizedState!==null,f.stateNode.isHidden=v,!v||f.alternate!==null&&f.alternate.memoizedState!==null||(ov=Gr())),u&4&&Eb(e);break;case 22:if(Z=a!==null&&a.memoizedState!==null,e.mode&1?(Xn=(B=Xn)||Z,Oo(t,e),Xn=B):Oo(t,e),ra(e),u&8192){if(B=e.memoizedState!==null,(e.stateNode.isHidden=B)&&!Z&&e.mode&1)for(it=e,Z=e.child;Z!==null;){for(U=it=Z;it!==null;){switch(O=it,de=O.child,O.tag){case 0:case 11:case 14:case 15:od(4,O,O.return);break;case 1:ec(O,O.return);var he=O.stateNode;if(typeof he.componentWillUnmount=="function"){u=O,a=O.return;try{t=u,he.props=t.memoizedProps,he.state=t.memoizedState,he.componentWillUnmount()}catch(ae){Vr(u,a,ae)}}break;case 5:ec(O,O.return);break;case 22:if(O.memoizedState!==null){Pb(U);continue}}de!==null?(de.return=O,it=de):Pb(U)}Z=Z.sibling}e:for(Z=null,U=e;;){if(U.tag===5){if(Z===null){Z=U;try{f=U.stateNode,B?(v=f.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none"):(h=U.stateNode,z=U.memoizedProps.style,x=z!=null&&z.hasOwnProperty("display")?z.display:null,h.style.display=y2("display",x))}catch(ae){Vr(e,e.return,ae)}}}else if(U.tag===6){if(Z===null)try{U.stateNode.nodeValue=B?"":U.memoizedProps}catch(ae){Vr(e,e.return,ae)}}else if((U.tag!==22&&U.tag!==23||U.memoizedState===null||U===e)&&U.child!==null){U.child.return=U,U=U.child;continue}if(U===e)break e;for(;U.sibling===null;){if(U.return===null||U.return===e)break e;Z===U&&(Z=null),U=U.return}Z===U&&(Z=null),U.sibling.return=U.return,U=U.sibling}}break;case 19:Oo(t,e),ra(e),u&4&&Eb(e);break;case 21:break;default:Oo(t,e),ra(e)}}function ra(e){var t=e.flags;if(t&2){try{e:{for(var a=e.return;a!==null;){if(VS(a)){var u=a;break e}a=a.return}throw Error(Le(160))}switch(u.tag){case 5:var f=u.stateNode;u.flags&32&&(cd(f,""),u.flags&=-33);var v=Ib(e);W_(e,v,f);break;case 3:case 4:var x=u.stateNode.containerInfo,h=Ib(e);H_(e,h,x);break;default:throw Error(Le(161))}}catch(z){Vr(e,e.return,z)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function GA(e,t,a){it=e,GS(e)}function GS(e,t,a){for(var u=(e.mode&1)!==0;it!==null;){var f=it,v=f.child;if(f.tag===22&&u){var x=f.memoizedState!==null||af;if(!x){var h=f.alternate,z=h!==null&&h.memoizedState!==null||Xn;h=af;var B=Xn;if(af=x,(Xn=z)&&!B)for(it=f;it!==null;)x=it,z=x.child,x.tag===22&&x.memoizedState!==null?Mb(f):z!==null?(z.return=x,it=z):Mb(f);for(;v!==null;)it=v,GS(v),v=v.sibling;it=f,af=h,Xn=B}Ab(e)}else f.subtreeFlags&8772&&v!==null?(v.return=f,it=v):Ab(e)}}function Ab(e){for(;it!==null;){var t=it;if(t.flags&8772){var a=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Xn||vm(5,t);break;case 1:var u=t.stateNode;if(t.flags&4&&!Xn)if(a===null)u.componentDidMount();else{var f=t.elementType===t.type?a.memoizedProps:No(t.type,a.memoizedProps);u.componentDidUpdate(f,a.memoizedState,u.__reactInternalSnapshotBeforeUpdate)}var v=t.updateQueue;v!==null&&pb(t,v,u);break;case 3:var x=t.updateQueue;if(x!==null){if(a=null,t.child!==null)switch(t.child.tag){case 5:a=t.child.stateNode;break;case 1:a=t.child.stateNode}pb(t,x,a)}break;case 5:var h=t.stateNode;if(a===null&&t.flags&4){a=h;var z=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":z.autoFocus&&a.focus();break;case"img":z.src&&(a.src=z.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var B=t.alternate;if(B!==null){var Z=B.memoizedState;if(Z!==null){var U=Z.dehydrated;U!==null&&fd(U)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Le(163))}Xn||t.flags&512&&G_(t)}catch(O){Vr(t,t.return,O)}}if(t===e){it=null;break}if(a=t.sibling,a!==null){a.return=t.return,it=a;break}it=t.return}}function Pb(e){for(;it!==null;){var t=it;if(t===e){it=null;break}var a=t.sibling;if(a!==null){a.return=t.return,it=a;break}it=t.return}}function Mb(e){for(;it!==null;){var t=it;try{switch(t.tag){case 0:case 11:case 15:var a=t.return;try{vm(4,t)}catch(z){Vr(t,a,z)}break;case 1:var u=t.stateNode;if(typeof u.componentDidMount=="function"){var f=t.return;try{u.componentDidMount()}catch(z){Vr(t,f,z)}}var v=t.return;try{G_(t)}catch(z){Vr(t,v,z)}break;case 5:var x=t.return;try{G_(t)}catch(z){Vr(t,x,z)}}}catch(z){Vr(t,t.return,z)}if(t===e){it=null;break}var h=t.sibling;if(h!==null){h.return=t.return,it=h;break}it=t.return}}var HA=Math.ceil,tm=qa.ReactCurrentDispatcher,nv=qa.ReactCurrentOwner,So=qa.ReactCurrentBatchConfig,Gt=0,Sn=null,nn=null,Dn=0,Wi=0,tc=Zs(0),hn=0,Cd=null,Ol=0,xm=0,iv=0,ad=null,Si=null,ov=0,xc=1/0,La=null,rm=!1,K_=null,Ns=null,sf=!1,Ls=null,nm=0,sd=0,X_=null,Tf=-1,Cf=0;function ci(){return Gt&6?Gr():Tf!==-1?Tf:Tf=Gr()}function $s(e){return e.mode&1?Gt&2&&Dn!==0?Dn&-Dn:PA.transition!==null?(Cf===0&&(Cf=P2()),Cf):(e=sr,e!==0||(e=window.event,e=e===void 0?16:B2(e.type)),e):1}function Vo(e,t,a,u){if(50<sd)throw sd=0,X_=null,Error(Le(185));zd(e,a,u),(!(Gt&2)||e!==Sn)&&(e===Sn&&(!(Gt&2)&&(xm|=a),hn===4&&Ps(e,Dn)),Ii(e,u),a===1&&Gt===0&&!(t.mode&1)&&(xc=Gr()+500,gm&&Gs()))}function Ii(e,t){var a=e.callbackNode;PE(e,t);var u=$f(e,e===Sn?Dn:0);if(u===0)a!==null&&$x(a),e.callbackNode=null,e.callbackPriority=0;else if(t=u&-u,e.callbackPriority!==t){if(a!=null&&$x(a),t===1)e.tag===0?AA(zb.bind(null,e)):rS(zb.bind(null,e)),CA(function(){!(Gt&6)&&Gs()}),a=null;else{switch(M2(u)){case 1:a=M0;break;case 4:a=E2;break;case 16:a=Nf;break;case 536870912:a=A2;break;default:a=Nf}a=eT(a,HS.bind(null,e))}e.callbackPriority=t,e.callbackNode=a}}function HS(e,t){if(Tf=-1,Cf=0,Gt&6)throw Error(Le(327));var a=e.callbackNode;if(sc()&&e.callbackNode!==a)return null;var u=$f(e,e===Sn?Dn:0);if(u===0)return null;if(u&30||u&e.expiredLanes||t)t=im(e,u);else{t=u;var f=Gt;Gt|=2;var v=KS();(Sn!==e||Dn!==t)&&(La=null,xc=Gr()+500,Ml(e,t));do try{XA();break}catch(h){WS(e,h)}while(!0);q0(),tm.current=v,Gt=f,nn!==null?t=0:(Sn=null,Dn=0,t=hn)}if(t!==0){if(t===2&&(f=S_(e),f!==0&&(u=f,t=Y_(e,f))),t===1)throw a=Cd,Ml(e,0),Ps(e,u),Ii(e,Gr()),a;if(t===6)Ps(e,u);else{if(f=e.current.alternate,!(u&30)&&!WA(f)&&(t=im(e,u),t===2&&(v=S_(e),v!==0&&(u=v,t=Y_(e,v))),t===1))throw a=Cd,Ml(e,0),Ps(e,u),Ii(e,Gr()),a;switch(e.finishedWork=f,e.finishedLanes=u,t){case 0:case 1:throw Error(Le(345));case 2:Sl(e,Si,La);break;case 3:if(Ps(e,u),(u&130023424)===u&&(t=ov+500-Gr(),10<t)){if($f(e,0)!==0)break;if(f=e.suspendedLanes,(f&u)!==u){ci(),e.pingedLanes|=e.suspendedLanes&f;break}e.timeoutHandle=M_(Sl.bind(null,e,Si,La),t);break}Sl(e,Si,La);break;case 4:if(Ps(e,u),(u&4194240)===u)break;for(t=e.eventTimes,f=-1;0<u;){var x=31-jo(u);v=1<<x,x=t[x],x>f&&(f=x),u&=~v}if(u=f,u=Gr()-u,u=(120>u?120:480>u?480:1080>u?1080:1920>u?1920:3e3>u?3e3:4320>u?4320:1960*HA(u/1960))-u,10<u){e.timeoutHandle=M_(Sl.bind(null,e,Si,La),u);break}Sl(e,Si,La);break;case 5:Sl(e,Si,La);break;default:throw Error(Le(329))}}}return Ii(e,Gr()),e.callbackNode===a?HS.bind(null,e):null}function Y_(e,t){var a=ad;return e.current.memoizedState.isDehydrated&&(Ml(e,t).flags|=256),e=im(e,t),e!==2&&(t=Si,Si=a,t!==null&&J_(t)),e}function J_(e){Si===null?Si=e:Si.push.apply(Si,e)}function WA(e){for(var t=e;;){if(t.flags&16384){var a=t.updateQueue;if(a!==null&&(a=a.stores,a!==null))for(var u=0;u<a.length;u++){var f=a[u],v=f.getSnapshot;f=f.value;try{if(!qo(v(),f))return!1}catch{return!1}}}if(a=t.child,t.subtreeFlags&16384&&a!==null)a.return=t,t=a;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Ps(e,t){for(t&=~iv,t&=~xm,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var a=31-jo(t),u=1<<a;e[a]=-1,t&=~u}}function zb(e){if(Gt&6)throw Error(Le(327));sc();var t=$f(e,0);if(!(t&1))return Ii(e,Gr()),null;var a=im(e,t);if(e.tag!==0&&a===2){var u=S_(e);u!==0&&(t=u,a=Y_(e,u))}if(a===1)throw a=Cd,Ml(e,0),Ps(e,t),Ii(e,Gr()),a;if(a===6)throw Error(Le(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Sl(e,Si,La),Ii(e,Gr()),null}function av(e,t){var a=Gt;Gt|=1;try{return e(t)}finally{Gt=a,Gt===0&&(xc=Gr()+500,gm&&Gs())}}function Nl(e){Ls!==null&&Ls.tag===0&&!(Gt&6)&&sc();var t=Gt;Gt|=1;var a=So.transition,u=sr;try{if(So.transition=null,sr=1,e)return e()}finally{sr=u,So.transition=a,Gt=t,!(Gt&6)&&Gs()}}function sv(){Wi=tc.current,Sr(tc)}function Ml(e,t){e.finishedWork=null,e.finishedLanes=0;var a=e.timeoutHandle;if(a!==-1&&(e.timeoutHandle=-1,TA(a)),nn!==null)for(a=nn.return;a!==null;){var u=a;switch(U0(u),u.tag){case 1:u=u.type.childContextTypes,u!=null&&Zf();break;case 3:_c(),Sr(Ci),Sr(Yn),X0();break;case 5:K0(u);break;case 4:_c();break;case 13:Sr(Lr);break;case 19:Sr(Lr);break;case 10:Z0(u.type._context);break;case 22:case 23:sv()}a=a.return}if(Sn=e,nn=e=Us(e.current,null),Dn=Wi=t,hn=0,Cd=null,iv=xm=Ol=0,Si=ad=null,El!==null){for(t=0;t<El.length;t++)if(a=El[t],u=a.interleaved,u!==null){a.interleaved=null;var f=u.next,v=a.pending;if(v!==null){var x=v.next;v.next=f,u.next=x}a.pending=u}El=null}return e}function WS(e,t){do{var a=nn;try{if(q0(),bf.current=em,Qf){for(var u=Rr.memoizedState;u!==null;){var f=u.queue;f!==null&&(f.pending=null),u=u.next}Qf=!1}if(Bl=0,bn=cn=Rr=null,id=!1,wd=0,nv.current=null,a===null||a.return===null){hn=1,Cd=t,nn=null;break}e:{var v=e,x=a.return,h=a,z=t;if(t=Dn,h.flags|=32768,z!==null&&typeof z=="object"&&typeof z.then=="function"){var B=z,Z=h,U=Z.tag;if(!(Z.mode&1)&&(U===0||U===11||U===15)){var O=Z.alternate;O?(Z.updateQueue=O.updateQueue,Z.memoizedState=O.memoizedState,Z.lanes=O.lanes):(Z.updateQueue=null,Z.memoizedState=null)}var de=vb(x);if(de!==null){de.flags&=-257,xb(de,x,h,v,t),de.mode&1&&_b(v,B,t),t=de,z=B;var he=t.updateQueue;if(he===null){var ae=new Set;ae.add(z),t.updateQueue=ae}else he.add(z);break e}else{if(!(t&1)){_b(v,B,t),lv();break e}z=Error(Le(426))}}else if(Ar&&h.mode&1){var Ae=vb(x);if(Ae!==null){!(Ae.flags&65536)&&(Ae.flags|=256),xb(Ae,x,h,v,t),j0(vc(z,h));break e}}v=z=vc(z,h),hn!==4&&(hn=2),ad===null?ad=[v]:ad.push(v),v=x;do{switch(v.tag){case 3:v.flags|=65536,t&=-t,v.lanes|=t;var te=MS(v,z,t);db(v,te);break e;case 1:h=z;var H=v.type,ie=v.stateNode;if(!(v.flags&128)&&(typeof H.getDerivedStateFromError=="function"||ie!==null&&typeof ie.componentDidCatch=="function"&&(Ns===null||!Ns.has(ie)))){v.flags|=65536,t&=-t,v.lanes|=t;var _e=zS(v,h,t);db(v,_e);break e}}v=v.return}while(v!==null)}YS(a)}catch(Se){t=Se,nn===a&&a!==null&&(nn=a=a.return);continue}break}while(!0)}function KS(){var e=tm.current;return tm.current=em,e===null?em:e}function lv(){(hn===0||hn===3||hn===2)&&(hn=4),Sn===null||!(Ol&268435455)&&!(xm&268435455)||Ps(Sn,Dn)}function im(e,t){var a=Gt;Gt|=2;var u=KS();(Sn!==e||Dn!==t)&&(La=null,Ml(e,t));do try{KA();break}catch(f){WS(e,f)}while(!0);if(q0(),Gt=a,tm.current=u,nn!==null)throw Error(Le(261));return Sn=null,Dn=0,hn}function KA(){for(;nn!==null;)XS(nn)}function XA(){for(;nn!==null&&!bE();)XS(nn)}function XS(e){var t=QS(e.alternate,e,Wi);e.memoizedProps=e.pendingProps,t===null?YS(e):nn=t,nv.current=null}function YS(e){var t=e;do{var a=t.alternate;if(e=t.return,t.flags&32768){if(a=VA(a,t),a!==null){a.flags&=32767,nn=a;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{hn=6,nn=null;return}}else if(a=jA(a,t,Wi),a!==null){nn=a;return}if(t=t.sibling,t!==null){nn=t;return}nn=t=e}while(t!==null);hn===0&&(hn=5)}function Sl(e,t,a){var u=sr,f=So.transition;try{So.transition=null,sr=1,YA(e,t,a,u)}finally{So.transition=f,sr=u}return null}function YA(e,t,a,u){do sc();while(Ls!==null);if(Gt&6)throw Error(Le(327));a=e.finishedWork;var f=e.finishedLanes;if(a===null)return null;if(e.finishedWork=null,e.finishedLanes=0,a===e.current)throw Error(Le(177));e.callbackNode=null,e.callbackPriority=0;var v=a.lanes|a.childLanes;if(ME(e,v),e===Sn&&(nn=Sn=null,Dn=0),!(a.subtreeFlags&2064)&&!(a.flags&2064)||sf||(sf=!0,eT(Nf,function(){return sc(),null})),v=(a.flags&15990)!==0,a.subtreeFlags&15990||v){v=So.transition,So.transition=null;var x=sr;sr=1;var h=Gt;Gt|=4,nv.current=null,ZA(e,a),ZS(a,e),yA(A_),Uf=!!E_,A_=E_=null,e.current=a,GA(a),wE(),Gt=h,sr=x,So.transition=v}else e.current=a;if(sf&&(sf=!1,Ls=e,nm=f),v=e.pendingLanes,v===0&&(Ns=null),CE(a.stateNode),Ii(e,Gr()),t!==null)for(u=e.onRecoverableError,a=0;a<t.length;a++)f=t[a],u(f.value,{componentStack:f.stack,digest:f.digest});if(rm)throw rm=!1,e=K_,K_=null,e;return nm&1&&e.tag!==0&&sc(),v=e.pendingLanes,v&1?e===X_?sd++:(sd=0,X_=e):sd=0,Gs(),null}function sc(){if(Ls!==null){var e=M2(nm),t=So.transition,a=sr;try{if(So.transition=null,sr=16>e?16:e,Ls===null)var u=!1;else{if(e=Ls,Ls=null,nm=0,Gt&6)throw Error(Le(331));var f=Gt;for(Gt|=4,it=e.current;it!==null;){var v=it,x=v.child;if(it.flags&16){var h=v.deletions;if(h!==null){for(var z=0;z<h.length;z++){var B=h[z];for(it=B;it!==null;){var Z=it;switch(Z.tag){case 0:case 11:case 15:od(8,Z,v)}var U=Z.child;if(U!==null)U.return=Z,it=U;else for(;it!==null;){Z=it;var O=Z.sibling,de=Z.return;if(jS(Z),Z===B){it=null;break}if(O!==null){O.return=de,it=O;break}it=de}}}var he=v.alternate;if(he!==null){var ae=he.child;if(ae!==null){he.child=null;do{var Ae=ae.sibling;ae.sibling=null,ae=Ae}while(ae!==null)}}it=v}}if(v.subtreeFlags&2064&&x!==null)x.return=v,it=x;else e:for(;it!==null;){if(v=it,v.flags&2048)switch(v.tag){case 0:case 11:case 15:od(9,v,v.return)}var te=v.sibling;if(te!==null){te.return=v.return,it=te;break e}it=v.return}}var H=e.current;for(it=H;it!==null;){x=it;var ie=x.child;if(x.subtreeFlags&2064&&ie!==null)ie.return=x,it=ie;else e:for(x=H;it!==null;){if(h=it,h.flags&2048)try{switch(h.tag){case 0:case 11:case 15:vm(9,h)}}catch(Se){Vr(h,h.return,Se)}if(h===x){it=null;break e}var _e=h.sibling;if(_e!==null){_e.return=h.return,it=_e;break e}it=h.return}}if(Gt=f,Gs(),la&&typeof la.onPostCommitFiberRoot=="function")try{la.onPostCommitFiberRoot(hm,e)}catch{}u=!0}return u}finally{sr=a,So.transition=t}}return!1}function Lb(e,t,a){t=vc(a,t),t=MS(e,t,1),e=Os(e,t,1),t=ci(),e!==null&&(zd(e,1,t),Ii(e,t))}function Vr(e,t,a){if(e.tag===3)Lb(e,e,a);else for(;t!==null;){if(t.tag===3){Lb(t,e,a);break}else if(t.tag===1){var u=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(Ns===null||!Ns.has(u))){e=vc(a,e),e=zS(t,e,1),t=Os(t,e,1),e=ci(),t!==null&&(zd(t,1,e),Ii(t,e));break}}t=t.return}}function JA(e,t,a){var u=e.pingCache;u!==null&&u.delete(t),t=ci(),e.pingedLanes|=e.suspendedLanes&a,Sn===e&&(Dn&a)===a&&(hn===4||hn===3&&(Dn&130023424)===Dn&&500>Gr()-ov?Ml(e,0):iv|=a),Ii(e,t)}function JS(e,t){t===0&&(e.mode&1?(t=Xp,Xp<<=1,!(Xp&130023424)&&(Xp=4194304)):t=1);var a=ci();e=$a(e,t),e!==null&&(zd(e,t,a),Ii(e,a))}function QA(e){var t=e.memoizedState,a=0;t!==null&&(a=t.retryLane),JS(e,a)}function eP(e,t){var a=0;switch(e.tag){case 13:var u=e.stateNode,f=e.memoizedState;f!==null&&(a=f.retryLane);break;case 19:u=e.stateNode;break;default:throw Error(Le(314))}u!==null&&u.delete(t),JS(e,a)}var QS;QS=function(e,t,a){if(e!==null)if(e.memoizedProps!==t.pendingProps||Ci.current)Ti=!0;else{if(!(e.lanes&a)&&!(t.flags&128))return Ti=!1,UA(e,t,a);Ti=!!(e.flags&131072)}else Ti=!1,Ar&&t.flags&1048576&&nS(t,Wf,t.index);switch(t.lanes=0,t.tag){case 2:var u=t.type;Sf(e,t),e=t.pendingProps;var f=mc(t,Yn.current);ac(t,a),f=J0(null,t,u,e,f,a);var v=Q0();return t.flags|=1,typeof f=="object"&&f!==null&&typeof f.render=="function"&&f.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ki(u)?(v=!0,Gf(t)):v=!1,t.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,H0(t),f.updater=_m,t.stateNode=f,f._reactInternals=t,O_(t,u,e,a),t=U_(null,t,u,!0,v,a)):(t.tag=0,Ar&&v&&$0(t),ui(null,t,f,a),t=t.child),t;case 16:u=t.elementType;e:{switch(Sf(e,t),e=t.pendingProps,f=u._init,u=f(u._payload),t.type=u,f=t.tag=rP(u),e=No(u,e),f){case 0:t=$_(null,t,u,e,a);break e;case 1:t=Sb(null,t,u,e,a);break e;case 11:t=bb(null,t,u,e,a);break e;case 14:t=wb(null,t,u,No(u.type,e),a);break e}throw Error(Le(306,u,""))}return t;case 0:return u=t.type,f=t.pendingProps,f=t.elementType===u?f:No(u,f),$_(e,t,u,f,a);case 1:return u=t.type,f=t.pendingProps,f=t.elementType===u?f:No(u,f),Sb(e,t,u,f,a);case 3:e:{if(FS(t),e===null)throw Error(Le(387));u=t.pendingProps,v=t.memoizedState,f=v.element,uS(e,t),Yf(t,u,null,a);var x=t.memoizedState;if(u=x.element,v.isDehydrated)if(v={element:u,isDehydrated:!1,cache:x.cache,pendingSuspenseBoundaries:x.pendingSuspenseBoundaries,transitions:x.transitions},t.updateQueue.baseState=v,t.memoizedState=v,t.flags&256){f=vc(Error(Le(423)),t),t=Tb(e,t,u,a,f);break e}else if(u!==f){f=vc(Error(Le(424)),t),t=Tb(e,t,u,a,f);break e}else for(Xi=Bs(t.stateNode.containerInfo.firstChild),Yi=t,Ar=!0,Uo=null,a=sS(t,null,u,a),t.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(gc(),u===f){t=Ua(e,t,a);break e}ui(e,t,u,a)}t=t.child}return t;case 5:return cS(t),e===null&&D_(t),u=t.type,f=t.pendingProps,v=e!==null?e.memoizedProps:null,x=f.children,P_(u,f)?x=null:v!==null&&P_(u,v)&&(t.flags|=32),DS(e,t),ui(e,t,x,a),t.child;case 6:return e===null&&D_(t),null;case 13:return BS(e,t,a);case 4:return W0(t,t.stateNode.containerInfo),u=t.pendingProps,e===null?t.child=yc(t,null,u,a):ui(e,t,u,a),t.child;case 11:return u=t.type,f=t.pendingProps,f=t.elementType===u?f:No(u,f),bb(e,t,u,f,a);case 7:return ui(e,t,t.pendingProps,a),t.child;case 8:return ui(e,t,t.pendingProps.children,a),t.child;case 12:return ui(e,t,t.pendingProps.children,a),t.child;case 10:e:{if(u=t.type._context,f=t.pendingProps,v=t.memoizedProps,x=f.value,vr(Kf,u._currentValue),u._currentValue=x,v!==null)if(qo(v.value,x)){if(v.children===f.children&&!Ci.current){t=Ua(e,t,a);break e}}else for(v=t.child,v!==null&&(v.return=t);v!==null;){var h=v.dependencies;if(h!==null){x=v.child;for(var z=h.firstContext;z!==null;){if(z.context===u){if(v.tag===1){z=Ba(-1,a&-a),z.tag=2;var B=v.updateQueue;if(B!==null){B=B.shared;var Z=B.pending;Z===null?z.next=z:(z.next=Z.next,Z.next=z),B.pending=z}}v.lanes|=a,z=v.alternate,z!==null&&(z.lanes|=a),F_(v.return,a,t),h.lanes|=a;break}z=z.next}}else if(v.tag===10)x=v.type===t.type?null:v.child;else if(v.tag===18){if(x=v.return,x===null)throw Error(Le(341));x.lanes|=a,h=x.alternate,h!==null&&(h.lanes|=a),F_(x,a,t),x=v.sibling}else x=v.child;if(x!==null)x.return=v;else for(x=v;x!==null;){if(x===t){x=null;break}if(v=x.sibling,v!==null){v.return=x.return,x=v;break}x=x.return}v=x}ui(e,t,f.children,a),t=t.child}return t;case 9:return f=t.type,u=t.pendingProps.children,ac(t,a),f=To(f),u=u(f),t.flags|=1,ui(e,t,u,a),t.child;case 14:return u=t.type,f=No(u,t.pendingProps),f=No(u.type,f),wb(e,t,u,f,a);case 15:return LS(e,t,t.type,t.pendingProps,a);case 17:return u=t.type,f=t.pendingProps,f=t.elementType===u?f:No(u,f),Sf(e,t),t.tag=1,ki(u)?(e=!0,Gf(t)):e=!1,ac(t,a),PS(t,u,f),O_(t,u,f,a),U_(null,t,u,!0,e,a);case 19:return OS(e,t,a);case 22:return RS(e,t,a)}throw Error(Le(156,t.tag))};function eT(e,t){return I2(e,t)}function tP(e,t,a,u){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wo(e,t,a,u){return new tP(e,t,a,u)}function uv(e){return e=e.prototype,!(!e||!e.isReactComponent)}function rP(e){if(typeof e=="function")return uv(e)?1:0;if(e!=null){if(e=e.$$typeof,e===E0)return 11;if(e===A0)return 14}return 2}function Us(e,t){var a=e.alternate;return a===null?(a=wo(e.tag,t,e.key,e.mode),a.elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=t,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=e.flags&14680064,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,t=e.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a}function kf(e,t,a,u,f,v){var x=2;if(u=e,typeof e=="function")uv(e)&&(x=1);else if(typeof e=="string")x=5;else e:switch(e){case Zu:return zl(a.children,f,v,t);case I0:x=8,f|=8;break;case l_:return e=wo(12,a,t,f|2),e.elementType=l_,e.lanes=v,e;case u_:return e=wo(13,a,t,f),e.elementType=u_,e.lanes=v,e;case c_:return e=wo(19,a,t,f),e.elementType=c_,e.lanes=v,e;case c2:return bm(a,f,v,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case l2:x=10;break e;case u2:x=9;break e;case E0:x=11;break e;case A0:x=14;break e;case Is:x=16,u=null;break e}throw Error(Le(130,e==null?e:typeof e,""))}return t=wo(x,a,t,f),t.elementType=e,t.type=u,t.lanes=v,t}function zl(e,t,a,u){return e=wo(7,e,u,t),e.lanes=a,e}function bm(e,t,a,u){return e=wo(22,e,u,t),e.elementType=c2,e.lanes=a,e.stateNode={isHidden:!1},e}function Ky(e,t,a){return e=wo(6,e,null,t),e.lanes=a,e}function Xy(e,t,a){return t=wo(4,e.children!==null?e.children:[],e.key,t),t.lanes=a,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function nP(e,t,a,u,f){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Py(0),this.expirationTimes=Py(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Py(0),this.identifierPrefix=u,this.onRecoverableError=f,this.mutableSourceEagerHydrationData=null}function cv(e,t,a,u,f,v,x,h,z){return e=new nP(e,t,a,h,z),t===1?(t=1,v===!0&&(t|=8)):t=0,v=wo(3,null,null,t),e.current=v,v.stateNode=e,v.memoizedState={element:u,isDehydrated:a,cache:null,transitions:null,pendingSuspenseBoundaries:null},H0(v),e}function iP(e,t,a){var u=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:qu,key:u==null?null:""+u,children:e,containerInfo:t,implementation:a}}function tT(e){if(!e)return Vs;e=e._reactInternals;e:{if(Ul(e)!==e||e.tag!==1)throw Error(Le(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ki(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Le(171))}if(e.tag===1){var a=e.type;if(ki(a))return tS(e,a,t)}return t}function rT(e,t,a,u,f,v,x,h,z){return e=cv(a,u,!0,e,f,v,x,h,z),e.context=tT(null),a=e.current,u=ci(),f=$s(a),v=Ba(u,f),v.callback=t??null,Os(a,v,f),e.current.lanes=f,zd(e,f,u),Ii(e,u),e}function wm(e,t,a,u){var f=t.current,v=ci(),x=$s(f);return a=tT(a),t.context===null?t.context=a:t.pendingContext=a,t=Ba(v,x),t.payload={element:e},u=u===void 0?null:u,u!==null&&(t.callback=u),e=Os(f,t,x),e!==null&&(Vo(e,f,x,v),xf(e,f,x)),x}function om(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Rb(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var a=e.retryLane;e.retryLane=a!==0&&a<t?a:t}}function hv(e,t){Rb(e,t),(e=e.alternate)&&Rb(e,t)}function oP(){return null}var nT=typeof reportError=="function"?reportError:function(e){console.error(e)};function dv(e){this._internalRoot=e}Sm.prototype.render=dv.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Le(409));wm(e,t,null,null)};Sm.prototype.unmount=dv.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Nl(function(){wm(null,e,null,null)}),t[Na]=null}};function Sm(e){this._internalRoot=e}Sm.prototype.unstable_scheduleHydration=function(e){if(e){var t=R2();e={blockedOn:null,target:e,priority:t};for(var a=0;a<As.length&&t!==0&&t<As[a].priority;a++);As.splice(a,0,e),a===0&&F2(e)}};function pv(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Tm(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Db(){}function aP(e,t,a,u,f){if(f){if(typeof u=="function"){var v=u;u=function(){var B=om(x);v.call(B)}}var x=rT(t,u,e,0,null,!1,!1,"",Db);return e._reactRootContainer=x,e[Na]=x.current,yd(e.nodeType===8?e.parentNode:e),Nl(),x}for(;f=e.lastChild;)e.removeChild(f);if(typeof u=="function"){var h=u;u=function(){var B=om(z);h.call(B)}}var z=cv(e,0,!1,null,null,!1,!1,"",Db);return e._reactRootContainer=z,e[Na]=z.current,yd(e.nodeType===8?e.parentNode:e),Nl(function(){wm(t,z,a,u)}),z}function Cm(e,t,a,u,f){var v=a._reactRootContainer;if(v){var x=v;if(typeof f=="function"){var h=f;f=function(){var z=om(x);h.call(z)}}wm(t,x,e,f)}else x=aP(a,t,e,f,u);return om(x)}z2=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var a=Kh(t.pendingLanes);a!==0&&(z0(t,a|1),Ii(t,Gr()),!(Gt&6)&&(xc=Gr()+500,Gs()))}break;case 13:Nl(function(){var u=$a(e,1);if(u!==null){var f=ci();Vo(u,e,1,f)}}),hv(e,1)}};L0=function(e){if(e.tag===13){var t=$a(e,134217728);if(t!==null){var a=ci();Vo(t,e,134217728,a)}hv(e,134217728)}};L2=function(e){if(e.tag===13){var t=$s(e),a=$a(e,t);if(a!==null){var u=ci();Vo(a,e,t,u)}hv(e,t)}};R2=function(){return sr};D2=function(e,t){var a=sr;try{return sr=e,t()}finally{sr=a}};x_=function(e,t,a){switch(t){case"input":if(p_(e,a),t=a.name,a.type==="radio"&&t!=null){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<a.length;t++){var u=a[t];if(u!==e&&u.form===e.form){var f=mm(u);if(!f)throw Error(Le(90));d2(u),p_(u,f)}}}break;case"textarea":f2(e,a);break;case"select":t=a.value,t!=null&&rc(e,!!a.multiple,t,!1)}};b2=av;w2=Nl;var sP={usingClientEntryPoint:!1,Events:[Rd,Ku,mm,v2,x2,av]},qh={findFiberByHostInstance:Il,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},lP={bundleType:qh.bundleType,version:qh.version,rendererPackageName:qh.rendererPackageName,rendererConfig:qh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:qa.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=C2(e),e===null?null:e.stateNode},findFiberByHostInstance:qh.findFiberByHostInstance||oP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var lf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!lf.isDisabled&&lf.supportsFiber)try{hm=lf.inject(lP),la=lf}catch{}}eo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sP;eo.createPortal=function(e,t){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!pv(t))throw Error(Le(200));return iP(e,t,null,a)};eo.createRoot=function(e,t){if(!pv(e))throw Error(Le(299));var a=!1,u="",f=nT;return t!=null&&(t.unstable_strictMode===!0&&(a=!0),t.identifierPrefix!==void 0&&(u=t.identifierPrefix),t.onRecoverableError!==void 0&&(f=t.onRecoverableError)),t=cv(e,1,!1,null,null,a,!1,u,f),e[Na]=t.current,yd(e.nodeType===8?e.parentNode:e),new dv(t)};eo.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Le(188)):(e=Object.keys(e).join(","),Error(Le(268,e)));return e=C2(t),e=e===null?null:e.stateNode,e};eo.flushSync=function(e){return Nl(e)};eo.hydrate=function(e,t,a){if(!Tm(t))throw Error(Le(200));return Cm(null,e,t,!0,a)};eo.hydrateRoot=function(e,t,a){if(!pv(e))throw Error(Le(405));var u=a!=null&&a.hydratedSources||null,f=!1,v="",x=nT;if(a!=null&&(a.unstable_strictMode===!0&&(f=!0),a.identifierPrefix!==void 0&&(v=a.identifierPrefix),a.onRecoverableError!==void 0&&(x=a.onRecoverableError)),t=rT(t,null,e,1,a??null,f,!1,v,x),e[Na]=t.current,yd(e),u)for(e=0;e<u.length;e++)a=u[e],f=a._getVersion,f=f(a._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[a,f]:t.mutableSourceEagerHydrationData.push(a,f);return new Sm(t)};eo.render=function(e,t,a){if(!Tm(t))throw Error(Le(200));return Cm(null,e,t,!1,a)};eo.unmountComponentAtNode=function(e){if(!Tm(e))throw Error(Le(40));return e._reactRootContainer?(Nl(function(){Cm(null,null,e,!1,function(){e._reactRootContainer=null,e[Na]=null})}),!0):!1};eo.unstable_batchedUpdates=av;eo.unstable_renderSubtreeIntoContainer=function(e,t,a,u){if(!Tm(a))throw Error(Le(200));if(e==null||e._reactInternals===void 0)throw Error(Le(38));return Cm(e,t,a,!1,u)};eo.version="18.3.1-next-f1338f8080-20240426";function iT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(iT)}catch(e){console.error(e)}}iT(),i2.exports=eo;var uP=i2.exports,Fb=uP;a_.createRoot=Fb.createRoot,a_.hydrateRoot=Fb.hydrateRoot;function Bn(e,t){if(e==null)return{};var a={};for(var u in e)if({}.hasOwnProperty.call(e,u)){if(t.indexOf(u)>=0)continue;a[u]=e[u]}return a}function ct(){return ct=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var u in a)({}).hasOwnProperty.call(a,u)&&(e[u]=a[u])}return e},ct.apply(null,arguments)}function oT(e){var t,a,u="";if(typeof e=="string"||typeof e=="number")u+=e;else if(typeof e=="object")if(Array.isArray(e)){var f=e.length;for(t=0;t<f;t++)e[t]&&(a=oT(e[t]))&&(u&&(u+=" "),u+=a)}else for(a in e)e[a]&&(u&&(u+=" "),u+=a);return u}function Ln(){for(var e,t,a=0,u="",f=arguments.length;a<f;a++)(e=arguments[a])&&(t=oT(e))&&(u&&(u+=" "),u+=t);return u}function jl(e,t,a=void 0){const u={};return Object.keys(e).forEach(f=>{u[f]=e[f].reduce((v,x)=>{if(x){const h=t(x);h!==""&&v.push(h),a&&a[x]&&v.push(a[x])}return v},[]).join(" ")}),u}function Q_(e,t){const a=ct({},t);return Object.keys(e).forEach(u=>{if(u.toString().match(/^(components|slots)$/))a[u]=ct({},e[u],a[u]);else if(u.toString().match(/^(componentsProps|slotProps)$/)){const f=e[u]||{},v=t[u];a[u]={},!v||!Object.keys(v)?a[u]=f:!f||!Object.keys(f)?a[u]=v:(a[u]=ct({},v),Object.keys(f).forEach(x=>{a[u][x]=Q_(f[x],v[x])}))}else a[u]===void 0&&(a[u]=e[u])}),a}const cP=He.createContext(void 0);function hP(e){const{theme:t,name:a,props:u}=e;if(!t||!t.components||!t.components[a])return u;const f=t.components[a];return f.defaultProps?Q_(f.defaultProps,u):!f.styleOverrides&&!f.variants?Q_(f,u):u}function dP({props:e,name:t}){const a=He.useContext(cP);return hP({props:e,name:t,theme:{components:a}})}function Hs(e){return dP(e)}var Fd={},aT={exports:{}};(function(e){function t(a){return a&&a.__esModule?a:{default:a}}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(aT);var fv=aT.exports,Yy={exports:{}},Bb;function sT(){return Bb||(Bb=1,function(e){function t(){return e.exports=t=Object.assign?Object.assign.bind():function(a){for(var u=1;u<arguments.length;u++){var f=arguments[u];for(var v in f)({}).hasOwnProperty.call(f,v)&&(a[v]=f[v])}return a},e.exports.__esModule=!0,e.exports.default=e.exports,t.apply(null,arguments)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(Yy)),Yy.exports}var Jy={exports:{}},Ob;function pP(){return Ob||(Ob=1,function(e){function t(a,u){if(a==null)return{};var f={};for(var v in a)if({}.hasOwnProperty.call(a,v)){if(u.indexOf(v)>=0)continue;f[v]=a[v]}return f}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(Jy)),Jy.exports}function lT(e){var t=Object.create(null);return function(a){return t[a]===void 0&&(t[a]=e(a)),t[a]}}var fP=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,mP=lT(function(e){return fP.test(e)||e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)<91}),gP=!1;function yP(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}function _P(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),e.nonce!==void 0&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}var vP=function(){function e(a){var u=this;this._insertTag=function(f){var v;u.tags.length===0?u.insertionPoint?v=u.insertionPoint.nextSibling:u.prepend?v=u.container.firstChild:v=u.before:v=u.tags[u.tags.length-1].nextSibling,u.container.insertBefore(f,v),u.tags.push(f)},this.isSpeedy=a.speedy===void 0?!gP:a.speedy,this.tags=[],this.ctr=0,this.nonce=a.nonce,this.key=a.key,this.container=a.container,this.prepend=a.prepend,this.insertionPoint=a.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(u){u.forEach(this._insertTag)},t.insert=function(u){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(_P(this));var f=this.tags[this.tags.length-1];if(this.isSpeedy){var v=yP(f);try{v.insertRule(u,v.cssRules.length)}catch{}}else f.appendChild(document.createTextNode(u));this.ctr++},t.flush=function(){this.tags.forEach(function(u){var f;return(f=u.parentNode)==null?void 0:f.removeChild(u)}),this.tags=[],this.ctr=0},e}(),Kn="-ms-",am="-moz-",Qt="-webkit-",uT="comm",mv="rule",gv="decl",xP="@import",cT="@keyframes",bP="@layer",wP=Math.abs,km=String.fromCharCode,SP=Object.assign;function TP(e,t){return Rn(e,0)^45?(((t<<2^Rn(e,0))<<2^Rn(e,1))<<2^Rn(e,2))<<2^Rn(e,3):0}function hT(e){return e.trim()}function CP(e,t){return(e=t.exec(e))?e[0]:e}function er(e,t,a){return e.replace(t,a)}function e0(e,t){return e.indexOf(t)}function Rn(e,t){return e.charCodeAt(t)|0}function kd(e,t,a){return e.slice(t,a)}function oa(e){return e.length}function yv(e){return e.length}function uf(e,t){return t.push(e),e}function kP(e,t){return e.map(t).join("")}var Im=1,bc=1,dT=0,Ei=0,rn=0,Cc="";function Em(e,t,a,u,f,v,x){return{value:e,root:t,parent:a,type:u,props:f,children:v,line:Im,column:bc,length:x,return:""}}function Zh(e,t){return SP(Em("",null,null,"",null,null,0),e,{length:-e.length},t)}function IP(){return rn}function EP(){return rn=Ei>0?Rn(Cc,--Ei):0,bc--,rn===10&&(bc=1,Im--),rn}function Ji(){return rn=Ei<dT?Rn(Cc,Ei++):0,bc++,rn===10&&(bc=1,Im++),rn}function ca(){return Rn(Cc,Ei)}function If(){return Ei}function Bd(e,t){return kd(Cc,e,t)}function Id(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function pT(e){return Im=bc=1,dT=oa(Cc=e),Ei=0,[]}function fT(e){return Cc="",e}function Ef(e){return hT(Bd(Ei-1,t0(e===91?e+2:e===40?e+1:e)))}function AP(e){for(;(rn=ca())&&rn<33;)Ji();return Id(e)>2||Id(rn)>3?"":" "}function PP(e,t){for(;--t&&Ji()&&!(rn<48||rn>102||rn>57&&rn<65||rn>70&&rn<97););return Bd(e,If()+(t<6&&ca()==32&&Ji()==32))}function t0(e){for(;Ji();)switch(rn){case e:return Ei;case 34:case 39:e!==34&&e!==39&&t0(rn);break;case 40:e===41&&t0(e);break;case 92:Ji();break}return Ei}function MP(e,t){for(;Ji()&&e+rn!==57;)if(e+rn===84&&ca()===47)break;return"/*"+Bd(t,Ei-1)+"*"+km(e===47?e:Ji())}function zP(e){for(;!Id(ca());)Ji();return Bd(e,Ei)}function LP(e){return fT(Af("",null,null,null,[""],e=pT(e),0,[0],e))}function Af(e,t,a,u,f,v,x,h,z){for(var B=0,Z=0,U=x,O=0,de=0,he=0,ae=1,Ae=1,te=1,H=0,ie="",_e=f,Se=v,Ee=u,ke=ie;Ae;)switch(he=H,H=Ji()){case 40:if(he!=108&&Rn(ke,U-1)==58){e0(ke+=er(Ef(H),"&","&\f"),"&\f")!=-1&&(te=-1);break}case 34:case 39:case 91:ke+=Ef(H);break;case 9:case 10:case 13:case 32:ke+=AP(he);break;case 92:ke+=PP(If()-1,7);continue;case 47:switch(ca()){case 42:case 47:uf(RP(MP(Ji(),If()),t,a),z);break;default:ke+="/"}break;case 123*ae:h[B++]=oa(ke)*te;case 125*ae:case 59:case 0:switch(H){case 0:case 125:Ae=0;case 59+Z:te==-1&&(ke=er(ke,/\f/g,"")),de>0&&oa(ke)-U&&uf(de>32?$b(ke+";",u,a,U-1):$b(er(ke," ","")+";",u,a,U-2),z);break;case 59:ke+=";";default:if(uf(Ee=Nb(ke,t,a,B,Z,f,h,ie,_e=[],Se=[],U),v),H===123)if(Z===0)Af(ke,t,Ee,Ee,_e,v,U,h,Se);else switch(O===99&&Rn(ke,3)===110?100:O){case 100:case 108:case 109:case 115:Af(e,Ee,Ee,u&&uf(Nb(e,Ee,Ee,0,0,f,h,ie,f,_e=[],U),Se),f,Se,U,h,u?_e:Se);break;default:Af(ke,Ee,Ee,Ee,[""],Se,0,h,Se)}}B=Z=de=0,ae=te=1,ie=ke="",U=x;break;case 58:U=1+oa(ke),de=he;default:if(ae<1){if(H==123)--ae;else if(H==125&&ae++==0&&EP()==125)continue}switch(ke+=km(H),H*ae){case 38:te=Z>0?1:(ke+="\f",-1);break;case 44:h[B++]=(oa(ke)-1)*te,te=1;break;case 64:ca()===45&&(ke+=Ef(Ji())),O=ca(),Z=U=oa(ie=ke+=zP(If())),H++;break;case 45:he===45&&oa(ke)==2&&(ae=0)}}return v}function Nb(e,t,a,u,f,v,x,h,z,B,Z){for(var U=f-1,O=f===0?v:[""],de=yv(O),he=0,ae=0,Ae=0;he<u;++he)for(var te=0,H=kd(e,U+1,U=wP(ae=x[he])),ie=e;te<de;++te)(ie=hT(ae>0?O[te]+" "+H:er(H,/&\f/g,O[te])))&&(z[Ae++]=ie);return Em(e,t,a,f===0?mv:h,z,B,Z)}function RP(e,t,a){return Em(e,t,a,uT,km(IP()),kd(e,2,-2),0)}function $b(e,t,a,u){return Em(e,t,a,gv,kd(e,0,u),kd(e,u+1,-1),u)}function lc(e,t){for(var a="",u=yv(e),f=0;f<u;f++)a+=t(e[f],f,e,t)||"";return a}function DP(e,t,a,u){switch(e.type){case bP:if(e.children.length)break;case xP:case gv:return e.return=e.return||e.value;case uT:return"";case cT:return e.return=e.value+"{"+lc(e.children,u)+"}";case mv:e.value=e.props.join(",")}return oa(a=lc(e.children,u))?e.return=e.value+"{"+a+"}":""}function FP(e){var t=yv(e);return function(a,u,f,v){for(var x="",h=0;h<t;h++)x+=e[h](a,u,f,v)||"";return x}}function BP(e){return function(t){t.root||(t=t.return)&&e(t)}}var OP=function(t,a,u){for(var f=0,v=0;f=v,v=ca(),f===38&&v===12&&(a[u]=1),!Id(v);)Ji();return Bd(t,Ei)},NP=function(t,a){var u=-1,f=44;do switch(Id(f)){case 0:f===38&&ca()===12&&(a[u]=1),t[u]+=OP(Ei-1,a,u);break;case 2:t[u]+=Ef(f);break;case 4:if(f===44){t[++u]=ca()===58?"&\f":"",a[u]=t[u].length;break}default:t[u]+=km(f)}while(f=Ji());return t},$P=function(t,a){return fT(NP(pT(t),a))},Ub=new WeakMap,UP=function(t){if(!(t.type!=="rule"||!t.parent||t.length<1)){for(var a=t.value,u=t.parent,f=t.column===u.column&&t.line===u.line;u.type!=="rule";)if(u=u.parent,!u)return;if(!(t.props.length===1&&a.charCodeAt(0)!==58&&!Ub.get(u))&&!f){Ub.set(t,!0);for(var v=[],x=$P(a,v),h=u.props,z=0,B=0;z<x.length;z++)for(var Z=0;Z<h.length;Z++,B++)t.props[B]=v[z]?x[z].replace(/&\f/g,h[Z]):h[Z]+" "+x[z]}}},jP=function(t){if(t.type==="decl"){var a=t.value;a.charCodeAt(0)===108&&a.charCodeAt(2)===98&&(t.return="",t.value="")}};function mT(e,t){switch(TP(e,t)){case 5103:return Qt+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Qt+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Qt+e+am+e+Kn+e+e;case 6828:case 4268:return Qt+e+Kn+e+e;case 6165:return Qt+e+Kn+"flex-"+e+e;case 5187:return Qt+e+er(e,/(\w+).+(:[^]+)/,Qt+"box-$1$2"+Kn+"flex-$1$2")+e;case 5443:return Qt+e+Kn+"flex-item-"+er(e,/flex-|-self/,"")+e;case 4675:return Qt+e+Kn+"flex-line-pack"+er(e,/align-content|flex-|-self/,"")+e;case 5548:return Qt+e+Kn+er(e,"shrink","negative")+e;case 5292:return Qt+e+Kn+er(e,"basis","preferred-size")+e;case 6060:return Qt+"box-"+er(e,"-grow","")+Qt+e+Kn+er(e,"grow","positive")+e;case 4554:return Qt+er(e,/([^-])(transform)/g,"$1"+Qt+"$2")+e;case 6187:return er(er(er(e,/(zoom-|grab)/,Qt+"$1"),/(image-set)/,Qt+"$1"),e,"")+e;case 5495:case 3959:return er(e,/(image-set\([^]*)/,Qt+"$1$`$1");case 4968:return er(er(e,/(.+:)(flex-)?(.*)/,Qt+"box-pack:$3"+Kn+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Qt+e+e;case 4095:case 3583:case 4068:case 2532:return er(e,/(.+)-inline(.+)/,Qt+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(oa(e)-1-t>6)switch(Rn(e,t+1)){case 109:if(Rn(e,t+4)!==45)break;case 102:return er(e,/(.+:)(.+)-([^]+)/,"$1"+Qt+"$2-$3$1"+am+(Rn(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~e0(e,"stretch")?mT(er(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(Rn(e,t+1)!==115)break;case 6444:switch(Rn(e,oa(e)-3-(~e0(e,"!important")&&10))){case 107:return er(e,":",":"+Qt)+e;case 101:return er(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Qt+(Rn(e,14)===45?"inline-":"")+"box$3$1"+Qt+"$2$3$1"+Kn+"$2box$3")+e}break;case 5936:switch(Rn(e,t+11)){case 114:return Qt+e+Kn+er(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Qt+e+Kn+er(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Qt+e+Kn+er(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Qt+e+Kn+e+e}return e}var VP=function(t,a,u,f){if(t.length>-1&&!t.return)switch(t.type){case gv:t.return=mT(t.value,t.length);break;case cT:return lc([Zh(t,{value:er(t.value,"@","@"+Qt)})],f);case mv:if(t.length)return kP(t.props,function(v){switch(CP(v,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return lc([Zh(t,{props:[er(v,/:(read-\w+)/,":"+am+"$1")]})],f);case"::placeholder":return lc([Zh(t,{props:[er(v,/:(plac\w+)/,":"+Qt+"input-$1")]}),Zh(t,{props:[er(v,/:(plac\w+)/,":"+am+"$1")]}),Zh(t,{props:[er(v,/:(plac\w+)/,Kn+"input-$1")]})],f)}return""})}},qP=[VP],gT=function(t){var a=t.key;if(a==="css"){var u=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(u,function(ae){var Ae=ae.getAttribute("data-emotion");Ae.indexOf(" ")!==-1&&(document.head.appendChild(ae),ae.setAttribute("data-s",""))})}var f=t.stylisPlugins||qP,v={},x,h=[];x=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+a+' "]'),function(ae){for(var Ae=ae.getAttribute("data-emotion").split(" "),te=1;te<Ae.length;te++)v[Ae[te]]=!0;h.push(ae)});var z,B=[UP,jP];{var Z,U=[DP,BP(function(ae){Z.insert(ae)})],O=FP(B.concat(f,U)),de=function(Ae){return lc(LP(Ae),O)};z=function(Ae,te,H,ie){Z=H,de(Ae?Ae+"{"+te.styles+"}":te.styles),ie&&(he.inserted[te.name]=!0)}}var he={key:a,sheet:new vP({key:a,container:x,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:v,registered:{},insert:z};return he.sheet.hydrate(h),he},yT={exports:{}},lr={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tn=typeof Symbol=="function"&&Symbol.for,_v=Tn?Symbol.for("react.element"):60103,vv=Tn?Symbol.for("react.portal"):60106,Am=Tn?Symbol.for("react.fragment"):60107,Pm=Tn?Symbol.for("react.strict_mode"):60108,Mm=Tn?Symbol.for("react.profiler"):60114,zm=Tn?Symbol.for("react.provider"):60109,Lm=Tn?Symbol.for("react.context"):60110,xv=Tn?Symbol.for("react.async_mode"):60111,Rm=Tn?Symbol.for("react.concurrent_mode"):60111,Dm=Tn?Symbol.for("react.forward_ref"):60112,Fm=Tn?Symbol.for("react.suspense"):60113,ZP=Tn?Symbol.for("react.suspense_list"):60120,Bm=Tn?Symbol.for("react.memo"):60115,Om=Tn?Symbol.for("react.lazy"):60116,GP=Tn?Symbol.for("react.block"):60121,HP=Tn?Symbol.for("react.fundamental"):60117,WP=Tn?Symbol.for("react.responder"):60118,KP=Tn?Symbol.for("react.scope"):60119;function ro(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case _v:switch(e=e.type,e){case xv:case Rm:case Am:case Mm:case Pm:case Fm:return e;default:switch(e=e&&e.$$typeof,e){case Lm:case Dm:case Om:case Bm:case zm:return e;default:return t}}case vv:return t}}}function _T(e){return ro(e)===Rm}lr.AsyncMode=xv;lr.ConcurrentMode=Rm;lr.ContextConsumer=Lm;lr.ContextProvider=zm;lr.Element=_v;lr.ForwardRef=Dm;lr.Fragment=Am;lr.Lazy=Om;lr.Memo=Bm;lr.Portal=vv;lr.Profiler=Mm;lr.StrictMode=Pm;lr.Suspense=Fm;lr.isAsyncMode=function(e){return _T(e)||ro(e)===xv};lr.isConcurrentMode=_T;lr.isContextConsumer=function(e){return ro(e)===Lm};lr.isContextProvider=function(e){return ro(e)===zm};lr.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===_v};lr.isForwardRef=function(e){return ro(e)===Dm};lr.isFragment=function(e){return ro(e)===Am};lr.isLazy=function(e){return ro(e)===Om};lr.isMemo=function(e){return ro(e)===Bm};lr.isPortal=function(e){return ro(e)===vv};lr.isProfiler=function(e){return ro(e)===Mm};lr.isStrictMode=function(e){return ro(e)===Pm};lr.isSuspense=function(e){return ro(e)===Fm};lr.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Am||e===Rm||e===Mm||e===Pm||e===Fm||e===ZP||typeof e=="object"&&e!==null&&(e.$$typeof===Om||e.$$typeof===Bm||e.$$typeof===zm||e.$$typeof===Lm||e.$$typeof===Dm||e.$$typeof===HP||e.$$typeof===WP||e.$$typeof===KP||e.$$typeof===GP)};lr.typeOf=ro;yT.exports=lr;var XP=yT.exports,vT=XP,YP={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},JP={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},xT={};xT[vT.ForwardRef]=YP;xT[vT.Memo]=JP;var QP=!0;function eM(e,t,a){var u="";return a.split(" ").forEach(function(f){e[f]!==void 0?t.push(e[f]+";"):u+=f+" "}),u}var bT=function(t,a,u){var f=t.key+"-"+a.name;(u===!1||QP===!1)&&t.registered[f]===void 0&&(t.registered[f]=a.styles)},wT=function(t,a,u){bT(t,a,u);var f=t.key+"-"+a.name;if(t.inserted[a.name]===void 0){var v=a;do t.insert(a===v?"."+f:"",v,t.sheet,!0),v=v.next;while(v!==void 0)}};function tM(e){for(var t=0,a,u=0,f=e.length;f>=4;++u,f-=4)a=e.charCodeAt(u)&255|(e.charCodeAt(++u)&255)<<8|(e.charCodeAt(++u)&255)<<16|(e.charCodeAt(++u)&255)<<24,a=(a&65535)*1540483477+((a>>>16)*59797<<16),a^=a>>>24,t=(a&65535)*1540483477+((a>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(f){case 3:t^=(e.charCodeAt(u+2)&255)<<16;case 2:t^=(e.charCodeAt(u+1)&255)<<8;case 1:t^=e.charCodeAt(u)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var rM={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},nM=!1,iM=/[A-Z]|^ms/g,oM=/_EMO_([^_]+?)_([^]*?)_EMO_/g,ST=function(t){return t.charCodeAt(1)===45},jb=function(t){return t!=null&&typeof t!="boolean"},Qy=lT(function(e){return ST(e)?e:e.replace(iM,"-$&").toLowerCase()}),Vb=function(t,a){switch(t){case"animation":case"animationName":if(typeof a=="string")return a.replace(oM,function(u,f,v){return aa={name:f,styles:v,next:aa},f})}return rM[t]!==1&&!ST(t)&&typeof a=="number"&&a!==0?a+"px":a},aM="Component selectors can only be used in conjunction with @emotion/babel-plugin, the swc Emotion plugin, or another Emotion-aware compiler transform.";function Ed(e,t,a){if(a==null)return"";var u=a;if(u.__emotion_styles!==void 0)return u;switch(typeof a){case"boolean":return"";case"object":{var f=a;if(f.anim===1)return aa={name:f.name,styles:f.styles,next:aa},f.name;var v=a;if(v.styles!==void 0){var x=v.next;if(x!==void 0)for(;x!==void 0;)aa={name:x.name,styles:x.styles,next:aa},x=x.next;var h=v.styles+";";return h}return sM(e,t,a)}case"function":{if(e!==void 0){var z=aa,B=a(e);return aa=z,Ed(e,t,B)}break}}var Z=a;if(t==null)return Z;var U=t[Z];return U!==void 0?U:Z}function sM(e,t,a){var u="";if(Array.isArray(a))for(var f=0;f<a.length;f++)u+=Ed(e,t,a[f])+";";else for(var v in a){var x=a[v];if(typeof x!="object"){var h=x;t!=null&&t[h]!==void 0?u+=v+"{"+t[h]+"}":jb(h)&&(u+=Qy(v)+":"+Vb(v,h)+";")}else{if(v==="NO_COMPONENT_SELECTOR"&&nM)throw new Error(aM);if(Array.isArray(x)&&typeof x[0]=="string"&&(t==null||t[x[0]]===void 0))for(var z=0;z<x.length;z++)jb(x[z])&&(u+=Qy(v)+":"+Vb(v,x[z])+";");else{var B=Ed(e,t,x);switch(v){case"animation":case"animationName":{u+=Qy(v)+":"+B+";";break}default:u+=v+"{"+B+"}"}}}}return u}var qb=/label:\s*([^\s;\n{]+)\s*(;|$)/g,aa;function bv(e,t,a){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var u=!0,f="";aa=void 0;var v=e[0];if(v==null||v.raw===void 0)u=!1,f+=Ed(a,t,v);else{var x=v;f+=x[0]}for(var h=1;h<e.length;h++)if(f+=Ed(a,t,e[h]),u){var z=v;f+=z[h]}qb.lastIndex=0;for(var B="",Z;(Z=qb.exec(f))!==null;)B+="-"+Z[1];var U=tM(f)+B;return{name:U,styles:f,next:aa}}var lM=function(t){return t()},TT=o_.useInsertionEffect?o_.useInsertionEffect:!1,uM=TT||lM,Zb=TT||He.useLayoutEffect,CT=He.createContext(typeof HTMLElement<"u"?gT({key:"css"}):null),cM=CT.Provider,kT=function(t){return He.forwardRef(function(a,u){var f=He.useContext(CT);return t(a,f,u)})},Nm=He.createContext({});sT();var hM=kT(function(e,t){var a=e.styles,u=bv([a],void 0,He.useContext(Nm)),f=He.useRef();return Zb(function(){var v=t.key+"-global",x=new t.sheet.constructor({key:v,nonce:t.sheet.nonce,container:t.sheet.container,speedy:t.sheet.isSpeedy}),h=!1,z=document.querySelector('style[data-emotion="'+v+" "+u.name+'"]');return t.sheet.tags.length&&(x.before=t.sheet.tags[0]),z!==null&&(h=!0,z.setAttribute("data-emotion",v),x.hydrate([z])),f.current=[x,h],function(){x.flush()}},[t]),Zb(function(){var v=f.current,x=v[0],h=v[1];if(h){v[1]=!1;return}if(u.next!==void 0&&wT(t,u.next,!0),x.tags.length){var z=x.tags[x.tags.length-1].nextElementSibling;x.before=z,x.flush()}t.insert("",u,x,!1)},[t,u.name]),null});function IT(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return bv(t)}var $m=function(){var t=IT.apply(void 0,arguments),a="animation-"+t.name;return{name:a,styles:"@keyframes "+a+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},dM=mP,pM=function(t){return t!=="theme"},Gb=function(t){return typeof t=="string"&&t.charCodeAt(0)>96?dM:pM},Hb=function(t,a,u){var f;if(a){var v=a.shouldForwardProp;f=t.__emotion_forwardProp&&v?function(x){return t.__emotion_forwardProp(x)&&v(x)}:v}return typeof f!="function"&&u&&(f=t.__emotion_forwardProp),f},fM=!1,mM=function(t){var a=t.cache,u=t.serialized,f=t.isStringTag;return bT(a,u,f),uM(function(){return wT(a,u,f)}),null},gM=function e(t,a){var u=t.__emotion_real===t,f=u&&t.__emotion_base||t,v,x;a!==void 0&&(v=a.label,x=a.target);var h=Hb(t,a,u),z=h||Gb(f),B=!z("as");return function(){var Z=arguments,U=u&&t.__emotion_styles!==void 0?t.__emotion_styles.slice(0):[];if(v!==void 0&&U.push("label:"+v+";"),Z[0]==null||Z[0].raw===void 0)U.push.apply(U,Z);else{U.push(Z[0][0]);for(var O=Z.length,de=1;de<O;de++)U.push(Z[de],Z[0][de])}var he=kT(function(ae,Ae,te){var H=B&&ae.as||f,ie="",_e=[],Se=ae;if(ae.theme==null){Se={};for(var Ee in ae)Se[Ee]=ae[Ee];Se.theme=He.useContext(Nm)}typeof ae.className=="string"?ie=eM(Ae.registered,_e,ae.className):ae.className!=null&&(ie=ae.className+" ");var ke=bv(U.concat(_e),Ae.registered,Se);ie+=Ae.key+"-"+ke.name,x!==void 0&&(ie+=" "+x);var Ze=B&&h===void 0?Gb(H):z,mt={};for(var tt in ae)B&&tt==="as"||Ze(tt)&&(mt[tt]=ae[tt]);return mt.className=ie,te&&(mt.ref=te),He.createElement(He.Fragment,null,He.createElement(mM,{cache:Ae,serialized:ke,isStringTag:typeof H=="string"}),He.createElement(H,mt))});return he.displayName=v!==void 0?v:"Styled("+(typeof f=="string"?f:f.displayName||f.name||"Component")+")",he.defaultProps=t.defaultProps,he.__emotion_real=he,he.__emotion_base=f,he.__emotion_styles=U,he.__emotion_forwardProp=h,Object.defineProperty(he,"toString",{value:function(){return x===void 0&&fM?"NO_COMPONENT_SELECTOR":"."+x}}),he.withComponent=function(ae,Ae){return e(ae,ct({},a,Ae,{shouldForwardProp:Hb(he,Ae,!0)})).apply(void 0,U)},he}},yM=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],r0=gM.bind();yM.forEach(function(e){r0[e]=r0(e)});let n0;typeof document=="object"&&(n0=gT({key:"css",prepend:!0}));function _M(e){const{injectFirst:t,children:a}=e;return t&&n0?Kt.jsx(cM,{value:n0,children:a}):a}function vM(e){return e==null||Object.keys(e).length===0}function xM(e){const{styles:t,defaultTheme:a={}}=e,u=typeof t=="function"?f=>t(vM(f)?a:f):t;return Kt.jsx(hM,{styles:u})}function ET(e,t){return r0(e,t)}const bM=(e,t)=>{Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))},wM=Object.freeze(Object.defineProperty({__proto__:null,GlobalStyles:xM,StyledEngineProvider:_M,ThemeContext:Nm,css:IT,default:ET,internal_processStyles:bM,keyframes:$m},Symbol.toStringTag,{value:"Module"})),SM=Va(wM);function Ms(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function AT(e){if(!Ms(e))return e;const t={};return Object.keys(e).forEach(a=>{t[a]=AT(e[a])}),t}function ha(e,t,a={clone:!0}){const u=a.clone?ct({},e):e;return Ms(e)&&Ms(t)&&Object.keys(t).forEach(f=>{Ms(t[f])&&Object.prototype.hasOwnProperty.call(e,f)&&Ms(e[f])?u[f]=ha(e[f],t[f],a):a.clone?u[f]=Ms(t[f])?AT(t[f]):t[f]:u[f]=t[f]}),u}const TM=Object.freeze(Object.defineProperty({__proto__:null,default:ha,isPlainObject:Ms},Symbol.toStringTag,{value:"Module"})),CM=Va(TM);function Ad(e){let t="https://mui.com/production-error/?code="+e;for(let a=1;a<arguments.length;a+=1)t+="&args[]="+encodeURIComponent(arguments[a]);return"Minified MUI error #"+e+"; visit "+t+" for the full message."}const kM=Object.freeze(Object.defineProperty({__proto__:null,default:Ad},Symbol.toStringTag,{value:"Module"}));function on(e){if(typeof e!="string")throw new Error(Ad(7));return e.charAt(0).toUpperCase()+e.slice(1)}const IM=Object.freeze(Object.defineProperty({__proto__:null,default:on},Symbol.toStringTag,{value:"Module"})),EM=Va(IM);var PT={exports:{}},ur={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wv=Symbol.for("react.element"),Sv=Symbol.for("react.portal"),Um=Symbol.for("react.fragment"),jm=Symbol.for("react.strict_mode"),Vm=Symbol.for("react.profiler"),qm=Symbol.for("react.provider"),Zm=Symbol.for("react.context"),AM=Symbol.for("react.server_context"),Gm=Symbol.for("react.forward_ref"),Hm=Symbol.for("react.suspense"),Wm=Symbol.for("react.suspense_list"),Km=Symbol.for("react.memo"),Xm=Symbol.for("react.lazy"),PM=Symbol.for("react.offscreen"),MT;MT=Symbol.for("react.module.reference");function Io(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case wv:switch(e=e.type,e){case Um:case Vm:case jm:case Hm:case Wm:return e;default:switch(e=e&&e.$$typeof,e){case AM:case Zm:case Gm:case Xm:case Km:case qm:return e;default:return t}}case Sv:return t}}}ur.ContextConsumer=Zm;ur.ContextProvider=qm;ur.Element=wv;ur.ForwardRef=Gm;ur.Fragment=Um;ur.Lazy=Xm;ur.Memo=Km;ur.Portal=Sv;ur.Profiler=Vm;ur.StrictMode=jm;ur.Suspense=Hm;ur.SuspenseList=Wm;ur.isAsyncMode=function(){return!1};ur.isConcurrentMode=function(){return!1};ur.isContextConsumer=function(e){return Io(e)===Zm};ur.isContextProvider=function(e){return Io(e)===qm};ur.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===wv};ur.isForwardRef=function(e){return Io(e)===Gm};ur.isFragment=function(e){return Io(e)===Um};ur.isLazy=function(e){return Io(e)===Xm};ur.isMemo=function(e){return Io(e)===Km};ur.isPortal=function(e){return Io(e)===Sv};ur.isProfiler=function(e){return Io(e)===Vm};ur.isStrictMode=function(e){return Io(e)===jm};ur.isSuspense=function(e){return Io(e)===Hm};ur.isSuspenseList=function(e){return Io(e)===Wm};ur.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Um||e===Vm||e===jm||e===Hm||e===Wm||e===PM||typeof e=="object"&&e!==null&&(e.$$typeof===Xm||e.$$typeof===Km||e.$$typeof===qm||e.$$typeof===Zm||e.$$typeof===Gm||e.$$typeof===MT||e.getModuleId!==void 0)};ur.typeOf=Io;PT.exports=ur;var Wb=PT.exports;const MM=/^\s*function(?:\s|\s*\/\*.*\*\/\s*)+([^(\s/]*)\s*/;function zT(e){const t=`${e}`.match(MM);return t&&t[1]||""}function LT(e,t=""){return e.displayName||e.name||zT(e)||t}function Kb(e,t,a){const u=LT(t);return e.displayName||(u!==""?`${a}(${u})`:a)}function zM(e){if(e!=null){if(typeof e=="string")return e;if(typeof e=="function")return LT(e,"Component");if(typeof e=="object")switch(e.$$typeof){case Wb.ForwardRef:return Kb(e,e.render,"ForwardRef");case Wb.Memo:return Kb(e,e.type,"memo");default:return}}}const LM=Object.freeze(Object.defineProperty({__proto__:null,default:zM,getFunctionName:zT},Symbol.toStringTag,{value:"Module"})),RM=Va(LM),DM=["values","unit","step"],FM=e=>{const t=Object.keys(e).map(a=>({key:a,val:e[a]}))||[];return t.sort((a,u)=>a.val-u.val),t.reduce((a,u)=>ct({},a,{[u.key]:u.val}),{})};function RT(e){const{values:t={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:a="px",step:u=5}=e,f=Bn(e,DM),v=FM(t),x=Object.keys(v);function h(O){return`@media (min-width:${typeof t[O]=="number"?t[O]:O}${a})`}function z(O){return`@media (max-width:${(typeof t[O]=="number"?t[O]:O)-u/100}${a})`}function B(O,de){const he=x.indexOf(de);return`@media (min-width:${typeof t[O]=="number"?t[O]:O}${a}) and (max-width:${(he!==-1&&typeof t[x[he]]=="number"?t[x[he]]:de)-u/100}${a})`}function Z(O){return x.indexOf(O)+1<x.length?B(O,x[x.indexOf(O)+1]):h(O)}function U(O){const de=x.indexOf(O);return de===0?h(x[1]):de===x.length-1?z(x[de]):B(O,x[x.indexOf(O)+1]).replace("@media","@media not all and")}return ct({keys:x,values:v,up:h,down:z,between:B,only:Z,not:U,unit:a},f)}const BM={borderRadius:4};function ld(e,t){return t?ha(e,t,{clone:!1}):e}const Tv={xs:0,sm:600,md:900,lg:1200,xl:1536},Xb={keys:["xs","sm","md","lg","xl"],up:e=>`@media (min-width:${Tv[e]}px)`};function ja(e,t,a){const u=e.theme||{};if(Array.isArray(t)){const v=u.breakpoints||Xb;return t.reduce((x,h,z)=>(x[v.up(v.keys[z])]=a(t[z]),x),{})}if(typeof t=="object"){const v=u.breakpoints||Xb;return Object.keys(t).reduce((x,h)=>{if(Object.keys(v.values||Tv).indexOf(h)!==-1){const z=v.up(h);x[z]=a(t[h],h)}else{const z=h;x[z]=t[z]}return x},{})}return a(t)}function OM(e={}){var t;return((t=e.keys)==null?void 0:t.reduce((u,f)=>{const v=e.up(f);return u[v]={},u},{}))||{}}function NM(e,t){return e.reduce((a,u)=>{const f=a[u];return(!f||Object.keys(f).length===0)&&delete a[u],a},t)}function Ym(e,t,a=!0){if(!t||typeof t!="string")return null;if(e&&e.vars&&a){const u=`vars.${t}`.split(".").reduce((f,v)=>f&&f[v]?f[v]:null,e);if(u!=null)return u}return t.split(".").reduce((u,f)=>u&&u[f]!=null?u[f]:null,e)}function sm(e,t,a,u=a){let f;return typeof e=="function"?f=e(a):Array.isArray(e)?f=e[a]||u:f=Ym(e,a)||u,t&&(f=t(f,u,e)),f}function Hr(e){const{prop:t,cssProperty:a=e.prop,themeKey:u,transform:f}=e,v=x=>{if(x[t]==null)return null;const h=x[t],z=x.theme,B=Ym(z,u)||{};return ja(x,h,U=>{let O=sm(B,f,U);return U===O&&typeof U=="string"&&(O=sm(B,f,`${t}${U==="default"?"":on(U)}`,U)),a===!1?O:{[a]:O}})};return v.propTypes={},v.filterProps=[t],v}function $M(e){const t={};return a=>(t[a]===void 0&&(t[a]=e(a)),t[a])}const UM={m:"margin",p:"padding"},jM={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},Yb={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},VM=$M(e=>{if(e.length>2)if(Yb[e])e=Yb[e];else return[e];const[t,a]=e.split(""),u=UM[t],f=jM[a]||"";return Array.isArray(f)?f.map(v=>u+v):[u+f]}),Cv=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],kv=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...Cv,...kv];function Od(e,t,a,u){var f;const v=(f=Ym(e,t,!1))!=null?f:a;return typeof v=="number"?x=>typeof x=="string"?x:v*x:Array.isArray(v)?x=>typeof x=="string"?x:v[x]:typeof v=="function"?v:()=>{}}function DT(e){return Od(e,"spacing",8)}function Nd(e,t){if(typeof t=="string"||t==null)return t;const a=Math.abs(t),u=e(a);return t>=0?u:typeof u=="number"?-u:`-${u}`}function qM(e,t){return a=>e.reduce((u,f)=>(u[f]=Nd(t,a),u),{})}function ZM(e,t,a,u){if(t.indexOf(a)===-1)return null;const f=VM(a),v=qM(f,u),x=e[a];return ja(e,x,v)}function FT(e,t){const a=DT(e.theme);return Object.keys(e).map(u=>ZM(e,t,u,a)).reduce(ld,{})}function Ur(e){return FT(e,Cv)}Ur.propTypes={};Ur.filterProps=Cv;function jr(e){return FT(e,kv)}jr.propTypes={};jr.filterProps=kv;function GM(e=8){if(e.mui)return e;const t=DT({spacing:e}),a=(...u)=>(u.length===0?[1]:u).map(v=>{const x=t(v);return typeof x=="number"?`${x}px`:x}).join(" ");return a.mui=!0,a}function Jm(...e){const t=e.reduce((u,f)=>(f.filterProps.forEach(v=>{u[v]=f}),u),{}),a=u=>Object.keys(u).reduce((f,v)=>t[v]?ld(f,t[v](u)):f,{});return a.propTypes={},a.filterProps=e.reduce((u,f)=>u.concat(f.filterProps),[]),a}function bo(e){return typeof e!="number"?e:`${e}px solid`}function Eo(e,t){return Hr({prop:e,themeKey:"borders",transform:t})}const HM=Eo("border",bo),WM=Eo("borderTop",bo),KM=Eo("borderRight",bo),XM=Eo("borderBottom",bo),YM=Eo("borderLeft",bo),JM=Eo("borderColor"),QM=Eo("borderTopColor"),e5=Eo("borderRightColor"),t5=Eo("borderBottomColor"),r5=Eo("borderLeftColor"),n5=Eo("outline",bo),i5=Eo("outlineColor"),Qm=e=>{if(e.borderRadius!==void 0&&e.borderRadius!==null){const t=Od(e.theme,"shape.borderRadius",4),a=u=>({borderRadius:Nd(t,u)});return ja(e,e.borderRadius,a)}return null};Qm.propTypes={};Qm.filterProps=["borderRadius"];Jm(HM,WM,KM,XM,YM,JM,QM,e5,t5,r5,Qm,n5,i5);const eg=e=>{if(e.gap!==void 0&&e.gap!==null){const t=Od(e.theme,"spacing",8),a=u=>({gap:Nd(t,u)});return ja(e,e.gap,a)}return null};eg.propTypes={};eg.filterProps=["gap"];const tg=e=>{if(e.columnGap!==void 0&&e.columnGap!==null){const t=Od(e.theme,"spacing",8),a=u=>({columnGap:Nd(t,u)});return ja(e,e.columnGap,a)}return null};tg.propTypes={};tg.filterProps=["columnGap"];const rg=e=>{if(e.rowGap!==void 0&&e.rowGap!==null){const t=Od(e.theme,"spacing",8),a=u=>({rowGap:Nd(t,u)});return ja(e,e.rowGap,a)}return null};rg.propTypes={};rg.filterProps=["rowGap"];const o5=Hr({prop:"gridColumn"}),a5=Hr({prop:"gridRow"}),s5=Hr({prop:"gridAutoFlow"}),l5=Hr({prop:"gridAutoColumns"}),u5=Hr({prop:"gridAutoRows"}),c5=Hr({prop:"gridTemplateColumns"}),h5=Hr({prop:"gridTemplateRows"}),d5=Hr({prop:"gridTemplateAreas"}),p5=Hr({prop:"gridArea"});Jm(eg,tg,rg,o5,a5,s5,l5,u5,c5,h5,d5,p5);function uc(e,t){return t==="grey"?t:e}const f5=Hr({prop:"color",themeKey:"palette",transform:uc}),m5=Hr({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:uc}),g5=Hr({prop:"backgroundColor",themeKey:"palette",transform:uc});Jm(f5,m5,g5);function Ki(e){return e<=1&&e!==0?`${e*100}%`:e}const y5=Hr({prop:"width",transform:Ki}),Iv=e=>{if(e.maxWidth!==void 0&&e.maxWidth!==null){const t=a=>{var u,f;const v=((u=e.theme)==null||(u=u.breakpoints)==null||(u=u.values)==null?void 0:u[a])||Tv[a];return v?((f=e.theme)==null||(f=f.breakpoints)==null?void 0:f.unit)!=="px"?{maxWidth:`${v}${e.theme.breakpoints.unit}`}:{maxWidth:v}:{maxWidth:Ki(a)}};return ja(e,e.maxWidth,t)}return null};Iv.filterProps=["maxWidth"];const _5=Hr({prop:"minWidth",transform:Ki}),v5=Hr({prop:"height",transform:Ki}),x5=Hr({prop:"maxHeight",transform:Ki}),b5=Hr({prop:"minHeight",transform:Ki});Hr({prop:"size",cssProperty:"width",transform:Ki});Hr({prop:"size",cssProperty:"height",transform:Ki});const w5=Hr({prop:"boxSizing"});Jm(y5,Iv,_5,v5,x5,b5,w5);const $d={border:{themeKey:"borders",transform:bo},borderTop:{themeKey:"borders",transform:bo},borderRight:{themeKey:"borders",transform:bo},borderBottom:{themeKey:"borders",transform:bo},borderLeft:{themeKey:"borders",transform:bo},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:bo},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:Qm},color:{themeKey:"palette",transform:uc},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:uc},backgroundColor:{themeKey:"palette",transform:uc},p:{style:jr},pt:{style:jr},pr:{style:jr},pb:{style:jr},pl:{style:jr},px:{style:jr},py:{style:jr},padding:{style:jr},paddingTop:{style:jr},paddingRight:{style:jr},paddingBottom:{style:jr},paddingLeft:{style:jr},paddingX:{style:jr},paddingY:{style:jr},paddingInline:{style:jr},paddingInlineStart:{style:jr},paddingInlineEnd:{style:jr},paddingBlock:{style:jr},paddingBlockStart:{style:jr},paddingBlockEnd:{style:jr},m:{style:Ur},mt:{style:Ur},mr:{style:Ur},mb:{style:Ur},ml:{style:Ur},mx:{style:Ur},my:{style:Ur},margin:{style:Ur},marginTop:{style:Ur},marginRight:{style:Ur},marginBottom:{style:Ur},marginLeft:{style:Ur},marginX:{style:Ur},marginY:{style:Ur},marginInline:{style:Ur},marginInlineStart:{style:Ur},marginInlineEnd:{style:Ur},marginBlock:{style:Ur},marginBlockStart:{style:Ur},marginBlockEnd:{style:Ur},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:eg},rowGap:{style:rg},columnGap:{style:tg},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Ki},maxWidth:{style:Iv},minWidth:{transform:Ki},height:{transform:Ki},maxHeight:{transform:Ki},minHeight:{transform:Ki},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function S5(...e){const t=e.reduce((u,f)=>u.concat(Object.keys(f)),[]),a=new Set(t);return e.every(u=>a.size===Object.keys(u).length)}function T5(e,t){return typeof e=="function"?e(t):e}function BT(){function e(a,u,f,v){const x={[a]:u,theme:f},h=v[a];if(!h)return{[a]:u};const{cssProperty:z=a,themeKey:B,transform:Z,style:U}=h;if(u==null)return null;if(B==="typography"&&u==="inherit")return{[a]:u};const O=Ym(f,B)||{};return U?U(x):ja(x,u,he=>{let ae=sm(O,Z,he);return he===ae&&typeof he=="string"&&(ae=sm(O,Z,`${a}${he==="default"?"":on(he)}`,he)),z===!1?ae:{[z]:ae}})}function t(a){var u;const{sx:f,theme:v={}}=a||{};if(!f)return null;const x=(u=v.unstable_sxConfig)!=null?u:$d;function h(z){let B=z;if(typeof z=="function")B=z(v);else if(typeof z!="object")return z;if(!B)return null;const Z=OM(v.breakpoints),U=Object.keys(Z);let O=Z;return Object.keys(B).forEach(de=>{const he=T5(B[de],v);if(he!=null)if(typeof he=="object")if(x[de])O=ld(O,e(de,he,v,x));else{const ae=ja({theme:v},he,Ae=>({[de]:Ae}));S5(ae,he)?O[de]=t({sx:he,theme:v}):O=ld(O,ae)}else O=ld(O,e(de,he,v,x))}),NM(U,O)}return Array.isArray(f)?f.map(h):h(f)}return t}const Ud=BT();Ud.filterProps=["sx"];function OT(e,t){const a=this;return a.vars&&typeof a.getColorSchemeSelector=="function"?{[a.getColorSchemeSelector(e).replace(/(\[[^\]]+\])/,"*:where($1)")]:t}:a.palette.mode===e?t:{}}const C5=["breakpoints","palette","spacing","shape"];function Ev(e={},...t){const{breakpoints:a={},palette:u={},spacing:f,shape:v={}}=e,x=Bn(e,C5),h=RT(a),z=GM(f);let B=ha({breakpoints:h,direction:"ltr",components:{},palette:ct({mode:"light"},u),spacing:z,shape:ct({},BM,v)},x);return B.applyStyles=OT,B=t.reduce((Z,U)=>ha(Z,U),B),B.unstable_sxConfig=ct({},$d,x==null?void 0:x.unstable_sxConfig),B.unstable_sx=function(U){return Ud({sx:U,theme:this})},B}const k5=Object.freeze(Object.defineProperty({__proto__:null,default:Ev,private_createBreakpoints:RT,unstable_applyStyles:OT},Symbol.toStringTag,{value:"Module"})),I5=Va(k5),E5=["sx"],A5=e=>{var t,a;const u={systemProps:{},otherProps:{}},f=(t=e==null||(a=e.theme)==null?void 0:a.unstable_sxConfig)!=null?t:$d;return Object.keys(e).forEach(v=>{f[v]?u.systemProps[v]=e[v]:u.otherProps[v]=e[v]}),u};function Av(e){const{sx:t}=e,a=Bn(e,E5),{systemProps:u,otherProps:f}=A5(a);let v;return Array.isArray(t)?v=[u,...t]:typeof t=="function"?v=(...x)=>{const h=t(...x);return Ms(h)?ct({},u,h):u}:v=ct({},u,t),ct({},f,{sx:v})}const P5=Object.freeze(Object.defineProperty({__proto__:null,default:Ud,extendSxProp:Av,unstable_createStyleFunctionSx:BT,unstable_defaultSxConfig:$d},Symbol.toStringTag,{value:"Module"})),M5=Va(P5);var kc=fv;Object.defineProperty(Fd,"__esModule",{value:!0});var z5=Fd.default=Z5;Fd.shouldForwardProp=Pf;Fd.systemDefaultTheme=void 0;var yo=kc(sT()),i0=kc(pP()),Jb=N5(SM),L5=CM;kc(EM);kc(RM);var R5=kc(I5),D5=kc(M5);const F5=["ownerState"],B5=["variants"],O5=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function NT(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,a=new WeakMap;return(NT=function(u){return u?a:t})(e)}function N5(e,t){if(e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var a=NT(t);if(a&&a.has(e))return a.get(e);var u={__proto__:null},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var v in e)if(v!=="default"&&Object.prototype.hasOwnProperty.call(e,v)){var x=f?Object.getOwnPropertyDescriptor(e,v):null;x&&(x.get||x.set)?Object.defineProperty(u,v,x):u[v]=e[v]}return u.default=e,a&&a.set(e,u),u}function $5(e){return Object.keys(e).length===0}function U5(e){return typeof e=="string"&&e.charCodeAt(0)>96}function Pf(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}const j5=Fd.systemDefaultTheme=(0,R5.default)(),V5=e=>e&&e.charAt(0).toLowerCase()+e.slice(1);function cf({defaultTheme:e,theme:t,themeId:a}){return $5(t)?e:t[a]||t}function q5(e){return e?(t,a)=>a[e]:null}function Mf(e,t){let{ownerState:a}=t,u=(0,i0.default)(t,F5);const f=typeof e=="function"?e((0,yo.default)({ownerState:a},u)):e;if(Array.isArray(f))return f.flatMap(v=>Mf(v,(0,yo.default)({ownerState:a},u)));if(f&&typeof f=="object"&&Array.isArray(f.variants)){const{variants:v=[]}=f;let h=(0,i0.default)(f,B5);return v.forEach(z=>{let B=!0;typeof z.props=="function"?B=z.props((0,yo.default)({ownerState:a},u,a)):Object.keys(z.props).forEach(Z=>{(a==null?void 0:a[Z])!==z.props[Z]&&u[Z]!==z.props[Z]&&(B=!1)}),B&&(Array.isArray(h)||(h=[h]),h.push(typeof z.style=="function"?z.style((0,yo.default)({ownerState:a},u,a)):z.style))}),h}return f}function Z5(e={}){const{themeId:t,defaultTheme:a=j5,rootShouldForwardProp:u=Pf,slotShouldForwardProp:f=Pf}=e,v=x=>(0,D5.default)((0,yo.default)({},x,{theme:cf((0,yo.default)({},x,{defaultTheme:a,themeId:t}))}));return v.__mui_systemSx=!0,(x,h={})=>{(0,Jb.internal_processStyles)(x,Se=>Se.filter(Ee=>!(Ee!=null&&Ee.__mui_systemSx)));const{name:z,slot:B,skipVariantsResolver:Z,skipSx:U,overridesResolver:O=q5(V5(B))}=h,de=(0,i0.default)(h,O5),he=Z!==void 0?Z:B&&B!=="Root"&&B!=="root"||!1,ae=U||!1;let Ae,te=Pf;B==="Root"||B==="root"?te=u:B?te=f:U5(x)&&(te=void 0);const H=(0,Jb.default)(x,(0,yo.default)({shouldForwardProp:te,label:Ae},de)),ie=Se=>typeof Se=="function"&&Se.__emotion_real!==Se||(0,L5.isPlainObject)(Se)?Ee=>Mf(Se,(0,yo.default)({},Ee,{theme:cf({theme:Ee.theme,defaultTheme:a,themeId:t})})):Se,_e=(Se,...Ee)=>{let ke=ie(Se);const Ze=Ee?Ee.map(ie):[];z&&O&&Ze.push(ot=>{const $t=cf((0,yo.default)({},ot,{defaultTheme:a,themeId:t}));if(!$t.components||!$t.components[z]||!$t.components[z].styleOverrides)return null;const It=$t.components[z].styleOverrides,Bt={};return Object.entries(It).forEach(([Pr,Tr])=>{Bt[Pr]=Mf(Tr,(0,yo.default)({},ot,{theme:$t}))}),O(ot,Bt)}),z&&!he&&Ze.push(ot=>{var $t;const It=cf((0,yo.default)({},ot,{defaultTheme:a,themeId:t})),Bt=It==null||($t=It.components)==null||($t=$t[z])==null?void 0:$t.variants;return Mf({variants:Bt},(0,yo.default)({},ot,{theme:It}))}),ae||Ze.push(v);const mt=Ze.length-Ee.length;if(Array.isArray(Se)&&mt>0){const ot=new Array(mt).fill("");ke=[...Se,...ot],ke.raw=[...Se.raw,...ot]}const tt=H(ke,...Ze);return x.muiName&&(tt.muiName=x.muiName),tt};return H.withConfig&&(_e.withConfig=H.withConfig),_e}}const Qb=e=>e,G5=()=>{let e=Qb;return{configure(t){e=t},generate(t){return e(t)},reset(){e=Qb}}},Pv=G5(),H5={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function Ws(e,t,a="Mui"){const u=H5[t];return u?`${a}-${u}`:`${Pv.generate(e)}-${t}`}function W5(e,t){return ct({toolbar:{minHeight:56,[e.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[e.up("sm")]:{minHeight:64}}},t)}var Wr={};const K5=Va(kM);function X5(e,t=Number.MIN_SAFE_INTEGER,a=Number.MAX_SAFE_INTEGER){return Math.max(t,Math.min(e,a))}const Y5=Object.freeze(Object.defineProperty({__proto__:null,default:X5},Symbol.toStringTag,{value:"Module"})),J5=Va(Y5);var $T=fv;Object.defineProperty(Wr,"__esModule",{value:!0});var lm=Wr.alpha=qT;Wr.blend=hz;Wr.colorChannel=void 0;var Q5=Wr.darken=zv;Wr.decomposeColor=ko;Wr.emphasize=ZT;var ez=Wr.getContrastRatio=az;Wr.getLuminance=um;Wr.hexToRgb=UT;Wr.hslToRgb=VT;var tz=Wr.lighten=Lv;Wr.private_safeAlpha=sz;Wr.private_safeColorChannel=void 0;Wr.private_safeDarken=lz;Wr.private_safeEmphasize=cz;Wr.private_safeLighten=uz;Wr.recomposeColor=Ic;Wr.rgbToHex=oz;var ew=$T(K5),rz=$T(J5);function Mv(e,t=0,a=1){return(0,rz.default)(e,t,a)}function UT(e){e=e.slice(1);const t=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let a=e.match(t);return a&&a[0].length===1&&(a=a.map(u=>u+u)),a?`rgb${a.length===4?"a":""}(${a.map((u,f)=>f<3?parseInt(u,16):Math.round(parseInt(u,16)/255*1e3)/1e3).join(", ")})`:""}function nz(e){const t=e.toString(16);return t.length===1?`0${t}`:t}function ko(e){if(e.type)return e;if(e.charAt(0)==="#")return ko(UT(e));const t=e.indexOf("("),a=e.substring(0,t);if(["rgb","rgba","hsl","hsla","color"].indexOf(a)===-1)throw new Error((0,ew.default)(9,e));let u=e.substring(t+1,e.length-1),f;if(a==="color"){if(u=u.split(" "),f=u.shift(),u.length===4&&u[3].charAt(0)==="/"&&(u[3]=u[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(f)===-1)throw new Error((0,ew.default)(10,f))}else u=u.split(",");return u=u.map(v=>parseFloat(v)),{type:a,values:u,colorSpace:f}}const jT=e=>{const t=ko(e);return t.values.slice(0,3).map((a,u)=>t.type.indexOf("hsl")!==-1&&u!==0?`${a}%`:a).join(" ")};Wr.colorChannel=jT;const iz=(e,t)=>{try{return jT(e)}catch{return e}};Wr.private_safeColorChannel=iz;function Ic(e){const{type:t,colorSpace:a}=e;let{values:u}=e;return t.indexOf("rgb")!==-1?u=u.map((f,v)=>v<3?parseInt(f,10):f):t.indexOf("hsl")!==-1&&(u[1]=`${u[1]}%`,u[2]=`${u[2]}%`),t.indexOf("color")!==-1?u=`${a} ${u.join(" ")}`:u=`${u.join(", ")}`,`${t}(${u})`}function oz(e){if(e.indexOf("#")===0)return e;const{values:t}=ko(e);return`#${t.map((a,u)=>nz(u===3?Math.round(255*a):a)).join("")}`}function VT(e){e=ko(e);const{values:t}=e,a=t[0],u=t[1]/100,f=t[2]/100,v=u*Math.min(f,1-f),x=(B,Z=(B+a/30)%12)=>f-v*Math.max(Math.min(Z-3,9-Z,1),-1);let h="rgb";const z=[Math.round(x(0)*255),Math.round(x(8)*255),Math.round(x(4)*255)];return e.type==="hsla"&&(h+="a",z.push(t[3])),Ic({type:h,values:z})}function um(e){e=ko(e);let t=e.type==="hsl"||e.type==="hsla"?ko(VT(e)).values:e.values;return t=t.map(a=>(e.type!=="color"&&(a/=255),a<=.03928?a/12.92:((a+.055)/1.055)**2.4)),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function az(e,t){const a=um(e),u=um(t);return(Math.max(a,u)+.05)/(Math.min(a,u)+.05)}function qT(e,t){return e=ko(e),t=Mv(t),(e.type==="rgb"||e.type==="hsl")&&(e.type+="a"),e.type==="color"?e.values[3]=`/${t}`:e.values[3]=t,Ic(e)}function sz(e,t,a){try{return qT(e,t)}catch{return e}}function zv(e,t){if(e=ko(e),t=Mv(t),e.type.indexOf("hsl")!==-1)e.values[2]*=1-t;else if(e.type.indexOf("rgb")!==-1||e.type.indexOf("color")!==-1)for(let a=0;a<3;a+=1)e.values[a]*=1-t;return Ic(e)}function lz(e,t,a){try{return zv(e,t)}catch{return e}}function Lv(e,t){if(e=ko(e),t=Mv(t),e.type.indexOf("hsl")!==-1)e.values[2]+=(100-e.values[2])*t;else if(e.type.indexOf("rgb")!==-1)for(let a=0;a<3;a+=1)e.values[a]+=(255-e.values[a])*t;else if(e.type.indexOf("color")!==-1)for(let a=0;a<3;a+=1)e.values[a]+=(1-e.values[a])*t;return Ic(e)}function uz(e,t,a){try{return Lv(e,t)}catch{return e}}function ZT(e,t=.15){return um(e)>.5?zv(e,t):Lv(e,t)}function cz(e,t,a){try{return ZT(e,t)}catch{return e}}function hz(e,t,a,u=1){const f=(z,B)=>Math.round((z**(1/u)*(1-a)+B**(1/u)*a)**u),v=ko(e),x=ko(t),h=[f(v.values[0],x.values[0]),f(v.values[1],x.values[1]),f(v.values[2],x.values[2])];return Ic({type:"rgb",values:h})}const Pd={black:"#000",white:"#fff"},dz={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},Ou={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},Nu={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},Gh={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},$u={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},Uu={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},ju={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},pz=["mode","contrastThreshold","tonalOffset"],tw={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:Pd.white,default:Pd.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},e_={text:{primary:Pd.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:Pd.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function rw(e,t,a,u){const f=u.light||u,v=u.dark||u*1.5;e[t]||(e.hasOwnProperty(a)?e[t]=e[a]:t==="light"?e.light=tz(e.main,f):t==="dark"&&(e.dark=Q5(e.main,v)))}function fz(e="light"){return e==="dark"?{main:$u[200],light:$u[50],dark:$u[400]}:{main:$u[700],light:$u[400],dark:$u[800]}}function mz(e="light"){return e==="dark"?{main:Ou[200],light:Ou[50],dark:Ou[400]}:{main:Ou[500],light:Ou[300],dark:Ou[700]}}function gz(e="light"){return e==="dark"?{main:Nu[500],light:Nu[300],dark:Nu[700]}:{main:Nu[700],light:Nu[400],dark:Nu[800]}}function yz(e="light"){return e==="dark"?{main:Uu[400],light:Uu[300],dark:Uu[700]}:{main:Uu[700],light:Uu[500],dark:Uu[900]}}function _z(e="light"){return e==="dark"?{main:ju[400],light:ju[300],dark:ju[700]}:{main:ju[800],light:ju[500],dark:ju[900]}}function vz(e="light"){return e==="dark"?{main:Gh[400],light:Gh[300],dark:Gh[700]}:{main:"#ed6c02",light:Gh[500],dark:Gh[900]}}function xz(e){const{mode:t="light",contrastThreshold:a=3,tonalOffset:u=.2}=e,f=Bn(e,pz),v=e.primary||fz(t),x=e.secondary||mz(t),h=e.error||gz(t),z=e.info||yz(t),B=e.success||_z(t),Z=e.warning||vz(t);function U(ae){return ez(ae,e_.text.primary)>=a?e_.text.primary:tw.text.primary}const O=({color:ae,name:Ae,mainShade:te=500,lightShade:H=300,darkShade:ie=700})=>{if(ae=ct({},ae),!ae.main&&ae[te]&&(ae.main=ae[te]),!ae.hasOwnProperty("main"))throw new Error(Ad(11,Ae?` (${Ae})`:"",te));if(typeof ae.main!="string")throw new Error(Ad(12,Ae?` (${Ae})`:"",JSON.stringify(ae.main)));return rw(ae,"light",H,u),rw(ae,"dark",ie,u),ae.contrastText||(ae.contrastText=U(ae.main)),ae},de={dark:e_,light:tw};return ha(ct({common:ct({},Pd),mode:t,primary:O({color:v,name:"primary"}),secondary:O({color:x,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:O({color:h,name:"error"}),warning:O({color:Z,name:"warning"}),info:O({color:z,name:"info"}),success:O({color:B,name:"success"}),grey:dz,contrastThreshold:a,getContrastText:U,augmentColor:O,tonalOffset:u},de[t]),f)}const bz=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function wz(e){return Math.round(e*1e5)/1e5}const nw={textTransform:"uppercase"},iw='"Roboto", "Helvetica", "Arial", sans-serif';function Sz(e,t){const a=typeof t=="function"?t(e):t,{fontFamily:u=iw,fontSize:f=14,fontWeightLight:v=300,fontWeightRegular:x=400,fontWeightMedium:h=500,fontWeightBold:z=700,htmlFontSize:B=16,allVariants:Z,pxToRem:U}=a,O=Bn(a,bz),de=f/14,he=U||(te=>`${te/B*de}rem`),ae=(te,H,ie,_e,Se)=>ct({fontFamily:u,fontWeight:te,fontSize:he(H),lineHeight:ie},u===iw?{letterSpacing:`${wz(_e/H)}em`}:{},Se,Z),Ae={h1:ae(v,96,1.167,-1.5),h2:ae(v,60,1.2,-.5),h3:ae(x,48,1.167,0),h4:ae(x,34,1.235,.25),h5:ae(x,24,1.334,0),h6:ae(h,20,1.6,.15),subtitle1:ae(x,16,1.75,.15),subtitle2:ae(h,14,1.57,.1),body1:ae(x,16,1.5,.15),body2:ae(x,14,1.43,.15),button:ae(h,14,1.75,.4,nw),caption:ae(x,12,1.66,.4),overline:ae(x,12,2.66,1,nw),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return ha(ct({htmlFontSize:B,pxToRem:he,fontFamily:u,fontSize:f,fontWeightLight:v,fontWeightRegular:x,fontWeightMedium:h,fontWeightBold:z},Ae),O,{clone:!1})}const Tz=.2,Cz=.14,kz=.12;function Er(...e){return[`${e[0]}px ${e[1]}px ${e[2]}px ${e[3]}px rgba(0,0,0,${Tz})`,`${e[4]}px ${e[5]}px ${e[6]}px ${e[7]}px rgba(0,0,0,${Cz})`,`${e[8]}px ${e[9]}px ${e[10]}px ${e[11]}px rgba(0,0,0,${kz})`].join(",")}const Iz=["none",Er(0,2,1,-1,0,1,1,0,0,1,3,0),Er(0,3,1,-2,0,2,2,0,0,1,5,0),Er(0,3,3,-2,0,3,4,0,0,1,8,0),Er(0,2,4,-1,0,4,5,0,0,1,10,0),Er(0,3,5,-1,0,5,8,0,0,1,14,0),Er(0,3,5,-1,0,6,10,0,0,1,18,0),Er(0,4,5,-2,0,7,10,1,0,2,16,1),Er(0,5,5,-3,0,8,10,1,0,3,14,2),Er(0,5,6,-3,0,9,12,1,0,3,16,2),Er(0,6,6,-3,0,10,14,1,0,4,18,3),Er(0,6,7,-4,0,11,15,1,0,4,20,3),Er(0,7,8,-4,0,12,17,2,0,5,22,4),Er(0,7,8,-4,0,13,19,2,0,5,24,4),Er(0,7,9,-4,0,14,21,2,0,5,26,4),Er(0,8,9,-5,0,15,22,2,0,6,28,5),Er(0,8,10,-5,0,16,24,2,0,6,30,5),Er(0,8,11,-5,0,17,26,2,0,6,32,5),Er(0,9,11,-5,0,18,28,2,0,7,34,6),Er(0,9,12,-6,0,19,29,2,0,7,36,6),Er(0,10,13,-6,0,20,31,3,0,8,38,7),Er(0,10,13,-6,0,21,33,3,0,8,40,7),Er(0,10,14,-6,0,22,35,3,0,8,42,7),Er(0,11,14,-7,0,23,36,3,0,9,44,8),Er(0,11,15,-7,0,24,38,3,0,9,46,8)],Ez=["duration","easing","delay"],Az={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},Pz={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function ow(e){return`${Math.round(e)}ms`}function Mz(e){if(!e)return 0;const t=e/36;return Math.round((4+15*t**.25+t/5)*10)}function zz(e){const t=ct({},Az,e.easing),a=ct({},Pz,e.duration);return ct({getAutoHeightDuration:Mz,create:(f=["all"],v={})=>{const{duration:x=a.standard,easing:h=t.easeInOut,delay:z=0}=v;return Bn(v,Ez),(Array.isArray(f)?f:[f]).map(B=>`${B} ${typeof x=="string"?x:ow(x)} ${h} ${typeof z=="string"?z:ow(z)}`).join(",")}},e,{easing:t,duration:a})}const Lz={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},Rz=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function GT(e={},...t){const{mixins:a={},palette:u={},transitions:f={},typography:v={}}=e,x=Bn(e,Rz);if(e.vars)throw new Error(Ad(18));const h=xz(u),z=Ev(e);let B=ha(z,{mixins:W5(z.breakpoints,a),palette:h,shadows:Iz.slice(),typography:Sz(h,v),transitions:zz(f),zIndex:ct({},Lz)});return B=ha(B,x),B=t.reduce((Z,U)=>ha(Z,U),B),B.unstable_sxConfig=ct({},$d,x==null?void 0:x.unstable_sxConfig),B.unstable_sx=function(U){return Ud({sx:U,theme:this})},B}const Dz=GT(),HT="$$material";function Fz(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}const Bz=e=>Fz(e)&&e!=="classes",da=z5({themeId:HT,defaultTheme:Dz,rootShouldForwardProp:Bz});function Za(e,t,a="Mui"){const u={};return t.forEach(f=>{u[f]=Ws(e,f,a)}),u}function Oz(e){return Ws("MuiToolbar",e)}Za("MuiToolbar",["root","gutters","regular","dense"]);const Nz=["className","component","disableGutters","variant"],$z=e=>{const{classes:t,disableGutters:a,variant:u}=e;return jl({root:["root",!a&&"gutters",u]},Oz,t)},Uz=da("div",{name:"MuiToolbar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.root,!a.disableGutters&&t.gutters,t[a.variant]]}})(({theme:e,ownerState:t})=>ct({position:"relative",display:"flex",alignItems:"center"},!t.disableGutters&&{paddingLeft:e.spacing(2),paddingRight:e.spacing(2),[e.breakpoints.up("sm")]:{paddingLeft:e.spacing(3),paddingRight:e.spacing(3)}},t.variant==="dense"&&{minHeight:48}),({theme:e,ownerState:t})=>t.variant==="regular"&&e.mixins.toolbar),jz=He.forwardRef(function(t,a){const u=Hs({props:t,name:"MuiToolbar"}),{className:f,component:v="div",disableGutters:x=!1,variant:h="regular"}=u,z=Bn(u,Nz),B=ct({},u,{component:v,disableGutters:x,variant:h}),Z=$z(B);return Kt.jsx(Uz,ct({as:v,className:Ln(Z.root,f),ref:a,ownerState:B},z))});function Vz(e){return Ws("MuiTypography",e)}Za("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const qz=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],Zz=e=>{const{align:t,gutterBottom:a,noWrap:u,paragraph:f,variant:v,classes:x}=e,h={root:["root",v,e.align!=="inherit"&&`align${on(t)}`,a&&"gutterBottom",u&&"noWrap",f&&"paragraph"]};return jl(h,Vz,x)},Gz=da("span",{name:"MuiTypography",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.root,a.variant&&t[a.variant],a.align!=="inherit"&&t[`align${on(a.align)}`],a.noWrap&&t.noWrap,a.gutterBottom&&t.gutterBottom,a.paragraph&&t.paragraph]}})(({theme:e,ownerState:t})=>ct({margin:0},t.variant==="inherit"&&{font:"inherit"},t.variant!=="inherit"&&e.typography[t.variant],t.align!=="inherit"&&{textAlign:t.align},t.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},t.gutterBottom&&{marginBottom:"0.35em"},t.paragraph&&{marginBottom:16})),aw={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},Hz={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},Wz=e=>Hz[e]||e,Kz=He.forwardRef(function(t,a){const u=Hs({props:t,name:"MuiTypography"}),f=Wz(u.color),v=Av(ct({},u,{color:f})),{align:x="inherit",className:h,component:z,gutterBottom:B=!1,noWrap:Z=!1,paragraph:U=!1,variant:O="body1",variantMapping:de=aw}=v,he=Bn(v,qz),ae=ct({},v,{align:x,color:f,className:h,component:z,gutterBottom:B,noWrap:Z,paragraph:U,variant:O,variantMapping:de}),Ae=z||(U?"p":de[O]||aw[O])||"span",te=Zz(ae);return Kt.jsx(Gz,ct({as:Ae,ref:a,ownerState:ae,className:Ln(te.root,h)},he))});function WT(e,t){typeof e=="function"?e(t):e&&(e.current=t)}function o0(...e){return He.useMemo(()=>e.every(t=>t==null)?null:t=>{e.forEach(a=>{WT(a,t)})},e)}const KT=typeof window<"u"?He.useLayoutEffect:He.useEffect;function Yh(e){const t=He.useRef(e);return KT(()=>{t.current=e}),He.useRef((...a)=>(0,t.current)(...a)).current}const sw={};function Xz(e,t){const a=He.useRef(sw);return a.current===sw&&(a.current=e(t)),a}const Yz=[];function Jz(e){He.useEffect(e,Yz)}class ng{constructor(){this.currentId=null,this.clear=()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)},this.disposeEffect=()=>this.clear}static create(){return new ng}start(t,a){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,a()},t)}}function Qz(){const e=Xz(ng.create).current;return Jz(e.disposeEffect),e}let ig=!0,a0=!1;const eL=new ng,tL={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function rL(e){const{type:t,tagName:a}=e;return!!(a==="INPUT"&&tL[t]&&!e.readOnly||a==="TEXTAREA"&&!e.readOnly||e.isContentEditable)}function nL(e){e.metaKey||e.altKey||e.ctrlKey||(ig=!0)}function t_(){ig=!1}function iL(){this.visibilityState==="hidden"&&a0&&(ig=!0)}function oL(e){e.addEventListener("keydown",nL,!0),e.addEventListener("mousedown",t_,!0),e.addEventListener("pointerdown",t_,!0),e.addEventListener("touchstart",t_,!0),e.addEventListener("visibilitychange",iL,!0)}function aL(e){const{target:t}=e;try{return t.matches(":focus-visible")}catch{}return ig||rL(t)}function XT(){const e=He.useCallback(f=>{f!=null&&oL(f.ownerDocument)},[]),t=He.useRef(!1);function a(){return t.current?(a0=!0,eL.start(100,()=>{a0=!1}),t.current=!1,!0):!1}function u(f){return aL(f)?(t.current=!0,!0):!1}return{isFocusVisibleRef:t,onFocus:u,onBlur:a,ref:e}}function s0(e,t){return s0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,u){return a.__proto__=u,a},s0(e,t)}function sL(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,s0(e,t)}const lw=kl.createContext(null);function lL(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rv(e,t){var a=function(v){return t&&He.isValidElement(v)?t(v):v},u=Object.create(null);return e&&He.Children.map(e,function(f){return f}).forEach(function(f){u[f.key]=a(f)}),u}function uL(e,t){e=e||{},t=t||{};function a(Z){return Z in t?t[Z]:e[Z]}var u=Object.create(null),f=[];for(var v in e)v in t?f.length&&(u[v]=f,f=[]):f.push(v);var x,h={};for(var z in t){if(u[z])for(x=0;x<u[z].length;x++){var B=u[z][x];h[u[z][x]]=a(B)}h[z]=a(z)}for(x=0;x<f.length;x++)h[f[x]]=a(f[x]);return h}function Pl(e,t,a){return a[t]!=null?a[t]:e.props[t]}function cL(e,t){return Rv(e.children,function(a){return He.cloneElement(a,{onExited:t.bind(null,a),in:!0,appear:Pl(a,"appear",e),enter:Pl(a,"enter",e),exit:Pl(a,"exit",e)})})}function hL(e,t,a){var u=Rv(e.children),f=uL(t,u);return Object.keys(f).forEach(function(v){var x=f[v];if(He.isValidElement(x)){var h=v in t,z=v in u,B=t[v],Z=He.isValidElement(B)&&!B.props.in;z&&(!h||Z)?f[v]=He.cloneElement(x,{onExited:a.bind(null,x),in:!0,exit:Pl(x,"exit",e),enter:Pl(x,"enter",e)}):!z&&h&&!Z?f[v]=He.cloneElement(x,{in:!1}):z&&h&&He.isValidElement(B)&&(f[v]=He.cloneElement(x,{onExited:a.bind(null,x),in:B.props.in,exit:Pl(x,"exit",e),enter:Pl(x,"enter",e)}))}}),f}var dL=Object.values||function(e){return Object.keys(e).map(function(t){return e[t]})},pL={component:"div",childFactory:function(t){return t}},Dv=function(e){sL(t,e);function t(u,f){var v;v=e.call(this,u,f)||this;var x=v.handleExited.bind(lL(v));return v.state={contextValue:{isMounting:!0},handleExited:x,firstRender:!0},v}var a=t.prototype;return a.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},a.componentWillUnmount=function(){this.mounted=!1},t.getDerivedStateFromProps=function(f,v){var x=v.children,h=v.handleExited,z=v.firstRender;return{children:z?cL(f,h):hL(f,x,h),firstRender:!1}},a.handleExited=function(f,v){var x=Rv(this.props.children);f.key in x||(f.props.onExited&&f.props.onExited(v),this.mounted&&this.setState(function(h){var z=ct({},h.children);return delete z[f.key],{children:z}}))},a.render=function(){var f=this.props,v=f.component,x=f.childFactory,h=Bn(f,["component","childFactory"]),z=this.state.contextValue,B=dL(this.state.children).map(x);return delete h.appear,delete h.enter,delete h.exit,v===null?kl.createElement(lw.Provider,{value:z},B):kl.createElement(lw.Provider,{value:z},kl.createElement(v,h,B))},t}(kl.Component);Dv.propTypes={};Dv.defaultProps=pL;function fL(e){return Object.keys(e).length===0}function mL(e=null){const t=He.useContext(Nm);return!t||fL(t)?e:t}const gL=Ev();function yL(e=gL){return mL(e)}const _L=["className","component"];function vL(e={}){const{themeId:t,defaultTheme:a,defaultClassName:u="MuiBox-root",generateClassName:f}=e,v=ET("div",{shouldForwardProp:h=>h!=="theme"&&h!=="sx"&&h!=="as"})(Ud);return He.forwardRef(function(z,B){const Z=yL(a),U=Av(z),{className:O,component:de="div"}=U,he=Bn(U,_L);return Kt.jsx(v,ct({as:de,ref:B,className:Ln(O,f?f(u):u),theme:t&&Z[t]||Z},he))})}function xL(...e){return e.reduce((t,a)=>a==null?t:function(...f){t.apply(this,f),a.apply(this,f)},()=>{})}function bL(e,t=166){let a;function u(...f){const v=()=>{e.apply(this,f)};clearTimeout(a),a=setTimeout(v,t)}return u.clear=()=>{clearTimeout(a)},u}function wL(e,t){return()=>null}function SL(e,t){var a,u;return He.isValidElement(e)&&t.indexOf((a=e.type.muiName)!=null?a:(u=e.type)==null||(u=u._payload)==null||(u=u.value)==null?void 0:u.muiName)!==-1}function YT(e){return e&&e.ownerDocument||document}function TL(e){return YT(e).defaultView||window}function CL(e,t){return()=>null}let uw=0;function kL(e){const[t,a]=He.useState(e),u=e||t;return He.useEffect(()=>{t==null&&(uw+=1,a(`mui-${uw}`))},[t]),u}const cw=o_.useId;function IL(e){if(cw!==void 0){const t=cw();return e??t}return kL(e)}function EL(e,t,a,u,f){return null}function AL({controlled:e,default:t,name:a,state:u="value"}){const{current:f}=He.useRef(e!==void 0),[v,x]=He.useState(t),h=f?e:v,z=He.useCallback(B=>{f||x(B)},[]);return[h,z]}function PL(e){const{className:t,classes:a,pulsate:u=!1,rippleX:f,rippleY:v,rippleSize:x,in:h,onExited:z,timeout:B}=e,[Z,U]=He.useState(!1),O=Ln(t,a.ripple,a.rippleVisible,u&&a.ripplePulsate),de={width:x,height:x,top:-(x/2)+v,left:-(x/2)+f},he=Ln(a.child,Z&&a.childLeaving,u&&a.childPulsate);return!h&&!Z&&U(!0),He.useEffect(()=>{if(!h&&z!=null){const ae=setTimeout(z,B);return()=>{clearTimeout(ae)}}},[z,h,B]),Kt.jsx("span",{className:O,style:de,children:Kt.jsx("span",{className:he})})}const _o=Za("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),ML=["center","classes","className"];let og=e=>e,hw,dw,pw,fw;const l0=550,zL=80,LL=$m(hw||(hw=og`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),RL=$m(dw||(dw=og`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),DL=$m(pw||(pw=og`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),FL=da("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),BL=da(PL,{name:"MuiTouchRipple",slot:"Ripple"})(fw||(fw=og`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),_o.rippleVisible,LL,l0,({theme:e})=>e.transitions.easing.easeInOut,_o.ripplePulsate,({theme:e})=>e.transitions.duration.shorter,_o.child,_o.childLeaving,RL,l0,({theme:e})=>e.transitions.easing.easeInOut,_o.childPulsate,DL,({theme:e})=>e.transitions.easing.easeInOut),OL=He.forwardRef(function(t,a){const u=Hs({props:t,name:"MuiTouchRipple"}),{center:f=!1,classes:v={},className:x}=u,h=Bn(u,ML),[z,B]=He.useState([]),Z=He.useRef(0),U=He.useRef(null);He.useEffect(()=>{U.current&&(U.current(),U.current=null)},[z]);const O=He.useRef(!1),de=Qz(),he=He.useRef(null),ae=He.useRef(null),Ae=He.useCallback(_e=>{const{pulsate:Se,rippleX:Ee,rippleY:ke,rippleSize:Ze,cb:mt}=_e;B(tt=>[...tt,Kt.jsx(BL,{classes:{ripple:Ln(v.ripple,_o.ripple),rippleVisible:Ln(v.rippleVisible,_o.rippleVisible),ripplePulsate:Ln(v.ripplePulsate,_o.ripplePulsate),child:Ln(v.child,_o.child),childLeaving:Ln(v.childLeaving,_o.childLeaving),childPulsate:Ln(v.childPulsate,_o.childPulsate)},timeout:l0,pulsate:Se,rippleX:Ee,rippleY:ke,rippleSize:Ze},Z.current)]),Z.current+=1,U.current=mt},[v]),te=He.useCallback((_e={},Se={},Ee=()=>{})=>{const{pulsate:ke=!1,center:Ze=f||Se.pulsate,fakeElement:mt=!1}=Se;if((_e==null?void 0:_e.type)==="mousedown"&&O.current){O.current=!1;return}(_e==null?void 0:_e.type)==="touchstart"&&(O.current=!0);const tt=mt?null:ae.current,ot=tt?tt.getBoundingClientRect():{width:0,height:0,left:0,top:0};let $t,It,Bt;if(Ze||_e===void 0||_e.clientX===0&&_e.clientY===0||!_e.clientX&&!_e.touches)$t=Math.round(ot.width/2),It=Math.round(ot.height/2);else{const{clientX:Pr,clientY:Tr}=_e.touches&&_e.touches.length>0?_e.touches[0]:_e;$t=Math.round(Pr-ot.left),It=Math.round(Tr-ot.top)}if(Ze)Bt=Math.sqrt((2*ot.width**2+ot.height**2)/3),Bt%2===0&&(Bt+=1);else{const Pr=Math.max(Math.abs((tt?tt.clientWidth:0)-$t),$t)*2+2,Tr=Math.max(Math.abs((tt?tt.clientHeight:0)-It),It)*2+2;Bt=Math.sqrt(Pr**2+Tr**2)}_e!=null&&_e.touches?he.current===null&&(he.current=()=>{Ae({pulsate:ke,rippleX:$t,rippleY:It,rippleSize:Bt,cb:Ee})},de.start(zL,()=>{he.current&&(he.current(),he.current=null)})):Ae({pulsate:ke,rippleX:$t,rippleY:It,rippleSize:Bt,cb:Ee})},[f,Ae,de]),H=He.useCallback(()=>{te({},{pulsate:!0})},[te]),ie=He.useCallback((_e,Se)=>{if(de.clear(),(_e==null?void 0:_e.type)==="touchend"&&he.current){he.current(),he.current=null,de.start(0,()=>{ie(_e,Se)});return}he.current=null,B(Ee=>Ee.length>0?Ee.slice(1):Ee),U.current=Se},[de]);return He.useImperativeHandle(a,()=>({pulsate:H,start:te,stop:ie}),[H,te,ie]),Kt.jsx(FL,ct({className:Ln(_o.root,v.root,x),ref:ae},h,{children:Kt.jsx(Dv,{component:null,exit:!0,children:z})}))});function NL(e){return Ws("MuiButtonBase",e)}const $L=Za("MuiButtonBase",["root","disabled","focusVisible"]),UL=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],jL=e=>{const{disabled:t,focusVisible:a,focusVisibleClassName:u,classes:f}=e,x=jl({root:["root",t&&"disabled",a&&"focusVisible"]},NL,f);return a&&u&&(x.root+=` ${u}`),x},VL=da("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${$L.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),qL=He.forwardRef(function(t,a){const u=Hs({props:t,name:"MuiButtonBase"}),{action:f,centerRipple:v=!1,children:x,className:h,component:z="button",disabled:B=!1,disableRipple:Z=!1,disableTouchRipple:U=!1,focusRipple:O=!1,LinkComponent:de="a",onBlur:he,onClick:ae,onContextMenu:Ae,onDragLeave:te,onFocus:H,onFocusVisible:ie,onKeyDown:_e,onKeyUp:Se,onMouseDown:Ee,onMouseLeave:ke,onMouseUp:Ze,onTouchEnd:mt,onTouchMove:tt,onTouchStart:ot,tabIndex:$t=0,TouchRippleProps:It,touchRippleRef:Bt,type:Pr}=u,Tr=Bn(u,UL),Fr=He.useRef(null),Ve=He.useRef(null),gt=o0(Ve,Bt),{isFocusVisibleRef:yt,onFocus:Pt,onBlur:Vt,ref:Jn}=XT(),[_r,qr]=He.useState(!1);B&&_r&&qr(!1),He.useImperativeHandle(f,()=>({focusVisible:()=>{qr(!0),Fr.current.focus()}}),[]);const[Kr,Br]=He.useState(!1);He.useEffect(()=>{Br(!0)},[]);const Qn=Kr&&!Z&&!B;He.useEffect(()=>{_r&&O&&!Z&&Kr&&Ve.current.pulsate()},[Z,O,_r,Kr]);function an(_t,Yr,pi=U){return Yh(zi=>(Yr&&Yr(zi),!pi&&Ve.current&&Ve.current[_t](zi),!0))}const Ao=an("start",Ee),pa=an("stop",Ae),Ai=an("stop",te),no=an("stop",Ze),io=an("stop",_t=>{_r&&_t.preventDefault(),ke&&ke(_t)}),Zo=an("start",ot),xe=an("stop",mt),Po=an("stop",tt),fa=an("stop",_t=>{Vt(_t),yt.current===!1&&qr(!1),he&&he(_t)},!1),Lt=Yh(_t=>{Fr.current||(Fr.current=_t.currentTarget),Pt(_t),yt.current===!0&&(qr(!0),ie&&ie(_t)),H&&H(_t)}),ir=()=>{const _t=Fr.current;return z&&z!=="button"&&!(_t.tagName==="A"&&_t.href)},Mo=He.useRef(!1),oo=Yh(_t=>{O&&!Mo.current&&_r&&Ve.current&&_t.key===" "&&(Mo.current=!0,Ve.current.stop(_t,()=>{Ve.current.start(_t)})),_t.target===_t.currentTarget&&ir()&&_t.key===" "&&_t.preventDefault(),_e&&_e(_t),_t.target===_t.currentTarget&&ir()&&_t.key==="Enter"&&!B&&(_t.preventDefault(),ae&&ae(_t))}),Pi=Yh(_t=>{O&&_t.key===" "&&Ve.current&&_r&&!_t.defaultPrevented&&(Mo.current=!1,Ve.current.stop(_t,()=>{Ve.current.pulsate(_t)})),Se&&Se(_t),ae&&_t.target===_t.currentTarget&&ir()&&_t.key===" "&&!_t.defaultPrevented&&ae(_t)});let Mi=z;Mi==="button"&&(Tr.href||Tr.to)&&(Mi=de);const Xr={};Mi==="button"?(Xr.type=Pr===void 0?"button":Pr,Xr.disabled=B):(!Tr.href&&!Tr.to&&(Xr.role="button"),B&&(Xr["aria-disabled"]=B));const ma=o0(a,Jn,Fr),Go=ct({},u,{centerRipple:v,component:z,disabled:B,disableRipple:Z,disableTouchRipple:U,focusRipple:O,tabIndex:$t,focusVisible:_r}),ze=jL(Go);return Kt.jsxs(VL,ct({as:Mi,className:Ln(ze.root,h),ownerState:Go,onBlur:fa,onClick:ae,onContextMenu:pa,onFocus:Lt,onKeyDown:oo,onKeyUp:Pi,onMouseDown:Ao,onMouseLeave:io,onMouseUp:no,onDragLeave:Ai,onTouchEnd:xe,onTouchMove:Po,onTouchStart:Zo,ref:ma,tabIndex:B?-1:$t,type:Pr},Xr,Tr,{children:[x,Qn?Kt.jsx(OL,ct({ref:gt,center:v},It)):null]}))});function ZL(e){return Ws("MuiIconButton",e)}const GL=Za("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge"]),HL=["edge","children","className","color","disabled","disableFocusRipple","size"],WL=e=>{const{classes:t,disabled:a,color:u,edge:f,size:v}=e,x={root:["root",a&&"disabled",u!=="default"&&`color${on(u)}`,f&&`edge${on(f)}`,`size${on(v)}`]};return jl(x,ZL,t)},KL=da(qL,{name:"MuiIconButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.root,a.color!=="default"&&t[`color${on(a.color)}`],a.edge&&t[`edge${on(a.edge)}`],t[`size${on(a.size)}`]]}})(({theme:e,ownerState:t})=>ct({textAlign:"center",flex:"0 0 auto",fontSize:e.typography.pxToRem(24),padding:8,borderRadius:"50%",overflow:"visible",color:(e.vars||e).palette.action.active,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest})},!t.disableRipple&&{"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:lm(e.palette.action.active,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},t.edge==="start"&&{marginLeft:t.size==="small"?-3:-12},t.edge==="end"&&{marginRight:t.size==="small"?-3:-12}),({theme:e,ownerState:t})=>{var a;const u=(a=(e.vars||e).palette)==null?void 0:a[t.color];return ct({},t.color==="inherit"&&{color:"inherit"},t.color!=="inherit"&&t.color!=="default"&&ct({color:u==null?void 0:u.main},!t.disableRipple&&{"&:hover":ct({},u&&{backgroundColor:e.vars?`rgba(${u.mainChannel} / ${e.vars.palette.action.hoverOpacity})`:lm(u.main,e.palette.action.hoverOpacity)},{"@media (hover: none)":{backgroundColor:"transparent"}})}),t.size==="small"&&{padding:5,fontSize:e.typography.pxToRem(18)},t.size==="large"&&{padding:12,fontSize:e.typography.pxToRem(28)},{[`&.${GL.disabled}`]:{backgroundColor:"transparent",color:(e.vars||e).palette.action.disabled}})}),XL=He.forwardRef(function(t,a){const u=Hs({props:t,name:"MuiIconButton"}),{edge:f=!1,children:v,className:x,color:h="default",disabled:z=!1,disableFocusRipple:B=!1,size:Z="medium"}=u,U=Bn(u,HL),O=ct({},u,{edge:f,color:h,disabled:z,disableFocusRipple:B,size:Z}),de=WL(O);return Kt.jsx(KL,ct({className:Ln(de.root,x),centerRipple:!0,focusRipple:!B,disabled:z,ref:a},U,{ownerState:O,children:v}))}),mw=e=>{let t;return e<1?t=5.11916*e**2:t=4.5*Math.log(e+1)+2,(t/100).toFixed(2)};function YL(e){return Ws("MuiPaper",e)}Za("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const JL=["className","component","elevation","square","variant"],QL=e=>{const{square:t,elevation:a,variant:u,classes:f}=e,v={root:["root",u,!t&&"rounded",u==="elevation"&&`elevation${a}`]};return jl(v,YL,f)},e3=da("div",{name:"MuiPaper",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.root,t[a.variant],!a.square&&t.rounded,a.variant==="elevation"&&t[`elevation${a.elevation}`]]}})(({theme:e,ownerState:t})=>{var a;return ct({backgroundColor:(e.vars||e).palette.background.paper,color:(e.vars||e).palette.text.primary,transition:e.transitions.create("box-shadow")},!t.square&&{borderRadius:e.shape.borderRadius},t.variant==="outlined"&&{border:`1px solid ${(e.vars||e).palette.divider}`},t.variant==="elevation"&&ct({boxShadow:(e.vars||e).shadows[t.elevation]},!e.vars&&e.palette.mode==="dark"&&{backgroundImage:`linear-gradient(${lm("#fff",mw(t.elevation))}, ${lm("#fff",mw(t.elevation))})`},e.vars&&{backgroundImage:(a=e.vars.overlays)==null?void 0:a[t.elevation]}))}),t3=He.forwardRef(function(t,a){const u=Hs({props:t,name:"MuiPaper"}),{className:f,component:v="div",elevation:x=1,square:h=!1,variant:z="elevation"}=u,B=Bn(u,JL),Z=ct({},u,{component:v,elevation:x,square:h,variant:z}),U=QL(Z);return Kt.jsx(e3,ct({as:v,ownerState:Z,className:Ln(U.root,f),ref:a},B))});function r3(e){return Ws("MuiAppBar",e)}Za("MuiAppBar",["root","positionFixed","positionAbsolute","positionSticky","positionStatic","positionRelative","colorDefault","colorPrimary","colorSecondary","colorInherit","colorTransparent","colorError","colorInfo","colorSuccess","colorWarning"]);const n3=["className","color","enableColorOnDark","position"],i3=e=>{const{color:t,position:a,classes:u}=e,f={root:["root",`color${on(t)}`,`position${on(a)}`]};return jl(f,r3,u)},hf=(e,t)=>e?`${e==null?void 0:e.replace(")","")}, ${t})`:t,o3=da(t3,{name:"MuiAppBar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.root,t[`position${on(a.position)}`],t[`color${on(a.color)}`]]}})(({theme:e,ownerState:t})=>{const a=e.palette.mode==="light"?e.palette.grey[100]:e.palette.grey[900];return ct({display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",flexShrink:0},t.position==="fixed"&&{position:"fixed",zIndex:(e.vars||e).zIndex.appBar,top:0,left:"auto",right:0,"@media print":{position:"absolute"}},t.position==="absolute"&&{position:"absolute",zIndex:(e.vars||e).zIndex.appBar,top:0,left:"auto",right:0},t.position==="sticky"&&{position:"sticky",zIndex:(e.vars||e).zIndex.appBar,top:0,left:"auto",right:0},t.position==="static"&&{position:"static"},t.position==="relative"&&{position:"relative"},!e.vars&&ct({},t.color==="default"&&{backgroundColor:a,color:e.palette.getContrastText(a)},t.color&&t.color!=="default"&&t.color!=="inherit"&&t.color!=="transparent"&&{backgroundColor:e.palette[t.color].main,color:e.palette[t.color].contrastText},t.color==="inherit"&&{color:"inherit"},e.palette.mode==="dark"&&!t.enableColorOnDark&&{backgroundColor:null,color:null},t.color==="transparent"&&ct({backgroundColor:"transparent",color:"inherit"},e.palette.mode==="dark"&&{backgroundImage:"none"})),e.vars&&ct({},t.color==="default"&&{"--AppBar-background":t.enableColorOnDark?e.vars.palette.AppBar.defaultBg:hf(e.vars.palette.AppBar.darkBg,e.vars.palette.AppBar.defaultBg),"--AppBar-color":t.enableColorOnDark?e.vars.palette.text.primary:hf(e.vars.palette.AppBar.darkColor,e.vars.palette.text.primary)},t.color&&!t.color.match(/^(default|inherit|transparent)$/)&&{"--AppBar-background":t.enableColorOnDark?e.vars.palette[t.color].main:hf(e.vars.palette.AppBar.darkBg,e.vars.palette[t.color].main),"--AppBar-color":t.enableColorOnDark?e.vars.palette[t.color].contrastText:hf(e.vars.palette.AppBar.darkColor,e.vars.palette[t.color].contrastText)},!["inherit","transparent"].includes(t.color)&&{backgroundColor:"var(--AppBar-background)"},{color:t.color==="inherit"?"inherit":"var(--AppBar-color)"},t.color==="transparent"&&{backgroundImage:"none",backgroundColor:"transparent",color:"inherit"}))}),a3=He.forwardRef(function(t,a){const u=Hs({props:t,name:"MuiAppBar"}),{className:f,color:v="primary",enableColorOnDark:x=!1,position:h="fixed"}=u,z=Bn(u,n3),B=ct({},u,{color:v,position:h,enableColorOnDark:x}),Z=i3(B);return Kt.jsx(o3,ct({square:!0,component:"header",ownerState:B,elevation:4,className:Ln(Z.root,f,h==="fixed"&&"mui-fixed"),ref:a},z))});var Fv={},r_={};function s3(e){return Ws("MuiSvgIcon",e)}Za("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const l3=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],u3=e=>{const{color:t,fontSize:a,classes:u}=e,f={root:["root",t!=="inherit"&&`color${on(t)}`,`fontSize${on(a)}`]};return jl(f,s3,u)},c3=da("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.root,a.color!=="inherit"&&t[`color${on(a.color)}`],t[`fontSize${on(a.fontSize)}`]]}})(({theme:e,ownerState:t})=>{var a,u,f,v,x,h,z,B,Z,U,O,de,he;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:t.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:(a=e.transitions)==null||(u=a.create)==null?void 0:u.call(a,"fill",{duration:(f=e.transitions)==null||(f=f.duration)==null?void 0:f.shorter}),fontSize:{inherit:"inherit",small:((v=e.typography)==null||(x=v.pxToRem)==null?void 0:x.call(v,20))||"1.25rem",medium:((h=e.typography)==null||(z=h.pxToRem)==null?void 0:z.call(h,24))||"1.5rem",large:((B=e.typography)==null||(Z=B.pxToRem)==null?void 0:Z.call(B,35))||"2.1875rem"}[t.fontSize],color:(U=(O=(e.vars||e).palette)==null||(O=O[t.color])==null?void 0:O.main)!=null?U:{action:(de=(e.vars||e).palette)==null||(de=de.action)==null?void 0:de.active,disabled:(he=(e.vars||e).palette)==null||(he=he.action)==null?void 0:he.disabled,inherit:void 0}[t.color]}}),u0=He.forwardRef(function(t,a){const u=Hs({props:t,name:"MuiSvgIcon"}),{children:f,className:v,color:x="inherit",component:h="svg",fontSize:z="medium",htmlColor:B,inheritViewBox:Z=!1,titleAccess:U,viewBox:O="0 0 24 24"}=u,de=Bn(u,l3),he=He.isValidElement(f)&&f.type==="svg",ae=ct({},u,{color:x,component:h,fontSize:z,instanceFontSize:t.fontSize,inheritViewBox:Z,viewBox:O,hasSvgAsChild:he}),Ae={};Z||(Ae.viewBox=O);const te=u3(ae);return Kt.jsxs(c3,ct({as:h,className:Ln(te.root,v),focusable:"false",color:B,"aria-hidden":U?void 0:!0,role:U?"img":void 0,ref:a},Ae,de,he&&f.props,{ownerState:ae,children:[he?f.props.children:f,U?Kt.jsx("title",{children:U}):null]}))});u0.muiName="SvgIcon";function h3(e,t){function a(u,f){return Kt.jsx(u0,ct({"data-testid":`${t}Icon`,ref:f},u,{children:e}))}return a.muiName=u0.muiName,He.memo(He.forwardRef(a))}const d3={configure:e=>{Pv.configure(e)}},p3=Object.freeze(Object.defineProperty({__proto__:null,capitalize:on,createChainedFunction:xL,createSvgIcon:h3,debounce:bL,deprecatedPropType:wL,isMuiElement:SL,ownerDocument:YT,ownerWindow:TL,requirePropFactory:CL,setRef:WT,unstable_ClassNameGenerator:d3,unstable_useEnhancedEffect:KT,unstable_useId:IL,unsupportedProp:EL,useControlled:AL,useEventCallback:Yh,useForkRef:o0,useIsFocusVisible:XT},Symbol.toStringTag,{value:"Module"})),f3=Va(p3);var gw;function m3(){return gw||(gw=1,function(e){"use client";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"default",{enumerable:!0,get:function(){return t.createSvgIcon}});var t=f3}(r_)),r_}var g3=fv;Object.defineProperty(Fv,"__esModule",{value:!0});var JT=Fv.default=void 0,y3=g3(m3()),_3=Kt;JT=Fv.default=(0,y3.default)((0,_3.jsx)("path",{d:"M3 18h18v-2H3zm0-5h18v-2H3zm0-7v2h18V6z"}),"Menu");function v3({handleDrawerOpen:e,open:t}){const u=da(a3,{shouldForwardProp:f=>f!=="open"})(({theme:f,open:v})=>({transition:f.transitions.create("margin",{easing:f.transitions.easing.sharp,duration:f.transitions.duration.leavingScreen}),...v&&{width:"calc(100% - 250px)",marginLeft:"-250px",transition:f.transitions.create("margin",{easing:f.transitions.easing.easeOut,duration:f.transitions.duration.enteringScreen})}}));return Kt.jsx(u,{position:"fixed",open:t,sx:{p:0},children:Kt.jsxs(jz,{children:[Kt.jsx(XL,{edge:"start",color:"inherit","aria-label":"open drawer",onClick:e,sx:{mr:2,...t&&{display:"none"}},children:Kt.jsx(JT,{})}),Kt.jsx(Kz,{variant:"h6",color:"inherit",component:"div",children:"Honolulu Accommodation"})]})})}var QT={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.7.0/LICENSE.txt
 */(function(e,t){(function(a,u){e.exports=u()})(BI,function(){var a={},u={};function f(x,h,z){if(u[x]=z,x==="index"){var B="var sharedModule = {}; ("+u.shared+")(sharedModule); ("+u.worker+")(sharedModule);",Z={};return u.shared(Z),u.index(a,Z),typeof window<"u"&&a.setWorkerUrl(window.URL.createObjectURL(new Blob([B],{type:"text/javascript"}))),a}}f("shared",["exports"],function(x){function h(i,n,o,l){return new(o||(o=Promise))(function(p,y){function _(k){try{S(l.next(k))}catch(I){y(I)}}function b(k){try{S(l.throw(k))}catch(I){y(I)}}function S(k){var I;k.done?p(k.value):(I=k.value,I instanceof o?I:new o(function(A){A(I)})).then(_,b)}S((l=l.apply(i,n||[])).next())})}function z(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}typeof SuppressedError=="function"&&SuppressedError;var B=Z;function Z(i,n){this.x=i,this.y=n}Z.prototype={clone:function(){return new Z(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,n){return this.clone()._rotateAround(i,n)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var n=i.x-this.x,o=i.y-this.y;return n*n+o*o},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,n){return Math.atan2(this.x*n-this.y*i,this.x*i+this.y*n)},_matMult:function(i){var n=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=n,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var n=Math.cos(i),o=Math.sin(i),l=o*this.x+n*this.y;return this.x=n*this.x-o*this.y,this.y=l,this},_rotateAround:function(i,n){var o=Math.cos(i),l=Math.sin(i),p=n.y+l*(this.x-n.x)+o*(this.y-n.y);return this.x=n.x+o*(this.x-n.x)-l*(this.y-n.y),this.y=p,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Z.convert=function(i){return i instanceof Z?i:Array.isArray(i)?new Z(i[0],i[1]):i};var U=z(B),O=de;function de(i,n,o,l){this.cx=3*i,this.bx=3*(o-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(l-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=n,this.p2x=o,this.p2y=l}de.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,n){if(n===void 0&&(n=1e-6),i<0)return 0;if(i>1)return 1;for(var o=i,l=0;l<8;l++){var p=this.sampleCurveX(o)-i;if(Math.abs(p)<n)return o;var y=this.sampleCurveDerivativeX(o);if(Math.abs(y)<1e-6)break;o-=p/y}var _=0,b=1;for(o=i,l=0;l<20&&(p=this.sampleCurveX(o),!(Math.abs(p-i)<n));l++)i>p?_=o:b=o,o=.5*(b-_)+_;return o},solve:function(i,n){return this.sampleCurveY(this.solveCurveX(i,n))}};var he=z(O);let ae,Ae;function te(){return ae==null&&(ae=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),ae}function H(){if(Ae==null&&(Ae=!1,te())){const n=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(n){for(let l=0;l<5*5;l++){const p=4*l;n.fillStyle=`rgb(${p},${p+1},${p+2})`,n.fillRect(l%5,Math.floor(l/5),1,1)}const o=n.getImageData(0,0,5,5).data;for(let l=0;l<5*5*4;l++)if(l%4!=3&&o[l]!==l){Ae=!0;break}}}return Ae||!1}function ie(i,n,o,l){const p=new he(i,n,o,l);return y=>p.solve(y)}const _e=ie(.25,.1,.25,1);function Se(i,n,o){return Math.min(o,Math.max(n,i))}function Ee(i,n,o){const l=o-n,p=((i-n)%l+l)%l+n;return p===n?o:p}function ke(i,...n){for(const o of n)for(const l in o)i[l]=o[l];return i}let Ze=1;function mt(i,n,o){const l={};for(const p in i)l[p]=n.call(this,i[p],p,i);return l}function tt(i,n,o){const l={};for(const p in i)n.call(this,i[p],p,i)&&(l[p]=i[p]);return l}function ot(i){return Array.isArray(i)?i.map(ot):typeof i=="object"&&i?mt(i,ot):i}const $t={};function It(i){$t[i]||(typeof console<"u"&&console.warn(i),$t[i]=!0)}function Bt(i,n,o){return(o.y-i.y)*(n.x-i.x)>(n.y-i.y)*(o.x-i.x)}function Pr(i){return typeof WorkerGlobalScope<"u"&&i!==void 0&&i instanceof WorkerGlobalScope}let Tr=null;function Fr(i){return typeof ImageBitmap<"u"&&i instanceof ImageBitmap}const Ve="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function gt(i,n,o,l,p){return h(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const y=new VideoFrame(i,{timestamp:0});try{const _=y==null?void 0:y.format;if(!_||!_.startsWith("BGR")&&!_.startsWith("RGB"))throw new Error(`Unrecognized format ${_}`);const b=_.startsWith("BGR"),S=new Uint8ClampedArray(l*p*4);if(yield y.copyTo(S,function(k,I,A,L,F){const $=4*Math.max(-I,0),j=(Math.max(0,A)-A)*L*4+$,K=4*L,Q=Math.max(0,I),ge=Math.max(0,A);return{rect:{x:Q,y:ge,width:Math.min(k.width,I+L)-Q,height:Math.min(k.height,A+F)-ge},layout:[{offset:j,stride:K}]}}(i,n,o,l,p)),b)for(let k=0;k<S.length;k+=4){const I=S[k];S[k]=S[k+2],S[k+2]=I}return S}finally{y.close()}})}let yt,Pt;const Vt="AbortError";function Jn(){return new Error(Vt)}const _r={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function qr(i){return _r.REGISTERED_PROTOCOLS[i.substring(0,i.indexOf("://"))]}const Kr="global-dispatcher";class Br extends Error{constructor(n,o,l,p){super(`AJAXError: ${o} (${n}): ${l}`),this.status=n,this.statusText=o,this.url=l,this.body=p}}const Qn=()=>Pr(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,an=function(i,n){if(/:\/\//.test(i.url)&&!/^https?:|^file:/.test(i.url)){const l=qr(i.url);if(l)return l(i,n);if(Pr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:i,targetMapId:Kr},n)}if(!(/^file:/.test(o=i.url)||/^file:/.test(Qn())&&!/^\w+:/.test(o))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(l,p){return h(this,void 0,void 0,function*(){const y=new Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,cache:l.cache,referrer:Qn(),signal:p.signal});l.type!=="json"||y.headers.has("Accept")||y.headers.set("Accept","application/json");const _=yield fetch(y);if(!_.ok){const k=yield _.blob();throw new Br(_.status,_.statusText,l.url,k)}let b;b=l.type==="arrayBuffer"||l.type==="image"?_.arrayBuffer():l.type==="json"?_.json():_.text();const S=yield b;if(p.signal.aborted)throw Jn();return{data:S,cacheControl:_.headers.get("Cache-Control"),expires:_.headers.get("Expires")}})}(i,n);if(Pr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:i,mustQueue:!0,targetMapId:Kr},n)}var o;return function(l,p){return new Promise((y,_)=>{var b;const S=new XMLHttpRequest;S.open(l.method||"GET",l.url,!0),l.type!=="arrayBuffer"&&l.type!=="image"||(S.responseType="arraybuffer");for(const k in l.headers)S.setRequestHeader(k,l.headers[k]);l.type==="json"&&(S.responseType="text",!((b=l.headers)===null||b===void 0)&&b.Accept||S.setRequestHeader("Accept","application/json")),S.withCredentials=l.credentials==="include",S.onerror=()=>{_(new Error(S.statusText))},S.onload=()=>{if(!p.signal.aborted)if((S.status>=200&&S.status<300||S.status===0)&&S.response!==null){let k=S.response;if(l.type==="json")try{k=JSON.parse(S.response)}catch(I){return void _(I)}y({data:k,cacheControl:S.getResponseHeader("Cache-Control"),expires:S.getResponseHeader("Expires")})}else{const k=new Blob([S.response],{type:S.getResponseHeader("Content-Type")});_(new Br(S.status,S.statusText,l.url,k))}},p.signal.addEventListener("abort",()=>{S.abort(),_(Jn())}),S.send(l.body)})}(i,n)};function Ao(i){if(!i||i.indexOf("://")<=0||i.indexOf("data:image/")===0||i.indexOf("blob:")===0)return!0;const n=new URL(i),o=window.location;return n.protocol===o.protocol&&n.host===o.host}function pa(i,n,o){o[i]&&o[i].indexOf(n)!==-1||(o[i]=o[i]||[],o[i].push(n))}function Ai(i,n,o){if(o&&o[i]){const l=o[i].indexOf(n);l!==-1&&o[i].splice(l,1)}}class no{constructor(n,o={}){ke(this,o),this.type=n}}class io extends no{constructor(n,o={}){super("error",ke({error:n},o))}}class Zo{on(n,o){return this._listeners=this._listeners||{},pa(n,o,this._listeners),this}off(n,o){return Ai(n,o,this._listeners),Ai(n,o,this._oneTimeListeners),this}once(n,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},pa(n,o,this._oneTimeListeners),this):new Promise(l=>this.once(n,l))}fire(n,o){typeof n=="string"&&(n=new no(n,o||{}));const l=n.type;if(this.listens(l)){n.target=this;const p=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];for(const b of p)b.call(this,n);const y=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];for(const b of y)Ai(l,b,this._oneTimeListeners),b.call(this,n);const _=this._eventedParent;_&&(ke(n,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),_.fire(n))}else n instanceof io&&console.error(n.error);return this}listens(n){return this._listeners&&this._listeners[n]&&this._listeners[n].length>0||this._oneTimeListeners&&this._oneTimeListeners[n]&&this._oneTimeListeners[n].length>0||this._eventedParent&&this._eventedParent.listens(n)}setEventedParent(n,o){return this._eventedParent=n,this._eventedParentData=o,this}}var xe={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Po=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function fa(i,n){const o={};for(const l in i)l!=="ref"&&(o[l]=i[l]);return Po.forEach(l=>{l in n&&(o[l]=n[l])}),o}function Lt(i,n){if(Array.isArray(i)){if(!Array.isArray(n)||i.length!==n.length)return!1;for(let o=0;o<i.length;o++)if(!Lt(i[o],n[o]))return!1;return!0}if(typeof i=="object"&&i!==null&&n!==null){if(typeof n!="object"||Object.keys(i).length!==Object.keys(n).length)return!1;for(const o in i)if(!Lt(i[o],n[o]))return!1;return!0}return i===n}function ir(i,n){i.push(n)}function Mo(i,n,o){ir(o,{command:"addSource",args:[i,n[i]]})}function oo(i,n,o){ir(n,{command:"removeSource",args:[i]}),o[i]=!0}function Pi(i,n,o,l){oo(i,o,l),Mo(i,n,o)}function Mi(i,n,o){let l;for(l in i[o])if(Object.prototype.hasOwnProperty.call(i[o],l)&&l!=="data"&&!Lt(i[o][l],n[o][l]))return!1;for(l in n[o])if(Object.prototype.hasOwnProperty.call(n[o],l)&&l!=="data"&&!Lt(i[o][l],n[o][l]))return!1;return!0}function Xr(i,n,o,l,p,y){i=i||{},n=n||{};for(const _ in i)Object.prototype.hasOwnProperty.call(i,_)&&(Lt(i[_],n[_])||o.push({command:y,args:[l,_,n[_],p]}));for(const _ in n)Object.prototype.hasOwnProperty.call(n,_)&&!Object.prototype.hasOwnProperty.call(i,_)&&(Lt(i[_],n[_])||o.push({command:y,args:[l,_,n[_],p]}))}function ma(i){return i.id}function Go(i,n){return i[n.id]=n,i}class ze{constructor(n,o,l,p){this.message=(n?`${n}: `:"")+l,p&&(this.identifier=p),o!=null&&o.__line__&&(this.line=o.__line__)}}function _t(i,...n){for(const o of n)for(const l in o)i[l]=o[l];return i}class Yr extends Error{constructor(n,o){super(o),this.message=o,this.key=n}}class pi{constructor(n,o=[]){this.parent=n,this.bindings={};for(const[l,p]of o)this.bindings[l]=p}concat(n){return new pi(this,n)}get(n){if(this.bindings[n])return this.bindings[n];if(this.parent)return this.parent.get(n);throw new Error(`${n} not found in scope.`)}has(n){return!!this.bindings[n]||!!this.parent&&this.parent.has(n)}}const zi={kind:"null"},Be={kind:"number"},Tt={kind:"string"},ht={kind:"boolean"},On={kind:"color"},Li={kind:"object"},xt={kind:"value"},ao={kind:"collator"},zo={kind:"formatted"},Ho={kind:"padding"},so={kind:"resolvedImage"},J={kind:"variableAnchorOffsetCollection"};function D(i,n){return{kind:"array",itemType:i,N:n}}function R(i){if(i.kind==="array"){const n=R(i.itemType);return typeof i.N=="number"?`array<${n}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${n}>`}return i.kind}const q=[zi,Be,Tt,ht,On,zo,Li,D(xt),Ho,so,J];function X(i,n){if(n.kind==="error")return null;if(i.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!X(i.itemType,n.itemType))&&(typeof i.N!="number"||i.N===n.N))return null}else{if(i.kind===n.kind)return null;if(i.kind==="value"){for(const o of q)if(!X(o,n))return null}}return`Expected ${R(i)} but found ${R(n)} instead.`}function le(i,n){return n.some(o=>o.kind===i.kind)}function ce(i,n){return n.some(o=>o==="null"?i===null:o==="array"?Array.isArray(i):o==="object"?i&&!Array.isArray(i)&&typeof i=="object":o===typeof i)}function me(i,n){return i.kind==="array"&&n.kind==="array"?i.itemType.kind===n.itemType.kind&&typeof i.N=="number":i.kind===n.kind}const ne=.96422,we=.82521,Ie=4/29,ve=6/29,Re=3*ve*ve,nt=ve*ve*ve,at=Math.PI/180,Rt=180/Math.PI;function bt(i){return(i%=360)<0&&(i+=360),i}function Dt([i,n,o,l]){let p,y;const _=Or((.2225045*(i=Et(i))+.7168786*(n=Et(n))+.0606169*(o=Et(o)))/1);i===n&&n===o?p=y=_:(p=Or((.4360747*i+.3850649*n+.1430804*o)/ne),y=Or((.0139322*i+.0971045*n+.7141733*o)/we));const b=116*_-16;return[b<0?0:b,500*(p-_),200*(_-y),l]}function Et(i){return i<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function Or(i){return i>nt?Math.pow(i,1/3):i/Re+Ie}function xr([i,n,o,l]){let p=(i+16)/116,y=isNaN(n)?p:p+n/500,_=isNaN(o)?p:p-o/200;return p=1*Ht(p),y=ne*Ht(y),_=we*Ht(_),[Ct(3.1338561*y-1.6168667*p-.4906146*_),Ct(-.9787684*y+1.9161415*p+.033454*_),Ct(.0719453*y-.2289914*p+1.4052427*_),l]}function Ct(i){return(i=i<=.00304?12.92*i:1.055*Math.pow(i,1/2.4)-.055)<0?0:i>1?1:i}function Ht(i){return i>ve?i*i*i:Re*(i-Ie)}function yr(i){return parseInt(i.padEnd(2,i),16)/255}function Jr(i,n){return sn(n?i/100:i,0,1)}function sn(i,n,o){return Math.min(Math.max(n,i),o)}function Cn(i){return!i.some(Number.isNaN)}const Ga={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Wt{constructor(n,o,l,p=1,y=!0){this.r=n,this.g=o,this.b=l,this.a=p,y||(this.r*=p,this.g*=p,this.b*=p,p||this.overwriteGetter("rgb",[n,o,l,p]))}static parse(n){if(n instanceof Wt)return n;if(typeof n!="string")return;const o=function(l){if((l=l.toLowerCase().trim())==="transparent")return[0,0,0,0];const p=Ga[l];if(p){const[_,b,S]=p;return[_/255,b/255,S/255,1]}if(l.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(l)){const _=l.length<6?1:2;let b=1;return[yr(l.slice(b,b+=_)),yr(l.slice(b,b+=_)),yr(l.slice(b,b+=_)),yr(l.slice(b,b+_)||"ff")]}if(l.startsWith("rgb")){const _=l.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(_){const[b,S,k,I,A,L,F,$,j,K,Q,ge]=_,se=[I||" ",F||" ",K].join("");if(se==="  "||se==="  /"||se===",,"||se===",,,"){const fe=[k,L,j].join(""),be=fe==="%%%"?100:fe===""?255:0;if(be){const Pe=[sn(+S/be,0,1),sn(+A/be,0,1),sn(+$/be,0,1),Q?Jr(+Q,ge):1];if(Cn(Pe))return Pe}}return}}const y=l.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(y){const[_,b,S,k,I,A,L,F,$]=y,j=[S||" ",I||" ",L].join("");if(j==="  "||j==="  /"||j===",,"||j===",,,"){const K=[+b,sn(+k,0,100),sn(+A,0,100),F?Jr(+F,$):1];if(Cn(K))return function([Q,ge,se,fe]){function be(Pe){const qe=(Pe+Q/30)%12,st=ge*Math.min(se,1-se);return se-st*Math.max(-1,Math.min(qe-3,9-qe,1))}return Q=bt(Q),ge/=100,se/=100,[be(0),be(8),be(4),fe]}(K)}}}(n);return o?new Wt(...o,!1):void 0}get rgb(){const{r:n,g:o,b:l,a:p}=this,y=p||1/0;return this.overwriteGetter("rgb",[n/y,o/y,l/y,p])}get hcl(){return this.overwriteGetter("hcl",function(n){const[o,l,p,y]=Dt(n),_=Math.sqrt(l*l+p*p);return[Math.round(1e4*_)?bt(Math.atan2(p,l)*Rt):NaN,_,o,y]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Dt(this.rgb))}overwriteGetter(n,o){return Object.defineProperty(this,n,{value:o}),o}toString(){const[n,o,l,p]=this.rgb;return`rgba(${[n,o,l].map(y=>Math.round(255*y)).join(",")},${p})`}}Wt.black=new Wt(0,0,0,1),Wt.white=new Wt(1,1,1,1),Wt.transparent=new Wt(0,0,0,0),Wt.red=new Wt(1,0,0,1);class Ac{constructor(n,o,l){this.sensitivity=n?o?"variant":"case":o?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(n,o){return this.collator.compare(n,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Pc{constructor(n,o,l,p,y){this.text=n,this.image=o,this.scale=l,this.fontStack=p,this.textColor=y}}class ei{constructor(n){this.sections=n}static fromString(n){return new ei([new Pc(n,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(n=>n.text.length!==0||n.image&&n.image.name.length!==0)}static factory(n){return n instanceof ei?n:ei.fromString(n)}toString(){return this.sections.length===0?"":this.sections.map(n=>n.text).join("")}}class ti{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof ti)return n;if(typeof n=="number")return new ti([n,n,n,n]);if(Array.isArray(n)&&!(n.length<1||n.length>4)){for(const o of n)if(typeof o!="number")return;switch(n.length){case 1:n=[n[0],n[0],n[0],n[0]];break;case 2:n=[n[0],n[1],n[0],n[1]];break;case 3:n=[n[0],n[1],n[2],n[1]]}return new ti(n)}}toString(){return JSON.stringify(this.values)}}const cg=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class fi{constructor(n){this.values=n.slice()}static parse(n){if(n instanceof fi)return n;if(Array.isArray(n)&&!(n.length<1)&&n.length%2==0){for(let o=0;o<n.length;o+=2){const l=n[o],p=n[o+1];if(typeof l!="string"||!cg.has(l)||!Array.isArray(p)||p.length!==2||typeof p[0]!="number"||typeof p[1]!="number")return}return new fi(n)}}toString(){return JSON.stringify(this.values)}}class ri{constructor(n){this.name=n.name,this.available=n.available}toString(){return this.name}static fromString(n){return n?new ri({name:n,available:!1}):null}}function Ha(i,n,o,l){return typeof i=="number"&&i>=0&&i<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof o=="number"&&o>=0&&o<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:`Invalid rgba value [${[i,n,o,l].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof l=="number"?[i,n,o,l]:[i,n,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ga(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof Wt||i instanceof Ac||i instanceof ei||i instanceof ti||i instanceof fi||i instanceof ri)return!0;if(Array.isArray(i)){for(const n of i)if(!ga(n))return!1;return!0}if(typeof i=="object"){for(const n in i)if(!ga(i[n]))return!1;return!0}return!1}function Nr(i){if(i===null)return zi;if(typeof i=="string")return Tt;if(typeof i=="boolean")return ht;if(typeof i=="number")return Be;if(i instanceof Wt)return On;if(i instanceof Ac)return ao;if(i instanceof ei)return zo;if(i instanceof ti)return Ho;if(i instanceof fi)return J;if(i instanceof ri)return so;if(Array.isArray(i)){const n=i.length;let o;for(const l of i){const p=Nr(l);if(o){if(o===p)continue;o=xt;break}o=p}return D(o||xt,n)}return Li}function Ks(i){const n=typeof i;return i===null?"":n==="string"||n==="number"||n==="boolean"?String(i):i instanceof Wt||i instanceof ei||i instanceof ti||i instanceof fi||i instanceof ri?i.toString():JSON.stringify(i)}class Ri{constructor(n,o){this.type=n,this.value=o}static parse(n,o){if(n.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${n.length-1} instead.`);if(!ga(n[1]))return o.error("invalid value");const l=n[1];let p=Nr(l);const y=o.expectedType;return p.kind!=="array"||p.N!==0||!y||y.kind!=="array"||typeof y.N=="number"&&y.N!==0||(p=y),new Ri(p,l)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Mr{constructor(n){this.name="ExpressionEvaluationError",this.message=n}toJSON(){return this.message}}const Vl={string:Tt,number:Be,boolean:ht,object:Li};class Di{constructor(n,o){this.type=n,this.args=o}static parse(n,o){if(n.length<2)return o.error("Expected at least one argument.");let l,p=1;const y=n[0];if(y==="array"){let b,S;if(n.length>2){const k=n[1];if(typeof k!="string"||!(k in Vl)||k==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);b=Vl[k],p++}else b=xt;if(n.length>3){if(n[2]!==null&&(typeof n[2]!="number"||n[2]<0||n[2]!==Math.floor(n[2])))return o.error('The length argument to "array" must be a positive integer literal',2);S=n[2],p++}l=D(b,S)}else{if(!Vl[y])throw new Error(`Types doesn't contain name = ${y}`);l=Vl[y]}const _=[];for(;p<n.length;p++){const b=o.parse(n[p],p,xt);if(!b)return null;_.push(b)}return new Di(l,_)}evaluate(n){for(let o=0;o<this.args.length;o++){const l=this.args[o].evaluate(n);if(!X(this.type,Nr(l)))return l;if(o===this.args.length-1)throw new Mr(`Expected value to be of type ${R(this.type)}, but found ${R(Nr(l))} instead.`)}throw new Error}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}const Mc={"to-boolean":ht,"to-color":On,"to-number":Be,"to-string":Tt};class Fi{constructor(n,o){this.type=n,this.args=o}static parse(n,o){if(n.length<2)return o.error("Expected at least one argument.");const l=n[0];if(!Mc[l])throw new Error(`Can't parse ${l} as it is not part of the known types`);if((l==="to-boolean"||l==="to-string")&&n.length!==2)return o.error("Expected one argument.");const p=Mc[l],y=[];for(let _=1;_<n.length;_++){const b=o.parse(n[_],_,xt);if(!b)return null;y.push(b)}return new Fi(p,y)}evaluate(n){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(n);case"color":{let o,l;for(const p of this.args){if(o=p.evaluate(n),l=null,o instanceof Wt)return o;if(typeof o=="string"){const y=n.parseColor(o);if(y)return y}else if(Array.isArray(o)&&(l=o.length<3||o.length>4?`Invalid rbga value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:Ha(o[0],o[1],o[2],o[3]),!l))return new Wt(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new Mr(l||`Could not parse color from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"padding":{let o;for(const l of this.args){o=l.evaluate(n);const p=ti.parse(o);if(p)return p}throw new Mr(`Could not parse padding from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"variableAnchorOffsetCollection":{let o;for(const l of this.args){o=l.evaluate(n);const p=fi.parse(o);if(p)return p}throw new Mr(`Could not parse variableAnchorOffsetCollection from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"number":{let o=null;for(const l of this.args){if(o=l.evaluate(n),o===null)return 0;const p=Number(o);if(!isNaN(p))return p}throw new Mr(`Could not convert ${JSON.stringify(o)} to number.`)}case"formatted":return ei.fromString(Ks(this.args[0].evaluate(n)));case"resolvedImage":return ri.fromString(Ks(this.args[0].evaluate(n)));default:return Ks(this.args[0].evaluate(n))}}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}const hg=["Unknown","Point","LineString","Polygon"];class ql{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?hg[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(n){let o=this._parseColorCache[n];return o||(o=this._parseColorCache[n]=Wt.parse(n)),o}}class ya{constructor(n,o,l=[],p,y=new pi,_=[]){this.registry=n,this.path=l,this.key=l.map(b=>`[${b}]`).join(""),this.scope=y,this.errors=_,this.expectedType=p,this._isConstant=o}parse(n,o,l,p,y={}){return o?this.concat(o,l,p)._parse(n,y):this._parse(n,y)}_parse(n,o){function l(p,y,_){return _==="assert"?new Di(y,[p]):_==="coerce"?new Fi(y,[p]):p}if(n!==null&&typeof n!="string"&&typeof n!="boolean"&&typeof n!="number"||(n=["literal",n]),Array.isArray(n)){if(n.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const p=n[0];if(typeof p!="string")return this.error(`Expression name must be a string, but found ${typeof p} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const y=this.registry[p];if(y){let _=y.parse(n,this);if(!_)return null;if(this.expectedType){const b=this.expectedType,S=_.type;if(b.kind!=="string"&&b.kind!=="number"&&b.kind!=="boolean"&&b.kind!=="object"&&b.kind!=="array"||S.kind!=="value")if(b.kind!=="color"&&b.kind!=="formatted"&&b.kind!=="resolvedImage"||S.kind!=="value"&&S.kind!=="string")if(b.kind!=="padding"||S.kind!=="value"&&S.kind!=="number"&&S.kind!=="array")if(b.kind!=="variableAnchorOffsetCollection"||S.kind!=="value"&&S.kind!=="array"){if(this.checkSubtype(b,S))return null}else _=l(_,b,o.typeAnnotation||"coerce");else _=l(_,b,o.typeAnnotation||"coerce");else _=l(_,b,o.typeAnnotation||"coerce");else _=l(_,b,o.typeAnnotation||"assert")}if(!(_ instanceof Ri)&&_.type.kind!=="resolvedImage"&&this._isConstant(_)){const b=new ql;try{_=new Ri(_.type,_.evaluate(b))}catch(S){return this.error(S.message),null}}return _}return this.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(n===void 0?"'undefined' value invalid. Use null instead.":typeof n=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof n} instead.`)}concat(n,o,l){const p=typeof n=="number"?this.path.concat(n):this.path,y=l?this.scope.concat(l):this.scope;return new ya(this.registry,this._isConstant,p,o||null,y,this.errors)}error(n,...o){const l=`${this.key}${o.map(p=>`[${p}]`).join("")}`;this.errors.push(new Yr(l,n))}checkSubtype(n,o){const l=X(n,o);return l&&this.error(l),l}}class Wo{constructor(n,o){this.type=o.type,this.bindings=[].concat(n),this.result=o}evaluate(n){return this.result.evaluate(n)}eachChild(n){for(const o of this.bindings)n(o[1]);n(this.result)}static parse(n,o){if(n.length<4)return o.error(`Expected at least 3 arguments, but found ${n.length-1} instead.`);const l=[];for(let y=1;y<n.length-1;y+=2){const _=n[y];if(typeof _!="string")return o.error(`Expected string, but found ${typeof _} instead.`,y);if(/[^a-zA-Z0-9_]/.test(_))return o.error("Variable names must contain only alphanumeric characters or '_'.",y);const b=o.parse(n[y+1],y+1);if(!b)return null;l.push([_,b])}const p=o.parse(n[n.length-1],n.length-1,o.expectedType,l);return p?new Wo(l,p):null}outputDefined(){return this.result.outputDefined()}}class Ut{constructor(n,o){this.type=o.type,this.name=n,this.boundExpression=o}static parse(n,o){if(n.length!==2||typeof n[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const l=n[1];return o.scope.has(l)?new Ut(l,o.scope.get(l)):o.error(`Unknown variable "${l}". Make sure "${l}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(n){return this.boundExpression.evaluate(n)}eachChild(){}outputDefined(){return!1}}class zc{constructor(n,o,l){this.type=n,this.index=o,this.input=l}static parse(n,o){if(n.length!==3)return o.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const l=o.parse(n[1],1,Be),p=o.parse(n[2],2,D(o.expectedType||xt));return l&&p?new zc(p.type.itemType,l,p):null}evaluate(n){const o=this.index.evaluate(n),l=this.input.evaluate(n);if(o<0)throw new Mr(`Array index out of bounds: ${o} < 0.`);if(o>=l.length)throw new Mr(`Array index out of bounds: ${o} > ${l.length-1}.`);if(o!==Math.floor(o))throw new Mr(`Array index must be an integer, but found ${o} instead.`);return l[o]}eachChild(n){n(this.index),n(this.input)}outputDefined(){return!1}}class Lc{constructor(n,o){this.type=ht,this.needle=n,this.haystack=o}static parse(n,o){if(n.length!==3)return o.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const l=o.parse(n[1],1,xt),p=o.parse(n[2],2,xt);return l&&p?le(l.type,[ht,Tt,Be,zi,xt])?new Lc(l,p):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${R(l.type)} instead`):null}evaluate(n){const o=this.needle.evaluate(n),l=this.haystack.evaluate(n);if(!l)return!1;if(!ce(o,["boolean","string","number","null"]))throw new Mr(`Expected first argument to be of type boolean, string, number or null, but found ${R(Nr(o))} instead.`);if(!ce(l,["string","array"]))throw new Mr(`Expected second argument to be of type array or string, but found ${R(Nr(l))} instead.`);return l.indexOf(o)>=0}eachChild(n){n(this.needle),n(this.haystack)}outputDefined(){return!0}}class Wa{constructor(n,o,l){this.type=Be,this.needle=n,this.haystack=o,this.fromIndex=l}static parse(n,o){if(n.length<=2||n.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const l=o.parse(n[1],1,xt),p=o.parse(n[2],2,xt);if(!l||!p)return null;if(!le(l.type,[ht,Tt,Be,zi,xt]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${R(l.type)} instead`);if(n.length===4){const y=o.parse(n[3],3,Be);return y?new Wa(l,p,y):null}return new Wa(l,p)}evaluate(n){const o=this.needle.evaluate(n),l=this.haystack.evaluate(n);if(!ce(o,["boolean","string","number","null"]))throw new Mr(`Expected first argument to be of type boolean, string, number or null, but found ${R(Nr(o))} instead.`);let p;if(this.fromIndex&&(p=this.fromIndex.evaluate(n)),ce(l,["string"])){const y=l.indexOf(o,p);return y===-1?-1:[...l.slice(0,y)].length}if(ce(l,["array"]))return l.indexOf(o,p);throw new Mr(`Expected second argument to be of type array or string, but found ${R(Nr(l))} instead.`)}eachChild(n){n(this.needle),n(this.haystack),this.fromIndex&&n(this.fromIndex)}outputDefined(){return!1}}class Rc{constructor(n,o,l,p,y,_){this.inputType=n,this.type=o,this.input=l,this.cases=p,this.outputs=y,this.otherwise=_}static parse(n,o){if(n.length<5)return o.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if(n.length%2!=1)return o.error("Expected an even number of arguments.");let l,p;o.expectedType&&o.expectedType.kind!=="value"&&(p=o.expectedType);const y={},_=[];for(let k=2;k<n.length-1;k+=2){let I=n[k];const A=n[k+1];Array.isArray(I)||(I=[I]);const L=o.concat(k);if(I.length===0)return L.error("Expected at least one branch label.");for(const $ of I){if(typeof $!="number"&&typeof $!="string")return L.error("Branch labels must be numbers or strings.");if(typeof $=="number"&&Math.abs($)>Number.MAX_SAFE_INTEGER)return L.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof $=="number"&&Math.floor($)!==$)return L.error("Numeric branch labels must be integer values.");if(l){if(L.checkSubtype(l,Nr($)))return null}else l=Nr($);if(y[String($)]!==void 0)return L.error("Branch labels must be unique.");y[String($)]=_.length}const F=o.parse(A,k,p);if(!F)return null;p=p||F.type,_.push(F)}const b=o.parse(n[1],1,xt);if(!b)return null;const S=o.parse(n[n.length-1],n.length-1,p);return S?b.type.kind!=="value"&&o.concat(1).checkSubtype(l,b.type)?null:new Rc(l,p,b,y,_,S):null}evaluate(n){const o=this.input.evaluate(n);return(Nr(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(n)}eachChild(n){n(this.input),this.outputs.forEach(n),n(this.otherwise)}outputDefined(){return this.outputs.every(n=>n.outputDefined())&&this.otherwise.outputDefined()}}class Zl{constructor(n,o,l){this.type=n,this.branches=o,this.otherwise=l}static parse(n,o){if(n.length<4)return o.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length%2!=0)return o.error("Expected an odd number of arguments.");let l;o.expectedType&&o.expectedType.kind!=="value"&&(l=o.expectedType);const p=[];for(let _=1;_<n.length-1;_+=2){const b=o.parse(n[_],_,ht);if(!b)return null;const S=o.parse(n[_+1],_+1,l);if(!S)return null;p.push([b,S]),l=l||S.type}const y=o.parse(n[n.length-1],n.length-1,l);if(!y)return null;if(!l)throw new Error("Can't infer output type");return new Zl(l,p,y)}evaluate(n){for(const[o,l]of this.branches)if(o.evaluate(n))return l.evaluate(n);return this.otherwise.evaluate(n)}eachChild(n){for(const[o,l]of this.branches)n(o),n(l);n(this.otherwise)}outputDefined(){return this.branches.every(([n,o])=>o.outputDefined())&&this.otherwise.outputDefined()}}class Xs{constructor(n,o,l,p){this.type=n,this.input=o,this.beginIndex=l,this.endIndex=p}static parse(n,o){if(n.length<=2||n.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const l=o.parse(n[1],1,xt),p=o.parse(n[2],2,Be);if(!l||!p)return null;if(!le(l.type,[D(xt),Tt,xt]))return o.error(`Expected first argument to be of type array or string, but found ${R(l.type)} instead`);if(n.length===4){const y=o.parse(n[3],3,Be);return y?new Xs(l.type,l,p,y):null}return new Xs(l.type,l,p)}evaluate(n){const o=this.input.evaluate(n),l=this.beginIndex.evaluate(n);let p;if(this.endIndex&&(p=this.endIndex.evaluate(n)),ce(o,["string"]))return[...o].slice(l,p).join("");if(ce(o,["array"]))return o.slice(l,p);throw new Mr(`Expected first argument to be of type array or string, but found ${R(Nr(o))} instead.`)}eachChild(n){n(this.input),n(this.beginIndex),this.endIndex&&n(this.endIndex)}outputDefined(){return!1}}function Gl(i,n){const o=i.length-1;let l,p,y=0,_=o,b=0;for(;y<=_;)if(b=Math.floor((y+_)/2),l=i[b],p=i[b+1],l<=n){if(b===o||n<p)return b;y=b+1}else{if(!(l>n))throw new Mr("Input is not a number.");_=b-1}return 0}class Ka{constructor(n,o,l){this.type=n,this.input=o,this.labels=[],this.outputs=[];for(const[p,y]of l)this.labels.push(p),this.outputs.push(y)}static parse(n,o){if(n.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return o.error("Expected an even number of arguments.");const l=o.parse(n[1],1,Be);if(!l)return null;const p=[];let y=null;o.expectedType&&o.expectedType.kind!=="value"&&(y=o.expectedType);for(let _=1;_<n.length;_+=2){const b=_===1?-1/0:n[_],S=n[_+1],k=_,I=_+1;if(typeof b!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(p.length&&p[p.length-1][0]>=b)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',k);const A=o.parse(S,I,y);if(!A)return null;y=y||A.type,p.push([b,A])}return new Ka(y,l,p)}evaluate(n){const o=this.labels,l=this.outputs;if(o.length===1)return l[0].evaluate(n);const p=this.input.evaluate(n);if(p<=o[0])return l[0].evaluate(n);const y=o.length;return p>=o[y-1]?l[y-1].evaluate(n):l[Gl(o,p)].evaluate(n)}eachChild(n){n(this.input);for(const o of this.outputs)n(o)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}}function Vd(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var dg=qd;function qd(i,n,o,l){this.cx=3*i,this.bx=3*(o-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(l-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=n,this.p2x=o,this.p2y=l}qd.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,n){if(n===void 0&&(n=1e-6),i<0)return 0;if(i>1)return 1;for(var o=i,l=0;l<8;l++){var p=this.sampleCurveX(o)-i;if(Math.abs(p)<n)return o;var y=this.sampleCurveDerivativeX(o);if(Math.abs(y)<1e-6)break;o-=p/y}var _=0,b=1;for(o=i,l=0;l<20&&(p=this.sampleCurveX(o),!(Math.abs(p-i)<n));l++)i>p?_=o:b=o,o=.5*(b-_)+_;return o},solve:function(i,n){return this.sampleCurveY(this.solveCurveX(i,n))}};var pg=Vd(dg);function _a(i,n,o){return i+o*(n-i)}function Ys(i,n,o){return i.map((l,p)=>_a(l,n[p],o))}const Nn={number:_a,color:function(i,n,o,l="rgb"){switch(l){case"rgb":{const[p,y,_,b]=Ys(i.rgb,n.rgb,o);return new Wt(p,y,_,b,!1)}case"hcl":{const[p,y,_,b]=i.hcl,[S,k,I,A]=n.hcl;let L,F;if(isNaN(p)||isNaN(S))isNaN(p)?isNaN(S)?L=NaN:(L=S,_!==1&&_!==0||(F=k)):(L=p,I!==1&&I!==0||(F=y));else{let ge=S-p;S>p&&ge>180?ge-=360:S<p&&p-S>180&&(ge+=360),L=p+o*ge}const[$,j,K,Q]=function([ge,se,fe,be]){return ge=isNaN(ge)?0:ge*at,xr([fe,Math.cos(ge)*se,Math.sin(ge)*se,be])}([L,F??_a(y,k,o),_a(_,I,o),_a(b,A,o)]);return new Wt($,j,K,Q,!1)}case"lab":{const[p,y,_,b]=xr(Ys(i.lab,n.lab,o));return new Wt(p,y,_,b,!1)}}},array:Ys,padding:function(i,n,o){return new ti(Ys(i.values,n.values,o))},variableAnchorOffsetCollection:function(i,n,o){const l=i.values,p=n.values;if(l.length!==p.length)throw new Mr(`Cannot interpolate values of different length. from: ${i.toString()}, to: ${n.toString()}`);const y=[];for(let _=0;_<l.length;_+=2){if(l[_]!==p[_])throw new Mr(`Cannot interpolate values containing mismatched anchors. from[${_}]: ${l[_]}, to[${_}]: ${p[_]}`);y.push(l[_]);const[b,S]=l[_+1],[k,I]=p[_+1];y.push([_a(b,k,o),_a(S,I,o)])}return new fi(y)}};class $n{constructor(n,o,l,p,y){this.type=n,this.operator=o,this.interpolation=l,this.input=p,this.labels=[],this.outputs=[];for(const[_,b]of y)this.labels.push(_),this.outputs.push(b)}static interpolationFactor(n,o,l,p){let y=0;if(n.name==="exponential")y=Hl(o,n.base,l,p);else if(n.name==="linear")y=Hl(o,1,l,p);else if(n.name==="cubic-bezier"){const _=n.controlPoints;y=new pg(_[0],_[1],_[2],_[3]).solve(Hl(o,1,l,p))}return y}static parse(n,o){let[l,p,y,..._]=n;if(!Array.isArray(p)||p.length===0)return o.error("Expected an interpolation type expression.",1);if(p[0]==="linear")p={name:"linear"};else if(p[0]==="exponential"){const k=p[1];if(typeof k!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:k}}else{if(p[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(p[0])}`,1,0);{const k=p.slice(1);if(k.length!==4||k.some(I=>typeof I!="number"||I<0||I>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:k}}}if(n.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(y=o.parse(y,2,Be),!y)return null;const b=[];let S=null;l==="interpolate-hcl"||l==="interpolate-lab"?S=On:o.expectedType&&o.expectedType.kind!=="value"&&(S=o.expectedType);for(let k=0;k<_.length;k+=2){const I=_[k],A=_[k+1],L=k+3,F=k+4;if(typeof I!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',L);if(b.length&&b[b.length-1][0]>=I)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',L);const $=o.parse(A,F,S);if(!$)return null;S=S||$.type,b.push([I,$])}return me(S,Be)||me(S,On)||me(S,Ho)||me(S,J)||me(S,D(Be))?new $n(S,l,p,y,b):o.error(`Type ${R(S)} is not interpolatable.`)}evaluate(n){const o=this.labels,l=this.outputs;if(o.length===1)return l[0].evaluate(n);const p=this.input.evaluate(n);if(p<=o[0])return l[0].evaluate(n);const y=o.length;if(p>=o[y-1])return l[y-1].evaluate(n);const _=Gl(o,p),b=$n.interpolationFactor(this.interpolation,p,o[_],o[_+1]),S=l[_].evaluate(n),k=l[_+1].evaluate(n);switch(this.operator){case"interpolate":return Nn[this.type.kind](S,k,b);case"interpolate-hcl":return Nn.color(S,k,b,"hcl");case"interpolate-lab":return Nn.color(S,k,b,"lab")}}eachChild(n){n(this.input);for(const o of this.outputs)n(o)}outputDefined(){return this.outputs.every(n=>n.outputDefined())}}function Hl(i,n,o,l){const p=l-o,y=i-o;return p===0?0:n===1?y/p:(Math.pow(n,y)-1)/(Math.pow(n,p)-1)}class Wl{constructor(n,o){this.type=n,this.args=o}static parse(n,o){if(n.length<2)return o.error("Expectected at least one argument.");let l=null;const p=o.expectedType;p&&p.kind!=="value"&&(l=p);const y=[];for(const b of n.slice(1)){const S=o.parse(b,1+y.length,l,void 0,{typeAnnotation:"omit"});if(!S)return null;l=l||S.type,y.push(S)}if(!l)throw new Error("No output type");const _=p&&y.some(b=>X(p,b.type));return new Wl(_?xt:l,y)}evaluate(n){let o,l=null,p=0;for(const y of this.args)if(p++,l=y.evaluate(n),l&&l instanceof ri&&!l.available&&(o||(o=l.name),l=null,p===this.args.length&&(l=o)),l!==null)break;return l}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every(n=>n.outputDefined())}}function Kl(i,n){return i==="=="||i==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function Zd(i,n,o,l){return l.compare(n,o)===0}function Xa(i,n,o){const l=i!=="=="&&i!=="!=";return class eC{constructor(y,_,b){this.type=ht,this.lhs=y,this.rhs=_,this.collator=b,this.hasUntypedArgument=y.type.kind==="value"||_.type.kind==="value"}static parse(y,_){if(y.length!==3&&y.length!==4)return _.error("Expected two or three arguments.");const b=y[0];let S=_.parse(y[1],1,xt);if(!S)return null;if(!Kl(b,S.type))return _.concat(1).error(`"${b}" comparisons are not supported for type '${R(S.type)}'.`);let k=_.parse(y[2],2,xt);if(!k)return null;if(!Kl(b,k.type))return _.concat(2).error(`"${b}" comparisons are not supported for type '${R(k.type)}'.`);if(S.type.kind!==k.type.kind&&S.type.kind!=="value"&&k.type.kind!=="value")return _.error(`Cannot compare types '${R(S.type)}' and '${R(k.type)}'.`);l&&(S.type.kind==="value"&&k.type.kind!=="value"?S=new Di(k.type,[S]):S.type.kind!=="value"&&k.type.kind==="value"&&(k=new Di(S.type,[k])));let I=null;if(y.length===4){if(S.type.kind!=="string"&&k.type.kind!=="string"&&S.type.kind!=="value"&&k.type.kind!=="value")return _.error("Cannot use collator to compare non-string types.");if(I=_.parse(y[3],3,ao),!I)return null}return new eC(S,k,I)}evaluate(y){const _=this.lhs.evaluate(y),b=this.rhs.evaluate(y);if(l&&this.hasUntypedArgument){const S=Nr(_),k=Nr(b);if(S.kind!==k.kind||S.kind!=="string"&&S.kind!=="number")throw new Mr(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${S.kind}, ${k.kind}) instead.`)}if(this.collator&&!l&&this.hasUntypedArgument){const S=Nr(_),k=Nr(b);if(S.kind!=="string"||k.kind!=="string")return n(y,_,b)}return this.collator?o(y,_,b,this.collator.evaluate(y)):n(y,_,b)}eachChild(y){y(this.lhs),y(this.rhs),this.collator&&y(this.collator)}outputDefined(){return!0}}}const fg=Xa("==",function(i,n,o){return n===o},Zd),Gd=Xa("!=",function(i,n,o){return n!==o},function(i,n,o,l){return!Zd(0,n,o,l)}),Hd=Xa("<",function(i,n,o){return n<o},function(i,n,o,l){return l.compare(n,o)<0}),mg=Xa(">",function(i,n,o){return n>o},function(i,n,o,l){return l.compare(n,o)>0}),gg=Xa("<=",function(i,n,o){return n<=o},function(i,n,o,l){return l.compare(n,o)<=0}),Wd=Xa(">=",function(i,n,o){return n>=o},function(i,n,o,l){return l.compare(n,o)>=0});class Js{constructor(n,o,l){this.type=ao,this.locale=l,this.caseSensitive=n,this.diacriticSensitive=o}static parse(n,o){if(n.length!==2)return o.error("Expected one argument.");const l=n[1];if(typeof l!="object"||Array.isArray(l))return o.error("Collator options argument must be an object.");const p=o.parse(l["case-sensitive"]!==void 0&&l["case-sensitive"],1,ht);if(!p)return null;const y=o.parse(l["diacritic-sensitive"]!==void 0&&l["diacritic-sensitive"],1,ht);if(!y)return null;let _=null;return l.locale&&(_=o.parse(l.locale,1,Tt),!_)?null:new Js(p,y,_)}evaluate(n){return new Ac(this.caseSensitive.evaluate(n),this.diacriticSensitive.evaluate(n),this.locale?this.locale.evaluate(n):null)}eachChild(n){n(this.caseSensitive),n(this.diacriticSensitive),this.locale&&n(this.locale)}outputDefined(){return!1}}class Dc{constructor(n,o,l,p,y){this.type=Tt,this.number=n,this.locale=o,this.currency=l,this.minFractionDigits=p,this.maxFractionDigits=y}static parse(n,o){if(n.length!==3)return o.error("Expected two arguments.");const l=o.parse(n[1],1,Be);if(!l)return null;const p=n[2];if(typeof p!="object"||Array.isArray(p))return o.error("NumberFormat options argument must be an object.");let y=null;if(p.locale&&(y=o.parse(p.locale,1,Tt),!y))return null;let _=null;if(p.currency&&(_=o.parse(p.currency,1,Tt),!_))return null;let b=null;if(p["min-fraction-digits"]&&(b=o.parse(p["min-fraction-digits"],1,Be),!b))return null;let S=null;return p["max-fraction-digits"]&&(S=o.parse(p["max-fraction-digits"],1,Be),!S)?null:new Dc(l,y,_,b,S)}evaluate(n){return new Intl.NumberFormat(this.locale?this.locale.evaluate(n):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(n):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(n):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(n):void 0}).format(this.number.evaluate(n))}eachChild(n){n(this.number),this.locale&&n(this.locale),this.currency&&n(this.currency),this.minFractionDigits&&n(this.minFractionDigits),this.maxFractionDigits&&n(this.maxFractionDigits)}outputDefined(){return!1}}class Xl{constructor(n){this.type=zo,this.sections=n}static parse(n,o){if(n.length<2)return o.error("Expected at least one argument.");const l=n[1];if(!Array.isArray(l)&&typeof l=="object")return o.error("First argument must be an image or text section.");const p=[];let y=!1;for(let _=1;_<=n.length-1;++_){const b=n[_];if(y&&typeof b=="object"&&!Array.isArray(b)){y=!1;let S=null;if(b["font-scale"]&&(S=o.parse(b["font-scale"],1,Be),!S))return null;let k=null;if(b["text-font"]&&(k=o.parse(b["text-font"],1,D(Tt)),!k))return null;let I=null;if(b["text-color"]&&(I=o.parse(b["text-color"],1,On),!I))return null;const A=p[p.length-1];A.scale=S,A.font=k,A.textColor=I}else{const S=o.parse(n[_],1,xt);if(!S)return null;const k=S.type.kind;if(k!=="string"&&k!=="value"&&k!=="null"&&k!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");y=!0,p.push({content:S,scale:null,font:null,textColor:null})}}return new Xl(p)}evaluate(n){return new ei(this.sections.map(o=>{const l=o.content.evaluate(n);return Nr(l)===so?new Pc("",l,null,null,null):new Pc(Ks(l),null,o.scale?o.scale.evaluate(n):null,o.font?o.font.evaluate(n).join(","):null,o.textColor?o.textColor.evaluate(n):null)}))}eachChild(n){for(const o of this.sections)n(o.content),o.scale&&n(o.scale),o.font&&n(o.font),o.textColor&&n(o.textColor)}outputDefined(){return!1}}class Fc{constructor(n){this.type=so,this.input=n}static parse(n,o){if(n.length!==2)return o.error("Expected two arguments.");const l=o.parse(n[1],1,Tt);return l?new Fc(l):o.error("No image name provided.")}evaluate(n){const o=this.input.evaluate(n),l=ri.fromString(o);return l&&n.availableImages&&(l.available=n.availableImages.indexOf(o)>-1),l}eachChild(n){n(this.input)}outputDefined(){return!1}}class Bc{constructor(n){this.type=Be,this.input=n}static parse(n,o){if(n.length!==2)return o.error(`Expected 1 argument, but found ${n.length-1} instead.`);const l=o.parse(n[1],1);return l?l.type.kind!=="array"&&l.type.kind!=="string"&&l.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${R(l.type)} instead.`):new Bc(l):null}evaluate(n){const o=this.input.evaluate(n);if(typeof o=="string")return[...o].length;if(Array.isArray(o))return o.length;throw new Mr(`Expected value to be of type string or array, but found ${R(Nr(o))} instead.`)}eachChild(n){n(this.input)}outputDefined(){return!1}}const lo=8192;function yg(i,n){const o=(180+i[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,p=Math.pow(2,n.z);return[Math.round(o*p*lo),Math.round(l*p*lo)]}function Oc(i,n){const o=Math.pow(2,n.z);return[(p=(i[0]/lo+n.x)/o,360*p-180),(l=(i[1]/lo+n.y)/o,360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90)];var l,p}function va(i,n){i[0]=Math.min(i[0],n[0]),i[1]=Math.min(i[1],n[1]),i[2]=Math.max(i[2],n[0]),i[3]=Math.max(i[3],n[1])}function Ko(i,n){return!(i[0]<=n[0]||i[2]>=n[2]||i[1]<=n[1]||i[3]>=n[3])}function qt(i,n,o){const l=i[0]-n[0],p=i[1]-n[1],y=i[0]-o[0],_=i[1]-o[1];return l*_-y*p==0&&l*y<=0&&p*_<=0}function Yl(i,n,o,l){return(p=[l[0]-o[0],l[1]-o[1]])[0]*(y=[n[0]-i[0],n[1]-i[1]])[1]-p[1]*y[0]!=0&&!(!Xd(i,n,o,l)||!Xd(o,l,i,n));var p,y}function _g(i,n,o){for(const l of o)for(let p=0;p<l.length-1;++p)if(Yl(i,n,l[p],l[p+1]))return!0;return!1}function Ya(i,n,o=!1){let l=!1;for(const b of n)for(let S=0;S<b.length-1;S++){if(qt(i,b[S],b[S+1]))return o;(y=b[S])[1]>(p=i)[1]!=(_=b[S+1])[1]>p[1]&&p[0]<(_[0]-y[0])*(p[1]-y[1])/(_[1]-y[1])+y[0]&&(l=!l)}var p,y,_;return l}function vg(i,n){for(const o of n)if(Ya(i,o))return!0;return!1}function Kd(i,n){for(const o of i)if(!Ya(o,n))return!1;for(let o=0;o<i.length-1;++o)if(_g(i[o],i[o+1],n))return!1;return!0}function xg(i,n){for(const o of n)if(Kd(i,o))return!0;return!1}function Xd(i,n,o,l){const p=l[0]-o[0],y=l[1]-o[1],_=(i[0]-o[0])*y-p*(i[1]-o[1]),b=(n[0]-o[0])*y-p*(n[1]-o[1]);return _>0&&b<0||_<0&&b>0}function Nc(i,n,o){const l=[];for(let p=0;p<i.length;p++){const y=[];for(let _=0;_<i[p].length;_++){const b=yg(i[p][_],o);va(n,b),y.push(b)}l.push(y)}return l}function Yd(i,n,o){const l=[];for(let p=0;p<i.length;p++){const y=Nc(i[p],n,o);l.push(y)}return l}function Jd(i,n,o,l){if(i[0]<o[0]||i[0]>o[2]){const p=.5*l;let y=i[0]-o[0]>p?-l:o[0]-i[0]>p?l:0;y===0&&(y=i[0]-o[2]>p?-l:o[2]-i[0]>p?l:0),i[0]+=y}va(n,i)}function Qd(i,n,o,l){const p=Math.pow(2,l.z)*lo,y=[l.x*lo,l.y*lo],_=[];for(const b of i)for(const S of b){const k=[S.x+y[0],S.y+y[1]];Jd(k,n,o,p),_.push(k)}return _}function ep(i,n,o,l){const p=Math.pow(2,l.z)*lo,y=[l.x*lo,l.y*lo],_=[];for(const S of i){const k=[];for(const I of S){const A=[I.x+y[0],I.y+y[1]];va(n,A),k.push(A)}_.push(k)}if(n[2]-n[0]<=p/2){(b=n)[0]=b[1]=1/0,b[2]=b[3]=-1/0;for(const S of _)for(const k of S)Jd(k,n,o,p)}var b;return _}class xa{constructor(n,o){this.type=ht,this.geojson=n,this.geometries=o}static parse(n,o){if(n.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${n.length-1} instead.`);if(ga(n[1])){const l=n[1];if(l.type==="FeatureCollection"){const p=[];for(const y of l.features){const{type:_,coordinates:b}=y.geometry;_==="Polygon"&&p.push(b),_==="MultiPolygon"&&p.push(...b)}if(p.length)return new xa(l,{type:"MultiPolygon",coordinates:p})}else if(l.type==="Feature"){const p=l.geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new xa(l,l.geometry)}else if(l.type==="Polygon"||l.type==="MultiPolygon")return new xa(l,l)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(o,l){const p=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],_=o.canonicalID();if(l.type==="Polygon"){const b=Nc(l.coordinates,y,_),S=Qd(o.geometry(),p,y,_);if(!Ko(p,y))return!1;for(const k of S)if(!Ya(k,b))return!1}if(l.type==="MultiPolygon"){const b=Yd(l.coordinates,y,_),S=Qd(o.geometry(),p,y,_);if(!Ko(p,y))return!1;for(const k of S)if(!vg(k,b))return!1}return!0}(n,this.geometries);if(n.geometryType()==="LineString")return function(o,l){const p=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],_=o.canonicalID();if(l.type==="Polygon"){const b=Nc(l.coordinates,y,_),S=ep(o.geometry(),p,y,_);if(!Ko(p,y))return!1;for(const k of S)if(!Kd(k,b))return!1}if(l.type==="MultiPolygon"){const b=Yd(l.coordinates,y,_),S=ep(o.geometry(),p,y,_);if(!Ko(p,y))return!1;for(const k of S)if(!xg(k,b))return!1}return!0}(n,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let tp=class{constructor(i=[],n=(o,l)=>o<l?-1:o>l?1:0){if(this.data=i,this.length=this.data.length,this.compare=n,this.length>0)for(let o=(this.length>>1)-1;o>=0;o--)this._down(o)}push(i){this.data.push(i),this._up(this.length++)}pop(){if(this.length===0)return;const i=this.data[0],n=this.data.pop();return--this.length>0&&(this.data[0]=n,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:n,compare:o}=this,l=n[i];for(;i>0;){const p=i-1>>1,y=n[p];if(o(l,y)>=0)break;n[i]=y,i=p}n[i]=l}_down(i){const{data:n,compare:o}=this,l=this.length>>1,p=n[i];for(;i<l;){let y=1+(i<<1);const _=y+1;if(_<this.length&&o(n[_],n[y])<0&&(y=_),o(n[y],p)>=0)break;n[i]=n[y],i=y}n[i]=p}};function bg(i,n,o,l,p){rp(i,n,o,l||i.length-1,p||wg)}function rp(i,n,o,l,p){for(;l>o;){if(l-o>600){var y=l-o+1,_=n-o+1,b=Math.log(y),S=.5*Math.exp(2*b/3),k=.5*Math.sqrt(b*S*(y-S)/y)*(_-y/2<0?-1:1);rp(i,n,Math.max(o,Math.floor(n-_*S/y+k)),Math.min(l,Math.floor(n+(y-_)*S/y+k)),p)}var I=i[n],A=o,L=l;for(Qs(i,o,n),p(i[l],I)>0&&Qs(i,o,l);A<L;){for(Qs(i,A,L),A++,L--;p(i[A],I)<0;)A++;for(;p(i[L],I)>0;)L--}p(i[o],I)===0?Qs(i,o,L):Qs(i,++L,l),L<=n&&(o=L+1),n<=L&&(l=L-1)}}function Qs(i,n,o){var l=i[n];i[n]=i[o],i[o]=l}function wg(i,n){return i<n?-1:i>n?1:0}function Jl(i,n){if(i.length<=1)return[i];const o=[];let l,p;for(const y of i){const _=Tg(y);_!==0&&(y.area=Math.abs(_),p===void 0&&(p=_<0),p===_<0?(l&&o.push(l),l=[y]):l.push(y))}if(l&&o.push(l),n>1)for(let y=0;y<o.length;y++)o[y].length<=n||(bg(o[y],n,1,o[y].length-1,Sg),o[y]=o[y].slice(0,n));return o}function Sg(i,n){return n.area-i.area}function Tg(i){let n=0;for(let o,l,p=0,y=i.length,_=y-1;p<y;_=p++)o=i[p],l=i[_],n+=(l.x-o.x)*(o.y+l.y);return n}const np=1/298.257223563,ip=np*(2-np),op=Math.PI/180;class $c{constructor(n){const o=6378.137*op*1e3,l=Math.cos(n*op),p=1/(1-ip*(1-l*l)),y=Math.sqrt(p);this.kx=o*y*l,this.ky=o*y*p*(1-ip)}distance(n,o){const l=this.wrap(n[0]-o[0])*this.kx,p=(n[1]-o[1])*this.ky;return Math.sqrt(l*l+p*p)}pointOnLine(n,o){let l,p,y,_,b=1/0;for(let S=0;S<n.length-1;S++){let k=n[S][0],I=n[S][1],A=this.wrap(n[S+1][0]-k)*this.kx,L=(n[S+1][1]-I)*this.ky,F=0;A===0&&L===0||(F=(this.wrap(o[0]-k)*this.kx*A+(o[1]-I)*this.ky*L)/(A*A+L*L),F>1?(k=n[S+1][0],I=n[S+1][1]):F>0&&(k+=A/this.kx*F,I+=L/this.ky*F)),A=this.wrap(o[0]-k)*this.kx,L=(o[1]-I)*this.ky;const $=A*A+L*L;$<b&&(b=$,l=k,p=I,y=S,_=F)}return{point:[l,p],index:y,t:Math.max(0,Math.min(1,_))}}wrap(n){for(;n<-180;)n+=360;for(;n>180;)n-=360;return n}}function ap(i,n){return n[0]-i[0]}function Ql(i){return i[1]-i[0]+1}function Lo(i,n){return i[1]>=i[0]&&i[1]<n}function Uc(i,n){if(i[0]>i[1])return[null,null];const o=Ql(i);if(n){if(o===2)return[i,null];const p=Math.floor(o/2);return[[i[0],i[0]+p],[i[0]+p,i[1]]]}if(o===1)return[i,null];const l=Math.floor(o/2)-1;return[[i[0],i[0]+l],[i[0]+l+1,i[1]]]}function jc(i,n){if(!Lo(n,i.length))return[1/0,1/0,-1/0,-1/0];const o=[1/0,1/0,-1/0,-1/0];for(let l=n[0];l<=n[1];++l)va(o,i[l]);return o}function Vc(i){const n=[1/0,1/0,-1/0,-1/0];for(const o of i)for(const l of o)va(n,l);return n}function eu(i){return i[0]!==-1/0&&i[1]!==-1/0&&i[2]!==1/0&&i[3]!==1/0}function qc(i,n,o){if(!eu(i)||!eu(n))return NaN;let l=0,p=0;return i[2]<n[0]&&(l=n[0]-i[2]),i[0]>n[2]&&(l=i[0]-n[2]),i[1]>n[3]&&(p=i[1]-n[3]),i[3]<n[1]&&(p=n[1]-i[3]),o.distance([0,0],[l,p])}function ba(i,n,o){const l=o.pointOnLine(n,i);return o.distance(i,l.point)}function Zc(i,n,o,l,p){const y=Math.min(ba(i,[o,l],p),ba(n,[o,l],p)),_=Math.min(ba(o,[i,n],p),ba(l,[i,n],p));return Math.min(y,_)}function Cg(i,n,o,l,p){if(!Lo(n,i.length)||!Lo(l,o.length))return 1/0;let y=1/0;for(let _=n[0];_<n[1];++_){const b=i[_],S=i[_+1];for(let k=l[0];k<l[1];++k){const I=o[k],A=o[k+1];if(Yl(b,S,I,A))return 0;y=Math.min(y,Zc(b,S,I,A,p))}}return y}function Cr(i,n,o,l,p){if(!Lo(n,i.length)||!Lo(l,o.length))return NaN;let y=1/0;for(let _=n[0];_<=n[1];++_)for(let b=l[0];b<=l[1];++b)if(y=Math.min(y,p.distance(i[_],o[b])),y===0)return y;return y}function kg(i,n,o){if(Ya(i,n,!0))return 0;let l=1/0;for(const p of n){const y=p[0],_=p[p.length-1];if(y!==_&&(l=Math.min(l,ba(i,[_,y],o)),l===0))return l;const b=o.pointOnLine(p,i);if(l=Math.min(l,o.distance(i,b.point)),l===0)return l}return l}function kt(i,n,o,l){if(!Lo(n,i.length))return NaN;for(let y=n[0];y<=n[1];++y)if(Ya(i[y],o,!0))return 0;let p=1/0;for(let y=n[0];y<n[1];++y){const _=i[y],b=i[y+1];for(const S of o)for(let k=0,I=S.length,A=I-1;k<I;A=k++){const L=S[A],F=S[k];if(Yl(_,b,L,F))return 0;p=Math.min(p,Zc(_,b,L,F,l))}}return p}function tu(i,n){for(const o of i)for(const l of o)if(Ya(l,n,!0))return!0;return!1}function or(i,n,o,l=1/0){const p=Vc(i),y=Vc(n);if(l!==1/0&&qc(p,y,o)>=l)return l;if(Ko(p,y)){if(tu(i,n))return 0}else if(tu(n,i))return 0;let _=1/0;for(const b of i)for(let S=0,k=b.length,I=k-1;S<k;I=S++){const A=b[I],L=b[S];for(const F of n)for(let $=0,j=F.length,K=j-1;$<j;K=$++){const Q=F[K],ge=F[$];if(Yl(A,L,Q,ge))return 0;_=Math.min(_,Zc(A,L,Q,ge,o))}}return _}function Xt(i,n,o,l,p,y){if(!y)return;const _=qc(jc(l,y),p,o);_<n&&i.push([_,y,[0,0]])}function wa(i,n,o,l,p,y,_){if(!y||!_)return;const b=qc(jc(l,y),jc(p,_),o);b<n&&i.push([b,y,_])}function el(i,n,o,l,p=1/0){let y=Math.min(l.distance(i[0],o[0][0]),p);if(y===0)return y;const _=new tp([[0,[0,i.length-1],[0,0]]],ap),b=Vc(o);for(;_.length>0;){const S=_.pop();if(S[0]>=y)continue;const k=S[1],I=n?50:100;if(Ql(k)<=I){if(!Lo(k,i.length))return NaN;if(n){const A=kt(i,k,o,l);if(isNaN(A)||A===0)return A;y=Math.min(y,A)}else for(let A=k[0];A<=k[1];++A){const L=kg(i[A],o,l);if(y=Math.min(y,L),y===0)return 0}}else{const A=Uc(k,n);Xt(_,y,l,i,b,A[0]),Xt(_,y,l,i,b,A[1])}}return y}function tl(i,n,o,l,p,y=1/0){let _=Math.min(y,p.distance(i[0],o[0]));if(_===0)return _;const b=new tp([[0,[0,i.length-1],[0,o.length-1]]],ap);for(;b.length>0;){const S=b.pop();if(S[0]>=_)continue;const k=S[1],I=S[2],A=n?50:100,L=l?50:100;if(Ql(k)<=A&&Ql(I)<=L){if(!Lo(k,i.length)&&Lo(I,o.length))return NaN;let F;if(n&&l)F=Cg(i,k,o,I,p),_=Math.min(_,F);else if(n&&!l){const $=i.slice(k[0],k[1]+1);for(let j=I[0];j<=I[1];++j)if(F=ba(o[j],$,p),_=Math.min(_,F),_===0)return _}else if(!n&&l){const $=o.slice(I[0],I[1]+1);for(let j=k[0];j<=k[1];++j)if(F=ba(i[j],$,p),_=Math.min(_,F),_===0)return _}else F=Cr(i,k,o,I,p),_=Math.min(_,F)}else{const F=Uc(k,n),$=Uc(I,l);wa(b,_,p,i,o,F[0],$[0]),wa(b,_,p,i,o,F[0],$[1]),wa(b,_,p,i,o,F[1],$[0]),wa(b,_,p,i,o,F[1],$[1])}}return _}function Gc(i){return i.type==="MultiPolygon"?i.coordinates.map(n=>({type:"Polygon",coordinates:n})):i.type==="MultiLineString"?i.coordinates.map(n=>({type:"LineString",coordinates:n})):i.type==="MultiPoint"?i.coordinates.map(n=>({type:"Point",coordinates:n})):[i]}class Sa{constructor(n,o){this.type=Be,this.geojson=n,this.geometries=o}static parse(n,o){if(n.length!==2)return o.error(`'distance' expression requires exactly one argument, but found ${n.length-1} instead.`);if(ga(n[1])){const l=n[1];if(l.type==="FeatureCollection")return new Sa(l,l.features.map(p=>Gc(p.geometry)).flat());if(l.type==="Feature")return new Sa(l,Gc(l.geometry));if("type"in l&&"coordinates"in l)return new Sa(l,Gc(l))}return o.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return function(o,l){const p=o.geometry(),y=p.flat().map(S=>Oc([S.x,S.y],o.canonical));if(p.length===0)return NaN;const _=new $c(y[0][1]);let b=1/0;for(const S of l){switch(S.type){case"Point":b=Math.min(b,tl(y,!1,[S.coordinates],!1,_,b));break;case"LineString":b=Math.min(b,tl(y,!1,S.coordinates,!0,_,b));break;case"Polygon":b=Math.min(b,el(y,!1,S.coordinates,_,b))}if(b===0)return b}return b}(n,this.geometries);if(n.geometryType()==="LineString")return function(o,l){const p=o.geometry(),y=p.flat().map(S=>Oc([S.x,S.y],o.canonical));if(p.length===0)return NaN;const _=new $c(y[0][1]);let b=1/0;for(const S of l){switch(S.type){case"Point":b=Math.min(b,tl(y,!0,[S.coordinates],!1,_,b));break;case"LineString":b=Math.min(b,tl(y,!0,S.coordinates,!0,_,b));break;case"Polygon":b=Math.min(b,el(y,!0,S.coordinates,_,b))}if(b===0)return b}return b}(n,this.geometries);if(n.geometryType()==="Polygon")return function(o,l){const p=o.geometry();if(p.length===0||p[0].length===0)return NaN;const y=Jl(p,0).map(S=>S.map(k=>k.map(I=>Oc([I.x,I.y],o.canonical)))),_=new $c(y[0][0][0][1]);let b=1/0;for(const S of l)for(const k of y){switch(S.type){case"Point":b=Math.min(b,el([S.coordinates],!1,k,_,b));break;case"LineString":b=Math.min(b,el(S.coordinates,!0,k,_,b));break;case"Polygon":b=Math.min(b,or(k,S.coordinates,_,b))}if(b===0)return b}return b}(n,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const Ja={"==":fg,"!=":Gd,">":mg,"<":Hd,">=":Wd,"<=":gg,array:Di,at:zc,boolean:Di,case:Zl,coalesce:Wl,collator:Js,format:Xl,image:Fc,in:Lc,"index-of":Wa,interpolate:$n,"interpolate-hcl":$n,"interpolate-lab":$n,length:Bc,let:Wo,literal:Ri,match:Rc,number:Di,"number-format":Dc,object:Di,slice:Xs,step:Ka,string:Di,"to-boolean":Fi,"to-color":Fi,"to-number":Fi,"to-string":Fi,var:Ut,within:xa,distance:Sa};class mi{constructor(n,o,l,p){this.name=n,this.type=o,this._evaluate=l,this.args=p}evaluate(n){return this._evaluate(n,this.args)}eachChild(n){this.args.forEach(n)}outputDefined(){return!1}static parse(n,o){const l=n[0],p=mi.definitions[l];if(!p)return o.error(`Unknown expression "${l}". If you wanted a literal array, use ["literal", [...]].`,0);const y=Array.isArray(p)?p[0]:p.type,_=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,b=_.filter(([k])=>!Array.isArray(k)||k.length===n.length-1);let S=null;for(const[k,I]of b){S=new ya(o.registry,rl,o.path,null,o.scope);const A=[];let L=!1;for(let F=1;F<n.length;F++){const $=n[F],j=Array.isArray(k)?k[F-1]:k.type,K=S.parse($,1+A.length,j);if(!K){L=!0;break}A.push(K)}if(!L)if(Array.isArray(k)&&k.length!==A.length)S.error(`Expected ${k.length} arguments, but found ${A.length} instead.`);else{for(let F=0;F<A.length;F++){const $=Array.isArray(k)?k[F]:k.type,j=A[F];S.concat(F+1).checkSubtype($,j.type)}if(S.errors.length===0)return new mi(l,y,I,A)}}if(b.length===1)o.errors.push(...S.errors);else{const k=(b.length?b:_).map(([A])=>{return L=A,Array.isArray(L)?`(${L.map(R).join(", ")})`:`(${R(L.type)}...)`;var L}).join(" | "),I=[];for(let A=1;A<n.length;A++){const L=o.parse(n[A],1+I.length);if(!L)return null;I.push(R(L.type))}o.error(`Expected arguments of type ${k}, but found (${I.join(", ")}) instead.`)}return null}static register(n,o){mi.definitions=o;for(const l in o)n[l]=mi}}function Hc(i,[n,o,l,p]){n=n.evaluate(i),o=o.evaluate(i),l=l.evaluate(i);const y=p?p.evaluate(i):1,_=Ha(n,o,l,y);if(_)throw new Mr(_);return new Wt(n/255,o/255,l/255,y,!1)}function Wc(i,n){return i in n}function Kc(i,n){const o=n[i];return o===void 0?null:o}function Ta(i){return{type:i}}function rl(i){if(i instanceof Ut)return rl(i.boundExpression);if(i instanceof mi&&i.name==="error"||i instanceof Js||i instanceof xa||i instanceof Sa)return!1;const n=i instanceof Fi||i instanceof Di;let o=!0;return i.eachChild(l=>{o=n?o&&rl(l):o&&l instanceof Ri}),!!o&&nl(i)&&il(i,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function nl(i){if(i instanceof mi&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof xa||i instanceof Sa)return!1;let n=!0;return i.eachChild(o=>{n&&!nl(o)&&(n=!1)}),n}function Qa(i){if(i instanceof mi&&i.name==="feature-state")return!1;let n=!0;return i.eachChild(o=>{n&&!Qa(o)&&(n=!1)}),n}function il(i,n){if(i instanceof mi&&n.indexOf(i.name)>=0)return!1;let o=!0;return i.eachChild(l=>{o&&!il(l,n)&&(o=!1)}),o}function ru(i){return{result:"success",value:i}}function es(i){return{result:"error",value:i}}function ts(i){return i["property-type"]==="data-driven"||i["property-type"]==="cross-faded-data-driven"}function sp(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function Xc(i){return!!i.expression&&i.expression.interpolated}function Ot(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function nu(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function Ig(i){return i}function lp(i,n){const o=n.type==="color",l=i.stops&&typeof i.stops[0][0]=="object",p=l||!(l||i.property!==void 0),y=i.type||(Xc(n)?"exponential":"interval");if(o||n.type==="padding"){const I=o?Wt.parse:ti.parse;(i=_t({},i)).stops&&(i.stops=i.stops.map(A=>[A[0],I(A[1])])),i.default=I(i.default?i.default:n.default)}if(i.colorSpace&&(_=i.colorSpace)!=="rgb"&&_!=="hcl"&&_!=="lab")throw new Error(`Unknown color space: "${i.colorSpace}"`);var _;let b,S,k;if(y==="exponential")b=cp;else if(y==="interval")b=iu;else if(y==="categorical"){b=up,S=Object.create(null);for(const I of i.stops)S[I[0]]=I[1];k=typeof i.stops[0][0]}else{if(y!=="identity")throw new Error(`Unknown function type "${y}"`);b=hp}if(l){const I={},A=[];for(let $=0;$<i.stops.length;$++){const j=i.stops[$],K=j[0].zoom;I[K]===void 0&&(I[K]={zoom:K,type:i.type,property:i.property,default:i.default,stops:[]},A.push(K)),I[K].stops.push([j[0].value,j[1]])}const L=[];for(const $ of A)L.push([I[$].zoom,lp(I[$],n)]);const F={name:"linear"};return{kind:"composite",interpolationType:F,interpolationFactor:$n.interpolationFactor.bind(void 0,F),zoomStops:L.map($=>$[0]),evaluate:({zoom:$},j)=>cp({stops:L,base:i.base},n,$).evaluate($,j)}}if(p){const I=y==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:I,interpolationFactor:$n.interpolationFactor.bind(void 0,I),zoomStops:i.stops.map(A=>A[0]),evaluate:({zoom:A})=>b(i,n,A,S,k)}}return{kind:"source",evaluate(I,A){const L=A&&A.properties?A.properties[i.property]:void 0;return L===void 0?rs(i.default,n.default):b(i,n,L,S,k)}}}function rs(i,n,o){return i!==void 0?i:n!==void 0?n:o!==void 0?o:void 0}function up(i,n,o,l,p){return rs(typeof o===p?l[o]:void 0,i.default,n.default)}function iu(i,n,o){if(Ot(o)!=="number")return rs(i.default,n.default);const l=i.stops.length;if(l===1||o<=i.stops[0][0])return i.stops[0][1];if(o>=i.stops[l-1][0])return i.stops[l-1][1];const p=Gl(i.stops.map(y=>y[0]),o);return i.stops[p][1]}function cp(i,n,o){const l=i.base!==void 0?i.base:1;if(Ot(o)!=="number")return rs(i.default,n.default);const p=i.stops.length;if(p===1||o<=i.stops[0][0])return i.stops[0][1];if(o>=i.stops[p-1][0])return i.stops[p-1][1];const y=Gl(i.stops.map(I=>I[0]),o),_=function(I,A,L,F){const $=F-L,j=I-L;return $===0?0:A===1?j/$:(Math.pow(A,j)-1)/(Math.pow(A,$)-1)}(o,l,i.stops[y][0],i.stops[y+1][0]),b=i.stops[y][1],S=i.stops[y+1][1],k=Nn[n.type]||Ig;return typeof b.evaluate=="function"?{evaluate(...I){const A=b.evaluate.apply(void 0,I),L=S.evaluate.apply(void 0,I);if(A!==void 0&&L!==void 0)return k(A,L,_,i.colorSpace)}}:k(b,S,_,i.colorSpace)}function hp(i,n,o){switch(n.type){case"color":o=Wt.parse(o);break;case"formatted":o=ei.fromString(o.toString());break;case"resolvedImage":o=ri.fromString(o.toString());break;case"padding":o=ti.parse(o);break;default:Ot(o)===n.type||n.type==="enum"&&n.values[o]||(o=void 0)}return rs(o,i.default,n.default)}mi.register(Ja,{error:[{kind:"error"},[Tt],(i,[n])=>{throw new Mr(n.evaluate(i))}],typeof:[Tt,[xt],(i,[n])=>R(Nr(n.evaluate(i)))],"to-rgba":[D(Be,4),[On],(i,[n])=>{const[o,l,p,y]=n.evaluate(i).rgb;return[255*o,255*l,255*p,y]}],rgb:[On,[Be,Be,Be],Hc],rgba:[On,[Be,Be,Be,Be],Hc],has:{type:ht,overloads:[[[Tt],(i,[n])=>Wc(n.evaluate(i),i.properties())],[[Tt,Li],(i,[n,o])=>Wc(n.evaluate(i),o.evaluate(i))]]},get:{type:xt,overloads:[[[Tt],(i,[n])=>Kc(n.evaluate(i),i.properties())],[[Tt,Li],(i,[n,o])=>Kc(n.evaluate(i),o.evaluate(i))]]},"feature-state":[xt,[Tt],(i,[n])=>Kc(n.evaluate(i),i.featureState||{})],properties:[Li,[],i=>i.properties()],"geometry-type":[Tt,[],i=>i.geometryType()],id:[xt,[],i=>i.id()],zoom:[Be,[],i=>i.globals.zoom],"heatmap-density":[Be,[],i=>i.globals.heatmapDensity||0],"line-progress":[Be,[],i=>i.globals.lineProgress||0],accumulated:[xt,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[Be,Ta(Be),(i,n)=>{let o=0;for(const l of n)o+=l.evaluate(i);return o}],"*":[Be,Ta(Be),(i,n)=>{let o=1;for(const l of n)o*=l.evaluate(i);return o}],"-":{type:Be,overloads:[[[Be,Be],(i,[n,o])=>n.evaluate(i)-o.evaluate(i)],[[Be],(i,[n])=>-n.evaluate(i)]]},"/":[Be,[Be,Be],(i,[n,o])=>n.evaluate(i)/o.evaluate(i)],"%":[Be,[Be,Be],(i,[n,o])=>n.evaluate(i)%o.evaluate(i)],ln2:[Be,[],()=>Math.LN2],pi:[Be,[],()=>Math.PI],e:[Be,[],()=>Math.E],"^":[Be,[Be,Be],(i,[n,o])=>Math.pow(n.evaluate(i),o.evaluate(i))],sqrt:[Be,[Be],(i,[n])=>Math.sqrt(n.evaluate(i))],log10:[Be,[Be],(i,[n])=>Math.log(n.evaluate(i))/Math.LN10],ln:[Be,[Be],(i,[n])=>Math.log(n.evaluate(i))],log2:[Be,[Be],(i,[n])=>Math.log(n.evaluate(i))/Math.LN2],sin:[Be,[Be],(i,[n])=>Math.sin(n.evaluate(i))],cos:[Be,[Be],(i,[n])=>Math.cos(n.evaluate(i))],tan:[Be,[Be],(i,[n])=>Math.tan(n.evaluate(i))],asin:[Be,[Be],(i,[n])=>Math.asin(n.evaluate(i))],acos:[Be,[Be],(i,[n])=>Math.acos(n.evaluate(i))],atan:[Be,[Be],(i,[n])=>Math.atan(n.evaluate(i))],min:[Be,Ta(Be),(i,n)=>Math.min(...n.map(o=>o.evaluate(i)))],max:[Be,Ta(Be),(i,n)=>Math.max(...n.map(o=>o.evaluate(i)))],abs:[Be,[Be],(i,[n])=>Math.abs(n.evaluate(i))],round:[Be,[Be],(i,[n])=>{const o=n.evaluate(i);return o<0?-Math.round(-o):Math.round(o)}],floor:[Be,[Be],(i,[n])=>Math.floor(n.evaluate(i))],ceil:[Be,[Be],(i,[n])=>Math.ceil(n.evaluate(i))],"filter-==":[ht,[Tt,xt],(i,[n,o])=>i.properties()[n.value]===o.value],"filter-id-==":[ht,[xt],(i,[n])=>i.id()===n.value],"filter-type-==":[ht,[Tt],(i,[n])=>i.geometryType()===n.value],"filter-<":[ht,[Tt,xt],(i,[n,o])=>{const l=i.properties()[n.value],p=o.value;return typeof l==typeof p&&l<p}],"filter-id-<":[ht,[xt],(i,[n])=>{const o=i.id(),l=n.value;return typeof o==typeof l&&o<l}],"filter->":[ht,[Tt,xt],(i,[n,o])=>{const l=i.properties()[n.value],p=o.value;return typeof l==typeof p&&l>p}],"filter-id->":[ht,[xt],(i,[n])=>{const o=i.id(),l=n.value;return typeof o==typeof l&&o>l}],"filter-<=":[ht,[Tt,xt],(i,[n,o])=>{const l=i.properties()[n.value],p=o.value;return typeof l==typeof p&&l<=p}],"filter-id-<=":[ht,[xt],(i,[n])=>{const o=i.id(),l=n.value;return typeof o==typeof l&&o<=l}],"filter->=":[ht,[Tt,xt],(i,[n,o])=>{const l=i.properties()[n.value],p=o.value;return typeof l==typeof p&&l>=p}],"filter-id->=":[ht,[xt],(i,[n])=>{const o=i.id(),l=n.value;return typeof o==typeof l&&o>=l}],"filter-has":[ht,[xt],(i,[n])=>n.value in i.properties()],"filter-has-id":[ht,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[ht,[D(Tt)],(i,[n])=>n.value.indexOf(i.geometryType())>=0],"filter-id-in":[ht,[D(xt)],(i,[n])=>n.value.indexOf(i.id())>=0],"filter-in-small":[ht,[Tt,D(xt)],(i,[n,o])=>o.value.indexOf(i.properties()[n.value])>=0],"filter-in-large":[ht,[Tt,D(xt)],(i,[n,o])=>function(l,p,y,_){for(;y<=_;){const b=y+_>>1;if(p[b]===l)return!0;p[b]>l?_=b-1:y=b+1}return!1}(i.properties()[n.value],o.value,0,o.value.length-1)],all:{type:ht,overloads:[[[ht,ht],(i,[n,o])=>n.evaluate(i)&&o.evaluate(i)],[Ta(ht),(i,n)=>{for(const o of n)if(!o.evaluate(i))return!1;return!0}]]},any:{type:ht,overloads:[[[ht,ht],(i,[n,o])=>n.evaluate(i)||o.evaluate(i)],[Ta(ht),(i,n)=>{for(const o of n)if(o.evaluate(i))return!0;return!1}]]},"!":[ht,[ht],(i,[n])=>!n.evaluate(i)],"is-supported-script":[ht,[Tt],(i,[n])=>{const o=i.globals&&i.globals.isSupportedScript;return!o||o(n.evaluate(i))}],upcase:[Tt,[Tt],(i,[n])=>n.evaluate(i).toUpperCase()],downcase:[Tt,[Tt],(i,[n])=>n.evaluate(i).toLowerCase()],concat:[Tt,Ta(xt),(i,n)=>n.map(o=>Ks(o.evaluate(i))).join("")],"resolved-locale":[Tt,[ao],(i,[n])=>n.evaluate(i).resolvedLocale()]});class ou{constructor(n,o){var l;this.expression=n,this._warningHistory={},this._evaluator=new ql,this._defaultValue=o?(l=o).type==="color"&&nu(l.default)?new Wt(0,0,0,0):l.type==="color"?Wt.parse(l.default)||null:l.type==="padding"?ti.parse(l.default)||null:l.type==="variableAnchorOffsetCollection"?fi.parse(l.default)||null:l.default===void 0?null:l.default:null,this._enumValues=o&&o.type==="enum"?o.values:null}evaluateWithoutErrorHandling(n,o,l,p,y,_){return this._evaluator.globals=n,this._evaluator.feature=o,this._evaluator.featureState=l,this._evaluator.canonical=p,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=_,this.expression.evaluate(this._evaluator)}evaluate(n,o,l,p,y,_){this._evaluator.globals=n,this._evaluator.feature=o||null,this._evaluator.featureState=l||null,this._evaluator.canonical=p,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=_||null;try{const b=this.expression.evaluate(this._evaluator);if(b==null||typeof b=="number"&&b!=b)return this._defaultValue;if(this._enumValues&&!(b in this._enumValues))throw new Mr(`Expected value to be one of ${Object.keys(this._enumValues).map(S=>JSON.stringify(S)).join(", ")}, but found ${JSON.stringify(b)} instead.`);return b}catch(b){return this._warningHistory[b.message]||(this._warningHistory[b.message]=!0,typeof console<"u"&&console.warn(b.message)),this._defaultValue}}}function au(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in Ja}function ns(i,n){const o=new ya(Ja,rl,[],n?function(p){const y={color:On,string:Tt,number:Be,enum:Tt,boolean:ht,formatted:zo,padding:Ho,resolvedImage:so,variableAnchorOffsetCollection:J};return p.type==="array"?D(y[p.value]||xt,p.length):y[p.type]}(n):void 0),l=o.parse(i,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?ru(new ou(l,n)):es(o.errors)}class is{constructor(n,o){this.kind=n,this._styleExpression=o,this.isStateDependent=n!=="constant"&&!Qa(o.expression)}evaluateWithoutErrorHandling(n,o,l,p,y,_){return this._styleExpression.evaluateWithoutErrorHandling(n,o,l,p,y,_)}evaluate(n,o,l,p,y,_){return this._styleExpression.evaluate(n,o,l,p,y,_)}}class os{constructor(n,o,l,p){this.kind=n,this.zoomStops=l,this._styleExpression=o,this.isStateDependent=n!=="camera"&&!Qa(o.expression),this.interpolationType=p}evaluateWithoutErrorHandling(n,o,l,p,y,_){return this._styleExpression.evaluateWithoutErrorHandling(n,o,l,p,y,_)}evaluate(n,o,l,p,y,_){return this._styleExpression.evaluate(n,o,l,p,y,_)}interpolationFactor(n,o,l){return this.interpolationType?$n.interpolationFactor(this.interpolationType,n,o,l):0}}function Yc(i,n){const o=ns(i,n);if(o.result==="error")return o;const l=o.value.expression,p=nl(l);if(!p&&!ts(n))return es([new Yr("","data expressions not supported")]);const y=il(l,["zoom"]);if(!y&&!sp(n))return es([new Yr("","zoom expressions not supported")]);const _=ol(l);return _||y?_ instanceof Yr?es([_]):_ instanceof $n&&!Xc(n)?es([new Yr("",'"interpolate" expressions cannot be used with this property')]):ru(_?new os(p?"camera":"composite",o.value,_.labels,_ instanceof $n?_.interpolation:void 0):new is(p?"constant":"source",o.value)):es([new Yr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class as{constructor(n,o){this._parameters=n,this._specification=o,_t(this,lp(this._parameters,this._specification))}static deserialize(n){return new as(n._parameters,n._specification)}static serialize(n){return{_parameters:n._parameters,_specification:n._specification}}}function ol(i){let n=null;if(i instanceof Wo)n=ol(i.result);else if(i instanceof Wl){for(const o of i.args)if(n=ol(o),n)break}else(i instanceof Ka||i instanceof $n)&&i.input instanceof mi&&i.input.name==="zoom"&&(n=i);return n instanceof Yr||i.eachChild(o=>{const l=ol(o);l instanceof Yr?n=l:!n&&l?n=new Yr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):n&&l&&n!==l&&(n=new Yr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),n}function su(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const n of i.slice(1))if(!su(n)&&typeof n!="boolean")return!1;return!0;default:return!0}}const lu={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Jc(i){if(i==null)return{filter:()=>!0,needGeometry:!1};su(i)||(i=uu(i));const n=ns(i,lu);if(n.result==="error")throw new Error(n.value.map(o=>`${o.key}: ${o.message}`).join(", "));return{filter:(o,l,p)=>n.value.evaluate(o,l,{},p),needGeometry:dp(i)}}function Eg(i,n){return i<n?-1:i>n?1:0}function dp(i){if(!Array.isArray(i))return!1;if(i[0]==="within"||i[0]==="distance")return!0;for(let n=1;n<i.length;n++)if(dp(i[n]))return!0;return!1}function uu(i){if(!i)return!0;const n=i[0];return i.length<=1?n!=="any":n==="=="?Qc(i[1],i[2],"=="):n==="!="?dn(Qc(i[1],i[2],"==")):n==="<"||n===">"||n==="<="||n===">="?Qc(i[1],i[2],n):n==="any"?(o=i.slice(1),["any"].concat(o.map(uu))):n==="all"?["all"].concat(i.slice(1).map(uu)):n==="none"?["all"].concat(i.slice(1).map(uu).map(dn)):n==="in"?al(i[1],i.slice(2)):n==="!in"?dn(al(i[1],i.slice(2))):n==="has"?sl(i[1]):n!=="!has"||dn(sl(i[1]));var o}function Qc(i,n,o){switch(i){case"$type":return[`filter-type-${o}`,n];case"$id":return[`filter-id-${o}`,n];default:return[`filter-${o}`,i,n]}}function al(i,n){if(n.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some(o=>typeof o!=typeof n[0])?["filter-in-large",i,["literal",n.sort(Eg)]]:["filter-in-small",i,["literal",n]]}}function sl(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function dn(i){return["!",i]}function Ca(i){const n=typeof i;if(n==="number"||n==="boolean"||n==="string"||i==null)return JSON.stringify(i);if(Array.isArray(i)){let p="[";for(const y of i)p+=`${Ca(y)},`;return`${p}]`}const o=Object.keys(i).sort();let l="{";for(let p=0;p<o.length;p++)l+=`${JSON.stringify(o[p])}:${Ca(i[o[p]])},`;return`${l}}`}function pp(i){let n="";for(const o of Po)n+=`/${Ca(i[o])}`;return n}function fp(i){const n=i.value;return n?[new ze(i.key,n,"constants have been deprecated as of v8")]:[]}function kr(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function Bi(i){if(Array.isArray(i))return i.map(Bi);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const n={};for(const o in i)n[o]=Bi(i[o]);return n}return kr(i)}function ni(i){const n=i.key,o=i.value,l=i.valueSpec||{},p=i.objectElementValidators||{},y=i.style,_=i.styleSpec,b=i.validateSpec;let S=[];const k=Ot(o);if(k!=="object")return[new ze(n,o,`object expected, ${k} found`)];for(const I in o){const A=I.split(".")[0],L=l[A]||l["*"];let F;if(p[A])F=p[A];else if(l[A])F=b;else if(p["*"])F=p["*"];else{if(!l["*"]){S.push(new ze(n,o[I],`unknown property "${I}"`));continue}F=b}S=S.concat(F({key:(n&&`${n}.`)+I,value:o[I],valueSpec:L,style:y,styleSpec:_,object:o,objectKey:I,validateSpec:b},o))}for(const I in l)p[I]||l[I].required&&l[I].default===void 0&&o[I]===void 0&&S.push(new ze(n,o,`missing required property "${I}"`));return S}function ll(i){const n=i.value,o=i.valueSpec,l=i.style,p=i.styleSpec,y=i.key,_=i.arrayElementValidator||i.validateSpec;if(Ot(n)!=="array")return[new ze(y,n,`array expected, ${Ot(n)} found`)];if(o.length&&n.length!==o.length)return[new ze(y,n,`array length ${o.length} expected, length ${n.length} found`)];if(o["min-length"]&&n.length<o["min-length"])return[new ze(y,n,`array length at least ${o["min-length"]} expected, length ${n.length} found`)];let b={type:o.value,values:o.values};p.$version<7&&(b.function=o.function),Ot(o.value)==="object"&&(b=o.value);let S=[];for(let k=0;k<n.length;k++)S=S.concat(_({array:n,arrayIndex:k,value:n[k],valueSpec:b,validateSpec:i.validateSpec,style:l,styleSpec:p,key:`${y}[${k}]`}));return S}function eh(i){const n=i.key,o=i.value,l=i.valueSpec;let p=Ot(o);return p==="number"&&o!=o&&(p="NaN"),p!=="number"?[new ze(n,o,`number expected, ${p} found`)]:"minimum"in l&&o<l.minimum?[new ze(n,o,`${o} is less than the minimum value ${l.minimum}`)]:"maximum"in l&&o>l.maximum?[new ze(n,o,`${o} is greater than the maximum value ${l.maximum}`)]:[]}function cu(i){const n=i.valueSpec,o=kr(i.value.type);let l,p,y,_={};const b=o!=="categorical"&&i.value.property===void 0,S=!b,k=Ot(i.value.stops)==="array"&&Ot(i.value.stops[0])==="array"&&Ot(i.value.stops[0][0])==="object",I=ni({key:i.key,value:i.value,valueSpec:i.styleSpec.function,validateSpec:i.validateSpec,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(F){if(o==="identity")return[new ze(F.key,F.value,'identity function may not have a "stops" property')];let $=[];const j=F.value;return $=$.concat(ll({key:F.key,value:j,valueSpec:F.valueSpec,validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec,arrayElementValidator:A})),Ot(j)==="array"&&j.length===0&&$.push(new ze(F.key,j,"array must have at least one stop")),$},default:function(F){return F.validateSpec({key:F.key,value:F.value,valueSpec:n,validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec})}}});return o==="identity"&&b&&I.push(new ze(i.key,i.value,'missing required property "property"')),o==="identity"||i.value.stops||I.push(new ze(i.key,i.value,'missing required property "stops"')),o==="exponential"&&i.valueSpec.expression&&!Xc(i.valueSpec)&&I.push(new ze(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(S&&!ts(i.valueSpec)?I.push(new ze(i.key,i.value,"property functions not supported")):b&&!sp(i.valueSpec)&&I.push(new ze(i.key,i.value,"zoom functions not supported"))),o!=="categorical"&&!k||i.value.property!==void 0||I.push(new ze(i.key,i.value,'"property" property is required')),I;function A(F){let $=[];const j=F.value,K=F.key;if(Ot(j)!=="array")return[new ze(K,j,`array expected, ${Ot(j)} found`)];if(j.length!==2)return[new ze(K,j,`array length 2 expected, length ${j.length} found`)];if(k){if(Ot(j[0])!=="object")return[new ze(K,j,`object expected, ${Ot(j[0])} found`)];if(j[0].zoom===void 0)return[new ze(K,j,"object stop key must have zoom")];if(j[0].value===void 0)return[new ze(K,j,"object stop key must have value")];if(y&&y>kr(j[0].zoom))return[new ze(K,j[0].zoom,"stop zoom values must appear in ascending order")];kr(j[0].zoom)!==y&&(y=kr(j[0].zoom),p=void 0,_={}),$=$.concat(ni({key:`${K}[0]`,value:j[0],valueSpec:{zoom:{}},validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec,objectElementValidators:{zoom:eh,value:L}}))}else $=$.concat(L({key:`${K}[0]`,value:j[0],valueSpec:{},validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec},j));return au(Bi(j[1]))?$.concat([new ze(`${K}[1]`,j[1],"expressions are not allowed in function stops.")]):$.concat(F.validateSpec({key:`${K}[1]`,value:j[1],valueSpec:n,validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec}))}function L(F,$){const j=Ot(F.value),K=kr(F.value),Q=F.value!==null?F.value:$;if(l){if(j!==l)return[new ze(F.key,Q,`${j} stop domain type must match previous stop domain type ${l}`)]}else l=j;if(j!=="number"&&j!=="string"&&j!=="boolean")return[new ze(F.key,Q,"stop domain value must be a number, string, or boolean")];if(j!=="number"&&o!=="categorical"){let ge=`number expected, ${j} found`;return ts(n)&&o===void 0&&(ge+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ze(F.key,Q,ge)]}return o!=="categorical"||j!=="number"||isFinite(K)&&Math.floor(K)===K?o!=="categorical"&&j==="number"&&p!==void 0&&K<p?[new ze(F.key,Q,"stop domain values must appear in ascending order")]:(p=K,o==="categorical"&&K in _?[new ze(F.key,Q,"stop domain values must be unique")]:(_[K]=!0,[])):[new ze(F.key,Q,`integer expected, found ${K}`)]}}function ss(i){const n=(i.expressionContext==="property"?Yc:ns)(Bi(i.value),i.valueSpec);if(n.result==="error")return n.value.map(l=>new ze(`${i.key}${l.key}`,i.value,l.message));const o=n.value.expression||n.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!o.outputDefined())return[new ze(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!Qa(o))return[new ze(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter"&&!Qa(o))return[new ze(i.key,i.value,'"feature-state" data expressions are not supported with filters.')];if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!il(o,["zoom","feature-state"]))return[new ze(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!nl(o))return[new ze(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ro(i){const n=i.key,o=i.value,l=i.valueSpec,p=[];return Array.isArray(l.values)?l.values.indexOf(kr(o))===-1&&p.push(new ze(n,o,`expected one of [${l.values.join(", ")}], ${JSON.stringify(o)} found`)):Object.keys(l.values).indexOf(kr(o))===-1&&p.push(new ze(n,o,`expected one of [${Object.keys(l.values).join(", ")}], ${JSON.stringify(o)} found`)),p}function th(i){return su(Bi(i.value))?ss(_t({},i,{expressionContext:"filter",valueSpec:{value:"boolean"}})):hu(i)}function hu(i){const n=i.value,o=i.key;if(Ot(n)!=="array")return[new ze(o,n,`array expected, ${Ot(n)} found`)];const l=i.styleSpec;let p,y=[];if(n.length<1)return[new ze(o,n,"filter array must have at least 1 element")];switch(y=y.concat(Ro({key:`${o}[0]`,value:n[0],valueSpec:l.filter_operator,style:i.style,styleSpec:i.styleSpec})),kr(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&kr(n[1])==="$type"&&y.push(new ze(o,n,`"$type" cannot be use with operator "${n[0]}"`));case"==":case"!=":n.length!==3&&y.push(new ze(o,n,`filter array for operator "${n[0]}" must have 3 elements`));case"in":case"!in":n.length>=2&&(p=Ot(n[1]),p!=="string"&&y.push(new ze(`${o}[1]`,n[1],`string expected, ${p} found`)));for(let _=2;_<n.length;_++)p=Ot(n[_]),kr(n[1])==="$type"?y=y.concat(Ro({key:`${o}[${_}]`,value:n[_],valueSpec:l.geometry_type,style:i.style,styleSpec:i.styleSpec})):p!=="string"&&p!=="number"&&p!=="boolean"&&y.push(new ze(`${o}[${_}]`,n[_],`string, number, or boolean expected, ${p} found`));break;case"any":case"all":case"none":for(let _=1;_<n.length;_++)y=y.concat(hu({key:`${o}[${_}]`,value:n[_],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":p=Ot(n[1]),n.length!==2?y.push(new ze(o,n,`filter array for "${n[0]}" operator must have 2 elements`)):p!=="string"&&y.push(new ze(`${o}[1]`,n[1],`string expected, ${p} found`))}return y}function rh(i,n){const o=i.key,l=i.validateSpec,p=i.style,y=i.styleSpec,_=i.value,b=i.objectKey,S=y[`${n}_${i.layerType}`];if(!S)return[];const k=b.match(/^(.*)-transition$/);if(n==="paint"&&k&&S[k[1]]&&S[k[1]].transition)return l({key:o,value:_,valueSpec:y.transition,style:p,styleSpec:y});const I=i.valueSpec||S[b];if(!I)return[new ze(o,_,`unknown property "${b}"`)];let A;if(Ot(_)==="string"&&ts(I)&&!I.tokens&&(A=/^{([^}]+)}$/.exec(_)))return[new ze(o,_,`"${b}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(A[1])} }\`.`)];const L=[];return i.layerType==="symbol"&&(b==="text-field"&&p&&!p.glyphs&&L.push(new ze(o,_,'use of "text-field" requires a style "glyphs" property')),b==="text-font"&&nu(Bi(_))&&kr(_.type)==="identity"&&L.push(new ze(o,_,'"text-font" does not support identity functions'))),L.concat(l({key:i.key,value:_,valueSpec:I,style:p,styleSpec:y,expressionContext:"property",propertyType:n,propertyKey:b}))}function du(i){return rh(i,"paint")}function nh(i){return rh(i,"layout")}function ih(i){let n=[];const o=i.value,l=i.key,p=i.style,y=i.styleSpec;o.type||o.ref||n.push(new ze(l,o,'either "type" or "ref" is required'));let _=kr(o.type);const b=kr(o.ref);if(o.id){const S=kr(o.id);for(let k=0;k<i.arrayIndex;k++){const I=p.layers[k];kr(I.id)===S&&n.push(new ze(l,o.id,`duplicate layer id "${o.id}", previously used at line ${I.id.__line__}`))}}if("ref"in o){let S;["type","source","source-layer","filter","layout"].forEach(k=>{k in o&&n.push(new ze(l,o[k],`"${k}" is prohibited for ref layers`))}),p.layers.forEach(k=>{kr(k.id)===b&&(S=k)}),S?S.ref?n.push(new ze(l,o.ref,"ref cannot reference another ref layer")):_=kr(S.type):n.push(new ze(l,o.ref,`ref layer "${b}" not found`))}else if(_!=="background")if(o.source){const S=p.sources&&p.sources[o.source],k=S&&kr(S.type);S?k==="vector"&&_==="raster"?n.push(new ze(l,o.source,`layer "${o.id}" requires a raster source`)):k!=="raster-dem"&&_==="hillshade"?n.push(new ze(l,o.source,`layer "${o.id}" requires a raster-dem source`)):k==="raster"&&_!=="raster"?n.push(new ze(l,o.source,`layer "${o.id}" requires a vector source`)):k!=="vector"||o["source-layer"]?k==="raster-dem"&&_!=="hillshade"?n.push(new ze(l,o.source,"raster-dem source can only be used with layer type 'hillshade'.")):_!=="line"||!o.paint||!o.paint["line-gradient"]||k==="geojson"&&S.lineMetrics||n.push(new ze(l,o,`layer "${o.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):n.push(new ze(l,o,`layer "${o.id}" must specify a "source-layer"`)):n.push(new ze(l,o.source,`source "${o.source}" not found`))}else n.push(new ze(l,o,'missing required property "source"'));return n=n.concat(ni({key:l,value:o,valueSpec:y.layer,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,objectElementValidators:{"*":()=>[],type:()=>i.validateSpec({key:`${l}.type`,value:o.type,valueSpec:y.layer.type,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,object:o,objectKey:"type"}),filter:th,layout:S=>ni({layer:o,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":k=>nh(_t({layerType:_},k))}}),paint:S=>ni({layer:o,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":k=>du(_t({layerType:_},k))}})}})),n}function ka(i){const n=i.value,o=i.key,l=Ot(n);return l!=="string"?[new ze(o,n,`string expected, ${l} found`)]:[]}const pu={promoteId:function({key:i,value:n}){if(Ot(n)==="string")return ka({key:i,value:n});{const o=[];for(const l in n)o.push(...ka({key:`${i}.${l}`,value:n[l]}));return o}}};function ul(i){const n=i.value,o=i.key,l=i.styleSpec,p=i.style,y=i.validateSpec;if(!n.type)return[new ze(o,n,'"type" is required')];const _=kr(n.type);let b;switch(_){case"vector":case"raster":return b=ni({key:o,value:n,valueSpec:l[`source_${_.replace("-","_")}`],style:i.style,styleSpec:l,objectElementValidators:pu,validateSpec:y}),b;case"raster-dem":return b=function(S){var k;const I=(k=S.sourceName)!==null&&k!==void 0?k:"",A=S.value,L=S.styleSpec,F=L.source_raster_dem,$=S.style;let j=[];const K=Ot(A);if(A===void 0)return j;if(K!=="object")return j.push(new ze("source_raster_dem",A,`object expected, ${K} found`)),j;const Q=kr(A.encoding)==="custom",ge=["redFactor","greenFactor","blueFactor","baseShift"],se=S.value.encoding?`"${S.value.encoding}"`:"Default";for(const fe in A)!Q&&ge.includes(fe)?j.push(new ze(fe,A[fe],`In "${I}": "${fe}" is only valid when "encoding" is set to "custom". ${se} encoding found`)):F[fe]?j=j.concat(S.validateSpec({key:fe,value:A[fe],valueSpec:F[fe],validateSpec:S.validateSpec,style:$,styleSpec:L})):j.push(new ze(fe,A[fe],`unknown property "${fe}"`));return j}({sourceName:o,value:n,style:i.style,styleSpec:l,validateSpec:y}),b;case"geojson":if(b=ni({key:o,value:n,valueSpec:l.source_geojson,style:p,styleSpec:l,validateSpec:y,objectElementValidators:pu}),n.cluster)for(const S in n.clusterProperties){const[k,I]=n.clusterProperties[S],A=typeof k=="string"?[k,["accumulated"],["get",S]]:k;b.push(...ss({key:`${o}.${S}.map`,value:I,validateSpec:y,expressionContext:"cluster-map"})),b.push(...ss({key:`${o}.${S}.reduce`,value:A,validateSpec:y,expressionContext:"cluster-reduce"}))}return b;case"video":return ni({key:o,value:n,valueSpec:l.source_video,style:p,validateSpec:y,styleSpec:l});case"image":return ni({key:o,value:n,valueSpec:l.source_image,style:p,validateSpec:y,styleSpec:l});case"canvas":return[new ze(o,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ro({key:`${o}.type`,value:n.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:p,validateSpec:y,styleSpec:l})}}function oh(i){const n=i.value,o=i.styleSpec,l=o.light,p=i.style;let y=[];const _=Ot(n);if(n===void 0)return y;if(_!=="object")return y=y.concat([new ze("light",n,`object expected, ${_} found`)]),y;for(const b in n){const S=b.match(/^(.*)-transition$/);y=y.concat(S&&l[S[1]]&&l[S[1]].transition?i.validateSpec({key:b,value:n[b],valueSpec:o.transition,validateSpec:i.validateSpec,style:p,styleSpec:o}):l[b]?i.validateSpec({key:b,value:n[b],valueSpec:l[b],validateSpec:i.validateSpec,style:p,styleSpec:o}):[new ze(b,n[b],`unknown property "${b}"`)])}return y}function ah(i){const n=i.value,o=i.styleSpec,l=o.sky,p=i.style,y=Ot(n);if(n===void 0)return[];if(y!=="object")return[new ze("sky",n,`object expected, ${y} found`)];let _=[];for(const b in n)_=_.concat(l[b]?i.validateSpec({key:b,value:n[b],valueSpec:l[b],style:p,styleSpec:o}):[new ze(b,n[b],`unknown property "${b}"`)]);return _}function sh(i){const n=i.value,o=i.styleSpec,l=o.terrain,p=i.style;let y=[];const _=Ot(n);if(n===void 0)return y;if(_!=="object")return y=y.concat([new ze("terrain",n,`object expected, ${_} found`)]),y;for(const b in n)y=y.concat(l[b]?i.validateSpec({key:b,value:n[b],valueSpec:l[b],validateSpec:i.validateSpec,style:p,styleSpec:o}):[new ze(b,n[b],`unknown property "${b}"`)]);return y}function lh(i){let n=[];const o=i.value,l=i.key;if(Array.isArray(o)){const p=[],y=[];for(const _ in o)o[_].id&&p.includes(o[_].id)&&n.push(new ze(l,o,`all the sprites' ids must be unique, but ${o[_].id} is duplicated`)),p.push(o[_].id),o[_].url&&y.includes(o[_].url)&&n.push(new ze(l,o,`all the sprites' URLs must be unique, but ${o[_].url} is duplicated`)),y.push(o[_].url),n=n.concat(ni({key:`${l}[${_}]`,value:o[_],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:i.validateSpec}));return n}return ka({key:l,value:o})}const fu={"*":()=>[],array:ll,boolean:function(i){const n=i.value,o=i.key,l=Ot(n);return l!=="boolean"?[new ze(o,n,`boolean expected, ${l} found`)]:[]},number:eh,color:function(i){const n=i.key,o=i.value,l=Ot(o);return l!=="string"?[new ze(n,o,`color expected, ${l} found`)]:Wt.parse(String(o))?[]:[new ze(n,o,`color expected, "${o}" found`)]},constants:fp,enum:Ro,filter:th,function:cu,layer:ih,object:ni,source:ul,light:oh,sky:ah,terrain:sh,projection:function(i){const n=i.value,o=i.styleSpec,l=o.projection,p=i.style,y=Ot(n);if(n===void 0)return[];if(y!=="object")return[new ze("projection",n,`object expected, ${y} found`)];let _=[];for(const b in n)_=_.concat(l[b]?i.validateSpec({key:b,value:n[b],valueSpec:l[b],style:p,styleSpec:o}):[new ze(b,n[b],`unknown property "${b}"`)]);return _},string:ka,formatted:function(i){return ka(i).length===0?[]:ss(i)},resolvedImage:function(i){return ka(i).length===0?[]:ss(i)},padding:function(i){const n=i.key,o=i.value;if(Ot(o)==="array"){if(o.length<1||o.length>4)return[new ze(n,o,`padding requires 1 to 4 values; ${o.length} values found`)];const l={type:"number"};let p=[];for(let y=0;y<o.length;y++)p=p.concat(i.validateSpec({key:`${n}[${y}]`,value:o[y],validateSpec:i.validateSpec,valueSpec:l}));return p}return eh({key:n,value:o,valueSpec:{}})},variableAnchorOffsetCollection:function(i){const n=i.key,o=i.value,l=Ot(o),p=i.styleSpec;if(l!=="array"||o.length<1||o.length%2!=0)return[new ze(n,o,"variableAnchorOffsetCollection requires a non-empty array of even length")];let y=[];for(let _=0;_<o.length;_+=2)y=y.concat(Ro({key:`${n}[${_}]`,value:o[_],valueSpec:p.layout_symbol["text-anchor"]})),y=y.concat(ll({key:`${n}[${_+1}]`,value:o[_+1],valueSpec:{length:2,value:"number"},validateSpec:i.validateSpec,style:i.style,styleSpec:p}));return y},sprite:lh};function ls(i){const n=i.value,o=i.valueSpec,l=i.styleSpec;return i.validateSpec=ls,o.expression&&nu(kr(n))?cu(i):o.expression&&au(Bi(n))?ss(i):o.type&&fu[o.type]?fu[o.type](i):ni(_t({},i,{valueSpec:o.type?l[o.type]:o}))}function mp(i){const n=i.value,o=i.key,l=ka(i);return l.length||(n.indexOf("{fontstack}")===-1&&l.push(new ze(o,n,'"glyphs" url must include a "{fontstack}" token')),n.indexOf("{range}")===-1&&l.push(new ze(o,n,'"glyphs" url must include a "{range}" token'))),l}function gi(i,n=xe){let o=[];return o=o.concat(ls({key:"",value:i,valueSpec:n.$root,styleSpec:n,style:i,validateSpec:ls,objectElementValidators:{glyphs:mp,"*":()=>[]}})),i.constants&&(o=o.concat(fp({key:"constants",value:i.constants,style:i,styleSpec:n,validateSpec:ls}))),uh(o)}function uo(i){return function(n){return i({...n,validateSpec:ls})}}function uh(i){return[].concat(i).sort((n,o)=>n.line-o.line)}function Oi(i){return function(...n){return uh(i.apply(this,n))}}gi.source=Oi(uo(ul)),gi.sprite=Oi(uo(lh)),gi.glyphs=Oi(uo(mp)),gi.light=Oi(uo(oh)),gi.sky=Oi(uo(ah)),gi.terrain=Oi(uo(sh)),gi.layer=Oi(uo(ih)),gi.filter=Oi(uo(th)),gi.paintProperty=Oi(uo(du)),gi.layoutProperty=Oi(uo(nh));const Ia=gi,Ag=Ia.light,Pg=Ia.sky,gp=Ia.paintProperty,yp=Ia.layoutProperty;function ch(i,n){let o=!1;if(n&&n.length)for(const l of n)i.fire(new io(new Error(l.message))),o=!0;return o}class us{constructor(n,o,l){const p=this.cells=[];if(n instanceof ArrayBuffer){this.arrayBuffer=n;const _=new Int32Array(this.arrayBuffer);n=_[0],this.d=(o=_[1])+2*(l=_[2]);for(let S=0;S<this.d*this.d;S++){const k=_[3+S],I=_[3+S+1];p.push(k===I?null:_.subarray(k,I))}const b=_[3+p.length+1];this.keys=_.subarray(_[3+p.length],b),this.bboxes=_.subarray(b),this.insert=this._insertReadonly}else{this.d=o+2*l;for(let _=0;_<this.d*this.d;_++)p.push([]);this.keys=[],this.bboxes=[]}this.n=o,this.extent=n,this.padding=l,this.scale=o/n,this.uid=0;const y=l/o*n;this.min=-y,this.max=n+y}insert(n,o,l,p,y){this._forEachCell(o,l,p,y,this._insertCell,this.uid++,void 0,void 0),this.keys.push(n),this.bboxes.push(o),this.bboxes.push(l),this.bboxes.push(p),this.bboxes.push(y)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(n,o,l,p,y,_){this.cells[y].push(_)}query(n,o,l,p,y){const _=this.min,b=this.max;if(n<=_&&o<=_&&b<=l&&b<=p&&!y)return Array.prototype.slice.call(this.keys);{const S=[];return this._forEachCell(n,o,l,p,this._queryCell,S,{},y),S}}_queryCell(n,o,l,p,y,_,b,S){const k=this.cells[y];if(k!==null){const I=this.keys,A=this.bboxes;for(let L=0;L<k.length;L++){const F=k[L];if(b[F]===void 0){const $=4*F;(S?S(A[$+0],A[$+1],A[$+2],A[$+3]):n<=A[$+2]&&o<=A[$+3]&&l>=A[$+0]&&p>=A[$+1])?(b[F]=!0,_.push(I[F])):b[F]=!1}}}}_forEachCell(n,o,l,p,y,_,b,S){const k=this._convertToCellCoord(n),I=this._convertToCellCoord(o),A=this._convertToCellCoord(l),L=this._convertToCellCoord(p);for(let F=k;F<=A;F++)for(let $=I;$<=L;$++){const j=this.d*$+F;if((!S||S(this._convertFromCellCoord(F),this._convertFromCellCoord($),this._convertFromCellCoord(F+1),this._convertFromCellCoord($+1)))&&y.call(this,n,o,l,p,j,_,b,S))return}}_convertFromCellCoord(n){return(n-this.padding)/this.scale}_convertToCellCoord(n){return Math.max(0,Math.min(this.d-1,Math.floor(n*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const n=this.cells,o=3+this.cells.length+1+1;let l=0;for(let _=0;_<this.cells.length;_++)l+=this.cells[_].length;const p=new Int32Array(o+l+this.keys.length+this.bboxes.length);p[0]=this.extent,p[1]=this.n,p[2]=this.padding;let y=o;for(let _=0;_<n.length;_++){const b=n[_];p[3+_]=y,p.set(b,y),y+=b.length}return p[3+n.length]=y,p.set(this.keys,y),y+=this.keys.length,p[3+n.length+1]=y,p.set(this.bboxes,y),y+=this.bboxes.length,p.buffer}static serialize(n,o){const l=n.toArrayBuffer();return o&&o.push(l),{buffer:l}}static deserialize(n){return new us(n.buffer)}}const yi={};function Ke(i,n,o={}){if(yi[i])throw new Error(`${i} is already registered.`);Object.defineProperty(n,"_classRegistryKey",{value:i,writeable:!1}),yi[i]={klass:n,omit:o.omit||[],shallow:o.shallow||[]}}Ke("Object",Object),Ke("TransferableGridIndex",us),Ke("Color",Wt),Ke("Error",Error),Ke("AJAXError",Br),Ke("ResolvedImage",ri),Ke("StylePropertyFunction",as),Ke("StyleExpression",ou,{omit:["_evaluator"]}),Ke("ZoomDependentExpression",os),Ke("ZoomConstantExpression",is),Ke("CompoundExpression",mi,{omit:["_evaluate"]});for(const i in Ja)Ja[i]._classRegistryKey||Ke(`Expression_${i}`,Ja[i]);function mu(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function hh(i){return i.$name||i.constructor._classRegistryKey}function _p(i){return!function(n){if(n===null||typeof n!="object")return!1;const o=hh(n);return!(!o||o==="Object")}(i)&&(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob||i instanceof Error||mu(i)||Fr(i)||ArrayBuffer.isView(i)||i instanceof ImageData)}function cs(i,n){if(_p(i))return(mu(i)||Fr(i))&&n&&n.push(i),ArrayBuffer.isView(i)&&n&&n.push(i.buffer),i instanceof ImageData&&n&&n.push(i.data.buffer),i;if(Array.isArray(i)){const y=[];for(const _ of i)y.push(cs(_,n));return y}if(typeof i!="object")throw new Error("can't serialize object of type "+typeof i);const o=hh(i);if(!o)throw new Error(`can't serialize object of unregistered class ${i.constructor.name}`);if(!yi[o])throw new Error(`${o} is not registered.`);const{klass:l}=yi[o],p=l.serialize?l.serialize(i,n):{};if(l.serialize){if(n&&p===n[n.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const y in i){if(!i.hasOwnProperty(y)||yi[o].omit.indexOf(y)>=0)continue;const _=i[y];p[y]=yi[o].shallow.indexOf(y)>=0?_:cs(_,n)}i instanceof Error&&(p.message=i.message)}if(p.$name)throw new Error("$name property is reserved for worker serialization logic.");return o!=="Object"&&(p.$name=o),p}function hs(i){if(_p(i))return i;if(Array.isArray(i))return i.map(hs);if(typeof i!="object")throw new Error("can't deserialize object of type "+typeof i);const n=hh(i)||"Object";if(!yi[n])throw new Error(`can't deserialize unregistered class ${n}`);const{klass:o}=yi[n];if(!o)throw new Error(`can't deserialize unregistered class ${n}`);if(o.deserialize)return o.deserialize(i);const l=Object.create(o.prototype);for(const p of Object.keys(i)){if(p==="$name")continue;const y=i[p];l[p]=yi[n].shallow.indexOf(p)>=0?y:hs(y)}return l}class dh{constructor(){this.first=!0}update(n,o){const l=Math.floor(n);return this.first?(this.first=!1,this.lastIntegerZoom=l,this.lastIntegerZoomTime=0,this.lastZoom=n,this.lastFloorZoom=l,!0):(this.lastFloorZoom>l?(this.lastIntegerZoom=l+1,this.lastIntegerZoomTime=o):this.lastFloorZoom<l&&(this.lastIntegerZoom=l,this.lastIntegerZoomTime=o),n!==this.lastZoom&&(this.lastZoom=n,this.lastFloorZoom=l,!0))}}const Mt={"Latin-1 Supplement":i=>i>=128&&i<=255,"Hangul Jamo":i=>i>=4352&&i<=4607,Khmer:i=>i>=6016&&i<=6143,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Katakana:i=>i>=12448&&i<=12543,Kanbun:i=>i>=12688&&i<=12703,"CJK Strokes":i=>i>=12736&&i<=12783,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"Private Use Area":i=>i>=57344&&i<=63743,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519};function ph(i){for(const n of i)if(mh(n.charCodeAt(0)))return!0;return!1}function Mg(i){for(const n of i)if(!ds(n.charCodeAt(0)))return!1;return!0}function fh(i){const n=i.map(o=>{try{return new RegExp(`\\p{sc=${o}}`,"u").source}catch{return null}}).filter(o=>o);return new RegExp(n.join("|"),"u")}const zg=fh(["Arab","Dupl","Mong","Ougr","Syrc"]);function ds(i){return!zg.test(String.fromCodePoint(i))}const vp=fh(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function mh(i){return!(i!==746&&i!==747&&(i<4352||!(Mt["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||Mt["CJK Compatibility"](i)||Mt["CJK Strokes"](i)||!(!Mt["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||Mt["Enclosed CJK Letters and Months"](i)||Mt["Ideographic Description Characters"](i)||Mt.Kanbun(i)||Mt.Katakana(i)&&i!==12540||!(!Mt["Halfwidth and Fullwidth Forms"](i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!Mt["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||Mt["Vertical Forms"](i)||Mt["Yijing Hexagram Symbols"](i)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(i))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(i))||vp.test(String.fromCodePoint(i)))))}function xp(i){return!(mh(i)||function(n){return!!(Mt["Latin-1 Supplement"](n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||Mt["General Punctuation"](n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||Mt["Letterlike Symbols"](n)||Mt["Number Forms"](n)||Mt["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||Mt["Control Pictures"](n)&&n!==9251||Mt["Optical Character Recognition"](n)||Mt["Enclosed Alphanumerics"](n)||Mt["Geometric Shapes"](n)||Mt["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||Mt["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||Mt["CJK Symbols and Punctuation"](n)||Mt.Katakana(n)||Mt["Private Use Area"](n)||Mt["CJK Compatibility Forms"](n)||Mt["Small Form Variants"](n)||Mt["Halfwidth and Fullwidth Forms"](n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)}(i))}const Lg=fh(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function gh(i){return Lg.test(String.fromCodePoint(i))}function Rg(i,n){return!(!n&&gh(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||Mt.Khmer(i))}function Dg(i){for(const n of i)if(gh(n.charCodeAt(0)))return!0;return!1}const ii=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(i){this.pluginStatus=i.pluginStatus,this.pluginURL=i.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(i){this.applyArabicShaping=i.applyArabicShaping,this.processBidirectionalText=i.processBidirectionalText,this.processStyledBidirectionalText=i.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class cr{constructor(n,o){this.zoom=n,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.zoomHistory=o.zoomHistory,this.transition=o.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new dh,this.transition={})}isSupportedScript(n){return function(o,l){for(const p of o)if(!Rg(p.charCodeAt(0),l))return!1;return!0}(n,ii.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const n=this.zoom,o=n-Math.floor(n),l=this.crossFadingFactor();return n>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:o+(1-o)*l}:{fromScale:.5,toScale:1,t:1-(1-l)*o}}}class ps{constructor(n,o){this.property=n,this.value=o,this.expression=function(l,p){if(nu(l))return new as(l,p);if(au(l)){const y=Yc(l,p);if(y.result==="error")throw new Error(y.value.map(_=>`${_.key}: ${_.message}`).join(", "));return y.value}{let y=l;return p.type==="color"&&typeof l=="string"?y=Wt.parse(l):p.type!=="padding"||typeof l!="number"&&!Array.isArray(l)?p.type==="variableAnchorOffsetCollection"&&Array.isArray(l)&&(y=fi.parse(l)):y=ti.parse(l),{kind:"constant",evaluate:()=>y}}}(o===void 0?n.specification.default:o,n.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(n,o,l){return this.property.possiblyEvaluate(this,n,o,l)}}class gu{constructor(n){this.property=n,this.value=new ps(n,void 0)}transitioned(n,o){return new bp(this.property,this.value,o,ke({},n.transition,this.transition),n.now)}untransitioned(){return new bp(this.property,this.value,null,{},0)}}class yu{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitionablePropertyValues)}getValue(n){return ot(this._values[n].value.value)}setValue(n,o){Object.prototype.hasOwnProperty.call(this._values,n)||(this._values[n]=new gu(this._values[n].property)),this._values[n].value=new ps(this._values[n].property,o===null?void 0:ot(o))}getTransition(n){return ot(this._values[n].transition)}setTransition(n,o){Object.prototype.hasOwnProperty.call(this._values,n)||(this._values[n]=new gu(this._values[n].property)),this._values[n].transition=ot(o)||void 0}serialize(){const n={};for(const o of Object.keys(this._values)){const l=this.getValue(o);l!==void 0&&(n[o]=l);const p=this.getTransition(o);p!==void 0&&(n[`${o}-transition`]=p)}return n}transitioned(n,o){const l=new cl(this._properties);for(const p of Object.keys(this._values))l._values[p]=this._values[p].transitioned(n,o._values[p]);return l}untransitioned(){const n=new cl(this._properties);for(const o of Object.keys(this._values))n._values[o]=this._values[o].untransitioned();return n}}class bp{constructor(n,o,l,p,y){this.property=n,this.value=o,this.begin=y+p.delay||0,this.end=this.begin+p.duration||0,n.specification.transition&&(p.delay||p.duration)&&(this.prior=l)}possiblyEvaluate(n,o,l){const p=n.now||0,y=this.value.possiblyEvaluate(n,o,l),_=this.prior;if(_){if(p>this.end)return this.prior=null,y;if(this.value.isDataDriven())return this.prior=null,y;if(p<this.begin)return _.possiblyEvaluate(n,o,l);{const b=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(_.possiblyEvaluate(n,o,l),y,function(S){if(S<=0)return 0;if(S>=1)return 1;const k=S*S,I=k*S;return 4*(S<.5?I:3*(S-k)+I-.75)}(b))}}return y}}class cl{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitioningPropertyValues)}possiblyEvaluate(n,o,l){const p=new dl(this._properties);for(const y of Object.keys(this._values))p._values[y]=this._values[y].possiblyEvaluate(n,o,l);return p}hasTransition(){for(const n of Object.keys(this._values))if(this._values[n].prior)return!0;return!1}}class hl{constructor(n){this._properties=n,this._values=Object.create(n.defaultPropertyValues)}hasValue(n){return this._values[n].value!==void 0}getValue(n){return ot(this._values[n].value)}setValue(n,o){this._values[n]=new ps(this._values[n].property,o===null?void 0:ot(o))}serialize(){const n={};for(const o of Object.keys(this._values)){const l=this.getValue(o);l!==void 0&&(n[o]=l)}return n}possiblyEvaluate(n,o,l){const p=new dl(this._properties);for(const y of Object.keys(this._values))p._values[y]=this._values[y].possiblyEvaluate(n,o,l);return p}}class co{constructor(n,o,l){this.property=n,this.value=o,this.parameters=l}isConstant(){return this.value.kind==="constant"}constantOr(n){return this.value.kind==="constant"?this.value.value:n}evaluate(n,o,l,p){return this.property.evaluate(this.value,this.parameters,n,o,l,p)}}class dl{constructor(n){this._properties=n,this._values=Object.create(n.defaultPossiblyEvaluatedValues)}get(n){return this._values[n]}}class Ye{constructor(n){this.specification=n}possiblyEvaluate(n,o){if(n.isDataDriven())throw new Error("Value should not be data driven");return n.expression.evaluate(o)}interpolate(n,o,l){const p=Nn[this.specification.type];return p?p(n,o,l):n}}class ut{constructor(n,o){this.specification=n,this.overrides=o}possiblyEvaluate(n,o,l,p){return new co(this,n.expression.kind==="constant"||n.expression.kind==="camera"?{kind:"constant",value:n.expression.evaluate(o,null,{},l,p)}:n.expression,o)}interpolate(n,o,l){if(n.value.kind!=="constant"||o.value.kind!=="constant")return n;if(n.value.value===void 0||o.value.value===void 0)return new co(this,{kind:"constant",value:void 0},n.parameters);const p=Nn[this.specification.type];if(p){const y=p(n.value.value,o.value.value,l);return new co(this,{kind:"constant",value:y},n.parameters)}return n}evaluate(n,o,l,p,y,_){return n.kind==="constant"?n.value:n.evaluate(o,l,p,y,_)}}class _u extends ut{possiblyEvaluate(n,o,l,p){if(n.value===void 0)return new co(this,{kind:"constant",value:void 0},o);if(n.expression.kind==="constant"){const y=n.expression.evaluate(o,null,{},l,p),_=n.property.specification.type==="resolvedImage"&&typeof y!="string"?y.name:y,b=this._calculate(_,_,_,o);return new co(this,{kind:"constant",value:b},o)}if(n.expression.kind==="camera"){const y=this._calculate(n.expression.evaluate({zoom:o.zoom-1}),n.expression.evaluate({zoom:o.zoom}),n.expression.evaluate({zoom:o.zoom+1}),o);return new co(this,{kind:"constant",value:y},o)}return new co(this,n.expression,o)}evaluate(n,o,l,p,y,_){if(n.kind==="source"){const b=n.evaluate(o,l,p,y,_);return this._calculate(b,b,b,o)}return n.kind==="composite"?this._calculate(n.evaluate({zoom:Math.floor(o.zoom)-1},l,p),n.evaluate({zoom:Math.floor(o.zoom)},l,p),n.evaluate({zoom:Math.floor(o.zoom)+1},l,p),o):n.value}_calculate(n,o,l,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:n,to:o}:{from:l,to:o}}interpolate(n){return n}}class vu{constructor(n){this.specification=n}possiblyEvaluate(n,o,l,p){if(n.value!==void 0){if(n.expression.kind==="constant"){const y=n.expression.evaluate(o,null,{},l,p);return this._calculate(y,y,y,o)}return this._calculate(n.expression.evaluate(new cr(Math.floor(o.zoom-1),o)),n.expression.evaluate(new cr(Math.floor(o.zoom),o)),n.expression.evaluate(new cr(Math.floor(o.zoom+1),o)),o)}}_calculate(n,o,l,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:n,to:o}:{from:l,to:o}}interpolate(n){return n}}class yh{constructor(n){this.specification=n}possiblyEvaluate(n,o,l,p){return!!n.expression.evaluate(o,null,{},l,p)}interpolate(){return!1}}class g{constructor(n){this.properties=n,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const o in n){const l=n[o];l.specification.overridable&&this.overridableProperties.push(o);const p=this.defaultPropertyValues[o]=new ps(l,void 0),y=this.defaultTransitionablePropertyValues[o]=new gu(l);this.defaultTransitioningPropertyValues[o]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[o]=p.possiblyEvaluate({})}}}Ke("DataDrivenProperty",ut),Ke("DataConstantProperty",Ye),Ke("CrossFadedDataDrivenProperty",_u),Ke("CrossFadedProperty",vu),Ke("ColorRampProperty",yh);const r="-transition";class s extends Zo{constructor(n,o){if(super(),this.id=n.id,this.type=n.type,this._featureFilter={filter:()=>!0,needGeometry:!1},n.type!=="custom"&&(this.metadata=n.metadata,this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,n.type!=="background"&&(this.source=n.source,this.sourceLayer=n["source-layer"],this.filter=n.filter),o.layout&&(this._unevaluatedLayout=new hl(o.layout)),o.paint)){this._transitionablePaint=new yu(o.paint);for(const l in n.paint)this.setPaintProperty(l,n.paint[l],{validate:!1});for(const l in n.layout)this.setLayoutProperty(l,n.layout[l],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new dl(o.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(n){return n==="visibility"?this.visibility:this._unevaluatedLayout.getValue(n)}setLayoutProperty(n,o,l={}){o!=null&&this._validate(yp,`layers.${this.id}.layout.${n}`,n,o,l)||(n!=="visibility"?this._unevaluatedLayout.setValue(n,o):this.visibility=o)}getPaintProperty(n){return n.endsWith(r)?this._transitionablePaint.getTransition(n.slice(0,-11)):this._transitionablePaint.getValue(n)}setPaintProperty(n,o,l={}){if(o!=null&&this._validate(gp,`layers.${this.id}.paint.${n}`,n,o,l))return!1;if(n.endsWith(r))return this._transitionablePaint.setTransition(n.slice(0,-11),o||void 0),!1;{const p=this._transitionablePaint._values[n],y=p.property.specification["property-type"]==="cross-faded-data-driven",_=p.value.isDataDriven(),b=p.value;this._transitionablePaint.setValue(n,o),this._handleSpecialPaintPropertyUpdate(n);const S=this._transitionablePaint._values[n].value;return S.isDataDriven()||_||y||this._handleOverridablePaintPropertyUpdate(n,b,S)}}_handleSpecialPaintPropertyUpdate(n){}_handleOverridablePaintPropertyUpdate(n,o,l){return!1}isHidden(n){return!!(this.minzoom&&n<this.minzoom)||!!(this.maxzoom&&n>=this.maxzoom)||this.visibility==="none"}updateTransitions(n){this._transitioningPaint=this._transitionablePaint.transitioned(n,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(n,o){n.getCrossfadeParameters&&(this._crossfadeParameters=n.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(n,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(n,void 0,o)}serialize(){const n={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(n.layout=n.layout||{},n.layout.visibility=this.visibility),tt(n,(o,l)=>!(o===void 0||l==="layout"&&!Object.keys(o).length||l==="paint"&&!Object.keys(o).length))}_validate(n,o,l,p,y={}){return(!y||y.validate!==!1)&&ch(this,n.call(Ia,{key:o,layerType:this.type,objectKey:l,value:p,styleSpec:xe,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const n in this.paint._values){const o=this.paint.get(n);if(o instanceof co&&ts(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}}const c={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class d{constructor(n,o){this._structArray=n,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class m{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(n,o){return n._trim(),o&&(n.isTransferred=!0,o.push(n.arrayBuffer)),{length:n.length,arrayBuffer:n.arrayBuffer}}static deserialize(n){const o=Object.create(this.prototype);return o.arrayBuffer=n.arrayBuffer,o.length=n.length,o.capacity=n.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(n){this.reserve(n),this.length=n}reserve(n){if(n>this.capacity){this.capacity=Math.max(n,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function w(i,n=1){let o=0,l=0;return{members:i.map(p=>{const y=c[p.type].BYTES_PER_ELEMENT,_=o=T(o,Math.max(n,y)),b=p.components||1;return l=Math.max(l,y),o+=y*b,{name:p.name,type:p.type,components:b,offset:_}}),size:T(o,Math.max(l,n)),alignment:n}}function T(i,n){return Math.ceil(i/n)*n}class C extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o){const l=this.length;return this.resize(l+1),this.emplace(l,n,o)}emplace(n,o,l){const p=2*n;return this.int16[p+0]=o,this.int16[p+1]=l,n}}C.prototype.bytesPerElement=4,Ke("StructArrayLayout2i4",C);class E extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,l){const p=this.length;return this.resize(p+1),this.emplace(p,n,o,l)}emplace(n,o,l,p){const y=3*n;return this.int16[y+0]=o,this.int16[y+1]=l,this.int16[y+2]=p,n}}E.prototype.bytesPerElement=6,Ke("StructArrayLayout3i6",E);class P extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,l,p){const y=this.length;return this.resize(y+1),this.emplace(y,n,o,l,p)}emplace(n,o,l,p,y){const _=4*n;return this.int16[_+0]=o,this.int16[_+1]=l,this.int16[_+2]=p,this.int16[_+3]=y,n}}P.prototype.bytesPerElement=8,Ke("StructArrayLayout4i8",P);class M extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,l,p,y,_){const b=this.length;return this.resize(b+1),this.emplace(b,n,o,l,p,y,_)}emplace(n,o,l,p,y,_,b){const S=6*n;return this.int16[S+0]=o,this.int16[S+1]=l,this.int16[S+2]=p,this.int16[S+3]=y,this.int16[S+4]=_,this.int16[S+5]=b,n}}M.prototype.bytesPerElement=12,Ke("StructArrayLayout2i4i12",M);class N extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,l,p,y,_){const b=this.length;return this.resize(b+1),this.emplace(b,n,o,l,p,y,_)}emplace(n,o,l,p,y,_,b){const S=4*n,k=8*n;return this.int16[S+0]=o,this.int16[S+1]=l,this.uint8[k+4]=p,this.uint8[k+5]=y,this.uint8[k+6]=_,this.uint8[k+7]=b,n}}N.prototype.bytesPerElement=8,Ke("StructArrayLayout2i4ub8",N);class V extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o){const l=this.length;return this.resize(l+1),this.emplace(l,n,o)}emplace(n,o,l){const p=2*n;return this.float32[p+0]=o,this.float32[p+1]=l,n}}V.prototype.bytesPerElement=8,Ke("StructArrayLayout2f8",V);class G extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,l,p,y,_,b,S,k,I){const A=this.length;return this.resize(A+1),this.emplace(A,n,o,l,p,y,_,b,S,k,I)}emplace(n,o,l,p,y,_,b,S,k,I,A){const L=10*n;return this.uint16[L+0]=o,this.uint16[L+1]=l,this.uint16[L+2]=p,this.uint16[L+3]=y,this.uint16[L+4]=_,this.uint16[L+5]=b,this.uint16[L+6]=S,this.uint16[L+7]=k,this.uint16[L+8]=I,this.uint16[L+9]=A,n}}G.prototype.bytesPerElement=20,Ke("StructArrayLayout10ui20",G);class Y extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,l,p,y,_,b,S,k,I,A,L){const F=this.length;return this.resize(F+1),this.emplace(F,n,o,l,p,y,_,b,S,k,I,A,L)}emplace(n,o,l,p,y,_,b,S,k,I,A,L,F){const $=12*n;return this.int16[$+0]=o,this.int16[$+1]=l,this.int16[$+2]=p,this.int16[$+3]=y,this.uint16[$+4]=_,this.uint16[$+5]=b,this.uint16[$+6]=S,this.uint16[$+7]=k,this.int16[$+8]=I,this.int16[$+9]=A,this.int16[$+10]=L,this.int16[$+11]=F,n}}Y.prototype.bytesPerElement=24,Ke("StructArrayLayout4i4ui4i24",Y);class ee extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,l){const p=this.length;return this.resize(p+1),this.emplace(p,n,o,l)}emplace(n,o,l,p){const y=3*n;return this.float32[y+0]=o,this.float32[y+1]=l,this.float32[y+2]=p,n}}ee.prototype.bytesPerElement=12,Ke("StructArrayLayout3f12",ee);class re extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n){const o=this.length;return this.resize(o+1),this.emplace(o,n)}emplace(n,o){return this.uint32[1*n+0]=o,n}}re.prototype.bytesPerElement=4,Ke("StructArrayLayout1ul4",re);class oe extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,l,p,y,_,b,S,k){const I=this.length;return this.resize(I+1),this.emplace(I,n,o,l,p,y,_,b,S,k)}emplace(n,o,l,p,y,_,b,S,k,I){const A=10*n,L=5*n;return this.int16[A+0]=o,this.int16[A+1]=l,this.int16[A+2]=p,this.int16[A+3]=y,this.int16[A+4]=_,this.int16[A+5]=b,this.uint32[L+3]=S,this.uint16[A+8]=k,this.uint16[A+9]=I,n}}oe.prototype.bytesPerElement=20,Ke("StructArrayLayout6i1ul2ui20",oe);class W extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,l,p,y,_){const b=this.length;return this.resize(b+1),this.emplace(b,n,o,l,p,y,_)}emplace(n,o,l,p,y,_,b){const S=6*n;return this.int16[S+0]=o,this.int16[S+1]=l,this.int16[S+2]=p,this.int16[S+3]=y,this.int16[S+4]=_,this.int16[S+5]=b,n}}W.prototype.bytesPerElement=12,Ke("StructArrayLayout2i2i2i12",W);class ue extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,l,p,y){const _=this.length;return this.resize(_+1),this.emplace(_,n,o,l,p,y)}emplace(n,o,l,p,y,_){const b=4*n,S=8*n;return this.float32[b+0]=o,this.float32[b+1]=l,this.float32[b+2]=p,this.int16[S+6]=y,this.int16[S+7]=_,n}}ue.prototype.bytesPerElement=16,Ke("StructArrayLayout2f1f2i16",ue);class pe extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,o,l,p,y,_){const b=this.length;return this.resize(b+1),this.emplace(b,n,o,l,p,y,_)}emplace(n,o,l,p,y,_,b){const S=16*n,k=4*n,I=8*n;return this.uint8[S+0]=o,this.uint8[S+1]=l,this.float32[k+1]=p,this.float32[k+2]=y,this.int16[I+6]=_,this.int16[I+7]=b,n}}pe.prototype.bytesPerElement=16,Ke("StructArrayLayout2ub2f2i16",pe);class ye extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,l){const p=this.length;return this.resize(p+1),this.emplace(p,n,o,l)}emplace(n,o,l,p){const y=3*n;return this.uint16[y+0]=o,this.uint16[y+1]=l,this.uint16[y+2]=p,n}}ye.prototype.bytesPerElement=6,Ke("StructArrayLayout3ui6",ye);class Ce extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,l,p,y,_,b,S,k,I,A,L,F,$,j,K,Q){const ge=this.length;return this.resize(ge+1),this.emplace(ge,n,o,l,p,y,_,b,S,k,I,A,L,F,$,j,K,Q)}emplace(n,o,l,p,y,_,b,S,k,I,A,L,F,$,j,K,Q,ge){const se=24*n,fe=12*n,be=48*n;return this.int16[se+0]=o,this.int16[se+1]=l,this.uint16[se+2]=p,this.uint16[se+3]=y,this.uint32[fe+2]=_,this.uint32[fe+3]=b,this.uint32[fe+4]=S,this.uint16[se+10]=k,this.uint16[se+11]=I,this.uint16[se+12]=A,this.float32[fe+7]=L,this.float32[fe+8]=F,this.uint8[be+36]=$,this.uint8[be+37]=j,this.uint8[be+38]=K,this.uint32[fe+10]=Q,this.int16[se+22]=ge,n}}Ce.prototype.bytesPerElement=48,Ke("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ce);class Me extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,l,p,y,_,b,S,k,I,A,L,F,$,j,K,Q,ge,se,fe,be,Pe,qe,st,Ue,Ne,et,Xe){const We=this.length;return this.resize(We+1),this.emplace(We,n,o,l,p,y,_,b,S,k,I,A,L,F,$,j,K,Q,ge,se,fe,be,Pe,qe,st,Ue,Ne,et,Xe)}emplace(n,o,l,p,y,_,b,S,k,I,A,L,F,$,j,K,Q,ge,se,fe,be,Pe,qe,st,Ue,Ne,et,Xe,We){const Te=32*n,rt=16*n;return this.int16[Te+0]=o,this.int16[Te+1]=l,this.int16[Te+2]=p,this.int16[Te+3]=y,this.int16[Te+4]=_,this.int16[Te+5]=b,this.int16[Te+6]=S,this.int16[Te+7]=k,this.uint16[Te+8]=I,this.uint16[Te+9]=A,this.uint16[Te+10]=L,this.uint16[Te+11]=F,this.uint16[Te+12]=$,this.uint16[Te+13]=j,this.uint16[Te+14]=K,this.uint16[Te+15]=Q,this.uint16[Te+16]=ge,this.uint16[Te+17]=se,this.uint16[Te+18]=fe,this.uint16[Te+19]=be,this.uint16[Te+20]=Pe,this.uint16[Te+21]=qe,this.uint16[Te+22]=st,this.uint32[rt+12]=Ue,this.float32[rt+13]=Ne,this.float32[rt+14]=et,this.uint16[Te+30]=Xe,this.uint16[Te+31]=We,n}}Me.prototype.bytesPerElement=64,Ke("StructArrayLayout8i15ui1ul2f2ui64",Me);class $e extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n){const o=this.length;return this.resize(o+1),this.emplace(o,n)}emplace(n,o){return this.float32[1*n+0]=o,n}}$e.prototype.bytesPerElement=4,Ke("StructArrayLayout1f4",$e);class Ge extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,l){const p=this.length;return this.resize(p+1),this.emplace(p,n,o,l)}emplace(n,o,l,p){const y=3*n;return this.uint16[6*n+0]=o,this.float32[y+1]=l,this.float32[y+2]=p,n}}Ge.prototype.bytesPerElement=12,Ke("StructArrayLayout1ui2f12",Ge);class Fe extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o,l){const p=this.length;return this.resize(p+1),this.emplace(p,n,o,l)}emplace(n,o,l,p){const y=4*n;return this.uint32[2*n+0]=o,this.uint16[y+2]=l,this.uint16[y+3]=p,n}}Fe.prototype.bytesPerElement=8,Ke("StructArrayLayout1ul2ui8",Fe);class De extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,o){const l=this.length;return this.resize(l+1),this.emplace(l,n,o)}emplace(n,o,l){const p=2*n;return this.uint16[p+0]=o,this.uint16[p+1]=l,n}}De.prototype.bytesPerElement=4,Ke("StructArrayLayout2ui4",De);class Je extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n){const o=this.length;return this.resize(o+1),this.emplace(o,n)}emplace(n,o){return this.uint16[1*n+0]=o,n}}Je.prototype.bytesPerElement=2,Ke("StructArrayLayout1ui2",Je);class vt extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,o,l,p){const y=this.length;return this.resize(y+1),this.emplace(y,n,o,l,p)}emplace(n,o,l,p,y){const _=4*n;return this.float32[_+0]=o,this.float32[_+1]=l,this.float32[_+2]=p,this.float32[_+3]=y,n}}vt.prototype.bytesPerElement=16,Ke("StructArrayLayout4f16",vt);class Oe extends d{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new U(this.anchorPointX,this.anchorPointY)}}Oe.prototype.size=20;class je extends oe{get(n){return new Oe(this,n)}}Ke("CollisionBoxArray",je);class pt extends d{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(n){this._structArray.uint8[this._pos1+37]=n}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(n){this._structArray.uint8[this._pos1+38]=n}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(n){this._structArray.uint32[this._pos4+10]=n}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}pt.prototype.size=48;class hr extends Ce{get(n){return new pt(this,n)}}Ke("PlacedSymbolArray",hr);class wt extends d{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(n){this._structArray.uint32[this._pos4+12]=n}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}wt.prototype.size=64;class At extends Me{get(n){return new wt(this,n)}}Ke("SymbolInstanceArray",At);class dr extends $e{getoffsetX(n){return this.float32[1*n+0]}}Ke("GlyphOffsetArray",dr);class pn extends E{getx(n){return this.int16[3*n+0]}gety(n){return this.int16[3*n+1]}gettileUnitDistanceFromAnchor(n){return this.int16[3*n+2]}}Ke("SymbolLineVertexArray",pn);class Ni extends d{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Ni.prototype.size=12;class pr extends Ge{get(n){return new Ni(this,n)}}Ke("TextAnchorOffsetArray",pr);class Un extends d{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Un.prototype.size=8;class kn extends Fe{get(n){return new Un(this,n)}}Ke("FeatureIndexArray",kn);class fn extends C{}class In extends C{}class ho extends C{}class fs extends M{}class xu extends N{}class ms extends V{}class _i extends G{}class bu extends Y{}class _h extends ee{}class vi extends re{}class xi extends W{}class Xo extends pe{}class $i extends ye{}class ln extends De{}const mn=w([{name:"a_pos",components:2,type:"Int16"}],4),{members:oi}=mn;class zt{constructor(n=[]){this.segments=n}prepareSegment(n,o,l,p){let y=this.segments[this.segments.length-1];return n>zt.MAX_VERTEX_ARRAY_LENGTH&&It(`Max vertices per segment is ${zt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${n}`),(!y||y.vertexLength+n>zt.MAX_VERTEX_ARRAY_LENGTH||y.sortKey!==p)&&(y={vertexOffset:o.length,primitiveOffset:l.length,vertexLength:0,primitiveLength:0},p!==void 0&&(y.sortKey=p),this.segments.push(y)),y}get(){return this.segments}destroy(){for(const n of this.segments)for(const o in n.vaos)n.vaos[o].destroy()}static simpleSegment(n,o,l,p){return new zt([{vertexOffset:n,primitiveOffset:o,vertexLength:l,primitiveLength:p,vaos:{},sortKey:0}])}}function Ea(i,n){return 256*(i=Se(Math.floor(i),0,255))+Se(Math.floor(n),0,255)}zt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ke("SegmentVector",zt);const gs=w([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var ys={exports:{}},wp={exports:{}};wp.exports=function(i,n){var o,l,p,y,_,b,S,k;for(l=i.length-(o=3&i.length),p=n,_=3432918353,b=461845907,k=0;k<l;)S=255&i.charCodeAt(k)|(255&i.charCodeAt(++k))<<8|(255&i.charCodeAt(++k))<<16|(255&i.charCodeAt(++k))<<24,++k,p=27492+(65535&(y=5*(65535&(p=(p^=S=(65535&(S=(S=(65535&S)*_+(((S>>>16)*_&65535)<<16)&4294967295)<<15|S>>>17))*b+(((S>>>16)*b&65535)<<16)&4294967295)<<13|p>>>19))+((5*(p>>>16)&65535)<<16)&4294967295))+((58964+(y>>>16)&65535)<<16);switch(S=0,o){case 3:S^=(255&i.charCodeAt(k+2))<<16;case 2:S^=(255&i.charCodeAt(k+1))<<8;case 1:p^=S=(65535&(S=(S=(65535&(S^=255&i.charCodeAt(k)))*_+(((S>>>16)*_&65535)<<16)&4294967295)<<15|S>>>17))*b+(((S>>>16)*b&65535)<<16)&4294967295}return p^=i.length,p=2246822507*(65535&(p^=p>>>16))+((2246822507*(p>>>16)&65535)<<16)&4294967295,p=3266489909*(65535&(p^=p>>>13))+((3266489909*(p>>>16)&65535)<<16)&4294967295,(p^=p>>>16)>>>0};var Fg=wp.exports,Sp={exports:{}};Sp.exports=function(i,n){for(var o,l=i.length,p=n^l,y=0;l>=4;)o=1540483477*(65535&(o=255&i.charCodeAt(y)|(255&i.charCodeAt(++y))<<8|(255&i.charCodeAt(++y))<<16|(255&i.charCodeAt(++y))<<24))+((1540483477*(o>>>16)&65535)<<16),p=1540483477*(65535&p)+((1540483477*(p>>>16)&65535)<<16)^(o=1540483477*(65535&(o^=o>>>24))+((1540483477*(o>>>16)&65535)<<16)),l-=4,++y;switch(l){case 3:p^=(255&i.charCodeAt(y+2))<<16;case 2:p^=(255&i.charCodeAt(y+1))<<8;case 1:p=1540483477*(65535&(p^=255&i.charCodeAt(y)))+((1540483477*(p>>>16)&65535)<<16)}return p=1540483477*(65535&(p^=p>>>13))+((1540483477*(p>>>16)&65535)<<16),(p^=p>>>15)>>>0};var Yo=Fg,Tp=Sp.exports;ys.exports=Yo,ys.exports.murmur3=Yo,ys.exports.murmur2=Tp;var wu=z(ys.exports);class pl{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(n,o,l,p){this.ids.push(Su(n)),this.positions.push(o,l,p)}getPositions(n){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const o=Su(n);let l=0,p=this.ids.length-1;for(;l<p;){const _=l+p>>1;this.ids[_]>=o?p=_:l=_+1}const y=[];for(;this.ids[l]===o;)y.push({index:this.positions[3*l],start:this.positions[3*l+1],end:this.positions[3*l+2]}),l++;return y}static serialize(n,o){const l=new Float64Array(n.ids),p=new Uint32Array(n.positions);return Tu(l,p,0,l.length-1),o&&o.push(l.buffer,p.buffer),{ids:l,positions:p}}static deserialize(n){const o=new pl;return o.ids=n.ids,o.positions=n.positions,o.indexed=!0,o}}function Su(i){const n=+i;return!isNaN(n)&&n<=Number.MAX_SAFE_INTEGER?n:wu(String(i))}function Tu(i,n,o,l){for(;o<l;){const p=i[o+l>>1];let y=o-1,_=l+1;for(;;){do y++;while(i[y]<p);do _--;while(i[_]>p);if(y>=_)break;_s(i,y,_),_s(n,3*y,3*_),_s(n,3*y+1,3*_+1),_s(n,3*y+2,3*_+2)}_-o<l-_?(Tu(i,n,o,_),o=_+1):(Tu(i,n,_+1,l),l=_)}}function _s(i,n,o){const l=i[n];i[n]=i[o],i[o]=l}Ke("FeaturePositionMap",pl);class fl{constructor(n,o){this.gl=n.gl,this.location=o}}class Cp extends fl{constructor(n,o){super(n,o),this.current=0}set(n){this.current!==n&&(this.current=n,this.gl.uniform1f(this.location,n))}}class Zv extends fl{constructor(n,o){super(n,o),this.current=[0,0,0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]&&n[3]===this.current[3]||(this.current=n,this.gl.uniform4f(this.location,n[0],n[1],n[2],n[3]))}}class Gv extends fl{constructor(n,o){super(n,o),this.current=Wt.transparent}set(n){n.r===this.current.r&&n.g===this.current.g&&n.b===this.current.b&&n.a===this.current.a||(this.current=n,this.gl.uniform4f(this.location,n.r,n.g,n.b,n.a))}}const qC=new Float32Array(16);function Bg(i){return[Ea(255*i.r,255*i.g),Ea(255*i.b,255*i.a)]}class vh{constructor(n,o,l){this.value=n,this.uniformNames=o.map(p=>`u_${p}`),this.type=l}setUniform(n,o,l){n.set(l.constantOr(this.value))}getBinding(n,o,l){return this.type==="color"?new Gv(n,o):new Cp(n,o)}}class Cu{constructor(n,o){this.uniformNames=o.map(l=>`u_${l}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(n,o){this.pixelRatioFrom=o.pixelRatio,this.pixelRatioTo=n.pixelRatio,this.patternFrom=o.tlbr,this.patternTo=n.tlbr}setUniform(n,o,l,p){const y=p==="u_pattern_to"?this.patternTo:p==="u_pattern_from"?this.patternFrom:p==="u_pixel_ratio_to"?this.pixelRatioTo:p==="u_pixel_ratio_from"?this.pixelRatioFrom:null;y&&n.set(y)}getBinding(n,o,l){return l.substr(0,9)==="u_pattern"?new Zv(n,o):new Cp(n,o)}}class Aa{constructor(n,o,l,p){this.expression=n,this.type=l,this.maxValue=0,this.paintVertexAttributes=o.map(y=>({name:`a_${y}`,type:"Float32",components:l==="color"?2:1,offset:0})),this.paintVertexArray=new p}populatePaintArray(n,o,l,p,y){const _=this.paintVertexArray.length,b=this.expression.evaluate(new cr(0),o,{},p,[],y);this.paintVertexArray.resize(n),this._setPaintValue(_,n,b)}updatePaintArray(n,o,l,p){const y=this.expression.evaluate({zoom:0},l,p);this._setPaintValue(n,o,y)}_setPaintValue(n,o,l){if(this.type==="color"){const p=Bg(l);for(let y=n;y<o;y++)this.paintVertexArray.emplace(y,p[0],p[1])}else{for(let p=n;p<o;p++)this.paintVertexArray.emplace(p,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Do{constructor(n,o,l,p,y,_){this.expression=n,this.uniformNames=o.map(b=>`u_${b}_t`),this.type=l,this.useIntegerZoom=p,this.zoom=y,this.maxValue=0,this.paintVertexAttributes=o.map(b=>({name:`a_${b}`,type:"Float32",components:l==="color"?4:2,offset:0})),this.paintVertexArray=new _}populatePaintArray(n,o,l,p,y){const _=this.expression.evaluate(new cr(this.zoom),o,{},p,[],y),b=this.expression.evaluate(new cr(this.zoom+1),o,{},p,[],y),S=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValue(S,n,_,b)}updatePaintArray(n,o,l,p){const y=this.expression.evaluate({zoom:this.zoom},l,p),_=this.expression.evaluate({zoom:this.zoom+1},l,p);this._setPaintValue(n,o,y,_)}_setPaintValue(n,o,l,p){if(this.type==="color"){const y=Bg(l),_=Bg(p);for(let b=n;b<o;b++)this.paintVertexArray.emplace(b,y[0],y[1],_[0],_[1])}else{for(let y=n;y<o;y++)this.paintVertexArray.emplace(y,l,p);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(p))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(n,o){const l=this.useIntegerZoom?Math.floor(o.zoom):o.zoom,p=Se(this.expression.interpolationFactor(l,this.zoom,this.zoom+1),0,1);n.set(p)}getBinding(n,o,l){return new Cp(n,o)}}class vs{constructor(n,o,l,p,y,_){this.expression=n,this.type=o,this.useIntegerZoom=l,this.zoom=p,this.layerId=_,this.zoomInPaintVertexArray=new y,this.zoomOutPaintVertexArray=new y}populatePaintArray(n,o,l){const p=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(n),this.zoomOutPaintVertexArray.resize(n),this._setPaintValues(p,n,o.patterns&&o.patterns[this.layerId],l)}updatePaintArray(n,o,l,p,y){this._setPaintValues(n,o,l.patterns&&l.patterns[this.layerId],y)}_setPaintValues(n,o,l,p){if(!p||!l)return;const{min:y,mid:_,max:b}=l,S=p[y],k=p[_],I=p[b];if(S&&k&&I)for(let A=n;A<o;A++)this.zoomInPaintVertexArray.emplace(A,k.tl[0],k.tl[1],k.br[0],k.br[1],S.tl[0],S.tl[1],S.br[0],S.br[1],k.pixelRatio,S.pixelRatio),this.zoomOutPaintVertexArray.emplace(A,k.tl[0],k.tl[1],k.br[0],k.br[1],I.tl[0],I.tl[1],I.br[0],I.br[1],k.pixelRatio,I.pixelRatio)}upload(n){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=n.createVertexBuffer(this.zoomInPaintVertexArray,gs.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=n.createVertexBuffer(this.zoomOutPaintVertexArray,gs.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Hv{constructor(n,o,l){this.binders={},this._buffers=[];const p=[];for(const y in n.paint._values){if(!l(y))continue;const _=n.paint.get(y);if(!(_ instanceof co&&ts(_.property.specification)))continue;const b=ZC(y,n.type),S=_.value,k=_.property.specification.type,I=_.property.useIntegerZoom,A=_.property.specification["property-type"],L=A==="cross-faded"||A==="cross-faded-data-driven";if(S.kind==="constant")this.binders[y]=L?new Cu(S.value,b):new vh(S.value,b,k),p.push(`/u_${y}`);else if(S.kind==="source"||L){const F=Wv(y,k,"source");this.binders[y]=L?new vs(S,k,I,o,F,n.id):new Aa(S,b,k,F),p.push(`/a_${y}`)}else{const F=Wv(y,k,"composite");this.binders[y]=new Do(S,b,k,I,o,F),p.push(`/z_${y}`)}}this.cacheKey=p.sort().join("")}getMaxValue(n){const o=this.binders[n];return o instanceof Aa||o instanceof Do?o.maxValue:0}populatePaintArrays(n,o,l,p,y){for(const _ in this.binders){const b=this.binders[_];(b instanceof Aa||b instanceof Do||b instanceof vs)&&b.populatePaintArray(n,o,l,p,y)}}setConstantPatternPositions(n,o){for(const l in this.binders){const p=this.binders[l];p instanceof Cu&&p.setConstantPatternPositions(n,o)}}updatePaintArrays(n,o,l,p,y){let _=!1;for(const b in n){const S=o.getPositions(b);for(const k of S){const I=l.feature(k.index);for(const A in this.binders){const L=this.binders[A];if((L instanceof Aa||L instanceof Do||L instanceof vs)&&L.expression.isStateDependent===!0){const F=p.paint.get(A);L.expression=F.value,L.updatePaintArray(k.start,k.end,I,n[b],y),_=!0}}}}return _}defines(){const n=[];for(const o in this.binders){const l=this.binders[o];(l instanceof vh||l instanceof Cu)&&n.push(...l.uniformNames.map(p=>`#define HAS_UNIFORM_${p}`))}return n}getBinderAttributes(){const n=[];for(const o in this.binders){const l=this.binders[o];if(l instanceof Aa||l instanceof Do)for(let p=0;p<l.paintVertexAttributes.length;p++)n.push(l.paintVertexAttributes[p].name);else if(l instanceof vs)for(let p=0;p<gs.members.length;p++)n.push(gs.members[p].name)}return n}getBinderUniforms(){const n=[];for(const o in this.binders){const l=this.binders[o];if(l instanceof vh||l instanceof Cu||l instanceof Do)for(const p of l.uniformNames)n.push(p)}return n}getPaintVertexBuffers(){return this._buffers}getUniforms(n,o){const l=[];for(const p in this.binders){const y=this.binders[p];if(y instanceof vh||y instanceof Cu||y instanceof Do){for(const _ of y.uniformNames)if(o[_]){const b=y.getBinding(n,o[_],_);l.push({name:_,property:p,binding:b})}}}return l}setUniforms(n,o,l,p){for(const{name:y,property:_,binding:b}of o)this.binders[_].setUniform(b,p,l.get(_),y)}updatePaintBuffers(n){this._buffers=[];for(const o in this.binders){const l=this.binders[o];if(n&&l instanceof vs){const p=n.fromScale===2?l.zoomInPaintVertexBuffer:l.zoomOutPaintVertexBuffer;p&&this._buffers.push(p)}else(l instanceof Aa||l instanceof Do)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}}upload(n){for(const o in this.binders){const l=this.binders[o];(l instanceof Aa||l instanceof Do||l instanceof vs)&&l.upload(n)}this.updatePaintBuffers()}destroy(){for(const n in this.binders){const o=this.binders[n];(o instanceof Aa||o instanceof Do||o instanceof vs)&&o.destroy()}}}class ml{constructor(n,o,l=()=>!0){this.programConfigurations={};for(const p of n)this.programConfigurations[p.id]=new Hv(p,o,l);this.needsUpload=!1,this._featureMap=new pl,this._bufferOffset=0}populatePaintArrays(n,o,l,p,y,_){for(const b in this.programConfigurations)this.programConfigurations[b].populatePaintArrays(n,o,p,y,_);o.id!==void 0&&this._featureMap.add(o.id,l,this._bufferOffset,n),this._bufferOffset=n,this.needsUpload=!0}updatePaintArrays(n,o,l,p){for(const y of l)this.needsUpload=this.programConfigurations[y.id].updatePaintArrays(n,this._featureMap,o,y,p)||this.needsUpload}get(n){return this.programConfigurations[n]}upload(n){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(n);this.needsUpload=!1}}destroy(){for(const n in this.programConfigurations)this.programConfigurations[n].destroy()}}function ZC(i,n){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[i]||[i.replace(`${n}-`,"").replace(/-/g,"_")]}function Wv(i,n,o){const l={color:{source:V,composite:vt},number:{source:$e,composite:V}},p=function(y){return{"line-pattern":{source:_i,composite:_i},"fill-pattern":{source:_i,composite:_i},"fill-extrusion-pattern":{source:_i,composite:_i}}[y]}(i);return p&&p[o]||l[n][o]}Ke("ConstantBinder",vh),Ke("CrossFadedConstantBinder",Cu),Ke("SourceExpressionBinder",Aa),Ke("CrossFadedCompositeBinder",vs),Ke("CompositeExpressionBinder",Do),Ke("ProgramConfiguration",Hv,{omit:["_buffers"]}),Ke("ProgramConfigurationSet",ml);const $r=8192,Og=Math.pow(2,14)-1,Kv=-Og-1;function gl(i){const n=$r/i.extent,o=i.loadGeometry();for(let l=0;l<o.length;l++){const p=o[l];for(let y=0;y<p.length;y++){const _=p[y],b=Math.round(_.x*n),S=Math.round(_.y*n);_.x=Se(b,Kv,Og),_.y=Se(S,Kv,Og),(b<_.x||b>_.x+1||S<_.y||S>_.y+1)&&It("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return o}function yl(i,n){return{type:i.type,id:i.id,properties:i.properties,geometry:n?gl(i):[]}}function kp(i,n,o,l,p){i.emplaceBack(2*n+(l+1)/2,2*o+(p+1)/2)}class Ng{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(o=>o.id),this.index=n.index,this.hasPattern=!1,this.layoutVertexArray=new In,this.indexArray=new $i,this.segments=new zt,this.programConfigurations=new ml(n.layers,n.zoom),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(n,o,l){const p=this.layers[0],y=[];let _=null,b=!1;p.type==="circle"&&(_=p.layout.get("circle-sort-key"),b=!_.isConstant());for(const{feature:S,id:k,index:I,sourceLayerIndex:A}of n){const L=this.layers[0]._featureFilter.needGeometry,F=yl(S,L);if(!this.layers[0]._featureFilter.filter(new cr(this.zoom),F,l))continue;const $=b?_.evaluate(F,{},l):void 0,j={id:k,properties:S.properties,type:S.type,sourceLayerIndex:A,index:I,geometry:L?F.geometry:gl(S),patterns:{},sortKey:$};y.push(j)}b&&y.sort((S,k)=>S.sortKey-k.sortKey);for(const S of y){const{geometry:k,index:I,sourceLayerIndex:A}=S,L=n[I].feature;this.addFeature(S,k,I,l),o.featureIndex.insert(L,k,I,A,this.index)}}update(n,o,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,o,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,oi),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(n,o,l,p){for(const y of o)for(const _ of y){const b=_.x,S=_.y;if(b<0||b>=$r||S<0||S>=$r)continue;const k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,n.sortKey),I=k.vertexLength;kp(this.layoutVertexArray,b,S,-1,-1),kp(this.layoutVertexArray,b,S,1,-1),kp(this.layoutVertexArray,b,S,1,1),kp(this.layoutVertexArray,b,S,-1,1),this.indexArray.emplaceBack(I,I+1,I+2),this.indexArray.emplaceBack(I,I+3,I+2),k.vertexLength+=4,k.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,l,{},p)}}function Xv(i,n){for(let o=0;o<i.length;o++)if(ku(n,i[o]))return!0;for(let o=0;o<n.length;o++)if(ku(i,n[o]))return!0;return!!$g(i,n)}function GC(i,n,o){return!!ku(i,n)||!!Ug(n,i,o)}function Yv(i,n){if(i.length===1)return Qv(n,i[0]);for(let o=0;o<n.length;o++){const l=n[o];for(let p=0;p<l.length;p++)if(ku(i,l[p]))return!0}for(let o=0;o<i.length;o++)if(Qv(n,i[o]))return!0;for(let o=0;o<n.length;o++)if($g(i,n[o]))return!0;return!1}function HC(i,n,o){if(i.length>1){if($g(i,n))return!0;for(let l=0;l<n.length;l++)if(Ug(n[l],i,o))return!0}for(let l=0;l<i.length;l++)if(Ug(i[l],n,o))return!0;return!1}function $g(i,n){if(i.length===0||n.length===0)return!1;for(let o=0;o<i.length-1;o++){const l=i[o],p=i[o+1];for(let y=0;y<n.length-1;y++)if(WC(l,p,n[y],n[y+1]))return!0}return!1}function WC(i,n,o,l){return Bt(i,o,l)!==Bt(n,o,l)&&Bt(i,n,o)!==Bt(i,n,l)}function Ug(i,n,o){const l=o*o;if(n.length===1)return i.distSqr(n[0])<l;for(let p=1;p<n.length;p++)if(Jv(i,n[p-1],n[p])<l)return!0;return!1}function Jv(i,n,o){const l=n.distSqr(o);if(l===0)return i.distSqr(n);const p=((i.x-n.x)*(o.x-n.x)+(i.y-n.y)*(o.y-n.y))/l;return i.distSqr(p<0?n:p>1?o:o.sub(n)._mult(p)._add(n))}function Qv(i,n){let o,l,p,y=!1;for(let _=0;_<i.length;_++){o=i[_];for(let b=0,S=o.length-1;b<o.length;S=b++)l=o[b],p=o[S],l.y>n.y!=p.y>n.y&&n.x<(p.x-l.x)*(n.y-l.y)/(p.y-l.y)+l.x&&(y=!y)}return y}function ku(i,n){let o=!1;for(let l=0,p=i.length-1;l<i.length;p=l++){const y=i[l],_=i[p];y.y>n.y!=_.y>n.y&&n.x<(_.x-y.x)*(n.y-y.y)/(_.y-y.y)+y.x&&(o=!o)}return o}function KC(i,n,o){const l=o[0],p=o[2];if(i.x<l.x&&n.x<l.x||i.x>p.x&&n.x>p.x||i.y<l.y&&n.y<l.y||i.y>p.y&&n.y>p.y)return!1;const y=Bt(i,n,o[0]);return y!==Bt(i,n,o[1])||y!==Bt(i,n,o[2])||y!==Bt(i,n,o[3])}function xh(i,n,o){const l=n.paint.get(i).value;return l.kind==="constant"?l.value:o.programConfigurations.get(n.id).getMaxValue(i)}function Ip(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function Ep(i,n,o,l,p){if(!n[0]&&!n[1])return i;const y=U.convert(n)._mult(p);o==="viewport"&&y._rotate(-l);const _=[];for(let b=0;b<i.length;b++)_.push(i[b].sub(y));return _}let e1,t1;Ke("CircleBucket",Ng,{omit:["layers"]});var XC={get paint(){return t1=t1||new g({"circle-radius":new ut(xe.paint_circle["circle-radius"]),"circle-color":new ut(xe.paint_circle["circle-color"]),"circle-blur":new ut(xe.paint_circle["circle-blur"]),"circle-opacity":new ut(xe.paint_circle["circle-opacity"]),"circle-translate":new Ye(xe.paint_circle["circle-translate"]),"circle-translate-anchor":new Ye(xe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ye(xe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ye(xe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ut(xe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ut(xe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ut(xe.paint_circle["circle-stroke-opacity"])})},get layout(){return e1=e1||new g({"circle-sort-key":new ut(xe.layout_circle["circle-sort-key"])})}},jn=1e-6,Iu=typeof Float32Array<"u"?Float32Array:Array;function jg(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function r1(i,n,o){var l=n[0],p=n[1],y=n[2],_=n[3],b=n[4],S=n[5],k=n[6],I=n[7],A=n[8],L=n[9],F=n[10],$=n[11],j=n[12],K=n[13],Q=n[14],ge=n[15],se=o[0],fe=o[1],be=o[2],Pe=o[3];return i[0]=se*l+fe*b+be*A+Pe*j,i[1]=se*p+fe*S+be*L+Pe*K,i[2]=se*y+fe*k+be*F+Pe*Q,i[3]=se*_+fe*I+be*$+Pe*ge,i[4]=(se=o[4])*l+(fe=o[5])*b+(be=o[6])*A+(Pe=o[7])*j,i[5]=se*p+fe*S+be*L+Pe*K,i[6]=se*y+fe*k+be*F+Pe*Q,i[7]=se*_+fe*I+be*$+Pe*ge,i[8]=(se=o[8])*l+(fe=o[9])*b+(be=o[10])*A+(Pe=o[11])*j,i[9]=se*p+fe*S+be*L+Pe*K,i[10]=se*y+fe*k+be*F+Pe*Q,i[11]=se*_+fe*I+be*$+Pe*ge,i[12]=(se=o[12])*l+(fe=o[13])*b+(be=o[14])*A+(Pe=o[15])*j,i[13]=se*p+fe*S+be*L+Pe*K,i[14]=se*y+fe*k+be*F+Pe*Q,i[15]=se*_+fe*I+be*$+Pe*ge,i}Math.hypot||(Math.hypot=function(){for(var i=0,n=arguments.length;n--;)i+=arguments[n]*arguments[n];return Math.sqrt(i)});var bh,YC=r1;function Ap(i,n,o){var l=n[0],p=n[1],y=n[2],_=n[3];return i[0]=o[0]*l+o[4]*p+o[8]*y+o[12]*_,i[1]=o[1]*l+o[5]*p+o[9]*y+o[13]*_,i[2]=o[2]*l+o[6]*p+o[10]*y+o[14]*_,i[3]=o[3]*l+o[7]*p+o[11]*y+o[15]*_,i}bh=new Iu(4),Iu!=Float32Array&&(bh[0]=0,bh[1]=0,bh[2]=0,bh[3]=0);class JC extends s{constructor(n){super(n,XC)}createBucket(n){return new Ng(n)}queryRadius(n){const o=n;return xh("circle-radius",this,o)+xh("circle-stroke-width",this,o)+Ip(this.paint.get("circle-translate"))}queryIntersectsFeature(n,o,l,p,y,_,b,S){const k=Ep(n,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),_.angle,b),I=this.paint.get("circle-radius").evaluate(o,l)+this.paint.get("circle-stroke-width").evaluate(o,l),A=this.paint.get("circle-pitch-alignment")==="map",L=A?k:function($,j){return $.map(K=>n1(K,j))}(k,S),F=A?I*b:I;for(const $ of p)for(const j of $){const K=A?j:n1(j,S);let Q=F;const ge=Ap([],[j.x,j.y,0,1],S);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Q*=ge[3]/_.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Q*=_.cameraToCenterDistance/ge[3]),GC(L,K,Q))return!0}return!1}}function n1(i,n){const o=Ap([],[i.x,i.y,0,1],n);return new U(o[0]/o[3],o[1]/o[3])}class i1 extends Ng{}let o1;Ke("HeatmapBucket",i1,{omit:["layers"]});var QC={get paint(){return o1=o1||new g({"heatmap-radius":new ut(xe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ut(xe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ye(xe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new yh(xe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ye(xe.paint_heatmap["heatmap-opacity"])})}};function Vg(i,{width:n,height:o},l,p){if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==n*o*l)throw new RangeError(`mismatched image size. expected: ${p.length} but got: ${n*o*l}`)}else p=new Uint8Array(n*o*l);return i.width=n,i.height=o,i.data=p,i}function a1(i,{width:n,height:o},l){if(n===i.width&&o===i.height)return;const p=Vg({},{width:n,height:o},l);qg(i,p,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,n),height:Math.min(i.height,o)},l),i.width=n,i.height=o,i.data=p.data}function qg(i,n,o,l,p,y){if(p.width===0||p.height===0)return n;if(p.width>i.width||p.height>i.height||o.x>i.width-p.width||o.y>i.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>n.width||p.height>n.height||l.x>n.width-p.width||l.y>n.height-p.height)throw new RangeError("out of range destination coordinates for image copy");const _=i.data,b=n.data;if(_===b)throw new Error("srcData equals dstData, so image is already copied");for(let S=0;S<p.height;S++){const k=((o.y+S)*i.width+o.x)*y,I=((l.y+S)*n.width+l.x)*y;for(let A=0;A<p.width*y;A++)b[I+A]=_[k+A]}return n}class wh{constructor(n,o){Vg(this,n,1,o)}resize(n){a1(this,n,1)}clone(){return new wh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,o,l,p,y){qg(n,o,l,p,y,1)}}class Ui{constructor(n,o){Vg(this,n,4,o)}resize(n){a1(this,n,4)}replace(n,o){o?this.data.set(n):this.data=n instanceof Uint8ClampedArray?new Uint8Array(n.buffer):n}clone(){return new Ui({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,o,l,p,y){qg(n,o,l,p,y,4)}}function s1(i){const n={},o=i.resolution||256,l=i.clips?i.clips.length:1,p=i.image||new Ui({width:o,height:l});if(Math.log(o)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${o}`);const y=(_,b,S)=>{n[i.evaluationKey]=S;const k=i.expression.evaluate(n);p.data[_+b+0]=Math.floor(255*k.r/k.a),p.data[_+b+1]=Math.floor(255*k.g/k.a),p.data[_+b+2]=Math.floor(255*k.b/k.a),p.data[_+b+3]=Math.floor(255*k.a)};if(i.clips)for(let _=0,b=0;_<l;++_,b+=4*o)for(let S=0,k=0;S<o;S++,k+=4){const I=S/(o-1),{start:A,end:L}=i.clips[_];y(b,k,A*(1-I)+L*I)}else for(let _=0,b=0;_<o;_++,b+=4)y(0,b,_/(o-1));return p}Ke("AlphaImage",wh),Ke("RGBAImage",Ui);const Zg="big-fb";class ek extends s{createBucket(n){return new i1(n)}constructor(n){super(n,QC),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(n){n==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=s1({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Zg)&&this.heatmapFbos.delete(Zg)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let l1;var tk={get paint(){return l1=l1||new g({"hillshade-illumination-direction":new Ye(xe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ye(xe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ye(xe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ye(xe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ye(xe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ye(xe.paint_hillshade["hillshade-accent-color"])})}};class rk extends s{constructor(n){super(n,tk)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const nk=w([{name:"a_pos",components:2,type:"Int16"}],4),{members:ik}=nk;function u1(i,n,o=2){const l=n&&n.length,p=l?n[0]*o:i.length;let y=c1(i,0,p,o,!0);const _=[];if(!y||y.next===y.prev)return _;let b,S,k;if(l&&(y=function(I,A,L,F){const $=[];for(let j=0,K=A.length;j<K;j++){const Q=c1(I,A[j]*F,j<K-1?A[j+1]*F:I.length,F,!1);Q===Q.next&&(Q.steiner=!0),$.push(dk(Q))}$.sort(uk);for(let j=0;j<$.length;j++)L=ck($[j],L);return L}(i,n,y,o)),i.length>80*o){b=1/0,S=1/0;let I=-1/0,A=-1/0;for(let L=o;L<p;L+=o){const F=i[L],$=i[L+1];F<b&&(b=F),$<S&&(S=$),F>I&&(I=F),$>A&&(A=$)}k=Math.max(I-b,A-S),k=k!==0?32767/k:0}return Sh(y,_,o,b,S,k,0),_}function c1(i,n,o,l,p){let y;if(p===function(_,b,S,k){let I=0;for(let A=b,L=S-k;A<S;A+=k)I+=(_[L]-_[A])*(_[A+1]+_[L+1]),L=A;return I}(i,n,o,l)>0)for(let _=n;_<o;_+=l)y=p1(_/l|0,i[_],i[_+1],y);else for(let _=o-l;_>=n;_-=l)y=p1(_/l|0,i[_],i[_+1],y);return y&&Pp(y,y.next)&&(Ch(y),y=y.next),y}function _l(i,n){if(!i)return i;n||(n=i);let o,l=i;do if(o=!1,l.steiner||!Pp(l,l.next)&&zr(l.prev,l,l.next)!==0)l=l.next;else{if(Ch(l),l=n=l.prev,l===l.next)break;o=!0}while(o||l!==n);return n}function Sh(i,n,o,l,p,y,_){if(!i)return;!_&&y&&function(S,k,I,A){let L=S;do L.z===0&&(L.z=Gg(L.x,L.y,k,I,A)),L.prevZ=L.prev,L.nextZ=L.next,L=L.next;while(L!==S);L.prevZ.nextZ=null,L.prevZ=null,function(F){let $,j=1;do{let K,Q=F;F=null;let ge=null;for($=0;Q;){$++;let se=Q,fe=0;for(let Pe=0;Pe<j&&(fe++,se=se.nextZ,se);Pe++);let be=j;for(;fe>0||be>0&&se;)fe!==0&&(be===0||!se||Q.z<=se.z)?(K=Q,Q=Q.nextZ,fe--):(K=se,se=se.nextZ,be--),ge?ge.nextZ=K:F=K,K.prevZ=ge,ge=K;Q=se}ge.nextZ=null,j*=2}while($>1)}(L)}(i,l,p,y);let b=i;for(;i.prev!==i.next;){const S=i.prev,k=i.next;if(y?ak(i,l,p,y):ok(i))n.push(S.i,i.i,k.i),Ch(i),i=k.next,b=k.next;else if((i=k)===b){_?_===1?Sh(i=sk(_l(i),n),n,o,l,p,y,2):_===2&&lk(i,n,o,l,p,y):Sh(_l(i),n,o,l,p,y,1);break}}}function ok(i){const n=i.prev,o=i,l=i.next;if(zr(n,o,l)>=0)return!1;const p=n.x,y=o.x,_=l.x,b=n.y,S=o.y,k=l.y,I=p<y?p<_?p:_:y<_?y:_,A=b<S?b<k?b:k:S<k?S:k,L=p>y?p>_?p:_:y>_?y:_,F=b>S?b>k?b:k:S>k?S:k;let $=l.next;for(;$!==n;){if($.x>=I&&$.x<=L&&$.y>=A&&$.y<=F&&Eu(p,b,y,S,_,k,$.x,$.y)&&zr($.prev,$,$.next)>=0)return!1;$=$.next}return!0}function ak(i,n,o,l){const p=i.prev,y=i,_=i.next;if(zr(p,y,_)>=0)return!1;const b=p.x,S=y.x,k=_.x,I=p.y,A=y.y,L=_.y,F=b<S?b<k?b:k:S<k?S:k,$=I<A?I<L?I:L:A<L?A:L,j=b>S?b>k?b:k:S>k?S:k,K=I>A?I>L?I:L:A>L?A:L,Q=Gg(F,$,n,o,l),ge=Gg(j,K,n,o,l);let se=i.prevZ,fe=i.nextZ;for(;se&&se.z>=Q&&fe&&fe.z<=ge;){if(se.x>=F&&se.x<=j&&se.y>=$&&se.y<=K&&se!==p&&se!==_&&Eu(b,I,S,A,k,L,se.x,se.y)&&zr(se.prev,se,se.next)>=0||(se=se.prevZ,fe.x>=F&&fe.x<=j&&fe.y>=$&&fe.y<=K&&fe!==p&&fe!==_&&Eu(b,I,S,A,k,L,fe.x,fe.y)&&zr(fe.prev,fe,fe.next)>=0))return!1;fe=fe.nextZ}for(;se&&se.z>=Q;){if(se.x>=F&&se.x<=j&&se.y>=$&&se.y<=K&&se!==p&&se!==_&&Eu(b,I,S,A,k,L,se.x,se.y)&&zr(se.prev,se,se.next)>=0)return!1;se=se.prevZ}for(;fe&&fe.z<=ge;){if(fe.x>=F&&fe.x<=j&&fe.y>=$&&fe.y<=K&&fe!==p&&fe!==_&&Eu(b,I,S,A,k,L,fe.x,fe.y)&&zr(fe.prev,fe,fe.next)>=0)return!1;fe=fe.nextZ}return!0}function sk(i,n){let o=i;do{const l=o.prev,p=o.next.next;!Pp(l,p)&&h1(l,o,o.next,p)&&Th(l,p)&&Th(p,l)&&(n.push(l.i,o.i,p.i),Ch(o),Ch(o.next),o=i=p),o=o.next}while(o!==i);return _l(o)}function lk(i,n,o,l,p,y){let _=i;do{let b=_.next.next;for(;b!==_.prev;){if(_.i!==b.i&&pk(_,b)){let S=d1(_,b);return _=_l(_,_.next),S=_l(S,S.next),Sh(_,n,o,l,p,y,0),void Sh(S,n,o,l,p,y,0)}b=b.next}_=_.next}while(_!==i)}function uk(i,n){return i.x-n.x}function ck(i,n){const o=function(p,y){let _=y;const b=p.x,S=p.y;let k,I=-1/0;do{if(S<=_.y&&S>=_.next.y&&_.next.y!==_.y){const j=_.x+(S-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(j<=b&&j>I&&(I=j,k=_.x<_.next.x?_:_.next,j===b))return k}_=_.next}while(_!==y);if(!k)return null;const A=k,L=k.x,F=k.y;let $=1/0;_=k;do{if(b>=_.x&&_.x>=L&&b!==_.x&&Eu(S<F?b:I,S,L,F,S<F?I:b,S,_.x,_.y)){const j=Math.abs(S-_.y)/(b-_.x);Th(_,p)&&(j<$||j===$&&(_.x>k.x||_.x===k.x&&hk(k,_)))&&(k=_,$=j)}_=_.next}while(_!==A);return k}(i,n);if(!o)return n;const l=d1(o,i);return _l(l,l.next),_l(o,o.next)}function hk(i,n){return zr(i.prev,i,n.prev)<0&&zr(n.next,i,i.next)<0}function Gg(i,n,o,l,p){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-o)*p|0)|i<<8))|i<<4))|i<<2))|i<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-l)*p|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function dk(i){let n=i,o=i;do(n.x<o.x||n.x===o.x&&n.y<o.y)&&(o=n),n=n.next;while(n!==i);return o}function Eu(i,n,o,l,p,y,_,b){return(p-_)*(n-b)>=(i-_)*(y-b)&&(i-_)*(l-b)>=(o-_)*(n-b)&&(o-_)*(y-b)>=(p-_)*(l-b)}function pk(i,n){return i.next.i!==n.i&&i.prev.i!==n.i&&!function(o,l){let p=o;do{if(p.i!==o.i&&p.next.i!==o.i&&p.i!==l.i&&p.next.i!==l.i&&h1(p,p.next,o,l))return!0;p=p.next}while(p!==o);return!1}(i,n)&&(Th(i,n)&&Th(n,i)&&function(o,l){let p=o,y=!1;const _=(o.x+l.x)/2,b=(o.y+l.y)/2;do p.y>b!=p.next.y>b&&p.next.y!==p.y&&_<(p.next.x-p.x)*(b-p.y)/(p.next.y-p.y)+p.x&&(y=!y),p=p.next;while(p!==o);return y}(i,n)&&(zr(i.prev,i,n.prev)||zr(i,n.prev,n))||Pp(i,n)&&zr(i.prev,i,i.next)>0&&zr(n.prev,n,n.next)>0)}function zr(i,n,o){return(n.y-i.y)*(o.x-n.x)-(n.x-i.x)*(o.y-n.y)}function Pp(i,n){return i.x===n.x&&i.y===n.y}function h1(i,n,o,l){const p=zp(zr(i,n,o)),y=zp(zr(i,n,l)),_=zp(zr(o,l,i)),b=zp(zr(o,l,n));return p!==y&&_!==b||!(p!==0||!Mp(i,o,n))||!(y!==0||!Mp(i,l,n))||!(_!==0||!Mp(o,i,l))||!(b!==0||!Mp(o,n,l))}function Mp(i,n,o){return n.x<=Math.max(i.x,o.x)&&n.x>=Math.min(i.x,o.x)&&n.y<=Math.max(i.y,o.y)&&n.y>=Math.min(i.y,o.y)}function zp(i){return i>0?1:i<0?-1:0}function Th(i,n){return zr(i.prev,i,i.next)<0?zr(i,n,i.next)>=0&&zr(i,i.prev,n)>=0:zr(i,n,i.prev)<0||zr(i,i.next,n)<0}function d1(i,n){const o=Hg(i.i,i.x,i.y),l=Hg(n.i,n.x,n.y),p=i.next,y=n.prev;return i.next=n,n.prev=i,o.next=p,p.prev=o,l.next=o,o.prev=l,y.next=l,l.prev=y,l}function p1(i,n,o,l){const p=Hg(i,n,o);return l?(p.next=l.next,p.prev=l,l.next.prev=p,l.next=p):(p.prev=p,p.next=p),p}function Ch(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function Hg(i,n,o){return{i,x:n,y:o,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Wg(i,n,o){const l=o.patternDependencies;let p=!1;for(const y of n){const _=y.paint.get(`${i}-pattern`);_.isConstant()||(p=!0);const b=_.constantOr(null);b&&(p=!0,l[b.to]=!0,l[b.from]=!0)}return p}function Kg(i,n,o,l,p){const y=p.patternDependencies;for(const _ of n){const b=_.paint.get(`${i}-pattern`).value;if(b.kind!=="constant"){let S=b.evaluate({zoom:l-1},o,{},p.availableImages),k=b.evaluate({zoom:l},o,{},p.availableImages),I=b.evaluate({zoom:l+1},o,{},p.availableImages);S=S&&S.name?S.name:S,k=k&&k.name?k.name:k,I=I&&I.name?I.name:I,y[S]=!0,y[k]=!0,y[I]=!0,o.patterns[_.id]={min:S,mid:k,max:I}}}return o}class Xg{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(o=>o.id),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ho,this.indexArray=new $i,this.indexArray2=new ln,this.programConfigurations=new ml(n.layers,n.zoom),this.segments=new zt,this.segments2=new zt,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(n,o,l){this.hasPattern=Wg("fill",this.layers,o);const p=this.layers[0].layout.get("fill-sort-key"),y=!p.isConstant(),_=[];for(const{feature:b,id:S,index:k,sourceLayerIndex:I}of n){const A=this.layers[0]._featureFilter.needGeometry,L=yl(b,A);if(!this.layers[0]._featureFilter.filter(new cr(this.zoom),L,l))continue;const F=y?p.evaluate(L,{},l,o.availableImages):void 0,$={id:S,properties:b.properties,type:b.type,sourceLayerIndex:I,index:k,geometry:A?L.geometry:gl(b),patterns:{},sortKey:F};_.push($)}y&&_.sort((b,S)=>b.sortKey-S.sortKey);for(const b of _){const{geometry:S,index:k,sourceLayerIndex:I}=b;if(this.hasPattern){const A=Kg("fill",this.layers,b,this.zoom,o);this.patternFeatures.push(A)}else this.addFeature(b,S,k,l,{});o.featureIndex.insert(n[k].feature,S,k,I,this.index)}}update(n,o,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,o,this.stateDependentLayers,l)}addFeatures(n,o,l){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,o,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,ik),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.indexBuffer2=n.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(n,o,l,p,y){for(const _ of Jl(o,500)){let b=0;for(const F of _)b+=F.length;const S=this.segments.prepareSegment(b,this.layoutVertexArray,this.indexArray),k=S.vertexLength,I=[],A=[];for(const F of _){if(F.length===0)continue;F!==_[0]&&A.push(I.length/2);const $=this.segments2.prepareSegment(F.length,this.layoutVertexArray,this.indexArray2),j=$.vertexLength;this.layoutVertexArray.emplaceBack(F[0].x,F[0].y),this.indexArray2.emplaceBack(j+F.length-1,j),I.push(F[0].x),I.push(F[0].y);for(let K=1;K<F.length;K++)this.layoutVertexArray.emplaceBack(F[K].x,F[K].y),this.indexArray2.emplaceBack(j+K-1,j+K),I.push(F[K].x),I.push(F[K].y);$.vertexLength+=F.length,$.primitiveLength+=F.length}const L=u1(I,A);for(let F=0;F<L.length;F+=3)this.indexArray.emplaceBack(k+L[F],k+L[F+1],k+L[F+2]);S.vertexLength+=b,S.primitiveLength+=L.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,l,y,p)}}let f1,m1;Ke("FillBucket",Xg,{omit:["layers","patternFeatures"]});var fk={get paint(){return m1=m1||new g({"fill-antialias":new Ye(xe.paint_fill["fill-antialias"]),"fill-opacity":new ut(xe.paint_fill["fill-opacity"]),"fill-color":new ut(xe.paint_fill["fill-color"]),"fill-outline-color":new ut(xe.paint_fill["fill-outline-color"]),"fill-translate":new Ye(xe.paint_fill["fill-translate"]),"fill-translate-anchor":new Ye(xe.paint_fill["fill-translate-anchor"]),"fill-pattern":new _u(xe.paint_fill["fill-pattern"])})},get layout(){return f1=f1||new g({"fill-sort-key":new ut(xe.layout_fill["fill-sort-key"])})}};class mk extends s{constructor(n){super(n,fk)}recalculate(n,o){super.recalculate(n,o);const l=this.paint._values["fill-outline-color"];l.value.kind==="constant"&&l.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(n){return new Xg(n)}queryRadius(){return Ip(this.paint.get("fill-translate"))}queryIntersectsFeature(n,o,l,p,y,_,b){return Yv(Ep(n,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),_.angle,b),p)}isTileClipped(){return!0}}const gk=w([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),yk=w([{name:"a_centroid",components:2,type:"Int16"}],4),{members:_k}=gk;var xs={},vk=B,g1=Au;function Au(i,n,o,l,p){this.properties={},this.extent=o,this.type=0,this._pbf=i,this._geometry=-1,this._keys=l,this._values=p,i.readFields(xk,this,n)}function xk(i,n,o){i==1?n.id=o.readVarint():i==2?function(l,p){for(var y=l.readVarint()+l.pos;l.pos<y;){var _=p._keys[l.readVarint()],b=p._values[l.readVarint()];p.properties[_]=b}}(o,n):i==3?n.type=o.readVarint():i==4&&(n._geometry=o.pos)}function bk(i){for(var n,o,l=0,p=0,y=i.length,_=y-1;p<y;_=p++)l+=((o=i[_]).x-(n=i[p]).x)*(n.y+o.y);return l}Au.types=["Unknown","Point","LineString","Polygon"],Au.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var n,o=i.readVarint()+i.pos,l=1,p=0,y=0,_=0,b=[];i.pos<o;){if(p<=0){var S=i.readVarint();l=7&S,p=S>>3}if(p--,l===1||l===2)y+=i.readSVarint(),_+=i.readSVarint(),l===1&&(n&&b.push(n),n=[]),n.push(new vk(y,_));else{if(l!==7)throw new Error("unknown command "+l);n&&n.push(n[0].clone())}}return n&&b.push(n),b},Au.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var n=i.readVarint()+i.pos,o=1,l=0,p=0,y=0,_=1/0,b=-1/0,S=1/0,k=-1/0;i.pos<n;){if(l<=0){var I=i.readVarint();o=7&I,l=I>>3}if(l--,o===1||o===2)(p+=i.readSVarint())<_&&(_=p),p>b&&(b=p),(y+=i.readSVarint())<S&&(S=y),y>k&&(k=y);else if(o!==7)throw new Error("unknown command "+o)}return[_,S,b,k]},Au.prototype.toGeoJSON=function(i,n,o){var l,p,y=this.extent*Math.pow(2,o),_=this.extent*i,b=this.extent*n,S=this.loadGeometry(),k=Au.types[this.type];function I(F){for(var $=0;$<F.length;$++){var j=F[$];F[$]=[360*(j.x+_)/y-180,360/Math.PI*Math.atan(Math.exp((180-360*(j.y+b)/y)*Math.PI/180))-90]}}switch(this.type){case 1:var A=[];for(l=0;l<S.length;l++)A[l]=S[l][0];I(S=A);break;case 2:for(l=0;l<S.length;l++)I(S[l]);break;case 3:for(S=function(F){var $=F.length;if($<=1)return[F];for(var j,K,Q=[],ge=0;ge<$;ge++){var se=bk(F[ge]);se!==0&&(K===void 0&&(K=se<0),K===se<0?(j&&Q.push(j),j=[F[ge]]):j.push(F[ge]))}return j&&Q.push(j),Q}(S),l=0;l<S.length;l++)for(p=0;p<S[l].length;p++)I(S[l][p])}S.length===1?S=S[0]:k="Multi"+k;var L={type:"Feature",geometry:{type:k,coordinates:S},properties:this.properties};return"id"in this&&(L.id=this.id),L};var wk=g1,y1=_1;function _1(i,n){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(Sk,this,n),this.length=this._features.length}function Sk(i,n,o){i===15?n.version=o.readVarint():i===1?n.name=o.readString():i===5?n.extent=o.readVarint():i===2?n._features.push(o.pos):i===3?n._keys.push(o.readString()):i===4&&n._values.push(function(l){for(var p=null,y=l.readVarint()+l.pos;l.pos<y;){var _=l.readVarint()>>3;p=_===1?l.readString():_===2?l.readFloat():_===3?l.readDouble():_===4?l.readVarint64():_===5?l.readVarint():_===6?l.readSVarint():_===7?l.readBoolean():null}return p}(o))}_1.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var n=this._pbf.readVarint()+this._pbf.pos;return new wk(this._pbf,n,this.extent,this._keys,this._values)};var Tk=y1;function Ck(i,n,o){if(i===3){var l=new Tk(o,o.readVarint()+o.pos);l.length&&(n[l.name]=l)}}xs.VectorTile=function(i,n){this.layers=i.readFields(Ck,{},n)},xs.VectorTileFeature=g1,xs.VectorTileLayer=y1;const kk=xs.VectorTileFeature.types,Yg=Math.pow(2,13);function kh(i,n,o,l,p,y,_,b){i.emplaceBack(n,o,2*Math.floor(l*Yg)+_,p*Yg*2,y*Yg*2,Math.round(b))}class Jg{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(o=>o.id),this.index=n.index,this.hasPattern=!1,this.layoutVertexArray=new fs,this.centroidVertexArray=new fn,this.indexArray=new $i,this.programConfigurations=new ml(n.layers,n.zoom),this.segments=new zt,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(n,o,l){this.features=[],this.hasPattern=Wg("fill-extrusion",this.layers,o);for(const{feature:p,id:y,index:_,sourceLayerIndex:b}of n){const S=this.layers[0]._featureFilter.needGeometry,k=yl(p,S);if(!this.layers[0]._featureFilter.filter(new cr(this.zoom),k,l))continue;const I={id:y,sourceLayerIndex:b,index:_,geometry:S?k.geometry:gl(p),properties:p.properties,type:p.type,patterns:{}};this.hasPattern?this.features.push(Kg("fill-extrusion",this.layers,I,this.zoom,o)):this.addFeature(I,I.geometry,_,l,{}),o.featureIndex.insert(p,I.geometry,_,b,this.index,!0)}}addFeatures(n,o,l){for(const p of this.features){const{geometry:y}=p;this.addFeature(p,y,p.index,o,l)}}update(n,o,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,o,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,_k),this.centroidVertexBuffer=n.createVertexBuffer(this.centroidVertexArray,yk.members,!0),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(n,o,l,p,y){for(const _ of Jl(o,500)){const b={x:0,y:0,vertexCount:0};let S=0;for(const $ of _)S+=$.length;let k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const $ of _){if($.length===0||Ek($))continue;let j=0;for(let K=0;K<$.length;K++){const Q=$[K];if(K>=1){const ge=$[K-1];if(!Ik(Q,ge)){k.vertexLength+4>zt.MAX_VERTEX_ARRAY_LENGTH&&(k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const se=Q.sub(ge)._perp()._unit(),fe=ge.dist(Q);j+fe>32768&&(j=0),kh(this.layoutVertexArray,Q.x,Q.y,se.x,se.y,0,0,j),kh(this.layoutVertexArray,Q.x,Q.y,se.x,se.y,0,1,j),b.x+=2*Q.x,b.y+=2*Q.y,b.vertexCount+=2,j+=fe,kh(this.layoutVertexArray,ge.x,ge.y,se.x,se.y,0,0,j),kh(this.layoutVertexArray,ge.x,ge.y,se.x,se.y,0,1,j),b.x+=2*ge.x,b.y+=2*ge.y,b.vertexCount+=2;const be=k.vertexLength;this.indexArray.emplaceBack(be,be+2,be+1),this.indexArray.emplaceBack(be+1,be+2,be+3),k.vertexLength+=4,k.primitiveLength+=2}}}}if(k.vertexLength+S>zt.MAX_VERTEX_ARRAY_LENGTH&&(k=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray)),kk[n.type]!=="Polygon")continue;const I=[],A=[],L=k.vertexLength;for(const $ of _)if($.length!==0){$!==_[0]&&A.push(I.length/2);for(let j=0;j<$.length;j++){const K=$[j];kh(this.layoutVertexArray,K.x,K.y,0,0,1,1,0),b.x+=K.x,b.y+=K.y,b.vertexCount+=1,I.push(K.x),I.push(K.y)}}const F=u1(I,A);for(let $=0;$<F.length;$+=3)this.indexArray.emplaceBack(L+F[$],L+F[$+2],L+F[$+1]);k.primitiveLength+=F.length/3,k.vertexLength+=S;for(let $=0;$<b.vertexCount;$++){const j=Math.floor(b.x/b.vertexCount),K=Math.floor(b.y/b.vertexCount);this.centroidVertexArray.emplaceBack(j,K)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,l,y,p)}}function Ik(i,n){return i.x===n.x&&(i.x<0||i.x>$r)||i.y===n.y&&(i.y<0||i.y>$r)}function Ek(i){return i.every(n=>n.x<0)||i.every(n=>n.x>$r)||i.every(n=>n.y<0)||i.every(n=>n.y>$r)}let v1;Ke("FillExtrusionBucket",Jg,{omit:["layers","features"]});var Ak={get paint(){return v1=v1||new g({"fill-extrusion-opacity":new Ye(xe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ut(xe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ye(xe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ye(xe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new _u(xe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ut(xe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ut(xe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ye(xe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Pk extends s{constructor(n){super(n,Ak)}createBucket(n){return new Jg(n)}queryRadius(){return Ip(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(n,o,l,p,y,_,b,S){const k=Ep(n,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),_.angle,b),I=this.paint.get("fill-extrusion-height").evaluate(o,l),A=this.paint.get("fill-extrusion-base").evaluate(o,l),L=function($,j,K,Q){const ge=[];for(const se of $){const fe=[se.x,se.y,0,1];Ap(fe,fe,j),ge.push(new U(fe[0]/fe[3],fe[1]/fe[3]))}return ge}(k,S),F=function($,j,K,Q){const ge=[],se=[],fe=Q[8]*j,be=Q[9]*j,Pe=Q[10]*j,qe=Q[11]*j,st=Q[8]*K,Ue=Q[9]*K,Ne=Q[10]*K,et=Q[11]*K;for(const Xe of $){const We=[],Te=[];for(const rt of Xe){const Qe=rt.x,ft=rt.y,tr=Q[0]*Qe+Q[4]*ft+Q[12],Jt=Q[1]*Qe+Q[5]*ft+Q[13],Qr=Q[2]*Qe+Q[6]*ft+Q[14],po=Q[3]*Qe+Q[7]*ft+Q[15],yn=Qr+Pe,en=po+qe,Vn=tr+st,qn=Jt+Ue,Zn=Qr+Ne,Ir=po+et,tn=new U((tr+fe)/en,(Jt+be)/en);tn.z=yn/en,We.push(tn);const En=new U(Vn/Ir,qn/Ir);En.z=Zn/Ir,Te.push(En)}ge.push(We),se.push(Te)}return[ge,se]}(p,A,I,S);return function($,j,K){let Q=1/0;Yv(K,j)&&(Q=x1(K,j[0]));for(let ge=0;ge<j.length;ge++){const se=j[ge],fe=$[ge];for(let be=0;be<se.length-1;be++){const Pe=se[be],qe=[Pe,se[be+1],fe[be+1],fe[be],Pe];Xv(K,qe)&&(Q=Math.min(Q,x1(K,qe)))}}return Q!==1/0&&Q}(F[0],F[1],L)}}function Ih(i,n){return i.x*n.x+i.y*n.y}function x1(i,n){if(i.length===1){let o=0;const l=n[o++];let p;for(;!p||l.equals(p);)if(p=n[o++],!p)return 1/0;for(;o<n.length;o++){const y=n[o],_=i[0],b=p.sub(l),S=y.sub(l),k=_.sub(l),I=Ih(b,b),A=Ih(b,S),L=Ih(S,S),F=Ih(k,b),$=Ih(k,S),j=I*L-A*A,K=(L*F-A*$)/j,Q=(I*$-A*F)/j,ge=l.z*(1-K-Q)+p.z*K+y.z*Q;if(isFinite(ge))return ge}return 1/0}{let o=1/0;for(const l of n)o=Math.min(o,l.z);return o}}const Mk=w([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:zk}=Mk,Lk=w([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Rk}=Lk,Dk=xs.VectorTileFeature.types,Fk=Math.cos(Math.PI/180*37.5),b1=Math.pow(2,14)/.5;class Qg{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(o=>o.id),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new xu,this.layoutVertexArray2=new ms,this.indexArray=new $i,this.programConfigurations=new ml(n.layers,n.zoom),this.segments=new zt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(n,o,l){this.hasPattern=Wg("line",this.layers,o);const p=this.layers[0].layout.get("line-sort-key"),y=!p.isConstant(),_=[];for(const{feature:b,id:S,index:k,sourceLayerIndex:I}of n){const A=this.layers[0]._featureFilter.needGeometry,L=yl(b,A);if(!this.layers[0]._featureFilter.filter(new cr(this.zoom),L,l))continue;const F=y?p.evaluate(L,{},l):void 0,$={id:S,properties:b.properties,type:b.type,sourceLayerIndex:I,index:k,geometry:A?L.geometry:gl(b),patterns:{},sortKey:F};_.push($)}y&&_.sort((b,S)=>b.sortKey-S.sortKey);for(const b of _){const{geometry:S,index:k,sourceLayerIndex:I}=b;if(this.hasPattern){const A=Kg("line",this.layers,b,this.zoom,o);this.patternFeatures.push(A)}else this.addFeature(b,S,k,l,{});o.featureIndex.insert(n[k].feature,S,k,I,this.index)}}update(n,o,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,o,this.stateDependentLayers,l)}addFeatures(n,o,l){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,o,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=n.createVertexBuffer(this.layoutVertexArray2,Rk)),this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,zk),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(n){if(n.properties&&Object.prototype.hasOwnProperty.call(n.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(n.properties,"mapbox_clip_end"))return{start:+n.properties.mapbox_clip_start,end:+n.properties.mapbox_clip_end}}addFeature(n,o,l,p,y){const _=this.layers[0].layout,b=_.get("line-join").evaluate(n,{}),S=_.get("line-cap"),k=_.get("line-miter-limit"),I=_.get("line-round-limit");this.lineClips=this.lineFeatureClips(n);for(const A of o)this.addLine(A,n,b,S,k,I);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,l,y,p)}addLine(n,o,l,p,y,_){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Q=0;Q<n.length-1;Q++)this.totalDistance+=n[Q].dist(n[Q+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const b=Dk[o.type]==="Polygon";let S=n.length;for(;S>=2&&n[S-1].equals(n[S-2]);)S--;let k=0;for(;k<S-1&&n[k].equals(n[k+1]);)k++;if(S<(b?3:2))return;l==="bevel"&&(y=1.05);const I=this.overscaling<=16?15*$r/(512*this.overscaling):0,A=this.segments.prepareSegment(10*S,this.layoutVertexArray,this.indexArray);let L,F,$,j,K;this.e1=this.e2=-1,b&&(L=n[S-2],K=n[k].sub(L)._unit()._perp());for(let Q=k;Q<S;Q++){if($=Q===S-1?b?n[k+1]:void 0:n[Q+1],$&&n[Q].equals($))continue;K&&(j=K),L&&(F=L),L=n[Q],K=$?$.sub(L)._unit()._perp():j,j=j||K;let ge=j.add(K);ge.x===0&&ge.y===0||ge._unit();const se=j.x*K.x+j.y*K.y,fe=ge.x*K.x+ge.y*K.y,be=fe!==0?1/fe:1/0,Pe=2*Math.sqrt(2-2*fe),qe=fe<Fk&&F&&$,st=j.x*K.y-j.y*K.x>0;if(qe&&Q>k){const et=L.dist(F);if(et>2*I){const Xe=L.sub(L.sub(F)._mult(I/et)._round());this.updateDistance(F,Xe),this.addCurrentVertex(Xe,j,0,0,A),F=Xe}}const Ue=F&&$;let Ne=Ue?l:b?"butt":p;if(Ue&&Ne==="round"&&(be<_?Ne="miter":be<=2&&(Ne="fakeround")),Ne==="miter"&&be>y&&(Ne="bevel"),Ne==="bevel"&&(be>2&&(Ne="flipbevel"),be<y&&(Ne="miter")),F&&this.updateDistance(F,L),Ne==="miter")ge._mult(be),this.addCurrentVertex(L,ge,0,0,A);else if(Ne==="flipbevel"){if(be>100)ge=K.mult(-1);else{const et=be*j.add(K).mag()/j.sub(K).mag();ge._perp()._mult(et*(st?-1:1))}this.addCurrentVertex(L,ge,0,0,A),this.addCurrentVertex(L,ge.mult(-1),0,0,A)}else if(Ne==="bevel"||Ne==="fakeround"){const et=-Math.sqrt(be*be-1),Xe=st?et:0,We=st?0:et;if(F&&this.addCurrentVertex(L,j,Xe,We,A),Ne==="fakeround"){const Te=Math.round(180*Pe/Math.PI/20);for(let rt=1;rt<Te;rt++){let Qe=rt/Te;if(Qe!==.5){const tr=Qe-.5;Qe+=Qe*tr*(Qe-1)*((1.0904+se*(se*(3.55645-1.43519*se)-3.2452))*tr*tr+(.848013+se*(.215638*se-1.06021)))}const ft=K.sub(j)._mult(Qe)._add(j)._unit()._mult(st?-1:1);this.addHalfVertex(L,ft.x,ft.y,!1,st,0,A)}}$&&this.addCurrentVertex(L,K,-Xe,-We,A)}else if(Ne==="butt")this.addCurrentVertex(L,ge,0,0,A);else if(Ne==="square"){const et=F?1:-1;this.addCurrentVertex(L,ge,et,et,A)}else Ne==="round"&&(F&&(this.addCurrentVertex(L,j,0,0,A),this.addCurrentVertex(L,j,1,1,A,!0)),$&&(this.addCurrentVertex(L,K,-1,-1,A,!0),this.addCurrentVertex(L,K,0,0,A)));if(qe&&Q<S-1){const et=L.dist($);if(et>2*I){const Xe=L.add($.sub(L)._mult(I/et)._round());this.updateDistance(L,Xe),this.addCurrentVertex(Xe,K,0,0,A),L=Xe}}}}addCurrentVertex(n,o,l,p,y,_=!1){const b=o.y*p-o.x,S=-o.y-o.x*p;this.addHalfVertex(n,o.x+o.y*l,o.y-o.x*l,_,!1,l,y),this.addHalfVertex(n,b,S,_,!0,-p,y),this.distance>b1/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(n,o,l,p,y,_))}addHalfVertex({x:n,y:o},l,p,y,_,b,S){const k=.5*(this.lineClips?this.scaledDistance*(b1-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((n<<1)+(y?1:0),(o<<1)+(_?1:0),Math.round(63*l)+128,Math.round(63*p)+128,1+(b===0?0:b<0?-1:1)|(63&k)<<2,k>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const I=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,I),S.primitiveLength++),_?this.e2=I:this.e1=I}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(n,o){this.distance+=n.dist(o),this.updateScaledDistance()}}let w1,S1;Ke("LineBucket",Qg,{omit:["layers","patternFeatures"]});var T1={get paint(){return S1=S1||new g({"line-opacity":new ut(xe.paint_line["line-opacity"]),"line-color":new ut(xe.paint_line["line-color"]),"line-translate":new Ye(xe.paint_line["line-translate"]),"line-translate-anchor":new Ye(xe.paint_line["line-translate-anchor"]),"line-width":new ut(xe.paint_line["line-width"]),"line-gap-width":new ut(xe.paint_line["line-gap-width"]),"line-offset":new ut(xe.paint_line["line-offset"]),"line-blur":new ut(xe.paint_line["line-blur"]),"line-dasharray":new vu(xe.paint_line["line-dasharray"]),"line-pattern":new _u(xe.paint_line["line-pattern"]),"line-gradient":new yh(xe.paint_line["line-gradient"])})},get layout(){return w1=w1||new g({"line-cap":new Ye(xe.layout_line["line-cap"]),"line-join":new ut(xe.layout_line["line-join"]),"line-miter-limit":new Ye(xe.layout_line["line-miter-limit"]),"line-round-limit":new Ye(xe.layout_line["line-round-limit"]),"line-sort-key":new ut(xe.layout_line["line-sort-key"])})}};class Bk extends ut{possiblyEvaluate(n,o){return o=new cr(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,zoomHistory:o.zoomHistory,transition:o.transition}),super.possiblyEvaluate(n,o)}evaluate(n,o,l,p){return o=ke({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(n,o,l,p)}}let Lp;class Ok extends s{constructor(n){super(n,T1),this.gradientVersion=0,Lp||(Lp=new Bk(T1.paint.properties["line-width"].specification),Lp.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(n){if(n==="line-gradient"){const o=this.gradientExpression();this.stepInterpolant=!!function(l){return l._styleExpression!==void 0}(o)&&o._styleExpression.expression instanceof Ka,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(n,o){super.recalculate(n,o),this.paint._values["line-floorwidth"]=Lp.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,n)}createBucket(n){return new Qg(n)}queryRadius(n){const o=n,l=C1(xh("line-width",this,o),xh("line-gap-width",this,o)),p=xh("line-offset",this,o);return l/2+Math.abs(p)+Ip(this.paint.get("line-translate"))}queryIntersectsFeature(n,o,l,p,y,_,b){const S=Ep(n,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),_.angle,b),k=b/2*C1(this.paint.get("line-width").evaluate(o,l),this.paint.get("line-gap-width").evaluate(o,l)),I=this.paint.get("line-offset").evaluate(o,l);return I&&(p=function(A,L){const F=[];for(let $=0;$<A.length;$++){const j=A[$],K=[];for(let Q=0;Q<j.length;Q++){const ge=j[Q-1],se=j[Q],fe=j[Q+1],be=Q===0?new U(0,0):se.sub(ge)._unit()._perp(),Pe=Q===j.length-1?new U(0,0):fe.sub(se)._unit()._perp(),qe=be._add(Pe)._unit(),st=qe.x*Pe.x+qe.y*Pe.y;st!==0&&qe._mult(1/st),K.push(qe._mult(L)._add(se))}F.push(K)}return F}(p,I*b)),function(A,L,F){for(let $=0;$<L.length;$++){const j=L[$];if(A.length>=3){for(let K=0;K<j.length;K++)if(ku(A,j[K]))return!0}if(HC(A,j,F))return!0}return!1}(S,p,k)}isTileClipped(){return!0}}function C1(i,n){return n>0?n+2*i:i}const Nk=w([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),$k=w([{name:"a_projected_pos",components:3,type:"Float32"}],4);w([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Uk=w([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);w([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const k1=w([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),jk=w([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Vk(i,n,o){return i.sections.forEach(l=>{l.text=function(p,y,_){const b=y.layout.get("text-transform").evaluate(_,{});return b==="uppercase"?p=p.toLocaleUpperCase():b==="lowercase"&&(p=p.toLocaleLowerCase()),ii.applyArabicShaping&&(p=ii.applyArabicShaping(p)),p}(l.text,n,o)}),i}w([{name:"triangle",components:3,type:"Uint16"}]),w([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),w([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),w([{type:"Float32",name:"offsetX"}]),w([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),w([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Eh={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Zr=24,I1=Yt,E1=function(i,n,o,l,p){var y,_,b=8*p-l-1,S=(1<<b)-1,k=S>>1,I=-7,A=p-1,L=-1,F=i[n+A];for(A+=L,y=F&(1<<-I)-1,F>>=-I,I+=b;I>0;y=256*y+i[n+A],A+=L,I-=8);for(_=y&(1<<-I)-1,y>>=-I,I+=l;I>0;_=256*_+i[n+A],A+=L,I-=8);if(y===0)y=1-k;else{if(y===S)return _?NaN:1/0*(F?-1:1);_+=Math.pow(2,l),y-=k}return(F?-1:1)*_*Math.pow(2,y-l)},A1=function(i,n,o,l,p,y){var _,b,S,k=8*y-p-1,I=(1<<k)-1,A=I>>1,L=p===23?Math.pow(2,-24)-Math.pow(2,-77):0,F=0,$=1,j=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(b=isNaN(n)?1:0,_=I):(_=Math.floor(Math.log(n)/Math.LN2),n*(S=Math.pow(2,-_))<1&&(_--,S*=2),(n+=_+A>=1?L/S:L*Math.pow(2,1-A))*S>=2&&(_++,S/=2),_+A>=I?(b=0,_=I):_+A>=1?(b=(n*S-1)*Math.pow(2,p),_+=A):(b=n*Math.pow(2,A-1)*Math.pow(2,p),_=0));p>=8;i[o+F]=255&b,F+=$,b/=256,p-=8);for(_=_<<p|b,k+=p;k>0;i[o+F]=255&_,F+=$,_/=256,k-=8);i[o+F-$]|=128*j};function Yt(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}Yt.Varint=0,Yt.Fixed64=1,Yt.Bytes=2,Yt.Fixed32=5;var ey=4294967296,P1=1/ey,M1=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function Pa(i){return i.type===Yt.Bytes?i.readVarint()+i.pos:i.pos+1}function Pu(i,n,o){return o?4294967296*n+(i>>>0):4294967296*(n>>>0)+(i>>>0)}function z1(i,n,o){var l=n<=16383?1:n<=2097151?2:n<=268435455?3:Math.floor(Math.log(n)/(7*Math.LN2));o.realloc(l);for(var p=o.pos-1;p>=i;p--)o.buf[p+l]=o.buf[p]}function qk(i,n){for(var o=0;o<i.length;o++)n.writeVarint(i[o])}function Zk(i,n){for(var o=0;o<i.length;o++)n.writeSVarint(i[o])}function Gk(i,n){for(var o=0;o<i.length;o++)n.writeFloat(i[o])}function Hk(i,n){for(var o=0;o<i.length;o++)n.writeDouble(i[o])}function Wk(i,n){for(var o=0;o<i.length;o++)n.writeBoolean(i[o])}function Kk(i,n){for(var o=0;o<i.length;o++)n.writeFixed32(i[o])}function Xk(i,n){for(var o=0;o<i.length;o++)n.writeSFixed32(i[o])}function Yk(i,n){for(var o=0;o<i.length;o++)n.writeFixed64(i[o])}function Jk(i,n){for(var o=0;o<i.length;o++)n.writeSFixed64(i[o])}function Rp(i,n){return(i[n]|i[n+1]<<8|i[n+2]<<16)+16777216*i[n+3]}function Mu(i,n,o){i[o]=n,i[o+1]=n>>>8,i[o+2]=n>>>16,i[o+3]=n>>>24}function L1(i,n){return(i[n]|i[n+1]<<8|i[n+2]<<16)+(i[n+3]<<24)}Yt.prototype={destroy:function(){this.buf=null},readFields:function(i,n,o){for(o=o||this.length;this.pos<o;){var l=this.readVarint(),p=l>>3,y=this.pos;this.type=7&l,i(p,n,this),this.pos===y&&this.skip(l)}return n},readMessage:function(i,n){return this.readFields(i,n,this.readVarint()+this.pos)},readFixed32:function(){var i=Rp(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=L1(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=Rp(this.buf,this.pos)+Rp(this.buf,this.pos+4)*ey;return this.pos+=8,i},readSFixed64:function(){var i=Rp(this.buf,this.pos)+L1(this.buf,this.pos+4)*ey;return this.pos+=8,i},readFloat:function(){var i=E1(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=E1(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var n,o,l=this.buf;return n=127&(o=l[this.pos++]),o<128?n:(n|=(127&(o=l[this.pos++]))<<7,o<128?n:(n|=(127&(o=l[this.pos++]))<<14,o<128?n:(n|=(127&(o=l[this.pos++]))<<21,o<128?n:function(p,y,_){var b,S,k=_.buf;if(b=(112&(S=k[_.pos++]))>>4,S<128||(b|=(127&(S=k[_.pos++]))<<3,S<128)||(b|=(127&(S=k[_.pos++]))<<10,S<128)||(b|=(127&(S=k[_.pos++]))<<17,S<128)||(b|=(127&(S=k[_.pos++]))<<24,S<128)||(b|=(1&(S=k[_.pos++]))<<31,S<128))return Pu(p,b,y);throw new Error("Expected varint not more than 10 bytes")}(n|=(15&(o=l[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?(i+1)/-2:i/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var i=this.readVarint()+this.pos,n=this.pos;return this.pos=i,i-n>=12&&M1?function(o,l,p){return M1.decode(o.subarray(l,p))}(this.buf,n,i):function(o,l,p){for(var y="",_=l;_<p;){var b,S,k,I=o[_],A=null,L=I>239?4:I>223?3:I>191?2:1;if(_+L>p)break;L===1?I<128&&(A=I):L===2?(192&(b=o[_+1]))==128&&(A=(31&I)<<6|63&b)<=127&&(A=null):L===3?(S=o[_+2],(192&(b=o[_+1]))==128&&(192&S)==128&&((A=(15&I)<<12|(63&b)<<6|63&S)<=2047||A>=55296&&A<=57343)&&(A=null)):L===4&&(S=o[_+2],k=o[_+3],(192&(b=o[_+1]))==128&&(192&S)==128&&(192&k)==128&&((A=(15&I)<<18|(63&b)<<12|(63&S)<<6|63&k)<=65535||A>=1114112)&&(A=null)),A===null?(A=65533,L=1):A>65535&&(A-=65536,y+=String.fromCharCode(A>>>10&1023|55296),A=56320|1023&A),y+=String.fromCharCode(A),_+=L}return y}(this.buf,n,i)},readBytes:function(){var i=this.readVarint()+this.pos,n=this.buf.subarray(this.pos,i);return this.pos=i,n},readPackedVarint:function(i,n){if(this.type!==Yt.Bytes)return i.push(this.readVarint(n));var o=Pa(this);for(i=i||[];this.pos<o;)i.push(this.readVarint(n));return i},readPackedSVarint:function(i){if(this.type!==Yt.Bytes)return i.push(this.readSVarint());var n=Pa(this);for(i=i||[];this.pos<n;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==Yt.Bytes)return i.push(this.readBoolean());var n=Pa(this);for(i=i||[];this.pos<n;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==Yt.Bytes)return i.push(this.readFloat());var n=Pa(this);for(i=i||[];this.pos<n;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==Yt.Bytes)return i.push(this.readDouble());var n=Pa(this);for(i=i||[];this.pos<n;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==Yt.Bytes)return i.push(this.readFixed32());var n=Pa(this);for(i=i||[];this.pos<n;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==Yt.Bytes)return i.push(this.readSFixed32());var n=Pa(this);for(i=i||[];this.pos<n;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==Yt.Bytes)return i.push(this.readFixed64());var n=Pa(this);for(i=i||[];this.pos<n;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==Yt.Bytes)return i.push(this.readSFixed64());var n=Pa(this);for(i=i||[];this.pos<n;)i.push(this.readSFixed64());return i},skip:function(i){var n=7&i;if(n===Yt.Varint)for(;this.buf[this.pos++]>127;);else if(n===Yt.Bytes)this.pos=this.readVarint()+this.pos;else if(n===Yt.Fixed32)this.pos+=4;else{if(n!==Yt.Fixed64)throw new Error("Unimplemented type: "+n);this.pos+=8}},writeTag:function(i,n){this.writeVarint(i<<3|n)},realloc:function(i){for(var n=this.length||16;n<this.pos+i;)n*=2;if(n!==this.length){var o=new Uint8Array(n);o.set(this.buf),this.buf=o,this.length=n}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),Mu(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),Mu(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),Mu(this.buf,-1&i,this.pos),Mu(this.buf,Math.floor(i*P1),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),Mu(this.buf,-1&i,this.pos),Mu(this.buf,Math.floor(i*P1),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?function(n,o){var l,p;if(n>=0?(l=n%4294967296|0,p=n/4294967296|0):(p=~(-n/4294967296),4294967295^(l=~(-n%4294967296))?l=l+1|0:(l=0,p=p+1|0)),n>=18446744073709552e3||n<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");o.realloc(10),function(y,_,b){b.buf[b.pos++]=127&y|128,y>>>=7,b.buf[b.pos++]=127&y|128,y>>>=7,b.buf[b.pos++]=127&y|128,y>>>=7,b.buf[b.pos++]=127&y|128,b.buf[b.pos]=127&(y>>>=7)}(l,0,o),function(y,_){var b=(7&y)<<4;_.buf[_.pos++]|=b|((y>>>=3)?128:0),y&&(_.buf[_.pos++]=127&y|((y>>>=7)?128:0),y&&(_.buf[_.pos++]=127&y|((y>>>=7)?128:0),y&&(_.buf[_.pos++]=127&y|((y>>>=7)?128:0),y&&(_.buf[_.pos++]=127&y|((y>>>=7)?128:0),y&&(_.buf[_.pos++]=127&y)))))}(p,o)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?2*-i-1:2*i)},writeBoolean:function(i){this.writeVarint(!!i)},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var n=this.pos;this.pos=function(l,p,y){for(var _,b,S=0;S<p.length;S++){if((_=p.charCodeAt(S))>55295&&_<57344){if(!b){_>56319||S+1===p.length?(l[y++]=239,l[y++]=191,l[y++]=189):b=_;continue}if(_<56320){l[y++]=239,l[y++]=191,l[y++]=189,b=_;continue}_=b-55296<<10|_-56320|65536,b=null}else b&&(l[y++]=239,l[y++]=191,l[y++]=189,b=null);_<128?l[y++]=_:(_<2048?l[y++]=_>>6|192:(_<65536?l[y++]=_>>12|224:(l[y++]=_>>18|240,l[y++]=_>>12&63|128),l[y++]=_>>6&63|128),l[y++]=63&_|128)}return y}(this.buf,i,this.pos);var o=this.pos-n;o>=128&&z1(n,o,this),this.pos=n-1,this.writeVarint(o),this.pos+=o},writeFloat:function(i){this.realloc(4),A1(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),A1(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var n=i.length;this.writeVarint(n),this.realloc(n);for(var o=0;o<n;o++)this.buf[this.pos++]=i[o]},writeRawMessage:function(i,n){this.pos++;var o=this.pos;i(n,this);var l=this.pos-o;l>=128&&z1(o,l,this),this.pos=o-1,this.writeVarint(l),this.pos+=l},writeMessage:function(i,n,o){this.writeTag(i,Yt.Bytes),this.writeRawMessage(n,o)},writePackedVarint:function(i,n){n.length&&this.writeMessage(i,qk,n)},writePackedSVarint:function(i,n){n.length&&this.writeMessage(i,Zk,n)},writePackedBoolean:function(i,n){n.length&&this.writeMessage(i,Wk,n)},writePackedFloat:function(i,n){n.length&&this.writeMessage(i,Gk,n)},writePackedDouble:function(i,n){n.length&&this.writeMessage(i,Hk,n)},writePackedFixed32:function(i,n){n.length&&this.writeMessage(i,Kk,n)},writePackedSFixed32:function(i,n){n.length&&this.writeMessage(i,Xk,n)},writePackedFixed64:function(i,n){n.length&&this.writeMessage(i,Yk,n)},writePackedSFixed64:function(i,n){n.length&&this.writeMessage(i,Jk,n)},writeBytesField:function(i,n){this.writeTag(i,Yt.Bytes),this.writeBytes(n)},writeFixed32Field:function(i,n){this.writeTag(i,Yt.Fixed32),this.writeFixed32(n)},writeSFixed32Field:function(i,n){this.writeTag(i,Yt.Fixed32),this.writeSFixed32(n)},writeFixed64Field:function(i,n){this.writeTag(i,Yt.Fixed64),this.writeFixed64(n)},writeSFixed64Field:function(i,n){this.writeTag(i,Yt.Fixed64),this.writeSFixed64(n)},writeVarintField:function(i,n){this.writeTag(i,Yt.Varint),this.writeVarint(n)},writeSVarintField:function(i,n){this.writeTag(i,Yt.Varint),this.writeSVarint(n)},writeStringField:function(i,n){this.writeTag(i,Yt.Bytes),this.writeString(n)},writeFloatField:function(i,n){this.writeTag(i,Yt.Fixed32),this.writeFloat(n)},writeDoubleField:function(i,n){this.writeTag(i,Yt.Fixed64),this.writeDouble(n)},writeBooleanField:function(i,n){this.writeVarintField(i,!!n)}};var ty=z(I1);const ry=3;function Qk(i,n,o){i===1&&o.readMessage(eI,n)}function eI(i,n,o){if(i===3){const{id:l,bitmap:p,width:y,height:_,left:b,top:S,advance:k}=o.readMessage(tI,{});n.push({id:l,bitmap:new wh({width:y+2*ry,height:_+2*ry},p),metrics:{width:y,height:_,left:b,top:S,advance:k}})}}function tI(i,n,o){i===1?n.id=o.readVarint():i===2?n.bitmap=o.readBytes():i===3?n.width=o.readVarint():i===4?n.height=o.readVarint():i===5?n.left=o.readSVarint():i===6?n.top=o.readSVarint():i===7&&(n.advance=o.readVarint())}const R1=ry;function D1(i){let n=0,o=0;for(const _ of i)n+=_.w*_.h,o=Math.max(o,_.w);i.sort((_,b)=>b.h-_.h);const l=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),o),h:1/0}];let p=0,y=0;for(const _ of i)for(let b=l.length-1;b>=0;b--){const S=l[b];if(!(_.w>S.w||_.h>S.h)){if(_.x=S.x,_.y=S.y,y=Math.max(y,_.y+_.h),p=Math.max(p,_.x+_.w),_.w===S.w&&_.h===S.h){const k=l.pop();b<l.length&&(l[b]=k)}else _.h===S.h?(S.x+=_.w,S.w-=_.w):_.w===S.w?(S.y+=_.h,S.h-=_.h):(l.push({x:S.x+_.w,y:S.y,w:S.w-_.w,h:_.h}),S.y+=_.h,S.h-=_.h);break}}return{w:p,h:y,fill:n/(p*y)||0}}const ai=1;class ny{constructor(n,{pixelRatio:o,version:l,stretchX:p,stretchY:y,content:_,textFitWidth:b,textFitHeight:S}){this.paddedRect=n,this.pixelRatio=o,this.stretchX=p,this.stretchY=y,this.content=_,this.version=l,this.textFitWidth=b,this.textFitHeight=S}get tl(){return[this.paddedRect.x+ai,this.paddedRect.y+ai]}get br(){return[this.paddedRect.x+this.paddedRect.w-ai,this.paddedRect.y+this.paddedRect.h-ai]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*ai)/this.pixelRatio,(this.paddedRect.h-2*ai)/this.pixelRatio]}}class F1{constructor(n,o){const l={},p={};this.haveRenderCallbacks=[];const y=[];this.addImages(n,l,y),this.addImages(o,p,y);const{w:_,h:b}=D1(y),S=new Ui({width:_||1,height:b||1});for(const k in n){const I=n[k],A=l[k].paddedRect;Ui.copy(I.data,S,{x:0,y:0},{x:A.x+ai,y:A.y+ai},I.data)}for(const k in o){const I=o[k],A=p[k].paddedRect,L=A.x+ai,F=A.y+ai,$=I.data.width,j=I.data.height;Ui.copy(I.data,S,{x:0,y:0},{x:L,y:F},I.data),Ui.copy(I.data,S,{x:0,y:j-1},{x:L,y:F-1},{width:$,height:1}),Ui.copy(I.data,S,{x:0,y:0},{x:L,y:F+j},{width:$,height:1}),Ui.copy(I.data,S,{x:$-1,y:0},{x:L-1,y:F},{width:1,height:j}),Ui.copy(I.data,S,{x:0,y:0},{x:L+$,y:F},{width:1,height:j})}this.image=S,this.iconPositions=l,this.patternPositions=p}addImages(n,o,l){for(const p in n){const y=n[p],_={x:0,y:0,w:y.data.width+2*ai,h:y.data.height+2*ai};l.push(_),o[p]=new ny(_,y),y.hasRenderCallback&&this.haveRenderCallbacks.push(p)}}patchUpdatedImages(n,o){n.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const l in n.updatedImages)this.patchUpdatedImage(this.iconPositions[l],n.getImage(l),o),this.patchUpdatedImage(this.patternPositions[l],n.getImage(l),o)}patchUpdatedImage(n,o,l){if(!n||!o||n.version===o.version)return;n.version=o.version;const[p,y]=n.tl;l.update(o.data,void 0,{x:p,y})}}var bs;Ke("ImagePosition",ny),Ke("ImageAtlas",F1),x.ah=void 0,(bs=x.ah||(x.ah={}))[bs.none=0]="none",bs[bs.horizontal=1]="horizontal",bs[bs.vertical=2]="vertical",bs[bs.horizontalOnly=3]="horizontalOnly";const Ah=-17;class Ph{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(n,o){const l=new Ph;return l.scale=n||1,l.fontStack=o,l}static forImage(n){const o=new Ph;return o.imageName=n,o}}class zu{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(n,o){const l=new zu;for(let p=0;p<n.sections.length;p++){const y=n.sections[p];y.image?l.addImageSection(y):l.addTextSection(y,o)}return l}length(){return this.text.length}getSection(n){return this.sections[this.sectionIndex[n]]}getSectionIndex(n){return this.sectionIndex[n]}getCharCode(n){return this.text.charCodeAt(n)}verticalizePunctuation(){this.text=function(n){let o="";for(let l=0;l<n.length;l++){const p=n.charCodeAt(l+1)||null,y=n.charCodeAt(l-1)||null;o+=p&&xp(p)&&!Eh[n[l+1]]||y&&xp(y)&&!Eh[n[l-1]]||!Eh[n[l]]?n[l]:Eh[n[l]]}return o}(this.text)}trim(){let n=0;for(let l=0;l<this.text.length&&Fp[this.text.charCodeAt(l)];l++)n++;let o=this.text.length;for(let l=this.text.length-1;l>=0&&l>=n&&Fp[this.text.charCodeAt(l)];l--)o--;this.text=this.text.substring(n,o),this.sectionIndex=this.sectionIndex.slice(n,o)}substring(n,o){const l=new zu;return l.text=this.text.substring(n,o),l.sectionIndex=this.sectionIndex.slice(n,o),l.sections=this.sections,l}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((n,o)=>Math.max(n,this.sections[o].scale),0)}addTextSection(n,o){this.text+=n.text,this.sections.push(Ph.forText(n.scale,n.fontStack||o));const l=this.sections.length-1;for(let p=0;p<n.text.length;++p)this.sectionIndex.push(l)}addImageSection(n){const o=n.image?n.image.name:"";if(o.length===0)return void It("Can't add FormattedSection with an empty image.");const l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCharCode(l),this.sections.push(Ph.forImage(o)),this.sectionIndex.push(this.sections.length-1)):It("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Dp(i,n,o,l,p,y,_,b,S,k,I,A,L,F,$){const j=zu.fromFeature(i,p);let K;A===x.ah.vertical&&j.verticalizePunctuation();const{processBidirectionalText:Q,processStyledBidirectionalText:ge}=ii;if(Q&&j.sections.length===1){K=[];const be=Q(j.toString(),iy(j,k,y,n,l,F));for(const Pe of be){const qe=new zu;qe.text=Pe,qe.sections=j.sections;for(let st=0;st<Pe.length;st++)qe.sectionIndex.push(0);K.push(qe)}}else if(ge){K=[];const be=ge(j.text,j.sectionIndex,iy(j,k,y,n,l,F));for(const Pe of be){const qe=new zu;qe.text=Pe[0],qe.sectionIndex=Pe[1],qe.sections=j.sections,K.push(qe)}}else K=function(be,Pe){const qe=[],st=be.text;let Ue=0;for(const Ne of Pe)qe.push(be.substring(Ue,Ne)),Ue=Ne;return Ue<st.length&&qe.push(be.substring(Ue,st.length)),qe}(j,iy(j,k,y,n,l,F));const se=[],fe={positionedLines:se,text:j.toString(),top:I[1],bottom:I[1],left:I[0],right:I[0],writingMode:A,iconsInText:!1,verticalizable:!1};return function(be,Pe,qe,st,Ue,Ne,et,Xe,We,Te,rt,Qe){let ft=0,tr=Ah,Jt=0,Qr=0;const po=Xe==="right"?1:Xe==="left"?0:.5;let yn=0;for(const Ir of Ue){Ir.trim();const tn=Ir.getMaxScale(),En=(tn-1)*Zr,_n={positionedGlyphs:[],lineOffset:0};be.positionedLines[yn]=_n;const Gn=_n.positionedGlyphs;let vn=0;if(!Ir.length()){tr+=Ne,++yn;continue}for(let si=0;si<Ir.length();si++){const Nt=Ir.getSection(si),ar=Ir.getSectionIndex(si),fr=Ir.getCharCode(si);let bi=0,br=null,Fu=null,Qo=null,ea=Zr;const fo=!(We===x.ah.horizontal||!rt&&!mh(fr)||rt&&(Fp[fr]||(en=fr,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(en)))));if(Nt.imageName){const qi=st[Nt.imageName];if(!qi)continue;Qo=Nt.imageName,be.iconsInText=be.iconsInText||!0,Fu=qi.paddedRect;const un=qi.displaySize;Nt.scale=Nt.scale*Zr/Qe,br={width:un[0],height:un[1],left:ai,top:-R1,advance:fo?un[1]:un[0]},bi=En+(Zr-un[1]*Nt.scale),ea=br.advance;const Ma=fo?un[0]*Nt.scale-Zr*tn:un[1]*Nt.scale-Zr*tn;Ma>0&&Ma>vn&&(vn=Ma)}else{const qi=qe[Nt.fontStack],un=qi&&qi[fr];if(un&&un.rect)Fu=un.rect,br=un.metrics;else{const Ma=Pe[Nt.fontStack],Fh=Ma&&Ma[fr];if(!Fh)continue;br=Fh.metrics}bi=(tn-Nt.scale)*Zr}fo?(be.verticalizable=!0,Gn.push({glyph:fr,imageName:Qo,x:ft,y:tr+bi,vertical:fo,scale:Nt.scale,fontStack:Nt.fontStack,sectionIndex:ar,metrics:br,rect:Fu}),ft+=ea*Nt.scale+Te):(Gn.push({glyph:fr,imageName:Qo,x:ft,y:tr+bi,vertical:fo,scale:Nt.scale,fontStack:Nt.fontStack,sectionIndex:ar,metrics:br,rect:Fu}),ft+=br.advance*Nt.scale+Te)}Gn.length!==0&&(Jt=Math.max(ft-Te,Jt),oI(Gn,0,Gn.length-1,po,vn)),ft=0;const Vi=Ne*tn+vn;_n.lineOffset=Math.max(vn,En),tr+=Vi,Qr=Math.max(Vi,Qr),++yn}var en;const Vn=tr-Ah,{horizontalAlign:qn,verticalAlign:Zn}=oy(et);(function(Ir,tn,En,_n,Gn,vn,Vi,si,Nt){const ar=(tn-En)*Gn;let fr=0;fr=vn!==Vi?-si*_n-Ah:(-_n*Nt+.5)*Vi;for(const bi of Ir)for(const br of bi.positionedGlyphs)br.x+=ar,br.y+=fr})(be.positionedLines,po,qn,Zn,Jt,Qr,Ne,Vn,Ue.length),be.top+=-Zn*Vn,be.bottom=be.top+Vn,be.left+=-qn*Jt,be.right=be.left+Jt}(fe,n,o,l,K,_,b,S,A,k,L,$),!function(be){for(const Pe of be)if(Pe.positionedGlyphs.length!==0)return!1;return!0}(se)&&fe}const Fp={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},rI={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},nI={40:!0};function B1(i,n,o,l,p,y){if(n.imageName){const _=l[n.imageName];return _?_.displaySize[0]*n.scale*Zr/y+p:0}{const _=o[n.fontStack],b=_&&_[i];return b?b.metrics.advance*n.scale+p:0}}function O1(i,n,o,l){const p=Math.pow(i-n,2);return l?i<n?p/2:2*p:p+Math.abs(o)*o}function iI(i,n,o){let l=0;return i===10&&(l-=1e4),o&&(l+=150),i!==40&&i!==65288||(l+=50),n!==41&&n!==65289||(l+=50),l}function N1(i,n,o,l,p,y){let _=null,b=O1(n,o,p,y);for(const S of l){const k=O1(n-S.x,o,p,y)+S.badness;k<=b&&(_=S,b=k)}return{index:i,x:n,priorBreak:_,badness:b}}function $1(i){return i?$1(i.priorBreak).concat(i.index):[]}function iy(i,n,o,l,p,y){if(!i)return[];const _=[],b=function(A,L,F,$,j,K){let Q=0;for(let ge=0;ge<A.length();ge++){const se=A.getSection(ge);Q+=B1(A.getCharCode(ge),se,$,j,L,K)}return Q/Math.max(1,Math.ceil(Q/F))}(i,n,o,l,p,y),S=i.text.indexOf("")>=0;let k=0;for(let A=0;A<i.length();A++){const L=i.getSection(A),F=i.getCharCode(A);if(Fp[F]||(k+=B1(F,L,l,p,n,y)),A<i.length()-1){const $=!((I=F)<11904)&&(!!Mt["CJK Compatibility Forms"](I)||!!Mt["CJK Compatibility"](I)||!!Mt["CJK Strokes"](I)||!!Mt["CJK Symbols and Punctuation"](I)||!!Mt["Enclosed CJK Letters and Months"](I)||!!Mt["Halfwidth and Fullwidth Forms"](I)||!!Mt["Ideographic Description Characters"](I)||!!Mt["Vertical Forms"](I)||vp.test(String.fromCodePoint(I)));(rI[F]||$||L.imageName||A!==i.length()-2&&nI[i.getCharCode(A+1)])&&_.push(N1(A+1,k,b,_,iI(F,i.getCharCode(A+1),$&&S),!1))}}var I;return $1(N1(i.length(),k,b,_,0,!0))}function oy(i){let n=.5,o=.5;switch(i){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:n,verticalAlign:o}}function oI(i,n,o,l,p){if(!l&&!p)return;const y=i[o],_=(i[o].x+y.metrics.advance*y.scale)*l;for(let b=n;b<=o;b++)i[b].x-=_,i[b].y+=p}function aI(i,n,o){const{horizontalAlign:l,verticalAlign:p}=oy(o),y=n[0]-i.displaySize[0]*l,_=n[1]-i.displaySize[1]*p;return{image:i,top:_,bottom:_+i.displaySize[1],left:y,right:y+i.displaySize[0]}}function U1(i){var n,o;let l=i.left,p=i.top,y=i.right-l,_=i.bottom-p;const b=(n=i.image.textFitWidth)!==null&&n!==void 0?n:"stretchOrShrink",S=(o=i.image.textFitHeight)!==null&&o!==void 0?o:"stretchOrShrink",k=(i.image.content[2]-i.image.content[0])/(i.image.content[3]-i.image.content[1]);if(S==="proportional"){if(b==="stretchOnly"&&y/_<k||b==="proportional"){const I=Math.ceil(_*k);l*=I/y,y=I}}else if(b==="proportional"&&S==="stretchOnly"&&k!==0&&y/_>k){const I=Math.ceil(y/k);p*=I/_,_=I}return{x1:l,y1:p,x2:l+y,y2:p+_}}function j1(i,n,o,l,p,y){const _=i.image;let b;if(_.content){const K=_.content,Q=_.pixelRatio||1;b=[K[0]/Q,K[1]/Q,_.displaySize[0]-K[2]/Q,_.displaySize[1]-K[3]/Q]}const S=n.left*y,k=n.right*y;let I,A,L,F;o==="width"||o==="both"?(F=p[0]+S-l[3],A=p[0]+k+l[1]):(F=p[0]+(S+k-_.displaySize[0])/2,A=F+_.displaySize[0]);const $=n.top*y,j=n.bottom*y;return o==="height"||o==="both"?(I=p[1]+$-l[0],L=p[1]+j+l[2]):(I=p[1]+($+j-_.displaySize[1])/2,L=I+_.displaySize[1]),{image:_,top:I,right:A,bottom:L,left:F,collisionPadding:b}}const Mh=255,Jo=128,ws=Mh*Jo;function V1(i,n){const{expression:o}=n;if(o.kind==="constant")return{kind:"constant",layoutSize:o.evaluate(new cr(i+1))};if(o.kind==="source")return{kind:"source"};{const{zoomStops:l,interpolationType:p}=o;let y=0;for(;y<l.length&&l[y]<=i;)y++;y=Math.max(0,y-1);let _=y;for(;_<l.length&&l[_]<i+1;)_++;_=Math.min(l.length-1,_);const b=l[y],S=l[_];return o.kind==="composite"?{kind:"composite",minZoom:b,maxZoom:S,interpolationType:p}:{kind:"camera",minZoom:b,maxZoom:S,minSize:o.evaluate(new cr(b)),maxSize:o.evaluate(new cr(S)),interpolationType:p}}}function ay(i,n,o){let l="never";const p=i.get(n);return p?l=p:i.get(o)&&(l="always"),l}const sI=xs.VectorTileFeature.types,lI=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Bp(i,n,o,l,p,y,_,b,S,k,I,A,L){const F=b?Math.min(ws,Math.round(b[0])):0,$=b?Math.min(ws,Math.round(b[1])):0;i.emplaceBack(n,o,Math.round(32*l),Math.round(32*p),y,_,(F<<1)+(S?1:0),$,16*k,16*I,256*A,256*L)}function sy(i,n,o){i.emplaceBack(n.x,n.y,o),i.emplaceBack(n.x,n.y,o),i.emplaceBack(n.x,n.y,o),i.emplaceBack(n.x,n.y,o)}function uI(i){for(const n of i.sections)if(Dg(n.text))return!0;return!1}class ly{constructor(n){this.layoutVertexArray=new bu,this.indexArray=new $i,this.programConfigurations=n,this.segments=new zt,this.dynamicLayoutVertexArray=new _h,this.opacityVertexArray=new vi,this.hasVisibleVertices=!1,this.placedSymbolArray=new hr}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(n,o,l,p){this.isEmpty()||(l&&(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,Nk.members),this.indexBuffer=n.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=n.createVertexBuffer(this.dynamicLayoutVertexArray,$k.members,!0),this.opacityVertexBuffer=n.createVertexBuffer(this.opacityVertexArray,lI,!0),this.opacityVertexBuffer.itemSize=1),(l||p)&&this.programConfigurations.upload(n))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Ke("SymbolBuffers",ly);class uy{constructor(n,o,l){this.layoutVertexArray=new n,this.layoutAttributes=o,this.indexArray=new l,this.segments=new zt,this.collisionVertexArray=new Xo}upload(n){this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=n.createVertexBuffer(this.collisionVertexArray,Uk.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Ke("CollisionBuffers",uy);class Lu{constructor(n){this.collisionBoxArray=n.collisionBoxArray,this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map(_=>_.id),this.index=n.index,this.pixelRatio=n.pixelRatio,this.sourceLayerIndex=n.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=jg([]),this.placementViewportMatrix=jg([]);const o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=V1(this.zoom,o["text-size"]),this.iconSizeData=V1(this.zoom,o["icon-size"]);const l=this.layers[0].layout,p=l.get("symbol-sort-key"),y=l.get("symbol-z-order");this.canOverlap=ay(l,"text-overlap","text-allow-overlap")!=="never"||ay(l,"icon-overlap","icon-allow-overlap")!=="never"||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey=y!=="viewport-y"&&!p.isConstant(),this.sortFeaturesByY=(y==="viewport-y"||y==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,l.get("symbol-placement")==="point"&&(this.writingModes=l.get("text-writing-mode").map(_=>x.ah[_])),this.stateDependentLayerIds=this.layers.filter(_=>_.isStateDependent()).map(_=>_.id),this.sourceID=n.sourceID}createArrays(){this.text=new ly(new ml(this.layers,this.zoom,n=>/^text/.test(n))),this.icon=new ly(new ml(this.layers,this.zoom,n=>/^icon/.test(n))),this.glyphOffsetArray=new dr,this.lineVertexArray=new pn,this.symbolInstances=new At,this.textAnchorOffsets=new pr}calculateGlyphDependencies(n,o,l,p,y){for(let _=0;_<n.length;_++)if(o[n.charCodeAt(_)]=!0,(l||p)&&y){const b=Eh[n.charAt(_)];b&&(o[b.charCodeAt(0)]=!0)}}populate(n,o,l){const p=this.layers[0],y=p.layout,_=y.get("text-font"),b=y.get("text-field"),S=y.get("icon-image"),k=(b.value.kind!=="constant"||b.value.value instanceof ei&&!b.value.value.isEmpty()||b.value.value.toString().length>0)&&(_.value.kind!=="constant"||_.value.value.length>0),I=S.value.kind!=="constant"||!!S.value.value||Object.keys(S.parameters).length>0,A=y.get("symbol-sort-key");if(this.features=[],!k&&!I)return;const L=o.iconDependencies,F=o.glyphDependencies,$=o.availableImages,j=new cr(this.zoom);for(const{feature:K,id:Q,index:ge,sourceLayerIndex:se}of n){const fe=p._featureFilter.needGeometry,be=yl(K,fe);if(!p._featureFilter.filter(j,be,l))continue;let Pe,qe;if(fe||(be.geometry=gl(K)),k){const Ue=p.getValueAndResolveTokens("text-field",be,l,$),Ne=ei.factory(Ue),et=this.hasRTLText=this.hasRTLText||uI(Ne);(!et||ii.getRTLTextPluginStatus()==="unavailable"||et&&ii.isParsed())&&(Pe=Vk(Ne,p,be))}if(I){const Ue=p.getValueAndResolveTokens("icon-image",be,l,$);qe=Ue instanceof ri?Ue:ri.fromString(Ue)}if(!Pe&&!qe)continue;const st=this.sortFeaturesByKey?A.evaluate(be,{},l):void 0;if(this.features.push({id:Q,text:Pe,icon:qe,index:ge,sourceLayerIndex:se,geometry:be.geometry,properties:K.properties,type:sI[K.type],sortKey:st}),qe&&(L[qe.name]=!0),Pe){const Ue=_.evaluate(be,{},l).join(","),Ne=y.get("text-rotation-alignment")!=="viewport"&&y.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(x.ah.vertical)>=0;for(const et of Pe.sections)if(et.image)L[et.image.name]=!0;else{const Xe=ph(Pe.toString()),We=et.fontStack||Ue,Te=F[We]=F[We]||{};this.calculateGlyphDependencies(et.text,Te,Ne,this.allowVerticalPlacement,Xe)}}}y.get("symbol-placement")==="line"&&(this.features=function(K){const Q={},ge={},se=[];let fe=0;function be(Ue){se.push(K[Ue]),fe++}function Pe(Ue,Ne,et){const Xe=ge[Ue];return delete ge[Ue],ge[Ne]=Xe,se[Xe].geometry[0].pop(),se[Xe].geometry[0]=se[Xe].geometry[0].concat(et[0]),Xe}function qe(Ue,Ne,et){const Xe=Q[Ne];return delete Q[Ne],Q[Ue]=Xe,se[Xe].geometry[0].shift(),se[Xe].geometry[0]=et[0].concat(se[Xe].geometry[0]),Xe}function st(Ue,Ne,et){const Xe=et?Ne[0][Ne[0].length-1]:Ne[0][0];return`${Ue}:${Xe.x}:${Xe.y}`}for(let Ue=0;Ue<K.length;Ue++){const Ne=K[Ue],et=Ne.geometry,Xe=Ne.text?Ne.text.toString():null;if(!Xe){be(Ue);continue}const We=st(Xe,et),Te=st(Xe,et,!0);if(We in ge&&Te in Q&&ge[We]!==Q[Te]){const rt=qe(We,Te,et),Qe=Pe(We,Te,se[rt].geometry);delete Q[We],delete ge[Te],ge[st(Xe,se[Qe].geometry,!0)]=Qe,se[rt].geometry=null}else We in ge?Pe(We,Te,et):Te in Q?qe(We,Te,et):(be(Ue),Q[We]=fe-1,ge[Te]=fe-1)}return se.filter(Ue=>Ue.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((K,Q)=>K.sortKey-Q.sortKey)}update(n,o,l){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(n,o,this.layers,l),this.icon.programConfigurations.updatePaintArrays(n,o,this.layers,l))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(n){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(n),this.iconCollisionBox.upload(n)),this.text.upload(n,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(n,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(n,o){const l=this.lineVertexArray.length;if(n.segment!==void 0){let p=n.dist(o[n.segment+1]),y=n.dist(o[n.segment]);const _={};for(let b=n.segment+1;b<o.length;b++)_[b]={x:o[b].x,y:o[b].y,tileUnitDistanceFromAnchor:p},b<o.length-1&&(p+=o[b+1].dist(o[b]));for(let b=n.segment||0;b>=0;b--)_[b]={x:o[b].x,y:o[b].y,tileUnitDistanceFromAnchor:y},b>0&&(y+=o[b-1].dist(o[b]));for(let b=0;b<o.length;b++){const S=_[b];this.lineVertexArray.emplaceBack(S.x,S.y,S.tileUnitDistanceFromAnchor)}}return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}}addSymbols(n,o,l,p,y,_,b,S,k,I,A,L){const F=n.indexArray,$=n.layoutVertexArray,j=n.segments.prepareSegment(4*o.length,$,F,this.canOverlap?_.sortKey:void 0),K=this.glyphOffsetArray.length,Q=j.vertexLength,ge=this.allowVerticalPlacement&&b===x.ah.vertical?Math.PI/2:0,se=_.text&&_.text.sections;for(let fe=0;fe<o.length;fe++){const{tl:be,tr:Pe,bl:qe,br:st,tex:Ue,pixelOffsetTL:Ne,pixelOffsetBR:et,minFontScaleX:Xe,minFontScaleY:We,glyphOffset:Te,isSDF:rt,sectionIndex:Qe}=o[fe],ft=j.vertexLength,tr=Te[1];Bp($,S.x,S.y,be.x,tr+be.y,Ue.x,Ue.y,l,rt,Ne.x,Ne.y,Xe,We),Bp($,S.x,S.y,Pe.x,tr+Pe.y,Ue.x+Ue.w,Ue.y,l,rt,et.x,Ne.y,Xe,We),Bp($,S.x,S.y,qe.x,tr+qe.y,Ue.x,Ue.y+Ue.h,l,rt,Ne.x,et.y,Xe,We),Bp($,S.x,S.y,st.x,tr+st.y,Ue.x+Ue.w,Ue.y+Ue.h,l,rt,et.x,et.y,Xe,We),sy(n.dynamicLayoutVertexArray,S,ge),F.emplaceBack(ft,ft+1,ft+2),F.emplaceBack(ft+1,ft+2,ft+3),j.vertexLength+=4,j.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Te[0]),fe!==o.length-1&&Qe===o[fe+1].sectionIndex||n.programConfigurations.populatePaintArrays($.length,_,_.index,{},L,se&&se[Qe])}n.placedSymbolArray.emplaceBack(S.x,S.y,K,this.glyphOffsetArray.length-K,Q,k,I,S.segment,l?l[0]:0,l?l[1]:0,p[0],p[1],b,0,!1,0,A)}_addCollisionDebugVertex(n,o,l,p,y,_){return o.emplaceBack(0,0),n.emplaceBack(l.x,l.y,p,y,Math.round(_.x),Math.round(_.y))}addCollisionDebugVertices(n,o,l,p,y,_,b){const S=y.segments.prepareSegment(4,y.layoutVertexArray,y.indexArray),k=S.vertexLength,I=y.layoutVertexArray,A=y.collisionVertexArray,L=b.anchorX,F=b.anchorY;this._addCollisionDebugVertex(I,A,_,L,F,new U(n,o)),this._addCollisionDebugVertex(I,A,_,L,F,new U(l,o)),this._addCollisionDebugVertex(I,A,_,L,F,new U(l,p)),this._addCollisionDebugVertex(I,A,_,L,F,new U(n,p)),S.vertexLength+=4;const $=y.indexArray;$.emplaceBack(k,k+1),$.emplaceBack(k+1,k+2),$.emplaceBack(k+2,k+3),$.emplaceBack(k+3,k),S.primitiveLength+=4}addDebugCollisionBoxes(n,o,l,p){for(let y=n;y<o;y++){const _=this.collisionBoxArray.get(y);this.addCollisionDebugVertices(_.x1,_.y1,_.x2,_.y2,p?this.textCollisionBox:this.iconCollisionBox,_.anchorPoint,l)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new uy(xi,k1.members,ln),this.iconCollisionBox=new uy(xi,k1.members,ln);for(let n=0;n<this.symbolInstances.length;n++){const o=this.symbolInstances.get(n);this.addDebugCollisionBoxes(o.textBoxStartIndex,o.textBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.iconBoxStartIndex,o.iconBoxEndIndex,o,!1),this.addDebugCollisionBoxes(o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o,!1)}}_deserializeCollisionBoxesForSymbol(n,o,l,p,y,_,b,S,k){const I={};for(let A=o;A<l;A++){const L=n.get(A);I.textBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},I.textFeatureIndex=L.featureIndex;break}for(let A=p;A<y;A++){const L=n.get(A);I.verticalTextBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},I.verticalTextFeatureIndex=L.featureIndex;break}for(let A=_;A<b;A++){const L=n.get(A);I.iconBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},I.iconFeatureIndex=L.featureIndex;break}for(let A=S;A<k;A++){const L=n.get(A);I.verticalIconBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},I.verticalIconFeatureIndex=L.featureIndex;break}return I}deserializeCollisionBoxes(n){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const l=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(n,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(n,o){const l=n.placedSymbolArray.get(o),p=l.vertexStartIndex+4*l.numGlyphs;for(let y=l.vertexStartIndex;y<p;y+=4)n.indexArray.emplaceBack(y,y+1,y+2),n.indexArray.emplaceBack(y+1,y+2,y+3)}getSortedSymbolIndexes(n){if(this.sortedAngle===n&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(n),l=Math.cos(n),p=[],y=[],_=[];for(let b=0;b<this.symbolInstances.length;++b){_.push(b);const S=this.symbolInstances.get(b);p.push(0|Math.round(o*S.anchorX+l*S.anchorY)),y.push(S.featureIndex)}return _.sort((b,S)=>p[b]-p[S]||y[S]-y[b]),_}addToSortKeyRanges(n,o){const l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===o?l.symbolInstanceEnd=n+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:n,symbolInstanceEnd:n+1})}sortFeatures(n){if(this.sortFeaturesByY&&this.sortedAngle!==n&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(n),this.sortedAngle=n,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const l=this.symbolInstances.get(o);this.featureSortOrder.push(l.featureIndex),[l.rightJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.leftJustifiedTextSymbolIndex].forEach((p,y,_)=>{p>=0&&_.indexOf(p)===y&&this.addIndicesForPlacedSymbol(this.text,p)}),l.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,l.verticalPlacedTextSymbolIndex),l.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.placedIconSymbolIndex),l.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let q1,Z1;Ke("SymbolBucket",Lu,{omit:["layers","collisionBoxArray","features","compareText"]}),Lu.MAX_GLYPHS=65535,Lu.addDynamicAttributes=sy;var cy={get paint(){return Z1=Z1||new g({"icon-opacity":new ut(xe.paint_symbol["icon-opacity"]),"icon-color":new ut(xe.paint_symbol["icon-color"]),"icon-halo-color":new ut(xe.paint_symbol["icon-halo-color"]),"icon-halo-width":new ut(xe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ut(xe.paint_symbol["icon-halo-blur"]),"icon-translate":new Ye(xe.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ye(xe.paint_symbol["icon-translate-anchor"]),"text-opacity":new ut(xe.paint_symbol["text-opacity"]),"text-color":new ut(xe.paint_symbol["text-color"],{runtimeType:On,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new ut(xe.paint_symbol["text-halo-color"]),"text-halo-width":new ut(xe.paint_symbol["text-halo-width"]),"text-halo-blur":new ut(xe.paint_symbol["text-halo-blur"]),"text-translate":new Ye(xe.paint_symbol["text-translate"]),"text-translate-anchor":new Ye(xe.paint_symbol["text-translate-anchor"])})},get layout(){return q1=q1||new g({"symbol-placement":new Ye(xe.layout_symbol["symbol-placement"]),"symbol-spacing":new Ye(xe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ye(xe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ut(xe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ye(xe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ye(xe.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Ye(xe.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Ye(xe.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ye(xe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ye(xe.layout_symbol["icon-rotation-alignment"]),"icon-size":new ut(xe.layout_symbol["icon-size"]),"icon-text-fit":new Ye(xe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ye(xe.layout_symbol["icon-text-fit-padding"]),"icon-image":new ut(xe.layout_symbol["icon-image"]),"icon-rotate":new ut(xe.layout_symbol["icon-rotate"]),"icon-padding":new ut(xe.layout_symbol["icon-padding"]),"icon-keep-upright":new Ye(xe.layout_symbol["icon-keep-upright"]),"icon-offset":new ut(xe.layout_symbol["icon-offset"]),"icon-anchor":new ut(xe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ye(xe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ye(xe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ye(xe.layout_symbol["text-rotation-alignment"]),"text-field":new ut(xe.layout_symbol["text-field"]),"text-font":new ut(xe.layout_symbol["text-font"]),"text-size":new ut(xe.layout_symbol["text-size"]),"text-max-width":new ut(xe.layout_symbol["text-max-width"]),"text-line-height":new Ye(xe.layout_symbol["text-line-height"]),"text-letter-spacing":new ut(xe.layout_symbol["text-letter-spacing"]),"text-justify":new ut(xe.layout_symbol["text-justify"]),"text-radial-offset":new ut(xe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ye(xe.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new ut(xe.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new ut(xe.layout_symbol["text-anchor"]),"text-max-angle":new Ye(xe.layout_symbol["text-max-angle"]),"text-writing-mode":new Ye(xe.layout_symbol["text-writing-mode"]),"text-rotate":new ut(xe.layout_symbol["text-rotate"]),"text-padding":new Ye(xe.layout_symbol["text-padding"]),"text-keep-upright":new Ye(xe.layout_symbol["text-keep-upright"]),"text-transform":new ut(xe.layout_symbol["text-transform"]),"text-offset":new ut(xe.layout_symbol["text-offset"]),"text-allow-overlap":new Ye(xe.layout_symbol["text-allow-overlap"]),"text-overlap":new Ye(xe.layout_symbol["text-overlap"]),"text-ignore-placement":new Ye(xe.layout_symbol["text-ignore-placement"]),"text-optional":new Ye(xe.layout_symbol["text-optional"])})}};class G1{constructor(n){if(n.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=n.property.overrides?n.property.overrides.runtimeType:zi,this.defaultValue=n}evaluate(n){if(n.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(n.formattedSection))return o.getOverride(n.formattedSection)}return n.feature&&n.featureState?this.defaultValue.evaluate(n.feature,n.featureState):this.defaultValue.property.specification.default}eachChild(n){this.defaultValue.isConstant()||n(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ke("FormatSectionOverride",G1,{omit:["defaultValue"]});class Op extends s{constructor(n){super(n,cy)}recalculate(n,o){if(super.recalculate(n,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const l=this.layout.get("text-writing-mode");if(l){const p=[];for(const y of l)p.indexOf(y)<0&&p.push(y);this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(n,o,l,p){const y=this.layout.get(n).evaluate(o,{},l,p),_=this._unevaluatedLayout._values[n];return _.isDataDriven()||au(_.value)||!y?y:function(b,S){return S.replace(/{([^{}]+)}/g,(k,I)=>b&&I in b?String(b[I]):"")}(o.properties,y)}createBucket(n){return new Lu(n)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const n of cy.paint.overridableProperties){if(!Op.hasPaintOverride(this.layout,n))continue;const o=this.paint.get(n),l=new G1(o),p=new ou(l,o.property.specification);let y=null;y=o.value.kind==="constant"||o.value.kind==="source"?new is("source",p):new os("composite",p,o.value.zoomStops),this.paint._values[n]=new co(o.property,y,o.parameters)}}_handleOverridablePaintPropertyUpdate(n,o,l){return!(!this.layout||o.isDataDriven()||l.isDataDriven())&&Op.hasPaintOverride(this.layout,n)}static hasPaintOverride(n,o){const l=n.get("text-field"),p=cy.paint.properties[o];let y=!1;const _=b=>{for(const S of b)if(p.overrides&&p.overrides.hasOverride(S))return void(y=!0)};if(l.value.kind==="constant"&&l.value.value instanceof ei)_(l.value.value.sections);else if(l.value.kind==="source"){const b=k=>{y||(k instanceof Ri&&Nr(k.value)===zo?_(k.value.sections):k instanceof Xl?_(k.sections):k.eachChild(b))},S=l.value;S._styleExpression&&b(S._styleExpression.expression)}return y}}let H1;var cI={get paint(){return H1=H1||new g({"background-color":new Ye(xe.paint_background["background-color"]),"background-pattern":new vu(xe.paint_background["background-pattern"]),"background-opacity":new Ye(xe.paint_background["background-opacity"])})}};class hI extends s{constructor(n){super(n,cI)}}let W1;var dI={get paint(){return W1=W1||new g({"raster-opacity":new Ye(xe.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ye(xe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ye(xe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ye(xe.paint_raster["raster-brightness-max"]),"raster-saturation":new Ye(xe.paint_raster["raster-saturation"]),"raster-contrast":new Ye(xe.paint_raster["raster-contrast"]),"raster-resampling":new Ye(xe.paint_raster["raster-resampling"]),"raster-fade-duration":new Ye(xe.paint_raster["raster-fade-duration"])})}};class pI extends s{constructor(n){super(n,dI)}}class fI extends s{constructor(n){super(n,{}),this.onAdd=o=>{this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)},this.onRemove=o=>{this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)},this.implementation=n}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class mI{constructor(n){this._methodToThrottle=n,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const hy=63710088e-1;class Ss{constructor(n,o){if(isNaN(n)||isNaN(o))throw new Error(`Invalid LngLat object: (${n}, ${o})`);if(this.lng=+n,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Ss(Ee(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(n){const o=Math.PI/180,l=this.lat*o,p=n.lat*o,y=Math.sin(l)*Math.sin(p)+Math.cos(l)*Math.cos(p)*Math.cos((n.lng-this.lng)*o);return hy*Math.acos(Math.min(y,1))}static convert(n){if(n instanceof Ss)return n;if(Array.isArray(n)&&(n.length===2||n.length===3))return new Ss(Number(n[0]),Number(n[1]));if(!Array.isArray(n)&&typeof n=="object"&&n!==null)return new Ss(Number("lng"in n?n.lng:n.lon),Number(n.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const K1=2*Math.PI*hy;function X1(i){return K1*Math.cos(i*Math.PI/180)}function Y1(i){return(180+i)/360}function J1(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function Q1(i,n){return i/X1(n)}function dy(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}class zh{constructor(n,o,l=0){this.x=+n,this.y=+o,this.z=+l}static fromLngLat(n,o=0){const l=Ss.convert(n);return new zh(Y1(l.lng),J1(l.lat),Q1(o,l.lat))}toLngLat(){return new Ss(360*this.x-180,dy(this.y))}toAltitude(){return this.z*X1(dy(this.y))}meterInMercatorCoordinateUnits(){return 1/K1*(n=dy(this.y),1/Math.cos(n*Math.PI/180));var n}}function ex(i,n,o){var l=2*Math.PI*6378137/256/Math.pow(2,o);return[i*l-2*Math.PI*6378137/2,n*l-2*Math.PI*6378137/2]}class py{constructor(n,o,l){if(!function(p,y,_){return!(p<0||p>25||_<0||_>=Math.pow(2,p)||y<0||y>=Math.pow(2,p))}(n,o,l))throw new Error(`x=${o}, y=${l}, z=${n} outside of bounds. 0<=x<${Math.pow(2,n)}, 0<=y<${Math.pow(2,n)} 0<=z<=25 `);this.z=n,this.x=o,this.y=l,this.key=Lh(0,n,n,o,l)}equals(n){return this.z===n.z&&this.x===n.x&&this.y===n.y}url(n,o,l){const p=(_=this.y,b=this.z,S=ex(256*(y=this.x),256*(_=Math.pow(2,b)-_-1),b),k=ex(256*(y+1),256*(_+1),b),S[0]+","+S[1]+","+k[0]+","+k[1]);var y,_,b,S,k;const I=function(A,L,F){let $,j="";for(let K=A;K>0;K--)$=1<<K-1,j+=(L&$?1:0)+(F&$?2:0);return j}(this.z,this.x,this.y);return n[(this.x+this.y)%n.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(l==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,o>1?"@2x":"").replace(/{quadkey}/g,I).replace(/{bbox-epsg-3857}/g,p)}isChildOf(n){const o=this.z-n.z;return o>0&&n.x===this.x>>o&&n.y===this.y>>o}getTilePoint(n){const o=Math.pow(2,this.z);return new U((n.x*o-this.x)*$r,(n.y*o-this.y)*$r)}toString(){return`${this.z}/${this.x}/${this.y}`}}class tx{constructor(n,o){this.wrap=n,this.canonical=o,this.key=Lh(n,o.z,o.z,o.x,o.y)}}class ji{constructor(n,o,l,p,y){if(n<l)throw new Error(`overscaledZ should be >= z; overscaledZ = ${n}; z = ${l}`);this.overscaledZ=n,this.wrap=o,this.canonical=new py(l,+p,+y),this.key=Lh(o,n,l,p,y)}clone(){return new ji(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(n){return this.overscaledZ===n.overscaledZ&&this.wrap===n.wrap&&this.canonical.equals(n.canonical)}scaledTo(n){if(n>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${n}; overscaledZ = ${this.overscaledZ}`);const o=this.canonical.z-n;return n>this.canonical.z?new ji(n,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ji(n,this.wrap,n,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(n,o){if(n>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${n}; overscaledZ = ${this.overscaledZ}`);const l=this.canonical.z-n;return n>this.canonical.z?Lh(this.wrap*+o,n,this.canonical.z,this.canonical.x,this.canonical.y):Lh(this.wrap*+o,n,n,this.canonical.x>>l,this.canonical.y>>l)}isChildOf(n){if(n.wrap!==this.wrap)return!1;const o=this.canonical.z-n.canonical.z;return n.overscaledZ===0||n.overscaledZ<this.overscaledZ&&n.canonical.x===this.canonical.x>>o&&n.canonical.y===this.canonical.y>>o}children(n){if(this.overscaledZ>=n)return[new ji(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,l=2*this.canonical.x,p=2*this.canonical.y;return[new ji(o,this.wrap,o,l,p),new ji(o,this.wrap,o,l+1,p),new ji(o,this.wrap,o,l,p+1),new ji(o,this.wrap,o,l+1,p+1)]}isLessThan(n){return this.wrap<n.wrap||!(this.wrap>n.wrap)&&(this.overscaledZ<n.overscaledZ||!(this.overscaledZ>n.overscaledZ)&&(this.canonical.x<n.canonical.x||!(this.canonical.x>n.canonical.x)&&this.canonical.y<n.canonical.y))}wrapped(){return new ji(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(n){return new ji(this.overscaledZ,n,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new tx(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(n){return this.canonical.getTilePoint(new zh(n.x-this.wrap,n.y))}}function Lh(i,n,o,l,p){(i*=2)<0&&(i=-1*i-1);const y=1<<o;return(y*y*i+y*p+l).toString(36)+o.toString(36)+n.toString(36)}Ke("CanonicalTileID",py),Ke("OverscaledTileID",ji,{omit:["posMatrix"]});class rx{constructor(n,o,l,p=1,y=1,_=1,b=0){if(this.uid=n,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(l&&!["mapbox","terrarium","custom"].includes(l))return void It(`"${l}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=o.height;const S=this.dim=o.height-2;switch(this.data=new Uint32Array(o.data.buffer),l){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=p,this.greenFactor=y,this.blueFactor=_,this.baseShift=b;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let k=0;k<S;k++)this.data[this._idx(-1,k)]=this.data[this._idx(0,k)],this.data[this._idx(S,k)]=this.data[this._idx(S-1,k)],this.data[this._idx(k,-1)]=this.data[this._idx(k,0)],this.data[this._idx(k,S)]=this.data[this._idx(k,S-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(S,-1)]=this.data[this._idx(S-1,0)],this.data[this._idx(-1,S)]=this.data[this._idx(0,S-1)],this.data[this._idx(S,S)]=this.data[this._idx(S-1,S-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let k=0;k<S;k++)for(let I=0;I<S;I++){const A=this.get(k,I);A>this.max&&(this.max=A),A<this.min&&(this.min=A)}}get(n,o){const l=new Uint8Array(this.data.buffer),p=4*this._idx(n,o);return this.unpack(l[p],l[p+1],l[p+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(n,o){if(n<-1||n>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(n+1)}unpack(n,o,l){return n*this.redFactor+o*this.greenFactor+l*this.blueFactor-this.baseShift}getPixels(){return new Ui({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(n,o,l){if(this.dim!==n.dim)throw new Error("dem dimension mismatch");let p=o*this.dim,y=o*this.dim+this.dim,_=l*this.dim,b=l*this.dim+this.dim;switch(o){case-1:p=y-1;break;case 1:y=p+1}switch(l){case-1:_=b-1;break;case 1:b=_+1}const S=-o*this.dim,k=-l*this.dim;for(let I=_;I<b;I++)for(let A=p;A<y;A++)this.data[this._idx(A,I)]=n.data[this._idx(A+S,I+k)]}}Ke("DEMData",rx);class nx{constructor(n){this._stringToNumber={},this._numberToString=[];for(let o=0;o<n.length;o++){const l=n[o];this._stringToNumber[l]=o,this._numberToString[o]=l}}encode(n){return this._stringToNumber[n]}decode(n){if(n>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${n} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[n]}}class ix{constructor(n,o,l,p,y){this.type="Feature",this._vectorTileFeature=n,n._z=o,n._x=l,n._y=p,this.properties=n.properties,this.id=y}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(n){this._geometry=n}toJSON(){const n={geometry:this.geometry};for(const o in this)o!=="_geometry"&&o!=="_vectorTileFeature"&&(n[o]=this[o]);return n}}class ox{constructor(n,o){this.tileID=n,this.x=n.canonical.x,this.y=n.canonical.y,this.z=n.canonical.z,this.grid=new us($r,16,0),this.grid3D=new us($r,16,0),this.featureIndexArray=new kn,this.promoteId=o}insert(n,o,l,p,y,_){const b=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,p,y);const S=_?this.grid3D:this.grid;for(let k=0;k<o.length;k++){const I=o[k],A=[1/0,1/0,-1/0,-1/0];for(let L=0;L<I.length;L++){const F=I[L];A[0]=Math.min(A[0],F.x),A[1]=Math.min(A[1],F.y),A[2]=Math.max(A[2],F.x),A[3]=Math.max(A[3],F.y)}A[0]<$r&&A[1]<$r&&A[2]>=0&&A[3]>=0&&S.insert(b,A[0],A[1],A[2],A[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new xs.VectorTile(new ty(this.rawTileData)).layers,this.sourceLayerCoder=new nx(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(n,o,l,p){this.loadVTLayers();const y=n.params||{},_=$r/n.tileSize/n.scale,b=Jc(y.filter),S=n.queryGeometry,k=n.queryPadding*_,I=sx(S),A=this.grid.query(I.minX-k,I.minY-k,I.maxX+k,I.maxY+k),L=sx(n.cameraQueryGeometry),F=this.grid3D.query(L.minX-k,L.minY-k,L.maxX+k,L.maxY+k,(K,Q,ge,se)=>function(fe,be,Pe,qe,st){for(const Ne of fe)if(be<=Ne.x&&Pe<=Ne.y&&qe>=Ne.x&&st>=Ne.y)return!0;const Ue=[new U(be,Pe),new U(be,st),new U(qe,st),new U(qe,Pe)];if(fe.length>2){for(const Ne of Ue)if(ku(fe,Ne))return!0}for(let Ne=0;Ne<fe.length-1;Ne++)if(KC(fe[Ne],fe[Ne+1],Ue))return!0;return!1}(n.cameraQueryGeometry,K-k,Q-k,ge+k,se+k));for(const K of F)A.push(K);A.sort(gI);const $={};let j;for(let K=0;K<A.length;K++){const Q=A[K];if(Q===j)continue;j=Q;const ge=this.featureIndexArray.get(Q);let se=null;this.loadMatchingFeature($,ge.bucketIndex,ge.sourceLayerIndex,ge.featureIndex,b,y.layers,y.availableImages,o,l,p,(fe,be,Pe)=>(se||(se=gl(fe)),be.queryIntersectsFeature(S,fe,Pe,se,this.z,n.transform,_,n.pixelPosMatrix)))}return $}loadMatchingFeature(n,o,l,p,y,_,b,S,k,I,A){const L=this.bucketLayerIDs[o];if(_&&!function(K,Q){for(let ge=0;ge<K.length;ge++)if(Q.indexOf(K[ge])>=0)return!0;return!1}(_,L))return;const F=this.sourceLayerCoder.decode(l),$=this.vtLayers[F].feature(p);if(y.needGeometry){const K=yl($,!0);if(!y.filter(new cr(this.tileID.overscaledZ),K,this.tileID.canonical))return}else if(!y.filter(new cr(this.tileID.overscaledZ),$))return;const j=this.getId($,F);for(let K=0;K<L.length;K++){const Q=L[K];if(_&&_.indexOf(Q)<0)continue;const ge=S[Q];if(!ge)continue;let se={};j&&I&&(se=I.getState(ge.sourceLayer||"_geojsonTileLayer",j));const fe=ke({},k[Q]);fe.paint=ax(fe.paint,ge.paint,$,se,b),fe.layout=ax(fe.layout,ge.layout,$,se,b);const be=!A||A($,ge,se);if(!be)continue;const Pe=new ix($,this.z,this.x,this.y,j);Pe.layer=fe;let qe=n[Q];qe===void 0&&(qe=n[Q]=[]),qe.push({featureIndex:p,feature:Pe,intersectionZ:be})}}lookupSymbolFeatures(n,o,l,p,y,_,b,S){const k={};this.loadVTLayers();const I=Jc(y);for(const A of n)this.loadMatchingFeature(k,l,p,A,I,_,b,S,o);return k}hasLayer(n){for(const o of this.bucketLayerIDs)for(const l of o)if(n===l)return!0;return!1}getId(n,o){let l=n.id;return this.promoteId&&(l=n.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[o]],typeof l=="boolean"&&(l=Number(l))),l}}function ax(i,n,o,l,p){return mt(i,(y,_)=>{const b=n instanceof dl?n.get(_):null;return b&&b.evaluate?b.evaluate(o,l,p):b})}function sx(i){let n=1/0,o=1/0,l=-1/0,p=-1/0;for(const y of i)n=Math.min(n,y.x),o=Math.min(o,y.y),l=Math.max(l,y.x),p=Math.max(p,y.y);return{minX:n,minY:o,maxX:l,maxY:p}}function gI(i,n){return n-i}function lx(i,n,o,l,p){const y=[];for(let _=0;_<i.length;_++){const b=i[_];let S;for(let k=0;k<b.length-1;k++){let I=b[k],A=b[k+1];I.x<n&&A.x<n||(I.x<n?I=new U(n,I.y+(n-I.x)/(A.x-I.x)*(A.y-I.y))._round():A.x<n&&(A=new U(n,I.y+(n-I.x)/(A.x-I.x)*(A.y-I.y))._round()),I.y<o&&A.y<o||(I.y<o?I=new U(I.x+(o-I.y)/(A.y-I.y)*(A.x-I.x),o)._round():A.y<o&&(A=new U(I.x+(o-I.y)/(A.y-I.y)*(A.x-I.x),o)._round()),I.x>=l&&A.x>=l||(I.x>=l?I=new U(l,I.y+(l-I.x)/(A.x-I.x)*(A.y-I.y))._round():A.x>=l&&(A=new U(l,I.y+(l-I.x)/(A.x-I.x)*(A.y-I.y))._round()),I.y>=p&&A.y>=p||(I.y>=p?I=new U(I.x+(p-I.y)/(A.y-I.y)*(A.x-I.x),p)._round():A.y>=p&&(A=new U(I.x+(p-I.y)/(A.y-I.y)*(A.x-I.x),p)._round()),S&&I.equals(S[S.length-1])||(S=[I],y.push(S)),S.push(A)))))}}return y}Ke("FeatureIndex",ox,{omit:["rawTileData","sourceLayerCoder"]});class Ts extends U{constructor(n,o,l,p){super(n,o),this.angle=l,p!==void 0&&(this.segment=p)}clone(){return new Ts(this.x,this.y,this.angle,this.segment)}}function ux(i,n,o,l,p){if(n.segment===void 0||o===0)return!0;let y=n,_=n.segment+1,b=0;for(;b>-o/2;){if(_--,_<0)return!1;b-=i[_].dist(y),y=i[_]}b+=i[_].dist(i[_+1]),_++;const S=[];let k=0;for(;b<o/2;){const I=i[_],A=i[_+1];if(!A)return!1;let L=i[_-1].angleTo(I)-I.angleTo(A);for(L=Math.abs((L+3*Math.PI)%(2*Math.PI)-Math.PI),S.push({distance:b,angleDelta:L}),k+=L;b-S[0].distance>l;)k-=S.shift().angleDelta;if(k>p)return!1;_++,b+=I.dist(A)}return!0}function cx(i){let n=0;for(let o=0;o<i.length-1;o++)n+=i[o].dist(i[o+1]);return n}function hx(i,n,o){return i?.6*n*o:0}function dx(i,n){return Math.max(i?i.right-i.left:0,n?n.right-n.left:0)}function yI(i,n,o,l,p,y){const _=hx(o,p,y),b=dx(o,l)*y;let S=0;const k=cx(i)/2;for(let I=0;I<i.length-1;I++){const A=i[I],L=i[I+1],F=A.dist(L);if(S+F>k){const $=(k-S)/F,j=Nn.number(A.x,L.x,$),K=Nn.number(A.y,L.y,$),Q=new Ts(j,K,L.angleTo(A),I);return Q._round(),!_||ux(i,Q,b,_,n)?Q:void 0}S+=F}}function _I(i,n,o,l,p,y,_,b,S){const k=hx(l,y,_),I=dx(l,p),A=I*_,L=i[0].x===0||i[0].x===S||i[0].y===0||i[0].y===S;return n-A<n/4&&(n=A+n/4),px(i,L?n/2*b%n:(I/2+2*y)*_*b%n,n,k,o,A,L,!1,S)}function px(i,n,o,l,p,y,_,b,S){const k=y/2,I=cx(i);let A=0,L=n-o,F=[];for(let $=0;$<i.length-1;$++){const j=i[$],K=i[$+1],Q=j.dist(K),ge=K.angleTo(j);for(;L+o<A+Q;){L+=o;const se=(L-A)/Q,fe=Nn.number(j.x,K.x,se),be=Nn.number(j.y,K.y,se);if(fe>=0&&fe<S&&be>=0&&be<S&&L-k>=0&&L+k<=I){const Pe=new Ts(fe,be,ge,$);Pe._round(),l&&!ux(i,Pe,y,l,p)||F.push(Pe)}}A+=Q}return b||F.length||_||(F=px(i,A/2,o,l,p,y,_,!0,S)),F}Ke("Anchor",Ts);const Ru=ai;function fx(i,n,o,l){const p=[],y=i.image,_=y.pixelRatio,b=y.paddedRect.w-2*Ru,S=y.paddedRect.h-2*Ru;let k={x1:i.left,y1:i.top,x2:i.right,y2:i.bottom};const I=y.stretchX||[[0,b]],A=y.stretchY||[[0,S]],L=(Te,rt)=>Te+rt[1]-rt[0],F=I.reduce(L,0),$=A.reduce(L,0),j=b-F,K=S-$;let Q=0,ge=F,se=0,fe=$,be=0,Pe=j,qe=0,st=K;if(y.content&&l){const Te=y.content,rt=Te[2]-Te[0],Qe=Te[3]-Te[1];(y.textFitWidth||y.textFitHeight)&&(k=U1(i)),Q=Np(I,0,Te[0]),se=Np(A,0,Te[1]),ge=Np(I,Te[0],Te[2]),fe=Np(A,Te[1],Te[3]),be=Te[0]-Q,qe=Te[1]-se,Pe=rt-ge,st=Qe-fe}const Ue=k.x1,Ne=k.y1,et=k.x2-Ue,Xe=k.y2-Ne,We=(Te,rt,Qe,ft)=>{const tr=$p(Te.stretch-Q,ge,et,Ue),Jt=Up(Te.fixed-be,Pe,Te.stretch,F),Qr=$p(rt.stretch-se,fe,Xe,Ne),po=Up(rt.fixed-qe,st,rt.stretch,$),yn=$p(Qe.stretch-Q,ge,et,Ue),en=Up(Qe.fixed-be,Pe,Qe.stretch,F),Vn=$p(ft.stretch-se,fe,Xe,Ne),qn=Up(ft.fixed-qe,st,ft.stretch,$),Zn=new U(tr,Qr),Ir=new U(yn,Qr),tn=new U(yn,Vn),En=new U(tr,Vn),_n=new U(Jt/_,po/_),Gn=new U(en/_,qn/_),vn=n*Math.PI/180;if(vn){const Nt=Math.sin(vn),ar=Math.cos(vn),fr=[ar,-Nt,Nt,ar];Zn._matMult(fr),Ir._matMult(fr),En._matMult(fr),tn._matMult(fr)}const Vi=Te.stretch+Te.fixed,si=rt.stretch+rt.fixed;return{tl:Zn,tr:Ir,bl:En,br:tn,tex:{x:y.paddedRect.x+Ru+Vi,y:y.paddedRect.y+Ru+si,w:Qe.stretch+Qe.fixed-Vi,h:ft.stretch+ft.fixed-si},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:_n,pixelOffsetBR:Gn,minFontScaleX:Pe/_/et,minFontScaleY:st/_/Xe,isSDF:o}};if(l&&(y.stretchX||y.stretchY)){const Te=mx(I,j,F),rt=mx(A,K,$);for(let Qe=0;Qe<Te.length-1;Qe++){const ft=Te[Qe],tr=Te[Qe+1];for(let Jt=0;Jt<rt.length-1;Jt++)p.push(We(ft,rt[Jt],tr,rt[Jt+1]))}}else p.push(We({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:b+1},{fixed:0,stretch:S+1}));return p}function Np(i,n,o){let l=0;for(const p of i)l+=Math.max(n,Math.min(o,p[1]))-Math.max(n,Math.min(o,p[0]));return l}function mx(i,n,o){const l=[{fixed:-Ru,stretch:0}];for(const[p,y]of i){const _=l[l.length-1];l.push({fixed:p-_.stretch,stretch:_.stretch}),l.push({fixed:p-_.stretch,stretch:_.stretch+(y-p)})}return l.push({fixed:n+Ru,stretch:o}),l}function $p(i,n,o,l){return i/n*o+l}function Up(i,n,o,l){return i-n*o/l}class jp{constructor(n,o,l,p,y,_,b,S,k,I){var A;if(this.boxStartIndex=n.length,k){let L=_.top,F=_.bottom;const $=_.collisionPadding;$&&(L-=$[1],F+=$[3]);let j=F-L;j>0&&(j=Math.max(10,j),this.circleDiameter=j)}else{const L=!((A=_.image)===null||A===void 0)&&A.content&&(_.image.textFitWidth||_.image.textFitHeight)?U1(_):{x1:_.left,y1:_.top,x2:_.right,y2:_.bottom};L.y1=L.y1*b-S[0],L.y2=L.y2*b+S[2],L.x1=L.x1*b-S[3],L.x2=L.x2*b+S[1];const F=_.collisionPadding;if(F&&(L.x1-=F[0]*b,L.y1-=F[1]*b,L.x2+=F[2]*b,L.y2+=F[3]*b),I){const $=new U(L.x1,L.y1),j=new U(L.x2,L.y1),K=new U(L.x1,L.y2),Q=new U(L.x2,L.y2),ge=I*Math.PI/180;$._rotate(ge),j._rotate(ge),K._rotate(ge),Q._rotate(ge),L.x1=Math.min($.x,j.x,K.x,Q.x),L.x2=Math.max($.x,j.x,K.x,Q.x),L.y1=Math.min($.y,j.y,K.y,Q.y),L.y2=Math.max($.y,j.y,K.y,Q.y)}n.emplaceBack(o.x,o.y,L.x1,L.y1,L.x2,L.y2,l,p,y)}this.boxEndIndex=n.length}}class vI{constructor(n=[],o=(l,p)=>l<p?-1:l>p?1:0){if(this.data=n,this.length=this.data.length,this.compare=o,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(n){this.data.push(n),this._up(this.length++)}pop(){if(this.length===0)return;const n=this.data[0],o=this.data.pop();return--this.length>0&&(this.data[0]=o,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:o,compare:l}=this,p=o[n];for(;n>0;){const y=n-1>>1,_=o[y];if(l(p,_)>=0)break;o[n]=_,n=y}o[n]=p}_down(n){const{data:o,compare:l}=this,p=this.length>>1,y=o[n];for(;n<p;){let _=1+(n<<1);const b=_+1;if(b<this.length&&l(o[b],o[_])<0&&(_=b),l(o[_],y)>=0)break;o[n]=o[_],n=_}o[n]=y}}function xI(i,n=1,o=!1){let l=1/0,p=1/0,y=-1/0,_=-1/0;const b=i[0];for(let F=0;F<b.length;F++){const $=b[F];(!F||$.x<l)&&(l=$.x),(!F||$.y<p)&&(p=$.y),(!F||$.x>y)&&(y=$.x),(!F||$.y>_)&&(_=$.y)}const S=Math.min(y-l,_-p);let k=S/2;const I=new vI([],bI);if(S===0)return new U(l,p);for(let F=l;F<y;F+=S)for(let $=p;$<_;$+=S)I.push(new Du(F+k,$+k,k,i));let A=function(F){let $=0,j=0,K=0;const Q=F[0];for(let ge=0,se=Q.length,fe=se-1;ge<se;fe=ge++){const be=Q[ge],Pe=Q[fe],qe=be.x*Pe.y-Pe.x*be.y;j+=(be.x+Pe.x)*qe,K+=(be.y+Pe.y)*qe,$+=3*qe}return new Du(j/$,K/$,0,F)}(i),L=I.length;for(;I.length;){const F=I.pop();(F.d>A.d||!A.d)&&(A=F,o&&console.log("found best %d after %d probes",Math.round(1e4*F.d)/1e4,L)),F.max-A.d<=n||(k=F.h/2,I.push(new Du(F.p.x-k,F.p.y-k,k,i)),I.push(new Du(F.p.x+k,F.p.y-k,k,i)),I.push(new Du(F.p.x-k,F.p.y+k,k,i)),I.push(new Du(F.p.x+k,F.p.y+k,k,i)),L+=4)}return o&&(console.log(`num probes: ${L}`),console.log(`best distance: ${A.d}`)),A.p}function bI(i,n){return n.max-i.max}function Du(i,n,o,l){this.p=new U(i,n),this.h=o,this.d=function(p,y){let _=!1,b=1/0;for(let S=0;S<y.length;S++){const k=y[S];for(let I=0,A=k.length,L=A-1;I<A;L=I++){const F=k[I],$=k[L];F.y>p.y!=$.y>p.y&&p.x<($.x-F.x)*(p.y-F.y)/($.y-F.y)+F.x&&(_=!_),b=Math.min(b,Jv(p,F,$))}}return(_?1:-1)*Math.sqrt(b)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}var gn;x.aq=void 0,(gn=x.aq||(x.aq={}))[gn.center=1]="center",gn[gn.left=2]="left",gn[gn.right=3]="right",gn[gn.top=4]="top",gn[gn.bottom=5]="bottom",gn[gn["top-left"]=6]="top-left",gn[gn["top-right"]=7]="top-right",gn[gn["bottom-left"]=8]="bottom-left",gn[gn["bottom-right"]=9]="bottom-right";const Cs=7,fy=Number.POSITIVE_INFINITY;function gx(i,n){return n[1]!==fy?function(o,l,p){let y=0,_=0;switch(l=Math.abs(l),p=Math.abs(p),o){case"top-right":case"top-left":case"top":_=p-Cs;break;case"bottom-right":case"bottom-left":case"bottom":_=-p+Cs}switch(o){case"top-right":case"bottom-right":case"right":y=-l;break;case"top-left":case"bottom-left":case"left":y=l}return[y,_]}(i,n[0],n[1]):function(o,l){let p=0,y=0;l<0&&(l=0);const _=l/Math.SQRT2;switch(o){case"top-right":case"top-left":y=_-Cs;break;case"bottom-right":case"bottom-left":y=-_+Cs;break;case"bottom":y=-l+Cs;break;case"top":y=l-Cs}switch(o){case"top-right":case"bottom-right":p=-_;break;case"top-left":case"bottom-left":p=_;break;case"left":p=l;break;case"right":p=-l}return[p,y]}(i,n[0])}function yx(i,n,o){var l;const p=i.layout,y=(l=p.get("text-variable-anchor-offset"))===null||l===void 0?void 0:l.evaluate(n,{},o);if(y){const b=y.values,S=[];for(let k=0;k<b.length;k+=2){const I=S[k]=b[k],A=b[k+1].map(L=>L*Zr);I.startsWith("top")?A[1]-=Cs:I.startsWith("bottom")&&(A[1]+=Cs),S[k+1]=A}return new fi(S)}const _=p.get("text-variable-anchor");if(_){let b;b=i._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[p.get("text-radial-offset").evaluate(n,{},o)*Zr,fy]:p.get("text-offset").evaluate(n,{},o).map(k=>k*Zr);const S=[];for(const k of _)S.push(k,gx(k,b));return new fi(S)}return null}function my(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function wI(i,n,o,l,p,y,_,b,S,k,I){let A=y.textMaxSize.evaluate(n,{});A===void 0&&(A=_);const L=i.layers[0].layout,F=L.get("icon-offset").evaluate(n,{},I),$=vx(o.horizontal),j=_/24,K=i.tilePixelRatio*j,Q=i.tilePixelRatio*A/24,ge=i.tilePixelRatio*b,se=i.tilePixelRatio*L.get("symbol-spacing"),fe=L.get("text-padding")*i.tilePixelRatio,be=function(Te,rt,Qe,ft=1){const tr=Te.get("icon-padding").evaluate(rt,{},Qe),Jt=tr&&tr.values;return[Jt[0]*ft,Jt[1]*ft,Jt[2]*ft,Jt[3]*ft]}(L,n,I,i.tilePixelRatio),Pe=L.get("text-max-angle")/180*Math.PI,qe=L.get("text-rotation-alignment")!=="viewport"&&L.get("symbol-placement")!=="point",st=L.get("icon-rotation-alignment")==="map"&&L.get("symbol-placement")!=="point",Ue=L.get("symbol-placement"),Ne=se/2,et=L.get("icon-text-fit");let Xe;l&&et!=="none"&&(i.allowVerticalPlacement&&o.vertical&&(Xe=j1(l,o.vertical,et,L.get("icon-text-fit-padding"),F,j)),$&&(l=j1(l,$,et,L.get("icon-text-fit-padding"),F,j)));const We=(Te,rt)=>{rt.x<0||rt.x>=$r||rt.y<0||rt.y>=$r||function(Qe,ft,tr,Jt,Qr,po,yn,en,Vn,qn,Zn,Ir,tn,En,_n,Gn,vn,Vi,si,Nt,ar,fr,bi,br,Fu){const Qo=Qe.addToLineVertexArray(ft,tr);let ea,fo,qi,un,Ma=0,Fh=0,Sx=0,Tx=0,Sy=-1,Ty=-1;const za={};let Cx=wu("");if(Qe.allowVerticalPlacement&&Jt.vertical){const An=en.layout.get("text-rotate").evaluate(ar,{},br)+90;qi=new jp(Vn,ft,qn,Zn,Ir,Jt.vertical,tn,En,_n,An),yn&&(un=new jp(Vn,ft,qn,Zn,Ir,yn,vn,Vi,_n,An))}if(Qr){const An=en.layout.get("icon-rotate").evaluate(ar,{}),Zi=en.layout.get("icon-text-fit")!=="none",vl=fx(Qr,An,bi,Zi),Bo=yn?fx(yn,An,bi,Zi):void 0;fo=new jp(Vn,ft,qn,Zn,Ir,Qr,vn,Vi,!1,An),Ma=4*vl.length;const xl=Qe.iconSizeData;let ta=null;xl.kind==="source"?(ta=[Jo*en.layout.get("icon-size").evaluate(ar,{})],ta[0]>ws&&It(`${Qe.layerIds[0]}: Value for "icon-size" is >= ${Mh}. Reduce your "icon-size".`)):xl.kind==="composite"&&(ta=[Jo*fr.compositeIconSizes[0].evaluate(ar,{},br),Jo*fr.compositeIconSizes[1].evaluate(ar,{},br)],(ta[0]>ws||ta[1]>ws)&&It(`${Qe.layerIds[0]}: Value for "icon-size" is >= ${Mh}. Reduce your "icon-size".`)),Qe.addSymbols(Qe.icon,vl,ta,Nt,si,ar,x.ah.none,ft,Qo.lineStartIndex,Qo.lineLength,-1,br),Sy=Qe.icon.placedSymbolArray.length-1,Bo&&(Fh=4*Bo.length,Qe.addSymbols(Qe.icon,Bo,ta,Nt,si,ar,x.ah.vertical,ft,Qo.lineStartIndex,Qo.lineLength,-1,br),Ty=Qe.icon.placedSymbolArray.length-1)}const kx=Object.keys(Jt.horizontal);for(const An of kx){const Zi=Jt.horizontal[An];if(!ea){Cx=wu(Zi.text);const Bo=en.layout.get("text-rotate").evaluate(ar,{},br);ea=new jp(Vn,ft,qn,Zn,Ir,Zi,tn,En,_n,Bo)}const vl=Zi.positionedLines.length===1;if(Sx+=_x(Qe,ft,Zi,po,en,_n,ar,Gn,Qo,Jt.vertical?x.ah.horizontal:x.ah.horizontalOnly,vl?kx:[An],za,Sy,fr,br),vl)break}Jt.vertical&&(Tx+=_x(Qe,ft,Jt.vertical,po,en,_n,ar,Gn,Qo,x.ah.vertical,["vertical"],za,Ty,fr,br));const CI=ea?ea.boxStartIndex:Qe.collisionBoxArray.length,kI=ea?ea.boxEndIndex:Qe.collisionBoxArray.length,II=qi?qi.boxStartIndex:Qe.collisionBoxArray.length,EI=qi?qi.boxEndIndex:Qe.collisionBoxArray.length,AI=fo?fo.boxStartIndex:Qe.collisionBoxArray.length,PI=fo?fo.boxEndIndex:Qe.collisionBoxArray.length,MI=un?un.boxStartIndex:Qe.collisionBoxArray.length,zI=un?un.boxEndIndex:Qe.collisionBoxArray.length;let Fo=-1;const qp=(An,Zi)=>An&&An.circleDiameter?Math.max(An.circleDiameter,Zi):Zi;Fo=qp(ea,Fo),Fo=qp(qi,Fo),Fo=qp(fo,Fo),Fo=qp(un,Fo);const Ix=Fo>-1?1:0;Ix&&(Fo*=Fu/Zr),Qe.glyphOffsetArray.length>=Lu.MAX_GLYPHS&&It("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),ar.sortKey!==void 0&&Qe.addToSortKeyRanges(Qe.symbolInstances.length,ar.sortKey);const LI=yx(en,ar,br),[RI,DI]=function(An,Zi){const vl=An.length,Bo=Zi==null?void 0:Zi.values;if((Bo==null?void 0:Bo.length)>0)for(let xl=0;xl<Bo.length;xl+=2){const ta=Bo[xl+1];An.emplaceBack(x.aq[Bo[xl]],ta[0],ta[1])}return[vl,An.length]}(Qe.textAnchorOffsets,LI);Qe.symbolInstances.emplaceBack(ft.x,ft.y,za.right>=0?za.right:-1,za.center>=0?za.center:-1,za.left>=0?za.left:-1,za.vertical||-1,Sy,Ty,Cx,CI,kI,II,EI,AI,PI,MI,zI,qn,Sx,Tx,Ma,Fh,Ix,0,tn,Fo,RI,DI)}(i,rt,Te,o,l,p,Xe,i.layers[0],i.collisionBoxArray,n.index,n.sourceLayerIndex,i.index,K,[fe,fe,fe,fe],qe,S,ge,be,st,F,n,y,k,I,_)};if(Ue==="line")for(const Te of lx(n.geometry,0,0,$r,$r)){const rt=_I(Te,se,Pe,o.vertical||$,l,24,Q,i.overscaling,$r);for(const Qe of rt)$&&SI(i,$.text,Ne,Qe)||We(Te,Qe)}else if(Ue==="line-center"){for(const Te of n.geometry)if(Te.length>1){const rt=yI(Te,Pe,o.vertical||$,l,24,Q);rt&&We(Te,rt)}}else if(n.type==="Polygon")for(const Te of Jl(n.geometry,0)){const rt=xI(Te,16);We(Te[0],new Ts(rt.x,rt.y,0))}else if(n.type==="LineString")for(const Te of n.geometry)We(Te,new Ts(Te[0].x,Te[0].y,0));else if(n.type==="Point")for(const Te of n.geometry)for(const rt of Te)We([rt],new Ts(rt.x,rt.y,0))}function _x(i,n,o,l,p,y,_,b,S,k,I,A,L,F,$){const j=function(ge,se,fe,be,Pe,qe,st,Ue){const Ne=be.layout.get("text-rotate").evaluate(qe,{})*Math.PI/180,et=[];for(const Xe of se.positionedLines)for(const We of Xe.positionedGlyphs){if(!We.rect)continue;const Te=We.rect||{};let rt=R1+1,Qe=!0,ft=1,tr=0;const Jt=(Pe||Ue)&&We.vertical,Qr=We.metrics.advance*We.scale/2;if(Ue&&se.verticalizable&&(tr=Xe.lineOffset/2-(We.imageName?-(Zr-We.metrics.width*We.scale)/2:(We.scale-1)*Zr)),We.imageName){const Nt=st[We.imageName];Qe=Nt.sdf,ft=Nt.pixelRatio,rt=ai/ft}const po=Pe?[We.x+Qr,We.y]:[0,0];let yn=Pe?[0,0]:[We.x+Qr+fe[0],We.y+fe[1]-tr],en=[0,0];Jt&&(en=yn,yn=[0,0]);const Vn=We.metrics.isDoubleResolution?2:1,qn=(We.metrics.left-rt)*We.scale-Qr+yn[0],Zn=(-We.metrics.top-rt)*We.scale+yn[1],Ir=qn+Te.w/Vn*We.scale/ft,tn=Zn+Te.h/Vn*We.scale/ft,En=new U(qn,Zn),_n=new U(Ir,Zn),Gn=new U(qn,tn),vn=new U(Ir,tn);if(Jt){const Nt=new U(-Qr,Qr-Ah),ar=-Math.PI/2,fr=Zr/2-Qr,bi=new U(5-Ah-fr,-(We.imageName?fr:0)),br=new U(...en);En._rotateAround(ar,Nt)._add(bi)._add(br),_n._rotateAround(ar,Nt)._add(bi)._add(br),Gn._rotateAround(ar,Nt)._add(bi)._add(br),vn._rotateAround(ar,Nt)._add(bi)._add(br)}if(Ne){const Nt=Math.sin(Ne),ar=Math.cos(Ne),fr=[ar,-Nt,Nt,ar];En._matMult(fr),_n._matMult(fr),Gn._matMult(fr),vn._matMult(fr)}const Vi=new U(0,0),si=new U(0,0);et.push({tl:En,tr:_n,bl:Gn,br:vn,tex:Te,writingMode:se.writingMode,glyphOffset:po,sectionIndex:We.sectionIndex,isSDF:Qe,pixelOffsetTL:Vi,pixelOffsetBR:si,minFontScaleX:0,minFontScaleY:0})}return et}(0,o,b,p,y,_,l,i.allowVerticalPlacement),K=i.textSizeData;let Q=null;K.kind==="source"?(Q=[Jo*p.layout.get("text-size").evaluate(_,{})],Q[0]>ws&&It(`${i.layerIds[0]}: Value for "text-size" is >= ${Mh}. Reduce your "text-size".`)):K.kind==="composite"&&(Q=[Jo*F.compositeTextSizes[0].evaluate(_,{},$),Jo*F.compositeTextSizes[1].evaluate(_,{},$)],(Q[0]>ws||Q[1]>ws)&&It(`${i.layerIds[0]}: Value for "text-size" is >= ${Mh}. Reduce your "text-size".`)),i.addSymbols(i.text,j,Q,b,y,_,k,n,S.lineStartIndex,S.lineLength,L,$);for(const ge of I)A[ge]=i.text.placedSymbolArray.length-1;return 4*j.length}function vx(i){for(const n in i)return i[n];return null}function SI(i,n,o,l){const p=i.compareText;if(n in p){const y=p[n];for(let _=y.length-1;_>=0;_--)if(l.dist(y[_])<o)return!0}else p[n]=[];return p[n].push(l),!1}const xx=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class gy{static from(n){if(!(n instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[o,l]=new Uint8Array(n,0,2);if(o!==219)throw new Error("Data does not appear to be in a KDBush format.");const p=l>>4;if(p!==1)throw new Error(`Got v${p} data when expected v1.`);const y=xx[15&l];if(!y)throw new Error("Unrecognized array type.");const[_]=new Uint16Array(n,2,1),[b]=new Uint32Array(n,4,1);return new gy(b,_,y,n)}constructor(n,o=64,l=Float64Array,p){if(isNaN(n)||n<0)throw new Error(`Unpexpected numItems value: ${n}.`);this.numItems=+n,this.nodeSize=Math.min(Math.max(+o,2),65535),this.ArrayType=l,this.IndexArrayType=n<65536?Uint16Array:Uint32Array;const y=xx.indexOf(this.ArrayType),_=2*n*this.ArrayType.BYTES_PER_ELEMENT,b=n*this.IndexArrayType.BYTES_PER_ELEMENT,S=(8-b%8)%8;if(y<0)throw new Error(`Unexpected typed array class: ${l}.`);p&&p instanceof ArrayBuffer?(this.data=p,this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+b+S,2*n),this._pos=2*n,this._finished=!0):(this.data=new ArrayBuffer(8+_+b+S),this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+b+S,2*n),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+y]),new Uint16Array(this.data,2,1)[0]=o,new Uint32Array(this.data,4,1)[0]=n)}add(n,o){const l=this._pos>>1;return this.ids[l]=l,this.coords[this._pos++]=n,this.coords[this._pos++]=o,l}finish(){const n=this._pos>>1;if(n!==this.numItems)throw new Error(`Added ${n} items when expected ${this.numItems}.`);return yy(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(n,o,l,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:y,coords:_,nodeSize:b}=this,S=[0,y.length-1,0],k=[];for(;S.length;){const I=S.pop()||0,A=S.pop()||0,L=S.pop()||0;if(A-L<=b){for(let K=L;K<=A;K++){const Q=_[2*K],ge=_[2*K+1];Q>=n&&Q<=l&&ge>=o&&ge<=p&&k.push(y[K])}continue}const F=L+A>>1,$=_[2*F],j=_[2*F+1];$>=n&&$<=l&&j>=o&&j<=p&&k.push(y[F]),(I===0?n<=$:o<=j)&&(S.push(L),S.push(F-1),S.push(1-I)),(I===0?l>=$:p>=j)&&(S.push(F+1),S.push(A),S.push(1-I))}return k}within(n,o,l){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:p,coords:y,nodeSize:_}=this,b=[0,p.length-1,0],S=[],k=l*l;for(;b.length;){const I=b.pop()||0,A=b.pop()||0,L=b.pop()||0;if(A-L<=_){for(let K=L;K<=A;K++)wx(y[2*K],y[2*K+1],n,o)<=k&&S.push(p[K]);continue}const F=L+A>>1,$=y[2*F],j=y[2*F+1];wx($,j,n,o)<=k&&S.push(p[F]),(I===0?n-l<=$:o-l<=j)&&(b.push(L),b.push(F-1),b.push(1-I)),(I===0?n+l>=$:o+l>=j)&&(b.push(F+1),b.push(A),b.push(1-I))}return S}}function yy(i,n,o,l,p,y){if(p-l<=o)return;const _=l+p>>1;bx(i,n,_,l,p,y),yy(i,n,o,l,_-1,1-y),yy(i,n,o,_+1,p,1-y)}function bx(i,n,o,l,p,y){for(;p>l;){if(p-l>600){const k=p-l+1,I=o-l+1,A=Math.log(k),L=.5*Math.exp(2*A/3),F=.5*Math.sqrt(A*L*(k-L)/k)*(I-k/2<0?-1:1);bx(i,n,o,Math.max(l,Math.floor(o-I*L/k+F)),Math.min(p,Math.floor(o+(k-I)*L/k+F)),y)}const _=n[2*o+y];let b=l,S=p;for(Rh(i,n,l,o),n[2*p+y]>_&&Rh(i,n,l,p);b<S;){for(Rh(i,n,b,S),b++,S--;n[2*b+y]<_;)b++;for(;n[2*S+y]>_;)S--}n[2*l+y]===_?Rh(i,n,l,S):(S++,Rh(i,n,S,p)),S<=o&&(l=S+1),o<=S&&(p=S-1)}}function Rh(i,n,o,l){_y(i,o,l),_y(n,2*o,2*l),_y(n,2*o+1,2*l+1)}function _y(i,n,o){const l=i[n];i[n]=i[o],i[o]=l}function wx(i,n,o,l){const p=i-o,y=n-l;return p*p+y*y}var vy;x.bg=void 0,(vy=x.bg||(x.bg={})).create="create",vy.load="load",vy.fullLoad="fullLoad";let Vp=null,Dh=[];const xy=1e3/60,by="loadTime",wy="fullLoadTime",TI={mark(i){performance.mark(i)},frame(i){const n=i;Vp!=null&&Dh.push(n-Vp),Vp=n},clearMetrics(){Vp=null,Dh=[],performance.clearMeasures(by),performance.clearMeasures(wy);for(const i in x.bg)performance.clearMarks(x.bg[i])},getPerformanceMetrics(){performance.measure(by,x.bg.create,x.bg.load),performance.measure(wy,x.bg.create,x.bg.fullLoad);const i=performance.getEntriesByName(by)[0].duration,n=performance.getEntriesByName(wy)[0].duration,o=Dh.length,l=1/(Dh.reduce((y,_)=>y+_,0)/o/1e3),p=Dh.filter(y=>y>xy).reduce((y,_)=>y+(_-xy)/xy,0);return{loadTime:i,fullLoadTime:n,fps:l,percentDroppedFrames:p/(o+p)*100,totalFrames:o}}};x.$=class extends P{},x.A=Iu,x.B=Pg,x.C=function(i){if(Tr==null){const n=i.navigator?i.navigator.userAgent:null;Tr=!!i.safari||!(!n||!(/\b(iPad|iPhone|iPod)\b/.test(n)||n.match("Safari")&&!n.match("Chrome")))}return Tr},x.D=Ye,x.E=Zo,x.F=class{constructor(i,n){this.target=i,this.mapId=n,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new mI(()=>this.process()),this.subscription=function(o,l,p,y){return o.addEventListener(l,p,!1),{unsubscribe:()=>{o.removeEventListener(l,p,!1)}}}(this.target,"message",o=>this.receive(o)),this.globalScope=Pr(self)?i:window}registerMessageHandler(i,n){this.messageHandlers[i]=n}sendAsync(i,n){return new Promise((o,l)=>{const p=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[p]={resolve:o,reject:l},n&&n.signal.addEventListener("abort",()=>{delete this.resolveRejects[p];const b={id:p,type:"<cancel>",origin:location.origin,targetMapId:i.targetMapId,sourceMapId:this.mapId};this.target.postMessage(b)},{once:!0});const y=[],_=Object.assign(Object.assign({},i),{id:p,sourceMapId:this.mapId,origin:location.origin,data:cs(i.data,y)});this.target.postMessage(_,{transfer:y})})}receive(i){const n=i.data,o=n.id;if(!(n.origin!=="file://"&&location.origin!=="file://"&&n.origin!=="resource://android"&&location.origin!=="resource://android"&&n.origin!==location.origin||n.targetMapId&&this.mapId!==n.targetMapId)){if(n.type==="<cancel>"){delete this.tasks[o];const l=this.abortControllers[o];return delete this.abortControllers[o],void(l&&l.abort())}if(Pr(self)||n.mustQueue)return this.tasks[o]=n,this.taskQueue.push(o),void this.invoker.trigger();this.processTask(o,n)}}process(){if(this.taskQueue.length===0)return;const i=this.taskQueue.shift(),n=this.tasks[i];delete this.tasks[i],this.taskQueue.length>0&&this.invoker.trigger(),n&&this.processTask(i,n)}processTask(i,n){return h(this,void 0,void 0,function*(){if(n.type==="<response>"){const p=this.resolveRejects[i];return delete this.resolveRejects[i],p?void(n.error?p.reject(hs(n.error)):p.resolve(hs(n.data))):void 0}if(!this.messageHandlers[n.type])return void this.completeTask(i,new Error(`Could not find a registered handler for ${n.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const o=hs(n.data),l=new AbortController;this.abortControllers[i]=l;try{const p=yield this.messageHandlers[n.type](n.sourceMapId,o,l);this.completeTask(i,null,p)}catch(p){this.completeTask(i,p)}})}completeTask(i,n,o){const l=[];delete this.abortControllers[i];const p={id:i,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:n?cs(n):null,data:cs(o,l)};this.target.postMessage(p,{transfer:l})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},x.G=Kr,x.H=function(){var i=new Iu(16);return Iu!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},x.I=ny,x.J=function(i,n,o){var l,p,y,_,b,S,k,I,A,L,F,$,j=o[0],K=o[1],Q=o[2];return n===i?(i[12]=n[0]*j+n[4]*K+n[8]*Q+n[12],i[13]=n[1]*j+n[5]*K+n[9]*Q+n[13],i[14]=n[2]*j+n[6]*K+n[10]*Q+n[14],i[15]=n[3]*j+n[7]*K+n[11]*Q+n[15]):(p=n[1],y=n[2],_=n[3],b=n[4],S=n[5],k=n[6],I=n[7],A=n[8],L=n[9],F=n[10],$=n[11],i[0]=l=n[0],i[1]=p,i[2]=y,i[3]=_,i[4]=b,i[5]=S,i[6]=k,i[7]=I,i[8]=A,i[9]=L,i[10]=F,i[11]=$,i[12]=l*j+b*K+A*Q+n[12],i[13]=p*j+S*K+L*Q+n[13],i[14]=y*j+k*K+F*Q+n[14],i[15]=_*j+I*K+$*Q+n[15]),i},x.K=function(i,n,o){var l=o[0],p=o[1],y=o[2];return i[0]=n[0]*l,i[1]=n[1]*l,i[2]=n[2]*l,i[3]=n[3]*l,i[4]=n[4]*p,i[5]=n[5]*p,i[6]=n[6]*p,i[7]=n[7]*p,i[8]=n[8]*y,i[9]=n[9]*y,i[10]=n[10]*y,i[11]=n[11]*y,i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],i},x.L=r1,x.M=function(i,n){const o={};for(let l=0;l<n.length;l++){const p=n[l];p in i&&(o[p]=i[p])}return o},x.N=Ss,x.O=Y1,x.P=U,x.Q=J1,x.R=Ui,x.S=ji,x.T=yu,x.U=te,x.V=H,x.W=gt,x.X=$r,x.Y=w,x.Z=zh,x._=h,x.a=_r,x.a$=function(i,n){var o=i[0],l=i[1],p=i[2],y=i[3],_=i[4],b=i[5],S=i[6],k=i[7],I=i[8],A=i[9],L=i[10],F=i[11],$=i[12],j=i[13],K=i[14],Q=i[15],ge=n[0],se=n[1],fe=n[2],be=n[3],Pe=n[4],qe=n[5],st=n[6],Ue=n[7],Ne=n[8],et=n[9],Xe=n[10],We=n[11],Te=n[12],rt=n[13],Qe=n[14],ft=n[15];return Math.abs(o-ge)<=jn*Math.max(1,Math.abs(o),Math.abs(ge))&&Math.abs(l-se)<=jn*Math.max(1,Math.abs(l),Math.abs(se))&&Math.abs(p-fe)<=jn*Math.max(1,Math.abs(p),Math.abs(fe))&&Math.abs(y-be)<=jn*Math.max(1,Math.abs(y),Math.abs(be))&&Math.abs(_-Pe)<=jn*Math.max(1,Math.abs(_),Math.abs(Pe))&&Math.abs(b-qe)<=jn*Math.max(1,Math.abs(b),Math.abs(qe))&&Math.abs(S-st)<=jn*Math.max(1,Math.abs(S),Math.abs(st))&&Math.abs(k-Ue)<=jn*Math.max(1,Math.abs(k),Math.abs(Ue))&&Math.abs(I-Ne)<=jn*Math.max(1,Math.abs(I),Math.abs(Ne))&&Math.abs(A-et)<=jn*Math.max(1,Math.abs(A),Math.abs(et))&&Math.abs(L-Xe)<=jn*Math.max(1,Math.abs(L),Math.abs(Xe))&&Math.abs(F-We)<=jn*Math.max(1,Math.abs(F),Math.abs(We))&&Math.abs($-Te)<=jn*Math.max(1,Math.abs($),Math.abs(Te))&&Math.abs(j-rt)<=jn*Math.max(1,Math.abs(j),Math.abs(rt))&&Math.abs(K-Qe)<=jn*Math.max(1,Math.abs(K),Math.abs(Qe))&&Math.abs(Q-ft)<=jn*Math.max(1,Math.abs(Q),Math.abs(ft))},x.a0=zt,x.a1=py,x.a2=ze,x.a3=i=>{const n=window.document.createElement("video");return n.muted=!0,new Promise(o=>{n.onloadstart=()=>{o(n)};for(const l of i){const p=window.document.createElement("source");Ao(l)||(n.crossOrigin="Anonymous"),p.src=l,n.appendChild(p)}})},x.a4=function(){return Ze++},x.a5=je,x.a6=Lu,x.a7=Jc,x.a8=yl,x.a9=ix,x.aA=function(i){if(i.type==="custom")return new fI(i);switch(i.type){case"background":return new hI(i);case"circle":return new JC(i);case"fill":return new mk(i);case"fill-extrusion":return new Pk(i);case"heatmap":return new ek(i);case"hillshade":return new rk(i);case"line":return new Ok(i);case"raster":return new pI(i);case"symbol":return new Op(i)}},x.aB=ot,x.aC=function(i,n){if(!i)return[{command:"setStyle",args:[n]}];let o=[];try{if(!Lt(i.version,n.version))return[{command:"setStyle",args:[n]}];Lt(i.center,n.center)||o.push({command:"setCenter",args:[n.center]}),Lt(i.zoom,n.zoom)||o.push({command:"setZoom",args:[n.zoom]}),Lt(i.bearing,n.bearing)||o.push({command:"setBearing",args:[n.bearing]}),Lt(i.pitch,n.pitch)||o.push({command:"setPitch",args:[n.pitch]}),Lt(i.sprite,n.sprite)||o.push({command:"setSprite",args:[n.sprite]}),Lt(i.glyphs,n.glyphs)||o.push({command:"setGlyphs",args:[n.glyphs]}),Lt(i.transition,n.transition)||o.push({command:"setTransition",args:[n.transition]}),Lt(i.light,n.light)||o.push({command:"setLight",args:[n.light]}),Lt(i.terrain,n.terrain)||o.push({command:"setTerrain",args:[n.terrain]}),Lt(i.sky,n.sky)||o.push({command:"setSky",args:[n.sky]}),Lt(i.projection,n.projection)||o.push({command:"setProjection",args:[n.projection]});const l={},p=[];(function(_,b,S,k){let I;for(I in b=b||{},_=_||{})Object.prototype.hasOwnProperty.call(_,I)&&(Object.prototype.hasOwnProperty.call(b,I)||oo(I,S,k));for(I in b)Object.prototype.hasOwnProperty.call(b,I)&&(Object.prototype.hasOwnProperty.call(_,I)?Lt(_[I],b[I])||(_[I].type==="geojson"&&b[I].type==="geojson"&&Mi(_,b,I)?ir(S,{command:"setGeoJSONSourceData",args:[I,b[I].data]}):Pi(I,b,S,k)):Mo(I,b,S))})(i.sources,n.sources,p,l);const y=[];i.layers&&i.layers.forEach(_=>{"source"in _&&l[_.source]?o.push({command:"removeLayer",args:[_.id]}):y.push(_)}),o=o.concat(p),function(_,b,S){b=b||[];const k=(_=_||[]).map(ma),I=b.map(ma),A=_.reduce(Go,{}),L=b.reduce(Go,{}),F=k.slice(),$=Object.create(null);let j,K,Q,ge,se;for(let fe=0,be=0;fe<k.length;fe++)j=k[fe],Object.prototype.hasOwnProperty.call(L,j)?be++:(ir(S,{command:"removeLayer",args:[j]}),F.splice(F.indexOf(j,be),1));for(let fe=0,be=0;fe<I.length;fe++)j=I[I.length-1-fe],F[F.length-1-fe]!==j&&(Object.prototype.hasOwnProperty.call(A,j)?(ir(S,{command:"removeLayer",args:[j]}),F.splice(F.lastIndexOf(j,F.length-be),1)):be++,ge=F[F.length-fe],ir(S,{command:"addLayer",args:[L[j],ge]}),F.splice(F.length-fe,0,j),$[j]=!0);for(let fe=0;fe<I.length;fe++)if(j=I[fe],K=A[j],Q=L[j],!$[j]&&!Lt(K,Q))if(Lt(K.source,Q.source)&&Lt(K["source-layer"],Q["source-layer"])&&Lt(K.type,Q.type)){for(se in Xr(K.layout,Q.layout,S,j,null,"setLayoutProperty"),Xr(K.paint,Q.paint,S,j,null,"setPaintProperty"),Lt(K.filter,Q.filter)||ir(S,{command:"setFilter",args:[j,Q.filter]}),Lt(K.minzoom,Q.minzoom)&&Lt(K.maxzoom,Q.maxzoom)||ir(S,{command:"setLayerZoomRange",args:[j,Q.minzoom,Q.maxzoom]}),K)Object.prototype.hasOwnProperty.call(K,se)&&se!=="layout"&&se!=="paint"&&se!=="filter"&&se!=="metadata"&&se!=="minzoom"&&se!=="maxzoom"&&(se.indexOf("paint.")===0?Xr(K[se],Q[se],S,j,se.slice(6),"setPaintProperty"):Lt(K[se],Q[se])||ir(S,{command:"setLayerProperty",args:[j,se,Q[se]]}));for(se in Q)Object.prototype.hasOwnProperty.call(Q,se)&&!Object.prototype.hasOwnProperty.call(K,se)&&se!=="layout"&&se!=="paint"&&se!=="filter"&&se!=="metadata"&&se!=="minzoom"&&se!=="maxzoom"&&(se.indexOf("paint.")===0?Xr(K[se],Q[se],S,j,se.slice(6),"setPaintProperty"):Lt(K[se],Q[se])||ir(S,{command:"setLayerProperty",args:[j,se,Q[se]]}))}else ir(S,{command:"removeLayer",args:[j]}),ge=F[F.lastIndexOf(j)+1],ir(S,{command:"addLayer",args:[Q,ge]})}(y,n.layers,o)}catch(l){console.warn("Unable to compute style diff:",l),o=[{command:"setStyle",args:[n]}]}return o},x.aD=function(i){const n=[],o=i.id;return o===void 0&&n.push({message:`layers.${o}: missing required property "id"`}),i.render===void 0&&n.push({message:`layers.${o}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&n.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),n},x.aE=function i(n,o){if(Array.isArray(n)){if(!Array.isArray(o)||n.length!==o.length)return!1;for(let l=0;l<n.length;l++)if(!i(n[l],o[l]))return!1;return!0}if(typeof n=="object"&&n!==null&&o!==null){if(typeof o!="object"||Object.keys(n).length!==Object.keys(o).length)return!1;for(const l in n)if(!i(n[l],o[l]))return!1;return!0}return n===o},x.aF=mt,x.aG=tt,x.aH=class extends fl{constructor(i,n){super(i,n),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},x.aI=Cp,x.aJ=class extends fl{constructor(i,n){super(i,n),this.current=qC}set(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let n=1;n<16;n++)if(i[n]!==this.current[n]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}},x.aK=Zv,x.aL=Gv,x.aM=Wt,x.aN=class extends fl{constructor(i,n){super(i,n),this.current=[0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))}},x.aO=class extends fl{constructor(i,n){super(i,n),this.current=[0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))}},x.aP=function(i,n,o,l,p,y,_){var b=1/(n-o),S=1/(l-p),k=1/(y-_);return i[0]=-2*b,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*S,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*k,i[11]=0,i[12]=(n+o)*b,i[13]=(p+l)*S,i[14]=(_+y)*k,i[15]=1,i},x.aQ=YC,x.aR=class extends ue{},x.aS=jk,x.aT=class extends ye{},x.aU=Zg,x.aV=function(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))},x.aW=s1,x.aX=fn,x.aY=$i,x.aZ=class extends Je{},x.a_=function(i,n){return i[0]===n[0]&&i[1]===n[1]&&i[2]===n[2]&&i[3]===n[3]&&i[4]===n[4]&&i[5]===n[5]&&i[6]===n[6]&&i[7]===n[7]&&i[8]===n[8]&&i[9]===n[9]&&i[10]===n[10]&&i[11]===n[11]&&i[12]===n[12]&&i[13]===n[13]&&i[14]===n[14]&&i[15]===n[15]},x.aa=function(i){const n={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,l,p,y)=>{const _=p||y;return n[l]=!_||_.toLowerCase(),""}),n["max-age"]){const o=parseInt(n["max-age"],10);isNaN(o)?delete n["max-age"]:n["max-age"]=o}return n},x.ab=function(i,n){const o=[];for(const l in i)l in n||o.push(l);return o},x.ac=Se,x.ad=function(i,n,o){var l=Math.sin(o),p=Math.cos(o),y=n[0],_=n[1],b=n[2],S=n[3],k=n[4],I=n[5],A=n[6],L=n[7];return n!==i&&(i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15]),i[0]=y*p+k*l,i[1]=_*p+I*l,i[2]=b*p+A*l,i[3]=S*p+L*l,i[4]=k*p-y*l,i[5]=I*p-_*l,i[6]=A*p-b*l,i[7]=L*p-S*l,i},x.ae=function(i){var n=new Iu(16);return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],n},x.af=Ap,x.ag=function(i,n){let o=0,l=0;if(i.kind==="constant")l=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:p,minZoom:y,maxZoom:_}=i,b=p?Se($n.interpolationFactor(p,n,y,_),0,1):0;i.kind==="camera"?l=Nn.number(i.minSize,i.maxSize,b):o=b}return{uSizeT:o,uSize:l}},x.ai=function(i,{uSize:n,uSizeT:o},{lowerSize:l,upperSize:p}){return i.kind==="source"?l/Jo:i.kind==="composite"?Nn.number(l/Jo,p/Jo,o):n},x.aj=sy,x.ak=function(i,n,o,l){const p=n.y-i.y,y=n.x-i.x,_=l.y-o.y,b=l.x-o.x,S=_*y-b*p;if(S===0)return null;const k=(b*(i.y-o.y)-_*(i.x-o.x))/S;return new U(i.x+k*y,i.y+k*p)},x.al=lx,x.am=Xv,x.an=jg,x.ao=function(i){let n=1/0,o=1/0,l=-1/0,p=-1/0;for(const y of i)n=Math.min(n,y.x),o=Math.min(o,y.y),l=Math.max(l,y.x),p=Math.max(p,y.y);return[n,o,l,p]},x.ap=Zr,x.ar=ay,x.as=function(i,n){var o=n[0],l=n[1],p=n[2],y=n[3],_=n[4],b=n[5],S=n[6],k=n[7],I=n[8],A=n[9],L=n[10],F=n[11],$=n[12],j=n[13],K=n[14],Q=n[15],ge=o*b-l*_,se=o*S-p*_,fe=o*k-y*_,be=l*S-p*b,Pe=l*k-y*b,qe=p*k-y*S,st=I*j-A*$,Ue=I*K-L*$,Ne=I*Q-F*$,et=A*K-L*j,Xe=A*Q-F*j,We=L*Q-F*K,Te=ge*We-se*Xe+fe*et+be*Ne-Pe*Ue+qe*st;return Te?(i[0]=(b*We-S*Xe+k*et)*(Te=1/Te),i[1]=(p*Xe-l*We-y*et)*Te,i[2]=(j*qe-K*Pe+Q*be)*Te,i[3]=(L*Pe-A*qe-F*be)*Te,i[4]=(S*Ne-_*We-k*Ue)*Te,i[5]=(o*We-p*Ne+y*Ue)*Te,i[6]=(K*fe-$*qe-Q*se)*Te,i[7]=(I*qe-L*fe+F*se)*Te,i[8]=(_*Xe-b*Ne+k*st)*Te,i[9]=(l*Ne-o*Xe-y*st)*Te,i[10]=($*Pe-j*fe+Q*ge)*Te,i[11]=(A*fe-I*Pe-F*ge)*Te,i[12]=(b*Ue-_*et-S*st)*Te,i[13]=(o*et-l*Ue+p*st)*Te,i[14]=(j*se-$*be-K*ge)*Te,i[15]=(I*be-A*se+L*ge)*Te,i):null},x.at=my,x.au=oy,x.av=gy,x.aw=function(){const i={},n=xe.$version;for(const o in xe.$root){const l=xe.$root[o];if(l.required){let p=null;p=o==="version"?n:l.type==="array"?[]:{},p!=null&&(i[o]=p)}}return i},x.ax=dh,x.ay=Qn,x.az=function(i){i=i.slice();const n=Object.create(null);for(let o=0;o<i.length;o++)n[i[o].id]=i[o];for(let o=0;o<i.length;o++)"ref"in i[o]&&(i[o]=fa(i[o],n[i[o].ref]));return i},x.b=Fr,x.b0=function(i,n){return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],i},x.b1=function(i,n,o){return i[0]=n[0]*o[0],i[1]=n[1]*o[1],i[2]=n[2]*o[2],i[3]=n[3]*o[3],i},x.b2=function(i,n){return i[0]*n[0]+i[1]*n[1]+i[2]*n[2]+i[3]*n[3]},x.b3=Ee,x.b4=tx,x.b5=Q1,x.b6=function(i,n,o,l,p){var y,_=1/Math.tan(n/2);return i[0]=_/o,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=_,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,p!=null&&p!==1/0?(i[10]=(p+l)*(y=1/(l-p)),i[14]=2*p*l*y):(i[10]=-1,i[14]=-2*l),i},x.b7=function(i,n,o){var l=Math.sin(o),p=Math.cos(o),y=n[4],_=n[5],b=n[6],S=n[7],k=n[8],I=n[9],A=n[10],L=n[11];return n!==i&&(i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15]),i[4]=y*p+k*l,i[5]=_*p+I*l,i[6]=b*p+A*l,i[7]=S*p+L*l,i[8]=k*p-y*l,i[9]=I*p-_*l,i[10]=A*p-b*l,i[11]=L*p-S*l,i},x.b8=ie,x.b9=_e,x.bA=I1,x.bB=function(i){return i.message===Vt},x.bC=ns,x.bD=ii,x.ba=function(i){return i*Math.PI/180},x.bb=function(i,n){const{x:o,y:l}=zh.fromLngLat(n);return!(i<0||i>25||l<0||l>=1||o<0||o>=1)},x.bc=function(i,n){return i[0]=n[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=n[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=n[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},x.bd=class extends E{},x.be=hy,x.bf=TI,x.bh=Br,x.bi=function(i,n){_r.REGISTERED_PROTOCOLS[i]=n},x.bj=function(i){delete _r.REGISTERED_PROTOCOLS[i]},x.bk=function(i,n){const o={};for(let p=0;p<i.length;p++){const y=n&&n[i[p].id]||pp(i[p]);n&&(n[i[p].id]=y);let _=o[y];_||(_=o[y]=[]),_.push(i[p])}const l=[];for(const p in o)l.push(o[p]);return l},x.bl=Ke,x.bm=nx,x.bn=ox,x.bo=F1,x.bp=function(i){i.bucket.createArrays(),i.bucket.tilePixelRatio=$r/(512*i.bucket.overscaling),i.bucket.compareText={},i.bucket.iconsNeedLinear=!1;const n=i.bucket.layers[0],o=n.layout,l=n._unevaluatedLayout._values,p={layoutIconSize:l["icon-size"].possiblyEvaluate(new cr(i.bucket.zoom+1),i.canonical),layoutTextSize:l["text-size"].possiblyEvaluate(new cr(i.bucket.zoom+1),i.canonical),textMaxSize:l["text-size"].possiblyEvaluate(new cr(18))};if(i.bucket.textSizeData.kind==="composite"){const{minZoom:k,maxZoom:I}=i.bucket.textSizeData;p.compositeTextSizes=[l["text-size"].possiblyEvaluate(new cr(k),i.canonical),l["text-size"].possiblyEvaluate(new cr(I),i.canonical)]}if(i.bucket.iconSizeData.kind==="composite"){const{minZoom:k,maxZoom:I}=i.bucket.iconSizeData;p.compositeIconSizes=[l["icon-size"].possiblyEvaluate(new cr(k),i.canonical),l["icon-size"].possiblyEvaluate(new cr(I),i.canonical)]}const y=o.get("text-line-height")*Zr,_=o.get("text-rotation-alignment")!=="viewport"&&o.get("symbol-placement")!=="point",b=o.get("text-keep-upright"),S=o.get("text-size");for(const k of i.bucket.features){const I=o.get("text-font").evaluate(k,{},i.canonical).join(","),A=S.evaluate(k,{},i.canonical),L=p.layoutTextSize.evaluate(k,{},i.canonical),F=p.layoutIconSize.evaluate(k,{},i.canonical),$={horizontal:{},vertical:void 0},j=k.text;let K,Q=[0,0];if(j){const fe=j.toString(),be=o.get("text-letter-spacing").evaluate(k,{},i.canonical)*Zr,Pe=Mg(fe)?be:0,qe=o.get("text-anchor").evaluate(k,{},i.canonical),st=yx(n,k,i.canonical);if(!st){const Xe=o.get("text-radial-offset").evaluate(k,{},i.canonical);Q=Xe?gx(qe,[Xe*Zr,fy]):o.get("text-offset").evaluate(k,{},i.canonical).map(We=>We*Zr)}let Ue=_?"center":o.get("text-justify").evaluate(k,{},i.canonical);const Ne=o.get("symbol-placement")==="point"?o.get("text-max-width").evaluate(k,{},i.canonical)*Zr:1/0,et=()=>{i.bucket.allowVerticalPlacement&&ph(fe)&&($.vertical=Dp(j,i.glyphMap,i.glyphPositions,i.imagePositions,I,Ne,y,qe,"left",Pe,Q,x.ah.vertical,!0,L,A))};if(!_&&st){const Xe=new Set;if(Ue==="auto")for(let Te=0;Te<st.values.length;Te+=2)Xe.add(my(st.values[Te]));else Xe.add(Ue);let We=!1;for(const Te of Xe)if(!$.horizontal[Te])if(We)$.horizontal[Te]=$.horizontal[0];else{const rt=Dp(j,i.glyphMap,i.glyphPositions,i.imagePositions,I,Ne,y,"center",Te,Pe,Q,x.ah.horizontal,!1,L,A);rt&&($.horizontal[Te]=rt,We=rt.positionedLines.length===1)}et()}else{Ue==="auto"&&(Ue=my(qe));const Xe=Dp(j,i.glyphMap,i.glyphPositions,i.imagePositions,I,Ne,y,qe,Ue,Pe,Q,x.ah.horizontal,!1,L,A);Xe&&($.horizontal[Ue]=Xe),et(),ph(fe)&&_&&b&&($.vertical=Dp(j,i.glyphMap,i.glyphPositions,i.imagePositions,I,Ne,y,qe,Ue,Pe,Q,x.ah.vertical,!1,L,A))}}let ge=!1;if(k.icon&&k.icon.name){const fe=i.imageMap[k.icon.name];fe&&(K=aI(i.imagePositions[k.icon.name],o.get("icon-offset").evaluate(k,{},i.canonical),o.get("icon-anchor").evaluate(k,{},i.canonical)),ge=!!fe.sdf,i.bucket.sdfIcons===void 0?i.bucket.sdfIcons=ge:i.bucket.sdfIcons!==ge&&It("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(fe.pixelRatio!==i.bucket.pixelRatio||o.get("icon-rotate").constantOr(1)!==0)&&(i.bucket.iconsNeedLinear=!0))}const se=vx($.horizontal)||$.vertical;i.bucket.iconsInText=!!se&&se.iconsInText,(se||K)&&wI(i.bucket,k,$,K,i.imageMap,p,L,F,Q,ge,i.canonical)}i.showCollisionBoxes&&i.bucket.generateCollisionDebugBuffers()},x.bq=Qg,x.br=Xg,x.bs=Jg,x.bt=xs,x.bu=ty,x.bv=class{constructor(i){this._marks={start:[i.url,"start"].join("#"),end:[i.url,"end"].join("#"),measure:i.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let i=performance.getEntriesByName(this._marks.measure);return i.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),i=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),i}},x.bw=function(i,n,o,l,p){return h(this,void 0,void 0,function*(){if(H())try{return yield gt(i,n,o,l,p)}catch{}return function(y,_,b,S,k){const I=y.width,A=y.height;yt&&Pt||(yt=new OffscreenCanvas(I,A),Pt=yt.getContext("2d",{willReadFrequently:!0})),yt.width=I,yt.height=A,Pt.drawImage(y,0,0,I,A);const L=Pt.getImageData(_,b,S,k);return Pt.clearRect(0,0,I,A),L.data}(i,n,o,l,p)})},x.bx=rx,x.by=z,x.bz=B,x.c=Jn,x.d=i=>h(void 0,void 0,void 0,function*(){if(i.byteLength===0)return createImageBitmap(new ImageData(1,1));const n=new Blob([new Uint8Array(i)],{type:"image/png"});try{return createImageBitmap(n)}catch(o){throw new Error(`Could not load image because of ${o.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),x.e=ke,x.f=i=>new Promise((n,o)=>{const l=new Image;l.onload=()=>{n(l),URL.revokeObjectURL(l.src),l.onload=null,window.requestAnimationFrame(()=>{l.src=Ve})},l.onerror=()=>o(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const p=new Blob([new Uint8Array(i)],{type:"image/png"});l.src=i.byteLength?URL.createObjectURL(p):Ve}),x.g=qr,x.h=(i,n)=>an(ke(i,{type:"json"}),n),x.i=Pr,x.j=io,x.k=no,x.l=(i,n)=>an(ke(i,{type:"arrayBuffer"}),n),x.m=an,x.n=function(i){return new ty(i).readFields(Qk,[])},x.o=wh,x.p=D1,x.q=g,x.r=Ag,x.s=Ao,x.t=ch,x.u=Ia,x.v=xe,x.w=It,x.x=function([i,n,o]){return n+=90,n*=Math.PI/180,o*=Math.PI/180,{x:i*Math.cos(n)*Math.sin(o),y:i*Math.sin(n)*Math.sin(o),z:i*Math.cos(o)}},x.y=Nn,x.z=cr}),f("worker",["./shared"],function(x){class h{constructor(D){this.keyCache={},D&&this.replace(D)}replace(D){this._layerConfigs={},this._layers={},this.update(D,[])}update(D,R){for(const X of D){this._layerConfigs[X.id]=X;const le=this._layers[X.id]=x.aA(X);le._featureFilter=x.a7(le.filter),this.keyCache[X.id]&&delete this.keyCache[X.id]}for(const X of R)delete this.keyCache[X],delete this._layerConfigs[X],delete this._layers[X];this.familiesBySource={};const q=x.bk(Object.values(this._layerConfigs),this.keyCache);for(const X of q){const le=X.map(ve=>this._layers[ve.id]),ce=le[0];if(ce.visibility==="none")continue;const me=ce.source||"";let ne=this.familiesBySource[me];ne||(ne=this.familiesBySource[me]={});const we=ce.sourceLayer||"_geojsonTileLayer";let Ie=ne[we];Ie||(Ie=ne[we]=[]),Ie.push(le)}}}class z{constructor(D){const R={},q=[];for(const me in D){const ne=D[me],we=R[me]={};for(const Ie in ne){const ve=ne[+Ie];if(!ve||ve.bitmap.width===0||ve.bitmap.height===0)continue;const Re={x:0,y:0,w:ve.bitmap.width+2,h:ve.bitmap.height+2};q.push(Re),we[Ie]={rect:Re,metrics:ve.metrics}}}const{w:X,h:le}=x.p(q),ce=new x.o({width:X||1,height:le||1});for(const me in D){const ne=D[me];for(const we in ne){const Ie=ne[+we];if(!Ie||Ie.bitmap.width===0||Ie.bitmap.height===0)continue;const ve=R[me][we].rect;x.o.copy(Ie.bitmap,ce,{x:0,y:0},{x:ve.x+1,y:ve.y+1},Ie.bitmap)}}this.image=ce,this.positions=R}}x.bl("GlyphAtlas",z);class B{constructor(D){this.tileID=new x.S(D.tileID.overscaledZ,D.tileID.wrap,D.tileID.canonical.z,D.tileID.canonical.x,D.tileID.canonical.y),this.uid=D.uid,this.zoom=D.zoom,this.pixelRatio=D.pixelRatio,this.tileSize=D.tileSize,this.source=D.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=D.showCollisionBoxes,this.collectResourceTiming=!!D.collectResourceTiming,this.returnDependencies=!!D.returnDependencies,this.promoteId=D.promoteId,this.inFlightDependencies=[]}parse(D,R,q,X){return x._(this,void 0,void 0,function*(){this.status="parsing",this.data=D,this.collisionBoxArray=new x.a5;const le=new x.bm(Object.keys(D.layers).sort()),ce=new x.bn(this.tileID,this.promoteId);ce.bucketLayerIDs=[];const me={},ne={featureIndex:ce,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:q},we=R.familiesBySource[this.source];for(const Ct in we){const Ht=D.layers[Ct];if(!Ht)continue;Ht.version===1&&x.w(`Vector tile source "${this.source}" layer "${Ct}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const yr=le.encode(Ct),Jr=[];for(let sn=0;sn<Ht.length;sn++){const Cn=Ht.feature(sn),Ga=ce.getId(Cn,Ct);Jr.push({feature:Cn,id:Ga,index:sn,sourceLayerIndex:yr})}for(const sn of we[Ct]){const Cn=sn[0];Cn.source!==this.source&&x.w(`layer.source = ${Cn.source} does not equal this.source = ${this.source}`),Cn.minzoom&&this.zoom<Math.floor(Cn.minzoom)||Cn.maxzoom&&this.zoom>=Cn.maxzoom||Cn.visibility!=="none"&&(Z(sn,this.zoom,q),(me[Cn.id]=Cn.createBucket({index:ce.bucketLayerIDs.length,layers:sn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:yr,sourceID:this.source})).populate(Jr,ne,this.tileID.canonical),ce.bucketLayerIDs.push(sn.map(Ga=>Ga.id)))}}const Ie=x.aF(ne.glyphDependencies,Ct=>Object.keys(Ct).map(Number));this.inFlightDependencies.forEach(Ct=>Ct==null?void 0:Ct.abort()),this.inFlightDependencies=[];let ve=Promise.resolve({});if(Object.keys(Ie).length){const Ct=new AbortController;this.inFlightDependencies.push(Ct),ve=X.sendAsync({type:"GG",data:{stacks:Ie,source:this.source,tileID:this.tileID,type:"glyphs"}},Ct)}const Re=Object.keys(ne.iconDependencies);let nt=Promise.resolve({});if(Re.length){const Ct=new AbortController;this.inFlightDependencies.push(Ct),nt=X.sendAsync({type:"GI",data:{icons:Re,source:this.source,tileID:this.tileID,type:"icons"}},Ct)}const at=Object.keys(ne.patternDependencies);let Rt=Promise.resolve({});if(at.length){const Ct=new AbortController;this.inFlightDependencies.push(Ct),Rt=X.sendAsync({type:"GI",data:{icons:at,source:this.source,tileID:this.tileID,type:"patterns"}},Ct)}const[bt,Dt,Et]=yield Promise.all([ve,nt,Rt]),Or=new z(bt),xr=new x.bo(Dt,Et);for(const Ct in me){const Ht=me[Ct];Ht instanceof x.a6?(Z(Ht.layers,this.zoom,q),x.bp({bucket:Ht,glyphMap:bt,glyphPositions:Or.positions,imageMap:Dt,imagePositions:xr.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Ht.hasPattern&&(Ht instanceof x.bq||Ht instanceof x.br||Ht instanceof x.bs)&&(Z(Ht.layers,this.zoom,q),Ht.addFeatures(ne,this.tileID.canonical,xr.patternPositions))}return this.status="done",{buckets:Object.values(me).filter(Ct=>!Ct.isEmpty()),featureIndex:ce,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Or.image,imageAtlas:xr,glyphMap:this.returnDependencies?bt:null,iconMap:this.returnDependencies?Dt:null,glyphPositions:this.returnDependencies?Or.positions:null}})}}function Z(J,D,R){const q=new x.z(D);for(const X of J)X.recalculate(q,R)}class U{constructor(D,R,q){this.actor=D,this.layerIndex=R,this.availableImages=q,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(D,R){return x._(this,void 0,void 0,function*(){const q=yield x.l(D.request,R);try{return{vectorTile:new x.bt.VectorTile(new x.bu(q.data)),rawData:q.data,cacheControl:q.cacheControl,expires:q.expires}}catch(X){const le=new Uint8Array(q.data);let ce=`Unable to parse the tile at ${D.request.url}, `;throw ce+=le[0]===31&&le[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${X.message}`,new Error(ce)}})}loadTile(D){return x._(this,void 0,void 0,function*(){const R=D.uid,q=!!(D&&D.request&&D.request.collectResourceTiming)&&new x.bv(D.request),X=new B(D);this.loading[R]=X;const le=new AbortController;X.abort=le;try{const ce=yield this.loadVectorTile(D,le);if(delete this.loading[R],!ce)return null;const me=ce.rawData,ne={};ce.expires&&(ne.expires=ce.expires),ce.cacheControl&&(ne.cacheControl=ce.cacheControl);const we={};if(q){const ve=q.finish();ve&&(we.resourceTiming=JSON.parse(JSON.stringify(ve)))}X.vectorTile=ce.vectorTile;const Ie=X.parse(ce.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[R]=X,this.fetching[R]={rawTileData:me,cacheControl:ne,resourceTiming:we};try{const ve=yield Ie;return x.e({rawTileData:me.slice(0)},ve,ne,we)}finally{delete this.fetching[R]}}catch(ce){throw delete this.loading[R],X.status="done",this.loaded[R]=X,ce}})}reloadTile(D){return x._(this,void 0,void 0,function*(){const R=D.uid;if(!this.loaded||!this.loaded[R])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const q=this.loaded[R];if(q.showCollisionBoxes=D.showCollisionBoxes,q.status==="parsing"){const X=yield q.parse(q.vectorTile,this.layerIndex,this.availableImages,this.actor);let le;if(this.fetching[R]){const{rawTileData:ce,cacheControl:me,resourceTiming:ne}=this.fetching[R];delete this.fetching[R],le=x.e({rawTileData:ce.slice(0)},X,me,ne)}else le=X;return le}if(q.status==="done"&&q.vectorTile)return q.parse(q.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(D){return x._(this,void 0,void 0,function*(){const R=this.loading,q=D.uid;R&&R[q]&&R[q].abort&&(R[q].abort.abort(),delete R[q])})}removeTile(D){return x._(this,void 0,void 0,function*(){this.loaded&&this.loaded[D.uid]&&delete this.loaded[D.uid]})}}class O{constructor(){this.loaded={}}loadTile(D){return x._(this,void 0,void 0,function*(){const{uid:R,encoding:q,rawImageData:X,redFactor:le,greenFactor:ce,blueFactor:me,baseShift:ne}=D,we=X.width+2,Ie=X.height+2,ve=x.b(X)?new x.R({width:we,height:Ie},yield x.bw(X,-1,-1,we,Ie)):X,Re=new x.bx(R,ve,q,le,ce,me,ne);return this.loaded=this.loaded||{},this.loaded[R]=Re,Re})}removeTile(D){const R=this.loaded,q=D.uid;R&&R[q]&&delete R[q]}}function de(J,D){if(J.length!==0){he(J[0],D);for(var R=1;R<J.length;R++)he(J[R],!D)}}function he(J,D){for(var R=0,q=0,X=0,le=J.length,ce=le-1;X<le;ce=X++){var me=(J[X][0]-J[ce][0])*(J[ce][1]+J[X][1]),ne=R+me;q+=Math.abs(R)>=Math.abs(me)?R-ne+me:me-ne+R,R=ne}R+q>=0!=!!D&&J.reverse()}var ae=x.by(function J(D,R){var q,X=D&&D.type;if(X==="FeatureCollection")for(q=0;q<D.features.length;q++)J(D.features[q],R);else if(X==="GeometryCollection")for(q=0;q<D.geometries.length;q++)J(D.geometries[q],R);else if(X==="Feature")J(D.geometry,R);else if(X==="Polygon")de(D.coordinates,R);else if(X==="MultiPolygon")for(q=0;q<D.coordinates.length;q++)de(D.coordinates[q],R);return D});const Ae=x.bt.VectorTileFeature.prototype.toGeoJSON;var te={exports:{}},H=x.bz,ie=x.bt.VectorTileFeature,_e=Se;function Se(J,D){this.options=D||{},this.features=J,this.length=J.length}function Ee(J,D){this.id=typeof J.id=="number"?J.id:void 0,this.type=J.type,this.rawGeometry=J.type===1?[J.geometry]:J.geometry,this.properties=J.tags,this.extent=D||4096}Se.prototype.feature=function(J){return new Ee(this.features[J],this.options.extent)},Ee.prototype.loadGeometry=function(){var J=this.rawGeometry;this.geometry=[];for(var D=0;D<J.length;D++){for(var R=J[D],q=[],X=0;X<R.length;X++)q.push(new H(R[X][0],R[X][1]));this.geometry.push(q)}return this.geometry},Ee.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var J=this.geometry,D=1/0,R=-1/0,q=1/0,X=-1/0,le=0;le<J.length;le++)for(var ce=J[le],me=0;me<ce.length;me++){var ne=ce[me];D=Math.min(D,ne.x),R=Math.max(R,ne.x),q=Math.min(q,ne.y),X=Math.max(X,ne.y)}return[D,q,R,X]},Ee.prototype.toGeoJSON=ie.prototype.toGeoJSON;var ke=x.bA,Ze=_e;function mt(J){var D=new ke;return function(R,q){for(var X in R.layers)q.writeMessage(3,tt,R.layers[X])}(J,D),D.finish()}function tt(J,D){var R;D.writeVarintField(15,J.version||1),D.writeStringField(1,J.name||""),D.writeVarintField(5,J.extent||4096);var q={keys:[],values:[],keycache:{},valuecache:{}};for(R=0;R<J.length;R++)q.feature=J.feature(R),D.writeMessage(2,ot,q);var X=q.keys;for(R=0;R<X.length;R++)D.writeStringField(3,X[R]);var le=q.values;for(R=0;R<le.length;R++)D.writeMessage(4,Tr,le[R])}function ot(J,D){var R=J.feature;R.id!==void 0&&D.writeVarintField(1,R.id),D.writeMessage(2,$t,J),D.writeVarintField(3,R.type),D.writeMessage(4,Pr,R)}function $t(J,D){var R=J.feature,q=J.keys,X=J.values,le=J.keycache,ce=J.valuecache;for(var me in R.properties){var ne=R.properties[me],we=le[me];if(ne!==null){we===void 0&&(q.push(me),le[me]=we=q.length-1),D.writeVarint(we);var Ie=typeof ne;Ie!=="string"&&Ie!=="boolean"&&Ie!=="number"&&(ne=JSON.stringify(ne));var ve=Ie+":"+ne,Re=ce[ve];Re===void 0&&(X.push(ne),ce[ve]=Re=X.length-1),D.writeVarint(Re)}}}function It(J,D){return(D<<3)+(7&J)}function Bt(J){return J<<1^J>>31}function Pr(J,D){for(var R=J.loadGeometry(),q=J.type,X=0,le=0,ce=R.length,me=0;me<ce;me++){var ne=R[me],we=1;q===1&&(we=ne.length),D.writeVarint(It(1,we));for(var Ie=q===3?ne.length-1:ne.length,ve=0;ve<Ie;ve++){ve===1&&q!==1&&D.writeVarint(It(2,Ie-1));var Re=ne[ve].x-X,nt=ne[ve].y-le;D.writeVarint(Bt(Re)),D.writeVarint(Bt(nt)),X+=Re,le+=nt}q===3&&D.writeVarint(It(7,1))}}function Tr(J,D){var R=typeof J;R==="string"?D.writeStringField(1,J):R==="boolean"?D.writeBooleanField(7,J):R==="number"&&(J%1!=0?D.writeDoubleField(3,J):J<0?D.writeSVarintField(6,J):D.writeVarintField(5,J))}te.exports=mt,te.exports.fromVectorTileJs=mt,te.exports.fromGeojsonVt=function(J,D){D=D||{};var R={};for(var q in J)R[q]=new Ze(J[q].features,D),R[q].name=q,R[q].version=D.version,R[q].extent=D.extent;return mt({layers:R})},te.exports.GeoJSONWrapper=Ze;var Fr=x.by(te.exports);const Ve={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:J=>J},gt=Math.fround||(yt=new Float32Array(1),J=>(yt[0]=+J,yt[0]));var yt;const Pt=3,Vt=5,Jn=6;class _r{constructor(D){this.options=Object.assign(Object.create(Ve),D),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(D){const{log:R,minZoom:q,maxZoom:X}=this.options;R&&console.time("total time");const le=`prepare ${D.length} points`;R&&console.time(le),this.points=D;const ce=[];for(let ne=0;ne<D.length;ne++){const we=D[ne];if(!we.geometry)continue;const[Ie,ve]=we.geometry.coordinates,Re=gt(Br(Ie)),nt=gt(Qn(ve));ce.push(Re,nt,1/0,ne,-1,1),this.options.reduce&&ce.push(0)}let me=this.trees[X+1]=this._createTree(ce);R&&console.timeEnd(le);for(let ne=X;ne>=q;ne--){const we=+Date.now();me=this.trees[ne]=this._createTree(this._cluster(me,ne)),R&&console.log("z%d: %d clusters in %dms",ne,me.numItems,+Date.now()-we)}return R&&console.timeEnd("total time"),this}getClusters(D,R){let q=((D[0]+180)%360+360)%360-180;const X=Math.max(-90,Math.min(90,D[1]));let le=D[2]===180?180:((D[2]+180)%360+360)%360-180;const ce=Math.max(-90,Math.min(90,D[3]));if(D[2]-D[0]>=360)q=-180,le=180;else if(q>le){const ve=this.getClusters([q,X,180,ce],R),Re=this.getClusters([-180,X,le,ce],R);return ve.concat(Re)}const me=this.trees[this._limitZoom(R)],ne=me.range(Br(q),Qn(ce),Br(le),Qn(X)),we=me.data,Ie=[];for(const ve of ne){const Re=this.stride*ve;Ie.push(we[Re+Vt]>1?qr(we,Re,this.clusterProps):this.points[we[Re+Pt]])}return Ie}getChildren(D){const R=this._getOriginId(D),q=this._getOriginZoom(D),X="No cluster with the specified id.",le=this.trees[q];if(!le)throw new Error(X);const ce=le.data;if(R*this.stride>=ce.length)throw new Error(X);const me=this.options.radius/(this.options.extent*Math.pow(2,q-1)),ne=le.within(ce[R*this.stride],ce[R*this.stride+1],me),we=[];for(const Ie of ne){const ve=Ie*this.stride;ce[ve+4]===D&&we.push(ce[ve+Vt]>1?qr(ce,ve,this.clusterProps):this.points[ce[ve+Pt]])}if(we.length===0)throw new Error(X);return we}getLeaves(D,R,q){const X=[];return this._appendLeaves(X,D,R=R||10,q=q||0,0),X}getTile(D,R,q){const X=this.trees[this._limitZoom(D)],le=Math.pow(2,D),{extent:ce,radius:me}=this.options,ne=me/ce,we=(q-ne)/le,Ie=(q+1+ne)/le,ve={features:[]};return this._addTileFeatures(X.range((R-ne)/le,we,(R+1+ne)/le,Ie),X.data,R,q,le,ve),R===0&&this._addTileFeatures(X.range(1-ne/le,we,1,Ie),X.data,le,q,le,ve),R===le-1&&this._addTileFeatures(X.range(0,we,ne/le,Ie),X.data,-1,q,le,ve),ve.features.length?ve:null}getClusterExpansionZoom(D){let R=this._getOriginZoom(D)-1;for(;R<=this.options.maxZoom;){const q=this.getChildren(D);if(R++,q.length!==1)break;D=q[0].properties.cluster_id}return R}_appendLeaves(D,R,q,X,le){const ce=this.getChildren(R);for(const me of ce){const ne=me.properties;if(ne&&ne.cluster?le+ne.point_count<=X?le+=ne.point_count:le=this._appendLeaves(D,ne.cluster_id,q,X,le):le<X?le++:D.push(me),D.length===q)break}return le}_createTree(D){const R=new x.av(D.length/this.stride|0,this.options.nodeSize,Float32Array);for(let q=0;q<D.length;q+=this.stride)R.add(D[q],D[q+1]);return R.finish(),R.data=D,R}_addTileFeatures(D,R,q,X,le,ce){for(const me of D){const ne=me*this.stride,we=R[ne+Vt]>1;let Ie,ve,Re;if(we)Ie=Kr(R,ne,this.clusterProps),ve=R[ne],Re=R[ne+1];else{const Rt=this.points[R[ne+Pt]];Ie=Rt.properties;const[bt,Dt]=Rt.geometry.coordinates;ve=Br(bt),Re=Qn(Dt)}const nt={type:1,geometry:[[Math.round(this.options.extent*(ve*le-q)),Math.round(this.options.extent*(Re*le-X))]],tags:Ie};let at;at=we||this.options.generateId?R[ne+Pt]:this.points[R[ne+Pt]].id,at!==void 0&&(nt.id=at),ce.features.push(nt)}}_limitZoom(D){return Math.max(this.options.minZoom,Math.min(Math.floor(+D),this.options.maxZoom+1))}_cluster(D,R){const{radius:q,extent:X,reduce:le,minPoints:ce}=this.options,me=q/(X*Math.pow(2,R)),ne=D.data,we=[],Ie=this.stride;for(let ve=0;ve<ne.length;ve+=Ie){if(ne[ve+2]<=R)continue;ne[ve+2]=R;const Re=ne[ve],nt=ne[ve+1],at=D.within(ne[ve],ne[ve+1],me),Rt=ne[ve+Vt];let bt=Rt;for(const Dt of at){const Et=Dt*Ie;ne[Et+2]>R&&(bt+=ne[Et+Vt])}if(bt>Rt&&bt>=ce){let Dt,Et=Re*Rt,Or=nt*Rt,xr=-1;const Ct=((ve/Ie|0)<<5)+(R+1)+this.points.length;for(const Ht of at){const yr=Ht*Ie;if(ne[yr+2]<=R)continue;ne[yr+2]=R;const Jr=ne[yr+Vt];Et+=ne[yr]*Jr,Or+=ne[yr+1]*Jr,ne[yr+4]=Ct,le&&(Dt||(Dt=this._map(ne,ve,!0),xr=this.clusterProps.length,this.clusterProps.push(Dt)),le(Dt,this._map(ne,yr)))}ne[ve+4]=Ct,we.push(Et/bt,Or/bt,1/0,Ct,-1,bt),le&&we.push(xr)}else{for(let Dt=0;Dt<Ie;Dt++)we.push(ne[ve+Dt]);if(bt>1)for(const Dt of at){const Et=Dt*Ie;if(!(ne[Et+2]<=R)){ne[Et+2]=R;for(let Or=0;Or<Ie;Or++)we.push(ne[Et+Or])}}}}return we}_getOriginId(D){return D-this.points.length>>5}_getOriginZoom(D){return(D-this.points.length)%32}_map(D,R,q){if(D[R+Vt]>1){const ce=this.clusterProps[D[R+Jn]];return q?Object.assign({},ce):ce}const X=this.points[D[R+Pt]].properties,le=this.options.map(X);return q&&le===X?Object.assign({},le):le}}function qr(J,D,R){return{type:"Feature",id:J[D+Pt],properties:Kr(J,D,R),geometry:{type:"Point",coordinates:[(q=J[D],360*(q-.5)),an(J[D+1])]}};var q}function Kr(J,D,R){const q=J[D+Vt],X=q>=1e4?`${Math.round(q/1e3)}k`:q>=1e3?Math.round(q/100)/10+"k":q,le=J[D+Jn],ce=le===-1?{}:Object.assign({},R[le]);return Object.assign(ce,{cluster:!0,cluster_id:J[D+Pt],point_count:q,point_count_abbreviated:X})}function Br(J){return J/360+.5}function Qn(J){const D=Math.sin(J*Math.PI/180),R=.5-.25*Math.log((1+D)/(1-D))/Math.PI;return R<0?0:R>1?1:R}function an(J){const D=(180-360*J)*Math.PI/180;return 360*Math.atan(Math.exp(D))/Math.PI-90}function Ao(J,D,R,q){let X=q;const le=D+(R-D>>1);let ce,me=R-D;const ne=J[D],we=J[D+1],Ie=J[R],ve=J[R+1];for(let Re=D+3;Re<R;Re+=3){const nt=pa(J[Re],J[Re+1],ne,we,Ie,ve);if(nt>X)ce=Re,X=nt;else if(nt===X){const at=Math.abs(Re-le);at<me&&(ce=Re,me=at)}}X>q&&(ce-D>3&&Ao(J,D,ce,q),J[ce+2]=X,R-ce>3&&Ao(J,ce,R,q))}function pa(J,D,R,q,X,le){let ce=X-R,me=le-q;if(ce!==0||me!==0){const ne=((J-R)*ce+(D-q)*me)/(ce*ce+me*me);ne>1?(R=X,q=le):ne>0&&(R+=ce*ne,q+=me*ne)}return ce=J-R,me=D-q,ce*ce+me*me}function Ai(J,D,R,q){const X={id:J??null,type:D,geometry:R,tags:q,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(D==="Point"||D==="MultiPoint"||D==="LineString")no(X,R);else if(D==="Polygon")no(X,R[0]);else if(D==="MultiLineString")for(const le of R)no(X,le);else if(D==="MultiPolygon")for(const le of R)no(X,le[0]);return X}function no(J,D){for(let R=0;R<D.length;R+=3)J.minX=Math.min(J.minX,D[R]),J.minY=Math.min(J.minY,D[R+1]),J.maxX=Math.max(J.maxX,D[R]),J.maxY=Math.max(J.maxY,D[R+1])}function io(J,D,R,q){if(!D.geometry)return;const X=D.geometry.coordinates;if(X&&X.length===0)return;const le=D.geometry.type,ce=Math.pow(R.tolerance/((1<<R.maxZoom)*R.extent),2);let me=[],ne=D.id;if(R.promoteId?ne=D.properties[R.promoteId]:R.generateId&&(ne=q||0),le==="Point")Zo(X,me);else if(le==="MultiPoint")for(const we of X)Zo(we,me);else if(le==="LineString")xe(X,me,ce,!1);else if(le==="MultiLineString"){if(R.lineMetrics){for(const we of X)me=[],xe(we,me,ce,!1),J.push(Ai(ne,"LineString",me,D.properties));return}Po(X,me,ce,!1)}else if(le==="Polygon")Po(X,me,ce,!0);else{if(le!=="MultiPolygon"){if(le==="GeometryCollection"){for(const we of D.geometry.geometries)io(J,{id:ne,geometry:we,properties:D.properties},R,q);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const we of X){const Ie=[];Po(we,Ie,ce,!0),me.push(Ie)}}J.push(Ai(ne,le,me,D.properties))}function Zo(J,D){D.push(fa(J[0]),Lt(J[1]),0)}function xe(J,D,R,q){let X,le,ce=0;for(let ne=0;ne<J.length;ne++){const we=fa(J[ne][0]),Ie=Lt(J[ne][1]);D.push(we,Ie,0),ne>0&&(ce+=q?(X*Ie-we*le)/2:Math.sqrt(Math.pow(we-X,2)+Math.pow(Ie-le,2))),X=we,le=Ie}const me=D.length-3;D[2]=1,Ao(D,0,me,R),D[me+2]=1,D.size=Math.abs(ce),D.start=0,D.end=D.size}function Po(J,D,R,q){for(let X=0;X<J.length;X++){const le=[];xe(J[X],le,R,q),D.push(le)}}function fa(J){return J/360+.5}function Lt(J){const D=Math.sin(J*Math.PI/180),R=.5-.25*Math.log((1+D)/(1-D))/Math.PI;return R<0?0:R>1?1:R}function ir(J,D,R,q,X,le,ce,me){if(q/=D,le>=(R/=D)&&ce<q)return J;if(ce<R||le>=q)return null;const ne=[];for(const we of J){const Ie=we.geometry;let ve=we.type;const Re=X===0?we.minX:we.minY,nt=X===0?we.maxX:we.maxY;if(Re>=R&&nt<q){ne.push(we);continue}if(nt<R||Re>=q)continue;let at=[];if(ve==="Point"||ve==="MultiPoint")Mo(Ie,at,R,q,X);else if(ve==="LineString")oo(Ie,at,R,q,X,!1,me.lineMetrics);else if(ve==="MultiLineString")Mi(Ie,at,R,q,X,!1);else if(ve==="Polygon")Mi(Ie,at,R,q,X,!0);else if(ve==="MultiPolygon")for(const Rt of Ie){const bt=[];Mi(Rt,bt,R,q,X,!0),bt.length&&at.push(bt)}if(at.length){if(me.lineMetrics&&ve==="LineString"){for(const Rt of at)ne.push(Ai(we.id,ve,Rt,we.tags));continue}ve!=="LineString"&&ve!=="MultiLineString"||(at.length===1?(ve="LineString",at=at[0]):ve="MultiLineString"),ve!=="Point"&&ve!=="MultiPoint"||(ve=at.length===3?"Point":"MultiPoint"),ne.push(Ai(we.id,ve,at,we.tags))}}return ne.length?ne:null}function Mo(J,D,R,q,X){for(let le=0;le<J.length;le+=3){const ce=J[le+X];ce>=R&&ce<=q&&Xr(D,J[le],J[le+1],J[le+2])}}function oo(J,D,R,q,X,le,ce){let me=Pi(J);const ne=X===0?ma:Go;let we,Ie,ve=J.start;for(let bt=0;bt<J.length-3;bt+=3){const Dt=J[bt],Et=J[bt+1],Or=J[bt+2],xr=J[bt+3],Ct=J[bt+4],Ht=X===0?Dt:Et,yr=X===0?xr:Ct;let Jr=!1;ce&&(we=Math.sqrt(Math.pow(Dt-xr,2)+Math.pow(Et-Ct,2))),Ht<R?yr>R&&(Ie=ne(me,Dt,Et,xr,Ct,R),ce&&(me.start=ve+we*Ie)):Ht>q?yr<q&&(Ie=ne(me,Dt,Et,xr,Ct,q),ce&&(me.start=ve+we*Ie)):Xr(me,Dt,Et,Or),yr<R&&Ht>=R&&(Ie=ne(me,Dt,Et,xr,Ct,R),Jr=!0),yr>q&&Ht<=q&&(Ie=ne(me,Dt,Et,xr,Ct,q),Jr=!0),!le&&Jr&&(ce&&(me.end=ve+we*Ie),D.push(me),me=Pi(J)),ce&&(ve+=we)}let Re=J.length-3;const nt=J[Re],at=J[Re+1],Rt=X===0?nt:at;Rt>=R&&Rt<=q&&Xr(me,nt,at,J[Re+2]),Re=me.length-3,le&&Re>=3&&(me[Re]!==me[0]||me[Re+1]!==me[1])&&Xr(me,me[0],me[1],me[2]),me.length&&D.push(me)}function Pi(J){const D=[];return D.size=J.size,D.start=J.start,D.end=J.end,D}function Mi(J,D,R,q,X,le){for(const ce of J)oo(ce,D,R,q,X,le,!1)}function Xr(J,D,R,q){J.push(D,R,q)}function ma(J,D,R,q,X,le){const ce=(le-D)/(q-D);return Xr(J,le,R+(X-R)*ce,1),ce}function Go(J,D,R,q,X,le){const ce=(le-R)/(X-R);return Xr(J,D+(q-D)*ce,le,1),ce}function ze(J,D){const R=[];for(let q=0;q<J.length;q++){const X=J[q],le=X.type;let ce;if(le==="Point"||le==="MultiPoint"||le==="LineString")ce=_t(X.geometry,D);else if(le==="MultiLineString"||le==="Polygon"){ce=[];for(const me of X.geometry)ce.push(_t(me,D))}else if(le==="MultiPolygon"){ce=[];for(const me of X.geometry){const ne=[];for(const we of me)ne.push(_t(we,D));ce.push(ne)}}R.push(Ai(X.id,le,ce,X.tags))}return R}function _t(J,D){const R=[];R.size=J.size,J.start!==void 0&&(R.start=J.start,R.end=J.end);for(let q=0;q<J.length;q+=3)R.push(J[q]+D,J[q+1],J[q+2]);return R}function Yr(J,D){if(J.transformed)return J;const R=1<<J.z,q=J.x,X=J.y;for(const le of J.features){const ce=le.geometry,me=le.type;if(le.geometry=[],me===1)for(let ne=0;ne<ce.length;ne+=2)le.geometry.push(pi(ce[ne],ce[ne+1],D,R,q,X));else for(let ne=0;ne<ce.length;ne++){const we=[];for(let Ie=0;Ie<ce[ne].length;Ie+=2)we.push(pi(ce[ne][Ie],ce[ne][Ie+1],D,R,q,X));le.geometry.push(we)}}return J.transformed=!0,J}function pi(J,D,R,q,X,le){return[Math.round(R*(J*q-X)),Math.round(R*(D*q-le))]}function zi(J,D,R,q,X){const le=D===X.maxZoom?0:X.tolerance/((1<<D)*X.extent),ce={features:[],numPoints:0,numSimplified:0,numFeatures:J.length,source:null,x:R,y:q,z:D,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const me of J)Be(ce,me,le,X);return ce}function Be(J,D,R,q){const X=D.geometry,le=D.type,ce=[];if(J.minX=Math.min(J.minX,D.minX),J.minY=Math.min(J.minY,D.minY),J.maxX=Math.max(J.maxX,D.maxX),J.maxY=Math.max(J.maxY,D.maxY),le==="Point"||le==="MultiPoint")for(let me=0;me<X.length;me+=3)ce.push(X[me],X[me+1]),J.numPoints++,J.numSimplified++;else if(le==="LineString")Tt(ce,X,J,R,!1,!1);else if(le==="MultiLineString"||le==="Polygon")for(let me=0;me<X.length;me++)Tt(ce,X[me],J,R,le==="Polygon",me===0);else if(le==="MultiPolygon")for(let me=0;me<X.length;me++){const ne=X[me];for(let we=0;we<ne.length;we++)Tt(ce,ne[we],J,R,!0,we===0)}if(ce.length){let me=D.tags||null;if(le==="LineString"&&q.lineMetrics){me={};for(const we in D.tags)me[we]=D.tags[we];me.mapbox_clip_start=X.start/X.size,me.mapbox_clip_end=X.end/X.size}const ne={geometry:ce,type:le==="Polygon"||le==="MultiPolygon"?3:le==="LineString"||le==="MultiLineString"?2:1,tags:me};D.id!==null&&(ne.id=D.id),J.features.push(ne)}}function Tt(J,D,R,q,X,le){const ce=q*q;if(q>0&&D.size<(X?ce:q))return void(R.numPoints+=D.length/3);const me=[];for(let ne=0;ne<D.length;ne+=3)(q===0||D[ne+2]>ce)&&(R.numSimplified++,me.push(D[ne],D[ne+1])),R.numPoints++;X&&function(ne,we){let Ie=0;for(let ve=0,Re=ne.length,nt=Re-2;ve<Re;nt=ve,ve+=2)Ie+=(ne[ve]-ne[nt])*(ne[ve+1]+ne[nt+1]);if(Ie>0===we)for(let ve=0,Re=ne.length;ve<Re/2;ve+=2){const nt=ne[ve],at=ne[ve+1];ne[ve]=ne[Re-2-ve],ne[ve+1]=ne[Re-1-ve],ne[Re-2-ve]=nt,ne[Re-1-ve]=at}}(me,le),J.push(me)}const ht={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class On{constructor(D,R){const q=(R=this.options=function(le,ce){for(const me in ce)le[me]=ce[me];return le}(Object.create(ht),R)).debug;if(q&&console.time("preprocess data"),R.maxZoom<0||R.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(R.promoteId&&R.generateId)throw new Error("promoteId and generateId cannot be used together.");let X=function(le,ce){const me=[];if(le.type==="FeatureCollection")for(let ne=0;ne<le.features.length;ne++)io(me,le.features[ne],ce,ne);else io(me,le.type==="Feature"?le:{geometry:le},ce);return me}(D,R);this.tiles={},this.tileCoords=[],q&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",R.indexMaxZoom,R.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),X=function(le,ce){const me=ce.buffer/ce.extent;let ne=le;const we=ir(le,1,-1-me,me,0,-1,2,ce),Ie=ir(le,1,1-me,2+me,0,-1,2,ce);return(we||Ie)&&(ne=ir(le,1,-me,1+me,0,-1,2,ce)||[],we&&(ne=ze(we,1).concat(ne)),Ie&&(ne=ne.concat(ze(Ie,-1)))),ne}(X,R),X.length&&this.splitTile(X,0,0,0),q&&(X.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(D,R,q,X,le,ce,me){const ne=[D,R,q,X],we=this.options,Ie=we.debug;for(;ne.length;){X=ne.pop(),q=ne.pop(),R=ne.pop(),D=ne.pop();const ve=1<<R,Re=Li(R,q,X);let nt=this.tiles[Re];if(!nt&&(Ie>1&&console.time("creation"),nt=this.tiles[Re]=zi(D,R,q,X,we),this.tileCoords.push({z:R,x:q,y:X}),Ie)){Ie>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",R,q,X,nt.numFeatures,nt.numPoints,nt.numSimplified),console.timeEnd("creation"));const Jr=`z${R}`;this.stats[Jr]=(this.stats[Jr]||0)+1,this.total++}if(nt.source=D,le==null){if(R===we.indexMaxZoom||nt.numPoints<=we.indexMaxPoints)continue}else{if(R===we.maxZoom||R===le)continue;if(le!=null){const Jr=le-R;if(q!==ce>>Jr||X!==me>>Jr)continue}}if(nt.source=null,D.length===0)continue;Ie>1&&console.time("clipping");const at=.5*we.buffer/we.extent,Rt=.5-at,bt=.5+at,Dt=1+at;let Et=null,Or=null,xr=null,Ct=null,Ht=ir(D,ve,q-at,q+bt,0,nt.minX,nt.maxX,we),yr=ir(D,ve,q+Rt,q+Dt,0,nt.minX,nt.maxX,we);D=null,Ht&&(Et=ir(Ht,ve,X-at,X+bt,1,nt.minY,nt.maxY,we),Or=ir(Ht,ve,X+Rt,X+Dt,1,nt.minY,nt.maxY,we),Ht=null),yr&&(xr=ir(yr,ve,X-at,X+bt,1,nt.minY,nt.maxY,we),Ct=ir(yr,ve,X+Rt,X+Dt,1,nt.minY,nt.maxY,we),yr=null),Ie>1&&console.timeEnd("clipping"),ne.push(Et||[],R+1,2*q,2*X),ne.push(Or||[],R+1,2*q,2*X+1),ne.push(xr||[],R+1,2*q+1,2*X),ne.push(Ct||[],R+1,2*q+1,2*X+1)}}getTile(D,R,q){D=+D,R=+R,q=+q;const X=this.options,{extent:le,debug:ce}=X;if(D<0||D>24)return null;const me=1<<D,ne=Li(D,R=R+me&me-1,q);if(this.tiles[ne])return Yr(this.tiles[ne],le);ce>1&&console.log("drilling down to z%d-%d-%d",D,R,q);let we,Ie=D,ve=R,Re=q;for(;!we&&Ie>0;)Ie--,ve>>=1,Re>>=1,we=this.tiles[Li(Ie,ve,Re)];return we&&we.source?(ce>1&&(console.log("found parent tile z%d-%d-%d",Ie,ve,Re),console.time("drilling down")),this.splitTile(we.source,Ie,ve,Re,D,R,q),ce>1&&console.timeEnd("drilling down"),this.tiles[ne]?Yr(this.tiles[ne],le):null):null}}function Li(J,D,R){return 32*((1<<J)*R+D)+J}function xt(J,D){return D?J.properties[D]:J.id}function ao(J,D){if(J==null)return!0;if(J.type==="Feature")return xt(J,D)!=null;if(J.type==="FeatureCollection"){const R=new Set;for(const q of J.features){const X=xt(q,D);if(X==null||R.has(X))return!1;R.add(X)}return!0}return!1}function zo(J,D){const R=new Map;if(J!=null)if(J.type==="Feature")R.set(xt(J,D),J);else for(const q of J.features)R.set(xt(q,D),q);return R}class Ho extends U{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(D,R){return x._(this,void 0,void 0,function*(){const q=D.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const X=this._geoJSONIndex.getTile(q.z,q.x,q.y);if(!X)return null;const le=new class{constructor(me){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=x.X,this.length=me.length,this._features=me}feature(me){return new class{constructor(ne){this._feature=ne,this.extent=x.X,this.type=ne.type,this.properties=ne.tags,"id"in ne&&!isNaN(ne.id)&&(this.id=parseInt(ne.id,10))}loadGeometry(){if(this._feature.type===1){const ne=[];for(const we of this._feature.geometry)ne.push([new x.P(we[0],we[1])]);return ne}{const ne=[];for(const we of this._feature.geometry){const Ie=[];for(const ve of we)Ie.push(new x.P(ve[0],ve[1]));ne.push(Ie)}return ne}}toGeoJSON(ne,we,Ie){return Ae.call(this,ne,we,Ie)}}(this._features[me])}}(X.features);let ce=Fr(le);return ce.byteOffset===0&&ce.byteLength===ce.buffer.byteLength||(ce=new Uint8Array(ce)),{vectorTile:le,rawData:ce.buffer}})}loadData(D){return x._(this,void 0,void 0,function*(){var R;(R=this._pendingRequest)===null||R===void 0||R.abort();const q=!!(D&&D.request&&D.request.collectResourceTiming)&&new x.bv(D.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(D,this._pendingRequest),this._geoJSONIndex=D.cluster?new _r(function({superclusterOptions:ce,clusterProperties:me}){if(!me||!ce)return ce;const ne={},we={},Ie={accumulated:null,zoom:0},ve={properties:null},Re=Object.keys(me);for(const nt of Re){const[at,Rt]=me[nt],bt=x.bC(Rt),Dt=x.bC(typeof at=="string"?[at,["accumulated"],["get",nt]]:at);ne[nt]=bt.value,we[nt]=Dt.value}return ce.map=nt=>{ve.properties=nt;const at={};for(const Rt of Re)at[Rt]=ne[Rt].evaluate(Ie,ve);return at},ce.reduce=(nt,at)=>{ve.properties=at;for(const Rt of Re)Ie.accumulated=nt[Rt],nt[Rt]=we[Rt].evaluate(Ie,ve)},ce}(D)).load((yield this._pendingData).features):(X=yield this._pendingData,new On(X,D.geojsonVtOptions)),this.loaded={};const le={};if(q){const ce=q.finish();ce&&(le.resourceTiming={},le.resourceTiming[D.source]=JSON.parse(JSON.stringify(ce)))}return le}catch(le){if(delete this._pendingRequest,x.bB(le))return{abandoned:!0};throw le}var X})}getData(){return x._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(D){const R=this.loaded;return R&&R[D.uid]?super.reloadTile(D):this.loadTile(D)}loadAndProcessGeoJSON(D,R){return x._(this,void 0,void 0,function*(){let q=yield this.loadGeoJSON(D,R);if(delete this._pendingRequest,typeof q!="object")throw new Error(`Input data given to '${D.source}' is not a valid GeoJSON object.`);if(ae(q,!0),D.filter){const X=x.bC(D.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(X.result==="error")throw new Error(X.value.map(ce=>`${ce.key}: ${ce.message}`).join(", "));q={type:"FeatureCollection",features:q.features.filter(ce=>X.value.evaluate({zoom:0},ce))}}return q})}loadGeoJSON(D,R){return x._(this,void 0,void 0,function*(){const{promoteId:q}=D;if(D.request){const X=yield x.h(D.request,R);return this._dataUpdateable=ao(X.data,q)?zo(X.data,q):void 0,X.data}if(typeof D.data=="string")try{const X=JSON.parse(D.data);return this._dataUpdateable=ao(X,q)?zo(X,q):void 0,X}catch{throw new Error(`Input data given to '${D.source}' is not a valid GeoJSON object.`)}if(!D.dataDiff)throw new Error(`Input data given to '${D.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${D.source}`);return function(X,le,ce){var me,ne,we,Ie;if(le.removeAll&&X.clear(),le.remove)for(const ve of le.remove)X.delete(ve);if(le.add)for(const ve of le.add){const Re=xt(ve,ce);Re!=null&&X.set(Re,ve)}if(le.update)for(const ve of le.update){let Re=X.get(ve.id);if(Re==null)continue;const nt=!ve.removeAllProperties&&(((me=ve.removeProperties)===null||me===void 0?void 0:me.length)>0||((ne=ve.addOrUpdateProperties)===null||ne===void 0?void 0:ne.length)>0);if((ve.newGeometry||ve.removeAllProperties||nt)&&(Re=Object.assign({},Re),X.set(ve.id,Re),nt&&(Re.properties=Object.assign({},Re.properties))),ve.newGeometry&&(Re.geometry=ve.newGeometry),ve.removeAllProperties)Re.properties={};else if(((we=ve.removeProperties)===null||we===void 0?void 0:we.length)>0)for(const at of ve.removeProperties)Object.prototype.hasOwnProperty.call(Re.properties,at)&&delete Re.properties[at];if(((Ie=ve.addOrUpdateProperties)===null||Ie===void 0?void 0:Ie.length)>0)for(const{key:at,value:Rt}of ve.addOrUpdateProperties)Re.properties[at]=Rt}}(this._dataUpdateable,D.dataDiff,q),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(D){return x._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(D){return this._geoJSONIndex.getClusterExpansionZoom(D.clusterId)}getClusterChildren(D){return this._geoJSONIndex.getChildren(D.clusterId)}getClusterLeaves(D){return this._geoJSONIndex.getLeaves(D.clusterId,D.limit,D.offset)}}class so{constructor(D){this.self=D,this.actor=new x.F(D),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(R,q)=>{if(this.externalWorkerSourceTypes[R])throw new Error(`Worker source with name "${R}" already registered.`);this.externalWorkerSourceTypes[R]=q},this.self.addProtocol=x.bi,this.self.removeProtocol=x.bj,this.self.registerRTLTextPlugin=R=>{if(x.bD.isParsed())throw new Error("RTL text plugin already registered.");x.bD.setMethods(R)},this.actor.registerMessageHandler("LDT",(R,q)=>this._getDEMWorkerSource(R,q.source).loadTile(q)),this.actor.registerMessageHandler("RDT",(R,q)=>x._(this,void 0,void 0,function*(){this._getDEMWorkerSource(R,q.source).removeTile(q)})),this.actor.registerMessageHandler("GCEZ",(R,q)=>x._(this,void 0,void 0,function*(){return this._getWorkerSource(R,q.type,q.source).getClusterExpansionZoom(q)})),this.actor.registerMessageHandler("GCC",(R,q)=>x._(this,void 0,void 0,function*(){return this._getWorkerSource(R,q.type,q.source).getClusterChildren(q)})),this.actor.registerMessageHandler("GCL",(R,q)=>x._(this,void 0,void 0,function*(){return this._getWorkerSource(R,q.type,q.source).getClusterLeaves(q)})),this.actor.registerMessageHandler("LD",(R,q)=>this._getWorkerSource(R,q.type,q.source).loadData(q)),this.actor.registerMessageHandler("GD",(R,q)=>this._getWorkerSource(R,q.type,q.source).getData()),this.actor.registerMessageHandler("LT",(R,q)=>this._getWorkerSource(R,q.type,q.source).loadTile(q)),this.actor.registerMessageHandler("RT",(R,q)=>this._getWorkerSource(R,q.type,q.source).reloadTile(q)),this.actor.registerMessageHandler("AT",(R,q)=>this._getWorkerSource(R,q.type,q.source).abortTile(q)),this.actor.registerMessageHandler("RMT",(R,q)=>this._getWorkerSource(R,q.type,q.source).removeTile(q)),this.actor.registerMessageHandler("RS",(R,q)=>x._(this,void 0,void 0,function*(){if(!this.workerSources[R]||!this.workerSources[R][q.type]||!this.workerSources[R][q.type][q.source])return;const X=this.workerSources[R][q.type][q.source];delete this.workerSources[R][q.type][q.source],X.removeSource!==void 0&&X.removeSource(q)})),this.actor.registerMessageHandler("RM",R=>x._(this,void 0,void 0,function*(){delete this.layerIndexes[R],delete this.availableImages[R],delete this.workerSources[R],delete this.demWorkerSources[R]})),this.actor.registerMessageHandler("SR",(R,q)=>x._(this,void 0,void 0,function*(){this.referrer=q})),this.actor.registerMessageHandler("SRPS",(R,q)=>this._syncRTLPluginState(R,q)),this.actor.registerMessageHandler("IS",(R,q)=>x._(this,void 0,void 0,function*(){this.self.importScripts(q)})),this.actor.registerMessageHandler("SI",(R,q)=>this._setImages(R,q)),this.actor.registerMessageHandler("UL",(R,q)=>x._(this,void 0,void 0,function*(){this._getLayerIndex(R).update(q.layers,q.removedIds)})),this.actor.registerMessageHandler("SL",(R,q)=>x._(this,void 0,void 0,function*(){this._getLayerIndex(R).replace(q)}))}_setImages(D,R){return x._(this,void 0,void 0,function*(){this.availableImages[D]=R;for(const q in this.workerSources[D]){const X=this.workerSources[D][q];for(const le in X)X[le].availableImages=R}})}_syncRTLPluginState(D,R){return x._(this,void 0,void 0,function*(){if(x.bD.isParsed())return x.bD.getState();if(R.pluginStatus!=="loading")return x.bD.setState(R),R;const q=R.pluginURL;if(this.self.importScripts(q),x.bD.isParsed()){const X={pluginStatus:"loaded",pluginURL:q};return x.bD.setState(X),X}throw x.bD.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${q}`)})}_getAvailableImages(D){let R=this.availableImages[D];return R||(R=[]),R}_getLayerIndex(D){let R=this.layerIndexes[D];return R||(R=this.layerIndexes[D]=new h),R}_getWorkerSource(D,R,q){if(this.workerSources[D]||(this.workerSources[D]={}),this.workerSources[D][R]||(this.workerSources[D][R]={}),!this.workerSources[D][R][q]){const X={sendAsync:(le,ce)=>(le.targetMapId=D,this.actor.sendAsync(le,ce))};switch(R){case"vector":this.workerSources[D][R][q]=new U(X,this._getLayerIndex(D),this._getAvailableImages(D));break;case"geojson":this.workerSources[D][R][q]=new Ho(X,this._getLayerIndex(D),this._getAvailableImages(D));break;default:this.workerSources[D][R][q]=new this.externalWorkerSourceTypes[R](X,this._getLayerIndex(D),this._getAvailableImages(D))}}return this.workerSources[D][R][q]}_getDEMWorkerSource(D,R){return this.demWorkerSources[D]||(this.demWorkerSources[D]={}),this.demWorkerSources[D][R]||(this.demWorkerSources[D][R]=new O),this.demWorkerSources[D][R]}}return x.i(self)&&(self.worker=new so(self)),so}),f("index",["exports","./shared"],function(x,h){var z="4.7.0";let B,Z;const U={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:g=>new Promise((r,s)=>{const c=requestAnimationFrame(r);g.signal.addEventListener("abort",()=>{cancelAnimationFrame(c),s(h.c())})}),getImageData(g,r=0){return this.getImageCanvasContext(g).getImageData(-r,-r,g.width+2*r,g.height+2*r)},getImageCanvasContext(g){const r=window.document.createElement("canvas"),s=r.getContext("2d",{willReadFrequently:!0});if(!s)throw new Error("failed to create canvas 2d context");return r.width=g.width,r.height=g.height,s.drawImage(g,0,0,g.width,g.height),s},resolveURL:g=>(B||(B=document.createElement("a")),B.href=g,B.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Z==null&&(Z=matchMedia("(prefers-reduced-motion: reduce)")),Z.matches)}};class O{static testProp(r){if(!O.docStyle)return r[0];for(let s=0;s<r.length;s++)if(r[s]in O.docStyle)return r[s];return r[0]}static create(r,s,c){const d=window.document.createElement(r);return s!==void 0&&(d.className=s),c&&c.appendChild(d),d}static createNS(r,s){return window.document.createElementNS(r,s)}static disableDrag(){O.docStyle&&O.selectProp&&(O.userSelect=O.docStyle[O.selectProp],O.docStyle[O.selectProp]="none")}static enableDrag(){O.docStyle&&O.selectProp&&(O.docStyle[O.selectProp]=O.userSelect)}static setTransform(r,s){r.style[O.transformProp]=s}static addEventListener(r,s,c,d={}){r.addEventListener(s,c,"passive"in d?d:d.capture)}static removeEventListener(r,s,c,d={}){r.removeEventListener(s,c,"passive"in d?d:d.capture)}static suppressClickInternal(r){r.preventDefault(),r.stopPropagation(),window.removeEventListener("click",O.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",O.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",O.suppressClickInternal,!0)},0)}static getScale(r){const s=r.getBoundingClientRect();return{x:s.width/r.offsetWidth||1,y:s.height/r.offsetHeight||1,boundingClientRect:s}}static getPoint(r,s,c){const d=s.boundingClientRect;return new h.P((c.clientX-d.left)/s.x-r.clientLeft,(c.clientY-d.top)/s.y-r.clientTop)}static mousePos(r,s){const c=O.getScale(r);return O.getPoint(r,c,s)}static touchPos(r,s){const c=[],d=O.getScale(r);for(let m=0;m<s.length;m++)c.push(O.getPoint(r,d,s[m]));return c}static mouseButton(r){return r.button}static remove(r){r.parentNode&&r.parentNode.removeChild(r)}}O.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,O.selectProp=O.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),O.transformProp=O.testProp(["transform","WebkitTransform"]);const de={supported:!1,testSupport:function(g){!Ae&&ae&&(te?H(g):he=g)}};let he,ae,Ae=!1,te=!1;function H(g){const r=g.createTexture();g.bindTexture(g.TEXTURE_2D,r);try{if(g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,ae),g.isContextLost())return;de.supported=!0}catch{}g.deleteTexture(r),Ae=!0}var ie;typeof document<"u"&&(ae=document.createElement("img"),ae.onload=()=>{he&&H(he),he=null,te=!0},ae.onerror=()=>{Ae=!0,he=null},ae.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(g){let r,s,c,d;g.resetRequestQueue=()=>{r=[],s=0,c=0,d={}},g.addThrottleControl=C=>{const E=c++;return d[E]=C,E},g.removeThrottleControl=C=>{delete d[C],w()},g.getImage=(C,E,P=!0)=>new Promise((M,N)=>{de.supported&&(C.headers||(C.headers={}),C.headers.accept="image/webp,*/*"),h.e(C,{type:"image"}),r.push({abortController:E,requestParameters:C,supportImageRefresh:P,state:"queued",onError:V=>{N(V)},onSuccess:V=>{M(V)}}),w()});const m=C=>h._(this,void 0,void 0,function*(){C.state="running";const{requestParameters:E,supportImageRefresh:P,onError:M,onSuccess:N,abortController:V}=C,G=P===!1&&!h.i(self)&&!h.g(E.url)&&(!E.headers||Object.keys(E.headers).reduce((re,oe)=>re&&oe==="accept",!0));s++;const Y=G?T(E,V):h.m(E,V);try{const re=yield Y;delete C.abortController,C.state="completed",re.data instanceof HTMLImageElement||h.b(re.data)?N(re):re.data&&N({data:yield(ee=re.data,typeof createImageBitmap=="function"?h.d(ee):h.f(ee)),cacheControl:re.cacheControl,expires:re.expires})}catch(re){delete C.abortController,M(re)}finally{s--,w()}var ee}),w=()=>{const C=(()=>{for(const E of Object.keys(d))if(d[E]())return!0;return!1})()?h.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:h.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let E=s;E<C&&r.length>0;E++){const P=r.shift();P.abortController.signal.aborted?E--:m(P)}},T=(C,E)=>new Promise((P,M)=>{const N=new Image,V=C.url,G=C.credentials;G&&G==="include"?N.crossOrigin="use-credentials":(G&&G==="same-origin"||!h.s(V))&&(N.crossOrigin="anonymous"),E.signal.addEventListener("abort",()=>{N.src="",M(h.c())}),N.fetchPriority="high",N.onload=()=>{N.onerror=N.onload=null,P({data:N})},N.onerror=()=>{N.onerror=N.onload=null,E.signal.aborted||M(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},N.src=V})}(ie||(ie={})),ie.resetRequestQueue();class _e{constructor(r){this._transformRequestFn=r}transformRequest(r,s){return this._transformRequestFn&&this._transformRequestFn(r,s)||{url:r}}setTransformRequest(r){this._transformRequestFn=r}}function Se(g){var r=new h.A(3);return r[0]=g[0],r[1]=g[1],r[2]=g[2],r}var Ee,ke=function(g,r,s){return g[0]=r[0]-s[0],g[1]=r[1]-s[1],g[2]=r[2]-s[2],g};Ee=new h.A(3),h.A!=Float32Array&&(Ee[0]=0,Ee[1]=0,Ee[2]=0);var Ze=function(g){var r=g[0],s=g[1];return r*r+s*s};function mt(g){const r=[];if(typeof g=="string")r.push({id:"default",url:g});else if(g&&g.length>0){const s=[];for(const{id:c,url:d}of g){const m=`${c}${d}`;s.indexOf(m)===-1&&(s.push(m),r.push({id:c,url:d}))}}return r}function tt(g,r,s){const c=g.split("?");return c[0]+=`${r}${s}`,c.join("?")}(function(){var g=new h.A(2);h.A!=Float32Array&&(g[0]=0,g[1]=0)})();class ot{constructor(r,s,c,d){this.context=r,this.format=c,this.texture=r.gl.createTexture(),this.update(s,d)}update(r,s,c){const{width:d,height:m}=r,w=!(this.size&&this.size[0]===d&&this.size[1]===m||c),{context:T}=this,{gl:C}=T;if(this.useMipmap=!!(s&&s.useMipmap),C.bindTexture(C.TEXTURE_2D,this.texture),T.pixelStoreUnpackFlipY.set(!1),T.pixelStoreUnpack.set(1),T.pixelStoreUnpackPremultiplyAlpha.set(this.format===C.RGBA&&(!s||s.premultiply!==!1)),w)this.size=[d,m],r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||h.b(r)?C.texImage2D(C.TEXTURE_2D,0,this.format,this.format,C.UNSIGNED_BYTE,r):C.texImage2D(C.TEXTURE_2D,0,this.format,d,m,0,this.format,C.UNSIGNED_BYTE,r.data);else{const{x:E,y:P}=c||{x:0,y:0};r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||h.b(r)?C.texSubImage2D(C.TEXTURE_2D,0,E,P,C.RGBA,C.UNSIGNED_BYTE,r):C.texSubImage2D(C.TEXTURE_2D,0,E,P,d,m,C.RGBA,C.UNSIGNED_BYTE,r.data)}this.useMipmap&&this.isSizePowerOfTwo()&&C.generateMipmap(C.TEXTURE_2D)}bind(r,s,c){const{context:d}=this,{gl:m}=d;m.bindTexture(m.TEXTURE_2D,this.texture),c!==m.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(c=m.LINEAR),r!==this.filter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,r),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,c||r),this.filter=r),s!==this.wrap&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,s),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,s),this.wrap=s)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:r}=this.context;r.deleteTexture(this.texture),this.texture=null}}function $t(g){const{userImage:r}=g;return!!(r&&r.render&&r.render())&&(g.data.replace(new Uint8Array(r.data.buffer)),!0)}class It extends h.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new h.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(r){if(this.loaded!==r&&(this.loaded=r,r)){for(const{ids:s,promiseResolve:c}of this.requestors)c(this._getImagesForIds(s));this.requestors=[]}}getImage(r){const s=this.images[r];if(s&&!s.data&&s.spriteData){const c=s.spriteData;s.data=new h.R({width:c.width,height:c.height},c.context.getImageData(c.x,c.y,c.width,c.height).data),s.spriteData=null}return s}addImage(r,s){if(this.images[r])throw new Error(`Image id ${r} already exist, use updateImage instead`);this._validate(r,s)&&(this.images[r]=s)}_validate(r,s){let c=!0;const d=s.data||s.spriteData;return this._validateStretch(s.stretchX,d&&d.width)||(this.fire(new h.j(new Error(`Image "${r}" has invalid "stretchX" value`))),c=!1),this._validateStretch(s.stretchY,d&&d.height)||(this.fire(new h.j(new Error(`Image "${r}" has invalid "stretchY" value`))),c=!1),this._validateContent(s.content,s)||(this.fire(new h.j(new Error(`Image "${r}" has invalid "content" value`))),c=!1),c}_validateStretch(r,s){if(!r)return!0;let c=0;for(const d of r){if(d[0]<c||d[1]<d[0]||s<d[1])return!1;c=d[1]}return!0}_validateContent(r,s){if(!r)return!0;if(r.length!==4)return!1;const c=s.spriteData,d=c&&c.width||s.data.width,m=c&&c.height||s.data.height;return!(r[0]<0||d<r[0]||r[1]<0||m<r[1]||r[2]<0||d<r[2]||r[3]<0||m<r[3]||r[2]<r[0]||r[3]<r[1])}updateImage(r,s,c=!0){const d=this.getImage(r);if(c&&(d.data.width!==s.data.width||d.data.height!==s.data.height))throw new Error(`size mismatch between old image (${d.data.width}x${d.data.height}) and new image (${s.data.width}x${s.data.height}).`);s.version=d.version+1,this.images[r]=s,this.updatedImages[r]=!0}removeImage(r){const s=this.images[r];delete this.images[r],delete this.patterns[r],s.userImage&&s.userImage.onRemove&&s.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(r){return new Promise((s,c)=>{let d=!0;if(!this.isLoaded())for(const m of r)this.images[m]||(d=!1);this.isLoaded()||d?s(this._getImagesForIds(r)):this.requestors.push({ids:r,promiseResolve:s})})}_getImagesForIds(r){const s={};for(const c of r){let d=this.getImage(c);d||(this.fire(new h.k("styleimagemissing",{id:c})),d=this.getImage(c)),d?s[c]={data:d.data.clone(),pixelRatio:d.pixelRatio,sdf:d.sdf,version:d.version,stretchX:d.stretchX,stretchY:d.stretchY,content:d.content,textFitWidth:d.textFitWidth,textFitHeight:d.textFitHeight,hasRenderCallback:!!(d.userImage&&d.userImage.render)}:h.w(`Image "${c}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return s}getPixelSize(){const{width:r,height:s}=this.atlasImage;return{width:r,height:s}}getPattern(r){const s=this.patterns[r],c=this.getImage(r);if(!c)return null;if(s&&s.position.version===c.version)return s.position;if(s)s.position.version=c.version;else{const d={w:c.data.width+2,h:c.data.height+2,x:0,y:0},m=new h.I(d,c);this.patterns[r]={bin:d,position:m}}return this._updatePatternAtlas(),this.patterns[r].position}bind(r){const s=r.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new ot(r,this.atlasImage,s.RGBA),this.atlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE)}_updatePatternAtlas(){const r=[];for(const m in this.patterns)r.push(this.patterns[m].bin);const{w:s,h:c}=h.p(r),d=this.atlasImage;d.resize({width:s||1,height:c||1});for(const m in this.patterns){const{bin:w}=this.patterns[m],T=w.x+1,C=w.y+1,E=this.getImage(m).data,P=E.width,M=E.height;h.R.copy(E,d,{x:0,y:0},{x:T,y:C},{width:P,height:M}),h.R.copy(E,d,{x:0,y:M-1},{x:T,y:C-1},{width:P,height:1}),h.R.copy(E,d,{x:0,y:0},{x:T,y:C+M},{width:P,height:1}),h.R.copy(E,d,{x:P-1,y:0},{x:T-1,y:C},{width:1,height:M}),h.R.copy(E,d,{x:0,y:0},{x:T+P,y:C},{width:1,height:M})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(r){for(const s of r){if(this.callbackDispatchedThisFrame[s])continue;this.callbackDispatchedThisFrame[s]=!0;const c=this.getImage(s);c||h.w(`Image with ID: "${s}" was not found`),$t(c)&&this.updateImage(s,c)}}}const Bt=1e20;function Pr(g,r,s,c,d,m,w,T,C){for(let E=r;E<r+c;E++)Tr(g,s*m+E,m,d,w,T,C);for(let E=s;E<s+d;E++)Tr(g,E*m+r,1,c,w,T,C)}function Tr(g,r,s,c,d,m,w){m[0]=0,w[0]=-Bt,w[1]=Bt,d[0]=g[r];for(let T=1,C=0,E=0;T<c;T++){d[T]=g[r+T*s];const P=T*T;do{const M=m[C];E=(d[T]-d[M]+P-M*M)/(T-M)/2}while(E<=w[C]&&--C>-1);C++,m[C]=T,w[C]=E,w[C+1]=Bt}for(let T=0,C=0;T<c;T++){for(;w[C+1]<T;)C++;const E=m[C],P=T-E;g[r+T*s]=d[E]+P*P}}class Fr{constructor(r,s){this.requestManager=r,this.localIdeographFontFamily=s,this.entries={}}setURL(r){this.url=r}getGlyphs(r){return h._(this,void 0,void 0,function*(){const s=[];for(const m in r)for(const w of r[m])s.push(this._getAndCacheGlyphsPromise(m,w));const c=yield Promise.all(s),d={};for(const{stack:m,id:w,glyph:T}of c)d[m]||(d[m]={}),d[m][w]=T&&{id:T.id,bitmap:T.bitmap.clone(),metrics:T.metrics};return d})}_getAndCacheGlyphsPromise(r,s){return h._(this,void 0,void 0,function*(){let c=this.entries[r];c||(c=this.entries[r]={glyphs:{},requests:{},ranges:{}});let d=c.glyphs[s];if(d!==void 0)return{stack:r,id:s,glyph:d};if(d=this._tinySDF(c,r,s),d)return c.glyphs[s]=d,{stack:r,id:s,glyph:d};const m=Math.floor(s/256);if(256*m>65535)throw new Error("glyphs > 65535 not supported");if(c.ranges[m])return{stack:r,id:s,glyph:d};if(!this.url)throw new Error("glyphsUrl is not set");if(!c.requests[m]){const T=Fr.loadGlyphRange(r,m,this.url,this.requestManager);c.requests[m]=T}const w=yield c.requests[m];for(const T in w)this._doesCharSupportLocalGlyph(+T)||(c.glyphs[+T]=w[+T]);return c.ranges[m]=!0,{stack:r,id:s,glyph:w[s]||null}})}_doesCharSupportLocalGlyph(r){return!!this.localIdeographFontFamily&&new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(r))}_tinySDF(r,s,c){const d=this.localIdeographFontFamily;if(!d||!this._doesCharSupportLocalGlyph(c))return;let m=r.tinySDF;if(!m){let T="400";/bold/i.test(s)?T="900":/medium/i.test(s)?T="500":/light/i.test(s)&&(T="200"),m=r.tinySDF=new Fr.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:d,fontWeight:T})}const w=m.draw(String.fromCharCode(c));return{id:c,bitmap:new h.o({width:w.width||60,height:w.height||60},w.data),metrics:{width:w.glyphWidth/2||24,height:w.glyphHeight/2||24,left:w.glyphLeft/2+.5||0,top:w.glyphTop/2-27.5||-8,advance:w.glyphAdvance/2||24,isDoubleResolution:!0}}}}Fr.loadGlyphRange=function(g,r,s,c){return h._(this,void 0,void 0,function*(){const d=256*r,m=d+255,w=c.transformRequest(s.replace("{fontstack}",g).replace("{range}",`${d}-${m}`),"Glyphs"),T=yield h.l(w,new AbortController);if(!T||!T.data)throw new Error(`Could not load glyph range. range: ${r}, ${d}-${m}`);const C={};for(const E of h.n(T.data))C[E.id]=E;return C})},Fr.TinySDF=class{constructor({fontSize:g=24,buffer:r=3,radius:s=8,cutoff:c=.25,fontFamily:d="sans-serif",fontWeight:m="normal",fontStyle:w="normal"}={}){this.buffer=r,this.cutoff=c,this.radius=s;const T=this.size=g+4*r,C=this._createCanvas(T),E=this.ctx=C.getContext("2d",{willReadFrequently:!0});E.font=`${w} ${m} ${g}px ${d}`,E.textBaseline="alphabetic",E.textAlign="left",E.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Uint16Array(T)}_createCanvas(g){const r=document.createElement("canvas");return r.width=r.height=g,r}draw(g){const{width:r,actualBoundingBoxAscent:s,actualBoundingBoxDescent:c,actualBoundingBoxLeft:d,actualBoundingBoxRight:m}=this.ctx.measureText(g),w=Math.ceil(s),T=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(m-d))),C=Math.min(this.size-this.buffer,w+Math.ceil(c)),E=T+2*this.buffer,P=C+2*this.buffer,M=Math.max(E*P,0),N=new Uint8ClampedArray(M),V={data:N,width:E,height:P,glyphWidth:T,glyphHeight:C,glyphTop:w,glyphLeft:0,glyphAdvance:r};if(T===0||C===0)return V;const{ctx:G,buffer:Y,gridInner:ee,gridOuter:re}=this;G.clearRect(Y,Y,T,C),G.fillText(g,Y,Y+w);const oe=G.getImageData(Y,Y,T,C);re.fill(Bt,0,M),ee.fill(0,0,M);for(let W=0;W<C;W++)for(let ue=0;ue<T;ue++){const pe=oe.data[4*(W*T+ue)+3]/255;if(pe===0)continue;const ye=(W+Y)*E+ue+Y;if(pe===1)re[ye]=0,ee[ye]=Bt;else{const Ce=.5-pe;re[ye]=Ce>0?Ce*Ce:0,ee[ye]=Ce<0?Ce*Ce:0}}Pr(re,0,0,E,P,E,this.f,this.v,this.z),Pr(ee,Y,Y,T,C,E,this.f,this.v,this.z);for(let W=0;W<M;W++){const ue=Math.sqrt(re[W])-Math.sqrt(ee[W]);N[W]=Math.round(255-255*(ue/this.radius+this.cutoff))}return V}};class Ve{constructor(){this.specification=h.v.light.position}possiblyEvaluate(r,s){return h.x(r.expression.evaluate(s))}interpolate(r,s,c){return{x:h.y.number(r.x,s.x,c),y:h.y.number(r.y,s.y,c),z:h.y.number(r.z,s.z,c)}}}let gt;class yt extends h.E{constructor(r){super(),gt=gt||new h.q({anchor:new h.D(h.v.light.anchor),position:new Ve,color:new h.D(h.v.light.color),intensity:new h.D(h.v.light.intensity)}),this._transitionable=new h.T(gt),this.setLight(r),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,s={}){if(!this._validate(h.r,r,s))for(const c in r){const d=r[c];c.endsWith("-transition")?this._transitionable.setTransition(c.slice(0,-11),d):this._transitionable.setValue(c,d)}}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,s,c){return(!c||c.validate!==!1)&&h.t(this,r.call(h.u,{value:s,style:{glyphs:!0,sprite:!0},styleSpec:h.v}))}}const Pt=new h.q({"sky-color":new h.D(h.v.sky["sky-color"]),"horizon-color":new h.D(h.v.sky["horizon-color"]),"fog-color":new h.D(h.v.sky["fog-color"]),"fog-ground-blend":new h.D(h.v.sky["fog-ground-blend"]),"horizon-fog-blend":new h.D(h.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new h.D(h.v.sky["sky-horizon-blend"]),"atmosphere-blend":new h.D(h.v.sky["atmosphere-blend"])});class Vt extends h.E{constructor(r){super(),this._transitionable=new h.T(Pt),this.setSky(r),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new h.z(0))}setSky(r,s={}){if(!this._validate(h.B,r,s)){r||(r={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const c in r){const d=r[c];c.endsWith("-transition")?this._transitionable.setTransition(c.slice(0,-11),d):this._transitionable.setValue(c,d)}}}getSky(){return this._transitionable.serialize()}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,s,c={}){return(c==null?void 0:c.validate)!==!1&&h.t(this,r.call(h.u,h.e({value:s,style:{glyphs:!0,sprite:!0},styleSpec:h.v})))}calculateFogBlendOpacity(r){return r<60?0:r<70?(r-60)/10:1}}class Jn{constructor(r,s){this.width=r,this.height=s,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(r,s){const c=r.join(",")+String(s);return this.dashEntry[c]||(this.dashEntry[c]=this.addDash(r,s)),this.dashEntry[c]}getDashRanges(r,s,c){const d=[];let m=r.length%2==1?-r[r.length-1]*c:0,w=r[0]*c,T=!0;d.push({left:m,right:w,isDash:T,zeroLength:r[0]===0});let C=r[0];for(let E=1;E<r.length;E++){T=!T;const P=r[E];m=C*c,C+=P,w=C*c,d.push({left:m,right:w,isDash:T,zeroLength:P===0})}return d}addRoundDash(r,s,c){const d=s/2;for(let m=-c;m<=c;m++){const w=this.width*(this.nextRow+c+m);let T=0,C=r[T];for(let E=0;E<this.width;E++){E/C.right>1&&(C=r[++T]);const P=Math.abs(E-C.left),M=Math.abs(E-C.right),N=Math.min(P,M);let V;const G=m/c*(d+1);if(C.isDash){const Y=d-Math.abs(G);V=Math.sqrt(N*N+Y*Y)}else V=d-Math.sqrt(N*N+G*G);this.data[w+E]=Math.max(0,Math.min(255,V+128))}}}addRegularDash(r){for(let T=r.length-1;T>=0;--T){const C=r[T],E=r[T+1];C.zeroLength?r.splice(T,1):E&&E.isDash===C.isDash&&(E.left=C.left,r.splice(T,1))}const s=r[0],c=r[r.length-1];s.isDash===c.isDash&&(s.left=c.left-this.width,c.right=s.right+this.width);const d=this.width*this.nextRow;let m=0,w=r[m];for(let T=0;T<this.width;T++){T/w.right>1&&(w=r[++m]);const C=Math.abs(T-w.left),E=Math.abs(T-w.right),P=Math.min(C,E);this.data[d+T]=Math.max(0,Math.min(255,(w.isDash?P:-P)+128))}}addDash(r,s){const c=s?7:0,d=2*c+1;if(this.nextRow+d>this.height)return h.w("LineAtlas out of space"),null;let m=0;for(let T=0;T<r.length;T++)m+=r[T];if(m!==0){const T=this.width/m,C=this.getDashRanges(r,this.width,T);s?this.addRoundDash(C,T,c):this.addRegularDash(C)}const w={y:(this.nextRow+c+.5)/this.height,height:2*c/this.height,width:m};return this.nextRow+=d,this.dirty=!0,w}bind(r){const s=r.gl;this.texture?(s.bindTexture(s.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,s.texSubImage2D(s.TEXTURE_2D,0,0,0,this.width,this.height,s.ALPHA,s.UNSIGNED_BYTE,this.data))):(this.texture=s.createTexture(),s.bindTexture(s.TEXTURE_2D,this.texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.ALPHA,this.width,this.height,0,s.ALPHA,s.UNSIGNED_BYTE,this.data))}}const _r="maplibre_preloaded_worker_pool";class qr{constructor(){this.active={}}acquire(r){if(!this.workers)for(this.workers=[];this.workers.length<qr.workerCount;)this.workers.push(new Worker(h.a.WORKER_URL));return this.active[r]=!0,this.workers.slice()}release(r){delete this.active[r],this.numActive()===0&&(this.workers.forEach(s=>{s.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[_r]}numActive(){return Object.keys(this.active).length}}const Kr=Math.floor(U.hardwareConcurrency/2);let Br,Qn;function an(){return Br||(Br=new qr),Br}qr.workerCount=h.C(globalThis)?Math.max(Math.min(Kr,3),1):1;class Ao{constructor(r,s){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=s;const c=this.workerPool.acquire(s);for(let d=0;d<c.length;d++){const m=new h.F(c[d],s);m.name=`Worker ${d}`,this.actors.push(m)}if(!this.actors.length)throw new Error("No actors found")}broadcast(r,s){const c=[];for(const d of this.actors)c.push(d.sendAsync({type:r,data:s}));return Promise.all(c)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(r=!0){this.actors.forEach(s=>{s.remove()}),this.actors=[],r&&this.workerPool.release(this.id)}registerMessageHandler(r,s){for(const c of this.actors)c.registerMessageHandler(r,s)}}function pa(){return Qn||(Qn=new Ao(an(),h.G),Qn.registerMessageHandler("GR",(g,r,s)=>h.m(r,s))),Qn}function Ai(g,r){const s=h.H();return h.J(s,s,[1,1,0]),h.K(s,s,[.5*g.width,.5*g.height,1]),h.L(s,s,g.calculatePosMatrix(r.toUnwrapped()))}function no(g,r,s,c,d,m){const w=function(M,N,V){if(M)for(const G of M){const Y=N[G];if(Y&&Y.source===V&&Y.type==="fill-extrusion")return!0}else for(const G in N){const Y=N[G];if(Y.source===V&&Y.type==="fill-extrusion")return!0}return!1}(d&&d.layers,r,g.id),T=m.maxPitchScaleFactor(),C=g.tilesIn(c,T,w);C.sort(io);const E=[];for(const M of C)E.push({wrappedTileID:M.tileID.wrapped().key,queryResults:M.tile.queryRenderedFeatures(r,s,g._state,M.queryGeometry,M.cameraQueryGeometry,M.scale,d,m,T,Ai(g.transform,M.tileID))});const P=function(M){const N={},V={};for(const G of M){const Y=G.queryResults,ee=G.wrappedTileID,re=V[ee]=V[ee]||{};for(const oe in Y){const W=Y[oe],ue=re[oe]=re[oe]||{},pe=N[oe]=N[oe]||[];for(const ye of W)ue[ye.featureIndex]||(ue[ye.featureIndex]=!0,pe.push(ye))}}return N}(E);for(const M in P)P[M].forEach(N=>{const V=N.feature,G=g.getFeatureState(V.layer["source-layer"],V.id);V.source=V.layer.source,V.layer["source-layer"]&&(V.sourceLayer=V.layer["source-layer"]),V.state=G});return P}function io(g,r){const s=g.tileID,c=r.tileID;return s.overscaledZ-c.overscaledZ||s.canonical.y-c.canonical.y||s.wrap-c.wrap||s.canonical.x-c.canonical.x}function Zo(g,r,s){return h._(this,void 0,void 0,function*(){let c=g;if(g.url?c=(yield h.h(r.transformRequest(g.url,"Source"),s)).data:yield U.frameAsync(s),!c)return null;const d=h.M(h.e(c,g),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in c&&c.vector_layers&&(d.vectorLayerIds=c.vector_layers.map(m=>m.id)),d})}class xe{constructor(r,s){r&&(s?this.setSouthWest(r).setNorthEast(s):Array.isArray(r)&&(r.length===4?this.setSouthWest([r[0],r[1]]).setNorthEast([r[2],r[3]]):this.setSouthWest(r[0]).setNorthEast(r[1])))}setNorthEast(r){return this._ne=r instanceof h.N?new h.N(r.lng,r.lat):h.N.convert(r),this}setSouthWest(r){return this._sw=r instanceof h.N?new h.N(r.lng,r.lat):h.N.convert(r),this}extend(r){const s=this._sw,c=this._ne;let d,m;if(r instanceof h.N)d=r,m=r;else{if(!(r instanceof xe))return Array.isArray(r)?r.length===4||r.every(Array.isArray)?this.extend(xe.convert(r)):this.extend(h.N.convert(r)):r&&("lng"in r||"lon"in r)&&"lat"in r?this.extend(h.N.convert(r)):this;if(d=r._sw,m=r._ne,!d||!m)return this}return s||c?(s.lng=Math.min(d.lng,s.lng),s.lat=Math.min(d.lat,s.lat),c.lng=Math.max(m.lng,c.lng),c.lat=Math.max(m.lat,c.lat)):(this._sw=new h.N(d.lng,d.lat),this._ne=new h.N(m.lng,m.lat)),this}getCenter(){return new h.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new h.N(this.getWest(),this.getNorth())}getSouthEast(){return new h.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(r){const{lng:s,lat:c}=h.N.convert(r);let d=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=s&&s>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&d}static convert(r){return r instanceof xe?r:r&&new xe(r)}static fromLngLat(r,s=0){const c=360*s/40075017,d=c/Math.cos(Math.PI/180*r.lat);return new xe(new h.N(r.lng-d,r.lat-c),new h.N(r.lng+d,r.lat+c))}adjustAntiMeridian(){const r=new h.N(this._sw.lng,this._sw.lat),s=new h.N(this._ne.lng,this._ne.lat);return new xe(r,r.lng>s.lng?new h.N(s.lng+360,s.lat):s)}}class Po{constructor(r,s,c){this.bounds=xe.convert(this.validateBounds(r)),this.minzoom=s||0,this.maxzoom=c||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}contains(r){const s=Math.pow(2,r.z),c=Math.floor(h.O(this.bounds.getWest())*s),d=Math.floor(h.Q(this.bounds.getNorth())*s),m=Math.ceil(h.O(this.bounds.getEast())*s),w=Math.ceil(h.Q(this.bounds.getSouth())*s);return r.x>=c&&r.x<m&&r.y>=d&&r.y<w}}class fa extends h.E{constructor(r,s,c,d){if(super(),this.id=r,this.dispatcher=c,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,h.e(this,h.M(s,["url","scheme","tileSize","promoteId"])),this._options=h.e({type:"vector"},s),this._collectResourceTiming=s.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(d)}load(){return h._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new h.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const r=yield Zo(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),r&&(h.e(this,r),r.bounds&&(this.tileBounds=new Po(r.bounds,this.minzoom,this.maxzoom)),this.fire(new h.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new h.k("data",{dataType:"source",sourceDataType:"content"})))}catch(r){this._tileJSONRequest=null,this.fire(new h.j(r))}})}loaded(){return this._loaded}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}onAdd(r){this.map=r,this.load()}setSourceProperty(r){this._tileJSONRequest&&this._tileJSONRequest.abort(),r(),this.load()}setTiles(r){return this.setSourceProperty(()=>{this._options.tiles=r}),this}setUrl(r){return this.setSourceProperty(()=>{this.url=r,this._options.url=r}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return h.e({},this._options)}loadTile(r){return h._(this,void 0,void 0,function*(){const s=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),c={request:this.map._requestManager.transformRequest(s,"Tile"),uid:r.uid,tileID:r.tileID,zoom:r.tileID.overscaledZ,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};c.request.collectResourceTiming=this._collectResourceTiming;let d="RT";if(r.actor&&r.state!=="expired"){if(r.state==="loading")return new Promise((m,w)=>{r.reloadPromise={resolve:m,reject:w}})}else r.actor=this.dispatcher.getActor(),d="LT";r.abortController=new AbortController;try{const m=yield r.actor.sendAsync({type:d,data:c},r.abortController);if(delete r.abortController,r.aborted)return;this._afterTileLoadWorkerResponse(r,m)}catch(m){if(delete r.abortController,r.aborted)return;if(m&&m.status!==404)throw m;this._afterTileLoadWorkerResponse(r,null)}})}_afterTileLoadWorkerResponse(r,s){if(s&&s.resourceTiming&&(r.resourceTiming=s.resourceTiming),s&&this.map._refreshExpiredTiles&&r.setExpiryData(s),r.loadVectorData(s,this.map.painter),r.reloadPromise){const c=r.reloadPromise;r.reloadPromise=null,this.loadTile(r).then(c.resolve).catch(c.reject)}}abortTile(r){return h._(this,void 0,void 0,function*(){r.abortController&&(r.abortController.abort(),delete r.abortController),r.actor&&(yield r.actor.sendAsync({type:"AT",data:{uid:r.uid,type:this.type,source:this.id}}))})}unloadTile(r){return h._(this,void 0,void 0,function*(){r.unloadVectorData(),r.actor&&(yield r.actor.sendAsync({type:"RMT",data:{uid:r.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Lt extends h.E{constructor(r,s,c,d){super(),this.id=r,this.dispatcher=c,this.setEventedParent(d),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=h.e({type:"raster"},s),h.e(this,h.M(s,["url","scheme","tileSize"]))}load(){return h._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new h.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const r=yield Zo(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,r&&(h.e(this,r),r.bounds&&(this.tileBounds=new Po(r.bounds,this.minzoom,this.maxzoom)),this.fire(new h.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new h.k("data",{dataType:"source",sourceDataType:"content"})))}catch(r){this._tileJSONRequest=null,this.fire(new h.j(r))}})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(r){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),r(),this.load()}setTiles(r){return this.setSourceProperty(()=>{this._options.tiles=r}),this}setUrl(r){return this.setSourceProperty(()=>{this.url=r,this._options.url=r}),this}serialize(){return h.e({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r){return h._(this,void 0,void 0,function*(){const s=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);r.abortController=new AbortController;try{const c=yield ie.getImage(this.map._requestManager.transformRequest(s,"Tile"),r.abortController,this.map._refreshExpiredTiles);if(delete r.abortController,r.aborted)return void(r.state="unloaded");if(c&&c.data){this.map._refreshExpiredTiles&&c.cacheControl&&c.expires&&r.setExpiryData({cacheControl:c.cacheControl,expires:c.expires});const d=this.map.painter.context,m=d.gl,w=c.data;r.texture=this.map.painter.getTileTexture(w.width),r.texture?r.texture.update(w,{useMipmap:!0}):(r.texture=new ot(d,w,m.RGBA,{useMipmap:!0}),r.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE,m.LINEAR_MIPMAP_NEAREST)),r.state="loaded"}}catch(c){if(delete r.abortController,r.aborted)r.state="unloaded";else if(c)throw r.state="errored",c}})}abortTile(r){return h._(this,void 0,void 0,function*(){r.abortController&&(r.abortController.abort(),delete r.abortController)})}unloadTile(r){return h._(this,void 0,void 0,function*(){r.texture&&this.map.painter.saveTileTexture(r.texture)})}hasTransition(){return!1}}class ir extends Lt{constructor(r,s,c,d){super(r,s,c,d),this.type="raster-dem",this.maxzoom=22,this._options=h.e({type:"raster-dem"},s),this.encoding=s.encoding||"mapbox",this.redFactor=s.redFactor,this.greenFactor=s.greenFactor,this.blueFactor=s.blueFactor,this.baseShift=s.baseShift}loadTile(r){return h._(this,void 0,void 0,function*(){const s=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),c=this.map._requestManager.transformRequest(s,"Tile");r.neighboringTiles=this._getNeighboringTiles(r.tileID),r.abortController=new AbortController;try{const d=yield ie.getImage(c,r.abortController,this.map._refreshExpiredTiles);if(delete r.abortController,r.aborted)return void(r.state="unloaded");if(d&&d.data){const m=d.data;this.map._refreshExpiredTiles&&d.cacheControl&&d.expires&&r.setExpiryData({cacheControl:d.cacheControl,expires:d.expires});const w=h.b(m)&&h.U()?m:yield this.readImageNow(m),T={type:this.type,uid:r.uid,source:this.id,rawImageData:w,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!r.actor||r.state==="expired"){r.actor=this.dispatcher.getActor();const C=yield r.actor.sendAsync({type:"LDT",data:T});r.dem=C,r.needsHillshadePrepare=!0,r.needsTerrainPrepare=!0,r.state="loaded"}}}catch(d){if(delete r.abortController,r.aborted)r.state="unloaded";else if(d)throw r.state="errored",d}})}readImageNow(r){return h._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&h.V()){const s=r.width+2,c=r.height+2;try{return new h.R({width:s,height:c},yield h.W(r,-1,-1,s,c))}catch{}}return U.getImageData(r,1)})}_getNeighboringTiles(r){const s=r.canonical,c=Math.pow(2,s.z),d=(s.x-1+c)%c,m=s.x===0?r.wrap-1:r.wrap,w=(s.x+1+c)%c,T=s.x+1===c?r.wrap+1:r.wrap,C={};return C[new h.S(r.overscaledZ,m,s.z,d,s.y).key]={backfilled:!1},C[new h.S(r.overscaledZ,T,s.z,w,s.y).key]={backfilled:!1},s.y>0&&(C[new h.S(r.overscaledZ,m,s.z,d,s.y-1).key]={backfilled:!1},C[new h.S(r.overscaledZ,r.wrap,s.z,s.x,s.y-1).key]={backfilled:!1},C[new h.S(r.overscaledZ,T,s.z,w,s.y-1).key]={backfilled:!1}),s.y+1<c&&(C[new h.S(r.overscaledZ,m,s.z,d,s.y+1).key]={backfilled:!1},C[new h.S(r.overscaledZ,r.wrap,s.z,s.x,s.y+1).key]={backfilled:!1},C[new h.S(r.overscaledZ,T,s.z,w,s.y+1).key]={backfilled:!1}),C}unloadTile(r){return h._(this,void 0,void 0,function*(){r.demTexture&&this.map.painter.saveTileTexture(r.demTexture),r.fbo&&(r.fbo.destroy(),delete r.fbo),r.dem&&delete r.dem,delete r.neighboringTiles,r.state="unloaded",r.actor&&(yield r.actor.sendAsync({type:"RDT",data:{type:this.type,uid:r.uid,source:this.id}}))})}}class Mo extends h.E{constructor(r,s,c,d){super(),this.id=r,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=c.getActor(),this.setEventedParent(d),this._data=s.data,this._options=h.e({},s),this._collectResourceTiming=s.collectResourceTiming,s.maxzoom!==void 0&&(this.maxzoom=s.maxzoom),s.type&&(this.type=s.type),s.attribution&&(this.attribution=s.attribution),this.promoteId=s.promoteId;const m=h.X/this.tileSize;s.clusterMaxZoom!==void 0&&this.maxzoom<=s.clusterMaxZoom&&h.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${s.clusterMaxZoom}".`),this.workerOptions=h.e({source:this.id,cluster:s.cluster||!1,geojsonVtOptions:{buffer:(s.buffer!==void 0?s.buffer:128)*m,tolerance:(s.tolerance!==void 0?s.tolerance:.375)*m,extent:h.X,maxZoom:this.maxzoom,lineMetrics:s.lineMetrics||!1,generateId:s.generateId||!1},superclusterOptions:{maxZoom:s.clusterMaxZoom!==void 0?s.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,s.clusterMinPoints||2),extent:h.X,radius:(s.clusterRadius||50)*m,log:!1,generateId:s.generateId||!1},clusterProperties:s.clusterProperties,filter:s.filter},s.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return h._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(r){this.map=r,this.load()}setData(r){return this._data=r,this._updateWorkerData(),this}updateData(r){return this._updateWorkerData(r),this}getData(){return h._(this,void 0,void 0,function*(){const r=h.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:r})})}setClusterOptions(r){return this.workerOptions.cluster=r.cluster,r&&(r.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=r.clusterRadius),r.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=r.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(r){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:r,source:this.id}})}getClusterChildren(r){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:r,source:this.id}})}getClusterLeaves(r,s,c){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:r,limit:s,offset:c}})}_updateWorkerData(r){return h._(this,void 0,void 0,function*(){const s=h.e({type:this.type},this.workerOptions);r?s.dataDiff=r:typeof this._data=="string"?(s.request=this.map._requestManager.transformRequest(U.resolveURL(this._data),"Source"),s.request.collectResourceTiming=this._collectResourceTiming):s.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new h.k("dataloading",{dataType:"source"}));try{const c=yield this.actor.sendAsync({type:"LD",data:s});if(this._pendingLoads--,this._removed||c.abandoned)return void this.fire(new h.k("dataabort",{dataType:"source"}));let d=null;c.resourceTiming&&c.resourceTiming[this.id]&&(d=c.resourceTiming[this.id].slice(0));const m={dataType:"source"};this._collectResourceTiming&&d&&d.length>0&&h.e(m,{resourceTiming:d}),this.fire(new h.k("data",Object.assign(Object.assign({},m),{sourceDataType:"metadata"}))),this.fire(new h.k("data",Object.assign(Object.assign({},m),{sourceDataType:"content"})))}catch(c){if(this._pendingLoads--,this._removed)return void this.fire(new h.k("dataabort",{dataType:"source"}));this.fire(new h.j(c))}})}loaded(){return this._pendingLoads===0}loadTile(r){return h._(this,void 0,void 0,function*(){const s=r.actor?"RT":"LT";r.actor=this.actor;const c={type:this.type,uid:r.uid,tileID:r.tileID,zoom:r.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};r.abortController=new AbortController;const d=yield this.actor.sendAsync({type:s,data:c},r.abortController);delete r.abortController,r.unloadVectorData(),r.aborted||r.loadVectorData(d,this.map.painter,s==="RT")})}abortTile(r){return h._(this,void 0,void 0,function*(){r.abortController&&(r.abortController.abort(),delete r.abortController),r.aborted=!0})}unloadTile(r){return h._(this,void 0,void 0,function*(){r.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:r.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return h.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var oo=h.Y([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Pi extends h.E{constructor(r,s,c,d){super(),this.id=r,this.dispatcher=c,this.coordinates=s.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(d),this.options=s}load(r){return h._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new h.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const s=yield ie.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,s&&s.data&&(this.image=s.data,r&&(this.coordinates=r),this._finishLoading())}catch(s){this._request=null,this._loaded=!0,this.fire(new h.j(s))}})}loaded(){return this._loaded}updateImage(r){return r.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=r.url,this.load(r.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new h.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(r){this.map=r,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(r){this.coordinates=r;const s=r.map(h.Z.fromLngLat);this.tileID=function(d){let m=1/0,w=1/0,T=-1/0,C=-1/0;for(const N of d)m=Math.min(m,N.x),w=Math.min(w,N.y),T=Math.max(T,N.x),C=Math.max(C,N.y);const E=Math.max(T-m,C-w),P=Math.max(0,Math.floor(-Math.log(E)/Math.LN2)),M=Math.pow(2,P);return new h.a1(P,Math.floor((m+T)/2*M),Math.floor((w+C)/2*M))}(s),this.minzoom=this.maxzoom=this.tileID.z;const c=s.map(d=>this.tileID.getTilePoint(d)._round());return this._boundsArray=new h.$,this._boundsArray.emplaceBack(c[0].x,c[0].y,0,0),this._boundsArray.emplaceBack(c[1].x,c[1].y,h.X,0),this._boundsArray.emplaceBack(c[3].x,c[3].y,0,h.X),this._boundsArray.emplaceBack(c[2].x,c[2].y,h.X,h.X),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new h.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const r=this.map.painter.context,s=r.gl;this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,oo.members)),this.boundsSegments||(this.boundsSegments=h.a0.simpleSegment(0,0,4,2)),this.texture||(this.texture=new ot(r,this.image,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));let c=!1;for(const d in this.tiles){const m=this.tiles[d];m.state!=="loaded"&&(m.state="loaded",m.texture=this.texture,c=!0)}c&&this.fire(new h.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(r){return h._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(r.tileID.canonical)?(this.tiles[String(r.tileID.wrap)]=r,r.buckets={}):r.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Mi extends Pi{constructor(r,s,c,d){super(r,s,c,d),this.roundZoom=!0,this.type="video",this.options=s}load(){return h._(this,void 0,void 0,function*(){this._loaded=!1;const r=this.options;this.urls=[];for(const s of r.urls)this.urls.push(this.map._requestManager.transformRequest(s,"Source").url);try{const s=yield h.a3(this.urls);if(this._loaded=!0,!s)return;this.video=s,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(s){this.fire(new h.j(s))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(r){if(this.video){const s=this.video.seekable;r<s.start(0)||r>s.end(0)?this.fire(new h.j(new h.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${s.start(0)} and ${s.end(0)}-second mark.`))):this.video.currentTime=r}}getVideo(){return this.video}onAdd(r){this.map||(this.map=r,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const r=this.map.painter.context,s=r.gl;this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,oo.members)),this.boundsSegments||(this.boundsSegments=h.a0.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,this.video)):(this.texture=new ot(r,this.video,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));let c=!1;for(const d in this.tiles){const m=this.tiles[d];m.state!=="loaded"&&(m.state="loaded",m.texture=this.texture,c=!0)}c&&this.fire(new h.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Xr extends Pi{constructor(r,s,c,d){super(r,s,c,d),s.coordinates?Array.isArray(s.coordinates)&&s.coordinates.length===4&&!s.coordinates.some(m=>!Array.isArray(m)||m.length!==2||m.some(w=>typeof w!="number"))||this.fire(new h.j(new h.a2(`sources.${r}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new h.j(new h.a2(`sources.${r}`,null,'missing required property "coordinates"'))),s.animate&&typeof s.animate!="boolean"&&this.fire(new h.j(new h.a2(`sources.${r}`,null,'optional "animate" property must be a boolean value'))),s.canvas?typeof s.canvas=="string"||s.canvas instanceof HTMLCanvasElement||this.fire(new h.j(new h.a2(`sources.${r}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new h.j(new h.a2(`sources.${r}`,null,'missing required property "canvas"'))),this.options=s,this.animate=s.animate===void 0||s.animate}load(){return h._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new h.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(r){this.map=r,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let r=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,r=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,r=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const s=this.map.painter.context,c=s.gl;this.boundsBuffer||(this.boundsBuffer=s.createVertexBuffer(this._boundsArray,oo.members)),this.boundsSegments||(this.boundsSegments=h.a0.simpleSegment(0,0,4,2)),this.texture?(r||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new ot(s,this.canvas,c.RGBA,{premultiply:!0});let d=!1;for(const m in this.tiles){const w=this.tiles[m];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture,d=!0)}d&&this.fire(new h.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const r of[this.canvas.width,this.canvas.height])if(isNaN(r)||r<=0)return!0;return!1}}const ma={},Go=g=>{switch(g){case"geojson":return Mo;case"image":return Pi;case"raster":return Lt;case"raster-dem":return ir;case"vector":return fa;case"video":return Mi;case"canvas":return Xr}return ma[g]},ze="RTLPluginLoaded";class _t extends h.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=pa()}_syncState(r){return this.status=r,this.dispatcher.broadcast("SRPS",{pluginStatus:r,pluginURL:this.url}).catch(s=>{throw this.status="error",s})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(r){return h._(this,arguments,void 0,function*(s,c=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=U.resolveURL(s),!this.url)throw new Error(`requested url ${s} is invalid`);if(this.status==="unavailable"){if(!c)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return h._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new h.k(ze))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Yr=null;function pi(){return Yr||(Yr=new _t),Yr}class zi{constructor(r,s){this.timeAdded=0,this.fadeEndTime=0,this.tileID=r,this.uid=h.a4(),this.uses=0,this.tileSize=s,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(r){const s=r+this.timeAdded;s<this.fadeEndTime||(this.fadeEndTime=s)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(r){this.demTexture&&r.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(r,s,c){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",r){r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=function(d,m){const w={};if(!m)return w;for(const T of d){const C=T.layerIds.map(E=>m.getLayer(E)).filter(Boolean);if(C.length!==0){T.layers=C,T.stateDependentLayerIds&&(T.stateDependentLayers=T.stateDependentLayerIds.map(E=>C.filter(P=>P.id===E)[0]));for(const E of C)w[E.id]=T}}return w}(r.buckets,s.style),this.hasSymbolBuckets=!1;for(const d in this.buckets){const m=this.buckets[d];if(m instanceof h.a6){if(this.hasSymbolBuckets=!0,!c)break;m.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const d in this.buckets){const m=this.buckets[d];if(m instanceof h.a6&&m.hasRTLText){this.hasRTLText=!0,pi().lazyLoad();break}}this.queryPadding=0;for(const d in this.buckets){const m=this.buckets[d];this.queryPadding=Math.max(this.queryPadding,s.style.getLayer(d).queryRadius(m))}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage)}else this.collisionBoxArray=new h.a5}unloadVectorData(){for(const r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(r){return this.buckets[r.id]}upload(r){for(const c in this.buckets){const d=this.buckets[c];d.uploadPending()&&d.upload(r)}const s=r.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ot(r,this.imageAtlas.image,s.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ot(r,this.glyphAtlasImage,s.ALPHA),this.glyphAtlasImage=null)}prepare(r){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture)}queryRenderedFeatures(r,s,c,d,m,w,T,C,E,P){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:d,cameraQueryGeometry:m,scale:w,tileSize:this.tileSize,pixelPosMatrix:P,transform:C,params:T,queryPadding:this.queryPadding*E},r,s,c):{}}querySourceFeatures(r,s){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const d=c.loadVTLayers(),m=s&&s.sourceLayer?s.sourceLayer:"",w=d._geojsonTileLayer||d[m];if(!w)return;const T=h.a7(s&&s.filter),{z:C,x:E,y:P}=this.tileID.canonical,M={z:C,x:E,y:P};for(let N=0;N<w.length;N++){const V=w.feature(N);if(T.needGeometry){const ee=h.a8(V,!0);if(!T.filter(new h.z(this.tileID.overscaledZ),ee,this.tileID.canonical))continue}else if(!T.filter(new h.z(this.tileID.overscaledZ),V))continue;const G=c.getId(V,m),Y=new h.a9(V,C,E,P,G);Y.tile=M,r.push(Y)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(r){const s=this.expirationTime;if(r.cacheControl){const c=h.aa(r.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){const c=Date.now();let d=!1;if(this.expirationTime>c)d=!1;else if(s)if(this.expirationTime<s)d=!0;else{const m=this.expirationTime-s;m?this.expirationTime=c+Math.max(m,3e4):d=!0}else d=!0;d?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(r,s){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(r).length===0)return;const c=this.latestFeatureIndex.loadVTLayers();for(const d in this.buckets){if(!s.style.hasLayer(d))continue;const m=this.buckets[d],w=m.layers[0].sourceLayer||"_geojsonTileLayer",T=c[w],C=r[w];if(!T||!C||Object.keys(C).length===0)continue;m.update(C,T,this.imageAtlas&&this.imageAtlas.patternPositions||{});const E=s&&s.style&&s.style.getLayer(d);E&&(this.queryPadding=Math.max(this.queryPadding,E.queryRadius(m)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<U.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(r){this.symbolFadeHoldUntil=U.now()+r}setDependencies(r,s){const c={};for(const d of s)c[d]=!0;this.dependencies[r]=c}hasDependency(r,s){for(const c of r){const d=this.dependencies[c];if(d){for(const m of s)if(d[m])return!0}}return!1}}class Be{constructor(r,s){this.max=r,this.onRemove=s,this.reset()}reset(){for(const r in this.data)for(const s of this.data[r])s.timeout&&clearTimeout(s.timeout),this.onRemove(s.value);return this.data={},this.order=[],this}add(r,s,c){const d=r.wrapped().key;this.data[d]===void 0&&(this.data[d]=[]);const m={value:s,timeout:void 0};if(c!==void 0&&(m.timeout=setTimeout(()=>{this.remove(r,m)},c)),this.data[d].push(m),this.order.push(d),this.order.length>this.max){const w=this._getAndRemoveByKey(this.order[0]);w&&this.onRemove(w)}return this}has(r){return r.wrapped().key in this.data}getAndRemove(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null}_getAndRemoveByKey(r){const s=this.data[r].shift();return s.timeout&&clearTimeout(s.timeout),this.data[r].length===0&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),s.value}getByKey(r){const s=this.data[r];return s?s[0].value:null}get(r){return this.has(r)?this.data[r.wrapped().key][0].value:null}remove(r,s){if(!this.has(r))return this;const c=r.wrapped().key,d=s===void 0?0:this.data[c].indexOf(s),m=this.data[c][d];return this.data[c].splice(d,1),m.timeout&&clearTimeout(m.timeout),this.data[c].length===0&&delete this.data[c],this.onRemove(m.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(r){for(this.max=r;this.order.length>this.max;){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}filter(r){const s=[];for(const c in this.data)for(const d of this.data[c])r(d.value)||s.push(d);for(const c of s)this.remove(c.value.tileID,c)}}class Tt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(r,s,c){const d=String(s);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][d]=this.stateChanges[r][d]||{},h.e(this.stateChanges[r][d],c),this.deletedStates[r]===null){this.deletedStates[r]={};for(const m in this.state[r])m!==d&&(this.deletedStates[r][m]=null)}else if(this.deletedStates[r]&&this.deletedStates[r][d]===null){this.deletedStates[r][d]={};for(const m in this.state[r][d])c[m]||(this.deletedStates[r][d][m]=null)}else for(const m in c)this.deletedStates[r]&&this.deletedStates[r][d]&&this.deletedStates[r][d][m]===null&&delete this.deletedStates[r][d][m]}removeFeatureState(r,s,c){if(this.deletedStates[r]===null)return;const d=String(s);if(this.deletedStates[r]=this.deletedStates[r]||{},c&&s!==void 0)this.deletedStates[r][d]!==null&&(this.deletedStates[r][d]=this.deletedStates[r][d]||{},this.deletedStates[r][d][c]=null);else if(s!==void 0)if(this.stateChanges[r]&&this.stateChanges[r][d])for(c in this.deletedStates[r][d]={},this.stateChanges[r][d])this.deletedStates[r][d][c]=null;else this.deletedStates[r][d]=null;else this.deletedStates[r]=null}getState(r,s){const c=String(s),d=h.e({},(this.state[r]||{})[c],(this.stateChanges[r]||{})[c]);if(this.deletedStates[r]===null)return{};if(this.deletedStates[r]){const m=this.deletedStates[r][s];if(m===null)return{};for(const w in m)delete d[w]}return d}initializeTileState(r,s){r.setFeatureState(this.state,s)}coalesceChanges(r,s){const c={};for(const d in this.stateChanges){this.state[d]=this.state[d]||{};const m={};for(const w in this.stateChanges[d])this.state[d][w]||(this.state[d][w]={}),h.e(this.state[d][w],this.stateChanges[d][w]),m[w]=this.state[d][w];c[d]=m}for(const d in this.deletedStates){this.state[d]=this.state[d]||{};const m={};if(this.deletedStates[d]===null)for(const w in this.state[d])m[w]={},this.state[d][w]={};else for(const w in this.deletedStates[d]){if(this.deletedStates[d][w]===null)this.state[d][w]={};else for(const T of Object.keys(this.deletedStates[d][w]))delete this.state[d][w][T];m[w]=this.state[d][w]}c[d]=c[d]||{},h.e(c[d],m)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(const d in r)r[d].setFeatureState(c,s)}}class ht extends h.E{constructor(r,s,c){super(),this.id=r,this.dispatcher=c,this.on("data",d=>this._dataHandler(d)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((d,m,w,T)=>{const C=new(Go(m.type))(d,m,w,T);if(C.id!==d)throw new Error(`Expected Source id to be ${d} instead of ${C.id}`);return C})(r,s,c,this),this._tiles={},this._cache=new Be(0,d=>this._unloadTile(d)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Tt,this._didEmitContent=!1,this._updated=!1}onAdd(r){this.map=r,this._maxTileCacheSize=r?r._maxTileCacheSize:null,this._maxTileCacheZoomLevels=r?r._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(r)}onRemove(r){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(r)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const r in this._tiles){const s=this._tiles[r];if(s.state!=="loaded"&&s.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const r=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,r&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(r,s,c){return h._(this,void 0,void 0,function*(){try{yield this._source.loadTile(r),this._tileLoaded(r,s,c)}catch(d){r.state="errored",d.status!==404?this._source.fire(new h.j(d,{tile:r})):this.update(this.transform,this.terrain)}})}_unloadTile(r){this._source.unloadTile&&this._source.unloadTile(r)}_abortTile(r){this._source.abortTile&&this._source.abortTile(r),this._source.fire(new h.k("dataabort",{tile:r,coord:r.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(r){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const s in this._tiles){const c=this._tiles[s];c.upload(r),c.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(r=>r.tileID).sort(On).map(r=>r.key)}getRenderableIds(r){const s=[];for(const c in this._tiles)this._isIdRenderable(c,r)&&s.push(this._tiles[c]);return r?s.sort((c,d)=>{const m=c.tileID,w=d.tileID,T=new h.P(m.canonical.x,m.canonical.y)._rotate(this.transform.angle),C=new h.P(w.canonical.x,w.canonical.y)._rotate(this.transform.angle);return m.overscaledZ-w.overscaledZ||C.y-T.y||C.x-T.x}).map(c=>c.tileID.key):s.map(c=>c.tileID).sort(On).map(c=>c.key)}hasRenderableParent(r){const s=this.findLoadedParent(r,0);return!!s&&this._isIdRenderable(s.tileID.key)}_isIdRenderable(r,s){return this._tiles[r]&&this._tiles[r].hasData()&&!this._coveredTiles[r]&&(s||!this._tiles[r].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)this._tiles[r].state!=="errored"&&this._reloadTile(r,"reloading")}}_reloadTile(r,s){return h._(this,void 0,void 0,function*(){const c=this._tiles[r];c&&(c.state!=="loading"&&(c.state=s),yield this._loadTile(c,r,s))})}_tileLoaded(r,s,c){r.timeAdded=U.now(),c==="expired"&&(r.refreshedUponExpiration=!0),this._setTileReloadTimer(s,r),this.getSource().type==="raster-dem"&&r.dem&&this._backfillDEM(r),this._state.initializeTileState(r,this.map?this.map.painter:null),r.aborted||this._source.fire(new h.k("data",{dataType:"source",tile:r,coord:r.tileID}))}_backfillDEM(r){const s=this.getRenderableIds();for(let d=0;d<s.length;d++){const m=s[d];if(r.neighboringTiles&&r.neighboringTiles[m]){const w=this.getTileByID(m);c(r,w),c(w,r)}}function c(d,m){d.needsHillshadePrepare=!0,d.needsTerrainPrepare=!0;let w=m.tileID.canonical.x-d.tileID.canonical.x;const T=m.tileID.canonical.y-d.tileID.canonical.y,C=Math.pow(2,d.tileID.canonical.z),E=m.tileID.key;w===0&&T===0||Math.abs(T)>1||(Math.abs(w)>1&&(Math.abs(w+C)===1?w+=C:Math.abs(w-C)===1&&(w-=C)),m.dem&&d.dem&&(d.dem.backfillBorder(m.dem,w,T),d.neighboringTiles&&d.neighboringTiles[E]&&(d.neighboringTiles[E].backfilled=!0)))}}getTile(r){return this.getTileByID(r.key)}getTileByID(r){return this._tiles[r]}_retainLoadedChildren(r,s,c,d){for(const m in this._tiles){let w=this._tiles[m];if(d[m]||!w.hasData()||w.tileID.overscaledZ<=s||w.tileID.overscaledZ>c)continue;let T=w.tileID;for(;w&&w.tileID.overscaledZ>s+1;){const E=w.tileID.scaledTo(w.tileID.overscaledZ-1);w=this._tiles[E.key],w&&w.hasData()&&(T=E)}let C=T;for(;C.overscaledZ>s;)if(C=C.scaledTo(C.overscaledZ-1),r[C.key]){d[T.key]=T;break}}}findLoadedParent(r,s){if(r.key in this._loadedParentTiles){const c=this._loadedParentTiles[r.key];return c&&c.tileID.overscaledZ>=s?c:null}for(let c=r.overscaledZ-1;c>=s;c--){const d=r.scaledTo(c),m=this._getLoadedTile(d);if(m)return m}}findLoadedSibling(r){return this._getLoadedTile(r)}_getLoadedTile(r){const s=this._tiles[r.key];return s&&s.hasData()?s:this._cache.getByKey(r.wrapped().key)}updateCacheSize(r){const s=Math.ceil(r.width/this._source.tileSize)+1,c=Math.ceil(r.height/this._source.tileSize)+1,d=Math.floor(s*c*(this._maxTileCacheZoomLevels===null?h.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),m=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,d):d;this._cache.setMaxSize(m)}handleWrapJump(r){const s=Math.round((r-(this._prevLng===void 0?r:this._prevLng))/360);if(this._prevLng=r,s){const c={};for(const d in this._tiles){const m=this._tiles[d];m.tileID=m.tileID.unwrapTo(m.tileID.wrap+s),c[m.tileID.key]=m}this._tiles=c;for(const d in this._timers)clearTimeout(this._timers[d]),delete this._timers[d];for(const d in this._tiles)this._setTileReloadTimer(d,this._tiles[d])}}_updateCoveredAndRetainedTiles(r,s,c,d,m,w){const T={},C={},E=Object.keys(r),P=U.now();for(const M of E){const N=r[M],V=this._tiles[M];if(!V||V.fadeEndTime!==0&&V.fadeEndTime<=P)continue;const G=this.findLoadedParent(N,s),Y=this.findLoadedSibling(N),ee=G||Y||null;ee&&(this._addTile(ee.tileID),T[ee.tileID.key]=ee.tileID),C[M]=N}this._retainLoadedChildren(C,d,c,r);for(const M in T)r[M]||(this._coveredTiles[M]=!0,r[M]=T[M]);if(w){const M={},N={};for(const V of m)this._tiles[V.key].hasData()?M[V.key]=V:N[V.key]=V;for(const V in N){const G=N[V].children(this._source.maxzoom);this._tiles[G[0].key]&&this._tiles[G[1].key]&&this._tiles[G[2].key]&&this._tiles[G[3].key]&&(M[G[0].key]=r[G[0].key]=G[0],M[G[1].key]=r[G[1].key]=G[1],M[G[2].key]=r[G[2].key]=G[2],M[G[3].key]=r[G[3].key]=G[3],delete N[V])}for(const V in N){const G=N[V],Y=this.findLoadedParent(G,this._source.minzoom),ee=this.findLoadedSibling(G),re=Y||ee||null;if(re){M[re.tileID.key]=r[re.tileID.key]=re.tileID;for(const oe in M)M[oe].isChildOf(re.tileID)&&delete M[oe]}}for(const V in this._tiles)M[V]||(this._coveredTiles[V]=!0)}}update(r,s){if(!this._sourceLoaded||this._paused)return;let c;this.transform=r,this.terrain=s,this.updateCacheSize(r),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?c=r.getVisibleUnwrappedCoordinates(this._source.tileID).map(P=>new h.S(P.canonical.z,P.wrap,P.canonical.z,P.canonical.x,P.canonical.y)):(c=r.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:s}),this._source.hasTile&&(c=c.filter(P=>this._source.hasTile(P)))):c=[];const d=r.coveringZoomLevel(this._source),m=Math.max(d-ht.maxOverzooming,this._source.minzoom),w=Math.max(d+ht.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const P={};for(const M of c)if(M.canonical.z>this._source.minzoom){const N=M.scaledTo(M.canonical.z-1);P[N.key]=N;const V=M.scaledTo(Math.max(this._source.minzoom,Math.min(M.canonical.z,5)));P[V.key]=V}c=c.concat(Object.values(P))}const T=c.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,T&&this.fire(new h.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const C=this._updateRetainedTiles(c,d);Li(this._source.type)&&this._updateCoveredAndRetainedTiles(C,m,w,d,c,s);for(const P in C)this._tiles[P].clearFadeHold();const E=h.ab(this._tiles,C);for(const P of E){const M=this._tiles[P];M.hasSymbolBuckets&&!M.holdingForFade()?M.setHoldDuration(this.map._fadeDuration):M.hasSymbolBuckets&&!M.symbolFadeFinished()||this._removeTile(P)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const r in this._tiles)this._tiles[r].holdingForFade()&&this._removeTile(r)}_updateRetainedTiles(r,s){var c;const d={},m={},w=Math.max(s-ht.maxOverzooming,this._source.minzoom),T=Math.max(s+ht.maxUnderzooming,this._source.minzoom),C={};for(const E of r){const P=this._addTile(E);d[E.key]=E,P.hasData()||s<this._source.maxzoom&&(C[E.key]=E)}this._retainLoadedChildren(C,s,T,d);for(const E of r){let P=this._tiles[E.key];if(P.hasData())continue;if(s+1>this._source.maxzoom){const N=E.children(this._source.maxzoom)[0],V=this.getTile(N);if(V&&V.hasData()){d[N.key]=N;continue}}else{const N=E.children(this._source.maxzoom);if(d[N[0].key]&&d[N[1].key]&&d[N[2].key]&&d[N[3].key])continue}let M=P.wasRequested();for(let N=E.overscaledZ-1;N>=w;--N){const V=E.scaledTo(N);if(m[V.key])break;if(m[V.key]=!0,P=this.getTile(V),!P&&M&&(P=this._addTile(V)),P){const G=P.hasData();if((G||!(!((c=this.map)===null||c===void 0)&&c.cancelPendingTileRequestsWhileZooming)||M)&&(d[V.key]=V),M=P.wasRequested(),G)break}}}return d}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const r in this._tiles){const s=[];let c,d=this._tiles[r].tileID;for(;d.overscaledZ>0;){if(d.key in this._loadedParentTiles){c=this._loadedParentTiles[d.key];break}s.push(d.key);const m=d.scaledTo(d.overscaledZ-1);if(c=this._getLoadedTile(m),c)break;d=m}for(const m of s)this._loadedParentTiles[m]=c}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const r in this._tiles){const s=this._tiles[r].tileID,c=this._getLoadedTile(s);this._loadedSiblingTiles[s.key]=c}}_addTile(r){let s=this._tiles[r.key];if(s)return s;s=this._cache.getAndRemove(r),s&&(this._setTileReloadTimer(r.key,s),s.tileID=r,this._state.initializeTileState(s,this.map?this.map.painter:null),this._cacheTimers[r.key]&&(clearTimeout(this._cacheTimers[r.key]),delete this._cacheTimers[r.key],this._setTileReloadTimer(r.key,s)));const c=s;return s||(s=new zi(r,this._source.tileSize*r.overscaleFactor()),this._loadTile(s,r.key,s.state)),s.uses++,this._tiles[r.key]=s,c||this._source.fire(new h.k("dataloading",{tile:s,coord:s.tileID,dataType:"source"})),s}_setTileReloadTimer(r,s){r in this._timers&&(clearTimeout(this._timers[r]),delete this._timers[r]);const c=s.getExpiryTimeout();c&&(this._timers[r]=setTimeout(()=>{this._reloadTile(r,"expired"),delete this._timers[r]},c))}_removeTile(r){const s=this._tiles[r];s&&(s.uses--,delete this._tiles[r],this._timers[r]&&(clearTimeout(this._timers[r]),delete this._timers[r]),s.uses>0||(s.hasData()&&s.state!=="reloading"?this._cache.add(s.tileID,s,s.getExpiryTimeout()):(s.aborted=!0,this._abortTile(s),this._unloadTile(s))))}_dataHandler(r){const s=r.sourceDataType;r.dataType==="source"&&s==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&r.dataType==="source"&&s==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const r in this._tiles)this._removeTile(r);this._cache.reset()}tilesIn(r,s,c){const d=[],m=this.transform;if(!m)return d;const w=c?m.getCameraQueryGeometry(r):r,T=r.map(G=>m.pointCoordinate(G,this.terrain)),C=w.map(G=>m.pointCoordinate(G,this.terrain)),E=this.getIds();let P=1/0,M=1/0,N=-1/0,V=-1/0;for(const G of C)P=Math.min(P,G.x),M=Math.min(M,G.y),N=Math.max(N,G.x),V=Math.max(V,G.y);for(let G=0;G<E.length;G++){const Y=this._tiles[E[G]];if(Y.holdingForFade())continue;const ee=Y.tileID,re=Math.pow(2,m.zoom-Y.tileID.overscaledZ),oe=s*Y.queryPadding*h.X/Y.tileSize/re,W=[ee.getTilePoint(new h.Z(P,M)),ee.getTilePoint(new h.Z(N,V))];if(W[0].x-oe<h.X&&W[0].y-oe<h.X&&W[1].x+oe>=0&&W[1].y+oe>=0){const ue=T.map(ye=>ee.getTilePoint(ye)),pe=C.map(ye=>ee.getTilePoint(ye));d.push({tile:Y,tileID:ee,queryGeometry:ue,cameraQueryGeometry:pe,scale:re})}}return d}getVisibleCoordinates(r){const s=this.getRenderableIds(r).map(c=>this._tiles[c].tileID);for(const c of s)c.posMatrix=this.transform.calculatePosMatrix(c.toUnwrapped());return s}hasTransition(){if(this._source.hasTransition())return!0;if(Li(this._source.type)){const r=U.now();for(const s in this._tiles)if(this._tiles[s].fadeEndTime>=r)return!0}return!1}setFeatureState(r,s,c){this._state.updateState(r=r||"_geojsonTileLayer",s,c)}removeFeatureState(r,s,c){this._state.removeFeatureState(r=r||"_geojsonTileLayer",s,c)}getFeatureState(r,s){return this._state.getState(r=r||"_geojsonTileLayer",s)}setDependencies(r,s,c){const d=this._tiles[r];d&&d.setDependencies(s,c)}reloadTilesForDependencies(r,s){for(const c in this._tiles)this._tiles[c].hasDependency(r,s)&&this._reloadTile(c,"reloading");this._cache.filter(c=>!c.hasDependency(r,s))}}function On(g,r){const s=Math.abs(2*g.wrap)-+(g.wrap<0),c=Math.abs(2*r.wrap)-+(r.wrap<0);return g.overscaledZ-r.overscaledZ||c-s||r.canonical.y-g.canonical.y||r.canonical.x-g.canonical.x}function Li(g){return g==="raster"||g==="image"||g==="video"}ht.maxOverzooming=10,ht.maxUnderzooming=3;class xt{constructor(r,s){this.reset(r,s)}reset(r,s){this.points=r||[],this._distances=[0];for(let c=1;c<this.points.length;c++)this._distances[c]=this._distances[c-1]+this.points[c].dist(this.points[c-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=h.ac(r,0,1);let s=1,c=this._distances[s];const d=r*this.paddedLength+this.padding;for(;c<d&&s<this._distances.length;)c=this._distances[++s];const m=s-1,w=this._distances[m],T=c-w,C=T>0?(d-w)/T:0;return this.points[m].mult(1-C).add(this.points[s].mult(C))}}function ao(g,r){let s=!0;return g==="always"||g!=="never"&&r!=="never"||(s=!1),s}class zo{constructor(r,s,c){const d=this.boxCells=[],m=this.circleCells=[];this.xCellCount=Math.ceil(r/c),this.yCellCount=Math.ceil(s/c);for(let w=0;w<this.xCellCount*this.yCellCount;w++)d.push([]),m.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=s,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,s,c,d,m){this._forEachCell(s,c,d,m,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(s),this.bboxes.push(c),this.bboxes.push(d),this.bboxes.push(m)}insertCircle(r,s,c,d){this._forEachCell(s-d,c-d,s+d,c+d,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(s),this.circles.push(c),this.circles.push(d)}_insertBoxCell(r,s,c,d,m,w){this.boxCells[m].push(w)}_insertCircleCell(r,s,c,d,m,w){this.circleCells[m].push(w)}_query(r,s,c,d,m,w,T){if(c<0||r>this.width||d<0||s>this.height)return[];const C=[];if(r<=0&&s<=0&&this.width<=c&&this.height<=d){if(m)return[{key:null,x1:r,y1:s,x2:c,y2:d}];for(let E=0;E<this.boxKeys.length;E++)C.push({key:this.boxKeys[E],x1:this.bboxes[4*E],y1:this.bboxes[4*E+1],x2:this.bboxes[4*E+2],y2:this.bboxes[4*E+3]});for(let E=0;E<this.circleKeys.length;E++){const P=this.circles[3*E],M=this.circles[3*E+1],N=this.circles[3*E+2];C.push({key:this.circleKeys[E],x1:P-N,y1:M-N,x2:P+N,y2:M+N})}}else this._forEachCell(r,s,c,d,this._queryCell,C,{hitTest:m,overlapMode:w,seenUids:{box:{},circle:{}}},T);return C}query(r,s,c,d){return this._query(r,s,c,d,!1,null)}hitTest(r,s,c,d,m,w){return this._query(r,s,c,d,!0,m,w).length>0}hitTestCircle(r,s,c,d,m){const w=r-c,T=r+c,C=s-c,E=s+c;if(T<0||w>this.width||E<0||C>this.height)return!1;const P=[];return this._forEachCell(w,C,T,E,this._queryCellCircle,P,{hitTest:!0,overlapMode:d,circle:{x:r,y:s,radius:c},seenUids:{box:{},circle:{}}},m),P.length>0}_queryCell(r,s,c,d,m,w,T,C){const{seenUids:E,hitTest:P,overlapMode:M}=T,N=this.boxCells[m];if(N!==null){const G=this.bboxes;for(const Y of N)if(!E.box[Y]){E.box[Y]=!0;const ee=4*Y,re=this.boxKeys[Y];if(r<=G[ee+2]&&s<=G[ee+3]&&c>=G[ee+0]&&d>=G[ee+1]&&(!C||C(re))&&(!P||!ao(M,re.overlapMode))&&(w.push({key:re,x1:G[ee],y1:G[ee+1],x2:G[ee+2],y2:G[ee+3]}),P))return!0}}const V=this.circleCells[m];if(V!==null){const G=this.circles;for(const Y of V)if(!E.circle[Y]){E.circle[Y]=!0;const ee=3*Y,re=this.circleKeys[Y];if(this._circleAndRectCollide(G[ee],G[ee+1],G[ee+2],r,s,c,d)&&(!C||C(re))&&(!P||!ao(M,re.overlapMode))){const oe=G[ee],W=G[ee+1],ue=G[ee+2];if(w.push({key:re,x1:oe-ue,y1:W-ue,x2:oe+ue,y2:W+ue}),P)return!0}}}return!1}_queryCellCircle(r,s,c,d,m,w,T,C){const{circle:E,seenUids:P,overlapMode:M}=T,N=this.boxCells[m];if(N!==null){const G=this.bboxes;for(const Y of N)if(!P.box[Y]){P.box[Y]=!0;const ee=4*Y,re=this.boxKeys[Y];if(this._circleAndRectCollide(E.x,E.y,E.radius,G[ee+0],G[ee+1],G[ee+2],G[ee+3])&&(!C||C(re))&&!ao(M,re.overlapMode))return w.push(!0),!0}}const V=this.circleCells[m];if(V!==null){const G=this.circles;for(const Y of V)if(!P.circle[Y]){P.circle[Y]=!0;const ee=3*Y,re=this.circleKeys[Y];if(this._circlesCollide(G[ee],G[ee+1],G[ee+2],E.x,E.y,E.radius)&&(!C||C(re))&&!ao(M,re.overlapMode))return w.push(!0),!0}}}_forEachCell(r,s,c,d,m,w,T,C){const E=this._convertToXCellCoord(r),P=this._convertToYCellCoord(s),M=this._convertToXCellCoord(c),N=this._convertToYCellCoord(d);for(let V=E;V<=M;V++)for(let G=P;G<=N;G++)if(m.call(this,r,s,c,d,this.xCellCount*G+V,w,T,C))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,s,c,d,m,w){const T=d-r,C=m-s,E=c+w;return E*E>T*T+C*C}_circleAndRectCollide(r,s,c,d,m,w,T){const C=(w-d)/2,E=Math.abs(r-(d+C));if(E>C+c)return!1;const P=(T-m)/2,M=Math.abs(s-(m+P));if(M>P+c)return!1;if(E<=C||M<=P)return!0;const N=E-C,V=M-P;return N*N+V*V<=c*c}}function Ho(g,r,s,c,d){const m=h.H();return r?(h.K(m,m,[1/d,1/d,1]),s||h.ad(m,m,c.angle)):h.L(m,c.labelPlaneMatrix,g),m}function so(g,r,s,c,d){if(r){const m=h.ae(g);return h.K(m,m,[d,d,1]),s||h.ad(m,m,-c.angle),m}return c.glCoordMatrix}function J(g,r,s,c){let d;c?(d=[g,r,c(g,r),1],h.af(d,d,s)):(d=[g,r,0,1],Rt(d,d,s));const m=d[3];return{point:new h.P(d[0]/m,d[1]/m),signedDistanceFromCamera:m,isOccluded:!1}}function D(g,r){return .5+g/r*.5}function R(g,r){return g.x>=-r[0]&&g.x<=r[0]&&g.y>=-r[1]&&g.y<=r[1]}function q(g,r,s,c,d,m,w,T,C,E,P,M,N,V,G){const Y=c?g.textSizeData:g.iconSizeData,ee=h.ag(Y,s.transform.zoom),re=[256/s.width*2+1,256/s.height*2+1],oe=c?g.text.dynamicLayoutVertexArray:g.icon.dynamicLayoutVertexArray;oe.clear();const W=g.lineVertexArray,ue=c?g.text.placedSymbolArray:g.icon.placedSymbolArray,pe=s.transform.width/s.transform.height;let ye=!1;for(let Ce=0;Ce<ue.length;Ce++){const Me=ue.get(Ce);if(Me.hidden||Me.writingMode===h.ah.vertical&&!ye){at(Me.numGlyphs,oe);continue}ye=!1;const $e=J(Me.anchorX,Me.anchorY,r,G);if(!R($e.point,re)){at(Me.numGlyphs,oe);continue}const Ge=D(s.transform.cameraToCenterDistance,$e.signedDistanceFromCamera),Fe=h.ai(Y,ee,Me),De=w?Fe/Ge:Fe*Ge,Je={getElevation:G,labelPlaneMatrix:d,lineVertexArray:W,pitchWithMap:w,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:E,tileAnchorPoint:new h.P(Me.anchorX,Me.anchorY),unwrappedTileID:P,width:M,height:N,translation:V},vt=ce(Je,Me,De,!1,T,r,m,g.glyphOffsetArray,oe,pe,C);ye=vt.useVertical,(vt.notEnoughRoom||ye||vt.needsFlipping&&ce(Je,Me,De,!0,T,r,m,g.glyphOffsetArray,oe,pe,C).notEnoughRoom)&&at(Me.numGlyphs,oe)}c?g.text.dynamicLayoutVertexBuffer.updateData(oe):g.icon.dynamicLayoutVertexBuffer.updateData(oe)}function X(g,r,s,c,d,m,w,T){const C=m.glyphStartIndex+m.numGlyphs,E=m.lineStartIndex,P=m.lineStartIndex+m.lineLength,M=r.getoffsetX(m.glyphStartIndex),N=r.getoffsetX(C-1),V=Re(g*M,s,c,d,m.segment,E,P,T,w);if(!V)return null;const G=Re(g*N,s,c,d,m.segment,E,P,T,w);return G?T.projectionCache.anyProjectionOccluded?null:{first:V,last:G}:null}function le(g,r,s,c){return g===h.ah.horizontal&&Math.abs(s.y-r.y)>Math.abs(s.x-r.x)*c?{useVertical:!0}:(g===h.ah.vertical?r.y<s.y:r.x>s.x)?{needsFlipping:!0}:null}function ce(g,r,s,c,d,m,w,T,C,E,P){const M=s/24,N=r.lineOffsetX*M,V=r.lineOffsetY*M;let G;if(r.numGlyphs>1){const Y=r.glyphStartIndex+r.numGlyphs,ee=r.lineStartIndex,re=r.lineStartIndex+r.lineLength,oe=X(M,T,N,V,c,r,P,g);if(!oe)return{notEnoughRoom:!0};const W=J(oe.first.point.x,oe.first.point.y,w,g.getElevation).point,ue=J(oe.last.point.x,oe.last.point.y,w,g.getElevation).point;if(d&&!c){const pe=le(r.writingMode,W,ue,E);if(pe)return pe}G=[oe.first];for(let pe=r.glyphStartIndex+1;pe<Y-1;pe++)G.push(Re(M*T.getoffsetX(pe),N,V,c,r.segment,ee,re,g,P));G.push(oe.last)}else{if(d&&!c){const ee=J(g.tileAnchorPoint.x,g.tileAnchorPoint.y,m,g.getElevation).point,re=r.lineStartIndex+r.segment+1,oe=new h.P(g.lineVertexArray.getx(re),g.lineVertexArray.gety(re)),W=J(oe.x,oe.y,m,g.getElevation),ue=W.signedDistanceFromCamera>0?W.point:function(ye,Ce,Me,$e,Ge,Fe){return me(ye,Ce,Me,1,Ge,Fe)}(g.tileAnchorPoint,oe,ee,0,m,g),pe=le(r.writingMode,ee,ue,E);if(pe)return pe}const Y=Re(M*T.getoffsetX(r.glyphStartIndex),N,V,c,r.segment,r.lineStartIndex,r.lineStartIndex+r.lineLength,g,P);if(!Y||g.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};G=[Y]}for(const Y of G)h.aj(C,Y.point,Y.angle);return{}}function me(g,r,s,c,d,m){const w=g.add(g.sub(r)._unit()),T=d!==void 0?J(w.x,w.y,d,m.getElevation).point:we(w.x,w.y,m).point,C=s.sub(T);return s.add(C._mult(c/C.mag()))}function ne(g,r,s){const c=r.projectionCache;if(c.projections[g])return c.projections[g];const d=new h.P(r.lineVertexArray.getx(g),r.lineVertexArray.gety(g)),m=we(d.x,d.y,r);if(m.signedDistanceFromCamera>0)return c.projections[g]=m.point,c.anyProjectionOccluded=c.anyProjectionOccluded||m.isOccluded,m.point;const w=g-s.direction;return function(T,C,E,P,M){return me(T,C,E,P,void 0,M)}(s.distanceFromAnchor===0?r.tileAnchorPoint:new h.P(r.lineVertexArray.getx(w),r.lineVertexArray.gety(w)),d,s.previousVertex,s.absOffsetX-s.distanceFromAnchor+1,r)}function we(g,r,s){const c=g+s.translation[0],d=r+s.translation[1];let m;return!s.pitchWithMap&&s.projection.useSpecialProjectionForSymbols?(m=s.projection.projectTileCoordinates(c,d,s.unwrappedTileID,s.getElevation),m.point.x=(.5*m.point.x+.5)*s.width,m.point.y=(.5*-m.point.y+.5)*s.height):(m=J(c,d,s.labelPlaneMatrix,s.getElevation),m.isOccluded=!1),m}function Ie(g,r,s){return g._unit()._perp()._mult(r*s)}function ve(g,r,s,c,d,m,w,T,C){if(T.projectionCache.offsets[g])return T.projectionCache.offsets[g];const E=s.add(r);if(g+C.direction<c||g+C.direction>=d)return T.projectionCache.offsets[g]=E,E;const P=ne(g+C.direction,T,C),M=Ie(P.sub(s),w,C.direction),N=s.add(M),V=P.add(M);return T.projectionCache.offsets[g]=h.ak(m,E,N,V)||E,T.projectionCache.offsets[g]}function Re(g,r,s,c,d,m,w,T,C){const E=c?g-r:g+r;let P=E>0?1:-1,M=0;c&&(P*=-1,M=Math.PI),P<0&&(M+=Math.PI);let N,V=P>0?m+d:m+d+1;T.projectionCache.cachedAnchorPoint?N=T.projectionCache.cachedAnchorPoint:(N=we(T.tileAnchorPoint.x,T.tileAnchorPoint.y,T).point,T.projectionCache.cachedAnchorPoint=N);let G,Y,ee=N,re=N,oe=0,W=0;const ue=Math.abs(E),pe=[];let ye;for(;oe+W<=ue;){if(V+=P,V<m||V>=w)return null;oe+=W,re=ee,Y=G;const $e={absOffsetX:ue,direction:P,distanceFromAnchor:oe,previousVertex:re};if(ee=ne(V,T,$e),s===0)pe.push(re),ye=ee.sub(re);else{let Ge;const Fe=ee.sub(re);Ge=Fe.mag()===0?Ie(ne(V+P,T,$e).sub(ee),s,P):Ie(Fe,s,P),Y||(Y=re.add(Ge)),G=ve(V,Ge,ee,m,w,Y,s,T,$e),pe.push(Y),ye=G.sub(Y)}W=ye.mag()}const Ce=ye._mult((ue-oe)/W)._add(Y||re),Me=M+Math.atan2(ee.y-re.y,ee.x-re.x);return pe.push(Ce),{point:Ce,angle:C?Me:0,path:pe}}const nt=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function at(g,r){for(let s=0;s<g;s++){const c=r.length;r.resize(c+4),r.float32.set(nt,3*c)}}function Rt(g,r,s){const c=r[0],d=r[1];return g[0]=s[0]*c+s[4]*d+s[12],g[1]=s[1]*c+s[5]*d+s[13],g[3]=s[3]*c+s[7]*d+s[15],g}const bt=100;class Dt{constructor(r,s,c=new zo(r.width+200,r.height+200,25),d=new zo(r.width+200,r.height+200,25)){this.transform=r,this.mapProjection=s,this.grid=c,this.ignoredGrid=d,this.pitchFactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+bt,this.screenBottomBoundary=r.height+bt,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(r,s,c,d,m,w,T,C,E,P,M){const N=r.anchorPointX+C[0],V=r.anchorPointY+C[1],G=this.projectAndGetPerspectiveRatio(d,N,V,m,P),Y=c*G.perspectiveRatio;let ee;if(w||T)ee=this._projectCollisionBox(r,Y,d,m,w,T,C,G,P,M);else{const pe=G.point.x+(M?M.x*Y:0),ye=G.point.y+(M?M.y*Y:0);ee={allPointsOccluded:!1,box:[pe+r.x1*Y,ye+r.y1*Y,pe+r.x2*Y,ye+r.y2*Y]}}const[re,oe,W,ue]=ee.box;return this.mapProjection.useSpecialProjectionForSymbols&&(w?ee.allPointsOccluded:this.mapProjection.isOccluded(N,V,m))||G.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(re,oe,W,ue)||s!=="always"&&this.grid.hitTest(re,oe,W,ue,s,E)?{box:[re,oe,W,ue],placeable:!1,offscreen:!1}:{box:[re,oe,W,ue],placeable:!0,offscreen:this.isOffscreen(re,oe,W,ue)}}placeCollisionCircles(r,s,c,d,m,w,T,C,E,P,M,N,V,G,Y,ee){const re=[],oe=new h.P(s.anchorX,s.anchorY),W=this.getPerspectiveRatio(w,oe.x,oe.y,T,ee),ue=(M?m/W:m*W)/h.ap,pe={getElevation:ee,labelPlaneMatrix:C,lineVertexArray:c,pitchWithMap:M,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:oe,unwrappedTileID:T,width:this.transform.width,height:this.transform.height,translation:Y},ye=X(ue,d,s.lineOffsetX*ue,s.lineOffsetY*ue,!1,s,!1,pe);let Ce=!1,Me=!1,$e=!0;if(ye){const Ge=.5*V*W+G,Fe=new h.P(-100,-100),De=new h.P(this.screenRightBoundary,this.screenBottomBoundary),Je=new xt,vt=ye.first,Oe=ye.last;let je=[];for(let wt=vt.path.length-1;wt>=1;wt--)je.push(vt.path[wt]);for(let wt=1;wt<Oe.path.length;wt++)je.push(Oe.path[wt]);const pt=2.5*Ge;if(E){const wt=this.projectPathToScreenSpace(je,pe,E);je=wt.some(At=>At.signedDistanceFromCamera<=0)?[]:wt.map(At=>At.point)}let hr=[];if(je.length>0){const wt=je[0].clone(),At=je[0].clone();for(let dr=1;dr<je.length;dr++)wt.x=Math.min(wt.x,je[dr].x),wt.y=Math.min(wt.y,je[dr].y),At.x=Math.max(At.x,je[dr].x),At.y=Math.max(At.y,je[dr].y);hr=wt.x>=Fe.x&&At.x<=De.x&&wt.y>=Fe.y&&At.y<=De.y?[je]:At.x<Fe.x||wt.x>De.x||At.y<Fe.y||wt.y>De.y?[]:h.al([je],Fe.x,Fe.y,De.x,De.y)}for(const wt of hr){Je.reset(wt,.25*Ge);let At=0;At=Je.length<=.5*Ge?1:Math.ceil(Je.paddedLength/pt)+1;for(let dr=0;dr<At;dr++){const pn=dr/Math.max(At-1,1),Ni=Je.lerp(pn),pr=Ni.x+bt,Un=Ni.y+bt;re.push(pr,Un,Ge,0);const kn=pr-Ge,fn=Un-Ge,In=pr+Ge,ho=Un+Ge;if($e=$e&&this.isOffscreen(kn,fn,In,ho),Me=Me||this.isInsideGrid(kn,fn,In,ho),r!=="always"&&this.grid.hitTestCircle(pr,Un,Ge,r,N)&&(Ce=!0,!P))return{circles:[],offscreen:!1,collisionDetected:Ce}}}}return{circles:!P&&Ce||!Me||W<this.perspectiveRatioCutoff?[]:re,offscreen:$e,collisionDetected:Ce}}projectPathToScreenSpace(r,s,c){return r.map(d=>J(d.x,d.y,c,s.getElevation))}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const s=[];let c=1/0,d=1/0,m=-1/0,w=-1/0;for(const P of r){const M=new h.P(P.x+bt,P.y+bt);c=Math.min(c,M.x),d=Math.min(d,M.y),m=Math.max(m,M.x),w=Math.max(w,M.y),s.push(M)}const T=this.grid.query(c,d,m,w).concat(this.ignoredGrid.query(c,d,m,w)),C={},E={};for(const P of T){const M=P.key;if(C[M.bucketInstanceId]===void 0&&(C[M.bucketInstanceId]={}),C[M.bucketInstanceId][M.featureIndex])continue;const N=[new h.P(P.x1,P.y1),new h.P(P.x2,P.y1),new h.P(P.x2,P.y2),new h.P(P.x1,P.y2)];h.am(s,N)&&(C[M.bucketInstanceId][M.featureIndex]=!0,E[M.bucketInstanceId]===void 0&&(E[M.bucketInstanceId]=[]),E[M.bucketInstanceId].push(M.featureIndex))}return E}insertCollisionBox(r,s,c,d,m,w){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:d,featureIndex:m,collisionGroupID:w,overlapMode:s},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,s,c,d,m,w){const T=c?this.ignoredGrid:this.grid,C={bucketInstanceId:d,featureIndex:m,collisionGroupID:w,overlapMode:s};for(let E=0;E<r.length;E+=4)T.insertCircle(C,r[E],r[E+1],r[E+2])}projectAndGetPerspectiveRatio(r,s,c,d,m){let w;m?(w=[s,c,m(s,c),1],h.af(w,w,r)):(w=[s,c,0,1],Rt(w,w,r));const T=w[3];return{point:new h.P((w[0]/T+1)/2*this.transform.width+bt,(-w[1]/T+1)/2*this.transform.height+bt),perspectiveRatio:.5+this.transform.cameraToCenterDistance/T*.5,isOccluded:!1,signedDistanceFromCamera:T}}getPerspectiveRatio(r,s,c,d,m){const w=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(s,c,d,m):J(s,c,r,m);return .5+this.transform.cameraToCenterDistance/w.signedDistanceFromCamera*.5}isOffscreen(r,s,c,d){return c<bt||r>=this.screenRightBoundary||d<bt||s>this.screenBottomBoundary}isInsideGrid(r,s,c,d){return c>=0&&r<this.gridRightBoundary&&d>=0&&s<this.gridBottomBoundary}getViewportMatrix(){const r=h.an([]);return h.J(r,r,[-100,-100,0]),r}_projectCollisionBox(r,s,c,d,m,w,T,C,E,P){let M=new h.P(1,0),N=new h.P(0,1);const V=new h.P(r.anchorPointX+T[0],r.anchorPointY+T[1]);if(w&&!m){const $e=this.projectAndGetPerspectiveRatio(c,V.x+1,V.y,d,E).point.sub(C.point).unit(),Ge=Math.atan($e.y/$e.x)+($e.x<0?Math.PI:0),Fe=Math.sin(Ge),De=Math.cos(Ge);M=new h.P(De,Fe),N=new h.P(-Fe,De)}else if(!w&&m){const $e=-this.transform.angle,Ge=Math.sin($e),Fe=Math.cos($e);M=new h.P(Fe,Ge),N=new h.P(-Ge,Fe)}let G=C.point,Y=s;if(m){G=V;const $e=this.transform.zoom-Math.floor(this.transform.zoom);Y=Math.pow(2,-$e),Y*=this.mapProjection.getPitchedTextCorrection(this.transform,V,d),P||(Y*=h.ac(.5+C.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}P&&(G=G.add(M.mult(P.x*Y)).add(N.mult(P.y*Y)));const ee=r.x1*Y,re=r.x2*Y,oe=(ee+re)/2,W=r.y1*Y,ue=r.y2*Y,pe=(W+ue)/2,ye=[{offsetX:ee,offsetY:W},{offsetX:oe,offsetY:W},{offsetX:re,offsetY:W},{offsetX:re,offsetY:pe},{offsetX:re,offsetY:ue},{offsetX:oe,offsetY:ue},{offsetX:ee,offsetY:ue},{offsetX:ee,offsetY:pe}];let Ce=[];for(const{offsetX:$e,offsetY:Ge}of ye)Ce.push(new h.P(G.x+M.x*$e+N.x*Ge,G.y+M.y*$e+N.y*Ge));let Me=!1;if(m){const $e=Ce.map(Ge=>this.projectAndGetPerspectiveRatio(c,Ge.x,Ge.y,d,E));Me=$e.some(Ge=>!Ge.isOccluded),Ce=$e.map(Ge=>Ge.point)}else Me=!0;return{box:h.ao(Ce),allPointsOccluded:!Me}}}function Et(g,r,s){return r*(h.X/(g.tileSize*Math.pow(2,s-g.tileID.overscaledZ)))}class Or{constructor(r,s,c,d){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?s:-s))):d&&c?1:0,this.placed=c}isHidden(){return this.opacity===0&&!this.placed}}class xr{constructor(r,s,c,d,m){this.text=new Or(r?r.text:null,s,c,m),this.icon=new Or(r?r.icon:null,s,d,m)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ct{constructor(r,s,c){this.text=r,this.icon=s,this.skipFade=c}}class Ht{constructor(){this.invProjMatrix=h.H(),this.viewportMatrix=h.H(),this.circles=[]}}class yr{constructor(r,s,c,d,m){this.bucketInstanceId=r,this.featureIndex=s,this.sourceLayerIndex=c,this.bucketIndex=d,this.tileID=m}}class Jr{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const s=++this.maxGroupID;this.collisionGroups[r]={ID:s,predicate:c=>c.collisionGroupID===s}}return this.collisionGroups[r]}}function sn(g,r,s,c,d){const{horizontalAlign:m,verticalAlign:w}=h.au(g);return new h.P(-(m-.5)*r+c[0]*d,-(w-.5)*s+c[1]*d)}class Cn{constructor(r,s,c,d,m,w){this.transform=r.clone(),this.terrain=c,this.collisionIndex=new Dt(this.transform,s),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=d,this.retainedQueryData={},this.collisionGroups=new Jr(m),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(r){const s=this.terrain;return s?(c,d)=>s.getElevation(r,c,d):null}getBucketParts(r,s,c,d){const m=c.getBucket(s),w=c.latestFeatureIndex;if(!m||!w||s.id!==m.layerIds[0])return;const T=c.collisionBoxArray,C=m.layers[0].layout,E=m.layers[0].paint,P=Math.pow(2,this.transform.zoom-c.tileID.overscaledZ),M=c.tileSize/h.X,N=c.tileID.toUnwrapped(),V=this.transform.calculatePosMatrix(N),G=C.get("text-pitch-alignment")==="map",Y=C.get("text-rotation-alignment")==="map",ee=Et(c,1,this.transform.zoom),re=this.collisionIndex.mapProjection.translatePosition(this.transform,c,E.get("text-translate"),E.get("text-translate-anchor")),oe=this.collisionIndex.mapProjection.translatePosition(this.transform,c,E.get("icon-translate"),E.get("icon-translate-anchor")),W=Ho(V,G,Y,this.transform,ee);let ue=null;if(G){const ye=so(V,G,Y,this.transform,ee);ue=h.L([],this.transform.labelPlaneMatrix,ye)}this.retainedQueryData[m.bucketInstanceId]=new yr(m.bucketInstanceId,w,m.sourceLayerIndex,m.index,c.tileID);const pe={bucket:m,layout:C,translationText:re,translationIcon:oe,posMatrix:V,unwrappedTileID:N,textLabelPlaneMatrix:W,labelToScreenMatrix:ue,scale:P,textPixelRatio:M,holdingForFade:c.holdingForFade(),collisionBoxArray:T,partiallyEvaluatedTextSize:h.ag(m.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(m.sourceID)};if(d)for(const ye of m.sortKeyRanges){const{sortKey:Ce,symbolInstanceStart:Me,symbolInstanceEnd:$e}=ye;r.push({sortKey:Ce,symbolInstanceStart:Me,symbolInstanceEnd:$e,parameters:pe})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:m.symbolInstances.length,parameters:pe})}attemptAnchorPlacement(r,s,c,d,m,w,T,C,E,P,M,N,V,G,Y,ee,re,oe,W){const ue=h.aq[r.textAnchor],pe=[r.textOffset0,r.textOffset1],ye=sn(ue,c,d,pe,m),Ce=this.collisionIndex.placeCollisionBox(s,N,C,E,P,T,w,ee,M.predicate,W,ye);if((!oe||this.collisionIndex.placeCollisionBox(oe,N,C,E,P,T,w,re,M.predicate,W,ye).placeable)&&Ce.placeable){let Me;if(this.prevPlacement&&this.prevPlacement.variableOffsets[V.crossTileID]&&this.prevPlacement.placements[V.crossTileID]&&this.prevPlacement.placements[V.crossTileID].text&&(Me=this.prevPlacement.variableOffsets[V.crossTileID].anchor),V.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[V.crossTileID]={textOffset:pe,width:c,height:d,anchor:ue,textBoxScale:m,prevAnchor:Me},this.markUsedJustification(G,ue,V,Y),G.allowVerticalPlacement&&(this.markUsedOrientation(G,Y,V),this.placedOrientations[V.crossTileID]=Y),{shift:ye,placedGlyphBoxes:Ce}}}placeLayerBucketPart(r,s,c){const{bucket:d,layout:m,translationText:w,translationIcon:T,posMatrix:C,unwrappedTileID:E,textLabelPlaneMatrix:P,labelToScreenMatrix:M,textPixelRatio:N,holdingForFade:V,collisionBoxArray:G,partiallyEvaluatedTextSize:Y,collisionGroup:ee}=r.parameters,re=m.get("text-optional"),oe=m.get("icon-optional"),W=h.ar(m,"text-overlap","text-allow-overlap"),ue=W==="always",pe=h.ar(m,"icon-overlap","icon-allow-overlap"),ye=pe==="always",Ce=m.get("text-rotation-alignment")==="map",Me=m.get("text-pitch-alignment")==="map",$e=m.get("icon-text-fit")!=="none",Ge=m.get("symbol-z-order")==="viewport-y",Fe=ue&&(ye||!d.hasIconData()||oe),De=ye&&(ue||!d.hasTextData()||re);!d.collisionArrays&&G&&d.deserializeCollisionBoxes(G);const Je=this._getTerrainElevationFunc(this.retainedQueryData[d.bucketInstanceId].tileID),vt=(Oe,je,pt)=>{var hr,wt;if(s[Oe.crossTileID])return;if(V)return void(this.placements[Oe.crossTileID]=new Ct(!1,!1,!1));let At=!1,dr=!1,pn=!0,Ni=null,pr={box:null,placeable:!1,offscreen:null},Un={box:null,placeable:!1,offscreen:null},kn=null,fn=null,In=null,ho=0,fs=0,xu=0;je.textFeatureIndex?ho=je.textFeatureIndex:Oe.useRuntimeCollisionCircles&&(ho=Oe.featureIndex),je.verticalTextFeatureIndex&&(fs=je.verticalTextFeatureIndex);const ms=je.textBox;if(ms){const vi=ln=>{let mn=h.ah.horizontal;if(d.allowVerticalPlacement&&!ln&&this.prevPlacement){const oi=this.prevPlacement.placedOrientations[Oe.crossTileID];oi&&(this.placedOrientations[Oe.crossTileID]=oi,mn=oi,this.markUsedOrientation(d,mn,Oe))}return mn},xi=(ln,mn)=>{if(d.allowVerticalPlacement&&Oe.numVerticalGlyphVertices>0&&je.verticalTextBox){for(const oi of d.writingModes)if(oi===h.ah.vertical?(pr=mn(),Un=pr):pr=ln(),pr&&pr.placeable)break}else pr=ln()},Xo=Oe.textAnchorOffsetStartIndex,$i=Oe.textAnchorOffsetEndIndex;if($i===Xo){const ln=(mn,oi)=>{const zt=this.collisionIndex.placeCollisionBox(mn,W,N,C,E,Me,Ce,w,ee.predicate,Je);return zt&&zt.placeable&&(this.markUsedOrientation(d,oi,Oe),this.placedOrientations[Oe.crossTileID]=oi),zt};xi(()=>ln(ms,h.ah.horizontal),()=>{const mn=je.verticalTextBox;return d.allowVerticalPlacement&&Oe.numVerticalGlyphVertices>0&&mn?ln(mn,h.ah.vertical):{box:null,offscreen:null}}),vi(pr&&pr.placeable)}else{let ln=h.aq[(wt=(hr=this.prevPlacement)===null||hr===void 0?void 0:hr.variableOffsets[Oe.crossTileID])===null||wt===void 0?void 0:wt.anchor];const mn=(zt,Ea,gs)=>{const ys=zt.x2-zt.x1,wp=zt.y2-zt.y1,Fg=Oe.textBoxScale,Sp=$e&&pe==="never"?Ea:null;let Yo=null,Tp=W==="never"?1:2,wu="never";ln&&Tp++;for(let pl=0;pl<Tp;pl++){for(let Su=Xo;Su<$i;Su++){const Tu=d.textAnchorOffsets.get(Su);if(ln&&Tu.textAnchor!==ln)continue;const _s=this.attemptAnchorPlacement(Tu,zt,ys,wp,Fg,Ce,Me,N,C,E,ee,wu,Oe,d,gs,w,T,Sp,Je);if(_s&&(Yo=_s.placedGlyphBoxes,Yo&&Yo.placeable))return At=!0,Ni=_s.shift,Yo}ln?ln=null:wu=W}return c&&!Yo&&(Yo={box:this.collisionIndex.placeCollisionBox(ms,"always",N,C,E,Me,Ce,w,ee.predicate,Je,new h.P(0,0)).box,offscreen:!1,placeable:!1}),Yo};xi(()=>mn(ms,je.iconBox,h.ah.horizontal),()=>{const zt=je.verticalTextBox;return d.allowVerticalPlacement&&(!pr||!pr.placeable)&&Oe.numVerticalGlyphVertices>0&&zt?mn(zt,je.verticalIconBox,h.ah.vertical):{box:null,occluded:!0,offscreen:null}}),pr&&(At=pr.placeable,pn=pr.offscreen);const oi=vi(pr&&pr.placeable);if(!At&&this.prevPlacement){const zt=this.prevPlacement.variableOffsets[Oe.crossTileID];zt&&(this.variableOffsets[Oe.crossTileID]=zt,this.markUsedJustification(d,zt.anchor,Oe,oi))}}}if(kn=pr,At=kn&&kn.placeable,pn=kn&&kn.offscreen,Oe.useRuntimeCollisionCircles){const vi=d.text.placedSymbolArray.get(Oe.centerJustifiedTextSymbolIndex),xi=h.ai(d.textSizeData,Y,vi),Xo=m.get("text-padding");fn=this.collisionIndex.placeCollisionCircles(W,vi,d.lineVertexArray,d.glyphOffsetArray,xi,C,E,P,M,c,Me,ee.predicate,Oe.collisionCircleDiameter,Xo,w,Je),fn.circles.length&&fn.collisionDetected&&!c&&h.w("Collisions detected, but collision boxes are not shown"),At=ue||fn.circles.length>0&&!fn.collisionDetected,pn=pn&&fn.offscreen}if(je.iconFeatureIndex&&(xu=je.iconFeatureIndex),je.iconBox){const vi=xi=>this.collisionIndex.placeCollisionBox(xi,pe,N,C,E,Me,Ce,T,ee.predicate,Je,$e&&Ni?Ni:void 0);Un&&Un.placeable&&je.verticalIconBox?(In=vi(je.verticalIconBox),dr=In.placeable):(In=vi(je.iconBox),dr=In.placeable),pn=pn&&In.offscreen}const _i=re||Oe.numHorizontalGlyphVertices===0&&Oe.numVerticalGlyphVertices===0,bu=oe||Oe.numIconVertices===0;_i||bu?bu?_i||(dr=dr&&At):At=dr&&At:dr=At=dr&&At;const _h=dr&&In.placeable;if(At&&kn.placeable&&this.collisionIndex.insertCollisionBox(kn.box,W,m.get("text-ignore-placement"),d.bucketInstanceId,Un&&Un.placeable&&fs?fs:ho,ee.ID),_h&&this.collisionIndex.insertCollisionBox(In.box,pe,m.get("icon-ignore-placement"),d.bucketInstanceId,xu,ee.ID),fn&&At&&this.collisionIndex.insertCollisionCircles(fn.circles,W,m.get("text-ignore-placement"),d.bucketInstanceId,ho,ee.ID),c&&this.storeCollisionData(d.bucketInstanceId,pt,je,kn,In,fn),Oe.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(d.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Oe.crossTileID]=new Ct(At||Fe,dr||De,pn||d.justReloaded),s[Oe.crossTileID]=!0};if(Ge){if(r.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Oe=d.getSortedSymbolIndexes(this.transform.angle);for(let je=Oe.length-1;je>=0;--je){const pt=Oe[je];vt(d.symbolInstances.get(pt),d.collisionArrays[pt],pt)}}else for(let Oe=r.symbolInstanceStart;Oe<r.symbolInstanceEnd;Oe++)vt(d.symbolInstances.get(Oe),d.collisionArrays[Oe],Oe);if(c&&d.bucketInstanceId in this.collisionCircleArrays){const Oe=this.collisionCircleArrays[d.bucketInstanceId];h.as(Oe.invProjMatrix,C),Oe.viewportMatrix=this.collisionIndex.getViewportMatrix()}d.justReloaded=!1}storeCollisionData(r,s,c,d,m,w){if(c.textBox||c.iconBox){let T,C;this.collisionBoxArrays.has(r)?T=this.collisionBoxArrays.get(r):(T=new Map,this.collisionBoxArrays.set(r,T)),T.has(s)?C=T.get(s):(C={text:null,icon:null},T.set(s,C)),c.textBox&&(C.text=d.box),c.iconBox&&(C.icon=m.box)}if(w){let T=this.collisionCircleArrays[r];T===void 0&&(T=this.collisionCircleArrays[r]=new Ht);for(let C=0;C<w.circles.length;C+=4)T.circles.push(w.circles[C+0]),T.circles.push(w.circles[C+1]),T.circles.push(w.circles[C+2]),T.circles.push(w.collisionDetected?1:0)}}markUsedJustification(r,s,c,d){let m;m=d===h.ah.vertical?c.verticalPlacedTextSymbolIndex:{left:c.leftJustifiedTextSymbolIndex,center:c.centerJustifiedTextSymbolIndex,right:c.rightJustifiedTextSymbolIndex}[h.at(s)];const w=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex,c.verticalPlacedTextSymbolIndex];for(const T of w)T>=0&&(r.text.placedSymbolArray.get(T).crossTileID=m>=0&&T!==m?0:c.crossTileID)}markUsedOrientation(r,s,c){const d=s===h.ah.horizontal||s===h.ah.horizontalOnly?s:0,m=s===h.ah.vertical?s:0,w=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex];for(const T of w)r.text.placedSymbolArray.get(T).placedOrientation=d;c.verticalPlacedTextSymbolIndex&&(r.text.placedSymbolArray.get(c.verticalPlacedTextSymbolIndex).placedOrientation=m)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const s=this.prevPlacement;let c=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;const d=s?s.symbolFadeChange(r):1,m=s?s.opacities:{},w=s?s.variableOffsets:{},T=s?s.placedOrientations:{};for(const C in this.placements){const E=this.placements[C],P=m[C];P?(this.opacities[C]=new xr(P,d,E.text,E.icon),c=c||E.text!==P.text.placed||E.icon!==P.icon.placed):(this.opacities[C]=new xr(null,d,E.text,E.icon,E.skipFade),c=c||E.text||E.icon)}for(const C in m){const E=m[C];if(!this.opacities[C]){const P=new xr(E,d,!1,!1);P.isHidden()||(this.opacities[C]=P,c=c||E.text.placed||E.icon.placed)}}for(const C in w)this.variableOffsets[C]||!this.opacities[C]||this.opacities[C].isHidden()||(this.variableOffsets[C]=w[C]);for(const C in T)this.placedOrientations[C]||!this.opacities[C]||this.opacities[C].isHidden()||(this.placedOrientations[C]=T[C]);if(s&&s.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");c?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:r)}updateLayerOpacities(r,s){const c={};for(const d of s){const m=d.getBucket(r);m&&d.latestFeatureIndex&&r.id===m.layerIds[0]&&this.updateBucketOpacities(m,d.tileID,c,d.collisionBoxArray)}}updateBucketOpacities(r,s,c,d){r.hasTextData()&&(r.text.opacityVertexArray.clear(),r.text.hasVisibleVertices=!1),r.hasIconData()&&(r.icon.opacityVertexArray.clear(),r.icon.hasVisibleVertices=!1),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const m=r.layers[0],w=m.layout,T=new xr(null,0,!1,!1,!0),C=w.get("text-allow-overlap"),E=w.get("icon-allow-overlap"),P=m._unevaluatedLayout.hasValue("text-variable-anchor")||m._unevaluatedLayout.hasValue("text-variable-anchor-offset"),M=w.get("text-rotation-alignment")==="map",N=w.get("text-pitch-alignment")==="map",V=w.get("icon-text-fit")!=="none",G=new xr(null,0,C&&(E||!r.hasIconData()||w.get("icon-optional")),E&&(C||!r.hasTextData()||w.get("text-optional")),!0);!r.collisionArrays&&d&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(d);const Y=(re,oe,W)=>{for(let ue=0;ue<oe/4;ue++)re.opacityVertexArray.emplaceBack(W);re.hasVisibleVertices=re.hasVisibleVertices||W!==Ha},ee=this.collisionBoxArrays.get(r.bucketInstanceId);for(let re=0;re<r.symbolInstances.length;re++){const oe=r.symbolInstances.get(re),{numHorizontalGlyphVertices:W,numVerticalGlyphVertices:ue,crossTileID:pe}=oe;let ye=this.opacities[pe];c[pe]?ye=T:ye||(ye=G,this.opacities[pe]=ye),c[pe]=!0;const Ce=oe.numIconVertices>0,Me=this.placedOrientations[oe.crossTileID],$e=Me===h.ah.vertical,Ge=Me===h.ah.horizontal||Me===h.ah.horizontalOnly;if(W>0||ue>0){const De=ri(ye.text);Y(r.text,W,$e?Ha:De),Y(r.text,ue,Ge?Ha:De);const Je=ye.text.isHidden();[oe.rightJustifiedTextSymbolIndex,oe.centerJustifiedTextSymbolIndex,oe.leftJustifiedTextSymbolIndex].forEach(je=>{je>=0&&(r.text.placedSymbolArray.get(je).hidden=Je||$e?1:0)}),oe.verticalPlacedTextSymbolIndex>=0&&(r.text.placedSymbolArray.get(oe.verticalPlacedTextSymbolIndex).hidden=Je||Ge?1:0);const vt=this.variableOffsets[oe.crossTileID];vt&&this.markUsedJustification(r,vt.anchor,oe,Me);const Oe=this.placedOrientations[oe.crossTileID];Oe&&(this.markUsedJustification(r,"left",oe,Oe),this.markUsedOrientation(r,Oe,oe))}if(Ce){const De=ri(ye.icon),Je=!(V&&oe.verticalPlacedIconSymbolIndex&&$e);oe.placedIconSymbolIndex>=0&&(Y(r.icon,oe.numIconVertices,Je?De:Ha),r.icon.placedSymbolArray.get(oe.placedIconSymbolIndex).hidden=ye.icon.isHidden()),oe.verticalPlacedIconSymbolIndex>=0&&(Y(r.icon,oe.numVerticalIconVertices,Je?Ha:De),r.icon.placedSymbolArray.get(oe.verticalPlacedIconSymbolIndex).hidden=ye.icon.isHidden())}const Fe=ee&&ee.has(re)?ee.get(re):{text:null,icon:null};if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const De=r.collisionArrays[re];if(De){let Je=new h.P(0,0);if(De.textBox||De.verticalTextBox){let vt=!0;if(P){const Oe=this.variableOffsets[pe];Oe?(Je=sn(Oe.anchor,Oe.width,Oe.height,Oe.textOffset,Oe.textBoxScale),M&&Je._rotate(N?this.transform.angle:-this.transform.angle)):vt=!1}if(De.textBox||De.verticalTextBox){let Oe;De.textBox&&(Oe=$e),De.verticalTextBox&&(Oe=Ge),Ga(r.textCollisionBox.collisionVertexArray,ye.text.placed,!vt||Oe,Fe.text,Je.x,Je.y)}}if(De.iconBox||De.verticalIconBox){const vt=!!(!Ge&&De.verticalIconBox);let Oe;De.iconBox&&(Oe=vt),De.verticalIconBox&&(Oe=!vt),Ga(r.iconCollisionBox.collisionVertexArray,ye.icon.placed,Oe,Fe.icon,V?Je.x:0,V?Je.y:0)}}}}if(r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.text.opacityVertexArray.length!==r.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${r.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${r.text.layoutVertexArray.length}) / 4`);if(r.icon.opacityVertexArray.length!==r.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${r.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${r.icon.layoutVertexArray.length}) / 4`);if(r.bucketInstanceId in this.collisionCircleArrays){const re=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=re.invProjMatrix,r.placementViewportMatrix=re.viewportMatrix,r.collisionCircleArray=re.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,s){const c=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*c>r}setStale(){this.stale=!0}}function Ga(g,r,s,c,d,m){c&&c.length!==0||(c=[0,0,0,0]);const w=c[0]-bt,T=c[1]-bt,C=c[2]-bt,E=c[3]-bt;g.emplaceBack(r?1:0,s?1:0,d||0,m||0,w,T),g.emplaceBack(r?1:0,s?1:0,d||0,m||0,C,T),g.emplaceBack(r?1:0,s?1:0,d||0,m||0,C,E),g.emplaceBack(r?1:0,s?1:0,d||0,m||0,w,E)}const Wt=Math.pow(2,25),Ac=Math.pow(2,24),Pc=Math.pow(2,17),ei=Math.pow(2,16),ti=Math.pow(2,9),cg=Math.pow(2,8),fi=Math.pow(2,1);function ri(g){if(g.opacity===0&&!g.placed)return 0;if(g.opacity===1&&g.placed)return 4294967295;const r=g.placed?1:0,s=Math.floor(127*g.opacity);return s*Wt+r*Ac+s*Pc+r*ei+s*ti+r*cg+s*fi+r}const Ha=0;function ga(){return{isOccluded:(g,r,s)=>!1,getPitchedTextCorrection:(g,r,s)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(g,r,s,c){throw new Error("Not implemented.")},translatePosition:(g,r,s,c)=>function(d,m,w,T,C=!1){if(!w[0]&&!w[1])return[0,0];const E=C?T==="map"?d.angle:0:T==="viewport"?-d.angle:0;if(E){const P=Math.sin(E),M=Math.cos(E);w=[w[0]*M-w[1]*P,w[0]*P+w[1]*M]}return[C?w[0]:Et(m,w[0],d.zoom),C?w[1]:Et(m,w[1],d.zoom)]}(g,r,s,c),getCircleRadiusCorrection:g=>1}}class Nr{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&!r.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(r,s,c,d,m){const w=this._bucketParts;for(;this._currentTileIndex<r.length;)if(s.getBucketParts(w,d,r[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,m())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,w.sort((T,C)=>T.sortKey-C.sortKey));this._currentPartIndex<w.length;)if(s.placeLayerBucketPart(w[this._currentPartIndex],this._seenCrossTileIDs,c),this._currentPartIndex++,m())return!0;return!1}}class Ks{constructor(r,s,c,d,m,w,T,C){this.placement=new Cn(r,ga(),s,w,T,C),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=d,this._showCollisionBoxes=m,this._done=!1}isDone(){return this._done}continuePlacement(r,s,c){const d=U.now(),m=()=>!this._forceFullPlacement&&U.now()-d>2;for(;this._currentPlacementIndex>=0;){const w=s[r[this._currentPlacementIndex]],T=this.placement.collisionIndex.transform.zoom;if(w.type==="symbol"&&(!w.minzoom||w.minzoom<=T)&&(!w.maxzoom||w.maxzoom>T)){if(this._inProgressLayer||(this._inProgressLayer=new Nr(w)),this._inProgressLayer.continuePlacement(c[w.source],this.placement,this._showCollisionBoxes,w,m))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const Ri=512/h.X/2;class Mr{constructor(r,s,c){this.tileID=r,this.bucketInstanceId=c,this._symbolsByKey={};const d=new Map;for(let m=0;m<s.length;m++){const w=s.get(m),T=w.key,C=d.get(T);C?C.push(w):d.set(T,[w])}for(const[m,w]of d){const T={positions:w.map(C=>({x:Math.floor(C.anchorX*Ri),y:Math.floor(C.anchorY*Ri)})),crossTileIDs:w.map(C=>C.crossTileID)};if(T.positions.length>128){const C=new h.av(T.positions.length,16,Uint16Array);for(const{x:E,y:P}of T.positions)C.add(E,P);C.finish(),delete T.positions,T.index=C}this._symbolsByKey[m]=T}}getScaledCoordinates(r,s){const{x:c,y:d,z:m}=this.tileID.canonical,{x:w,y:T,z:C}=s.canonical,E=Ri/Math.pow(2,C-m),P=(T*h.X+r.anchorY)*E,M=d*h.X*Ri;return{x:Math.floor((w*h.X+r.anchorX)*E-c*h.X*Ri),y:Math.floor(P-M)}}findMatches(r,s,c){const d=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z);for(let m=0;m<r.length;m++){const w=r.get(m);if(w.crossTileID)continue;const T=this._symbolsByKey[w.key];if(!T)continue;const C=this.getScaledCoordinates(w,s);if(T.index){const E=T.index.range(C.x-d,C.y-d,C.x+d,C.y+d).sort();for(const P of E){const M=T.crossTileIDs[P];if(!c[M]){c[M]=!0,w.crossTileID=M;break}}}else if(T.positions)for(let E=0;E<T.positions.length;E++){const P=T.positions[E],M=T.crossTileIDs[E];if(Math.abs(P.x-C.x)<=d&&Math.abs(P.y-C.y)<=d&&!c[M]){c[M]=!0,w.crossTileID=M;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:r})=>r)}}class Vl{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Di{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const s=Math.round((r-this.lng)/360);if(s!==0)for(const c in this.indexes){const d=this.indexes[c],m={};for(const w in d){const T=d[w];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+s),m[T.tileID.key]=T}this.indexes[c]=m}this.lng=r}addBucket(r,s,c){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let m=0;m<s.symbolInstances.length;m++)s.symbolInstances.get(m).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]={});const d=this.usedCrossTileIDs[r.overscaledZ];for(const m in this.indexes){const w=this.indexes[m];if(Number(m)>r.overscaledZ)for(const T in w){const C=w[T];C.tileID.isChildOf(r)&&C.findMatches(s.symbolInstances,r,d)}else{const T=w[r.scaledTo(Number(m)).key];T&&T.findMatches(s.symbolInstances,r,d)}}for(let m=0;m<s.symbolInstances.length;m++){const w=s.symbolInstances.get(m);w.crossTileID||(w.crossTileID=c.generate(),d[w.crossTileID]=!0)}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new Mr(r,s.symbolInstances,s.bucketInstanceId),!0}removeBucketCrossTileIDs(r,s){for(const c of s.getCrossTileIDsLists())for(const d of c)delete this.usedCrossTileIDs[r][d]}removeStaleBuckets(r){let s=!1;for(const c in this.indexes){const d=this.indexes[c];for(const m in d)r[d[m].bucketInstanceId]||(this.removeBucketCrossTileIDs(c,d[m]),delete d[m],s=!0)}return s}}class Mc{constructor(){this.layerIndexes={},this.crossTileIDs=new Vl,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,s,c){let d=this.layerIndexes[r.id];d===void 0&&(d=this.layerIndexes[r.id]=new Di);let m=!1;const w={};d.handleWrapJump(c);for(const T of s){const C=T.getBucket(r);C&&r.id===C.layerIds[0]&&(C.bucketInstanceId||(C.bucketInstanceId=++this.maxBucketInstanceId),d.addBucket(T.tileID,C,this.crossTileIDs)&&(m=!0),w[C.bucketInstanceId]=!0)}return d.removeStaleBuckets(w)&&(m=!0),m}pruneUnusedLayers(r){const s={};r.forEach(c=>{s[c]=!0});for(const c in this.layerIndexes)s[c]||delete this.layerIndexes[c]}}const Fi=(g,r)=>h.t(g,r&&r.filter(s=>s.identifier!=="source.canvas")),hg=h.aw();class ql extends h.E{constructor(r,s={}){super(),this._rtlPluginLoaded=()=>{for(const c in this.sourceCaches){const d=this.sourceCaches[c].getSource().type;d!=="vector"&&d!=="geojson"||this.sourceCaches[c].reload()}},this.map=r,this.dispatcher=new Ao(an(),r._getMapId()),this.dispatcher.registerMessageHandler("GG",(c,d)=>this.getGlyphs(c,d)),this.dispatcher.registerMessageHandler("GI",(c,d)=>this.getImages(c,d)),this.imageManager=new It,this.imageManager.setEventedParent(this),this.glyphManager=new Fr(r._requestManager,s.localIdeographFontFamily),this.lineAtlas=new Jn(256,512),this.crossTileSymbolIndex=new Mc,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new h.ax,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",h.ay()),pi().on(ze,this._rtlPluginLoaded),this.on("data",c=>{if(c.dataType!=="source"||c.sourceDataType!=="metadata")return;const d=this.sourceCaches[c.sourceId];if(!d)return;const m=d.getSource();if(m&&m.vectorLayerIds)for(const w in this._layers){const T=this._layers[w];T.source===m.id&&this._validateLayer(T)}})}loadURL(r,s={},c){this.fire(new h.k("dataloading",{dataType:"style"})),s.validate=typeof s.validate!="boolean"||s.validate;const d=this.map._requestManager.transformRequest(r,"Style");this._loadStyleRequest=new AbortController;const m=this._loadStyleRequest;h.h(d,this._loadStyleRequest).then(w=>{this._loadStyleRequest=null,this._load(w.data,s,c)}).catch(w=>{this._loadStyleRequest=null,w&&!m.signal.aborted&&this.fire(new h.j(w))})}loadJSON(r,s={},c){this.fire(new h.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,U.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,s.validate=s.validate!==!1,this._load(r,s,c)}).catch(()=>{})}loadEmpty(){this.fire(new h.k("dataloading",{dataType:"style"})),this._load(hg,{validate:!1})}_load(r,s,c){var d;const m=s.transformStyle?s.transformStyle(c,r):r;if(!s.validate||!Fi(this,h.u(m))){this._loaded=!0,this.stylesheet=m;for(const w in m.sources)this.addSource(w,m.sources[w],{validate:!1});m.sprite?this._loadSprite(m.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(m.glyphs),this._createLayers(),this.light=new yt(this.stylesheet.light),this.sky=new Vt(this.stylesheet.sky),this.map.setTerrain((d=this.stylesheet.terrain)!==null&&d!==void 0?d:null),this.fire(new h.k("data",{dataType:"style"})),this.fire(new h.k("style.load"))}}_createLayers(){const r=h.az(this.stylesheet.layers);this.dispatcher.broadcast("SL",r),this._order=r.map(s=>s.id),this._layers={},this._serializedLayers=null;for(const s of r){const c=h.aA(s);c.setEventedParent(this,{layer:{id:s.id}}),this._layers[s.id]=c}}_loadSprite(r,s=!1,c=void 0){let d;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(m,w,T,C){return h._(this,void 0,void 0,function*(){const E=mt(m),P=T>1?"@2x":"",M={},N={};for(const{id:V,url:G}of E){const Y=w.transformRequest(tt(G,P,".json"),"SpriteJSON");M[V]=h.h(Y,C);const ee=w.transformRequest(tt(G,P,".png"),"SpriteImage");N[V]=ie.getImage(ee,C)}return yield Promise.all([...Object.values(M),...Object.values(N)]),function(V,G){return h._(this,void 0,void 0,function*(){const Y={};for(const ee in V){Y[ee]={};const re=U.getImageCanvasContext((yield G[ee]).data),oe=(yield V[ee]).data;for(const W in oe){const{width:ue,height:pe,x:ye,y:Ce,sdf:Me,pixelRatio:$e,stretchX:Ge,stretchY:Fe,content:De,textFitWidth:Je,textFitHeight:vt}=oe[W];Y[ee][W]={data:null,pixelRatio:$e,sdf:Me,stretchX:Ge,stretchY:Fe,content:De,textFitWidth:Je,textFitHeight:vt,spriteData:{width:ue,height:pe,x:ye,y:Ce,context:re}}}}return Y})}(M,N)})}(r,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(m=>{if(this._spriteRequest=null,m)for(const w in m){this._spritesImagesIds[w]=[];const T=this._spritesImagesIds[w]?this._spritesImagesIds[w].filter(C=>!(C in m)):[];for(const C of T)this.imageManager.removeImage(C),this._changedImages[C]=!0;for(const C in m[w]){const E=w==="default"?C:`${w}:${C}`;this._spritesImagesIds[w].push(E),E in this.imageManager.images?this.imageManager.updateImage(E,m[w][C],!1):this.imageManager.addImage(E,m[w][C]),s&&(this._changedImages[E]=!0)}}}).catch(m=>{this._spriteRequest=null,d=m,this.fire(new h.j(d))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),s&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new h.k("data",{dataType:"style"})),c&&c(d)})}_unloadSprite(){for(const r of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(r),this._changedImages[r]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new h.k("data",{dataType:"style"}))}_validateLayer(r){const s=this.sourceCaches[r.source];if(!s)return;const c=r.sourceLayer;if(!c)return;const d=s.getSource();(d.type==="geojson"||d.vectorLayerIds&&d.vectorLayerIds.indexOf(c)===-1)&&this.fire(new h.j(new Error(`Source layer "${c}" does not exist on source "${d.id}" as specified by style layer "${r.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const r in this.sourceCaches)if(!this.sourceCaches[r].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(r,s=!1){const c=this._serializedAllLayers();if(!r||r.length===0)return Object.values(s?h.aB(c):c);const d=[];for(const m of r)if(c[m]){const w=s?h.aB(c[m]):c[m];d.push(w)}return d}_serializedAllLayers(){let r=this._serializedLayers;if(r)return r;r=this._serializedLayers={};const s=Object.keys(this._layers);for(const c of s){const d=this._layers[c];d.type!=="custom"&&(r[c]=d.serialize())}return r}hasTransitions(){if(this.light&&this.light.hasTransition()||this.sky&&this.sky.hasTransition())return!0;for(const r in this.sourceCaches)if(this.sourceCaches[r].hasTransition())return!0;for(const r in this._layers)if(this._layers[r].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(r){if(!this._loaded)return;const s=this._changed;if(s){const d=Object.keys(this._updatedLayers),m=Object.keys(this._removedLayers);(d.length||m.length)&&this._updateWorkerLayers(d,m);for(const w in this._updatedSources){const T=this._updatedSources[w];if(T==="reload")this._reloadSource(w);else{if(T!=="clear")throw new Error(`Invalid action ${T}`);this._clearSource(w)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const w in this._updatedPaintProps)this._layers[w].updateTransitions(r);this.light.updateTransitions(r),this.sky.updateTransitions(r),this._resetUpdates()}const c={};for(const d in this.sourceCaches){const m=this.sourceCaches[d];c[d]=m.used,m.used=!1}for(const d of this._order){const m=this._layers[d];m.recalculate(r,this._availableImages),!m.isHidden(r.zoom)&&m.source&&(this.sourceCaches[m.source].used=!0)}for(const d in c){const m=this.sourceCaches[d];!!c[d]!=!!m.used&&m.fire(new h.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:d}))}this.light.recalculate(r),this.sky.recalculate(r),this.z=r.zoom,s&&this.fire(new h.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const r=Object.keys(this._changedImages);if(r.length){for(const s in this.sourceCaches)this.sourceCaches[s].reloadTilesForDependencies(["icons","patterns"],r);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const r in this.sourceCaches)this.sourceCaches[r].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(r,s){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(r,!1),removedIds:s})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(r,s={}){var c;this._checkLoaded();const d=this.serialize();if(r=s.transformStyle?s.transformStyle(d,r):r,((c=s.validate)===null||c===void 0||c)&&Fi(this,h.u(r)))return!1;(r=h.aB(r)).layers=h.az(r.layers);const m=h.aC(d,r),w=this._getOperationsToPerform(m);if(w.unimplemented.length>0)throw new Error(`Unimplemented: ${w.unimplemented.join(", ")}.`);if(w.operations.length===0)return!1;for(const T of w.operations)T();return this.stylesheet=r,this._serializedLayers=null,!0}_getOperationsToPerform(r){const s=[],c=[];for(const d of r)switch(d.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":s.push(()=>this.addLayer.apply(this,d.args));break;case"removeLayer":s.push(()=>this.removeLayer.apply(this,d.args));break;case"setPaintProperty":s.push(()=>this.setPaintProperty.apply(this,d.args));break;case"setLayoutProperty":s.push(()=>this.setLayoutProperty.apply(this,d.args));break;case"setFilter":s.push(()=>this.setFilter.apply(this,d.args));break;case"addSource":s.push(()=>this.addSource.apply(this,d.args));break;case"removeSource":s.push(()=>this.removeSource.apply(this,d.args));break;case"setLayerZoomRange":s.push(()=>this.setLayerZoomRange.apply(this,d.args));break;case"setLight":s.push(()=>this.setLight.apply(this,d.args));break;case"setGeoJSONSourceData":s.push(()=>this.setGeoJSONSourceData.apply(this,d.args));break;case"setGlyphs":s.push(()=>this.setGlyphs.apply(this,d.args));break;case"setSprite":s.push(()=>this.setSprite.apply(this,d.args));break;case"setSky":s.push(()=>this.setSky.apply(this,d.args));break;case"setTerrain":s.push(()=>this.map.setTerrain.apply(this,d.args));break;case"setTransition":s.push(()=>{});break;default:c.push(d.command)}return{operations:s,unimplemented:c}}addImage(r,s){if(this.getImage(r))return this.fire(new h.j(new Error(`An image named "${r}" already exists.`)));this.imageManager.addImage(r,s),this._afterImageUpdated(r)}updateImage(r,s){this.imageManager.updateImage(r,s)}getImage(r){return this.imageManager.getImage(r)}removeImage(r){if(!this.getImage(r))return this.fire(new h.j(new Error(`An image named "${r}" does not exist.`)));this.imageManager.removeImage(r),this._afterImageUpdated(r)}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(),this._changedImages[r]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new h.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(r,s,c={}){if(this._checkLoaded(),this.sourceCaches[r]!==void 0)throw new Error(`Source "${r}" already exists.`);if(!s.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(s).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(s.type)>=0&&this._validate(h.u.source,`sources.${r}`,s,null,c))return;this.map&&this.map._collectResourceTiming&&(s.collectResourceTiming=!0);const d=this.sourceCaches[r]=new ht(r,s,this.dispatcher);d.style=this,d.setEventedParent(this,()=>({isSourceLoaded:d.loaded(),source:d.serialize(),sourceId:r})),d.onAdd(this.map),this._changed=!0}removeSource(r){if(this._checkLoaded(),this.sourceCaches[r]===void 0)throw new Error("There is no source with this ID");for(const c in this._layers)if(this._layers[c].source===r)return this.fire(new h.j(new Error(`Source "${r}" cannot be removed while layer "${c}" is using it.`)));const s=this.sourceCaches[r];delete this.sourceCaches[r],delete this._updatedSources[r],s.fire(new h.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:r})),s.setEventedParent(null),s.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(r,s){if(this._checkLoaded(),this.sourceCaches[r]===void 0)throw new Error(`There is no source with this ID=${r}`);const c=this.sourceCaches[r].getSource();if(c.type!=="geojson")throw new Error(`geojsonSource.type is ${c.type}, which is !== 'geojson`);c.setData(s),this._changed=!0}getSource(r){return this.sourceCaches[r]&&this.sourceCaches[r].getSource()}addLayer(r,s,c={}){this._checkLoaded();const d=r.id;if(this.getLayer(d))return void this.fire(new h.j(new Error(`Layer "${d}" already exists on this map.`)));let m;if(r.type==="custom"){if(Fi(this,h.aD(r)))return;m=h.aA(r)}else{if("source"in r&&typeof r.source=="object"&&(this.addSource(d,r.source),r=h.aB(r),r=h.e(r,{source:d})),this._validate(h.u.layer,`layers.${d}`,r,{arrayIndex:-1},c))return;m=h.aA(r),this._validateLayer(m),m.setEventedParent(this,{layer:{id:d}})}const w=s?this._order.indexOf(s):this._order.length;if(s&&w===-1)this.fire(new h.j(new Error(`Cannot add layer "${d}" before non-existing layer "${s}".`)));else{if(this._order.splice(w,0,d),this._layerOrderChanged=!0,this._layers[d]=m,this._removedLayers[d]&&m.source&&m.type!=="custom"){const T=this._removedLayers[d];delete this._removedLayers[d],T.type!==m.type?this._updatedSources[m.source]="clear":(this._updatedSources[m.source]="reload",this.sourceCaches[m.source].pause())}this._updateLayer(m),m.onAdd&&m.onAdd(this.map)}}moveLayer(r,s){if(this._checkLoaded(),this._changed=!0,!this._layers[r])return void this.fire(new h.j(new Error(`The layer '${r}' does not exist in the map's style and cannot be moved.`)));if(r===s)return;const c=this._order.indexOf(r);this._order.splice(c,1);const d=s?this._order.indexOf(s):this._order.length;s&&d===-1?this.fire(new h.j(new Error(`Cannot move layer "${r}" before non-existing layer "${s}".`))):(this._order.splice(d,0,r),this._layerOrderChanged=!0)}removeLayer(r){this._checkLoaded();const s=this._layers[r];if(!s)return void this.fire(new h.j(new Error(`Cannot remove non-existing layer "${r}".`)));s.setEventedParent(null);const c=this._order.indexOf(r);this._order.splice(c,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[r]=s,delete this._layers[r],this._serializedLayers&&delete this._serializedLayers[r],delete this._updatedLayers[r],delete this._updatedPaintProps[r],s.onRemove&&s.onRemove(this.map)}getLayer(r){return this._layers[r]}getLayersOrder(){return[...this._order]}hasLayer(r){return r in this._layers}setLayerZoomRange(r,s,c){this._checkLoaded();const d=this.getLayer(r);d?d.minzoom===s&&d.maxzoom===c||(s!=null&&(d.minzoom=s),c!=null&&(d.maxzoom=c),this._updateLayer(d)):this.fire(new h.j(new Error(`Cannot set the zoom range of non-existing layer "${r}".`)))}setFilter(r,s,c={}){this._checkLoaded();const d=this.getLayer(r);if(d){if(!h.aE(d.filter,s))return s==null?(d.filter=void 0,void this._updateLayer(d)):void(this._validate(h.u.filter,`layers.${d.id}.filter`,s,null,c)||(d.filter=h.aB(s),this._updateLayer(d)))}else this.fire(new h.j(new Error(`Cannot filter non-existing layer "${r}".`)))}getFilter(r){return h.aB(this.getLayer(r).filter)}setLayoutProperty(r,s,c,d={}){this._checkLoaded();const m=this.getLayer(r);m?h.aE(m.getLayoutProperty(s),c)||(m.setLayoutProperty(s,c,d),this._updateLayer(m)):this.fire(new h.j(new Error(`Cannot style non-existing layer "${r}".`)))}getLayoutProperty(r,s){const c=this.getLayer(r);if(c)return c.getLayoutProperty(s);this.fire(new h.j(new Error(`Cannot get style of non-existing layer "${r}".`)))}setPaintProperty(r,s,c,d={}){this._checkLoaded();const m=this.getLayer(r);m?h.aE(m.getPaintProperty(s),c)||(m.setPaintProperty(s,c,d)&&this._updateLayer(m),this._changed=!0,this._updatedPaintProps[r]=!0,this._serializedLayers=null):this.fire(new h.j(new Error(`Cannot style non-existing layer "${r}".`)))}getPaintProperty(r,s){return this.getLayer(r).getPaintProperty(s)}setFeatureState(r,s){this._checkLoaded();const c=r.source,d=r.sourceLayer,m=this.sourceCaches[c];if(m===void 0)return void this.fire(new h.j(new Error(`The source '${c}' does not exist in the map's style.`)));const w=m.getSource().type;w==="geojson"&&d?this.fire(new h.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):w!=="vector"||d?(r.id===void 0&&this.fire(new h.j(new Error("The feature id parameter must be provided."))),m.setFeatureState(d,r.id,s)):this.fire(new h.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(r,s){this._checkLoaded();const c=r.source,d=this.sourceCaches[c];if(d===void 0)return void this.fire(new h.j(new Error(`The source '${c}' does not exist in the map's style.`)));const m=d.getSource().type,w=m==="vector"?r.sourceLayer:void 0;m!=="vector"||w?s&&typeof r.id!="string"&&typeof r.id!="number"?this.fire(new h.j(new Error("A feature id is required to remove its specific state property."))):d.removeFeatureState(w,r.id,s):this.fire(new h.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(r){this._checkLoaded();const s=r.source,c=r.sourceLayer,d=this.sourceCaches[s];if(d!==void 0)return d.getSource().type!=="vector"||c?(r.id===void 0&&this.fire(new h.j(new Error("The feature id parameter must be provided."))),d.getFeatureState(c,r.id)):void this.fire(new h.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new h.j(new Error(`The source '${s}' does not exist in the map's style.`)))}getTransition(){return h.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const r=h.aF(this.sourceCaches,m=>m.serialize()),s=this._serializeByIds(this._order,!0),c=this.map.getTerrain()||void 0,d=this.stylesheet;return h.aG({version:d.version,name:d.name,metadata:d.metadata,light:d.light,sky:d.sky,center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch,sprite:d.sprite,glyphs:d.glyphs,transition:d.transition,sources:r,layers:s,terrain:c},m=>m!==void 0)}_updateLayer(r){this._updatedLayers[r.id]=!0,r.source&&!this._updatedSources[r.source]&&this.sourceCaches[r.source].getSource().type!=="raster"&&(this._updatedSources[r.source]="reload",this.sourceCaches[r.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(r){const s=w=>this._layers[w].type==="fill-extrusion",c={},d=[];for(let w=this._order.length-1;w>=0;w--){const T=this._order[w];if(s(T)){c[T]=w;for(const C of r){const E=C[T];if(E)for(const P of E)d.push(P)}}}d.sort((w,T)=>T.intersectionZ-w.intersectionZ);const m=[];for(let w=this._order.length-1;w>=0;w--){const T=this._order[w];if(s(T))for(let C=d.length-1;C>=0;C--){const E=d[C].feature;if(c[E.layer.id]<w)break;m.push(E),d.pop()}else for(const C of r){const E=C[T];if(E)for(const P of E)m.push(P.feature)}}return m}queryRenderedFeatures(r,s,c){s&&s.filter&&this._validate(h.u.filter,"queryRenderedFeatures.filter",s.filter,null,s);const d={};if(s&&s.layers){if(!Array.isArray(s.layers))return this.fire(new h.j(new Error("parameters.layers must be an Array."))),[];for(const T of s.layers){const C=this._layers[T];if(!C)return this.fire(new h.j(new Error(`The layer '${T}' does not exist in the map's style and cannot be queried for features.`))),[];d[C.source]=!0}}const m=[];s.availableImages=this._availableImages;const w=this._serializedAllLayers();for(const T in this.sourceCaches)s.layers&&!d[T]||m.push(no(this.sourceCaches[T],this._layers,w,r,s,c));return this.placement&&m.push(function(T,C,E,P,M,N,V){const G={},Y=N.queryRenderedSymbols(P),ee=[];for(const re of Object.keys(Y).map(Number))ee.push(V[re]);ee.sort(io);for(const re of ee){const oe=re.featureIndex.lookupSymbolFeatures(Y[re.bucketInstanceId],C,re.bucketIndex,re.sourceLayerIndex,M.filter,M.layers,M.availableImages,T);for(const W in oe){const ue=G[W]=G[W]||[],pe=oe[W];pe.sort((ye,Ce)=>{const Me=re.featureSortOrder;if(Me){const $e=Me.indexOf(ye.featureIndex);return Me.indexOf(Ce.featureIndex)-$e}return Ce.featureIndex-ye.featureIndex});for(const ye of pe)ue.push(ye)}}for(const re in G)G[re].forEach(oe=>{const W=oe.feature,ue=E[T[re].source].getFeatureState(W.layer["source-layer"],W.id);W.source=W.layer.source,W.layer["source-layer"]&&(W.sourceLayer=W.layer["source-layer"]),W.state=ue});return G}(this._layers,w,this.sourceCaches,r,s,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(m)}querySourceFeatures(r,s){s&&s.filter&&this._validate(h.u.filter,"querySourceFeatures.filter",s.filter,null,s);const c=this.sourceCaches[r];return c?function(d,m){const w=d.getRenderableIds().map(E=>d.getTileByID(E)),T=[],C={};for(let E=0;E<w.length;E++){const P=w[E],M=P.tileID.canonical.key;C[M]||(C[M]=!0,P.querySourceFeatures(T,m))}return T}(c,s):[]}getLight(){return this.light.getLight()}setLight(r,s={}){this._checkLoaded();const c=this.light.getLight();let d=!1;for(const w in r)if(!h.aE(r[w],c[w])){d=!0;break}if(!d)return;const m={now:U.now(),transition:h.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(r,s),this.light.updateTransitions(m)}getSky(){var r;return(r=this.stylesheet)===null||r===void 0?void 0:r.sky}setSky(r,s={}){const c=this.getSky();let d=!1;if(!r&&!c)return;if(r&&!c)d=!0;else if(!r&&c)d=!0;else for(const w in r)if(!h.aE(r[w],c[w])){d=!0;break}if(!d)return;const m={now:U.now(),transition:h.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=r,this.sky.setSky(r,s),this.sky.updateTransitions(m)}_validate(r,s,c,d,m={}){return(!m||m.validate!==!1)&&Fi(this,r.call(h.u,h.e({key:s,style:this.serialize(),value:c,styleSpec:h.v},d)))}_remove(r=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),pi().off(ze,this._rtlPluginLoaded);for(const s in this._layers)this._layers[s].setEventedParent(null);for(const s in this.sourceCaches){const c=this.sourceCaches[s];c.setEventedParent(null),c.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),r&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(r)}_clearSource(r){this.sourceCaches[r].clearTiles()}_reloadSource(r){this.sourceCaches[r].resume(),this.sourceCaches[r].reload()}_updateSources(r){for(const s in this.sourceCaches)this.sourceCaches[s].update(r,this.map.terrain)}_generateCollisionBoxes(){for(const r in this.sourceCaches)this._reloadSource(r)}_updatePlacement(r,s,c,d,m=!1){let w=!1,T=!1;const C={};for(const E of this._order){const P=this._layers[E];if(P.type!=="symbol")continue;if(!C[P.source]){const N=this.sourceCaches[P.source];C[P.source]=N.getRenderableIds(!0).map(V=>N.getTileByID(V)).sort((V,G)=>G.tileID.overscaledZ-V.tileID.overscaledZ||(V.tileID.isLessThan(G.tileID)?-1:1))}const M=this.crossTileSymbolIndex.addLayer(P,C[P.source],r.center.lng);w=w||M}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((m=m||this._layerOrderChanged||c===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(U.now(),r.zoom))&&(this.pauseablePlacement=new Ks(r,this.map.terrain,this._order,m,s,c,d,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,C),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(U.now()),T=!0),w&&this.pauseablePlacement.placement.setStale()),T||w)for(const E of this._order){const P=this._layers[E];P.type==="symbol"&&this.placement.updateLayerOpacities(P,C[P.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(U.now())}_releaseSymbolFadeTiles(){for(const r in this.sourceCaches)this.sourceCaches[r].releaseSymbolFadeTiles()}getImages(r,s){return h._(this,void 0,void 0,function*(){const c=yield this.imageManager.getImages(s.icons);this._updateTilesForChangedImages();const d=this.sourceCaches[s.source];return d&&d.setDependencies(s.tileID.key,s.type,s.icons),c})}getGlyphs(r,s){return h._(this,void 0,void 0,function*(){const c=yield this.glyphManager.getGlyphs(s.stacks),d=this.sourceCaches[s.source];return d&&d.setDependencies(s.tileID.key,s.type,[""]),c})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(r,s={}){this._checkLoaded(),r&&this._validate(h.u.glyphs,"glyphs",r,null,s)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=r,this.glyphManager.entries={},this.glyphManager.setURL(r))}addSprite(r,s,c={},d){this._checkLoaded();const m=[{id:r,url:s}],w=[...mt(this.stylesheet.sprite),...m];this._validate(h.u.sprite,"sprite",w,null,c)||(this.stylesheet.sprite=w,this._loadSprite(m,!0,d))}removeSprite(r){this._checkLoaded();const s=mt(this.stylesheet.sprite);if(s.find(c=>c.id===r)){if(this._spritesImagesIds[r])for(const c of this._spritesImagesIds[r])this.imageManager.removeImage(c),this._changedImages[c]=!0;s.splice(s.findIndex(c=>c.id===r),1),this.stylesheet.sprite=s.length>0?s:void 0,delete this._spritesImagesIds[r],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new h.k("data",{dataType:"style"}))}else this.fire(new h.j(new Error(`Sprite "${r}" doesn't exists on this map.`)))}getSprite(){return mt(this.stylesheet.sprite)}setSprite(r,s={},c){this._checkLoaded(),r&&this._validate(h.u.sprite,"sprite",r,null,s)||(this.stylesheet.sprite=r,r?this._loadSprite(r,!0,c):(this._unloadSprite(),c&&c(null)))}}var ya=h.Y([{name:"a_pos",type:"Int16",components:2}]);const Wo={prelude:Ut(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Ut(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Ut(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Ut(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Ut("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Ut(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,get_elevation(floor(a_pos*0.5)),1);gl_Position=u_matrix*pos;}`),heatmapTexture:Ut(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Ut("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Ut("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Ut("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Ut(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Ut(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Ut(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Ut(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Ut(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Ut(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Ut(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Ut(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Ut(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Ut(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Ut(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Ut(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Ut(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Ut(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Ut(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Ut(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Ut("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;varying vec2 v_texture_pos;varying float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture2D(u_texture,v_texture_pos);if (v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);gl_FragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {gl_FragColor=surface_color;}}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform mat4 u_fog_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Ut("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Ut("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);}"),sky:Ut("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform float u_horizon;uniform float u_sky_horizon_blend;void main() {float y=gl_FragCoord.y;if (y > u_horizon) {float blend=y-u_horizon;if (blend < u_sky_horizon_blend) {gl_FragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {gl_FragColor=u_sky_color;}}}","attribute vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Ut(g,r){const s=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,c=r.match(/attribute ([\w]+) ([\w]+)/g),d=g.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),m=r.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=m?m.concat(d):d,T={};return{fragmentSource:g=g.replace(s,(C,E,P,M,N)=>(T[N]=!0,E==="define"?`
#ifndef HAS_UNIFORM_u_${N}
varying ${P} ${M} ${N};
#else
uniform ${P} ${M} u_${N};
#endif
`:`
#ifdef HAS_UNIFORM_u_${N}
    ${P} ${M} ${N} = u_${N};
#endif
`)),vertexSource:r=r.replace(s,(C,E,P,M,N)=>{const V=M==="float"?"vec2":"vec4",G=N.match(/color/)?"color":V;return T[N]?E==="define"?`
#ifndef HAS_UNIFORM_u_${N}
uniform lowp float u_${N}_t;
attribute ${P} ${V} a_${N};
varying ${P} ${M} ${N};
#else
uniform ${P} ${M} u_${N};
#endif
`:G==="vec4"?`
#ifndef HAS_UNIFORM_u_${N}
    ${N} = a_${N};
#else
    ${P} ${M} ${N} = u_${N};
#endif
`:`
#ifndef HAS_UNIFORM_u_${N}
    ${N} = unpack_mix_${G}(a_${N}, u_${N}_t);
#else
    ${P} ${M} ${N} = u_${N};
#endif
`:E==="define"?`
#ifndef HAS_UNIFORM_u_${N}
uniform lowp float u_${N}_t;
attribute ${P} ${V} a_${N};
#else
uniform ${P} ${M} u_${N};
#endif
`:G==="vec4"?`
#ifndef HAS_UNIFORM_u_${N}
    ${P} ${M} ${N} = a_${N};
#else
    ${P} ${M} ${N} = u_${N};
#endif
`:`
#ifndef HAS_UNIFORM_u_${N}
    ${P} ${M} ${N} = unpack_mix_${G}(a_${N}, u_${N}_t);
#else
    ${P} ${M} ${N} = u_${N};
#endif
`}),staticAttributes:c,staticUniforms:w}}class zc{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(r,s,c,d,m,w,T,C,E){this.context=r;let P=this.boundPaintVertexBuffers.length!==d.length;for(let M=0;!P&&M<d.length;M++)this.boundPaintVertexBuffers[M]!==d[M]&&(P=!0);!this.vao||this.boundProgram!==s||this.boundLayoutVertexBuffer!==c||P||this.boundIndexBuffer!==m||this.boundVertexOffset!==w||this.boundDynamicVertexBuffer!==T||this.boundDynamicVertexBuffer2!==C||this.boundDynamicVertexBuffer3!==E?this.freshBind(s,c,d,m,w,T,C,E):(r.bindVertexArray.set(this.vao),T&&T.bind(),m&&m.dynamicDraw&&m.bind(),C&&C.bind(),E&&E.bind())}freshBind(r,s,c,d,m,w,T,C){const E=r.numAttributes,P=this.context,M=P.gl;this.vao&&this.destroy(),this.vao=P.createVertexArray(),P.bindVertexArray.set(this.vao),this.boundProgram=r,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=c,this.boundIndexBuffer=d,this.boundVertexOffset=m,this.boundDynamicVertexBuffer=w,this.boundDynamicVertexBuffer2=T,this.boundDynamicVertexBuffer3=C,s.enableAttributes(M,r);for(const N of c)N.enableAttributes(M,r);w&&w.enableAttributes(M,r),T&&T.enableAttributes(M,r),C&&C.enableAttributes(M,r),s.bind(),s.setVertexAttribPointers(M,r,m);for(const N of c)N.bind(),N.setVertexAttribPointers(M,r,m);w&&(w.bind(),w.setVertexAttribPointers(M,r,m)),d&&d.bind(),T&&(T.bind(),T.setVertexAttribPointers(M,r,m)),C&&(C.bind(),C.setVertexAttribPointers(M,r,m)),P.currentNumAttributes=E}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Lc=(g,r,s,c,d)=>({u_matrix:g,u_texture:0,u_ele_delta:r,u_fog_matrix:s,u_fog_color:c?c.properties.get("fog-color"):h.aM.white,u_fog_ground_blend:c?c.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:c?c.calculateFogBlendOpacity(d):0,u_horizon_color:c?c.properties.get("horizon-color"):h.aM.white,u_horizon_fog_blend:c?c.properties.get("horizon-fog-blend"):1});function Wa(g){const r=[];for(let s=0;s<g.length;s++){if(g[s]===null)continue;const c=g[s].split(" ");r.push(c.pop())}return r}class Rc{constructor(r,s,c,d,m,w){const T=r.gl;this.program=T.createProgram();const C=Wa(s.staticAttributes),E=c?c.getBinderAttributes():[],P=C.concat(E),M=Wo.prelude.staticUniforms?Wa(Wo.prelude.staticUniforms):[],N=s.staticUniforms?Wa(s.staticUniforms):[],V=c?c.getBinderUniforms():[],G=M.concat(N).concat(V),Y=[];for(const ye of G)Y.indexOf(ye)<0&&Y.push(ye);const ee=c?c.defines():[];m&&ee.push("#define OVERDRAW_INSPECTOR;"),w&&ee.push("#define TERRAIN3D;");const re=ee.concat(Wo.prelude.fragmentSource,s.fragmentSource).join(`
`),oe=ee.concat(Wo.prelude.vertexSource,s.vertexSource).join(`
`),W=T.createShader(T.FRAGMENT_SHADER);if(T.isContextLost())return void(this.failedToCreate=!0);if(T.shaderSource(W,re),T.compileShader(W),!T.getShaderParameter(W,T.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${T.getShaderInfoLog(W)}`);T.attachShader(this.program,W);const ue=T.createShader(T.VERTEX_SHADER);if(T.isContextLost())return void(this.failedToCreate=!0);if(T.shaderSource(ue,oe),T.compileShader(ue),!T.getShaderParameter(ue,T.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${T.getShaderInfoLog(ue)}`);T.attachShader(this.program,ue),this.attributes={};const pe={};this.numAttributes=P.length;for(let ye=0;ye<this.numAttributes;ye++)P[ye]&&(T.bindAttribLocation(this.program,ye,P[ye]),this.attributes[P[ye]]=ye);if(T.linkProgram(this.program),!T.getProgramParameter(this.program,T.LINK_STATUS))throw new Error(`Program failed to link: ${T.getProgramInfoLog(this.program)}`);T.deleteShader(ue),T.deleteShader(W);for(let ye=0;ye<Y.length;ye++){const Ce=Y[ye];if(Ce&&!pe[Ce]){const Me=T.getUniformLocation(this.program,Ce);Me&&(pe[Ce]=Me)}}this.fixedUniforms=d(r,pe),this.terrainUniforms=((ye,Ce)=>({u_depth:new h.aH(ye,Ce.u_depth),u_terrain:new h.aH(ye,Ce.u_terrain),u_terrain_dim:new h.aI(ye,Ce.u_terrain_dim),u_terrain_matrix:new h.aJ(ye,Ce.u_terrain_matrix),u_terrain_unpack:new h.aK(ye,Ce.u_terrain_unpack),u_terrain_exaggeration:new h.aI(ye,Ce.u_terrain_exaggeration)}))(r,pe),this.binderUniforms=c?c.getUniforms(r,pe):[]}draw(r,s,c,d,m,w,T,C,E,P,M,N,V,G,Y,ee,re,oe){const W=r.gl;if(this.failedToCreate)return;if(r.program.set(this.program),r.setDepthMode(c),r.setStencilMode(d),r.setColorMode(m),r.setCullFace(w),C){r.activeTexture.set(W.TEXTURE2),W.bindTexture(W.TEXTURE_2D,C.depthTexture),r.activeTexture.set(W.TEXTURE3),W.bindTexture(W.TEXTURE_2D,C.texture);for(const pe in this.terrainUniforms)this.terrainUniforms[pe].set(C[pe])}for(const pe in this.fixedUniforms)this.fixedUniforms[pe].set(T[pe]);Y&&Y.setUniforms(r,this.binderUniforms,V,{zoom:G});let ue=0;switch(s){case W.LINES:ue=2;break;case W.TRIANGLES:ue=3;break;case W.LINE_STRIP:ue=1}for(const pe of N.get()){const ye=pe.vaos||(pe.vaos={});(ye[E]||(ye[E]=new zc)).bind(r,this,P,Y?Y.getPaintVertexBuffers():[],M,pe.vertexOffset,ee,re,oe),W.drawElements(s,pe.primitiveLength*ue,W.UNSIGNED_SHORT,pe.primitiveOffset*ue*2)}}}function Zl(g,r,s){const c=1/Et(s,1,r.transform.tileZoom),d=Math.pow(2,s.tileID.overscaledZ),m=s.tileSize*Math.pow(2,r.transform.tileZoom)/d,w=m*(s.tileID.canonical.x+s.tileID.wrap*d),T=m*s.tileID.canonical.y;return{u_image:0,u_texsize:s.imageAtlasTexture.size,u_scale:[c,g.fromScale,g.toScale],u_fade:g.t,u_pixel_coord_upper:[w>>16,T>>16],u_pixel_coord_lower:[65535&w,65535&T]}}const Xs=(g,r,s,c)=>{const d=r.style.light,m=d.properties.get("position"),w=[m.x,m.y,m.z],T=function(){var E=new h.A(9);return h.A!=Float32Array&&(E[1]=0,E[2]=0,E[3]=0,E[5]=0,E[6]=0,E[7]=0),E[0]=1,E[4]=1,E[8]=1,E}();d.properties.get("anchor")==="viewport"&&function(E,P){var M=Math.sin(P),N=Math.cos(P);E[0]=N,E[1]=M,E[2]=0,E[3]=-M,E[4]=N,E[5]=0,E[6]=0,E[7]=0,E[8]=1}(T,-r.transform.angle),function(E,P,M){var N=P[0],V=P[1],G=P[2];E[0]=N*M[0]+V*M[3]+G*M[6],E[1]=N*M[1]+V*M[4]+G*M[7],E[2]=N*M[2]+V*M[5]+G*M[8]}(w,w,T);const C=d.properties.get("color");return{u_matrix:g,u_lightpos:w,u_lightintensity:d.properties.get("intensity"),u_lightcolor:[C.r,C.g,C.b],u_vertical_gradient:+s,u_opacity:c}},Gl=(g,r,s,c,d,m,w)=>h.e(Xs(g,r,s,c),Zl(m,r,w),{u_height_factor:-Math.pow(2,d.overscaledZ)/w.tileSize/8}),Ka=g=>({u_matrix:g}),Vd=(g,r,s,c)=>h.e(Ka(g),Zl(s,r,c)),dg=(g,r)=>({u_matrix:g,u_world:r}),qd=(g,r,s,c,d)=>h.e(Vd(g,r,s,c),{u_world:d}),pg=(g,r,s,c)=>{const d=g.transform;let m,w;if(c.paint.get("circle-pitch-alignment")==="map"){const T=Et(s,1,d.zoom);m=!0,w=[T,T]}else m=!1,w=d.pixelsToGLUnits;return{u_camera_to_center_distance:d.cameraToCenterDistance,u_scale_with_map:+(c.paint.get("circle-pitch-scale")==="map"),u_matrix:g.translatePosMatrix(r.posMatrix,s,c.paint.get("circle-translate"),c.paint.get("circle-translate-anchor")),u_pitch_with_map:+m,u_device_pixel_ratio:g.pixelRatio,u_extrude_scale:w}},_a=(g,r,s)=>({u_matrix:g,u_inv_matrix:r,u_camera_to_center_distance:s.cameraToCenterDistance,u_viewport_size:[s.width,s.height]}),Ys=(g,r,s=1)=>({u_matrix:g,u_color:r,u_overlay:0,u_overlay_scale:s}),Nn=g=>({u_matrix:g}),$n=(g,r,s,c)=>({u_matrix:g,u_extrude_scale:Et(r,1,s),u_intensity:c}),Hl=(g,r,s,c)=>{const d=h.H();h.aP(d,0,g.width,g.height,0,0,1);const m=g.context.gl;return{u_matrix:d,u_world:[m.drawingBufferWidth,m.drawingBufferHeight],u_image:s,u_color_ramp:c,u_opacity:r.paint.get("heatmap-opacity")}};function Wl(g,r){const s=Math.pow(2,r.canonical.z),c=r.canonical.y;return[new h.Z(0,c/s).toLngLat().lat,new h.Z(0,(c+1)/s).toLngLat().lat]}const Kl=(g,r,s,c)=>{const d=g.transform;return{u_matrix:Hd(g,r,s,c),u_ratio:1/Et(r,1,d.zoom),u_device_pixel_ratio:g.pixelRatio,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},Zd=(g,r,s,c,d)=>h.e(Kl(g,r,s,d),{u_image:0,u_image_height:c}),Xa=(g,r,s,c,d)=>{const m=g.transform,w=Gd(r,m);return{u_matrix:Hd(g,r,s,d),u_texsize:r.imageAtlasTexture.size,u_ratio:1/Et(r,1,m.zoom),u_device_pixel_ratio:g.pixelRatio,u_image:0,u_scale:[w,c.fromScale,c.toScale],u_fade:c.t,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}},fg=(g,r,s,c,d,m)=>{const w=g.lineAtlas,T=Gd(r,g.transform),C=s.layout.get("line-cap")==="round",E=w.getDash(c.from,C),P=w.getDash(c.to,C),M=E.width*d.fromScale,N=P.width*d.toScale;return h.e(Kl(g,r,s,m),{u_patternscale_a:[T/M,-E.height/2],u_patternscale_b:[T/N,-P.height/2],u_sdfgamma:w.width/(256*Math.min(M,N)*g.pixelRatio)/2,u_image:0,u_tex_y_a:E.y,u_tex_y_b:P.y,u_mix:d.t})};function Gd(g,r){return 1/Et(g,1,r.tileZoom)}function Hd(g,r,s,c){return g.translatePosMatrix(c?c.posMatrix:r.tileID.posMatrix,r,s.paint.get("line-translate"),s.paint.get("line-translate-anchor"))}const mg=(g,r,s,c,d)=>{return{u_matrix:g,u_tl_parent:r,u_scale_parent:s,u_buffer_scale:1,u_fade_t:c.mix,u_opacity:c.opacity*d.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:d.paint.get("raster-brightness-min"),u_brightness_high:d.paint.get("raster-brightness-max"),u_saturation_factor:(w=d.paint.get("raster-saturation"),w>0?1-1/(1.001-w):-w),u_contrast_factor:(m=d.paint.get("raster-contrast"),m>0?1/(1-m):1+m),u_spin_weights:gg(d.paint.get("raster-hue-rotate"))};var m,w};function gg(g){g*=Math.PI/180;const r=Math.sin(g),s=Math.cos(g);return[(2*s+1)/3,(-Math.sqrt(3)*r-s+1)/3,(Math.sqrt(3)*r-s+1)/3]}const Wd=(g,r,s,c,d,m,w,T,C,E,P,M,N,V)=>{const G=w.transform;return{u_is_size_zoom_constant:+(g==="constant"||g==="source"),u_is_size_feature_constant:+(g==="constant"||g==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:G.cameraToCenterDistance,u_pitch:G.pitch/360*2*Math.PI,u_rotate_symbol:+s,u_aspect_ratio:G.width/G.height,u_fade_change:w.options.fadeDuration?w.symbolFadeChange:1,u_matrix:T,u_label_plane_matrix:C,u_coord_matrix:E,u_is_text:+M,u_pitch_with_map:+c,u_is_along_line:d,u_is_variable_anchor:m,u_texsize:N,u_texture:0,u_translation:P,u_pitched_scale:V}},Js=(g,r,s,c,d,m,w,T,C,E,P,M,N,V,G)=>{const Y=w.transform;return h.e(Wd(g,r,s,c,d,m,w,T,C,E,P,M,N,G),{u_gamma_scale:c?Math.cos(Y._pitch)*Y.cameraToCenterDistance:1,u_device_pixel_ratio:w.pixelRatio,u_is_halo:+V})},Dc=(g,r,s,c,d,m,w,T,C,E,P,M,N,V)=>h.e(Js(g,r,s,c,d,m,w,T,C,E,P,!0,M,!0,V),{u_texsize_icon:N,u_texture_icon:1}),Xl=(g,r,s)=>({u_matrix:g,u_opacity:r,u_color:s}),Fc=(g,r,s,c,d,m)=>h.e(function(w,T,C,E){const P=C.imageManager.getPattern(w.from.toString()),M=C.imageManager.getPattern(w.to.toString()),{width:N,height:V}=C.imageManager.getPixelSize(),G=Math.pow(2,E.tileID.overscaledZ),Y=E.tileSize*Math.pow(2,C.transform.tileZoom)/G,ee=Y*(E.tileID.canonical.x+E.tileID.wrap*G),re=Y*E.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:P.tl,u_pattern_br_a:P.br,u_pattern_tl_b:M.tl,u_pattern_br_b:M.br,u_texsize:[N,V],u_mix:T.t,u_pattern_size_a:P.displaySize,u_pattern_size_b:M.displaySize,u_scale_a:T.fromScale,u_scale_b:T.toScale,u_tile_units_to_pixels:1/Et(E,1,C.transform.tileZoom),u_pixel_coord_upper:[ee>>16,re>>16],u_pixel_coord_lower:[65535&ee,65535&re]}}(c,m,s,d),{u_matrix:g,u_opacity:r}),Bc={fillExtrusion:(g,r)=>({u_matrix:new h.aJ(g,r.u_matrix),u_lightpos:new h.aN(g,r.u_lightpos),u_lightintensity:new h.aI(g,r.u_lightintensity),u_lightcolor:new h.aN(g,r.u_lightcolor),u_vertical_gradient:new h.aI(g,r.u_vertical_gradient),u_opacity:new h.aI(g,r.u_opacity)}),fillExtrusionPattern:(g,r)=>({u_matrix:new h.aJ(g,r.u_matrix),u_lightpos:new h.aN(g,r.u_lightpos),u_lightintensity:new h.aI(g,r.u_lightintensity),u_lightcolor:new h.aN(g,r.u_lightcolor),u_vertical_gradient:new h.aI(g,r.u_vertical_gradient),u_height_factor:new h.aI(g,r.u_height_factor),u_image:new h.aH(g,r.u_image),u_texsize:new h.aO(g,r.u_texsize),u_pixel_coord_upper:new h.aO(g,r.u_pixel_coord_upper),u_pixel_coord_lower:new h.aO(g,r.u_pixel_coord_lower),u_scale:new h.aN(g,r.u_scale),u_fade:new h.aI(g,r.u_fade),u_opacity:new h.aI(g,r.u_opacity)}),fill:(g,r)=>({u_matrix:new h.aJ(g,r.u_matrix)}),fillPattern:(g,r)=>({u_matrix:new h.aJ(g,r.u_matrix),u_image:new h.aH(g,r.u_image),u_texsize:new h.aO(g,r.u_texsize),u_pixel_coord_upper:new h.aO(g,r.u_pixel_coord_upper),u_pixel_coord_lower:new h.aO(g,r.u_pixel_coord_lower),u_scale:new h.aN(g,r.u_scale),u_fade:new h.aI(g,r.u_fade)}),fillOutline:(g,r)=>({u_matrix:new h.aJ(g,r.u_matrix),u_world:new h.aO(g,r.u_world)}),fillOutlinePattern:(g,r)=>({u_matrix:new h.aJ(g,r.u_matrix),u_world:new h.aO(g,r.u_world),u_image:new h.aH(g,r.u_image),u_texsize:new h.aO(g,r.u_texsize),u_pixel_coord_upper:new h.aO(g,r.u_pixel_coord_upper),u_pixel_coord_lower:new h.aO(g,r.u_pixel_coord_lower),u_scale:new h.aN(g,r.u_scale),u_fade:new h.aI(g,r.u_fade)}),circle:(g,r)=>({u_camera_to_center_distance:new h.aI(g,r.u_camera_to_center_distance),u_scale_with_map:new h.aH(g,r.u_scale_with_map),u_pitch_with_map:new h.aH(g,r.u_pitch_with_map),u_extrude_scale:new h.aO(g,r.u_extrude_scale),u_device_pixel_ratio:new h.aI(g,r.u_device_pixel_ratio),u_matrix:new h.aJ(g,r.u_matrix)}),collisionBox:(g,r)=>({u_matrix:new h.aJ(g,r.u_matrix),u_pixel_extrude_scale:new h.aO(g,r.u_pixel_extrude_scale)}),collisionCircle:(g,r)=>({u_matrix:new h.aJ(g,r.u_matrix),u_inv_matrix:new h.aJ(g,r.u_inv_matrix),u_camera_to_center_distance:new h.aI(g,r.u_camera_to_center_distance),u_viewport_size:new h.aO(g,r.u_viewport_size)}),debug:(g,r)=>({u_color:new h.aL(g,r.u_color),u_matrix:new h.aJ(g,r.u_matrix),u_overlay:new h.aH(g,r.u_overlay),u_overlay_scale:new h.aI(g,r.u_overlay_scale)}),clippingMask:(g,r)=>({u_matrix:new h.aJ(g,r.u_matrix)}),heatmap:(g,r)=>({u_extrude_scale:new h.aI(g,r.u_extrude_scale),u_intensity:new h.aI(g,r.u_intensity),u_matrix:new h.aJ(g,r.u_matrix)}),heatmapTexture:(g,r)=>({u_matrix:new h.aJ(g,r.u_matrix),u_world:new h.aO(g,r.u_world),u_image:new h.aH(g,r.u_image),u_color_ramp:new h.aH(g,r.u_color_ramp),u_opacity:new h.aI(g,r.u_opacity)}),hillshade:(g,r)=>({u_matrix:new h.aJ(g,r.u_matrix),u_image:new h.aH(g,r.u_image),u_latrange:new h.aO(g,r.u_latrange),u_light:new h.aO(g,r.u_light),u_shadow:new h.aL(g,r.u_shadow),u_highlight:new h.aL(g,r.u_highlight),u_accent:new h.aL(g,r.u_accent)}),hillshadePrepare:(g,r)=>({u_matrix:new h.aJ(g,r.u_matrix),u_image:new h.aH(g,r.u_image),u_dimension:new h.aO(g,r.u_dimension),u_zoom:new h.aI(g,r.u_zoom),u_unpack:new h.aK(g,r.u_unpack)}),line:(g,r)=>({u_matrix:new h.aJ(g,r.u_matrix),u_ratio:new h.aI(g,r.u_ratio),u_device_pixel_ratio:new h.aI(g,r.u_device_pixel_ratio),u_units_to_pixels:new h.aO(g,r.u_units_to_pixels)}),lineGradient:(g,r)=>({u_matrix:new h.aJ(g,r.u_matrix),u_ratio:new h.aI(g,r.u_ratio),u_device_pixel_ratio:new h.aI(g,r.u_device_pixel_ratio),u_units_to_pixels:new h.aO(g,r.u_units_to_pixels),u_image:new h.aH(g,r.u_image),u_image_height:new h.aI(g,r.u_image_height)}),linePattern:(g,r)=>({u_matrix:new h.aJ(g,r.u_matrix),u_texsize:new h.aO(g,r.u_texsize),u_ratio:new h.aI(g,r.u_ratio),u_device_pixel_ratio:new h.aI(g,r.u_device_pixel_ratio),u_image:new h.aH(g,r.u_image),u_units_to_pixels:new h.aO(g,r.u_units_to_pixels),u_scale:new h.aN(g,r.u_scale),u_fade:new h.aI(g,r.u_fade)}),lineSDF:(g,r)=>({u_matrix:new h.aJ(g,r.u_matrix),u_ratio:new h.aI(g,r.u_ratio),u_device_pixel_ratio:new h.aI(g,r.u_device_pixel_ratio),u_units_to_pixels:new h.aO(g,r.u_units_to_pixels),u_patternscale_a:new h.aO(g,r.u_patternscale_a),u_patternscale_b:new h.aO(g,r.u_patternscale_b),u_sdfgamma:new h.aI(g,r.u_sdfgamma),u_image:new h.aH(g,r.u_image),u_tex_y_a:new h.aI(g,r.u_tex_y_a),u_tex_y_b:new h.aI(g,r.u_tex_y_b),u_mix:new h.aI(g,r.u_mix)}),raster:(g,r)=>({u_matrix:new h.aJ(g,r.u_matrix),u_tl_parent:new h.aO(g,r.u_tl_parent),u_scale_parent:new h.aI(g,r.u_scale_parent),u_buffer_scale:new h.aI(g,r.u_buffer_scale),u_fade_t:new h.aI(g,r.u_fade_t),u_opacity:new h.aI(g,r.u_opacity),u_image0:new h.aH(g,r.u_image0),u_image1:new h.aH(g,r.u_image1),u_brightness_low:new h.aI(g,r.u_brightness_low),u_brightness_high:new h.aI(g,r.u_brightness_high),u_saturation_factor:new h.aI(g,r.u_saturation_factor),u_contrast_factor:new h.aI(g,r.u_contrast_factor),u_spin_weights:new h.aN(g,r.u_spin_weights)}),symbolIcon:(g,r)=>({u_is_size_zoom_constant:new h.aH(g,r.u_is_size_zoom_constant),u_is_size_feature_constant:new h.aH(g,r.u_is_size_feature_constant),u_size_t:new h.aI(g,r.u_size_t),u_size:new h.aI(g,r.u_size),u_camera_to_center_distance:new h.aI(g,r.u_camera_to_center_distance),u_pitch:new h.aI(g,r.u_pitch),u_rotate_symbol:new h.aH(g,r.u_rotate_symbol),u_aspect_ratio:new h.aI(g,r.u_aspect_ratio),u_fade_change:new h.aI(g,r.u_fade_change),u_matrix:new h.aJ(g,r.u_matrix),u_label_plane_matrix:new h.aJ(g,r.u_label_plane_matrix),u_coord_matrix:new h.aJ(g,r.u_coord_matrix),u_is_text:new h.aH(g,r.u_is_text),u_pitch_with_map:new h.aH(g,r.u_pitch_with_map),u_is_along_line:new h.aH(g,r.u_is_along_line),u_is_variable_anchor:new h.aH(g,r.u_is_variable_anchor),u_texsize:new h.aO(g,r.u_texsize),u_texture:new h.aH(g,r.u_texture),u_translation:new h.aO(g,r.u_translation),u_pitched_scale:new h.aI(g,r.u_pitched_scale)}),symbolSDF:(g,r)=>({u_is_size_zoom_constant:new h.aH(g,r.u_is_size_zoom_constant),u_is_size_feature_constant:new h.aH(g,r.u_is_size_feature_constant),u_size_t:new h.aI(g,r.u_size_t),u_size:new h.aI(g,r.u_size),u_camera_to_center_distance:new h.aI(g,r.u_camera_to_center_distance),u_pitch:new h.aI(g,r.u_pitch),u_rotate_symbol:new h.aH(g,r.u_rotate_symbol),u_aspect_ratio:new h.aI(g,r.u_aspect_ratio),u_fade_change:new h.aI(g,r.u_fade_change),u_matrix:new h.aJ(g,r.u_matrix),u_label_plane_matrix:new h.aJ(g,r.u_label_plane_matrix),u_coord_matrix:new h.aJ(g,r.u_coord_matrix),u_is_text:new h.aH(g,r.u_is_text),u_pitch_with_map:new h.aH(g,r.u_pitch_with_map),u_is_along_line:new h.aH(g,r.u_is_along_line),u_is_variable_anchor:new h.aH(g,r.u_is_variable_anchor),u_texsize:new h.aO(g,r.u_texsize),u_texture:new h.aH(g,r.u_texture),u_gamma_scale:new h.aI(g,r.u_gamma_scale),u_device_pixel_ratio:new h.aI(g,r.u_device_pixel_ratio),u_is_halo:new h.aH(g,r.u_is_halo),u_translation:new h.aO(g,r.u_translation),u_pitched_scale:new h.aI(g,r.u_pitched_scale)}),symbolTextAndIcon:(g,r)=>({u_is_size_zoom_constant:new h.aH(g,r.u_is_size_zoom_constant),u_is_size_feature_constant:new h.aH(g,r.u_is_size_feature_constant),u_size_t:new h.aI(g,r.u_size_t),u_size:new h.aI(g,r.u_size),u_camera_to_center_distance:new h.aI(g,r.u_camera_to_center_distance),u_pitch:new h.aI(g,r.u_pitch),u_rotate_symbol:new h.aH(g,r.u_rotate_symbol),u_aspect_ratio:new h.aI(g,r.u_aspect_ratio),u_fade_change:new h.aI(g,r.u_fade_change),u_matrix:new h.aJ(g,r.u_matrix),u_label_plane_matrix:new h.aJ(g,r.u_label_plane_matrix),u_coord_matrix:new h.aJ(g,r.u_coord_matrix),u_is_text:new h.aH(g,r.u_is_text),u_pitch_with_map:new h.aH(g,r.u_pitch_with_map),u_is_along_line:new h.aH(g,r.u_is_along_line),u_is_variable_anchor:new h.aH(g,r.u_is_variable_anchor),u_texsize:new h.aO(g,r.u_texsize),u_texsize_icon:new h.aO(g,r.u_texsize_icon),u_texture:new h.aH(g,r.u_texture),u_texture_icon:new h.aH(g,r.u_texture_icon),u_gamma_scale:new h.aI(g,r.u_gamma_scale),u_device_pixel_ratio:new h.aI(g,r.u_device_pixel_ratio),u_is_halo:new h.aH(g,r.u_is_halo),u_translation:new h.aO(g,r.u_translation),u_pitched_scale:new h.aI(g,r.u_pitched_scale)}),background:(g,r)=>({u_matrix:new h.aJ(g,r.u_matrix),u_opacity:new h.aI(g,r.u_opacity),u_color:new h.aL(g,r.u_color)}),backgroundPattern:(g,r)=>({u_matrix:new h.aJ(g,r.u_matrix),u_opacity:new h.aI(g,r.u_opacity),u_image:new h.aH(g,r.u_image),u_pattern_tl_a:new h.aO(g,r.u_pattern_tl_a),u_pattern_br_a:new h.aO(g,r.u_pattern_br_a),u_pattern_tl_b:new h.aO(g,r.u_pattern_tl_b),u_pattern_br_b:new h.aO(g,r.u_pattern_br_b),u_texsize:new h.aO(g,r.u_texsize),u_mix:new h.aI(g,r.u_mix),u_pattern_size_a:new h.aO(g,r.u_pattern_size_a),u_pattern_size_b:new h.aO(g,r.u_pattern_size_b),u_scale_a:new h.aI(g,r.u_scale_a),u_scale_b:new h.aI(g,r.u_scale_b),u_pixel_coord_upper:new h.aO(g,r.u_pixel_coord_upper),u_pixel_coord_lower:new h.aO(g,r.u_pixel_coord_lower),u_tile_units_to_pixels:new h.aI(g,r.u_tile_units_to_pixels)}),terrain:(g,r)=>({u_matrix:new h.aJ(g,r.u_matrix),u_texture:new h.aH(g,r.u_texture),u_ele_delta:new h.aI(g,r.u_ele_delta),u_fog_matrix:new h.aJ(g,r.u_fog_matrix),u_fog_color:new h.aL(g,r.u_fog_color),u_fog_ground_blend:new h.aI(g,r.u_fog_ground_blend),u_fog_ground_blend_opacity:new h.aI(g,r.u_fog_ground_blend_opacity),u_horizon_color:new h.aL(g,r.u_horizon_color),u_horizon_fog_blend:new h.aI(g,r.u_horizon_fog_blend)}),terrainDepth:(g,r)=>({u_matrix:new h.aJ(g,r.u_matrix),u_ele_delta:new h.aI(g,r.u_ele_delta)}),terrainCoords:(g,r)=>({u_matrix:new h.aJ(g,r.u_matrix),u_texture:new h.aH(g,r.u_texture),u_terrain_coords_id:new h.aI(g,r.u_terrain_coords_id),u_ele_delta:new h.aI(g,r.u_ele_delta)}),sky:(g,r)=>({u_sky_color:new h.aL(g,r.u_sky_color),u_horizon_color:new h.aL(g,r.u_horizon_color),u_horizon:new h.aI(g,r.u_horizon),u_sky_horizon_blend:new h.aI(g,r.u_sky_horizon_blend)})};class lo{constructor(r,s,c){this.context=r;const d=r.gl;this.buffer=d.createBuffer(),this.dynamicDraw=!!c,this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),d.bufferData(d.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){const s=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const yg={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Oc{constructor(r,s,c,d){this.length=s.length,this.attributes=c,this.itemSize=s.bytesPerElement,this.dynamicDraw=d,this.context=r;const m=r.gl;this.buffer=m.createBuffer(),r.bindVertexBuffer.set(this.buffer),m.bufferData(m.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){if(r.length!==this.length)throw new Error(`Length of new data is ${r.length}, which doesn't match current length of ${this.length}`);const s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,s){for(let c=0;c<this.attributes.length;c++){const d=s.attributes[this.attributes[c].name];d!==void 0&&r.enableVertexAttribArray(d)}}setVertexAttribPointers(r,s,c){for(let d=0;d<this.attributes.length;d++){const m=this.attributes[d],w=s.attributes[m.name];w!==void 0&&r.vertexAttribPointer(w,m.components,r[yg[m.type]],!1,this.itemSize,m.offset+this.itemSize*(c||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const va=new WeakMap;function Ko(g){var r;if(va.has(g))return va.get(g);{const s=(r=g.getParameter(g.VERSION))===null||r===void 0?void 0:r.startsWith("WebGL 2.0");return va.set(g,s),s}}class qt{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Yl extends qt{getDefault(){return h.aM.transparent}set(r){const s=this.current;(r.r!==s.r||r.g!==s.g||r.b!==s.b||r.a!==s.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class _g extends qt{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class Ya extends qt{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class vg extends qt{getDefault(){return[!0,!0,!0,!0]}set(r){const s=this.current;(r[0]!==s[0]||r[1]!==s[1]||r[2]!==s[2]||r[3]!==s[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Kd extends qt{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class xg extends qt{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class Xd extends qt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const s=this.current;(r.func!==s.func||r.ref!==s.ref||r.mask!==s.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class Nc extends qt{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const s=this.current;(r[0]!==s[0]||r[1]!==s[1]||r[2]!==s[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class Yd extends qt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;r?s.enable(s.STENCIL_TEST):s.disable(s.STENCIL_TEST),this.current=r,this.dirty=!1}}class Jd extends qt{getDefault(){return[0,1]}set(r){const s=this.current;(r[0]!==s[0]||r[1]!==s[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class Qd extends qt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;r?s.enable(s.DEPTH_TEST):s.disable(s.DEPTH_TEST),this.current=r,this.dirty=!1}}class ep extends qt{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class xa extends qt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;r?s.enable(s.BLEND):s.disable(s.BLEND),this.current=r,this.dirty=!1}}class tp extends qt{getDefault(){const r=this.gl;return[r.ONE,r.ZERO]}set(r){const s=this.current;(r[0]!==s[0]||r[1]!==s[1]||this.dirty)&&(this.gl.blendFunc(r[0],r[1]),this.current=r,this.dirty=!1)}}class bg extends qt{getDefault(){return h.aM.transparent}set(r){const s=this.current;(r.r!==s.r||r.g!==s.g||r.b!==s.b||r.a!==s.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class rp extends qt{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquation(r),this.current=r,this.dirty=!1)}}class Qs extends qt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;r?s.enable(s.CULL_FACE):s.disable(s.CULL_FACE),this.current=r,this.dirty=!1}}class wg extends qt{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class Jl extends qt{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}class Sg extends qt{getDefault(){return null}set(r){(r!==this.current||this.dirty)&&(this.gl.useProgram(r),this.current=r,this.dirty=!1)}}class Tg extends qt{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class np extends qt{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const s=this.current;(r[0]!==s[0]||r[1]!==s[1]||r[2]!==s[2]||r[3]!==s[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class ip extends qt{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.bindFramebuffer(s.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class op extends qt{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.bindRenderbuffer(s.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class $c extends qt{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.bindTexture(s.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class ap extends qt{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.bindBuffer(s.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class Ql extends qt{getDefault(){return null}set(r){const s=this.gl;s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class Lo extends qt{getDefault(){return null}set(r){var s;if(r===this.current&&!this.dirty)return;const c=this.gl;Ko(c)?c.bindVertexArray(r):(s=c.getExtension("OES_vertex_array_object"))===null||s===void 0||s.bindVertexArrayOES(r),this.current=r,this.dirty=!1}}class Uc extends qt{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class jc extends qt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class Vc extends qt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class eu extends qt{constructor(r,s){super(r),this.context=r,this.parent=s}getDefault(){return null}}class qc extends eu{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class ba extends eu{set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class Zc extends eu{set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class Cg{constructor(r,s,c,d,m){this.context=r,this.width=s,this.height=c;const w=r.gl,T=this.framebuffer=w.createFramebuffer();if(this.colorAttachment=new qc(r,T),d)this.depthAttachment=m?new Zc(r,T):new ba(r,T);else if(m)throw new Error("Stencil cannot be set without depth");if(w.checkFramebufferStatus(w.FRAMEBUFFER)!==w.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const r=this.context.gl,s=this.colorAttachment.get();if(s&&r.deleteTexture(s),this.depthAttachment){const c=this.depthAttachment.get();c&&r.deleteRenderbuffer(c)}r.deleteFramebuffer(this.framebuffer)}}class Cr{constructor(r,s,c){this.blendFunction=r,this.blendColor=s,this.mask=c}}Cr.Replace=[1,0],Cr.disabled=new Cr(Cr.Replace,h.aM.transparent,[!1,!1,!1,!1]),Cr.unblended=new Cr(Cr.Replace,h.aM.transparent,[!0,!0,!0,!0]),Cr.alphaBlended=new Cr([1,771],h.aM.transparent,[!0,!0,!0,!0]);class kg{constructor(r){var s,c;if(this.gl=r,this.clearColor=new Yl(this),this.clearDepth=new _g(this),this.clearStencil=new Ya(this),this.colorMask=new vg(this),this.depthMask=new Kd(this),this.stencilMask=new xg(this),this.stencilFunc=new Xd(this),this.stencilOp=new Nc(this),this.stencilTest=new Yd(this),this.depthRange=new Jd(this),this.depthTest=new Qd(this),this.depthFunc=new ep(this),this.blend=new xa(this),this.blendFunc=new tp(this),this.blendColor=new bg(this),this.blendEquation=new rp(this),this.cullFace=new Qs(this),this.cullFaceSide=new wg(this),this.frontFace=new Jl(this),this.program=new Sg(this),this.activeTexture=new Tg(this),this.viewport=new np(this),this.bindFramebuffer=new ip(this),this.bindRenderbuffer=new op(this),this.bindTexture=new $c(this),this.bindVertexBuffer=new ap(this),this.bindElementBuffer=new Ql(this),this.bindVertexArray=new Lo(this),this.pixelStoreUnpack=new Uc(this),this.pixelStoreUnpackPremultiplyAlpha=new jc(this),this.pixelStoreUnpackFlipY=new Vc(this),this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),Ko(r)){this.HALF_FLOAT=r.HALF_FLOAT;const d=r.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(s=r.RGBA16F)!==null&&s!==void 0?s:d==null?void 0:d.RGBA16F_EXT,this.RGB16F=(c=r.RGB16F)!==null&&c!==void 0?c:d==null?void 0:d.RGB16F_EXT,r.getExtension("EXT_color_buffer_float")}else{r.getExtension("EXT_color_buffer_half_float"),r.getExtension("OES_texture_half_float_linear");const d=r.getExtension("OES_texture_half_float");this.HALF_FLOAT=d==null?void 0:d.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,s){return new lo(this,r,s)}createVertexBuffer(r,s,c){return new Oc(this,r,s,c)}createRenderbuffer(r,s,c){const d=this.gl,m=d.createRenderbuffer();return this.bindRenderbuffer.set(m),d.renderbufferStorage(d.RENDERBUFFER,r,s,c),this.bindRenderbuffer.set(null),m}createFramebuffer(r,s,c,d){return new Cg(this,r,s,c,d)}clear({color:r,depth:s,stencil:c}){const d=this.gl;let m=0;r&&(m|=d.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set([!0,!0,!0,!0])),s!==void 0&&(m|=d.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(s),this.depthMask.set(!0)),c!==void 0&&(m|=d.STENCIL_BUFFER_BIT,this.clearStencil.set(c),this.stencilMask.set(255)),d.clear(m)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){h.aE(r.blendFunction,Cr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor)),this.colorMask.set(r.mask)}createVertexArray(){var r;return Ko(this.gl)?this.gl.createVertexArray():(r=this.gl.getExtension("OES_vertex_array_object"))===null||r===void 0?void 0:r.createVertexArrayOES()}deleteVertexArray(r){var s;return Ko(this.gl)?this.gl.deleteVertexArray(r):(s=this.gl.getExtension("OES_vertex_array_object"))===null||s===void 0?void 0:s.deleteVertexArrayOES(r)}unbindVAO(){this.bindVertexArray.set(null)}}class kt{constructor(r,s,c){this.func=r,this.mask=s,this.range=c}}kt.ReadOnly=!1,kt.ReadWrite=!0,kt.disabled=new kt(519,kt.ReadOnly,[0,1]);const tu=7680;class or{constructor(r,s,c,d,m,w){this.test=r,this.ref=s,this.mask=c,this.fail=d,this.depthFail=m,this.pass=w}}or.disabled=new or({func:519,mask:0},0,0,tu,tu,tu);class Xt{constructor(r,s,c){this.enable=r,this.mode=s,this.frontFace=c}}let wa;function el(g,r,s,c,d){const m=g.context,w=m.gl,T=g.useProgram("collisionBox"),C=[];let E=0,P=0;for(let re=0;re<c.length;re++){const oe=c[re],W=r.getTile(oe).getBucket(s);if(!W)continue;const ue=d?W.textCollisionBox:W.iconCollisionBox,pe=W.collisionCircleArray;if(pe.length>0){const ye=h.H();h.aQ(ye,W.placementInvProjMatrix,g.transform.glCoordMatrix),h.aQ(ye,ye,W.placementViewportMatrix),C.push({circleArray:pe,circleOffset:P,transform:oe.posMatrix,invTransform:ye,coord:oe}),E+=pe.length/4,P=E}ue&&T.draw(m,w.LINES,kt.disabled,or.disabled,g.colorModeForRenderPass(),Xt.disabled,{u_matrix:oe.posMatrix,u_pixel_extrude_scale:[1/(M=g.transform).width,1/M.height]},g.style.map.terrain&&g.style.map.terrain.getTerrainData(oe),s.id,ue.layoutVertexBuffer,ue.indexBuffer,ue.segments,null,g.transform.zoom,null,null,ue.collisionVertexBuffer)}var M;if(!d||!C.length)return;const N=g.useProgram("collisionCircle"),V=new h.aR;V.resize(4*E),V._trim();let G=0;for(const re of C)for(let oe=0;oe<re.circleArray.length/4;oe++){const W=4*oe,ue=re.circleArray[W+0],pe=re.circleArray[W+1],ye=re.circleArray[W+2],Ce=re.circleArray[W+3];V.emplace(G++,ue,pe,ye,Ce,0),V.emplace(G++,ue,pe,ye,Ce,1),V.emplace(G++,ue,pe,ye,Ce,2),V.emplace(G++,ue,pe,ye,Ce,3)}(!wa||wa.length<2*E)&&(wa=function(re){const oe=2*re,W=new h.aT;W.resize(oe),W._trim();for(let ue=0;ue<oe;ue++){const pe=6*ue;W.uint16[pe+0]=4*ue+0,W.uint16[pe+1]=4*ue+1,W.uint16[pe+2]=4*ue+2,W.uint16[pe+3]=4*ue+2,W.uint16[pe+4]=4*ue+3,W.uint16[pe+5]=4*ue+0}return W}(E));const Y=m.createIndexBuffer(wa,!0),ee=m.createVertexBuffer(V,h.aS.members,!0);for(const re of C){const oe=_a(re.transform,re.invTransform,g.transform);N.draw(m,w.TRIANGLES,kt.disabled,or.disabled,g.colorModeForRenderPass(),Xt.disabled,oe,g.style.map.terrain&&g.style.map.terrain.getTerrainData(re.coord),s.id,ee,Y,h.a0.simpleSegment(0,2*re.circleOffset,re.circleArray.length,re.circleArray.length/2),null,g.transform.zoom,null,null,null)}ee.destroy(),Y.destroy()}Xt.disabled=new Xt(!1,1029,2305),Xt.backCCW=new Xt(!0,1029,2305);const tl=h.an(new Float32Array(16));function Gc(g,r,s,c,d,m){const{horizontalAlign:w,verticalAlign:T}=h.au(g);return new h.P((-(w-.5)*r/d+c[0])*m,(-(T-.5)*s/d+c[1])*m)}function Sa(g,r,s,c,d,m){const w=r.tileAnchorPoint.add(new h.P(r.translation[0],r.translation[1]));if(r.pitchWithMap){let T=c.mult(m);s||(T=T.rotate(-d));const C=w.add(T);return J(C.x,C.y,r.labelPlaneMatrix,r.getElevation).point}if(s){const T=we(r.tileAnchorPoint.x+1,r.tileAnchorPoint.y,r).point.sub(g),C=Math.atan(T.y/T.x)+(T.x<0?Math.PI:0);return g.add(c.rotate(C))}return g.add(c)}function Ja(g,r,s,c,d,m,w,T,C,E,P,M,N,V){const G=g.text.placedSymbolArray,Y=g.text.dynamicLayoutVertexArray,ee=g.icon.dynamicLayoutVertexArray,re={};Y.clear();for(let oe=0;oe<G.length;oe++){const W=G.get(oe),ue=W.hidden||!W.crossTileID||g.allowVerticalPlacement&&!W.placedOrientation?null:c[W.crossTileID];if(ue){const pe=new h.P(W.anchorX,W.anchorY),ye={getElevation:V,width:d.width,height:d.height,labelPlaneMatrix:m,lineVertexArray:null,pitchWithMap:s,projection:P,projectionCache:null,tileAnchorPoint:pe,translation:M,unwrappedTileID:N},Ce=s?J(pe.x,pe.y,w,V):we(pe.x,pe.y,ye),Me=D(d.cameraToCenterDistance,Ce.signedDistanceFromCamera);let $e=h.ai(g.textSizeData,C,W)*Me/h.ap;s&&($e*=g.tilePixelRatio/T);const{width:Ge,height:Fe,anchor:De,textOffset:Je,textBoxScale:vt}=ue,Oe=Gc(De,Ge,Fe,Je,vt,$e),je=P.getPitchedTextCorrection(d,pe.add(new h.P(M[0],M[1])),N),pt=Sa(Ce.point,ye,r,Oe,d.angle,je),hr=g.allowVerticalPlacement&&W.placedOrientation===h.ah.vertical?Math.PI/2:0;for(let wt=0;wt<W.numGlyphs;wt++)h.aj(Y,pt,hr);E&&W.associatedIconIndex>=0&&(re[W.associatedIconIndex]={shiftedAnchor:pt,angle:hr})}else at(W.numGlyphs,Y)}if(E){ee.clear();const oe=g.icon.placedSymbolArray;for(let W=0;W<oe.length;W++){const ue=oe.get(W);if(ue.hidden)at(ue.numGlyphs,ee);else{const pe=re[W];if(pe)for(let ye=0;ye<ue.numGlyphs;ye++)h.aj(ee,pe.shiftedAnchor,pe.angle);else at(ue.numGlyphs,ee)}}g.icon.dynamicLayoutVertexBuffer.updateData(ee)}g.text.dynamicLayoutVertexBuffer.updateData(Y)}function mi(g,r,s){return s.iconsInText&&r?"symbolTextAndIcon":g?"symbolSDF":"symbolIcon"}function Hc(g,r,s,c,d,m,w,T,C,E,P,M){const N=g.context,V=N.gl,G=g.transform,Y=ga(),ee=T==="map",re=C==="map",oe=T!=="viewport"&&s.layout.get("symbol-placement")!=="point",W=ee&&!re&&!oe,ue=!re&&oe,pe=!s.layout.get("symbol-sort-key").isConstant();let ye=!1;const Ce=g.depthModeForSublayer(0,kt.ReadOnly),Me=s._unevaluatedLayout.hasValue("text-variable-anchor")||s._unevaluatedLayout.hasValue("text-variable-anchor-offset"),$e=[],Ge=Y.getCircleRadiusCorrection(G);for(const Fe of c){const De=r.getTile(Fe),Je=De.getBucket(s);if(!Je)continue;const vt=d?Je.text:Je.icon;if(!vt||!vt.segments.get().length||!vt.hasVisibleVertices)continue;const Oe=vt.programConfigurations.get(s.id),je=d||Je.sdfIcons,pt=d?Je.textSizeData:Je.iconSizeData,hr=re||G.pitch!==0,wt=g.useProgram(mi(je,d,Je),Oe),At=h.ag(pt,G.zoom),dr=g.style.map.terrain&&g.style.map.terrain.getTerrainData(Fe);let pn,Ni,pr,Un,kn=[0,0],fn=null;if(d)Ni=De.glyphAtlasTexture,pr=V.LINEAR,pn=De.glyphAtlasTexture.size,Je.iconsInText&&(kn=De.imageAtlasTexture.size,fn=De.imageAtlasTexture,Un=hr||g.options.rotating||g.options.zooming||pt.kind==="composite"||pt.kind==="camera"?V.LINEAR:V.NEAREST);else{const zt=s.layout.get("icon-size").constantOr(0)!==1||Je.iconsNeedLinear;Ni=De.imageAtlasTexture,pr=je||g.options.rotating||g.options.zooming||zt||hr?V.LINEAR:V.NEAREST,pn=De.imageAtlasTexture.size}const In=Et(De,1,g.transform.zoom),ho=ue?Fe.posMatrix:tl,fs=Ho(ho,re,ee,g.transform,In),xu=so(ho,re,ee,g.transform,In),ms=so(Fe.posMatrix,re,ee,g.transform,In),_i=Y.translatePosition(g.transform,De,m,w),bu=Me&&Je.hasTextData(),_h=s.layout.get("icon-text-fit")!=="none"&&bu&&Je.hasIconData();if(oe){const zt=g.style.map.terrain?(gs,ys)=>g.style.map.terrain.getElevation(Fe,gs,ys):null,Ea=s.layout.get("text-rotation-alignment")==="map";q(Je,Fe.posMatrix,g,d,fs,ms,re,E,Ea,Y,Fe.toUnwrapped(),G.width,G.height,_i,zt)}const vi=Fe.posMatrix,xi=d&&Me||_h,Xo=oe||xi?tl:fs,$i=xu,ln=je&&s.paint.get(d?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let mn;mn=je?Je.iconsInText?Dc(pt.kind,At,W,re,oe,xi,g,vi,Xo,$i,_i,pn,kn,Ge):Js(pt.kind,At,W,re,oe,xi,g,vi,Xo,$i,_i,d,pn,!0,Ge):Wd(pt.kind,At,W,re,oe,xi,g,vi,Xo,$i,_i,d,pn,Ge);const oi={program:wt,buffers:vt,uniformValues:mn,atlasTexture:Ni,atlasTextureIcon:fn,atlasInterpolation:pr,atlasInterpolationIcon:Un,isSDF:je,hasHalo:ln};if(pe&&Je.canOverlap){ye=!0;const zt=vt.segments.get();for(const Ea of zt)$e.push({segments:new h.a0([Ea]),sortKey:Ea.sortKey,state:oi,terrainData:dr})}else $e.push({segments:vt.segments,sortKey:0,state:oi,terrainData:dr})}ye&&$e.sort((Fe,De)=>Fe.sortKey-De.sortKey);for(const Fe of $e){const De=Fe.state;if(N.activeTexture.set(V.TEXTURE0),De.atlasTexture.bind(De.atlasInterpolation,V.CLAMP_TO_EDGE),De.atlasTextureIcon&&(N.activeTexture.set(V.TEXTURE1),De.atlasTextureIcon&&De.atlasTextureIcon.bind(De.atlasInterpolationIcon,V.CLAMP_TO_EDGE)),De.isSDF){const Je=De.uniformValues;De.hasHalo&&(Je.u_is_halo=1,Wc(De.buffers,Fe.segments,s,g,De.program,Ce,P,M,Je,Fe.terrainData)),Je.u_is_halo=0}Wc(De.buffers,Fe.segments,s,g,De.program,Ce,P,M,De.uniformValues,Fe.terrainData)}}function Wc(g,r,s,c,d,m,w,T,C,E){const P=c.context;d.draw(P,P.gl.TRIANGLES,m,w,T,Xt.disabled,C,E,s.id,g.layoutVertexBuffer,g.indexBuffer,r,s.paint,c.transform.zoom,g.programConfigurations.get(s.id),g.dynamicLayoutVertexBuffer,g.opacityVertexBuffer)}function Kc(g,r,s,c){const d=g.context,m=d.gl,w=or.disabled,T=new Cr([m.ONE,m.ONE],h.aM.transparent,[!0,!0,!0,!0]),C=r.getBucket(s);if(!C)return;const E=c.key;let P=s.heatmapFbos.get(E);P||(P=rl(d,r.tileSize,r.tileSize),s.heatmapFbos.set(E,P)),d.bindFramebuffer.set(P.framebuffer),d.viewport.set([0,0,r.tileSize,r.tileSize]),d.clear({color:h.aM.transparent});const M=C.programConfigurations.get(s.id),N=g.useProgram("heatmap",M),V=g.style.map.terrain.getTerrainData(c);N.draw(d,m.TRIANGLES,kt.disabled,w,T,Xt.disabled,$n(c.posMatrix,r,g.transform.zoom,s.paint.get("heatmap-intensity")),V,s.id,C.layoutVertexBuffer,C.indexBuffer,C.segments,s.paint,g.transform.zoom,M)}function Ta(g,r,s){const c=g.context,d=c.gl;c.setColorMode(g.colorModeForRenderPass());const m=nl(c,r),w=s.key,T=r.heatmapFbos.get(w);T&&(c.activeTexture.set(d.TEXTURE0),d.bindTexture(d.TEXTURE_2D,T.colorAttachment.get()),c.activeTexture.set(d.TEXTURE1),m.bind(d.LINEAR,d.CLAMP_TO_EDGE),g.useProgram("heatmapTexture").draw(c,d.TRIANGLES,kt.disabled,or.disabled,g.colorModeForRenderPass(),Xt.disabled,Hl(g,r,0,1),null,r.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments,r.paint,g.transform.zoom),T.destroy(),r.heatmapFbos.delete(w))}function rl(g,r,s){var c,d;const m=g.gl,w=m.createTexture();m.bindTexture(m.TEXTURE_2D,w),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.LINEAR),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.LINEAR);const T=(c=g.HALF_FLOAT)!==null&&c!==void 0?c:m.UNSIGNED_BYTE,C=(d=g.RGBA16F)!==null&&d!==void 0?d:m.RGBA;m.texImage2D(m.TEXTURE_2D,0,C,r,s,0,m.RGBA,T,null);const E=g.createFramebuffer(r,s,!1,!1);return E.colorAttachment.set(w),E}function nl(g,r){return r.colorRampTexture||(r.colorRampTexture=new ot(g,r.colorRamp,g.gl.RGBA)),r.colorRampTexture}function Qa(g,r,s,c,d){if(!s||!c||!c.imageAtlas)return;const m=c.imageAtlas.patternPositions;let w=m[s.to.toString()],T=m[s.from.toString()];if(!w&&T&&(w=T),!T&&w&&(T=w),!w||!T){const C=d.getPaintProperty(r);w=m[C],T=m[C]}w&&T&&g.setConstantPatternPositions(w,T)}function il(g,r,s,c,d,m,w){const T=g.context.gl,C="fill-pattern",E=s.paint.get(C),P=E&&E.constantOr(1),M=s.getCrossfadeParameters();let N,V,G,Y,ee;w?(V=P&&!s.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",N=T.LINES):(V=P?"fillPattern":"fill",N=T.TRIANGLES);const re=E.constantOr(null);for(const oe of c){const W=r.getTile(oe);if(P&&!W.patternsLoaded())continue;const ue=W.getBucket(s);if(!ue)continue;const pe=ue.programConfigurations.get(s.id),ye=g.useProgram(V,pe),Ce=g.style.map.terrain&&g.style.map.terrain.getTerrainData(oe);P&&(g.context.activeTexture.set(T.TEXTURE0),W.imageAtlasTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),pe.updatePaintBuffers(M)),Qa(pe,C,re,W,s);const Me=Ce?oe:null,$e=g.translatePosMatrix(Me?Me.posMatrix:oe.posMatrix,W,s.paint.get("fill-translate"),s.paint.get("fill-translate-anchor"));if(w){Y=ue.indexBuffer2,ee=ue.segments2;const Ge=[T.drawingBufferWidth,T.drawingBufferHeight];G=V==="fillOutlinePattern"&&P?qd($e,g,M,W,Ge):dg($e,Ge)}else Y=ue.indexBuffer,ee=ue.segments,G=P?Vd($e,g,M,W):Ka($e);ye.draw(g.context,N,d,g.stencilModeForClipping(oe),m,Xt.disabled,G,Ce,s.id,ue.layoutVertexBuffer,Y,ee,s.paint,g.transform.zoom,pe)}}function ru(g,r,s,c,d,m,w){const T=g.context,C=T.gl,E="fill-extrusion-pattern",P=s.paint.get(E),M=P.constantOr(1),N=s.getCrossfadeParameters(),V=s.paint.get("fill-extrusion-opacity"),G=P.constantOr(null);for(const Y of c){const ee=r.getTile(Y),re=ee.getBucket(s);if(!re)continue;const oe=g.style.map.terrain&&g.style.map.terrain.getTerrainData(Y),W=re.programConfigurations.get(s.id),ue=g.useProgram(M?"fillExtrusionPattern":"fillExtrusion",W);M&&(g.context.activeTexture.set(C.TEXTURE0),ee.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),W.updatePaintBuffers(N)),Qa(W,E,G,ee,s);const pe=g.translatePosMatrix(Y.posMatrix,ee,s.paint.get("fill-extrusion-translate"),s.paint.get("fill-extrusion-translate-anchor")),ye=s.paint.get("fill-extrusion-vertical-gradient"),Ce=M?Gl(pe,g,ye,V,Y,N,ee):Xs(pe,g,ye,V);ue.draw(T,T.gl.TRIANGLES,d,m,w,Xt.backCCW,Ce,oe,s.id,re.layoutVertexBuffer,re.indexBuffer,re.segments,s.paint,g.transform.zoom,W,g.style.map.terrain&&re.centroidVertexBuffer)}}function es(g,r,s,c,d,m,w){const T=g.context,C=T.gl,E=s.fbo;if(!E)return;const P=g.useProgram("hillshade"),M=g.style.map.terrain&&g.style.map.terrain.getTerrainData(r);T.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,E.colorAttachment.get()),P.draw(T,C.TRIANGLES,d,m,w,Xt.disabled,((N,V,G,Y)=>{const ee=G.paint.get("hillshade-shadow-color"),re=G.paint.get("hillshade-highlight-color"),oe=G.paint.get("hillshade-accent-color");let W=G.paint.get("hillshade-illumination-direction")*(Math.PI/180);G.paint.get("hillshade-illumination-anchor")==="viewport"&&(W-=N.transform.angle);const ue=!N.options.moving;return{u_matrix:Y?Y.posMatrix:N.transform.calculatePosMatrix(V.tileID.toUnwrapped(),ue),u_image:0,u_latrange:Wl(0,V.tileID),u_light:[G.paint.get("hillshade-exaggeration"),W],u_shadow:ee,u_highlight:re,u_accent:oe}})(g,s,c,M?r:null),M,c.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments)}function ts(g,r,s,c,d,m){const w=g.context,T=w.gl,C=r.dem;if(C&&C.data){const E=C.dim,P=C.stride,M=C.getPixels();if(w.activeTexture.set(T.TEXTURE1),w.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||g.getTileTexture(P),r.demTexture){const V=r.demTexture;V.update(M,{premultiply:!1}),V.bind(T.NEAREST,T.CLAMP_TO_EDGE)}else r.demTexture=new ot(w,M,T.RGBA,{premultiply:!1}),r.demTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE);w.activeTexture.set(T.TEXTURE0);let N=r.fbo;if(!N){const V=new ot(w,{width:E,height:E,data:null},T.RGBA);V.bind(T.LINEAR,T.CLAMP_TO_EDGE),N=r.fbo=w.createFramebuffer(E,E,!0,!1),N.colorAttachment.set(V.texture)}w.bindFramebuffer.set(N.framebuffer),w.viewport.set([0,0,E,E]),g.useProgram("hillshadePrepare").draw(w,T.TRIANGLES,c,d,m,Xt.disabled,((V,G)=>{const Y=G.stride,ee=h.H();return h.aP(ee,0,h.X,-h.X,0,0,1),h.J(ee,ee,[0,-h.X,0]),{u_matrix:ee,u_image:1,u_dimension:[Y,Y],u_zoom:V.overscaledZ,u_unpack:G.getUnpackVector()}})(r.tileID,C),null,s.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments),r.needsHillshadePrepare=!1}}function sp(g,r,s,c,d,m){const w=c.paint.get("raster-fade-duration");if(!m&&w>0){const T=U.now(),C=(T-g.timeAdded)/w,E=r?(T-r.timeAdded)/w:-1,P=s.getSource(),M=d.coveringZoomLevel({tileSize:P.tileSize,roundZoom:P.roundZoom}),N=!r||Math.abs(r.tileID.overscaledZ-M)>Math.abs(g.tileID.overscaledZ-M),V=N&&g.refreshedUponExpiration?1:h.ac(N?C:1-E,0,1);return g.refreshedUponExpiration&&C>=1&&(g.refreshedUponExpiration=!1),r?{opacity:1,mix:1-V}:{opacity:V,mix:0}}return{opacity:1,mix:0}}const Xc=new h.aM(1,0,0,1),Ot=new h.aM(0,1,0,1),nu=new h.aM(0,0,1,1),Ig=new h.aM(1,0,1,1),lp=new h.aM(0,1,1,1);function rs(g,r,s,c){iu(g,0,r+s/2,g.transform.width,s,c)}function up(g,r,s,c){iu(g,r-s/2,0,s,g.transform.height,c)}function iu(g,r,s,c,d,m){const w=g.context,T=w.gl;T.enable(T.SCISSOR_TEST),T.scissor(r*g.pixelRatio,s*g.pixelRatio,c*g.pixelRatio,d*g.pixelRatio),w.clear({color:m}),T.disable(T.SCISSOR_TEST)}function cp(g,r,s){const c=g.context,d=c.gl,m=s.posMatrix,w=g.useProgram("debug"),T=kt.disabled,C=or.disabled,E=g.colorModeForRenderPass(),P="$debug",M=g.style.map.terrain&&g.style.map.terrain.getTerrainData(s);c.activeTexture.set(d.TEXTURE0);const N=r.getTileByID(s.key).latestRawTileData,V=Math.floor((N&&N.byteLength||0)/1024),G=r.getTile(s).tileSize,Y=512/Math.min(G,512)*(s.overscaledZ/g.transform.zoom)*.5;let ee=s.canonical.toString();s.overscaledZ!==s.canonical.z&&(ee+=` => ${s.overscaledZ}`),function(re,oe){re.initDebugOverlayCanvas();const W=re.debugOverlayCanvas,ue=re.context.gl,pe=re.debugOverlayCanvas.getContext("2d");pe.clearRect(0,0,W.width,W.height),pe.shadowColor="white",pe.shadowBlur=2,pe.lineWidth=1.5,pe.strokeStyle="white",pe.textBaseline="top",pe.font="bold 36px Open Sans, sans-serif",pe.fillText(oe,5,5),pe.strokeText(oe,5,5),re.debugOverlayTexture.update(W),re.debugOverlayTexture.bind(ue.LINEAR,ue.CLAMP_TO_EDGE)}(g,`${ee} ${V}kB`),w.draw(c,d.TRIANGLES,T,C,Cr.alphaBlended,Xt.disabled,Ys(m,h.aM.transparent,Y),null,P,g.debugBuffer,g.quadTriangleIndexBuffer,g.debugSegments),w.draw(c,d.LINE_STRIP,T,C,E,Xt.disabled,Ys(m,h.aM.red),M,P,g.debugBuffer,g.tileBorderIndexBuffer,g.debugSegments)}function hp(g,r,s){const c=g.context,d=c.gl,m=g.colorModeForRenderPass(),w=new kt(d.LEQUAL,kt.ReadWrite,g.depthRangeFor3D),T=g.useProgram("terrain"),C=r.getTerrainMesh();c.bindFramebuffer.set(null),c.viewport.set([0,0,g.width,g.height]);for(const E of s){const P=g.renderToTexture.getTexture(E),M=r.getTerrainData(E.tileID);c.activeTexture.set(d.TEXTURE0),d.bindTexture(d.TEXTURE_2D,P.texture);const N=g.transform.calculatePosMatrix(E.tileID.toUnwrapped()),V=r.getMeshFrameDelta(g.transform.zoom),G=g.transform.calculateFogMatrix(E.tileID.toUnwrapped()),Y=Lc(N,V,G,g.style.sky,g.transform.pitch);T.draw(c,d.TRIANGLES,w,or.disabled,m,Xt.backCCW,Y,M,"terrain",C.vertexBuffer,C.indexBuffer,C.segments)}}class ou{constructor(r,s,c){this.vertexBuffer=r,this.indexBuffer=s,this.segments=c}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}class au{constructor(r,s){this.context=new kg(r),this.transform=s,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:h.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=ht.maxUnderzooming+ht.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Mc}resize(r,s,c){if(this.width=Math.floor(r*c),this.height=Math.floor(s*c),this.pixelRatio=c,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const d of this.style._order)this.style._layers[d].resize()}setup(){const r=this.context,s=new h.aX;s.emplaceBack(0,0),s.emplaceBack(h.X,0),s.emplaceBack(0,h.X),s.emplaceBack(h.X,h.X),this.tileExtentBuffer=r.createVertexBuffer(s,ya.members),this.tileExtentSegments=h.a0.simpleSegment(0,0,4,2);const c=new h.aX;c.emplaceBack(0,0),c.emplaceBack(h.X,0),c.emplaceBack(0,h.X),c.emplaceBack(h.X,h.X),this.debugBuffer=r.createVertexBuffer(c,ya.members),this.debugSegments=h.a0.simpleSegment(0,0,4,5);const d=new h.$;d.emplaceBack(0,0,0,0),d.emplaceBack(h.X,0,h.X,0),d.emplaceBack(0,h.X,0,h.X),d.emplaceBack(h.X,h.X,h.X,h.X),this.rasterBoundsBuffer=r.createVertexBuffer(d,oo.members),this.rasterBoundsSegments=h.a0.simpleSegment(0,0,4,2);const m=new h.aX;m.emplaceBack(0,0),m.emplaceBack(1,0),m.emplaceBack(0,1),m.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(m,ya.members),this.viewportSegments=h.a0.simpleSegment(0,0,4,2);const w=new h.aZ;w.emplaceBack(0),w.emplaceBack(1),w.emplaceBack(3),w.emplaceBack(2),w.emplaceBack(0),this.tileBorderIndexBuffer=r.createIndexBuffer(w);const T=new h.aY;T.emplaceBack(0,1,2),T.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(T);const C=this.context.gl;this.stencilClearMode=new or({func:C.ALWAYS,mask:0},0,255,C.ZERO,C.ZERO,C.ZERO)}clearStencil(){const r=this.context,s=r.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const c=h.H();h.aP(c,0,this.width,this.height,0,0,1),h.K(c,c,[s.drawingBufferWidth,s.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(r,s.TRIANGLES,kt.disabled,this.stencilClearMode,Cr.disabled,Xt.disabled,Nn(c),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(r,s){if(this.currentStencilSource===r.source||!r.isTileClipped()||!s||!s.length)return;this.currentStencilSource=r.source;const c=this.context,d=c.gl;this.nextStencilID+s.length>256&&this.clearStencil(),c.setColorMode(Cr.disabled),c.setDepthMode(kt.disabled);const m=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const w of s){const T=this._tileClippingMaskIDs[w.key]=this.nextStencilID++,C=this.style.map.terrain&&this.style.map.terrain.getTerrainData(w);m.draw(c,d.TRIANGLES,kt.disabled,new or({func:d.ALWAYS,mask:0},T,255,d.KEEP,d.KEEP,d.REPLACE),Cr.disabled,Xt.disabled,Nn(w.posMatrix),C,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,s=this.context.gl;return new or({func:s.NOTEQUAL,mask:255},r,255,s.KEEP,s.KEEP,s.REPLACE)}stencilModeForClipping(r){const s=this.context.gl;return new or({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,s.KEEP,s.KEEP,s.REPLACE)}stencilConfigForOverlap(r){const s=this.context.gl,c=r.sort((w,T)=>T.overscaledZ-w.overscaledZ),d=c[c.length-1].overscaledZ,m=c[0].overscaledZ-d+1;if(m>1){this.currentStencilSource=void 0,this.nextStencilID+m>256&&this.clearStencil();const w={};for(let T=0;T<m;T++)w[T+d]=new or({func:s.GEQUAL,mask:255},T+this.nextStencilID,255,s.KEEP,s.KEEP,s.REPLACE);return this.nextStencilID+=m,[w,c]}return[{[d]:or.disabled},c]}colorModeForRenderPass(){const r=this.context.gl;return this._showOverdrawInspector?new Cr([r.CONSTANT_COLOR,r.ONE],new h.aM(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Cr.unblended:Cr.alphaBlended}depthModeForSublayer(r,s,c){if(!this.opaquePassEnabledForLayer())return kt.disabled;const d=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new kt(c||this.context.gl.LEQUAL,s,[d,d])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(r,s){this.style=r,this.options=s,this.lineAtlas=r.lineAtlas,this.imageManager=r.imageManager,this.glyphManager=r.glyphManager,this.symbolFadeChange=r.placement.symbolFadeChange(U.now()),this.imageManager.beginFrame();const c=this.style._order,d=this.style.sourceCaches,m={},w={},T={};for(const C in d){const E=d[C];E.used&&E.prepare(this.context),m[C]=E.getVisibleCoordinates(),w[C]=m[C].slice().reverse(),T[C]=E.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let C=0;C<c.length;C++)if(this.style._layers[c[C]].is3D()){this.opaquePassCutoff=C;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const C of c){const E=this.style._layers[C];if(!E.hasOffscreenPass()||E.isHidden(this.transform.zoom))continue;const P=w[E.source];(E.type==="custom"||P.length)&&this.renderLayer(this,d[E.source],E,P)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:s.showOverdrawInspector?h.aM.black:h.aM.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(C,E){const P=C.context,M=P.gl,N=((re,oe,W)=>({u_sky_color:re.properties.get("sky-color"),u_horizon_color:re.properties.get("horizon-color"),u_horizon:(oe.height/2+oe.getHorizon())*W,u_sky_horizon_blend:re.properties.get("sky-horizon-blend")*oe.height/2*W}))(E,C.style.map.transform,C.pixelRatio),V=new kt(M.LEQUAL,kt.ReadWrite,[0,1]),G=or.disabled,Y=C.colorModeForRenderPass(),ee=C.useProgram("sky");if(!E.mesh){const re=new h.aX;re.emplaceBack(-1,-1),re.emplaceBack(1,-1),re.emplaceBack(1,1),re.emplaceBack(-1,1);const oe=new h.aY;oe.emplaceBack(0,1,2),oe.emplaceBack(0,2,3),E.mesh=new ou(P.createVertexBuffer(re,ya.members),P.createIndexBuffer(oe),h.a0.simpleSegment(0,0,re.length,oe.length))}ee.draw(P,M.TRIANGLES,V,G,Y,Xt.disabled,N,void 0,"sky",E.mesh.vertexBuffer,E.mesh.indexBuffer,E.mesh.segments)}(this,this.style.sky),this._showOverdrawInspector=s.showOverdrawInspector,this.depthRangeFor3D=[0,1-(r._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=c.length-1;this.currentLayer>=0;this.currentLayer--){const C=this.style._layers[c[this.currentLayer]],E=d[C.source],P=m[C.source];this._renderTileClippingMasks(C,P),this.renderLayer(this,E,C,P)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<c.length;this.currentLayer++){const C=this.style._layers[c[this.currentLayer]],E=d[C.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(C))continue;const P=(C.type==="symbol"?T:w)[C.source];this._renderTileClippingMasks(C,m[C.source]),this.renderLayer(this,E,C,P)}if(this.options.showTileBoundaries){const C=function(E,P){let M=null;const N=Object.values(E._layers).flatMap(ee=>ee.source&&!ee.isHidden(P)?[E.sourceCaches[ee.source]]:[]),V=N.filter(ee=>ee.getSource().type==="vector"),G=N.filter(ee=>ee.getSource().type!=="vector"),Y=ee=>{(!M||M.getSource().maxzoom<ee.getSource().maxzoom)&&(M=ee)};return V.forEach(ee=>Y(ee)),M||G.forEach(ee=>Y(ee)),M}(this.style,this.transform.zoom);C&&function(E,P,M){for(let N=0;N<M.length;N++)cp(E,P,M[N])}(this,C,C.getVisibleCoordinates())}this.options.showPadding&&function(C){const E=C.transform.padding;rs(C,C.transform.height-(E.top||0),3,Xc),rs(C,E.bottom||0,3,Ot),up(C,E.left||0,3,nu),up(C,C.transform.width-(E.right||0),3,Ig);const P=C.transform.centerPoint;(function(M,N,V,G){iu(M,N-1,V-10,2,20,G),iu(M,N-10,V-1,20,2,G)})(C,P.x,C.transform.height-P.y,lp)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(r){if(!this.style||!this.style.map||!this.style.map.terrain)return;const s=this.terrainFacilitator.matrix,c=this.transform.modelViewProjectionMatrix;let d=this.terrainFacilitator.dirty;d||(d=r?!h.a_(s,c):!h.a$(s,c)),d||(d=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),d&&(h.b0(s,c),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(m,w){const T=m.context,C=T.gl,E=Cr.unblended,P=new kt(C.LEQUAL,kt.ReadWrite,[0,1]),M=w.getTerrainMesh(),N=w.sourceCache.getRenderableTiles(),V=m.useProgram("terrainDepth");T.bindFramebuffer.set(w.getFramebuffer("depth").framebuffer),T.viewport.set([0,0,m.width/devicePixelRatio,m.height/devicePixelRatio]),T.clear({color:h.aM.transparent,depth:1});for(const G of N){const Y=w.getTerrainData(G.tileID),ee={u_matrix:m.transform.calculatePosMatrix(G.tileID.toUnwrapped()),u_ele_delta:w.getMeshFrameDelta(m.transform.zoom)};V.draw(T,C.TRIANGLES,P,or.disabled,E,Xt.backCCW,ee,Y,"terrain",M.vertexBuffer,M.indexBuffer,M.segments)}T.bindFramebuffer.set(null),T.viewport.set([0,0,m.width,m.height])}(this,this.style.map.terrain),function(m,w){const T=m.context,C=T.gl,E=Cr.unblended,P=new kt(C.LEQUAL,kt.ReadWrite,[0,1]),M=w.getTerrainMesh(),N=w.getCoordsTexture(),V=w.sourceCache.getRenderableTiles(),G=m.useProgram("terrainCoords");T.bindFramebuffer.set(w.getFramebuffer("coords").framebuffer),T.viewport.set([0,0,m.width/devicePixelRatio,m.height/devicePixelRatio]),T.clear({color:h.aM.transparent,depth:1}),w.coordsIndex=[];for(const Y of V){const ee=w.getTerrainData(Y.tileID);T.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,N.texture);const re={u_matrix:m.transform.calculatePosMatrix(Y.tileID.toUnwrapped()),u_terrain_coords_id:(255-w.coordsIndex.length)/255,u_texture:0,u_ele_delta:w.getMeshFrameDelta(m.transform.zoom)};G.draw(T,C.TRIANGLES,P,or.disabled,E,Xt.backCCW,re,ee,"terrain",M.vertexBuffer,M.indexBuffer,M.segments),w.coordsIndex.push(Y.tileID.key)}T.bindFramebuffer.set(null),T.viewport.set([0,0,m.width,m.height])}(this,this.style.map.terrain))}renderLayer(r,s,c,d){if(!c.isHidden(this.transform.zoom)&&(c.type==="background"||c.type==="custom"||(d||[]).length))switch(this.id=c.id,c.type){case"symbol":(function(m,w,T,C,E){if(m.renderPass!=="translucent")return;const P=or.disabled,M=m.colorModeForRenderPass();(T._unevaluatedLayout.hasValue("text-variable-anchor")||T._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(N,V,G,Y,ee,re,oe,W,ue){const pe=V.transform,ye=ga(),Ce=ee==="map",Me=re==="map";for(const $e of N){const Ge=Y.getTile($e),Fe=Ge.getBucket(G);if(!Fe||!Fe.text||!Fe.text.segments.get().length)continue;const De=h.ag(Fe.textSizeData,pe.zoom),Je=Et(Ge,1,V.transform.zoom),vt=Ho($e.posMatrix,Me,Ce,V.transform,Je),Oe=G.layout.get("icon-text-fit")!=="none"&&Fe.hasIconData();if(De){const je=Math.pow(2,pe.zoom-Ge.tileID.overscaledZ),pt=V.style.map.terrain?(wt,At)=>V.style.map.terrain.getElevation($e,wt,At):null,hr=ye.translatePosition(pe,Ge,oe,W);Ja(Fe,Ce,Me,ue,pe,vt,$e.posMatrix,je,De,Oe,ye,hr,$e.toUnwrapped(),pt)}}}(C,m,T,w,T.layout.get("text-rotation-alignment"),T.layout.get("text-pitch-alignment"),T.paint.get("text-translate"),T.paint.get("text-translate-anchor"),E),T.paint.get("icon-opacity").constantOr(1)!==0&&Hc(m,w,T,C,!1,T.paint.get("icon-translate"),T.paint.get("icon-translate-anchor"),T.layout.get("icon-rotation-alignment"),T.layout.get("icon-pitch-alignment"),T.layout.get("icon-keep-upright"),P,M),T.paint.get("text-opacity").constantOr(1)!==0&&Hc(m,w,T,C,!0,T.paint.get("text-translate"),T.paint.get("text-translate-anchor"),T.layout.get("text-rotation-alignment"),T.layout.get("text-pitch-alignment"),T.layout.get("text-keep-upright"),P,M),w.map.showCollisionBoxes&&(el(m,w,T,C,!0),el(m,w,T,C,!1))})(r,s,c,d,this.style.placement.variableOffsets);break;case"circle":(function(m,w,T,C){if(m.renderPass!=="translucent")return;const E=T.paint.get("circle-opacity"),P=T.paint.get("circle-stroke-width"),M=T.paint.get("circle-stroke-opacity"),N=!T.layout.get("circle-sort-key").isConstant();if(E.constantOr(1)===0&&(P.constantOr(1)===0||M.constantOr(1)===0))return;const V=m.context,G=V.gl,Y=m.depthModeForSublayer(0,kt.ReadOnly),ee=or.disabled,re=m.colorModeForRenderPass(),oe=[];for(let W=0;W<C.length;W++){const ue=C[W],pe=w.getTile(ue),ye=pe.getBucket(T);if(!ye)continue;const Ce=ye.programConfigurations.get(T.id),Me=m.useProgram("circle",Ce),$e=ye.layoutVertexBuffer,Ge=ye.indexBuffer,Fe=m.style.map.terrain&&m.style.map.terrain.getTerrainData(ue),De={programConfiguration:Ce,program:Me,layoutVertexBuffer:$e,indexBuffer:Ge,uniformValues:pg(m,ue,pe,T),terrainData:Fe};if(N){const Je=ye.segments.get();for(const vt of Je)oe.push({segments:new h.a0([vt]),sortKey:vt.sortKey,state:De})}else oe.push({segments:ye.segments,sortKey:0,state:De})}N&&oe.sort((W,ue)=>W.sortKey-ue.sortKey);for(const W of oe){const{programConfiguration:ue,program:pe,layoutVertexBuffer:ye,indexBuffer:Ce,uniformValues:Me,terrainData:$e}=W.state;pe.draw(V,G.TRIANGLES,Y,ee,re,Xt.disabled,Me,$e,T.id,ye,Ce,W.segments,T.paint,m.transform.zoom,ue)}})(r,s,c,d);break;case"heatmap":(function(m,w,T,C){if(T.paint.get("heatmap-opacity")===0)return;const E=m.context;if(m.style.map.terrain){for(const P of C){const M=w.getTile(P);w.hasRenderableParent(P)||(m.renderPass==="offscreen"?Kc(m,M,T,P):m.renderPass==="translucent"&&Ta(m,T,P))}E.viewport.set([0,0,m.width,m.height])}else m.renderPass==="offscreen"?function(P,M,N,V){const G=P.context,Y=G.gl,ee=or.disabled,re=new Cr([Y.ONE,Y.ONE],h.aM.transparent,[!0,!0,!0,!0]);(function(oe,W,ue){const pe=oe.gl;oe.activeTexture.set(pe.TEXTURE1),oe.viewport.set([0,0,W.width/4,W.height/4]);let ye=ue.heatmapFbos.get(h.aU);ye?(pe.bindTexture(pe.TEXTURE_2D,ye.colorAttachment.get()),oe.bindFramebuffer.set(ye.framebuffer)):(ye=rl(oe,W.width/4,W.height/4),ue.heatmapFbos.set(h.aU,ye))})(G,P,N),G.clear({color:h.aM.transparent});for(let oe=0;oe<V.length;oe++){const W=V[oe];if(M.hasRenderableParent(W))continue;const ue=M.getTile(W),pe=ue.getBucket(N);if(!pe)continue;const ye=pe.programConfigurations.get(N.id),Ce=P.useProgram("heatmap",ye),{zoom:Me}=P.transform;Ce.draw(G,Y.TRIANGLES,kt.disabled,ee,re,Xt.disabled,$n(W.posMatrix,ue,Me,N.paint.get("heatmap-intensity")),null,N.id,pe.layoutVertexBuffer,pe.indexBuffer,pe.segments,N.paint,P.transform.zoom,ye)}G.viewport.set([0,0,P.width,P.height])}(m,w,T,C):m.renderPass==="translucent"&&function(P,M){const N=P.context,V=N.gl;N.setColorMode(P.colorModeForRenderPass());const G=M.heatmapFbos.get(h.aU);G&&(N.activeTexture.set(V.TEXTURE0),V.bindTexture(V.TEXTURE_2D,G.colorAttachment.get()),N.activeTexture.set(V.TEXTURE1),nl(N,M).bind(V.LINEAR,V.CLAMP_TO_EDGE),P.useProgram("heatmapTexture").draw(N,V.TRIANGLES,kt.disabled,or.disabled,P.colorModeForRenderPass(),Xt.disabled,Hl(P,M,0,1),null,M.id,P.viewportBuffer,P.quadTriangleIndexBuffer,P.viewportSegments,M.paint,P.transform.zoom))}(m,T)})(r,s,c,d);break;case"line":(function(m,w,T,C){if(m.renderPass!=="translucent")return;const E=T.paint.get("line-opacity"),P=T.paint.get("line-width");if(E.constantOr(1)===0||P.constantOr(1)===0)return;const M=m.depthModeForSublayer(0,kt.ReadOnly),N=m.colorModeForRenderPass(),V=T.paint.get("line-dasharray"),G=T.paint.get("line-pattern"),Y=G.constantOr(1),ee=T.paint.get("line-gradient"),re=T.getCrossfadeParameters(),oe=Y?"linePattern":V?"lineSDF":ee?"lineGradient":"line",W=m.context,ue=W.gl;let pe=!0;for(const ye of C){const Ce=w.getTile(ye);if(Y&&!Ce.patternsLoaded())continue;const Me=Ce.getBucket(T);if(!Me)continue;const $e=Me.programConfigurations.get(T.id),Ge=m.context.program.get(),Fe=m.useProgram(oe,$e),De=pe||Fe.program!==Ge,Je=m.style.map.terrain&&m.style.map.terrain.getTerrainData(ye),vt=G.constantOr(null);if(vt&&Ce.imageAtlas){const pt=Ce.imageAtlas,hr=pt.patternPositions[vt.to.toString()],wt=pt.patternPositions[vt.from.toString()];hr&&wt&&$e.setConstantPatternPositions(hr,wt)}const Oe=Je?ye:null,je=Y?Xa(m,Ce,T,re,Oe):V?fg(m,Ce,T,V,re,Oe):ee?Zd(m,Ce,T,Me.lineClipsArray.length,Oe):Kl(m,Ce,T,Oe);if(Y)W.activeTexture.set(ue.TEXTURE0),Ce.imageAtlasTexture.bind(ue.LINEAR,ue.CLAMP_TO_EDGE),$e.updatePaintBuffers(re);else if(V&&(De||m.lineAtlas.dirty))W.activeTexture.set(ue.TEXTURE0),m.lineAtlas.bind(W);else if(ee){const pt=Me.gradients[T.id];let hr=pt.texture;if(T.gradientVersion!==pt.version){let wt=256;if(T.stepInterpolant){const At=w.getSource().maxzoom,dr=ye.canonical.z===At?Math.ceil(1<<m.transform.maxZoom-ye.canonical.z):1;wt=h.ac(h.aV(Me.maxLineLength/h.X*1024*dr),256,W.maxTextureSize)}pt.gradient=h.aW({expression:T.gradientExpression(),evaluationKey:"lineProgress",resolution:wt,image:pt.gradient||void 0,clips:Me.lineClipsArray}),pt.texture?pt.texture.update(pt.gradient):pt.texture=new ot(W,pt.gradient,ue.RGBA),pt.version=T.gradientVersion,hr=pt.texture}W.activeTexture.set(ue.TEXTURE0),hr.bind(T.stepInterpolant?ue.NEAREST:ue.LINEAR,ue.CLAMP_TO_EDGE)}Fe.draw(W,ue.TRIANGLES,M,m.stencilModeForClipping(ye),N,Xt.disabled,je,Je,T.id,Me.layoutVertexBuffer,Me.indexBuffer,Me.segments,T.paint,m.transform.zoom,$e,Me.layoutVertexBuffer2),pe=!1}})(r,s,c,d);break;case"fill":(function(m,w,T,C){const E=T.paint.get("fill-color"),P=T.paint.get("fill-opacity");if(P.constantOr(1)===0)return;const M=m.colorModeForRenderPass(),N=T.paint.get("fill-pattern"),V=m.opaquePassEnabledForLayer()&&!N.constantOr(1)&&E.constantOr(h.aM.transparent).a===1&&P.constantOr(0)===1?"opaque":"translucent";if(m.renderPass===V){const G=m.depthModeForSublayer(1,m.renderPass==="opaque"?kt.ReadWrite:kt.ReadOnly);il(m,w,T,C,G,M,!1)}if(m.renderPass==="translucent"&&T.paint.get("fill-antialias")){const G=m.depthModeForSublayer(T.getPaintProperty("fill-outline-color")?2:0,kt.ReadOnly);il(m,w,T,C,G,M,!0)}})(r,s,c,d);break;case"fill-extrusion":(function(m,w,T,C){const E=T.paint.get("fill-extrusion-opacity");if(E!==0&&m.renderPass==="translucent"){const P=new kt(m.context.gl.LEQUAL,kt.ReadWrite,m.depthRangeFor3D);if(E!==1||T.paint.get("fill-extrusion-pattern").constantOr(1))ru(m,w,T,C,P,or.disabled,Cr.disabled),ru(m,w,T,C,P,m.stencilModeFor3D(),m.colorModeForRenderPass());else{const M=m.colorModeForRenderPass();ru(m,w,T,C,P,or.disabled,M)}}})(r,s,c,d);break;case"hillshade":(function(m,w,T,C){if(m.renderPass!=="offscreen"&&m.renderPass!=="translucent")return;const E=m.context,P=m.depthModeForSublayer(0,kt.ReadOnly),M=m.colorModeForRenderPass(),[N,V]=m.renderPass==="translucent"?m.stencilConfigForOverlap(C):[{},C];for(const G of V){const Y=w.getTile(G);Y.needsHillshadePrepare!==void 0&&Y.needsHillshadePrepare&&m.renderPass==="offscreen"?ts(m,Y,T,P,or.disabled,M):m.renderPass==="translucent"&&es(m,G,Y,T,P,N[G.overscaledZ],M)}E.viewport.set([0,0,m.width,m.height])})(r,s,c,d);break;case"raster":(function(m,w,T,C){if(m.renderPass!=="translucent"||T.paint.get("raster-opacity")===0||!C.length)return;const E=m.context,P=E.gl,M=w.getSource(),N=m.useProgram("raster"),V=m.colorModeForRenderPass(),[G,Y]=M instanceof Pi?[{},C]:m.stencilConfigForOverlap(C),ee=Y[Y.length-1].overscaledZ,re=!m.options.moving;for(const oe of Y){const W=m.depthModeForSublayer(oe.overscaledZ-ee,T.paint.get("raster-opacity")===1?kt.ReadWrite:kt.ReadOnly,P.LESS),ue=w.getTile(oe);ue.registerFadeDuration(T.paint.get("raster-fade-duration"));const pe=w.findLoadedParent(oe,0),ye=w.findLoadedSibling(oe),Ce=sp(ue,pe||ye||null,w,T,m.transform,m.style.map.terrain);let Me,$e;const Ge=T.paint.get("raster-resampling")==="nearest"?P.NEAREST:P.LINEAR;E.activeTexture.set(P.TEXTURE0),ue.texture.bind(Ge,P.CLAMP_TO_EDGE,P.LINEAR_MIPMAP_NEAREST),E.activeTexture.set(P.TEXTURE1),pe?(pe.texture.bind(Ge,P.CLAMP_TO_EDGE,P.LINEAR_MIPMAP_NEAREST),Me=Math.pow(2,pe.tileID.overscaledZ-ue.tileID.overscaledZ),$e=[ue.tileID.canonical.x*Me%1,ue.tileID.canonical.y*Me%1]):ue.texture.bind(Ge,P.CLAMP_TO_EDGE,P.LINEAR_MIPMAP_NEAREST),ue.texture.useMipmap&&E.extTextureFilterAnisotropic&&m.transform.pitch>20&&P.texParameterf(P.TEXTURE_2D,E.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,E.extTextureFilterAnisotropicMax);const Fe=m.style.map.terrain&&m.style.map.terrain.getTerrainData(oe),De=Fe?oe:null,Je=De?De.posMatrix:m.transform.calculatePosMatrix(oe.toUnwrapped(),re),vt=mg(Je,$e||[0,0],Me||1,Ce,T);M instanceof Pi?N.draw(E,P.TRIANGLES,W,or.disabled,V,Xt.disabled,vt,Fe,T.id,M.boundsBuffer,m.quadTriangleIndexBuffer,M.boundsSegments):N.draw(E,P.TRIANGLES,W,G[oe.overscaledZ],V,Xt.disabled,vt,Fe,T.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments)}})(r,s,c,d);break;case"background":(function(m,w,T,C){const E=T.paint.get("background-color"),P=T.paint.get("background-opacity");if(P===0)return;const M=m.context,N=M.gl,V=m.transform,G=V.tileSize,Y=T.paint.get("background-pattern");if(m.isPatternMissing(Y))return;const ee=!Y&&E.a===1&&P===1&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==ee)return;const re=or.disabled,oe=m.depthModeForSublayer(0,ee==="opaque"?kt.ReadWrite:kt.ReadOnly),W=m.colorModeForRenderPass(),ue=m.useProgram(Y?"backgroundPattern":"background"),pe=C||V.coveringTiles({tileSize:G,terrain:m.style.map.terrain});Y&&(M.activeTexture.set(N.TEXTURE0),m.imageManager.bind(m.context));const ye=T.getCrossfadeParameters();for(const Ce of pe){const Me=C?Ce.posMatrix:m.transform.calculatePosMatrix(Ce.toUnwrapped()),$e=Y?Fc(Me,P,m,Y,{tileID:Ce,tileSize:G},ye):Xl(Me,P,E),Ge=m.style.map.terrain&&m.style.map.terrain.getTerrainData(Ce);ue.draw(M,N.TRIANGLES,oe,re,W,Xt.disabled,$e,Ge,T.id,m.tileExtentBuffer,m.quadTriangleIndexBuffer,m.tileExtentSegments)}})(r,0,c,d);break;case"custom":(function(m,w,T){const C=m.context,E=T.implementation;if(m.renderPass==="offscreen"){const P=E.prerender;P&&(m.setCustomLayerDefaults(),C.setColorMode(m.colorModeForRenderPass()),P.call(E,C.gl,m.transform.customLayerMatrix()),C.setDirty(),m.setBaseState())}else if(m.renderPass==="translucent"){m.setCustomLayerDefaults(),C.setColorMode(m.colorModeForRenderPass()),C.setStencilMode(or.disabled);const P=E.renderingMode==="3d"?new kt(m.context.gl.LEQUAL,kt.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,kt.ReadOnly);C.setDepthMode(P),E.render(C.gl,m.transform.customLayerMatrix(),{farZ:m.transform.farZ,nearZ:m.transform.nearZ,fov:m.transform._fov,modelViewProjectionMatrix:m.transform.modelViewProjectionMatrix,projectionMatrix:m.transform.projectionMatrix}),C.setDirty(),m.setBaseState(),C.bindFramebuffer.set(null)}})(r,0,c)}}translatePosMatrix(r,s,c,d,m){if(!c[0]&&!c[1])return r;const w=m?d==="map"?this.transform.angle:0:d==="viewport"?-this.transform.angle:0;if(w){const E=Math.sin(w),P=Math.cos(w);c=[c[0]*P-c[1]*E,c[0]*E+c[1]*P]}const T=[m?c[0]:Et(s,c[0],this.transform.zoom),m?c[1]:Et(s,c[1],this.transform.zoom),0],C=new Float32Array(16);return h.J(C,r,T),C}saveTileTexture(r){const s=this._tileTextures[r.size[0]];s?s.push(r):this._tileTextures[r.size[0]]=[r]}getTileTexture(r){const s=this._tileTextures[r];return s&&s.length>0?s.pop():null}isPatternMissing(r){if(!r)return!1;if(!r.from||!r.to)return!0;const s=this.imageManager.getPattern(r.from.toString()),c=this.imageManager.getPattern(r.to.toString());return!s||!c}useProgram(r,s){this.cache=this.cache||{};const c=r+(s?s.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[c]||(this.cache[c]=new Rc(this.context,Wo[r],s,Bc[r],this._showOverdrawInspector,this.style.map.terrain)),this.cache[c]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new ot(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:r,drawingBufferHeight:s}=this.context.gl;return this.width!==r||this.height!==s}}class ns{constructor(r,s){this.points=r,this.planes=s}static fromInvProjectionMatrix(r,s,c){const d=Math.pow(2,c),m=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(T=>{const C=1/(T=h.af([],T,r))[3]/s*d;return h.b1(T,T,[C,C,1/T[3],C])}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(T=>{const C=function(N,V){var G=V[0],Y=V[1],ee=V[2],re=G*G+Y*Y+ee*ee;return re>0&&(re=1/Math.sqrt(re)),N[0]=V[0]*re,N[1]=V[1]*re,N[2]=V[2]*re,N}([],function(N,V,G){var Y=V[0],ee=V[1],re=V[2],oe=G[0],W=G[1],ue=G[2];return N[0]=ee*ue-re*W,N[1]=re*oe-Y*ue,N[2]=Y*W-ee*oe,N}([],ke([],m[T[0]],m[T[1]]),ke([],m[T[2]],m[T[1]]))),E=-((P=C)[0]*(M=m[T[1]])[0]+P[1]*M[1]+P[2]*M[2]);var P,M;return C.concat(E)});return new ns(m,w)}}class is{constructor(r,s){this.min=r,this.max=s,this.center=function(c,d,m){return c[0]=.5*d[0],c[1]=.5*d[1],c[2]=.5*d[2],c}([],function(c,d,m){return c[0]=d[0]+m[0],c[1]=d[1]+m[1],c[2]=d[2]+m[2],c}([],this.min,this.max))}quadrant(r){const s=[r%2==0,r<2],c=Se(this.min),d=Se(this.max);for(let m=0;m<s.length;m++)c[m]=s[m]?this.min[m]:this.center[m],d[m]=s[m]?this.center[m]:this.max[m];return d[2]=this.max[2],new is(c,d)}distanceX(r){return Math.max(Math.min(this.max[0],r[0]),this.min[0])-r[0]}distanceY(r){return Math.max(Math.min(this.max[1],r[1]),this.min[1])-r[1]}intersects(r){const s=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let c=!0;for(let d=0;d<r.planes.length;d++){const m=r.planes[d];let w=0;for(let T=0;T<s.length;T++)h.b2(m,s[T])>=0&&w++;if(w===0)return 0;w!==s.length&&(c=!1)}if(c)return 2;for(let d=0;d<3;d++){let m=Number.MAX_VALUE,w=-Number.MAX_VALUE;for(let T=0;T<r.points.length;T++){const C=r.points[T][d]-this.min[d];m=Math.min(m,C),w=Math.max(w,C)}if(w<0||m>this.max[d]-this.min[d])return 0}return 1}}class os{constructor(r=0,s=0,c=0,d=0){if(isNaN(r)||r<0||isNaN(s)||s<0||isNaN(c)||c<0||isNaN(d)||d<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=s,this.left=c,this.right=d}interpolate(r,s,c){return s.top!=null&&r.top!=null&&(this.top=h.y.number(r.top,s.top,c)),s.bottom!=null&&r.bottom!=null&&(this.bottom=h.y.number(r.bottom,s.bottom,c)),s.left!=null&&r.left!=null&&(this.left=h.y.number(r.left,s.left,c)),s.right!=null&&r.right!=null&&(this.right=h.y.number(r.right,s.right,c)),this}getCenter(r,s){const c=h.ac((this.left+r-this.right)/2,0,r),d=h.ac((this.top+s-this.bottom)/2,0,s);return new h.P(c,d)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new os(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Yc=85.051129;class as{constructor(r,s,c,d,m){this.tileSize=512,this._renderWorldCopies=m===void 0||!!m,this._minZoom=r||0,this._maxZoom=s||22,this._minPitch=c??0,this._maxPitch=d??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new h.N(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new os,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={},this.minElevationForCurrentTile=0}clone(){const r=new as(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return r.apply(this),r}apply(r){this.tileSize=r.tileSize,this.latRange=r.latRange,this.lngRange=r.lngRange,this.width=r.width,this.height=r.height,this._center=r._center,this._elevation=r._elevation,this.minElevationForCurrentTile=r.minElevationForCurrentTile,this.zoom=r.zoom,this.angle=r.angle,this._fov=r._fov,this._pitch=r._pitch,this._unmodified=r._unmodified,this._edgeInsets=r._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}get maxZoom(){return this._maxZoom}set maxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}get minPitch(){return this._minPitch}set minPitch(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))}get maxPitch(){return this._maxPitch}set maxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new h.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(r){const s=-h.b3(r,-180,180)*Math.PI/180;this.angle!==s&&(this._unmodified=!1,this.angle=s,this._calcMatrices(),this.rotationMatrix=function(){var c=new h.A(4);return h.A!=Float32Array&&(c[1]=0,c[2]=0),c[0]=1,c[3]=1,c}(),function(c,d,m){var w=d[0],T=d[1],C=d[2],E=d[3],P=Math.sin(m),M=Math.cos(m);c[0]=w*M+C*P,c[1]=T*M+E*P,c[2]=w*-P+C*M,c[3]=T*-P+E*M}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(r){const s=h.ac(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==s&&(this._unmodified=!1,this._pitch=s,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=r/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(r){const s=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==s&&(this._unmodified=!1,this._zoom=s,this.tileZoom=Math.max(0,Math.floor(s)),this.scale=this.zoomScale(s),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(r){r!==this._elevation&&(this._elevation=r,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,s,c){this._unmodified=!1,this._edgeInsets.interpolate(r,s,c),this._constrain(),this._calcMatrices()}coveringZoomLevel(r){const s=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,s)}getVisibleUnwrappedCoordinates(r){const s=[new h.b4(0,r)];if(this._renderWorldCopies){const c=this.pointCoordinate(new h.P(0,0)),d=this.pointCoordinate(new h.P(this.width,0)),m=this.pointCoordinate(new h.P(this.width,this.height)),w=this.pointCoordinate(new h.P(0,this.height)),T=Math.floor(Math.min(c.x,d.x,m.x,w.x)),C=Math.floor(Math.max(c.x,d.x,m.x,w.x)),E=1;for(let P=T-E;P<=C+E;P++)P!==0&&s.push(new h.b4(P,r))}return s}coveringTiles(r){var s,c;let d=this.coveringZoomLevel(r);const m=d;if(r.minzoom!==void 0&&d<r.minzoom)return[];r.maxzoom!==void 0&&d>r.maxzoom&&(d=r.maxzoom);const w=this.pointCoordinate(this.getCameraPoint()),T=h.Z.fromLngLat(this.center),C=Math.pow(2,d),E=[C*w.x,C*w.y,0],P=[C*T.x,C*T.y,0],M=ns.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,d);let N=r.minzoom||0;!r.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(N=d);const V=r.terrain?2/Math.min(this.tileSize,r.tileSize)*this.tileSize:3,G=W=>({aabb:new is([W*C,0,0],[(W+1)*C,C,0]),zoom:0,x:0,y:0,wrap:W,fullyVisible:!1}),Y=[],ee=[],re=d,oe=r.reparseOverscaled?m:d;if(this._renderWorldCopies)for(let W=1;W<=3;W++)Y.push(G(-W)),Y.push(G(W));for(Y.push(G(0));Y.length>0;){const W=Y.pop(),ue=W.x,pe=W.y;let ye=W.fullyVisible;if(!ye){const Fe=W.aabb.intersects(M);if(Fe===0)continue;ye=Fe===2}const Ce=r.terrain?E:P,Me=W.aabb.distanceX(Ce),$e=W.aabb.distanceY(Ce),Ge=Math.max(Math.abs(Me),Math.abs($e));if(W.zoom===re||Ge>V+(1<<re-W.zoom)-2&&W.zoom>=N){const Fe=re-W.zoom,De=E[0]-.5-(ue<<Fe),Je=E[1]-.5-(pe<<Fe);ee.push({tileID:new h.S(W.zoom===re?oe:W.zoom,W.wrap,W.zoom,ue,pe),distanceSq:Ze([P[0]-.5-ue,P[1]-.5-pe]),tileDistanceToCamera:Math.sqrt(De*De+Je*Je)})}else for(let Fe=0;Fe<4;Fe++){const De=(ue<<1)+Fe%2,Je=(pe<<1)+(Fe>>1),vt=W.zoom+1;let Oe=W.aabb.quadrant(Fe);if(r.terrain){const je=new h.S(vt,W.wrap,vt,De,Je),pt=r.terrain.getMinMaxElevation(je),hr=(s=pt.minElevation)!==null&&s!==void 0?s:this.elevation,wt=(c=pt.maxElevation)!==null&&c!==void 0?c:this.elevation;Oe=new is([Oe.min[0],Oe.min[1],hr],[Oe.max[0],Oe.max[1],wt])}Y.push({aabb:Oe,zoom:vt,x:De,y:Je,wrap:W.wrap,fullyVisible:ye})}}return ee.sort((W,ue)=>W.distanceSq-ue.distanceSq).map(W=>W.tileID)}resize(r,s){this.width=r,this.height=s,this.pixelsToGLUnits=[2/r,-2/s],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(r){return Math.pow(2,r)}scaleZoom(r){return Math.log(r)/Math.LN2}project(r){const s=h.ac(r.lat,-85.051129,Yc);return new h.P(h.O(r.lng)*this.worldSize,h.Q(s)*this.worldSize)}unproject(r){return new h.Z(r.x/this.worldSize,r.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(r){const s=this.elevation,c=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,d=this.pointLocation(this.centerPoint,r),m=r.getElevationForLngLatZoom(d,this.tileZoom);if(!(this.elevation-m))return;const w=c+s-m,T=Math.cos(this._pitch)*this.cameraToCenterDistance/w/h.b5(1,d.lat),C=this.scaleZoom(T/this.tileSize);this._elevation=m,this._center=d,this.zoom=C}setLocationAtPoint(r,s){const c=this.pointCoordinate(s),d=this.pointCoordinate(this.centerPoint),m=this.locationCoordinate(r),w=new h.Z(m.x-(c.x-d.x),m.y-(c.y-d.y));this.center=this.coordinateLocation(w),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(r,s){return s?this.coordinatePoint(this.locationCoordinate(r),s.getElevationForLngLatZoom(r,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(r))}pointLocation(r,s){return this.coordinateLocation(this.pointCoordinate(r,s))}locationCoordinate(r){return h.Z.fromLngLat(r)}coordinateLocation(r){return r&&r.toLngLat()}pointCoordinate(r,s){if(s){const N=s.pointCoordinate(r);if(N!=null)return N}const c=[r.x,r.y,0,1],d=[r.x,r.y,1,1];h.af(c,c,this.pixelMatrixInverse),h.af(d,d,this.pixelMatrixInverse);const m=c[3],w=d[3],T=c[1]/m,C=d[1]/w,E=c[2]/m,P=d[2]/w,M=E===P?0:(0-E)/(P-E);return new h.Z(h.y.number(c[0]/m,d[0]/w,M)/this.worldSize,h.y.number(T,C,M)/this.worldSize)}coordinatePoint(r,s=0,c=this.pixelMatrix){const d=[r.x*this.worldSize,r.y*this.worldSize,s,1];return h.af(d,d,c),new h.P(d[0]/d[3],d[1]/d[3])}getBounds(){const r=Math.max(0,this.height/2-this.getHorizon());return new xe().extend(this.pointLocation(new h.P(0,r))).extend(this.pointLocation(new h.P(this.width,r))).extend(this.pointLocation(new h.P(this.width,this.height))).extend(this.pointLocation(new h.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new xe([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(r){r?(this.lngRange=[r.getWest(),r.getEast()],this.latRange=[r.getSouth(),r.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,Yc])}calculateTileMatrix(r){const s=r.canonical,c=this.worldSize/this.zoomScale(s.z),d=s.x+Math.pow(2,s.z)*r.wrap,m=h.an(new Float64Array(16));return h.J(m,m,[d*c,s.y*c,0]),h.K(m,m,[c/h.X,c/h.X,1]),m}calculatePosMatrix(r,s=!1){const c=r.key,d=s?this._alignedPosMatrixCache:this._posMatrixCache;if(d[c])return d[c];const m=this.calculateTileMatrix(r);return h.L(m,s?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,m),d[c]=new Float32Array(m),d[c]}calculateFogMatrix(r){const s=r.key,c=this._fogMatrixCache;if(c[s])return c[s];const d=this.calculateTileMatrix(r);return h.L(d,this.fogMatrix,d),c[s]=new Float32Array(d),c[s]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(r,s){s=h.ac(+s,this.minZoom,this.maxZoom);const c={center:new h.N(r.lng,r.lat),zoom:s};let d=this.lngRange;if(!this._renderWorldCopies&&d===null){const W=179.9999999999;d=[-W,W]}const m=this.tileSize*this.zoomScale(c.zoom);let w=0,T=m,C=0,E=m,P=0,M=0;const{x:N,y:V}=this.size;if(this.latRange){const W=this.latRange;w=h.Q(W[1])*m,T=h.Q(W[0])*m,T-w<V&&(P=V/(T-w))}d&&(C=h.b3(h.O(d[0])*m,0,m),E=h.b3(h.O(d[1])*m,0,m),E<C&&(E+=m),E-C<N&&(M=N/(E-C)));const{x:G,y:Y}=this.project.call({worldSize:m},r);let ee,re;const oe=Math.max(M||0,P||0);if(oe){const W=new h.P(M?(E+C)/2:G,P?(T+w)/2:Y);return c.center=this.unproject.call({worldSize:m},W).wrap(),c.zoom+=this.scaleZoom(oe),c}if(this.latRange){const W=V/2;Y-W<w&&(re=w+W),Y+W>T&&(re=T-W)}if(d){const W=(C+E)/2;let ue=G;this._renderWorldCopies&&(ue=h.b3(G,W-m/2,W+m/2));const pe=N/2;ue-pe<C&&(ee=C+pe),ue+pe>E&&(ee=E-pe)}if(ee!==void 0||re!==void 0){const W=new h.P(ee??G,re??Y);c.center=this.unproject.call({worldSize:m},W).wrap()}return c}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const r=this._unmodified,{center:s,zoom:c}=this.getConstrained(this.center,this.zoom);this.center=s,this.zoom=c,this._unmodified=r,this._constraining=!1}_calcMatrices(){if(!this.height)return;const r=this.centerOffset,s=this.point.x,c=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=h.b5(1,this.center.lat)*this.worldSize;let d=h.an(new Float64Array(16));h.K(d,d,[this.width/2,-this.height/2,1]),h.J(d,d,[1,-1,0]),this.labelPlaneMatrix=d,d=h.an(new Float64Array(16)),h.K(d,d,[1,-1,1]),h.J(d,d,[-1,-1,0]),h.K(d,d,[2/this.width,2/this.height,1]),this.glCoordMatrix=d;const m=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),w=Math.min(this.elevation,this.minElevationForCurrentTile),T=m-w*this._pixelPerMeter/Math.cos(this._pitch),C=w<0?T:m,E=Math.PI/2+this._pitch,P=this._fov*(.5+r.y/this.height),M=Math.sin(P)*C/Math.sin(h.ac(Math.PI-E-P,.01,Math.PI-.01)),N=this.getHorizon(),V=2*Math.atan(N/this.cameraToCenterDistance)*(.5+r.y/(2*N)),G=Math.sin(V)*C/Math.sin(h.ac(Math.PI-E-V,.01,Math.PI-.01)),Y=Math.min(M,G);this.farZ=1.01*(Math.cos(Math.PI/2-this._pitch)*Y+C),this.nearZ=this.height/50,d=new Float64Array(16),h.b6(d,this._fov,this.width/this.height,this.nearZ,this.farZ),d[8]=2*-r.x/this.width,d[9]=2*r.y/this.height,this.projectionMatrix=h.ae(d),h.K(d,d,[1,-1,1]),h.J(d,d,[0,0,-this.cameraToCenterDistance]),h.b7(d,d,this._pitch),h.ad(d,d,this.angle),h.J(d,d,[-s,-c,0]),this.mercatorMatrix=h.K([],d,[this.worldSize,this.worldSize,this.worldSize]),h.K(d,d,[1,1,this._pixelPerMeter]),this.pixelMatrix=h.L(new Float64Array(16),this.labelPlaneMatrix,d),h.J(d,d,[0,0,-this.elevation]),this.modelViewProjectionMatrix=d,this.invModelViewProjectionMatrix=h.as([],d),this.fogMatrix=new Float64Array(16),h.b6(this.fogMatrix,this._fov,this.width/this.height,m,this.farZ),this.fogMatrix[8]=2*-r.x/this.width,this.fogMatrix[9]=2*r.y/this.height,h.K(this.fogMatrix,this.fogMatrix,[1,-1,1]),h.J(this.fogMatrix,this.fogMatrix,[0,0,-this.cameraToCenterDistance]),h.b7(this.fogMatrix,this.fogMatrix,this._pitch),h.ad(this.fogMatrix,this.fogMatrix,this.angle),h.J(this.fogMatrix,this.fogMatrix,[-s,-c,0]),h.K(this.fogMatrix,this.fogMatrix,[1,1,this._pixelPerMeter]),h.J(this.fogMatrix,this.fogMatrix,[0,0,-this.elevation]),this.pixelMatrix3D=h.L(new Float64Array(16),this.labelPlaneMatrix,d);const ee=this.width%2/2,re=this.height%2/2,oe=Math.cos(this.angle),W=Math.sin(this.angle),ue=s-Math.round(s)+oe*ee+W*re,pe=c-Math.round(c)+oe*re+W*ee,ye=new Float64Array(d);if(h.J(ye,ye,[ue>.5?ue-1:ue,pe>.5?pe-1:pe,0]),this.alignedModelViewProjectionMatrix=ye,d=h.as(new Float64Array(16),this.pixelMatrix),!d)throw new Error("failed to invert matrix");this.pixelMatrixInverse=d,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const r=this.pointCoordinate(new h.P(0,0)),s=[r.x*this.worldSize,r.y*this.worldSize,0,1];return h.af(s,s,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new h.P(0,r))}getCameraQueryGeometry(r){const s=this.getCameraPoint();if(r.length===1)return[r[0],s];{let c=s.x,d=s.y,m=s.x,w=s.y;for(const T of r)c=Math.min(c,T.x),d=Math.min(d,T.y),m=Math.max(m,T.x),w=Math.max(w,T.y);return[new h.P(c,d),new h.P(m,d),new h.P(m,w),new h.P(c,w),new h.P(c,d)]}}lngLatToCameraDepth(r,s){const c=this.locationCoordinate(r),d=[c.x*this.worldSize,c.y*this.worldSize,s,1];return h.af(d,d,this.modelViewProjectionMatrix),d[2]/d[3]}}function ol(g,r){let s,c=!1,d=null,m=null;const w=()=>{d=null,c&&(g.apply(m,s),d=setTimeout(w,r),c=!1)};return(...T)=>(c=!0,m=this,s=T,d||w(),d)}class su{constructor(r){this._getCurrentHash=()=>{const s=window.location.hash.replace("#","");if(this._hashName){let c;return s.split("&").map(d=>d.split("=")).forEach(d=>{d[0]===this._hashName&&(c=d)}),(c&&c[1]||"").split("/")}return s.split("/")},this._onHashChange=()=>{const s=this._getCurrentHash();if(s.length>=3&&!s.some(c=>isNaN(c))){const c=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(s[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+s[2],+s[1]],zoom:+s[0],bearing:c,pitch:+(s[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const s=window.location.href.replace(/(#.+)?$/,this.getHashString());window.history.replaceState(window.history.state,null,s)},this._removeHash=()=>{const s=this._getCurrentHash();if(s.length===0)return;const c=s.join("/");let d=c;d.split("&").length>0&&(d=d.split("&")[0]),this._hashName&&(d=`${this._hashName}=${c}`);let m=window.location.hash.replace(d,"");m.startsWith("#&")?m=m.slice(0,1)+m.slice(2):m==="#"&&(m="");let w=window.location.href.replace(/(#.+)?$/,m);w=w.replace("&&","&"),window.history.replaceState(window.history.state,null,w)},this._updateHash=ol(this._updateHashUnthrottled,300),this._hashName=r&&encodeURIComponent(r)}addTo(r){return this._map=r,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(r){const s=this._map.getCenter(),c=Math.round(100*this._map.getZoom())/100,d=Math.ceil((c*Math.LN2+Math.log(512/360/.5))/Math.LN10),m=Math.pow(10,d),w=Math.round(s.lng*m)/m,T=Math.round(s.lat*m)/m,C=this._map.getBearing(),E=this._map.getPitch();let P="";if(P+=r?`/${w}/${T}/${c}`:`${c}/${T}/${w}`,(C||E)&&(P+="/"+Math.round(10*C)/10),E&&(P+=`/${Math.round(E)}`),this._hashName){const M=this._hashName;let N=!1;const V=window.location.hash.slice(1).split("&").map(G=>{const Y=G.split("=")[0];return Y===M?(N=!0,`${Y}=${P}`):G}).filter(G=>G);return N||V.push(`${M}=${P}`),`#${V.join("&")}`}return`#${P}`}}const lu={linearity:.3,easing:h.b8(0,0,.3,1)},Jc=h.e({deceleration:2500,maxSpeed:1400},lu),Eg=h.e({deceleration:20,maxSpeed:1400},lu),dp=h.e({deceleration:1e3,maxSpeed:360},lu),uu=h.e({deceleration:1e3,maxSpeed:90},lu);class Qc{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:U.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,s=U.now();for(;r.length>0&&s-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const s={zoom:0,bearing:0,pitch:0,pan:new h.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:m}of this._inertiaBuffer)s.zoom+=m.zoomDelta||0,s.bearing+=m.bearingDelta||0,s.pitch+=m.pitchDelta||0,m.panDelta&&s.pan._add(m.panDelta),m.around&&(s.around=m.around),m.pinchAround&&(s.pinchAround=m.pinchAround);const c=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,d={};if(s.pan.mag()){const m=sl(s.pan.mag(),c,h.e({},Jc,r||{}));d.offset=s.pan.mult(m.amount/s.pan.mag()),d.center=this._map.transform.center,al(d,m)}if(s.zoom){const m=sl(s.zoom,c,Eg);d.zoom=this._map.transform.zoom+m.amount,al(d,m)}if(s.bearing){const m=sl(s.bearing,c,dp);d.bearing=this._map.transform.bearing+h.ac(m.amount,-179,179),al(d,m)}if(s.pitch){const m=sl(s.pitch,c,uu);d.pitch=this._map.transform.pitch+m.amount,al(d,m)}if(d.zoom||d.bearing){const m=s.pinchAround===void 0?s.around:s.pinchAround;d.around=m?this._map.unproject(m):this._map.getCenter()}return this.clear(),h.e(d,{noMoveStart:!0})}}function al(g,r){(!g.duration||g.duration<r.duration)&&(g.duration=r.duration,g.easing=r.easing)}function sl(g,r,s){const{maxSpeed:c,linearity:d,deceleration:m}=s,w=h.ac(g*d/(r/1e3),-c,c),T=Math.abs(w)/(m*d);return{easing:s.easing,duration:1e3*T,amount:w*(T/2)}}class dn extends h.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,s,c,d={}){const m=O.mousePos(s.getCanvas(),c),w=s.unproject(m);super(r,h.e({point:m,lngLat:w,originalEvent:c},d)),this._defaultPrevented=!1,this.target=s}}class Ca extends h.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,s,c){const d=r==="touchend"?c.changedTouches:c.touches,m=O.touchPos(s.getCanvasContainer(),d),w=m.map(C=>s.unproject(C)),T=m.reduce((C,E,P,M)=>C.add(E.div(M.length)),new h.P(0,0));super(r,{points:m,point:T,lngLats:w,lngLat:s.unproject(T),originalEvent:c}),this._defaultPrevented=!1}}class pp extends h.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,s,c){super(r,{originalEvent:c}),this._defaultPrevented=!1}}class fp{constructor(r,s){this._map=r,this._clickTolerance=s.clickTolerance}reset(){delete this._mousedownPos}wheel(r){return this._firePreventable(new pp(r.type,this._map,r))}mousedown(r,s){return this._mousedownPos=s,this._firePreventable(new dn(r.type,this._map,r))}mouseup(r){this._map.fire(new dn(r.type,this._map,r))}click(r,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||this._map.fire(new dn(r.type,this._map,r))}dblclick(r){return this._firePreventable(new dn(r.type,this._map,r))}mouseover(r){this._map.fire(new dn(r.type,this._map,r))}mouseout(r){this._map.fire(new dn(r.type,this._map,r))}touchstart(r){return this._firePreventable(new Ca(r.type,this._map,r))}touchmove(r){this._map.fire(new Ca(r.type,this._map,r))}touchend(r){this._map.fire(new Ca(r.type,this._map,r))}touchcancel(r){this._map.fire(new Ca(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class kr{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(r){this._map.fire(new dn(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new dn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._ignoreContextMenu||this._map.fire(new dn(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Bi{constructor(r){this._map=r}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(r){return this.transform.pointLocation(h.P.convert(r),this._map.terrain)}}class ni{constructor(r,s){this._map=r,this._tr=new Bi(r),this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=s.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,s){this.isEnabled()&&r.shiftKey&&r.button===0&&(O.disableDrag(),this._startPos=this._lastPos=s,this._active=!0)}mousemoveWindow(r,s){if(!this._active)return;const c=s;if(this._lastPos.equals(c)||!this._box&&c.dist(this._startPos)<this._clickTolerance)return;const d=this._startPos;this._lastPos=c,this._box||(this._box=O.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",r));const m=Math.min(d.x,c.x),w=Math.max(d.x,c.x),T=Math.min(d.y,c.y),C=Math.max(d.y,c.y);O.setTransform(this._box,`translate(${m}px,${T}px)`),this._box.style.width=w-m+"px",this._box.style.height=C-T+"px"}mouseupWindow(r,s){if(!this._active||r.button!==0)return;const c=this._startPos,d=s;if(this.reset(),O.suppressClick(),c.x!==d.x||c.y!==d.y)return this._map.fire(new h.k("boxzoomend",{originalEvent:r})),{cameraAnimation:m=>m.fitScreenCoordinates(c,d,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",r)}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(O.remove(this._box),this._box=null),O.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(r,s){return this._map.fire(new h.k(r,{originalEvent:s}))}}function ll(g,r){if(g.length!==r.length)throw new Error(`The number of touches and points are not equal - touches ${g.length}, points ${r.length}`);const s={};for(let c=0;c<g.length;c++)s[g[c].identifier]=r[c];return s}class eh{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(r,s,c){(this.centroid||c.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=r.timeStamp),c.length===this.numTouches&&(this.centroid=function(d){const m=new h.P(0,0);for(const w of d)m._add(w);return m.div(d.length)}(s),this.touches=ll(c,s)))}touchmove(r,s,c){if(this.aborted||!this.centroid)return;const d=ll(c,s);for(const m in this.touches){const w=d[m];(!w||w.dist(this.touches[m])>30)&&(this.aborted=!0)}}touchend(r,s,c){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),c.length===0){const d=!this.aborted&&this.centroid;if(this.reset(),d)return d}}}class cu{constructor(r){this.singleTap=new eh(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(r,s,c){this.singleTap.touchstart(r,s,c)}touchmove(r,s,c){this.singleTap.touchmove(r,s,c)}touchend(r,s,c){const d=this.singleTap.touchend(r,s,c);if(d){const m=r.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(d)<30;if(m&&w||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=d,this.count===this.numTaps)return this.reset(),d}}}class ss{constructor(r){this._tr=new Bi(r),this._zoomIn=new cu({numTouches:1,numTaps:2}),this._zoomOut=new cu({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,s,c){this._zoomIn.touchstart(r,s,c),this._zoomOut.touchstart(r,s,c)}touchmove(r,s,c){this._zoomIn.touchmove(r,s,c),this._zoomOut.touchmove(r,s,c)}touchend(r,s,c){const d=this._zoomIn.touchend(r,s,c),m=this._zoomOut.touchend(r,s,c),w=this._tr;return d?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:w.zoom+1,around:w.unproject(d)},{originalEvent:r})}):m?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:w.zoom-1,around:w.unproject(m)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ro{constructor(r){this._enabled=!!r.enable,this._moveStateManager=r.moveStateManager,this._clickTolerance=r.clickTolerance||1,this._moveFunction=r.move,this._activateOnStart=!!r.activateOnStart,r.assignEvents(this),this.reset()}reset(r){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(r)}_move(...r){const s=this._moveFunction(...r);if(s.bearingDelta||s.pitchDelta||s.around||s.panDelta)return this._active=!0,s}dragStart(r,s){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(r)&&(this._moveStateManager.startMove(r),this._lastPoint=s.length?s[0]:s,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(r,s){if(!this.isEnabled())return;const c=this._lastPoint;if(!c)return;if(r.preventDefault(),!this._moveStateManager.isValidMoveEvent(r))return void this.reset(r);const d=s.length?s[0]:s;return!this._moved&&d.dist(c)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=d,this._move(c,d))}dragEnd(r){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(r)&&(this._moved&&O.suppressClick(),this.reset(r))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const th={0:1,2:2};class hu{constructor(r){this._correctEvent=r.checkCorrectEvent}startMove(r){const s=O.mouseButton(r);this._eventButton=s}endMove(r){delete this._eventButton}isValidStartEvent(r){return this._correctEvent(r)}isValidMoveEvent(r){return!function(s,c){const d=th[c];return s.buttons===void 0||(s.buttons&d)!==d}(r,this._eventButton)}isValidEndEvent(r){return O.mouseButton(r)===this._eventButton}}class rh{constructor(){this._firstTouch=void 0}_isOneFingerTouch(r){return r.targetTouches.length===1}_isSameTouchEvent(r){return r.targetTouches[0].identifier===this._firstTouch}startMove(r){this._firstTouch=r.targetTouches[0].identifier}endMove(r){delete this._firstTouch}isValidStartEvent(r){return this._isOneFingerTouch(r)}isValidMoveEvent(r){return this._isOneFingerTouch(r)&&this._isSameTouchEvent(r)}isValidEndEvent(r){return this._isOneFingerTouch(r)&&this._isSameTouchEvent(r)}}const du=g=>{g.mousedown=g.dragStart,g.mousemoveWindow=g.dragMove,g.mouseup=g.dragEnd,g.contextmenu=r=>{r.preventDefault()}},nh=({enable:g,clickTolerance:r,bearingDegreesPerPixelMoved:s=.8})=>{const c=new hu({checkCorrectEvent:d=>O.mouseButton(d)===0&&d.ctrlKey||O.mouseButton(d)===2});return new Ro({clickTolerance:r,move:(d,m)=>({bearingDelta:(m.x-d.x)*s}),moveStateManager:c,enable:g,assignEvents:du})},ih=({enable:g,clickTolerance:r,pitchDegreesPerPixelMoved:s=-.5})=>{const c=new hu({checkCorrectEvent:d=>O.mouseButton(d)===0&&d.ctrlKey||O.mouseButton(d)===2});return new Ro({clickTolerance:r,move:(d,m)=>({pitchDelta:(m.y-d.y)*s}),moveStateManager:c,enable:g,assignEvents:du})};class ka{constructor(r,s){this._clickTolerance=r.clickTolerance||1,this._map=s,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new h.P(0,0)}_shouldBePrevented(r){return r<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(r,s,c){return this._calculateTransform(r,s,c)}touchmove(r,s,c){if(this._active){if(!this._shouldBePrevented(c.length))return r.preventDefault(),this._calculateTransform(r,s,c);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",r)}}touchend(r,s,c){this._calculateTransform(r,s,c),this._active&&this._shouldBePrevented(c.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,s,c){c.length>0&&(this._active=!0);const d=ll(c,s),m=new h.P(0,0),w=new h.P(0,0);let T=0;for(const E in d){const P=d[E],M=this._touches[E];M&&(m._add(P),w._add(P.sub(M)),T++,d[E]=P)}if(this._touches=d,this._shouldBePrevented(T)||!w.mag())return;const C=w.div(T);return this._sum._add(C),this._sum.mag()<this._clickTolerance?void 0:{around:m.div(T),panDelta:C}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class pu{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(r,s,c){this._firstTwoTouches||c.length<2||(this._firstTwoTouches=[c[0].identifier,c[1].identifier],this._start([s[0],s[1]]))}touchmove(r,s,c){if(!this._firstTwoTouches)return;r.preventDefault();const[d,m]=this._firstTwoTouches,w=ul(c,s,d),T=ul(c,s,m);if(!w||!T)return;const C=this._aroundCenter?null:w.add(T).div(2);return this._move([w,T],C,r)}touchend(r,s,c){if(!this._firstTwoTouches)return;const[d,m]=this._firstTwoTouches,w=ul(c,s,d),T=ul(c,s,m);w&&T||(this._active&&O.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function ul(g,r,s){for(let c=0;c<g.length;c++)if(g[c].identifier===s)return r[c]}function oh(g,r){return Math.log(g/r)/Math.LN2}class ah extends pu{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,s){const c=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(oh(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:oh(this._distance,c),pinchAround:s}}}function sh(g,r){return 180*g.angleWith(r)/Math.PI}class lh extends pu{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,s,c){const d=this._vector;if(this._vector=r[0].sub(r[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:sh(this._vector,d),pinchAround:s}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const s=25/(Math.PI*this._minDiameter)*360,c=sh(r,this._startVector);return Math.abs(c)<s}}function fu(g){return Math.abs(g.y)>Math.abs(g.x)}class ls extends pu{constructor(r){super(),this._currentTouchCount=0,this._map=r}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(r,s,c){super.touchstart(r,s,c),this._currentTouchCount=c.length}_start(r){this._lastPoints=r,fu(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,s,c){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const d=r[0].sub(this._lastPoints[0]),m=r[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(d,m,c.timeStamp),this._valid?(this._lastPoints=r,this._active=!0,{pitchDelta:(d.y+m.y)/2*-.5}):void 0}gestureBeginsVertically(r,s,c){if(this._valid!==void 0)return this._valid;const d=r.mag()>=2,m=s.mag()>=2;if(!d&&!m)return;if(!d||!m)return this._firstMove===void 0&&(this._firstMove=c),c-this._firstMove<100&&void 0;const w=r.y>0==s.y>0;return fu(r)&&fu(s)&&w}}const mp={panStep:100,bearingStep:15,pitchStep:10};class gi{constructor(r){this._tr=new Bi(r);const s=mp;this._panStep=s.panStep,this._bearingStep=s.bearingStep,this._pitchStep=s.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let s=0,c=0,d=0,m=0,w=0;switch(r.keyCode){case 61:case 107:case 171:case 187:s=1;break;case 189:case 109:case 173:s=-1;break;case 37:r.shiftKey?c=-1:(r.preventDefault(),m=-1);break;case 39:r.shiftKey?c=1:(r.preventDefault(),m=1);break;case 38:r.shiftKey?d=1:(r.preventDefault(),w=-1);break;case 40:r.shiftKey?d=-1:(r.preventDefault(),w=1);break;default:return}return this._rotationDisabled&&(c=0,d=0),{cameraAnimation:T=>{const C=this._tr;T.easeTo({duration:300,easeId:"keyboardHandler",easing:uo,zoom:s?Math.round(C.zoom)+s*(r.shiftKey?2:1):C.zoom,bearing:C.bearing+c*this._bearingStep,pitch:C.pitch+d*this._pitchStep,offset:[-m*this._panStep,-w*this._panStep],center:C.center},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function uo(g){return g*(2-g)}const uh=4.000244140625;class Oi{constructor(r,s){this._onTimeout=c=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)},this._map=r,this._tr=new Bi(r),this._triggerRenderFrame=s,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!r&&r.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(r){return!!this._map.cooperativeGestures.isEnabled()&&!(r.ctrlKey||this._map.cooperativeGestures.isBypassed(r))}wheel(r){if(!this.isEnabled())return;if(this._shouldBePrevented(r))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",r);let s=r.deltaMode===WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const c=U.now(),d=c-(this._lastWheelEventTime||0);this._lastWheelEventTime=c,s!==0&&s%uh==0?this._type="wheel":s!==0&&Math.abs(s)<4?this._type="trackpad":d>400?(this._type=null,this._lastValue=s,this._timeout=setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(d*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),r.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=r,this._delta-=s,this._active||this._start(r)),r.preventDefault()}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const s=O.mousePos(this._map.getCanvas(),r),c=this._tr;this._around=s.y>c.transform.height/2-c.transform.getHorizon()?h.N.convert(this._aroundCenter?c.center:c.unproject(s)):h.N.convert(c.center),this._aroundPoint=c.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._tr.transform;if(this._delta!==0){const C=this._type==="wheel"&&Math.abs(this._delta)>uh?this._wheelZoomRate:this._defaultZoomRate;let E=2/(1+Math.exp(-Math.abs(this._delta*C)));this._delta<0&&E!==0&&(E=1/E);const P=typeof this._targetZoom=="number"?r.zoomScale(this._targetZoom):r.scale;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(P*E))),this._type==="wheel"&&(this._startZoom=r.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const s=typeof this._targetZoom=="number"?this._targetZoom:r.zoom,c=this._startZoom,d=this._easing;let m,w=!1;const T=U.now()-this._lastWheelEventTime;if(this._type==="wheel"&&c&&d&&T){const C=Math.min(T/200,1),E=d(C);m=h.y.number(c,s,E),C<1?this._frameId||(this._frameId=!0):w=!0}else m=s,w=!0;return this._active=!0,w&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!w,zoomDelta:m-r.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let s=h.b9;if(this._prevEase){const c=this._prevEase,d=(U.now()-c.start)/c.duration,m=c.easing(d+.01)-c.easing(d),w=.27/Math.sqrt(m*m+1e-4)*.01,T=Math.sqrt(.0729-w*w);s=h.b8(w,T,.25,1)}return this._prevEase={start:U.now(),duration:r,easing:s},s}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Ia{constructor(r,s){this._clickZoom=r,this._tapZoom=s}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Ag{constructor(r){this._tr=new Bi(r),this.reset()}reset(){this._active=!1}dblclick(r,s){return r.preventDefault(),{cameraAnimation:c=>{c.easeTo({duration:300,zoom:this._tr.zoom+(r.shiftKey?-1:1),around:this._tr.unproject(s)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Pg{constructor(){this._tap=new cu({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(r,s,c){if(!this._swipePoint)if(this._tapTime){const d=s[0],m=r.timeStamp-this._tapTime<500,w=this._tapPoint.dist(d)<30;m&&w?c.length>0&&(this._swipePoint=d,this._swipeTouch=c[0].identifier):this.reset()}else this._tap.touchstart(r,s,c)}touchmove(r,s,c){if(this._tapTime){if(this._swipePoint){if(c[0].identifier!==this._swipeTouch)return;const d=s[0],m=d.y-this._swipePoint.y;return this._swipePoint=d,r.preventDefault(),this._active=!0,{zoomDelta:m/128}}}else this._tap.touchmove(r,s,c)}touchend(r,s,c){if(this._tapTime)this._swipePoint&&c.length===0&&this.reset();else{const d=this._tap.touchend(r,s,c);d&&(this._tapTime=r.timeStamp,this._tapPoint=d)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class gp{constructor(r,s,c){this._el=r,this._mousePan=s,this._touchPan=c}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class yp{constructor(r,s,c){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=s,this._mousePitch=c}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class ch{constructor(r,s,c,d){this._el=r,this._touchZoom=s,this._touchRotate=c,this._tapDragZoom=d,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class us{constructor(r,s){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=r,this._options=s,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const r=this._map.getCanvasContainer();r.classList.add("maplibregl-cooperative-gestures"),this._container=O.create("div","maplibregl-cooperative-gesture-screen",r);let s=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(s=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const c=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),d=document.createElement("div");d.className="maplibregl-desktop-message",d.textContent=s,this._container.appendChild(d);const m=document.createElement("div");m.className="maplibregl-mobile-message",m.textContent=c,this._container.appendChild(m),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(O.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(r){return r[this._bypassKey]}notifyGestureBlocked(r,s){this._enabled&&(this._map.fire(new h.k("cooperativegestureprevented",{gestureType:r,originalEvent:s})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const yi=g=>g.zoom||g.drag||g.pitch||g.rotate;class Ke extends h.k{}function mu(g){return g.panDelta&&g.panDelta.mag()||g.zoomDelta||g.bearingDelta||g.pitchDelta}class hh{constructor(r,s){this.handleWindowEvent=d=>{this.handleEvent(d,`${d.type}Window`)},this.handleEvent=(d,m)=>{if(d.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const w=d.type==="renderFrame"?void 0:d,T={needsRenderFrame:!1},C={},E={},P=d.touches,M=P?this._getMapTouches(P):void 0,N=M?O.touchPos(this._map.getCanvas(),M):O.mousePos(this._map.getCanvas(),d);for(const{handlerName:Y,handler:ee,allowed:re}of this._handlers){if(!ee.isEnabled())continue;let oe;this._blockedByActive(E,re,Y)?ee.reset():ee[m||d.type]&&(oe=ee[m||d.type](d,N,M),this.mergeHandlerResult(T,C,oe,Y,w),oe&&oe.needsRenderFrame&&this._triggerRenderFrame()),(oe||ee.isActive())&&(E[Y]=ee)}const V={};for(const Y in this._previousActiveHandlers)E[Y]||(V[Y]=w);this._previousActiveHandlers=E,(Object.keys(V).length||mu(T))&&(this._changes.push([T,C,V]),this._triggerRenderFrame()),(Object.keys(E).length||mu(T))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:G}=T;G&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],G(this._map))},this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Qc(r),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(s);const c=this._el;this._listeners=[[c,"touchstart",{passive:!0}],[c,"touchmove",{passive:!1}],[c,"touchend",void 0],[c,"touchcancel",void 0],[c,"mousedown",void 0],[c,"mousemove",void 0],[c,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[c,"mouseover",void 0],[c,"mouseout",void 0],[c,"dblclick",void 0],[c,"click",void 0],[c,"keydown",{capture:!1}],[c,"keyup",void 0],[c,"wheel",{passive:!1}],[c,"contextmenu",void 0],[window,"blur",void 0]];for(const[d,m,w]of this._listeners)O.addEventListener(d,m,d===document?this.handleWindowEvent:this.handleEvent,w)}destroy(){for(const[r,s,c]of this._listeners)O.removeEventListener(r,s,r===document?this.handleWindowEvent:this.handleEvent,c)}_addDefaultHandlers(r){const s=this._map,c=s.getCanvasContainer();this._add("mapEvent",new fp(s,r));const d=s.boxZoom=new ni(s,r);this._add("boxZoom",d),r.interactive&&r.boxZoom&&d.enable();const m=s.cooperativeGestures=new us(s,r.cooperativeGestures);this._add("cooperativeGestures",m),r.cooperativeGestures&&m.enable();const w=new ss(s),T=new Ag(s);s.doubleClickZoom=new Ia(T,w),this._add("tapZoom",w),this._add("clickZoom",T),r.interactive&&r.doubleClickZoom&&s.doubleClickZoom.enable();const C=new Pg;this._add("tapDragZoom",C);const E=s.touchPitch=new ls(s);this._add("touchPitch",E),r.interactive&&r.touchPitch&&s.touchPitch.enable(r.touchPitch);const P=nh(r),M=ih(r);s.dragRotate=new yp(r,P,M),this._add("mouseRotate",P,["mousePitch"]),this._add("mousePitch",M,["mouseRotate"]),r.interactive&&r.dragRotate&&s.dragRotate.enable();const N=(({enable:oe,clickTolerance:W})=>{const ue=new hu({checkCorrectEvent:pe=>O.mouseButton(pe)===0&&!pe.ctrlKey});return new Ro({clickTolerance:W,move:(pe,ye)=>({around:ye,panDelta:ye.sub(pe)}),activateOnStart:!0,moveStateManager:ue,enable:oe,assignEvents:du})})(r),V=new ka(r,s);s.dragPan=new gp(c,N,V),this._add("mousePan",N),this._add("touchPan",V,["touchZoom","touchRotate"]),r.interactive&&r.dragPan&&s.dragPan.enable(r.dragPan);const G=new lh,Y=new ah;s.touchZoomRotate=new ch(c,Y,G,C),this._add("touchRotate",G,["touchPan","touchZoom"]),this._add("touchZoom",Y,["touchPan","touchRotate"]),r.interactive&&r.touchZoomRotate&&s.touchZoomRotate.enable(r.touchZoomRotate);const ee=s.scrollZoom=new Oi(s,()=>this._triggerRenderFrame());this._add("scrollZoom",ee,["mousePan"]),r.interactive&&r.scrollZoom&&s.scrollZoom.enable(r.scrollZoom);const re=s.keyboard=new gi(s);this._add("keyboard",re),r.interactive&&r.keyboard&&s.keyboard.enable(),this._add("blockableMapEvent",new kr(s))}_add(r,s,c){this._handlers.push({handlerName:r,handler:s,allowed:c}),this._handlersById[r]=s}stop(r){if(!this._updatingCamera){for(const{handler:s}of this._handlers)s.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[]}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!yi(this._eventsInProgress)||this.isZooming()}_blockedByActive(r,s,c){for(const d in r)if(d!==c&&(!s||s.indexOf(d)<0))return!0;return!1}_getMapTouches(r){const s=[];for(const c of r)this._el.contains(c.target)&&s.push(c);return s}mergeHandlerResult(r,s,c,d,m){if(!c)return;h.e(r,c);const w={handlerName:d,originalEvent:c.originalEvent||m};c.zoomDelta!==void 0&&(s.zoom=w),c.panDelta!==void 0&&(s.drag=w),c.pitchDelta!==void 0&&(s.pitch=w),c.bearingDelta!==void 0&&(s.rotate=w)}_applyChanges(){const r={},s={},c={};for(const[d,m,w]of this._changes)d.panDelta&&(r.panDelta=(r.panDelta||new h.P(0,0))._add(d.panDelta)),d.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+d.zoomDelta),d.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+d.bearingDelta),d.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+d.pitchDelta),d.around!==void 0&&(r.around=d.around),d.pinchAround!==void 0&&(r.pinchAround=d.pinchAround),d.noInertia&&(r.noInertia=d.noInertia),h.e(s,m),h.e(c,w);this._updateMapTransform(r,s,c),this._changes=[]}_updateMapTransform(r,s,c){const d=this._map,m=d._getTransformForUpdate(),w=d.terrain;if(!(mu(r)||w&&this._terrainMovement))return this._fireEvents(s,c,!0);let{panDelta:T,zoomDelta:C,bearingDelta:E,pitchDelta:P,around:M,pinchAround:N}=r;N!==void 0&&(M=N),d._stop(!0),M=M||d.transform.centerPoint;const V=m.pointLocation(T?M.sub(T):M);E&&(m.bearing+=E),P&&(m.pitch+=P),C&&(m.zoom+=C),w?this._terrainMovement||!s.drag&&!s.zoom?s.drag&&this._terrainMovement?m.center=m.pointLocation(m.centerPoint.sub(T)):m.setLocationAtPoint(V,M):(this._terrainMovement=!0,this._map._elevationFreeze=!0,m.setLocationAtPoint(V,M)):m.setLocationAtPoint(V,M),d._applyUpdatedTransform(m),this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(s,c,!0)}_fireEvents(r,s,c){const d=yi(this._eventsInProgress),m=yi(r),w={};for(const M in r){const{originalEvent:N}=r[M];this._eventsInProgress[M]||(w[`${M}start`]=N),this._eventsInProgress[M]=r[M]}!d&&m&&this._fireEvent("movestart",m.originalEvent);for(const M in w)this._fireEvent(M,w[M]);m&&this._fireEvent("move",m.originalEvent);for(const M in r){const{originalEvent:N}=r[M];this._fireEvent(M,N)}const T={};let C;for(const M in this._eventsInProgress){const{handlerName:N,originalEvent:V}=this._eventsInProgress[M];this._handlersById[N].isActive()||(delete this._eventsInProgress[M],C=s[N]||V,T[`${M}end`]=C)}for(const M in T)this._fireEvent(M,T[M]);const E=yi(this._eventsInProgress),P=(d||m)&&!E;if(P&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const M=this._map._getTransformForUpdate();M.recalculateZoom(this._map.terrain),this._map._applyUpdatedTransform(M)}if(c&&P){this._updatingCamera=!0;const M=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),N=V=>V!==0&&-this._bearingSnap<V&&V<this._bearingSnap;!M||!M.essential&&U.prefersReducedMotion?(this._map.fire(new h.k("moveend",{originalEvent:C})),N(this._map.getBearing())&&this._map.resetNorth()):(N(M.bearing||this._map.getBearing())&&(M.bearing=0),M.freezeElevation=!0,this._map.easeTo(M,{originalEvent:C})),this._updatingCamera=!1}}_fireEvent(r,s){this._map.fire(new h.k(r,s?{originalEvent:s}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{delete this._frameId,this.handleEvent(new Ke("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class _p extends h.E{constructor(r,s){super(),this._renderFrameCallback=()=>{const c=Math.min((U.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(c)),c<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=s.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new h.N(this.transform.center.lng,this.transform.center.lat)}setCenter(r,s){return this.jumpTo({center:r},s)}panBy(r,s,c){return r=h.P.convert(r).mult(-1),this.panTo(this.transform.center,h.e({offset:r},s),c)}panTo(r,s,c){return this.easeTo(h.e({center:r},s),c)}getZoom(){return this.transform.zoom}setZoom(r,s){return this.jumpTo({zoom:r},s),this}zoomTo(r,s,c){return this.easeTo(h.e({zoom:r},s),c)}zoomIn(r,s){return this.zoomTo(this.getZoom()+1,r,s),this}zoomOut(r,s){return this.zoomTo(this.getZoom()-1,r,s),this}getBearing(){return this.transform.bearing}setBearing(r,s){return this.jumpTo({bearing:r},s),this}getPadding(){return this.transform.padding}setPadding(r,s){return this.jumpTo({padding:r},s),this}rotateTo(r,s,c){return this.easeTo(h.e({bearing:r},s),c)}resetNorth(r,s){return this.rotateTo(0,h.e({duration:1e3},r),s),this}resetNorthPitch(r,s){return this.easeTo(h.e({bearing:0,pitch:0,duration:1e3},r),s),this}snapToNorth(r,s){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,s):this}getPitch(){return this.transform.pitch}setPitch(r,s){return this.jumpTo({pitch:r},s),this}cameraForBounds(r,s){r=xe.convert(r).adjustAntiMeridian();const c=s&&s.bearing||0;return this._cameraForBoxAndBearing(r.getNorthWest(),r.getSouthEast(),c,s)}_cameraForBoxAndBearing(r,s,c,d){const m={top:0,bottom:0,right:0,left:0};if(typeof(d=h.e({padding:m,offset:[0,0],maxZoom:this.transform.maxZoom},d)).padding=="number"){const Fe=d.padding;d.padding={top:Fe,bottom:Fe,right:Fe,left:Fe}}d.padding=h.e(m,d.padding);const w=this.transform,T=w.padding,C=new xe(r,s),E=w.project(C.getNorthWest()),P=w.project(C.getNorthEast()),M=w.project(C.getSouthEast()),N=w.project(C.getSouthWest()),V=h.ba(-c),G=E.rotate(V),Y=P.rotate(V),ee=M.rotate(V),re=N.rotate(V),oe=new h.P(Math.max(G.x,Y.x,re.x,ee.x),Math.max(G.y,Y.y,re.y,ee.y)),W=new h.P(Math.min(G.x,Y.x,re.x,ee.x),Math.min(G.y,Y.y,re.y,ee.y)),ue=oe.sub(W),pe=(w.width-(T.left+T.right+d.padding.left+d.padding.right))/ue.x,ye=(w.height-(T.top+T.bottom+d.padding.top+d.padding.bottom))/ue.y;if(ye<0||pe<0)return void h.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Ce=Math.min(w.scaleZoom(w.scale*Math.min(pe,ye)),d.maxZoom),Me=h.P.convert(d.offset),$e=new h.P((d.padding.left-d.padding.right)/2,(d.padding.top-d.padding.bottom)/2).rotate(h.ba(c)),Ge=Me.add($e).mult(w.scale/w.zoomScale(Ce));return{center:w.unproject(E.add(M).div(2).sub(Ge)),zoom:Ce,bearing:c}}fitBounds(r,s,c){return this._fitInternal(this.cameraForBounds(r,s),s,c)}fitScreenCoordinates(r,s,c,d,m){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(h.P.convert(r)),this.transform.pointLocation(h.P.convert(s)),c,d),d,m)}_fitInternal(r,s,c){return r?(delete(s=h.e(r,s)).padding,s.linear?this.easeTo(s,c):this.flyTo(s,c)):this}jumpTo(r,s){this.stop();const c=this._getTransformForUpdate();let d=!1,m=!1,w=!1;return"zoom"in r&&c.zoom!==+r.zoom&&(d=!0,c.zoom=+r.zoom),r.center!==void 0&&(c.center=h.N.convert(r.center)),"bearing"in r&&c.bearing!==+r.bearing&&(m=!0,c.bearing=+r.bearing),"pitch"in r&&c.pitch!==+r.pitch&&(w=!0,c.pitch=+r.pitch),r.padding==null||c.isPaddingEqual(r.padding)||(c.padding=r.padding),this._applyUpdatedTransform(c),this.fire(new h.k("movestart",s)).fire(new h.k("move",s)),d&&this.fire(new h.k("zoomstart",s)).fire(new h.k("zoom",s)).fire(new h.k("zoomend",s)),m&&this.fire(new h.k("rotatestart",s)).fire(new h.k("rotate",s)).fire(new h.k("rotateend",s)),w&&this.fire(new h.k("pitchstart",s)).fire(new h.k("pitch",s)).fire(new h.k("pitchend",s)),this.fire(new h.k("moveend",s))}calculateCameraOptionsFromTo(r,s,c,d=0){const m=h.Z.fromLngLat(r,s),w=h.Z.fromLngLat(c,d),T=w.x-m.x,C=w.y-m.y,E=w.z-m.z,P=Math.hypot(T,C,E);if(P===0)throw new Error("Can't calculate camera options with same From and To");const M=Math.hypot(T,C),N=this.transform.scaleZoom(this.transform.cameraToCenterDistance/P/this.transform.tileSize),V=180*Math.atan2(T,-C)/Math.PI;let G=180*Math.acos(M/P)/Math.PI;return G=E<0?90-G:90+G,{center:w.toLngLat(),zoom:N,pitch:G,bearing:V}}easeTo(r,s){var c;this._stop(!1,r.easeId),((r=h.e({offset:[0,0],duration:500,easing:h.b9},r)).animate===!1||!r.essential&&U.prefersReducedMotion)&&(r.duration=0);const d=this._getTransformForUpdate(),m=d.zoom,w=d.bearing,T=d.pitch,C=d.padding,E="bearing"in r?this._normalizeBearing(r.bearing,w):w,P="pitch"in r?+r.pitch:T,M="padding"in r?r.padding:d.padding,N=h.P.convert(r.offset);let V=d.centerPoint.add(N);const G=d.pointLocation(V),{center:Y,zoom:ee}=d.getConstrained(h.N.convert(r.center||G),(c=r.zoom)!==null&&c!==void 0?c:m);this._normalizeCenter(Y,d);const re=d.project(G),oe=d.project(Y).sub(re),W=d.zoomScale(ee-m);let ue,pe;r.around&&(ue=h.N.convert(r.around),pe=d.locationPoint(ue));const ye={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||ee!==m,this._rotating=this._rotating||w!==E,this._pitching=this._pitching||P!==T,this._padding=!d.isPaddingEqual(M),this._easeId=r.easeId,this._prepareEase(s,r.noMoveStart,ye),this.terrain&&this._prepareElevation(Y),this._ease(Ce=>{if(this._zooming&&(d.zoom=h.y.number(m,ee,Ce)),this._rotating&&(d.bearing=h.y.number(w,E,Ce)),this._pitching&&(d.pitch=h.y.number(T,P,Ce)),this._padding&&(d.interpolatePadding(C,M,Ce),V=d.centerPoint.add(N)),this.terrain&&!r.freezeElevation&&this._updateElevation(Ce),ue)d.setLocationAtPoint(ue,pe);else{const Me=d.zoomScale(d.zoom-m),$e=ee>m?Math.min(2,W):Math.max(.5,W),Ge=Math.pow($e,1-Ce),Fe=d.unproject(re.add(oe.mult(Ce*Ge)).mult(Me));d.setLocationAtPoint(d.renderWorldCopies?Fe.wrap():Fe,V)}this._applyUpdatedTransform(d),this._fireMoveEvents(s)},Ce=>{this.terrain&&r.freezeElevation&&this._finalizeElevation(),this._afterEase(s,Ce)},r),this}_prepareEase(r,s,c={}){this._moving=!0,s||c.moving||this.fire(new h.k("movestart",r)),this._zooming&&!c.zooming&&this.fire(new h.k("zoomstart",r)),this._rotating&&!c.rotating&&this.fire(new h.k("rotatestart",r)),this._pitching&&!c.pitching&&this.fire(new h.k("pitchstart",r))}_prepareElevation(r){this._elevationCenter=r,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(r,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(r){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const s=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(r<1&&s!==this._elevationTarget){const c=this._elevationTarget-this._elevationStart;this._elevationStart+=r*(c-(s-(c*r+this._elevationStart))/(1-r)),this._elevationTarget=s}this.transform.elevation=h.y.number(this._elevationStart,this._elevationTarget,r)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(r){const s=r.getCameraPosition(),c=this.terrain.getElevationForLngLatZoom(s.lngLat,r.zoom);if(s.altitude<c){const d=this.calculateCameraOptionsFromTo(s.lngLat,c,r.center,r.elevation);return{pitch:d.pitch,zoom:d.zoom}}return{}}_applyUpdatedTransform(r){const s=[];if(this.terrain&&s.push(d=>this._elevateCameraIfInsideTerrain(d)),this.transformCameraUpdate&&s.push(d=>this.transformCameraUpdate(d)),!s.length)return;const c=r.clone();for(const d of s){const m=c.clone(),{center:w,zoom:T,pitch:C,bearing:E,elevation:P}=d(m);w&&(m.center=w),T!==void 0&&(m.zoom=T),C!==void 0&&(m.pitch=C),E!==void 0&&(m.bearing=E),P!==void 0&&(m.elevation=P),c.apply(m)}this.transform.apply(c)}_fireMoveEvents(r){this.fire(new h.k("move",r)),this._zooming&&this.fire(new h.k("zoom",r)),this._rotating&&this.fire(new h.k("rotate",r)),this._pitching&&this.fire(new h.k("pitch",r))}_afterEase(r,s){if(this._easeId&&s&&this._easeId===s)return;delete this._easeId;const c=this._zooming,d=this._rotating,m=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,c&&this.fire(new h.k("zoomend",r)),d&&this.fire(new h.k("rotateend",r)),m&&this.fire(new h.k("pitchend",r)),this.fire(new h.k("moveend",r))}flyTo(r,s){var c;if(!r.essential&&U.prefersReducedMotion){const je=h.M(r,["center","zoom","bearing","pitch","around"]);return this.jumpTo(je,s)}this.stop(),r=h.e({offset:[0,0],speed:1.2,curve:1.42,easing:h.b9},r);const d=this._getTransformForUpdate(),m=d.zoom,w=d.bearing,T=d.pitch,C=d.padding,E="bearing"in r?this._normalizeBearing(r.bearing,w):w,P="pitch"in r?+r.pitch:T,M="padding"in r?r.padding:d.padding,N=h.P.convert(r.offset);let V=d.centerPoint.add(N);const G=d.pointLocation(V),{center:Y,zoom:ee}=d.getConstrained(h.N.convert(r.center||G),(c=r.zoom)!==null&&c!==void 0?c:m);this._normalizeCenter(Y,d);const re=d.zoomScale(ee-m),oe=d.project(G),W=d.project(Y).sub(oe);let ue=r.curve;const pe=Math.max(d.width,d.height),ye=pe/re,Ce=W.mag();if("minZoom"in r){const je=h.ac(Math.min(r.minZoom,m,ee),d.minZoom,d.maxZoom),pt=pe/d.zoomScale(je-m);ue=Math.sqrt(pt/Ce*2)}const Me=ue*ue;function $e(je){const pt=(ye*ye-pe*pe+(je?-1:1)*Me*Me*Ce*Ce)/(2*(je?ye:pe)*Me*Ce);return Math.log(Math.sqrt(pt*pt+1)-pt)}function Ge(je){return(Math.exp(je)-Math.exp(-je))/2}function Fe(je){return(Math.exp(je)+Math.exp(-je))/2}const De=$e(!1);let Je=function(je){return Fe(De)/Fe(De+ue*je)},vt=function(je){return pe*((Fe(De)*(Ge(pt=De+ue*je)/Fe(pt))-Ge(De))/Me)/Ce;var pt},Oe=($e(!0)-De)/ue;if(Math.abs(Ce)<1e-6||!isFinite(Oe)){if(Math.abs(pe-ye)<1e-6)return this.easeTo(r,s);const je=ye<pe?-1:1;Oe=Math.abs(Math.log(ye/pe))/ue,vt=()=>0,Je=pt=>Math.exp(je*ue*pt)}return r.duration="duration"in r?+r.duration:1e3*Oe/("screenSpeed"in r?+r.screenSpeed/ue:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0),this._zooming=!0,this._rotating=w!==E,this._pitching=P!==T,this._padding=!d.isPaddingEqual(M),this._prepareEase(s,!1),this.terrain&&this._prepareElevation(Y),this._ease(je=>{const pt=je*Oe,hr=1/Je(pt);d.zoom=je===1?ee:m+d.scaleZoom(hr),this._rotating&&(d.bearing=h.y.number(w,E,je)),this._pitching&&(d.pitch=h.y.number(T,P,je)),this._padding&&(d.interpolatePadding(C,M,je),V=d.centerPoint.add(N)),this.terrain&&!r.freezeElevation&&this._updateElevation(je);const wt=je===1?Y:d.unproject(oe.add(W.mult(vt(pt))).mult(hr));d.setLocationAtPoint(d.renderWorldCopies?wt.wrap():wt,V),this._applyUpdatedTransform(d),this._fireMoveEvents(s)},()=>{this.terrain&&r.freezeElevation&&this._finalizeElevation(),this._afterEase(s)},r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(r,s){var c;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const d=this._onEaseEnd;delete this._onEaseEnd,d.call(this,s)}return r||(c=this.handlers)===null||c===void 0||c.stop(!1),this}_ease(r,s,c){c.animate===!1||c.duration===0?(r(1),s()):(this._easeStart=U.now(),this._easeOptions=c,this._onEaseFrame=r,this._onEaseEnd=s,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(r,s){r=h.b3(r,-180,180);const c=Math.abs(r-s);return Math.abs(r-360-s)<c&&(r-=360),Math.abs(r+360-s)<c&&(r+=360),r}_normalizeCenter(r,s){if(!s.renderWorldCopies||s.lngRange)return;const c=r.lng-s.center.lng;r.lng+=c>180?-360:c<-180?360:0}queryTerrainElevation(r){return this.terrain?this.terrain.getElevationForLngLatZoom(h.N.convert(r),this.transform.tileZoom)-this.transform.elevation:null}}const cs={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class hs{constructor(r=cs){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=s=>{!s||s.sourceDataType!=="metadata"&&s.sourceDataType!=="visibility"&&s.dataType!=="style"&&s.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=r}getDefaultPosition(){return"bottom-right"}onAdd(r){return this._map=r,this._compact=this.options.compact,this._container=O.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=O.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=O.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){O.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(r,s){const c=this._map._getUIString(`AttributionControl.${s}`);r.title=c,r.setAttribute("aria-label",c)}_updateAttributions(){if(!this._map.style)return;let r=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=r.concat(this.options.customAttribution.map(d=>typeof d!="string"?"":d)):typeof this.options.customAttribution=="string"&&r.push(this.options.customAttribution)),this._map.style.stylesheet){const d=this._map.style.stylesheet;this.styleOwner=d.owner,this.styleId=d.id}const s=this._map.style.sourceCaches;for(const d in s){const m=s[d];if(m.used||m.usedForTerrain){const w=m.getSource();w.attribution&&r.indexOf(w.attribution)<0&&r.push(w.attribution)}}r=r.filter(d=>String(d).trim()),r.sort((d,m)=>d.length-m.length),r=r.filter((d,m)=>{for(let w=m+1;w<r.length;w++)if(r[w].indexOf(d)>=0)return!1;return!0});const c=r.join(" | ");c!==this._attribHTML&&(this._attribHTML=c,r.length?(this._innerContainer.innerHTML=c,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class dh{constructor(r={}){this._updateCompact=()=>{const s=this._container.children;if(s.length){const c=s[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&c.classList.add("maplibregl-compact"):c.classList.remove("maplibregl-compact")}},this.options=r}getDefaultPosition(){return"bottom-left"}onAdd(r){this._map=r,this._compact=this.options&&this.options.compact,this._container=O.create("div","maplibregl-ctrl");const s=O.create("a","maplibregl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://maplibre.org/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){O.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Mt{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const s=++this._id;return this._queue.push({callback:r,id:s,cancelled:!1}),s}remove(r){const s=this._currentlyRunning,c=s?this._queue.concat(s):this._queue;for(const d of c)if(d.id===r)return void(d.cancelled=!0)}run(r=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const s=this._currentlyRunning=this._queue;this._queue=[];for(const c of s)if(!c.cancelled&&(c.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var ph=h.Y([{name:"a_pos3d",type:"Int16",components:3}]);class Mg extends h.E{constructor(r){super(),this.sourceCache=r,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,r.usedForTerrain=!0,r.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(r,s){this.sourceCache.update(r,s),this._renderableTilesKeys=[];const c={};for(const d of r.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:s}))c[d.key]=!0,this._renderableTilesKeys.push(d.key),this._tiles[d.key]||(d.posMatrix=new Float64Array(16),h.aP(d.posMatrix,0,h.X,0,h.X,0,1),this._tiles[d.key]=new zi(d,this.tileSize));for(const d in this._tiles)c[d]||delete this._tiles[d]}freeRtt(r){for(const s in this._tiles){const c=this._tiles[s];(!r||c.tileID.equals(r)||c.tileID.isChildOf(r)||r.isChildOf(c.tileID))&&(c.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(r=>this.getTileByID(r))}getTileByID(r){return this._tiles[r]}getTerrainCoords(r){const s={};for(const c of this._renderableTilesKeys){const d=this._tiles[c].tileID;if(d.canonical.equals(r.canonical)){const m=r.clone();m.posMatrix=new Float64Array(16),h.aP(m.posMatrix,0,h.X,0,h.X,0,1),s[c]=m}else if(d.canonical.isChildOf(r.canonical)){const m=r.clone();m.posMatrix=new Float64Array(16);const w=d.canonical.z-r.canonical.z,T=d.canonical.x-(d.canonical.x>>w<<w),C=d.canonical.y-(d.canonical.y>>w<<w),E=h.X>>w;h.aP(m.posMatrix,0,E,0,E,0,1),h.J(m.posMatrix,m.posMatrix,[-T*E,-C*E,0]),s[c]=m}else if(r.canonical.isChildOf(d.canonical)){const m=r.clone();m.posMatrix=new Float64Array(16);const w=r.canonical.z-d.canonical.z,T=r.canonical.x-(r.canonical.x>>w<<w),C=r.canonical.y-(r.canonical.y>>w<<w),E=h.X>>w;h.aP(m.posMatrix,0,h.X,0,h.X,0,1),h.J(m.posMatrix,m.posMatrix,[T*E,C*E,0]),h.K(m.posMatrix,m.posMatrix,[1/2**w,1/2**w,0]),s[c]=m}}return s}getSourceTile(r,s){const c=this.sourceCache._source;let d=r.overscaledZ-this.deltaZoom;if(d>c.maxzoom&&(d=c.maxzoom),d<c.minzoom)return null;this._sourceTileCache[r.key]||(this._sourceTileCache[r.key]=r.scaledTo(d).key);let m=this.sourceCache.getTileByID(this._sourceTileCache[r.key]);if((!m||!m.dem)&&s)for(;d>=c.minzoom&&(!m||!m.dem);)m=this.sourceCache.getTileByID(r.scaledTo(d--).key);return m}tilesAfterTime(r=Date.now()){return Object.values(this._tiles).filter(s=>s.timeAdded>=r)}}class fh{constructor(r,s,c){this.painter=r,this.sourceCache=new Mg(s),this.options=c,this.exaggeration=typeof c.exaggeration=="number"?c.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(r,s,c,d=h.X){var m;if(!(s>=0&&s<d&&c>=0&&c<d))return 0;const w=this.getTerrainData(r),T=(m=w.tile)===null||m===void 0?void 0:m.dem;if(!T)return 0;const C=function(G,Y,ee){var re=Y[0],oe=Y[1];return G[0]=ee[0]*re+ee[4]*oe+ee[12],G[1]=ee[1]*re+ee[5]*oe+ee[13],G}([],[s/d*h.X,c/d*h.X],w.u_terrain_matrix),E=[C[0]*T.dim,C[1]*T.dim],P=Math.floor(E[0]),M=Math.floor(E[1]),N=E[0]-P,V=E[1]-M;return T.get(P,M)*(1-N)*(1-V)+T.get(P+1,M)*N*(1-V)+T.get(P,M+1)*(1-N)*V+T.get(P+1,M+1)*N*V}getElevationForLngLatZoom(r,s){if(!h.bb(s,r.wrap()))return 0;const{tileID:c,mercatorX:d,mercatorY:m}=this._getOverscaledTileIDFromLngLatZoom(r,s);return this.getElevation(c,d%h.X,m%h.X,h.X)}getElevation(r,s,c,d=h.X){return this.getDEMElevation(r,s,c,d)*this.exaggeration}getTerrainData(r){if(!this._emptyDemTexture){const d=this.painter.context,m=new h.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new ot(d,m,d.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new ot(d,new h.R({width:1,height:1}),d.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(d.gl.NEAREST,d.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=h.an([])}const s=this.sourceCache.getSourceTile(r,!0);if(s&&s.dem&&(!s.demTexture||s.needsTerrainPrepare)){const d=this.painter.context;s.demTexture=this.painter.getTileTexture(s.dem.stride),s.demTexture?s.demTexture.update(s.dem.getPixels(),{premultiply:!1}):s.demTexture=new ot(d,s.dem.getPixels(),d.gl.RGBA,{premultiply:!1}),s.demTexture.bind(d.gl.NEAREST,d.gl.CLAMP_TO_EDGE),s.needsTerrainPrepare=!1}const c=s&&s+s.tileID.key+r.key;if(c&&!this._demMatrixCache[c]){const d=this.sourceCache.sourceCache._source.maxzoom;let m=r.canonical.z-s.tileID.canonical.z;r.overscaledZ>r.canonical.z&&(r.canonical.z>=d?m=r.canonical.z-d:h.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const w=r.canonical.x-(r.canonical.x>>m<<m),T=r.canonical.y-(r.canonical.y>>m<<m),C=h.bc(new Float64Array(16),[1/(h.X<<m),1/(h.X<<m),0]);h.J(C,C,[w*h.X,T*h.X,0]),this._demMatrixCache[r.key]={matrix:C,coord:r}}return{u_depth:2,u_terrain:3,u_terrain_dim:s&&s.dem&&s.dem.dim||1,u_terrain_matrix:c?this._demMatrixCache[r.key].matrix:this._emptyDemMatrix,u_terrain_unpack:s&&s.dem&&s.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(s&&s.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:s}}getFramebuffer(r){const s=this.painter,c=s.width/devicePixelRatio,d=s.height/devicePixelRatio;return!this._fbo||this._fbo.width===c&&this._fbo.height===d||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new ot(s.context,{width:c,height:d,data:null},s.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(s.context.gl.NEAREST,s.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new ot(s.context,{width:c,height:d,data:null},s.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(s.context.gl.NEAREST,s.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=s.context.createFramebuffer(c,d,!0,!1),this._fbo.depthAttachment.set(s.context.createRenderbuffer(s.context.gl.DEPTH_COMPONENT16,c,d))),this._fbo.colorAttachment.set(r==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const r=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const s=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let m=0,w=0;m<this._coordsTextureSize;m++)for(let T=0;T<this._coordsTextureSize;T++,w+=4)s[w+0]=255&T,s[w+1]=255&m,s[w+2]=T>>8<<4|m>>8,s[w+3]=0;const c=new h.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(s.buffer)),d=new ot(r,c,r.gl.RGBA,{premultiply:!1});return d.bind(r.gl.NEAREST,r.gl.CLAMP_TO_EDGE),this._coordsTexture=d,d}pointCoordinate(r){this.painter.maybeDrawDepthAndCoords(!0);const s=new Uint8Array(4),c=this.painter.context,d=c.gl,m=Math.round(r.x*this.painter.pixelRatio/devicePixelRatio),w=Math.round(r.y*this.painter.pixelRatio/devicePixelRatio),T=Math.round(this.painter.height/devicePixelRatio);c.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),d.readPixels(m,T-w-1,1,1,d.RGBA,d.UNSIGNED_BYTE,s),c.bindFramebuffer.set(null);const C=s[0]+(s[2]>>4<<8),E=s[1]+((15&s[2])<<8),P=this.coordsIndex[255-s[3]],M=P&&this.sourceCache.getTileByID(P);if(!M)return null;const N=this._coordsTextureSize,V=(1<<M.tileID.canonical.z)*N;return new h.Z((M.tileID.canonical.x*N+C)/V+M.tileID.wrap,(M.tileID.canonical.y*N+E)/V,this.getElevation(M.tileID,C,E,N))}depthAtPoint(r){const s=new Uint8Array(4),c=this.painter.context,d=c.gl;return c.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),d.readPixels(r.x,this.painter.height/devicePixelRatio-r.y-1,1,1,d.RGBA,d.UNSIGNED_BYTE,s),c.bindFramebuffer.set(null),(s[0]/16777216+s[1]/65536+s[2]/256+s[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const r=this.painter.context,s=new h.bd,c=new h.aY,d=this.meshSize,m=h.X/d,w=d*d;for(let M=0;M<=d;M++)for(let N=0;N<=d;N++)s.emplaceBack(N*m,M*m,0);for(let M=0;M<w;M+=d+1)for(let N=0;N<d;N++)c.emplaceBack(N+M,d+N+M+1,d+N+M+2),c.emplaceBack(N+M,d+N+M+2,N+M+1);const T=s.length,C=T+2*(d+1);for(const M of[0,1])for(let N=0;N<=d;N++)for(const V of[0,1])s.emplaceBack(N*m,M*h.X,V);for(let M=0;M<2*d;M+=2)c.emplaceBack(C+M,C+M+1,C+M+3),c.emplaceBack(C+M,C+M+3,C+M+2),c.emplaceBack(T+M,T+M+3,T+M+1),c.emplaceBack(T+M,T+M+2,T+M+3);const E=s.length,P=E+2*(d+1);for(const M of[0,1])for(let N=0;N<=d;N++)for(const V of[0,1])s.emplaceBack(M*h.X,N*m,V);for(let M=0;M<2*d;M+=2)c.emplaceBack(E+M,E+M+1,E+M+3),c.emplaceBack(E+M,E+M+3,E+M+2),c.emplaceBack(P+M,P+M+3,P+M+1),c.emplaceBack(P+M,P+M+2,P+M+3);return this._mesh=new ou(r.createVertexBuffer(s,ph.members),r.createIndexBuffer(c),h.a0.simpleSegment(0,0,s.length,c.length)),this._mesh}getMeshFrameDelta(r){return 2*Math.PI*h.be/Math.pow(2,r)/5}getMinTileElevationForLngLatZoom(r,s){var c;const{tileID:d}=this._getOverscaledTileIDFromLngLatZoom(r,s);return(c=this.getMinMaxElevation(d).minElevation)!==null&&c!==void 0?c:0}getMinMaxElevation(r){const s=this.getTerrainData(r).tile,c={minElevation:null,maxElevation:null};return s&&s.dem&&(c.minElevation=s.dem.min*this.exaggeration,c.maxElevation=s.dem.max*this.exaggeration),c}_getOverscaledTileIDFromLngLatZoom(r,s){const c=h.Z.fromLngLat(r.wrap()),d=(1<<s)*h.X,m=c.x*d,w=c.y*d,T=Math.floor(m/h.X),C=Math.floor(w/h.X);return{tileID:new h.S(s,0,s,T,C),mercatorX:m,mercatorY:w}}}class zg{constructor(r,s,c){this._context=r,this._size=s,this._tileSize=c,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const r of this._objects)r.texture.destroy(),r.fbo.destroy()}_createObject(r){const s=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),c=new ot(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return c.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),s.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),s.colorAttachment.set(c.texture),{id:r,fbo:s,texture:c,stamp:-1,inUse:!1}}getObjectForId(r){return this._objects[r]}useObject(r){r.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(s=>r.id!==s),this._recentlyUsed.push(r.id)}stampObject(r){r.stamp=++this._stamp}getOrCreateFreeObject(){for(const s of this._recentlyUsed)if(!this._objects[s].inUse)return this._objects[s];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const r=this._createObject(this._objects.length);return this._objects.push(r),r}freeObject(r){r.inUse=!1}freeAllObjects(){for(const r of this._objects)this.freeObject(r)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(r=>!r.inUse)===!1}}const ds={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class vp{constructor(r,s){this.painter=r,this.terrain=s,this.pool=new zg(r.context,30,s.sourceCache.tileSize*s.qualityFactor)}destruct(){this.pool.destruct()}getTexture(r){return this.pool.getObjectForId(r.rtt[this._stacks.length-1].id).texture}prepareForRender(r,s){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=r._order.filter(c=>!r._layers[c].isHidden(s)),this._coordsDescendingInv={};for(const c in r.sourceCaches){this._coordsDescendingInv[c]={};const d=r.sourceCaches[c].getVisibleCoordinates();for(const m of d){const w=this.terrain.sourceCache.getTerrainCoords(m);for(const T in w)this._coordsDescendingInv[c][T]||(this._coordsDescendingInv[c][T]=[]),this._coordsDescendingInv[c][T].push(w[T])}}this._coordsDescendingInvStr={};for(const c of r._order){const d=r._layers[c],m=d.source;if(ds[d.type]&&!this._coordsDescendingInvStr[m]){this._coordsDescendingInvStr[m]={};for(const w in this._coordsDescendingInv[m])this._coordsDescendingInvStr[m][w]=this._coordsDescendingInv[m][w].map(T=>T.key).sort().join()}}for(const c of this._renderableTiles)for(const d in this._coordsDescendingInvStr){const m=this._coordsDescendingInvStr[d][c.tileID.key];m&&m!==c.rttCoords[d]&&(c.rtt=[])}}renderLayer(r){if(r.isHidden(this.painter.transform.zoom))return!1;const s=r.type,c=this.painter,d=this._renderableLayerIds[this._renderableLayerIds.length-1]===r.id;if(ds[s]&&(this._prevType&&ds[this._prevType]||this._stacks.push([]),this._prevType=s,this._stacks[this._stacks.length-1].push(r.id),!d))return!0;if(ds[this._prevType]||ds[s]&&d){this._prevType=s;const m=this._stacks.length-1,w=this._stacks[m]||[];for(const T of this._renderableTiles){if(this.pool.isFull()&&(hp(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(T),T.rtt[m]){const E=this.pool.getObjectForId(T.rtt[m].id);if(E.stamp===T.rtt[m].stamp){this.pool.useObject(E);continue}}const C=this.pool.getOrCreateFreeObject();this.pool.useObject(C),this.pool.stampObject(C),T.rtt[m]={id:C.id,stamp:C.stamp},c.context.bindFramebuffer.set(C.fbo.framebuffer),c.context.clear({color:h.aM.transparent,stencil:0}),c.currentStencilSource=void 0;for(let E=0;E<w.length;E++){const P=c.style._layers[w[E]],M=P.source?this._coordsDescendingInv[P.source][T.tileID.key]:[T.tileID];c.context.viewport.set([0,0,C.fbo.width,C.fbo.height]),c._renderTileClippingMasks(P,M),c.renderLayer(c,c.style.sourceCaches[P.source],P,M),P.source&&(T.rttCoords[P.source]=this._coordsDescendingInvStr[P.source][T.tileID.key])}}return hp(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),ds[s]}return!1}}const mh={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},xp=z,Lg={hash:!1,interactive:!0,bearingSnap:7,attributionControl:cs,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:h.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},gh=g=>{g.touchstart=g.dragStart,g.touchmoveWindow=g.dragMove,g.touchend=g.dragEnd},Rg={showCompass:!0,showZoom:!0,visualizePitch:!1};class Dg{constructor(r,s,c=!1){this.mousedown=w=>{this.startMouse(h.e({},w,{ctrlKey:!0,preventDefault:()=>w.preventDefault()}),O.mousePos(this.element,w)),O.addEventListener(window,"mousemove",this.mousemove),O.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=w=>{this.moveMouse(w,O.mousePos(this.element,w))},this.mouseup=w=>{this.mouseRotate.dragEnd(w),this.mousePitch&&this.mousePitch.dragEnd(w),this.offTemp()},this.touchstart=w=>{w.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=O.touchPos(this.element,w.targetTouches)[0],this.startTouch(w,this._startPos),O.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),O.addEventListener(window,"touchend",this.touchend))},this.touchmove=w=>{w.targetTouches.length!==1?this.reset():(this._lastPos=O.touchPos(this.element,w.targetTouches)[0],this.moveTouch(w,this._lastPos))},this.touchend=w=>{w.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const d=r.dragRotate._mouseRotate.getClickTolerance(),m=r.dragRotate._mousePitch.getClickTolerance();this.element=s,this.mouseRotate=nh({clickTolerance:d,enable:!0}),this.touchRotate=(({enable:w,clickTolerance:T,bearingDegreesPerPixelMoved:C=.8})=>{const E=new rh;return new Ro({clickTolerance:T,move:(P,M)=>({bearingDelta:(M.x-P.x)*C}),moveStateManager:E,enable:w,assignEvents:gh})})({clickTolerance:d,enable:!0}),this.map=r,c&&(this.mousePitch=ih({clickTolerance:m,enable:!0}),this.touchPitch=(({enable:w,clickTolerance:T,pitchDegreesPerPixelMoved:C=-.5})=>{const E=new rh;return new Ro({clickTolerance:T,move:(P,M)=>({pitchDelta:(M.y-P.y)*C}),moveStateManager:E,enable:w,assignEvents:gh})})({clickTolerance:m,enable:!0})),O.addEventListener(s,"mousedown",this.mousedown),O.addEventListener(s,"touchstart",this.touchstart,{passive:!1}),O.addEventListener(s,"touchcancel",this.reset)}startMouse(r,s){this.mouseRotate.dragStart(r,s),this.mousePitch&&this.mousePitch.dragStart(r,s),O.disableDrag()}startTouch(r,s){this.touchRotate.dragStart(r,s),this.touchPitch&&this.touchPitch.dragStart(r,s),O.disableDrag()}moveMouse(r,s){const c=this.map,{bearingDelta:d}=this.mouseRotate.dragMove(r,s)||{};if(d&&c.setBearing(c.getBearing()+d),this.mousePitch){const{pitchDelta:m}=this.mousePitch.dragMove(r,s)||{};m&&c.setPitch(c.getPitch()+m)}}moveTouch(r,s){const c=this.map,{bearingDelta:d}=this.touchRotate.dragMove(r,s)||{};if(d&&c.setBearing(c.getBearing()+d),this.touchPitch){const{pitchDelta:m}=this.touchPitch.dragMove(r,s)||{};m&&c.setPitch(c.getPitch()+m)}}off(){const r=this.element;O.removeEventListener(r,"mousedown",this.mousedown),O.removeEventListener(r,"touchstart",this.touchstart,{passive:!1}),O.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),O.removeEventListener(window,"touchend",this.touchend),O.removeEventListener(r,"touchcancel",this.reset),this.offTemp()}offTemp(){O.enableDrag(),O.removeEventListener(window,"mousemove",this.mousemove),O.removeEventListener(window,"mouseup",this.mouseup),O.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),O.removeEventListener(window,"touchend",this.touchend)}}let ii;function cr(g,r,s){const c=new h.N(g.lng,g.lat);if(g=new h.N(g.lng,g.lat),r){const d=new h.N(g.lng-360,g.lat),m=new h.N(g.lng+360,g.lat),w=s.locationPoint(g).distSqr(r);s.locationPoint(d).distSqr(r)<w?g=d:s.locationPoint(m).distSqr(r)<w&&(g=m)}for(;Math.abs(g.lng-s.center.lng)>180;){const d=s.locationPoint(g);if(d.x>=0&&d.y>=0&&d.x<=s.width&&d.y<=s.height)break;g.lng>s.center.lng?g.lng-=360:g.lng+=360}return g.lng!==c.lng&&s.locationPoint(g).y>s.height/2-s.getHorizon()?g:c}const ps={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function gu(g,r,s){const c=g.classList;for(const d in ps)c.remove(`maplibregl-${s}-anchor-${d}`);c.add(`maplibregl-${s}-anchor-${r}`)}class yu extends h.E{constructor(r){if(super(),this._onKeyPress=s=>{const c=s.code,d=s.charCode||s.keyCode;c!=="Space"&&c!=="Enter"&&d!==32&&d!==13||this.togglePopup()},this._onMapClick=s=>{const c=s.originalEvent.target,d=this._element;this._popup&&(c===d||d.contains(c))&&this.togglePopup()},this._update=s=>{var c;if(!this._map)return;const d=this._map.loaded()&&!this._map.isMoving();((s==null?void 0:s.type)==="terrain"||(s==null?void 0:s.type)==="render"&&!d)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?cr(this._lngLat,this._flatPos,this._map.transform):(c=this._lngLat)===null||c===void 0?void 0:c.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let m="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?m=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(m=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let w="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?w="rotateX(0deg)":this._pitchAlignment==="map"&&(w=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||s&&s.type!=="moveend"||(this._pos=this._pos.round()),O.setTransform(this._element,`${ps[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${w} ${m}`),U.frameAsync(new AbortController).then(()=>{this._updateOpacity(s&&s.type==="moveend")}).catch(()=>{})},this._onMove=s=>{if(!this._isDragging){const c=this._clickTolerance||this._map._clickTolerance;this._isDragging=s.point.dist(this._pointerdownPos)>=c}this._isDragging&&(this._pos=s.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new h.k("dragstart"))),this.fire(new h.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new h.k("dragend")),this._state="inactive"},this._addDragHandler=s=>{this._element.contains(s.originalEvent.target)&&(s.preventDefault(),this._positionDelta=s.point.sub(this._pos).add(this._offset),this._pointerdownPos=s.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._subpixelPositioning=r&&r.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&r.pitchAlignment!=="auto"?r.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(r==null?void 0:r.opacity,r==null?void 0:r.opacityWhenCovered),r&&r.element)this._element=r.element,this._offset=h.P.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=O.create("div");const s=O.createNS("http://www.w3.org/2000/svg","svg"),c=41,d=27;s.setAttributeNS(null,"display","block"),s.setAttributeNS(null,"height",`${c}px`),s.setAttributeNS(null,"width",`${d}px`),s.setAttributeNS(null,"viewBox",`0 0 ${d} ${c}`);const m=O.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"stroke","none"),m.setAttributeNS(null,"stroke-width","1"),m.setAttributeNS(null,"fill","none"),m.setAttributeNS(null,"fill-rule","evenodd");const w=O.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"fill-rule","nonzero");const T=O.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"transform","translate(3.0, 29.0)"),T.setAttributeNS(null,"fill","#000000");const C=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const re of C){const oe=O.createNS("http://www.w3.org/2000/svg","ellipse");oe.setAttributeNS(null,"opacity","0.04"),oe.setAttributeNS(null,"cx","10.5"),oe.setAttributeNS(null,"cy","5.80029008"),oe.setAttributeNS(null,"rx",re.rx),oe.setAttributeNS(null,"ry",re.ry),T.appendChild(oe)}const E=O.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"fill",this._color);const P=O.createNS("http://www.w3.org/2000/svg","path");P.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),E.appendChild(P);const M=O.createNS("http://www.w3.org/2000/svg","g");M.setAttributeNS(null,"opacity","0.25"),M.setAttributeNS(null,"fill","#000000");const N=O.createNS("http://www.w3.org/2000/svg","path");N.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),M.appendChild(N);const V=O.createNS("http://www.w3.org/2000/svg","g");V.setAttributeNS(null,"transform","translate(6.0, 7.0)"),V.setAttributeNS(null,"fill","#FFFFFF");const G=O.createNS("http://www.w3.org/2000/svg","g");G.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Y=O.createNS("http://www.w3.org/2000/svg","circle");Y.setAttributeNS(null,"fill","#000000"),Y.setAttributeNS(null,"opacity","0.25"),Y.setAttributeNS(null,"cx","5.5"),Y.setAttributeNS(null,"cy","5.5"),Y.setAttributeNS(null,"r","5.4999962");const ee=O.createNS("http://www.w3.org/2000/svg","circle");ee.setAttributeNS(null,"fill","#FFFFFF"),ee.setAttributeNS(null,"cx","5.5"),ee.setAttributeNS(null,"cy","5.5"),ee.setAttributeNS(null,"r","5.4999962"),G.appendChild(Y),G.appendChild(ee),w.appendChild(T),w.appendChild(E),w.appendChild(M),w.appendChild(V),w.appendChild(G),s.appendChild(w),s.setAttributeNS(null,"height",c*this._scale+"px"),s.setAttributeNS(null,"width",d*this._scale+"px"),this._element.appendChild(s),this._offset=h.P.convert(r&&r.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",s=>{s.preventDefault()}),this._element.addEventListener("mousedown",s=>{s.preventDefault()}),gu(this._element,this._anchor,"marker"),r&&r.className)for(const s of r.className.split(" "))this._element.classList.add(s);this._popup=null}addTo(r){return this.remove(),this._map=r,this._element.setAttribute("aria-label",r._getUIString("Marker.Title")),r.getCanvasContainer().appendChild(this._element),r.on("move",this._update),r.on("moveend",this._update),r.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),O.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=h.N.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const d=Math.abs(13.5)/Math.SQRT2;r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[d,-1*(38.1-13.5+d)],"bottom-right":[-d,-1*(38.1-13.5+d)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=r,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(r){return this._subpixelPositioning=r,this}getPopup(){return this._popup}togglePopup(){const r=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:r?(r.isOpen()?r.remove():(r.setLngLat(this._lngLat),r.addTo(this._map)),this):this}_updateOpacity(r=!1){var s,c;if(!(!((s=this._map)===null||s===void 0)&&s.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(r)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const d=this._map,m=d.terrain.depthAtPoint(this._pos),w=d.terrain.getElevationForLngLatZoom(this._lngLat,d.transform.tileZoom);if(d.transform.lngLatToCameraDepth(this._lngLat,w)-m<.006)return void(this._element.style.opacity=this._opacity);const T=-this._offset.y/d.transform._pixelPerMeter,C=Math.sin(d.getPitch()*Math.PI/180)*T,E=d.terrain.depthAtPoint(new h.P(this._pos.x,this._pos.y-this._offset.y)),P=d.transform.lngLatToCameraDepth(this._lngLat,w+C)-E>.006;!((c=this._popup)===null||c===void 0)&&c.isOpen()&&P&&this._popup.remove(),this._element.style.opacity=P?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(r){return this._offset=h.P.convert(r),this._update(),this}addClassName(r){this._element.classList.add(r)}removeClassName(r){this._element.classList.remove(r)}toggleClassName(r){return this._element.classList.toggle(r)}setDraggable(r){return this._draggable=!!r,this._map&&(r?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r&&r!=="auto"?r:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(r,s){return r===void 0&&s===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),r!==void 0&&(this._opacity=r),s!==void 0&&(this._opacityWhenCovered=s),this._map&&this._updateOpacity(!0),this}}const bp={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let cl=0,hl=!1;const co={maxWidth:100,unit:"metric"};function dl(g,r,s){const c=s&&s.maxWidth||100,d=g._container.clientHeight/2,m=g.unproject([0,d]),w=g.unproject([c,d]),T=m.distanceTo(w);if(s&&s.unit==="imperial"){const C=3.2808*T;C>5280?Ye(r,c,C/5280,g._getUIString("ScaleControl.Miles")):Ye(r,c,C,g._getUIString("ScaleControl.Feet"))}else s&&s.unit==="nautical"?Ye(r,c,T/1852,g._getUIString("ScaleControl.NauticalMiles")):T>=1e3?Ye(r,c,T/1e3,g._getUIString("ScaleControl.Kilometers")):Ye(r,c,T,g._getUIString("ScaleControl.Meters"))}function Ye(g,r,s,c){const d=function(m){const w=Math.pow(10,`${Math.floor(m)}`.length-1);let T=m/w;return T=T>=10?10:T>=5?5:T>=3?3:T>=2?2:T>=1?1:function(C){const E=Math.pow(10,Math.ceil(-Math.log(C)/Math.LN10));return Math.round(C*E)/E}(T),w*T}(s);g.style.width=r*(d/s)+"px",g.innerHTML=`${d}&nbsp;${c}`}const ut={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},_u=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function vu(g){if(g){if(typeof g=="number"){const r=Math.round(Math.abs(g)/Math.SQRT2);return{center:new h.P(0,0),top:new h.P(0,g),"top-left":new h.P(r,r),"top-right":new h.P(-r,r),bottom:new h.P(0,-g),"bottom-left":new h.P(r,-r),"bottom-right":new h.P(-r,-r),left:new h.P(g,0),right:new h.P(-g,0)}}if(g instanceof h.P||Array.isArray(g)){const r=h.P.convert(g);return{center:r,top:r,"top-left":r,"top-right":r,bottom:r,"bottom-left":r,"bottom-right":r,left:r,right:r}}return{center:h.P.convert(g.center||[0,0]),top:h.P.convert(g.top||[0,0]),"top-left":h.P.convert(g["top-left"]||[0,0]),"top-right":h.P.convert(g["top-right"]||[0,0]),bottom:h.P.convert(g.bottom||[0,0]),"bottom-left":h.P.convert(g["bottom-left"]||[0,0]),"bottom-right":h.P.convert(g["bottom-right"]||[0,0]),left:h.P.convert(g.left||[0,0]),right:h.P.convert(g.right||[0,0])}}return vu(new h.P(0,0))}const yh=z;x.AJAXError=h.bh,x.Evented=h.E,x.LngLat=h.N,x.MercatorCoordinate=h.Z,x.Point=h.P,x.addProtocol=h.bi,x.config=h.a,x.removeProtocol=h.bj,x.AttributionControl=hs,x.BoxZoomHandler=ni,x.CanvasSource=Xr,x.CooperativeGesturesHandler=us,x.DoubleClickZoomHandler=Ia,x.DragPanHandler=gp,x.DragRotateHandler=yp,x.EdgeInsets=os,x.FullscreenControl=class extends h.E{constructor(g={}){super(),this._onFullscreenChange=()=>{var r;let s=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((r=s==null?void 0:s.shadowRoot)===null||r===void 0)&&r.fullscreenElement;)s=s.shadowRoot.fullscreenElement;s===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,g&&g.container&&(g.container instanceof HTMLElement?this._container=g.container:h.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(g){return this._map=g,this._container||(this._container=this._map.getContainer()),this._controlContainer=O.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){O.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const g=this._fullscreenButton=O.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);O.create("span","maplibregl-ctrl-icon",g).setAttribute("aria-hidden","true"),g.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const g=this._getTitle();this._fullscreenButton.setAttribute("aria-label",g),this._fullscreenButton.title=g}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new h.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new h.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},x.GeoJSONSource=Mo,x.GeolocateControl=class extends h.E{constructor(g){super(),this._onSuccess=r=>{if(this._map){if(this._isOutOfMapMaxBounds(r))return this._setErrorState(),this.fire(new h.k("outofmaxbounds",r)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=r,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(r),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(r),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new h.k("geolocate",r)),this._finish()}},this._updateCamera=r=>{const s=new h.N(r.coords.longitude,r.coords.latitude),c=r.coords.accuracy,d=this._map.getBearing(),m=h.e({bearing:d},this.options.fitBoundsOptions),w=xe.fromLngLat(s,c);this._map.fitBounds(w,m,{geolocateSource:!0})},this._updateMarker=r=>{if(r){const s=new h.N(r.coords.longitude,r.coords.latitude);this._accuracyCircleMarker.setLngLat(s).addTo(this._map),this._userLocationDotMarker.setLngLat(s).addTo(this._map),this._accuracy=r.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=r=>{if(this._map){if(this.options.trackUserLocation)if(r.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(r.code===3&&hl)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new h.k("error",r)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",r=>r.preventDefault()),this._geolocateButton=O.create("button","maplibregl-ctrl-geolocate",this._container),O.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=r=>{if(this._map){if(r===!1){h.w("Geolocation support is not available so the GeolocateControl will be disabled.");const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s)}else{const s=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=O.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new yu({element:this._dotElement}),this._circleElement=O.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new yu({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",s=>{s.geolocateSource||this._watchState!=="ACTIVE_LOCK"||s.originalEvent&&s.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new h.k("trackuserlocationend")),this.fire(new h.k("userlocationlostfocus")))})}},this.options=h.e({},bp,g)}onAdd(g){return this._map=g,this._container=O.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return h._(this,arguments,void 0,function*(r=!1){if(ii!==void 0&&!r)return ii;if(window.navigator.permissions===void 0)return ii=!!window.navigator.geolocation,ii;try{ii=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{ii=!!window.navigator.geolocation}return ii})}().then(r=>this._finishSetupUI(r)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),O.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,cl=0,hl=!1}_isOutOfMapMaxBounds(g){const r=this._map.getMaxBounds(),s=g.coords;return r&&(s.longitude<r.getWest()||s.longitude>r.getEast()||s.latitude<r.getSouth()||s.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const g=this._map.getBounds(),r=g.getSouthEast(),s=g.getNorthEast(),c=r.distanceTo(s),d=Math.ceil(this._accuracy/(c/this._map._container.clientHeight)*2);this._circleElement.style.width=`${d}px`,this._circleElement.style.height=`${d}px`}trigger(){if(!this._setup)return h.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new h.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":cl--,hl=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new h.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new h.k("trackuserlocationstart")),this.fire(new h.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let g;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),cl++,cl>1?(g={maximumAge:6e5,timeout:0},hl=!0):(g=this.options.positionOptions,hl=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,g)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},x.Hash=su,x.ImageSource=Pi,x.KeyboardHandler=gi,x.LngLatBounds=xe,x.LogoControl=dh,x.Map=class extends _p{constructor(g){h.bf.mark(h.bg.create);const r=Object.assign(Object.assign({},Lg),g);if(r.minZoom!=null&&r.maxZoom!=null&&r.minZoom>r.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(r.minPitch!=null&&r.maxPitch!=null&&r.minPitch>r.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(r.minPitch!=null&&r.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(r.maxPitch!=null&&r.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new as(r.minZoom,r.maxZoom,r.minPitch,r.maxPitch,r.renderWorldCopies),{bearingSnap:r.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Mt,this._controls=[],this._mapId=h.a4(),this._contextLost=s=>{s.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new h.k("webglcontextlost",{originalEvent:s}))},this._contextRestored=s=>{this._setupPainter(),this.resize(),this._update(),this.fire(new h.k("webglcontextrestored",{originalEvent:s}))},this._onMapScroll=s=>{if(s.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=r.interactive,this._maxTileCacheSize=r.maxTileCacheSize,this._maxTileCacheZoomLevels=r.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=r.failIfMajorPerformanceCaveat===!0,this._preserveDrawingBuffer=r.preserveDrawingBuffer===!0,this._antialias=r.antialias===!0,this._trackResize=r.trackResize===!0,this._bearingSnap=r.bearingSnap,this._refreshExpiredTiles=r.refreshExpiredTiles===!0,this._fadeDuration=r.fadeDuration,this._crossSourceCollisions=r.crossSourceCollisions===!0,this._collectResourceTiming=r.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},mh),r.locale),this._clickTolerance=r.clickTolerance,this._overridePixelRatio=r.pixelRatio,this._maxCanvasSize=r.maxCanvasSize,this.transformCameraUpdate=r.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=r.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=ie.addThrottleControl(()=>this.isMoving()),this._requestManager=new _e(r.transformRequest),typeof r.container=="string"){if(this._container=document.getElementById(r.container),!this._container)throw new Error(`Container '${r.container}' not found.`)}else{if(!(r.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=r.container}if(r.maxBounds&&this.setMaxBounds(r.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)).on("moveend",()=>this._update(!1)).on("zoom",()=>this._update(!0)).on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}).once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let s=!1;const c=ol(d=>{this._trackResize&&!this._removed&&(this.resize(d),this.redraw())},50);this._resizeObserver=new ResizeObserver(d=>{s?c(d):s=!0}),this._resizeObserver.observe(this._container)}this.handlers=new hh(this,r),this._hash=r.hash&&new su(typeof r.hash=="string"&&r.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:r.center,zoom:r.zoom,bearing:r.bearing,pitch:r.pitch}),r.bounds&&(this.resize(),this.fitBounds(r.bounds,h.e({},r.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=r.localIdeographFontFamily,this._validateStyle=r.validateStyle,r.style&&this.setStyle(r.style,{localIdeographFontFamily:r.localIdeographFontFamily}),r.attributionControl&&this.addControl(new hs(typeof r.attributionControl=="boolean"?void 0:r.attributionControl)),r.maplibreLogo&&this.addControl(new dh,r.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",s=>{this._update(s.dataType==="style"),this.fire(new h.k(`${s.dataType}data`,s))}),this.on("dataloading",s=>{this.fire(new h.k(`${s.dataType}dataloading`,s))}),this.on("dataabort",s=>{this.fire(new h.k("sourcedataabort",s))})}_getMapId(){return this._mapId}addControl(g,r){if(r===void 0&&(r=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new h.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const s=g.onAdd(this);this._controls.push(g);const c=this._controlPositions[r];return r.indexOf("bottom")!==-1?c.insertBefore(s,c.firstChild):c.appendChild(s),this}removeControl(g){if(!g||!g.onRemove)return this.fire(new h.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(g);return r>-1&&this._controls.splice(r,1),g.onRemove(this),this}hasControl(g){return this._controls.indexOf(g)>-1}calculateCameraOptionsFromTo(g,r,s,c){return c==null&&this.terrain&&(c=this.terrain.getElevationForLngLatZoom(s,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(g,r,s,c)}resize(g){var r;const s=this._containerDimensions(),c=s[0],d=s[1],m=this._getClampedPixelRatio(c,d);if(this._resizeCanvas(c,d,m),this.painter.resize(c,d,m),this.painter.overLimit()){const T=this.painter.context.gl;this._maxCanvasSize=[T.drawingBufferWidth,T.drawingBufferHeight];const C=this._getClampedPixelRatio(c,d);this._resizeCanvas(c,d,C),this.painter.resize(c,d,C)}this.transform.resize(c,d),(r=this._requestedCameraState)===null||r===void 0||r.resize(c,d);const w=!this._moving;return w&&(this.stop(),this.fire(new h.k("movestart",g)).fire(new h.k("move",g))),this.fire(new h.k("resize",g)),w&&this.fire(new h.k("moveend",g)),this}_getClampedPixelRatio(g,r){const{0:s,1:c}=this._maxCanvasSize,d=this.getPixelRatio(),m=g*d,w=r*d;return Math.min(m>s?s/m:1,w>c?c/w:1)*d}getPixelRatio(){var g;return(g=this._overridePixelRatio)!==null&&g!==void 0?g:devicePixelRatio}setPixelRatio(g){this._overridePixelRatio=g,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(g){return this.transform.setMaxBounds(xe.convert(g)),this._update()}setMinZoom(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.minZoom=g,this._update(),this.getZoom()<g&&this.setZoom(g),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(g){if((g=g??22)>=this.transform.minZoom)return this.transform.maxZoom=g,this._update(),this.getZoom()>g&&this.setZoom(g),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.minPitch=g,this._update(),this.getPitch()<g&&this.setPitch(g),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(g){if((g=g??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(g>=this.transform.minPitch)return this.transform.maxPitch=g,this._update(),this.getPitch()>g&&this.setPitch(g),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(g){return this.transform.renderWorldCopies=g,this._update()}project(g){return this.transform.locationPoint(h.N.convert(g),this.style&&this.terrain)}unproject(g){return this.transform.pointLocation(h.P.convert(g),this.terrain)}isMoving(){var g;return this._moving||((g=this.handlers)===null||g===void 0?void 0:g.isMoving())}isZooming(){var g;return this._zooming||((g=this.handlers)===null||g===void 0?void 0:g.isZooming())}isRotating(){var g;return this._rotating||((g=this.handlers)===null||g===void 0?void 0:g.isRotating())}_createDelegatedListener(g,r,s){if(g==="mouseenter"||g==="mouseover"){let c=!1;return{layers:r,listener:s,delegates:{mousemove:m=>{const w=r.filter(C=>this.getLayer(C)),T=w.length!==0?this.queryRenderedFeatures(m.point,{layers:w}):[];T.length?c||(c=!0,s.call(this,new dn(g,this,m.originalEvent,{features:T}))):c=!1},mouseout:()=>{c=!1}}}}if(g==="mouseleave"||g==="mouseout"){let c=!1;return{layers:r,listener:s,delegates:{mousemove:w=>{const T=r.filter(C=>this.getLayer(C));(T.length!==0?this.queryRenderedFeatures(w.point,{layers:T}):[]).length?c=!0:c&&(c=!1,s.call(this,new dn(g,this,w.originalEvent)))},mouseout:w=>{c&&(c=!1,s.call(this,new dn(g,this,w.originalEvent)))}}}}{const c=d=>{const m=r.filter(T=>this.getLayer(T)),w=m.length!==0?this.queryRenderedFeatures(d.point,{layers:m}):[];w.length&&(d.features=w,s.call(this,d),delete d.features)};return{layers:r,listener:s,delegates:{[g]:c}}}}_saveDelegatedListener(g,r){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(r)}_removeDelegatedListener(g,r,s){if(!this._delegatedListeners||!this._delegatedListeners[g])return;const c=this._delegatedListeners[g];for(let d=0;d<c.length;d++){const m=c[d];if(m.listener===s&&m.layers.length===r.length&&m.layers.every(w=>r.includes(w))){for(const w in m.delegates)this.off(w,m.delegates[w]);return void c.splice(d,1)}}}on(g,r,s){if(s===void 0)return super.on(g,r);const c=this._createDelegatedListener(g,typeof r=="string"?[r]:r,s);this._saveDelegatedListener(g,c);for(const d in c.delegates)this.on(d,c.delegates[d]);return this}once(g,r,s){if(s===void 0)return super.once(g,r);const c=typeof r=="string"?[r]:r,d=this._createDelegatedListener(g,c,s);for(const m in d.delegates){const w=d.delegates[m];d.delegates[m]=(...T)=>{this._removeDelegatedListener(g,c,s),w(...T)}}this._saveDelegatedListener(g,d);for(const m in d.delegates)this.once(m,d.delegates[m]);return this}off(g,r,s){return s===void 0?super.off(g,r):(this._removeDelegatedListener(g,typeof r=="string"?[r]:r,s),this)}queryRenderedFeatures(g,r){if(!this.style)return[];let s;const c=g instanceof h.P||Array.isArray(g),d=c?g:[[0,0],[this.transform.width,this.transform.height]];if(r=r||(c?{}:g)||{},d instanceof h.P||typeof d[0]=="number")s=[h.P.convert(d)];else{const m=h.P.convert(d[0]),w=h.P.convert(d[1]);s=[m,new h.P(w.x,m.y),w,new h.P(m.x,w.y),m]}return this.style.queryRenderedFeatures(s,r,this.transform)}querySourceFeatures(g,r){return this.style.querySourceFeatures(g,r)}setStyle(g,r){return(r=h.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},r)).diff!==!1&&r.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&g?(this._diffStyle(g,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._updateStyle(g,r))}setTransformRequest(g){return this._requestManager.setTransformRequest(g),this}_getUIString(g){const r=this._locale[g];if(r==null)throw new Error(`Missing UI string '${g}'`);return r}_updateStyle(g,r){if(r.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(g,r));const s=this.style&&r.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!g)),g?(this.style=new ql(this,r||{}),this.style.setEventedParent(this,{style:this.style}),typeof g=="string"?this.style.loadURL(g,r,s):this.style.loadJSON(g,r,s),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new ql(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(g,r){if(typeof g=="string"){const s=this._requestManager.transformRequest(g,"Style");h.h(s,new AbortController).then(c=>{this._updateDiff(c.data,r)}).catch(c=>{c&&this.fire(new h.j(c))})}else typeof g=="object"&&this._updateDiff(g,r)}_updateDiff(g,r){try{this.style.setState(g,r)&&this._update(!0)}catch(s){h.w(`Unable to perform style diff: ${s.message||s.error||s}.  Rebuilding the style from scratch.`),this._updateStyle(g,r)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():h.w("There is no style added to the map.")}addSource(g,r){return this._lazyInitEmptyStyle(),this.style.addSource(g,r),this._update(!0)}isSourceLoaded(g){const r=this.style&&this.style.sourceCaches[g];if(r!==void 0)return r.loaded();this.fire(new h.j(new Error(`There is no source with ID '${g}'`)))}setTerrain(g){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),g){const r=this.style.sourceCaches[g.source];if(!r)throw new Error(`cannot load terrain, because there exists no source with ID: ${g.source}`);this.terrain===null&&r.reload();for(const s in this.style._layers){const c=this.style._layers[s];c.type==="hillshade"&&c.source===g.source&&h.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new fh(this.painter,r,g),this.painter.renderToTexture=new vp(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=s=>{s.dataType==="style"?this.terrain.sourceCache.freeRtt():s.dataType==="source"&&s.tile&&(s.sourceId!==g.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(s.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new h.k("terrain",{terrain:g})),this}getTerrain(){var g,r;return(r=(g=this.terrain)===null||g===void 0?void 0:g.options)!==null&&r!==void 0?r:null}areTilesLoaded(){const g=this.style&&this.style.sourceCaches;for(const r in g){const s=g[r]._tiles;for(const c in s){const d=s[c];if(d.state!=="loaded"&&d.state!=="errored")return!1}}return!0}removeSource(g){return this.style.removeSource(g),this._update(!0)}getSource(g){return this.style.getSource(g)}addImage(g,r,s={}){const{pixelRatio:c=1,sdf:d=!1,stretchX:m,stretchY:w,content:T,textFitWidth:C,textFitHeight:E}=s;if(this._lazyInitEmptyStyle(),!(r instanceof HTMLImageElement||h.b(r))){if(r.width===void 0||r.height===void 0)return this.fire(new h.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:P,height:M,data:N}=r,V=r;return this.style.addImage(g,{data:new h.R({width:P,height:M},new Uint8Array(N)),pixelRatio:c,stretchX:m,stretchY:w,content:T,textFitWidth:C,textFitHeight:E,sdf:d,version:0,userImage:V}),V.onAdd&&V.onAdd(this,g),this}}{const{width:P,height:M,data:N}=U.getImageData(r);this.style.addImage(g,{data:new h.R({width:P,height:M},N),pixelRatio:c,stretchX:m,stretchY:w,content:T,textFitWidth:C,textFitHeight:E,sdf:d,version:0})}}updateImage(g,r){const s=this.style.getImage(g);if(!s)return this.fire(new h.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const c=r instanceof HTMLImageElement||h.b(r)?U.getImageData(r):r,{width:d,height:m,data:w}=c;if(d===void 0||m===void 0)return this.fire(new h.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(d!==s.data.width||m!==s.data.height)return this.fire(new h.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const T=!(r instanceof HTMLImageElement||h.b(r));return s.data.replace(w,T),this.style.updateImage(g,s),this}getImage(g){return this.style.getImage(g)}hasImage(g){return g?!!this.style.getImage(g):(this.fire(new h.j(new Error("Missing required image id"))),!1)}removeImage(g){this.style.removeImage(g)}loadImage(g){return ie.getImage(this._requestManager.transformRequest(g,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(g,r){return this._lazyInitEmptyStyle(),this.style.addLayer(g,r),this._update(!0)}moveLayer(g,r){return this.style.moveLayer(g,r),this._update(!0)}removeLayer(g){return this.style.removeLayer(g),this._update(!0)}getLayer(g){return this.style.getLayer(g)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(g,r,s){return this.style.setLayerZoomRange(g,r,s),this._update(!0)}setFilter(g,r,s={}){return this.style.setFilter(g,r,s),this._update(!0)}getFilter(g){return this.style.getFilter(g)}setPaintProperty(g,r,s,c={}){return this.style.setPaintProperty(g,r,s,c),this._update(!0)}getPaintProperty(g,r){return this.style.getPaintProperty(g,r)}setLayoutProperty(g,r,s,c={}){return this.style.setLayoutProperty(g,r,s,c),this._update(!0)}getLayoutProperty(g,r){return this.style.getLayoutProperty(g,r)}setGlyphs(g,r={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(g,r),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(g,r,s={}){return this._lazyInitEmptyStyle(),this.style.addSprite(g,r,s,c=>{c||this._update(!0)}),this}removeSprite(g){return this._lazyInitEmptyStyle(),this.style.removeSprite(g),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(g,r={}){return this._lazyInitEmptyStyle(),this.style.setSprite(g,r,s=>{s||this._update(!0)}),this}setLight(g,r={}){return this._lazyInitEmptyStyle(),this.style.setLight(g,r),this._update(!0)}getLight(){return this.style.getLight()}setSky(g){return this._lazyInitEmptyStyle(),this.style.setSky(g),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(g,r){return this.style.setFeatureState(g,r),this._update()}removeFeatureState(g,r){return this.style.removeFeatureState(g,r),this._update()}getFeatureState(g){return this.style.getFeatureState(g)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let g=0,r=0;return this._container&&(g=this._container.clientWidth||400,r=this._container.clientHeight||300),[g,r]}_setupContainer(){const g=this._container;g.classList.add("maplibregl-map");const r=this._canvasContainer=O.create("div","maplibregl-canvas-container",g);this._interactive&&r.classList.add("maplibregl-interactive"),this._canvas=O.create("canvas","maplibregl-canvas",r),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const s=this._containerDimensions(),c=this._getClampedPixelRatio(s[0],s[1]);this._resizeCanvas(s[0],s[1],c);const d=this._controlContainer=O.create("div","maplibregl-control-container",g),m=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(w=>{m[w]=O.create("div",`maplibregl-ctrl-${w} `,d)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(g,r,s){this._canvas.width=Math.floor(s*g),this._canvas.height=Math.floor(s*r),this._canvas.style.width=`${g}px`,this._canvas.style.height=`${r}px`}_setupPainter(){const g={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let r=null;this._canvas.addEventListener("webglcontextcreationerror",c=>{r={requestedAttributes:g},c&&(r.statusMessage=c.statusMessage,r.type=c.type)},{once:!0});const s=this._canvas.getContext("webgl2",g)||this._canvas.getContext("webgl",g);if(!s){const c="Failed to initialize WebGL";throw r?(r.message=c,new Error(JSON.stringify(r))):new Error(c)}this.painter=new au(s,this.transform),de.testSupport(s)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(g){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(g){return this._update(),this._renderTaskQueue.add(g)}_cancelRenderFrame(g){this._renderTaskQueue.remove(g)}_render(g){const r=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(g),this._removed)return;let s=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const d=this.transform.zoom,m=U.now();this.style.zoomHistory.update(d,m);const w=new h.z(d,{now:m,fadeDuration:r,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),T=w.crossFadingFactor();T===1&&T===this._crossFadingFactor||(s=!0,this._crossFadingFactor=T),this.style.update(w)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,r,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:r,showPadding:this.showPadding}),this.fire(new h.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,h.bf.mark(h.bg.load),this.fire(new h.k("load"))),this.style&&(this.style.hasTransitions()||s)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const c=this._sourcesDirty||this._styleDirty||this._placementDirty;return c||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new h.k("idle")),!this._loaded||this._fullyLoaded||c||(this._fullyLoaded=!0,h.bf.mark(h.bg.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var g;this._hash&&this._hash.remove();for(const s of this._controls)s.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),ie.removeThrottleControl(this._imageQueueHandle),(g=this._resizeObserver)===null||g===void 0||g.disconnect();const r=this.painter.context.gl.getExtension("WEBGL_lose_context");r!=null&&r.loseContext&&r.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),O.remove(this._canvasContainer),O.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),h.bf.clearMetrics(),this._removed=!0,this.fire(new h.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,U.frameAsync(this._frameRequest).then(g=>{h.bf.frame(g),this._frameRequest=null,this._render(g)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._update())}get showPadding(){return!!this._showPadding}set showPadding(g){this._showPadding!==g&&(this._showPadding=g,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,g?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._update())}get repaint(){return!!this._repaint}set repaint(g){this._repaint!==g&&(this._repaint=g,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(g){this._vertices=g,this._update()}get version(){return xp}getCameraTargetElevation(){return this.transform.elevation}},x.MapMouseEvent=dn,x.MapTouchEvent=Ca,x.MapWheelEvent=pp,x.Marker=yu,x.NavigationControl=class{constructor(g){this._updateZoomButtons=()=>{const r=this._map.getZoom(),s=r===this._map.getMaxZoom(),c=r===this._map.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=c,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",c.toString())},this._rotateCompassArrow=()=>{const r=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=r},this._setButtonTitle=(r,s)=>{const c=this._map._getUIString(`NavigationControl.${s}`);r.title=c,r.setAttribute("aria-label",c)},this.options=h.e({},Rg,g),this._container=O.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",r=>this._map.zoomIn({},{originalEvent:r})),O.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",r=>this._map.zoomOut({},{originalEvent:r})),O.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",r=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:r}):this._map.resetNorth({},{originalEvent:r})}),this._compassIcon=O.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(g){return this._map=g,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Dg(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){O.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(g,r){const s=O.create("button",g,this._container);return s.type="button",s.addEventListener("click",r),s}},x.Popup=class extends h.E{constructor(g){super(),this.remove=()=>(this._content&&O.remove(this._content),this._container&&(O.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new h.k("close"))),this),this._onMouseUp=r=>{this._update(r.point)},this._onMouseMove=r=>{this._update(r.point)},this._onDrag=r=>{this._update(r.point)},this._update=r=>{var s;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=O.create("div","maplibregl-popup",this._map.getContainer()),this._tip=O.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const T of this.options.className.split(" "))this._container.classList.add(T);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?cr(this._lngLat,this._flatPos,this._map.transform):(s=this._lngLat)===null||s===void 0?void 0:s.wrap(),this._trackPointer&&!r)return;const c=this._flatPos=this._pos=this._trackPointer&&r?r:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&r?r:this._map.transform.locationPoint(this._lngLat));let d=this.options.anchor;const m=vu(this.options.offset);if(!d){const T=this._container.offsetWidth,C=this._container.offsetHeight;let E;E=c.y+m.bottom.y<C?["top"]:c.y>this._map.transform.height-C?["bottom"]:[],c.x<T/2?E.push("left"):c.x>this._map.transform.width-T/2&&E.push("right"),d=E.length===0?"bottom":E.join("-")}let w=c.add(m[d]);this.options.subpixelPositioning||(w=w.round()),O.setTransform(this._container,`${ps[d]} translate(${w.x}px,${w.y}px)`),gu(this._container,d,"popup")},this._onClose=()=>{this.remove()},this.options=h.e(Object.create(ut),g)}addTo(g){return this._map&&this.remove(),this._map=g,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new h.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(g){return this._lngLat=h.N.convert(g),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(g){return this.setDOMContent(document.createTextNode(g))}setHTML(g){const r=document.createDocumentFragment(),s=document.createElement("body");let c;for(s.innerHTML=g;c=s.firstChild,c;)r.appendChild(c);return this.setDOMContent(r)}getMaxWidth(){var g;return(g=this._container)===null||g===void 0?void 0:g.style.maxWidth}setMaxWidth(g){return this.options.maxWidth=g,this._update(),this}setDOMContent(g){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=O.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(g),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(g){return this._container&&this._container.classList.add(g),this}removeClassName(g){return this._container&&this._container.classList.remove(g),this}setOffset(g){return this.options.offset=g,this._update(),this}toggleClassName(g){if(this._container)return this._container.classList.toggle(g)}setSubpixelPositioning(g){this.options.subpixelPositioning=g}_createCloseButton(){this.options.closeButton&&(this._closeButton=O.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const g=this._container.querySelector(_u);g&&g.focus()}},x.RasterDEMTileSource=ir,x.RasterTileSource=Lt,x.ScaleControl=class{constructor(g){this._onMove=()=>{dl(this._map,this._container,this.options)},this.setUnit=r=>{this.options.unit=r,dl(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},co),g)}getDefaultPosition(){return"bottom-left"}onAdd(g){return this._map=g,this._container=O.create("div","maplibregl-ctrl maplibregl-ctrl-scale",g.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){O.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},x.ScrollZoomHandler=Oi,x.Style=ql,x.TerrainControl=class{constructor(g){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=g}onAdd(g){return this._map=g,this._container=O.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=O.create("button","maplibregl-ctrl-terrain",this._container),O.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){O.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},x.TwoFingersTouchPitchHandler=ls,x.TwoFingersTouchRotateHandler=lh,x.TwoFingersTouchZoomHandler=ah,x.TwoFingersTouchZoomRotateHandler=ch,x.VectorTileSource=fa,x.VideoSource=Mi,x.addSourceType=(g,r)=>h._(void 0,void 0,void 0,function*(){if(Go(g))throw new Error(`A source type called "${g}" already exists.`);((s,c)=>{ma[s]=c})(g,r)}),x.clearPrewarmedResources=function(){const g=Br;g&&(g.isPreloaded()&&g.numActive()===1?(g.release(_r),Br=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},x.getMaxParallelImageRequests=function(){return h.a.MAX_PARALLEL_IMAGE_REQUESTS},x.getRTLTextPluginStatus=function(){return pi().getRTLTextPluginStatus()},x.getVersion=function(){return yh},x.getWorkerCount=function(){return qr.workerCount},x.getWorkerUrl=function(){return h.a.WORKER_URL},x.importScriptInWorkers=function(g){return pa().broadcast("IS",g)},x.prewarm=function(){an().acquire(_r)},x.setMaxParallelImageRequests=function(g){h.a.MAX_PARALLEL_IMAGE_REQUESTS=g},x.setRTLTextPlugin=function(g,r){return pi().setRTLTextPlugin(g,r)},x.setWorkerCount=function(g){qr.workerCount=g},x.setWorkerUrl=function(g){h.a.WORKER_URL=g}});var v=a;return v})})(QT);var x3=QT.exports;const lt=v0(x3);function b3(){return typeof self<"u"?fetch.bind(self):typeof global<"u"&&global.fetch?global.fetch:null}class w3{constructor(){this._apiKey="",this._fetch=b3(),this.tileCacheSize=200}set apiKey(t){this._apiKey=t}get apiKey(){return this._apiKey}set fetch(t){this._fetch=t}get fetch(){return this._fetch}}const cc=new w3,jd={AUTO:{code:null,flag:"auto",name:"Auto",latin:!1,isMode:!0,geocoding:!0},LATIN:{code:"latin",flag:"name:latin",name:"Latin",latin:!0,isMode:!1,geocoding:!1},NON_LATIN:{code:"nonlatin",flag:"name:nonlatin",name:"Non Latin",latin:!1,isMode:!1,geocoding:!1},LOCAL:{code:null,flag:"name",name:"Local",latin:!0,isMode:!1,geocoding:!1},AMHARIC:{code:"am",flag:"name:am",name:"Amharic",latin:!1,isMode:!1,geocoding:!1},ARABIC:{code:"ar",flag:"name:ar",name:"Arabic",latin:!1,isMode:!1,geocoding:!0},AZERBAIJANI:{code:"az",flag:"name:az",name:"Azerbaijani",latin:!0,isMode:!1,geocoding:!0},BELARUSIAN:{code:"be",flag:"name:be",name:"Belarusian",latin:!1,isMode:!1,geocoding:!0},BULGARIAN:{code:"bg",flag:"bg",name:"Bulgarian",latin:!1,isMode:!1,geocoding:!0},BENGALI:{code:"bn",flag:"name:bn",name:"Bengali",latin:!0,isMode:!1,geocoding:!1},BRETON:{code:"br",flag:"name:br",name:"Breton",latin:!0,isMode:!1,geocoding:!0},BOSNIAN:{code:"bs",flag:"name:bs",name:"Bosnian",latin:!0,isMode:!1,geocoding:!0},CATALAN:{code:"ca",flag:"name:ca",name:"Catalan",latin:!0,isMode:!1,geocoding:!0},CHINESE:{code:"zh",flag:"name:zh",name:"Chinese",latin:!1,isMode:!1,geocoding:!0},TRADITIONAL_CHINESE:{code:"zh-Hant",flag:"name:zh-Hant",name:"Chinese (traditional)",latin:!1,isMode:!1,geocoding:!1},SIMPLIFIED_CHINESE:{code:"zh-Hans",flag:"name:zh-Hans",name:"Chinese (simplified)",latin:!1,isMode:!1,geocoding:!1},CORSICAN:{code:"co",flag:"name:co",name:"Corsican",latin:!0,isMode:!1,geocoding:!1},CZECH:{code:"cs",flag:"name:cs",name:"Czech",latin:!0,isMode:!1,geocoding:!1},WELSH:{code:"cy",flag:"name:cy",name:"WELSH",latin:!0,isMode:!1,geocoding:!0},DANISH:{code:"da",flag:"name:da",name:"Danish",latin:!0,isMode:!1,geocoding:!0},GERMAN:{code:"de",flag:"name:de",name:"German",latin:!0,isMode:!1,geocoding:!0},GREEK:{code:"el",flag:"name:el",name:"Greek",latin:!1,isMode:!1,geocoding:!0},ENGLISH:{code:"en",flag:"name:en",name:"English",latin:!0,isMode:!1,geocoding:!0},ESPERANTO:{code:"eo",flag:"name:eo",name:"Esperanto",latin:!0,isMode:!1,geocoding:!0},SPANISH:{code:"es",flag:"name:es",name:"Spanish",latin:!0,isMode:!1,geocoding:!0},ESTONIAN:{code:"et",flag:"name:et",name:"Estonian",latin:!0,isMode:!1,geocoding:!0},BASQUE:{code:"eu",flag:"name:eu",name:"Basque",latin:!0,isMode:!1,geocoding:!1},FINNISH:{code:"fi",flag:"name:fi",name:"Finnish",latin:!0,isMode:!1,geocoding:!0},FRENCH:{code:"fr",flag:"name:fr",name:"French",latin:!0,isMode:!1,geocoding:!0},FRISIAN:{code:"fy",flag:"name:fy",name:"Frisian (West)",latin:!0,isMode:!1,geocoding:!0},IRISH:{code:"ga",flag:"name:ga",name:"Irish",latin:!0,isMode:!1,geocoding:!0},SCOTTISH_GAELIC:{code:"gd",flag:"name:gd",name:"Scottish Gaelic",latin:!0,isMode:!1,geocoding:!0},HEBREW:{code:"he",flag:"name:he",name:"Hebrew",latin:!1,isMode:!1,geocoding:!0},HINDI:{code:"hi",flag:"name:hi",name:"Hindi",latin:!1,isMode:!1,geocoding:!1},CROATIAN:{code:"hr",flag:"name:hr",name:"Croatian",latin:!0,isMode:!1,geocoding:!0},HUNGARIAN:{code:"hu",flag:"name:hu",name:"Hungarian",latin:!0,isMode:!1,geocoding:!0},ARMENIAN:{code:"hy",flag:"name:hy",name:"Armenian",latin:!1,isMode:!1,geocoding:!0},INDONESIAN:{code:"id",flag:"name:id",name:"Indonesian",latin:!0,isMode:!1,geocoding:!1},ICELANDIC:{code:"is",flag:"name:is",name:"Icelandic",latin:!0,isMode:!1,geocoding:!0},ITALIAN:{code:"it",flag:"name:it",name:"Italian",latin:!0,isMode:!1,geocoding:!0},JAPANESE:{code:"ja",flag:"name:ja",name:"Japanese",latin:!1,isMode:!1,geocoding:!0},JAPANESE_HIRAGANA:{code:"ja-Hira",flag:"name:ja-Hira",name:"Japanese Hiragana form",latin:!1,isMode:!1,geocoding:!1},JAPANESE_2018:{code:"ja-Latn",flag:"name:ja-Latn",name:"Japanese (Latin 2018)",latin:!0,isMode:!1,geocoding:!1},JAPANESE_KANA:{code:"ja_kana",flag:"name:ja_kana",name:"Japanese (Kana)",latin:!1,isMode:!1,geocoding:!1},JAPANESE_LATIN:{code:"ja_rm",flag:"name:ja_rm",name:"Japanese (Latin script)",latin:!0,isMode:!1,geocoding:!1},GEORGIAN:{code:"ka",flag:"name:ka",name:"Georgian",latin:!1,isMode:!1,geocoding:!0},KAZAKH:{code:"kk",flag:"name:kk",name:"Kazakh",latin:!1,isMode:!1,geocoding:!0},KANNADA:{code:"kn",flag:"name:kn",name:"Kannada",latin:!0,isMode:!1,geocoding:!0},KOREAN:{code:"ko",flag:"name:ko",name:"Korean",latin:!1,isMode:!1,geocoding:!0},KOREAN_LATIN:{code:"ko-Latn",flag:"name:ko-Latn",name:"Korean (Latin script)",latin:!0,isMode:!1,geocoding:!1},KURDISH:{code:"ku",flag:"name:ku",name:"Kurdish",latin:!0,isMode:!1,geocoding:!1},CLASSICAL_LATIN:{code:"la",flag:"name:la",name:"Latin",latin:!0,isMode:!1,geocoding:!0},LUXEMBOURGISH:{code:"lb",flag:"name:lb",name:"Luxembourgish",latin:!0,isMode:!1,geocoding:!0},LITHUANIAN:{code:"lt",flag:"name:lt",name:"Lithuanian",latin:!0,isMode:!1,geocoding:!0},LATVIAN:{code:"lv",flag:"name:lv",name:"Latvian",latin:!0,isMode:!1,geocoding:!0},MACEDONIAN:{code:"mk",flag:"name:mk",name:"Macedonian",latin:!1,isMode:!1,geocoding:!0},MALAYALAM:{code:"ml",flag:"name:ml",name:"Malayalam",latin:!1,isMode:!1,geocoding:!1},MALTESE:{code:"mt",flag:"name:mt",name:"Maltese",latin:!0,isMode:!1,geocoding:!0},DUTCH:{code:"nl",flag:"name:nl",name:"Dutch",latin:!0,isMode:!1,geocoding:!0},NORWEGIAN:{code:"no",flag:"name:no",name:"Norwegian",latin:!0,isMode:!1,geocoding:!0},OCCITAN:{code:"oc",flag:"name:oc",name:"Occitan",latin:!0,isMode:!1,geocoding:!1},POLISH:{code:"pl",flag:"name:pl",name:"Polish",latin:!0,isMode:!1,geocoding:!0},PERSIAN:{code:"fa",flag:"name:fa",name:"Persian",latin:!1,isMode:!1,geocoding:!1},PUNJABI:{code:"pa",flag:"name:pa",name:"Punjabi",latin:!1,isMode:!1,geocoding:!1},WESTERN_PUNJABI:{code:"pnb",flag:"name:pnb",name:"Western Punjabi",latin:!1,isMode:!1,geocoding:!1},PORTUGUESE:{code:"pt",flag:"name:pt",name:"Portuguese",latin:!0,isMode:!1,geocoding:!0},ROMANSH:{code:"rm",flag:"name:rm",name:"Romansh",latin:!0,isMode:!1,geocoding:!0},ROMANIAN:{code:"ro",flag:"name:ro",name:"Romanian",latin:!0,isMode:!1,geocoding:!0},RUSSIAN:{code:"ru",flag:"name:ru",name:"Russian",latin:!1,isMode:!1,geocoding:!0},SLOVAK:{code:"sk",flag:"name:sk",name:"Slovak",latin:!0,isMode:!1,geocoding:!0},SLOVENE:{code:"sl",flag:"name:sl",name:"Slovene",latin:!0,isMode:!1,geocoding:!0},ALBANIAN:{code:"sq",flag:"name:sq",name:"Albanian",latin:!0,isMode:!1,geocoding:!0},SERBIAN_CYRILLIC:{code:"sr",flag:"name:sr",name:"Serbian (Cyrillic script)",latin:!1,isMode:!1,geocoding:!0},SERBIAN_LATIN:{code:"sr-Latn",flag:"name:sr-Latn",name:"Serbian (Latin script)",latin:!0,isMode:!1,geocoding:!1},SWEDISH:{code:"sv",flag:"name:sv",name:"Swedish",latin:!0,isMode:!1,geocoding:!0},TAMIL:{code:"ta",flag:"name:ta",name:"Tamil",latin:!1,isMode:!1,geocoding:!1},TELUGU:{code:"te",flag:"name:te",name:"Telugu",latin:!1,isMode:!1,geocoding:!1},THAI:{code:"th",flag:"name:th",name:"Thai",latin:!1,isMode:!1,geocoding:!0},TURKISH:{code:"tr",flag:"name:tr",name:"Turkish",latin:!0,isMode:!1,geocoding:!0},UKRAINIAN:{code:"uk",flag:"name:uk",name:"Ukrainian",latin:!1,isMode:!1,geocoding:!0},VIETNAMESE:{code:"vi",flag:"name:vi",name:"Vietnamese (Latin script)",latin:!0,isMode:!1,geocoding:!1}};function S3(e,t=jd){return e in t?e[e]:null}function c0(e,t=jd){for(const a of Object.values(t))if(a.code===e)return a;return null}function h0(e,t=jd){for(const a of Object.values(t))if(a.flag===e)return a;return null}function T3(e){return e!==null&&typeof e=="object"&&"code"in e&&"flag"in e&&"name"in e&&"latin"in e&&"isMode"in e&&"geocoding"in e&&(typeof e.code=="string"||e.code===null)&&typeof e.flag=="string"&&typeof e.name=="string"&&typeof e.latin=="boolean"&&typeof e.isMode=="boolean"&&typeof e.geocoding=="boolean"}function C3(e,t=jd){return T3(e)?h0(e.flag,t):typeof e!="string"?null:S3(e,t)||c0(e,t)||h0(e,t)||null}async function k3(e,t={}){if(cc.fetch===null)throw new Error("The fetch function was not found. If on NodeJS < 18 please specify the fetch function with config.fetch");if(new URL(e).searchParams.get("key").trim()==="")throw new Error("The MapTiler Cloud API key is missing. Set it in `config.apiKey` or get one for free at https://maptiler.com");return cc.fetch(e,t)}const tC={maptilerApiURL:"https://api.maptiler.com/",mapStyle:"streets-v2"};Object.freeze(tC);class I3 extends Error{constructor(t,a=""){super(`Call to enpoint ${t.url} failed with the status code ${t.status}. ${a}`),this.res=t}}const yw={403:"Key is missing, invalid or restricted"};async function E3(e={}){const t=new URL("geolocation/ip.json",tC.maptilerApiURL);t.searchParams.set("key",e.apiKey??cc.apiKey);const a=t.toString(),u=await k3(a);if(!u.ok)throw new I3(u,u.status in yw?yw[u.status]:"");return await u.json()}const _w={info:E3};function rC(e){const t=/^maptiler:\/\/(.*)/;let a;const u=e.trim();let f;return u.startsWith("http://")||u.startsWith("https://")?f=u:(a=t.exec(u))!==null?f=`https://api.maptiler.com/maps/${a[1]}/style.json`:f=`https://api.maptiler.com/maps/${u}/style.json`,f}class nC{constructor(t,a,u,f,v,x){this.name=t,this.variantType=a,this.id=u,this.referenceStyle=f,this.description=v,this.imageURL=x}getName(){return this.name}getFullName(){return`${this.referenceStyle.getName()} ${this.name}`}getType(){return this.variantType}getId(){return this.id}getDescription(){return this.description}getReferenceStyle(){return this.referenceStyle}hasVariant(t){return this.referenceStyle.hasVariant(t)}getVariant(t){return this.referenceStyle.getVariant(t)}getVariants(){return this.referenceStyle.getVariants().filter(t=>t!==this)}getImageURL(){return this.imageURL}getExpandedStyleURL(){return rC(this.getId())}}class iC{constructor(t,a){this.name=t,this.id=a,this.variants={},this.orderedVariants=[]}getName(){return this.name}getId(){return this.id}addVariant(t){this.variants[t.getType()]=t,this.orderedVariants.push(t)}hasVariant(t){return t in this.variants}getVariant(t){return t in this.variants?this.variants[t]:this.orderedVariants[0]}getVariants(){return Object.values(this.variants)}getDefaultVariant(){return this.orderedVariants[0]}}const d0=[{referenceStyleID:"STREETS",name:"Streets",description:"",variants:[{id:"streets-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"streets-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"streets-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"streets-v2-night",name:"Night",variantType:"NIGHT",description:"",imageURL:""},{id:"streets-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OUTDOOR",name:"Outdoor",description:"",variants:[{id:"outdoor-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"outdoor-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"WINTER",name:"Winter",description:"",variants:[{id:"winter-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"winter-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"SATELLITE",name:"Satellite",description:"",variants:[{id:"satellite",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"HYBRID",name:"Hybrid",description:"",variants:[{id:"hybrid",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"BASIC",name:"Basic",description:"",variants:[{id:"basic-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"basic-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"basic-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BRIGHT",name:"Bright",description:"",variants:[{id:"bright-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"bright-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"bright-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"bright-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OPENSTREETMAP",name:"OpenStreetMap",description:"",variants:[{id:"openstreetmap",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"TOPO",name:"Topo",description:"",variants:[{id:"topo-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"topo-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"topo-v2-shiny",name:"Shiny",variantType:"SHINY",description:"",imageURL:""},{id:"topo-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""},{id:"topo-v2-topographique",name:"Topographique",variantType:"TOPOGRAPHIQUE",description:"",imageURL:""}]},{referenceStyleID:"VOYAGER",name:"Voyager",description:"",variants:[{id:"voyager-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"voyager-v2-darkmatter",name:"Darkmatter",variantType:"DARK",description:"",imageURL:""},{id:"voyager-v2-positron",name:"Positron",variantType:"LIGHT",description:"",imageURL:""},{id:"voyager-v2-vintage",name:"Vintage",variantType:"VINTAGE",description:"",imageURL:""}]},{referenceStyleID:"TONER",name:"Toner",description:"",variants:[{id:"toner-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"toner-v2-background",name:"Background",variantType:"BACKGROUND",description:"",imageURL:""},{id:"toner-v2-lite",name:"Lite",variantType:"LITE",description:"",imageURL:""},{id:"toner-v2-lines",name:"Lines",variantType:"LINES",description:"",imageURL:""}]},{referenceStyleID:"DATAVIZ",name:"Dataviz",description:"",variants:[{id:"dataviz",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"dataviz-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"dataviz-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BACKDROP",name:"Backdrop",description:"",variants:[{id:"backdrop",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"backdrop-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"backdrop-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"OCEAN",name:"Ocean",description:"",variants:[{id:"ocean",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]}];function A3(e){return new Proxy(e,{get(t,a,u){return t.hasVariant(a)?t.getVariant(a):a.toString().toUpperCase()===a?e.getDefaultVariant():Reflect.get(t,a,u)}})}function P3(){const e={};for(let t=0;t<d0.length;t+=1){const a=d0[t],u=A3(new iC(a.name,a.referenceStyleID));for(let f=0;f<a.variants.length;f+=1){const v=a.variants[f],x=new nC(v.name,v.variantType,v.id,u,v.description,v.imageURL);u.addVariant(x)}e[a.referenceStyleID]=u}return e}const oC=P3();var Bv={exports:{}},hc=typeof Reflect=="object"?Reflect:null,vw=hc&&typeof hc.apply=="function"?hc.apply:function(t,a,u){return Function.prototype.apply.call(t,a,u)},zf;hc&&typeof hc.ownKeys=="function"?zf=hc.ownKeys:Object.getOwnPropertySymbols?zf=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:zf=function(t){return Object.getOwnPropertyNames(t)};function M3(e){console&&console.warn&&console.warn(e)}var aC=Number.isNaN||function(t){return t!==t};function gr(){gr.init.call(this)}Bv.exports=gr;Bv.exports.once=D3;gr.EventEmitter=gr;gr.prototype._events=void 0;gr.prototype._eventsCount=0;gr.prototype._maxListeners=void 0;var xw=10;function ag(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(gr,"defaultMaxListeners",{enumerable:!0,get:function(){return xw},set:function(e){if(typeof e!="number"||e<0||aC(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");xw=e}});gr.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};gr.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||aC(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function sC(e){return e._maxListeners===void 0?gr.defaultMaxListeners:e._maxListeners}gr.prototype.getMaxListeners=function(){return sC(this)};gr.prototype.emit=function(t){for(var a=[],u=1;u<arguments.length;u++)a.push(arguments[u]);var f=t==="error",v=this._events;if(v!==void 0)f=f&&v.error===void 0;else if(!f)return!1;if(f){var x;if(a.length>0&&(x=a[0]),x instanceof Error)throw x;var h=new Error("Unhandled error."+(x?" ("+x.message+")":""));throw h.context=x,h}var z=v[t];if(z===void 0)return!1;if(typeof z=="function")vw(z,this,a);else for(var B=z.length,Z=dC(z,B),u=0;u<B;++u)vw(Z[u],this,a);return!0};function lC(e,t,a,u){var f,v,x;if(ag(a),v=e._events,v===void 0?(v=e._events=Object.create(null),e._eventsCount=0):(v.newListener!==void 0&&(e.emit("newListener",t,a.listener?a.listener:a),v=e._events),x=v[t]),x===void 0)x=v[t]=a,++e._eventsCount;else if(typeof x=="function"?x=v[t]=u?[a,x]:[x,a]:u?x.unshift(a):x.push(a),f=sC(e),f>0&&x.length>f&&!x.warned){x.warned=!0;var h=new Error("Possible EventEmitter memory leak detected. "+x.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");h.name="MaxListenersExceededWarning",h.emitter=e,h.type=t,h.count=x.length,M3(h)}return e}gr.prototype.addListener=function(t,a){return lC(this,t,a,!1)};gr.prototype.on=gr.prototype.addListener;gr.prototype.prependListener=function(t,a){return lC(this,t,a,!0)};function z3(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function uC(e,t,a){var u={fired:!1,wrapFn:void 0,target:e,type:t,listener:a},f=z3.bind(u);return f.listener=a,u.wrapFn=f,f}gr.prototype.once=function(t,a){return ag(a),this.on(t,uC(this,t,a)),this};gr.prototype.prependOnceListener=function(t,a){return ag(a),this.prependListener(t,uC(this,t,a)),this};gr.prototype.removeListener=function(t,a){var u,f,v,x,h;if(ag(a),f=this._events,f===void 0)return this;if(u=f[t],u===void 0)return this;if(u===a||u.listener===a)--this._eventsCount===0?this._events=Object.create(null):(delete f[t],f.removeListener&&this.emit("removeListener",t,u.listener||a));else if(typeof u!="function"){for(v=-1,x=u.length-1;x>=0;x--)if(u[x]===a||u[x].listener===a){h=u[x].listener,v=x;break}if(v<0)return this;v===0?u.shift():L3(u,v),u.length===1&&(f[t]=u[0]),f.removeListener!==void 0&&this.emit("removeListener",t,h||a)}return this};gr.prototype.off=gr.prototype.removeListener;gr.prototype.removeAllListeners=function(t){var a,u,f;if(u=this._events,u===void 0)return this;if(u.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):u[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete u[t]),this;if(arguments.length===0){var v=Object.keys(u),x;for(f=0;f<v.length;++f)x=v[f],x!=="removeListener"&&this.removeAllListeners(x);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(a=u[t],typeof a=="function")this.removeListener(t,a);else if(a!==void 0)for(f=a.length-1;f>=0;f--)this.removeListener(t,a[f]);return this};function cC(e,t,a){var u=e._events;if(u===void 0)return[];var f=u[t];return f===void 0?[]:typeof f=="function"?a?[f.listener||f]:[f]:a?R3(f):dC(f,f.length)}gr.prototype.listeners=function(t){return cC(this,t,!0)};gr.prototype.rawListeners=function(t){return cC(this,t,!1)};gr.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):hC.call(e,t)};gr.prototype.listenerCount=hC;function hC(e){var t=this._events;if(t!==void 0){var a=t[e];if(typeof a=="function")return 1;if(a!==void 0)return a.length}return 0}gr.prototype.eventNames=function(){return this._eventsCount>0?zf(this._events):[]};function dC(e,t){for(var a=new Array(t),u=0;u<t;++u)a[u]=e[u];return a}function L3(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function R3(e){for(var t=new Array(e.length),a=0;a<t.length;++a)t[a]=e[a].listener||e[a];return t}function D3(e,t){return new Promise(function(a,u){function f(x){e.removeListener(t,v),u(x)}function v(){typeof e.removeListener=="function"&&e.removeListener("error",f),a([].slice.call(arguments))}pC(e,t,v,{once:!0}),t!=="error"&&F3(e,f,{once:!0})})}function F3(e,t,a){typeof e.on=="function"&&pC(e,"error",t,a)}function pC(e,t,a,u){if(typeof e.on=="function")u.once?e.once(t,a):e.on(t,a);else if(typeof e.addEventListener=="function")e.addEventListener(t,function f(v){u.once&&e.removeEventListener(t,f),a(v)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}var B3=Bv.exports;const O3=v0(B3);let df;const N3=new Uint8Array(16);function $3(){if(!df&&(df=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!df))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return df(N3)}const Pn=[];for(let e=0;e<256;++e)Pn.push((e+256).toString(16).slice(1));function U3(e,t=0){return Pn[e[t+0]]+Pn[e[t+1]]+Pn[e[t+2]]+Pn[e[t+3]]+"-"+Pn[e[t+4]]+Pn[e[t+5]]+"-"+Pn[e[t+6]]+Pn[e[t+7]]+"-"+Pn[e[t+8]]+Pn[e[t+9]]+"-"+Pn[e[t+10]]+Pn[e[t+11]]+Pn[e[t+12]]+Pn[e[t+13]]+Pn[e[t+14]]+Pn[e[t+15]]}const j3=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),bw={randomUUID:j3};function V3(e,t,a){if(bw.randomUUID&&!t&&!e)return bw.randomUUID();e=e||{};const u=e.random||(e.rng||$3)();return u[6]=u[6]&15|64,u[8]=u[8]&63|128,U3(u)}const fC="3.7.7",q3=fC,Ec=typeof Buffer=="function",ww=typeof TextDecoder=="function"?new TextDecoder:void 0,Sw=typeof TextEncoder=="function"?new TextEncoder:void 0,Z3="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Jh=Array.prototype.slice.call(Z3),pf=(e=>{let t={};return e.forEach((a,u)=>t[a]=u),t})(Jh),G3=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,zn=String.fromCharCode.bind(String),Tw=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):e=>new Uint8Array(Array.prototype.slice.call(e,0)),mC=e=>e.replace(/=/g,"").replace(/[+\/]/g,t=>t=="+"?"-":"_"),gC=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),yC=e=>{let t,a,u,f,v="";const x=e.length%3;for(let h=0;h<e.length;){if((a=e.charCodeAt(h++))>255||(u=e.charCodeAt(h++))>255||(f=e.charCodeAt(h++))>255)throw new TypeError("invalid character found");t=a<<16|u<<8|f,v+=Jh[t>>18&63]+Jh[t>>12&63]+Jh[t>>6&63]+Jh[t&63]}return x?v.slice(0,x-3)+"===".substring(x):v},Ov=typeof btoa=="function"?e=>btoa(e):Ec?e=>Buffer.from(e,"binary").toString("base64"):yC,p0=Ec?e=>Buffer.from(e).toString("base64"):e=>{let a=[];for(let u=0,f=e.length;u<f;u+=4096)a.push(zn.apply(null,e.subarray(u,u+4096)));return Ov(a.join(""))},Lf=(e,t=!1)=>t?mC(p0(e)):p0(e),H3=e=>{if(e.length<2){var t=e.charCodeAt(0);return t<128?e:t<2048?zn(192|t>>>6)+zn(128|t&63):zn(224|t>>>12&15)+zn(128|t>>>6&63)+zn(128|t&63)}else{var t=65536+(e.charCodeAt(0)-55296)*1024+(e.charCodeAt(1)-56320);return zn(240|t>>>18&7)+zn(128|t>>>12&63)+zn(128|t>>>6&63)+zn(128|t&63)}},W3=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,_C=e=>e.replace(W3,H3),Cw=Ec?e=>Buffer.from(e,"utf8").toString("base64"):Sw?e=>p0(Sw.encode(e)):e=>Ov(_C(e)),dc=(e,t=!1)=>t?mC(Cw(e)):Cw(e),kw=e=>dc(e,!0),K3=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,X3=e=>{switch(e.length){case 4:var t=(7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3),a=t-65536;return zn((a>>>10)+55296)+zn((a&1023)+56320);case 3:return zn((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return zn((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},vC=e=>e.replace(K3,X3),xC=e=>{if(e=e.replace(/\s+/g,""),!G3.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(e.length&3));let t,a="",u,f;for(let v=0;v<e.length;)t=pf[e.charAt(v++)]<<18|pf[e.charAt(v++)]<<12|(u=pf[e.charAt(v++)])<<6|(f=pf[e.charAt(v++)]),a+=u===64?zn(t>>16&255):f===64?zn(t>>16&255,t>>8&255):zn(t>>16&255,t>>8&255,t&255);return a},Nv=typeof atob=="function"?e=>atob(gC(e)):Ec?e=>Buffer.from(e,"base64").toString("binary"):xC,bC=Ec?e=>Tw(Buffer.from(e,"base64")):e=>Tw(Nv(e).split("").map(t=>t.charCodeAt(0))),wC=e=>bC(SC(e)),Y3=Ec?e=>Buffer.from(e,"base64").toString("utf8"):ww?e=>ww.decode(bC(e)):e=>vC(Nv(e)),SC=e=>gC(e.replace(/[-_]/g,t=>t=="-"?"+":"/")),f0=e=>Y3(SC(e)),J3=e=>{if(typeof e!="string")return!1;const t=e.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(t)||!/[^\s0-9a-zA-Z\-_]/.test(t)},TC=e=>({value:e,enumerable:!1,writable:!0,configurable:!0}),CC=function(){const e=(t,a)=>Object.defineProperty(String.prototype,t,TC(a));e("fromBase64",function(){return f0(this)}),e("toBase64",function(t){return dc(this,t)}),e("toBase64URI",function(){return dc(this,!0)}),e("toBase64URL",function(){return dc(this,!0)}),e("toUint8Array",function(){return wC(this)})},kC=function(){const e=(t,a)=>Object.defineProperty(Uint8Array.prototype,t,TC(a));e("toBase64",function(t){return Lf(this,t)}),e("toBase64URI",function(){return Lf(this,!0)}),e("toBase64URL",function(){return Lf(this,!0)})},Q3=()=>{CC(),kC()},eR={version:fC,VERSION:q3,atob:Nv,atobPolyfill:xC,btoa:Ov,btoaPolyfill:yC,fromBase64:f0,toBase64:dc,encode:dc,encodeURI:kw,encodeURL:kw,utob:_C,btou:vC,decode:f0,isValid:J3,fromUint8Array:Lf,toUint8Array:wC,extendString:CC,extendUint8Array:kC,extendBuiltins:Q3};var tR=Object.defineProperty,IC=e=>{throw TypeError(e)},rR=(e,t,a)=>t in e?tR(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,mr=(e,t,a)=>rR(e,typeof t!="symbol"?t+"":t,a),$v=(e,t,a)=>t.has(e)||IC("Cannot "+a),jt=(e,t,a)=>($v(e,t,"read from private field"),a?a.call(e):t.get(e)),bl=(e,t,a)=>t.has(e)?IC("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,a),Vu=(e,t,a,u)=>($v(e,t,"write to private field"),t.set(e,a),a),Gi=(e,t,a)=>($v(e,t,"access private method"),a);const Zt={VISITOR:{code:null,flag:"visitor",name:"Visitor",latin:!0,isMode:!0,geocoding:!1},VISITOR_ENGLISH:{code:null,flag:"visitor_en",name:"Visitor English",latin:!0,isMode:!0,geocoding:!1},STYLE:{code:null,flag:"style",name:"Style",latin:!1,isMode:!0,geocoding:!1},STYLE_LOCK:{code:null,flag:"style_lock",name:"Style Lock",latin:!1,isMode:!0,geocoding:!1},...jd};function Iw(){if(typeof navigator>"u"){const e=Intl.DateTimeFormat().resolvedOptions().locale.split("-")[0];return c0(e)||Zt.ENGLISH}return Array.from(new Set(navigator.languages.map(e=>e.split("-")[0]))).map(e=>c0(e)).filter(e=>e)[0]??Zt.LOCAL}const wi={maptilerLogoURL:"https://api.maptiler.com/resources/logo.svg",maptilerURL:"https://www.maptiler.com/",maptilerApiHost:"api.maptiler.com",rtlPluginURL:"https://cdn.maptiler.com/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.min.js",primaryLanguage:Zt.STYLE,secondaryLanguage:Zt.LOCAL,terrainSourceURL:"https://api.maptiler.com/tiles/terrain-rgb-v2/tiles.json",terrainSourceId:"maptiler-terrain"};Object.freeze(wi);const EC=V3();class nR extends O3{constructor(){super(...arguments),mr(this,"primaryLanguage",wi.primaryLanguage),mr(this,"secondaryLanguage"),mr(this,"session",!0),mr(this,"caching",!0),mr(this,"_unit","metric"),mr(this,"_apiKey","")}set unit(t){this._unit=t,this.emit("unit",t)}get unit(){return this._unit}set apiKey(t){this._apiKey=t,cc.apiKey=t,this.emit("apiKey",t)}get apiKey(){return this._apiKey}set fetch(t){cc.fetch=t}get fetch(){return cc.fetch}}const xn=new nR,{addProtocol:Ew}=lt,m0="localcache_source",g0="localcache",iR="maptiler_sdk",oR=1e3,aR=100,y0=typeof caches<"u";function sR(e,t){if(y0&&xn.caching&&xn.session&&e.host===wi.maptilerApiHost){if(t==="Source"&&e.href.includes("tiles.json"))return e.href.replace("https://",`${m0}://`);if(t==="Tile"||t==="Glyphs")return e.href.replace("https://",`${g0}://`)}return e.href}let n_;async function AC(){return n_||(n_=await caches.open(iR)),n_}let Aw=0;async function lR(){const e=await AC(),t=await e.keys(),a=t.slice(0,Math.max(t.length-oR,0));for(const u of a)e.delete(u)}function uR(){Ew(m0,async(e,t)=>{if(!e.url)throw new Error("");e.url=e.url.replace(`${m0}://`,"https://");const a=e;a.signal=t.signal;const u=await fetch(e.url,a),f=await u.json();return f.tiles&&f.tiles.length>0&&(f.tiles[0]+=`&last-modified=${u.headers.get("Last-Modified")}`),{data:f,cacheControl:u.headers.get("Cache-Control"),expires:u.headers.get("Expires")}}),Ew(g0,async(e,t)=>{if(!e.url)throw new Error("");e.url=e.url.replace(`${g0}://`,"https://");const a=new URL(e.url),u=new URL(a);u.searchParams.delete("mtsid"),u.searchParams.delete("key");const f=u.toString(),v=new URL(a);v.searchParams.delete("last-modified");const x=v.toString(),h=async O=>({data:await O.arrayBuffer(),cacheControl:O.headers.get("Cache-Control"),expires:O.headers.get("Expires")}),z=await AC(),B=await z.match(f);if(B)return h(B);const Z=e;Z.signal=t.signal;const U=await fetch(x,Z);return U.status>=200&&U.status<300&&(z.put(f,U.clone()).catch(()=>{}),++Aw>aR&&(lR(),Aw=0)),h(U)})}function cR(){if(typeof window>"u")return;const e=lt.getRTLTextPluginStatus();if(e==="unavailable"||e==="requested")try{lt.setRTLTextPlugin(wi.rtlPluginURL,!0)}catch{}}function hR(e,t){for(const a of e)typeof t[a]=="function"&&(t[a]=t[a].bind(t))}function pc(e,t,a){const u=window.document.createElement(e);return t!==void 0&&(u.className=t),a&&a.appendChild(u),u}function PC(e){e.parentNode&&e.parentNode.removeChild(e)}function Pw(e,t){let a=null;try{a=new URL(e)}catch{return{url:e}}return a.host===wi.maptilerApiHost&&(a.searchParams.has("key")||a.searchParams.append("key",xn.apiKey),xn.session&&a.searchParams.append("mtsid",EC)),{url:sR(a,t)}}function Mw(e){return(t,a)=>{if(e!=null){const u=e(t,a),f=Pw((u==null?void 0:u.url)??"",a);return{...u,...f}}return Pw(t,a)}}function MC(){return Math.random().toString(36).substring(2)}function sg(e){return/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/gi.test(e)}function dR(e){try{return JSON.parse(e)}catch{}return null}function pR(){return document.createElement("canvas").getContext("webgl2")?null:typeof WebGL2RenderingContext<"u"?"Graphic rendering with WebGL2 has been disabled or is not supported by your graphic card. The map cannot be displayed.":"Your browser does not support graphic rendering with WebGL2. The map cannot be displayed."}function fR(e){const t=pR();if(!t)return;let a=null;if(typeof e=="string"?a=document.getElementById(e):e instanceof HTMLElement&&(a=e),!a)throw new Error("The Map container must be provided.");const u=document.createElement("div");throw u.innerHTML=t,u.classList.add("no-webgl-support-div"),a.appendChild(u),new Error(t)}(class extends lt.Marker{addTo(e){return super.addTo(e)}});class YR extends lt.Popup{addTo(t){return super.addTo(t)}}class JR extends lt.Style{constructor(t,a={}){super(t,a)}}class QR extends lt.CanvasSource{onAdd(t){super.onAdd(t)}}class eD extends lt.GeoJSONSource{onAdd(t){super.onAdd(t)}}class tD extends lt.ImageSource{onAdd(t){super.onAdd(t)}}class rD extends lt.RasterTileSource{onAdd(t){super.onAdd(t)}}class nD extends lt.RasterDEMTileSource{onAdd(t){super.onAdd(t)}}class iD extends lt.VectorTileSource{onAdd(t){super.onAdd(t)}}class oD extends lt.VideoSource{onAdd(t){super.onAdd(t)}}class mR extends lt.NavigationControl{onAdd(t){return super.onAdd(t)}}class gR extends lt.GeolocateControl{onAdd(t){return super.onAdd(t)}}class aD extends lt.AttributionControl{onAdd(t){return super.onAdd(t)}}class yR extends lt.LogoControl{onAdd(t){return super.onAdd(t)}}class _R extends lt.ScaleControl{onAdd(t){return super.onAdd(t)}}class vR extends lt.FullscreenControl{onAdd(t){return super.onAdd(t)}}class sD extends lt.TerrainControl{onAdd(t){return super.onAdd(t)}}class lD extends lt.BoxZoomHandler{constructor(t,a){super(t,a)}}class uD extends lt.ScrollZoomHandler{constructor(t,a){super(t,a)}}class cD extends lt.CooperativeGesturesHandler{constructor(t,a){super(t,a)}}class hD extends lt.KeyboardHandler{constructor(t){super(t)}}class dD extends lt.TwoFingersTouchPitchHandler{constructor(t){super(t)}}class pD extends lt.MapWheelEvent{constructor(t,a,u){super(t,a,u)}}class fD extends lt.MapTouchEvent{constructor(t,a,u){super(t,a,u)}}class mD extends lt.MapMouseEvent{constructor(t,a,u,f={}){super(t,a,u,f)}}class zw extends yR{constructor(t={}){super(t),mr(this,"logoURL",""),mr(this,"linkURL",""),this.logoURL=t.logoURL??wi.maptilerLogoURL,this.linkURL=t.linkURL??wi.maptilerURL}onAdd(t){this._map=t,this._compact=this.options.compact??!1,this._container=window.document.createElement("div"),this._container.className="maplibregl-ctrl";const a=window.document.createElement("a");return a.style.backgroundRepeat="no-repeat",a.style.cursor="pointer",a.style.display="block",a.style.height="23px",a.style.margin="0 0 -4px -4px",a.style.overflow="hidden",a.style.width="88px",a.style.backgroundImage=`url(${this.logoURL})`,a.style.backgroundSize="100px 30px",a.style.width="100px",a.style.height="30px",a.target="_blank",a.rel="noopener",a.href=this.linkURL,a.setAttribute("aria-label","MapTiler logo"),a.setAttribute("rel","noopener"),this._container.appendChild(a),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}}function Lw(e){return e?typeof e=="string"||e instanceof String?!e.startsWith("http")&&e.toLowerCase().includes(".json")?e:rC(e):e instanceof nC?e.getExpandedStyleURL():e instanceof iC?e.getDefaultVariant().getExpandedStyleURL():e:oC[d0[0].referenceStyleID].getDefaultVariant().getExpandedStyleURL()}class xR{constructor(){mr(this,"_map"),mr(this,"_container"),mr(this,"_terrainButton"),hR(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(t){return this._map=t,this._container=pc("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=pc("button","maplibregl-ctrl-terrain",this._container),pc("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){PC(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.hasTerrain()?this._map.disableTerrain():this._map.enableTerrain(),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.hasTerrain()?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))}}class bR extends mR{constructor(t={}){super({showCompass:t.showCompass??!0,showZoom:t.showZoom??!0,visualizePitch:t.visualizePitch??!0}),mr(this,"_rotateCompassArrow",()=>{const a=this.options.visualizePitch?`scale(${Math.min(1.5,1/Math.cos(this._map.transform.pitch*(Math.PI/180))**.5)}) rotateX(${Math.min(70,this._map.transform.pitch)}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=a}),this._compass&&(this._compass.removeEventListener("click",this._compass.clickFunction),this._compass.addEventListener("click",a=>{this._map.getPitch()===0?this._map.easeTo({pitch:Math.min(this._map.getMaxPitch(),80)}):this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:a}):this._map.resetNorth({},{originalEvent:a})}))}_createButton(t,a){const u=super._createButton(t,a);return u.clickFunction=a,u}}const Rw=lt.Marker,Dw=lt.LngLat,wR=lt.LngLatBounds;class SR extends gR{constructor(){super(...arguments),mr(this,"lastUpdatedCenter",new Dw(0,0)),mr(this,"_updateCamera",t=>{var a,u;const f=new Dw(t.coords.longitude,t.coords.latitude),v=t.coords.accuracy,x={bearing:this._map.getBearing(),...this.options.fitBoundsOptions,linear:!0},h=this._map.getZoom();h>(((u=(a=this.options)==null?void 0:a.fitBoundsOptions)==null?void 0:u.maxZoom)??30)&&(x.zoom=h),this._map.fitBounds(wR.fromLngLat(f,v),x,{geolocateSource:!0});let z=!1;const B=()=>{z=!0};this._map.once("click",B),this._map.once("dblclick",B),this._map.once("dragstart",B),this._map.once("mousedown",B),this._map.once("touchstart",B),this._map.once("wheel",B),this._map.once("moveend",()=>{this._map.off("click",B),this._map.off("dblclick",B),this._map.off("dragstart",B),this._map.off("mousedown",B),this._map.off("touchstart",B),this._map.off("wheel",B),!z&&(this.lastUpdatedCenter=this._map.getCenter())})}),mr(this,"_finishSetupUI",t=>{if(this._map){if(t===!1){const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}else{const a=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=pc("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Rw({element:this._dotElement}),this._circleElement=pc("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Rw({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("move",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("moveend",a=>{const u=a.originalEvent&&a.originalEvent.type==="resize",f=this.lastUpdatedCenter.distanceTo(this._map.getCenter());!a.geolocateSource&&this._watchState==="ACTIVE_LOCK"&&!u&&f>1&&(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new Event("trackuserlocationend")))})}}),mr(this,"_onZoom",()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()})}_updateCircleRadius(){if(this._watchState!=="BACKGROUND"&&this._watchState!=="ACTIVE_LOCK")return;const t=[this._lastKnownPosition.coords.longitude,this._lastKnownPosition.coords.latitude],a=this._map.project(t),u=this._map.unproject([a.x,a.y]),f=this._map.unproject([a.x+20,a.y]),v=u.distanceTo(f)/20,x=Math.ceil(2*this._accuracy/v);this._circleElement.style.width=`${x}px`,this._circleElement.style.height=`${x}px`}}var Hi,ia,Tl,Cl,mo,Rf,li,zC,go,LC;class i_{constructor(t,a){bl(this,li),bl(this,Hi),mr(this,"map"),bl(this,ia),bl(this,Tl),bl(this,Cl),bl(this,mo,!1),bl(this,Rf),t.style!==void 0&&Vu(this,mo,!0),Vu(this,Hi,{zoomAdjust:-4,position:"top-right",...a,forceNoAttributionControl:!0,attributionControl:!1,navigationControl:!1,geolocateControl:!1,maptilerLogo:!1,minimap:!1,hash:!1,pitchAdjust:!1,...t,containerStyle:{border:"1px solid #000",width:"400px",height:"300px",...t.containerStyle??{}}}),t.lockZoom!==void 0&&(jt(this,Hi).minZoom=t.lockZoom,jt(this,Hi).maxZoom=t.lockZoom)}setStyle(t,a){jt(this,mo)||this.map.setStyle(t,a),Gi(this,li,go).call(this)}addLayer(t,a){return jt(this,mo)||this.map.addLayer(t,a),Gi(this,li,go).call(this),this.map}moveLayer(t,a){return jt(this,mo)||this.map.moveLayer(t,a),Gi(this,li,go).call(this),this.map}removeLayer(t){return jt(this,mo)||this.map.removeLayer(t),Gi(this,li,go).call(this),this}setLayerZoomRange(t,a,u){return jt(this,mo)||this.map.setLayerZoomRange(t,a,u),Gi(this,li,go).call(this),this}setFilter(t,a,u){return jt(this,mo)||this.map.setFilter(t,a,u),Gi(this,li,go).call(this),this}setPaintProperty(t,a,u,f){return jt(this,mo)||this.map.setPaintProperty(t,a,u,f),Gi(this,li,go).call(this),this}setLayoutProperty(t,a,u,f){return jt(this,mo)||this.map.setLayoutProperty(t,a,u,f),Gi(this,li,go).call(this),this}setGlyphs(t,a){return jt(this,mo)||this.map.setGlyphs(t,a),Gi(this,li,go).call(this),this}onAdd(t){Vu(this,ia,t),Vu(this,Tl,pc("div","maplibregl-ctrl maplibregl-ctrl-group"));for(const[a,u]of Object.entries(jt(this,Hi).containerStyle))jt(this,Tl).style.setProperty(a,u);return jt(this,Hi).container=jt(this,Tl),jt(this,Hi).zoom=t.getZoom()+jt(this,Hi).zoomAdjust,this.map=new RC(jt(this,Hi)),this.map.once("style.load",()=>{this.map.resize()}),this.map.once("load",()=>{Gi(this,li,zC).call(this,jt(this,Hi).parentRect),Vu(this,Rf,Gi(this,li,LC).call(this))}),jt(this,Tl)}onRemove(){var t;(t=jt(this,Rf))==null||t.call(this),PC(jt(this,Tl))}}Hi=new WeakMap,ia=new WeakMap,Tl=new WeakMap,Cl=new WeakMap,mo=new WeakMap,Rf=new WeakMap,li=new WeakSet,zC=function(e){e===void 0||e.linePaint===void 0&&e.fillPaint===void 0||(Vu(this,Cl,{type:"Feature",properties:{name:"parentRect"},geometry:{type:"Polygon",coordinates:[[[],[],[],[],[]]]}}),this.map.addSource("parentRect",{type:"geojson",data:jt(this,Cl)}),(e.lineLayout!==void 0||e.linePaint!==void 0)&&this.map.addLayer({id:"parentRectOutline",type:"line",source:"parentRect",layout:{...e.lineLayout},paint:{"line-color":"#FFF","line-width":1,"line-opacity":.85,...e.linePaint}}),e.fillPaint!==void 0&&this.map.addLayer({id:"parentRectFill",type:"fill",source:"parentRect",layout:{},paint:{"fill-color":"#08F","fill-opacity":.135,...e.fillPaint}}),Gi(this,li,go).call(this))},go=function(){if(jt(this,Cl)===void 0)return;const{devicePixelRatio:e}=window,t=jt(this,ia).getCanvas(),a=t.width/e,u=t.height/e,f=jt(this,ia).unproject.bind(jt(this,ia)),v=f([0,0]),x=f([a,0]),h=f([0,u]),z=f([a,u]);jt(this,Cl).geometry.coordinates=[[h.toArray(),z.toArray(),x.toArray(),v.toArray(),h.toArray()]],this.map.getSource("parentRect").setData(jt(this,Cl))},LC=function(){const{pitchAdjust:e}=jt(this,Hi),t=()=>{v("parent")},a=()=>{v("minimap")},u=()=>{jt(this,ia).on("move",t),this.map.on("move",a)},f=()=>{jt(this,ia).off("move",t),this.map.off("move",a)},v=x=>{f();const h=x==="parent"?jt(this,ia):this.map,z=x==="parent"?this.map:jt(this,ia),B=h.getCenter(),Z=h.getZoom()+jt(this,Hi).zoomAdjust*(x==="parent"?1:-1),U=h.getBearing(),O=h.getPitch();z.jumpTo({center:B,zoom:Z,bearing:U,pitch:e?O:0}),Gi(this,li,go).call(this),u()};return u(),()=>{f()}};const TR={POINT:"POINT",COUNTRY:"COUNTRY"};class RC extends lt.Map{constructor(t){fR(t.container),t.apiKey&&(xn.apiKey=t.apiKey);const a=Lw(t.style),u=location.hash;xn.apiKey||console.warn("MapTiler Cloud API key is not set. Visit https://maptiler.com and try Cloud for free!");let f={compact:!1};t.customAttribution?f.customAttribution=t.customAttribution:t.attributionControl&&typeof t.attributionControl=="object"&&(f={...f,...t.attributionControl}),super({...t,style:a,maplibreLogo:!1,transformRequest:Mw(t.transformRequest),attributionControl:t.forceNoAttributionControl===!0?!1:f}),mr(this,"isTerrainEnabled",!1),mr(this,"terrainExaggeration",1),mr(this,"primaryLanguage"),mr(this,"terrainGrowing",!1),mr(this,"terrainFlattening",!1),mr(this,"minimap"),mr(this,"forceLanguageUpdate"),mr(this,"languageAlwaysBeenStyle"),mr(this,"isReady",!1),xn.caching&&!y0&&console.warn("The cache API is only available in secure contexts. More info at https://developer.mozilla.org/en-US/docs/Web/API/Cache"),xn.caching&&y0&&uR(),this.primaryLanguage=t.language??xn.primaryLanguage,this.forceLanguageUpdate=!(this.primaryLanguage===Zt.STYLE||this.primaryLanguage===Zt.STYLE_LOCK),this.languageAlwaysBeenStyle=this.primaryLanguage===Zt.STYLE,this.terrainExaggeration=t.terrainExaggeration??this.terrainExaggeration,this.once("styledata",async()=>{if(!t.geolocate||t.center||t.hash&&u)return;try{if(t.geolocate===TR.COUNTRY){await this.fitToIpBounds();return}}catch(Z){console.warn(Z.message)}let B;try{await this.centerOnIpPoint(t.zoom),B=this.getCameraHash()}catch(Z){console.warn(Z.message)}(await navigator.permissions.query({name:"geolocation"})).state==="granted"&&navigator.geolocation.getCurrentPosition(Z=>{B===this.getCameraHash()&&(this.terrain?this.easeTo({center:[Z.coords.longitude,Z.coords.latitude],zoom:t.zoom||12,duration:2e3}):this.once("terrain",()=>{this.easeTo({center:[Z.coords.longitude,Z.coords.latitude],zoom:t.zoom||12,duration:2e3})}))},null,{maximumAge:24*3600*1e3,timeout:5e3,enableHighAccuracy:!1})}),this.on("styledata",()=>{this.setPrimaryLanguage(this.primaryLanguage)}),this.on("styledata",()=>{this.getTerrain()===null&&this.isTerrainEnabled&&this.enableTerrain(this.terrainExaggeration)}),this.once("load",async()=>{let B={logo:null};try{const Z=Object.keys(this.style.sourceCaches).map(O=>this.getSource(O)).filter(O=>O&&"url"in O&&typeof O.url=="string"&&(O==null?void 0:O.url.includes("tiles.json"))),U=new URL(Z[0].url);U.searchParams.has("key")||U.searchParams.append("key",xn.apiKey),B=await(await fetch(U.href)).json()}catch{}if(t.forceNoAttributionControl!==!0)if("logo"in B&&B.logo){const Z=B.logo;this.addControl(new zw({logoURL:Z}),t.logoPosition)}else t.maptilerLogo&&this.addControl(new zw,t.logoPosition);if(t.scaleControl){const Z=t.scaleControl===!0||t.scaleControl===void 0?"bottom-right":t.scaleControl,U=new _R({unit:xn.unit});this.addControl(U,Z),xn.on("unit",O=>{U.setUnit(O)})}if(t.navigationControl!==!1){const Z=t.navigationControl===!0||t.navigationControl===void 0?"top-right":t.navigationControl;this.addControl(new bR,Z)}if(t.geolocateControl!==!1){const Z=t.geolocateControl===!0||t.geolocateControl===void 0?"top-right":t.geolocateControl;this.addControl(new SR({positionOptions:{enableHighAccuracy:!0,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!0,showAccuracyCircle:!0,showUserLocation:!0}),Z)}if(t.terrainControl){const Z=t.terrainControl===!0||t.terrainControl===void 0?"top-right":t.terrainControl;this.addControl(new xR,Z)}if(t.fullscreenControl){const Z=t.fullscreenControl===!0||t.fullscreenControl===void 0?"top-right":t.fullscreenControl;this.addControl(new vR({}),Z)}this.isReady=!0,this.fire("ready",{target:this})});let v=!1,x=!1,h;this.once("ready",()=>{v=!0,x&&this.fire("loadWithTerrain",h)}),this.once("style.load",()=>{const{minimap:B}=t;if(typeof B=="object"){const{zoom:Z,center:U,style:O,language:de,apiKey:he,maptilerLogo:ae,antialias:Ae,refreshExpiredTiles:te,maxBounds:H,scrollZoom:ie,minZoom:_e,maxZoom:Se,boxZoom:Ee,locale:ke,fadeDuration:Ze,crossSourceCollisions:mt,clickTolerance:tt,bounds:ot,fitBoundsOptions:$t,pixelRatio:It,validateStyle:Bt}=t;this.minimap=new i_(B,{zoom:Z,center:U,style:O,language:de,apiKey:he,container:"null",maptilerLogo:ae,antialias:Ae,refreshExpiredTiles:te,maxBounds:H,scrollZoom:ie,minZoom:_e,maxZoom:Se,boxZoom:Ee,locale:ke,fadeDuration:Ze,crossSourceCollisions:mt,clickTolerance:tt,bounds:ot,fitBoundsOptions:$t,pixelRatio:It,validateStyle:Bt}),this.addControl(this.minimap,B.position??"bottom-left")}else B===!0?(this.minimap=new i_({},t),this.addControl(this.minimap,"bottom-left")):B!==void 0&&B!==!1&&(this.minimap=new i_({},t),this.addControl(this.minimap,B))});const z=B=>{B.terrain&&(x=!0,h={type:"loadWithTerrain",target:this,terrain:B.terrain},this.off("terrain",z),v&&this.fire("loadWithTerrain",h))};this.on("terrain",z),t.terrain&&this.enableTerrain(t.terrainExaggeration??this.terrainExaggeration)}async onLoadAsync(){return new Promise(t=>{if(this.loaded())return t(this);this.once("load",()=>{t(this)})})}async onReadyAsync(){return new Promise(t=>{if(this.isReady)return t(this);this.once("ready",()=>{t(this)})})}async onLoadWithTerrainAsync(){return new Promise(t=>{if(this.isReady&&this.terrain)return t(this);this.once("loadWithTerrain",()=>{t(this)})})}setStyle(t,a){var u;return(u=this.minimap)==null||u.setStyle(t),this.forceLanguageUpdate=!0,this.once("idle",()=>{this.forceLanguageUpdate=!1}),super.setStyle(Lw(t),a)}addLayer(t,a){var u;return(u=this.minimap)==null||u.addLayer(t,a),super.addLayer(t,a)}moveLayer(t,a){var u;return(u=this.minimap)==null||u.moveLayer(t,a),super.moveLayer(t,a)}removeLayer(t){var a;return(a=this.minimap)==null||a.removeLayer(t),super.removeLayer(t)}setLayerZoomRange(t,a,u){var f;return(f=this.minimap)==null||f.setLayerZoomRange(t,a,u),super.setLayerZoomRange(t,a,u)}setFilter(t,a,u){var f;return(f=this.minimap)==null||f.setFilter(t,a,u),super.setFilter(t,a,u)}setPaintProperty(t,a,u,f){var v;return(v=this.minimap)==null||v.setPaintProperty(t,a,u,f),super.setPaintProperty(t,a,u,f)}setLayoutProperty(t,a,u,f){var v;return(v=this.minimap)==null||v.setLayoutProperty(t,a,u,f),super.setLayoutProperty(t,a,u,f)}setGlyphs(t,a){var u;return(u=this.minimap)==null||u.setGlyphs(t,a),super.setGlyphs(t,a)}getStyleLanguage(){return!this.style.stylesheet.metadata||typeof this.style.stylesheet.metadata!="object"?null:"maptiler:language"in this.style.stylesheet.metadata&&typeof this.style.stylesheet.metadata["maptiler:language"]=="string"?h0(this.style.stylesheet.metadata["maptiler:language"]):null}setLanguage(t){var a,u;(u=(a=this.minimap)==null?void 0:a.map)==null||u.setLanguage(t),this.onStyleReady(()=>{this.setPrimaryLanguage(t)})}setPrimaryLanguage(t){const a=this.getStyleLanguage(),u=C3(t,Zt);if(!u){console.warn(`The language "${u}" is not supported.`);return}if(!(u.flag===Zt.STYLE.flag&&a&&(a.flag===Zt.AUTO.flag||a.flag===Zt.VISITOR.flag))&&(u.flag!==Zt.STYLE.flag&&(this.languageAlwaysBeenStyle=!1),this.languageAlwaysBeenStyle||this.primaryLanguage===u&&!this.forceLanguageUpdate))return;if(this.primaryLanguage.flag===Zt.STYLE_LOCK.flag){console.warn("The language cannot be changed because this map has been instantiated with the STYLE_LOCK language flag.");return}this.primaryLanguage=u;let f=u;if(u.flag===Zt.STYLE.flag){if(!a){console.warn("The style has no default languages or has an invalid one.");return}f=a}let v=Zt.LOCAL.flag,x=`{${v}}`;f.flag===Zt.VISITOR.flag?(v=Iw().flag,x=["case",["all",["has",v],["has",Zt.LOCAL.flag]],["case",["==",["get",v],["get",Zt.LOCAL.flag]],["get",Zt.LOCAL.flag],["format",["get",v],{"font-scale":.8},`
`,["get",Zt.LOCAL.flag],{"font-scale":1.1}]],["get",Zt.LOCAL.flag]]):f.flag===Zt.VISITOR_ENGLISH.flag?(v=Zt.ENGLISH.flag,x=["case",["all",["has",v],["has",Zt.LOCAL.flag]],["case",["==",["get",v],["get",Zt.LOCAL.flag]],["get",Zt.LOCAL.flag],["format",["get",v],{"font-scale":.8},`
`,["get",Zt.LOCAL.flag],{"font-scale":1.1}]],["get",Zt.LOCAL.flag]]):f.flag===Zt.AUTO.flag?(v=Iw().flag,x=["case",["has",v],["get",v],["get",Zt.LOCAL.flag]]):f===Zt.LOCAL?(v=Zt.LOCAL.flag,x=`{${v}}`):(v=f.flag,x=["case",["has",v],["get",v],["get",Zt.LOCAL.flag]]);const{layers:h}=this.getStyle();for(const z of h){if(z.type!=="symbol")continue;const B=z,Z=this.getSource(B.source);if(!Z||!("url"in Z&&typeof Z.url=="string")||new URL(Z.url).host!==wi.maptilerApiHost)continue;const{id:U,layout:O}=B;if(!O||!("text-field"in O))continue;const de=this.getLayoutProperty(U,"text-field");typeof de=="string"&&(de.toLowerCase().includes("ref")||de.toLowerCase().includes("housenumber"))||this.setLayoutProperty(U,"text-field",x)}}getPrimaryLanguage(){return this.primaryLanguage}getTerrainExaggeration(){return this.terrainExaggeration}hasTerrain(){return this.isTerrainEnabled}growTerrain(t,a=1e3){if(!this.terrain)return;const u=performance.now(),f=this.terrain.exaggeration,v=t-f,x=()=>{if(!this.terrain||this.terrainFlattening)return;const h=(performance.now()-u)/a;if(h<.99){const z=1-(1-h)**4,B=f+z*v;this.terrain.exaggeration=B,requestAnimationFrame(x)}else this.terrainGrowing=!1,this.terrainFlattening=!1,this.terrain.exaggeration=t;this._elevationFreeze=!1,this.triggerRepaint()};this.terrainGrowing=!0,this.terrainFlattening=!1,requestAnimationFrame(x)}enableTerrain(t=this.terrainExaggeration){if(t<0){console.warn("Terrain exaggeration cannot be negative.");return}const a=async f=>{!this.terrain||f.type!=="data"||f.dataType!=="source"||!("source"in f)||f.sourceId!=="maptiler-terrain"||f.source.type!=="raster-dem"||f.isSourceLoaded&&(this.off("data",a),this.growTerrain(t))},u=()=>{this.isTerrainEnabled=!0,this.terrainExaggeration=t,this.on("data",a),this.addSource(wi.terrainSourceId,{type:"raster-dem",url:wi.terrainSourceURL}),this.setTerrain({source:wi.terrainSourceId,exaggeration:0})};if(this.getTerrain()){this.isTerrainEnabled=!0,this.growTerrain(t);return}this.loaded()||this.isTerrainEnabled?u():this.once("load",()=>{this.getTerrain()&&this.getSource(wi.terrainSourceId)||u()})}disableTerrain(){if(!this.terrain)return;this.isTerrainEnabled=!1;const t=1*1e3,a=performance.now(),u=this.terrain.exaggeration,f=()=>{if(!this.terrain||this.terrainGrowing)return;const v=(performance.now()-a)/t;if(this._elevationFreeze=!1,v<.99){const x=(1-v)**4,h=u*x;this.terrain.exaggeration=h,requestAnimationFrame(f)}else this.terrain.exaggeration=0,this.terrainGrowing=!1,this.terrainFlattening=!1,this.setTerrain(),this.getSource(wi.terrainSourceId)&&this.removeSource(wi.terrainSourceId);this.triggerRepaint()};this.terrainGrowing=!1,this.terrainFlattening=!0,requestAnimationFrame(f)}setTerrainExaggeration(t,a=!0){!a&&this.terrain?(this.terrainExaggeration=t,this.terrain.exaggeration=t,this.triggerRepaint()):this.enableTerrain(t)}onStyleReady(t){this.isStyleLoaded()?t():this.once("styledata",()=>{t()})}async fitToIpBounds(){const t=await _w.info();this.fitBounds(t.country_bounds,{duration:0,padding:100})}async centerOnIpPoint(t){const a=await _w.info();this.jumpTo({center:[(a==null?void 0:a.longitude)??0,(a==null?void 0:a.latitude)??0],zoom:t||11})}getCameraHash(){const t=new Float32Array(5),a=this.getCenter();return t[0]=a.lng,t[1]=a.lat,t[2]=this.getZoom(),t[3]=this.getPitch(),t[4]=this.getBearing(),eR.fromUint8Array(new Uint8Array(t.buffer))}getSdkConfig(){return xn}getMaptilerSessionId(){return EC}setTransformRequest(t){return super.setTransformRequest(Mw(t)),this}}function Uv(e){if(typeof DOMParser<"u"){const t=new DOMParser().parseFromString(e,"application/xml");if(t.querySelector("parsererror"))throw new Error("The provided string is not valid XML");return t}throw new Error("No XML parser found")}function DC(e,t){if(!e.hasChildNodes())return!1;for(const a of Array.from(e.childNodes)){const u=a.nodeName;if(typeof u=="string"&&u.trim().toLowerCase()===t.toLowerCase())return!0}return!1}function Fw(e){if(typeof XMLSerializer<"u")return new XMLSerializer().serializeToString(e);throw new Error("No XML serializer found")}function FC(e){const t=typeof e=="string"?Uv(e):e;if(!DC(t,"gpx"))throw new Error("The XML document is not valid GPX");const a=wn(t,"trk"),u=wn(t,"rte"),f=wn(t,"wpt"),v={type:"FeatureCollection",features:[]};for(const x of Array.from(a)){const h=ER(x);h&&v.features.push(h)}for(const x of Array.from(u)){const h=AR(x);h&&v.features.push(h)}for(const x of Array.from(f))v.features.push(PR(x));return v}function BC(e,t){let a=e;if(typeof a=="string"&&(a=Uv(a)),!DC(a,"kml"))throw new Error("The XML document is not valid KML");const u={type:"FeatureCollection",features:[]},f={},v={},x={},h=wn(a,"Placemark"),z=wn(a,"Style"),B=wn(a,"StyleMap");for(const Z of Array.from(z)){const U=Ow(Fw(Z)).toString(16);f[`#${Ll(Z,"id")}`]=U,v[U]=Z}for(const Z of Array.from(B)){f[`#${Ll(Z,"id")}`]=Ow(Fw(Z)).toString(16);const U=wn(Z,"Pair"),O={};for(const de of Array.from(U))O[rr(St(de,"key"))??""]=rr(St(de,"styleUrl"));x[`#${Ll(Z,"id")}`]=O}for(const Z of Array.from(h))u.features=u.features.concat(IR(Z,f,v,x));return u}function Bw(e){if(e===null)return["#000000",1];let t="",a=1,u=e;return u.substring(0,1)==="#"&&(u=u.substring(1)),(u.length===6||u.length===3)&&(t=u),u.length===8&&(a=Number.parseInt(u.substring(0,2),16)/255,t=`#${u.substring(6,8)}${u.substring(4,6)}${u.substring(2,4)}`),[t??"#000000",a??1]}function CR(e){return $C(e.split(" "))}function kR(e){let t=wn(e,"coord");const a=[],u=[];t.length===0&&(t=wn(e,"gx:coord"));for(const v of Array.from(t))a.push(CR(rr(v)??""));const f=wn(e,"when");for(const v of Array.from(f))u.push(rr(v));return{coords:a,times:u}}function Df(e){const t=["Polygon","LineString","Point","Track","gx:Track"];let a,u,f,v,x;const h=[],z=[];if(St(e,"MultiGeometry")!==null)return Df(St(e,"MultiGeometry"));if(St(e,"MultiTrack")!==null)return Df(St(e,"MultiTrack"));if(St(e,"gx:MultiTrack")!==null)return Df(St(e,"gx:MultiTrack"));for(f=0;f<t.length;f++)if(u=wn(e,t[f]),u){for(v=0;v<u.length;v++)if(a=u[v],t[f]==="Point")h.push({type:"Point",coordinates:UC(rr(St(a,"coordinates"))??"")});else if(t[f]==="LineString")h.push({type:"LineString",coordinates:$w(rr(St(a,"coordinates"))??"")});else if(t[f]==="Polygon"){const B=wn(a,"LinearRing"),Z=[];for(x=0;x<B.length;x++)Z.push($w(rr(St(B[x],"coordinates"))??""));h.push({type:"Polygon",coordinates:Z})}else if(t[f]==="Track"||t[f]==="gx:Track"){const B=kR(a);h.push({type:"LineString",coordinates:B.coords}),B.times.length&&z.push(B.times)}}return{geoms:h,coordTimes:z}}function IR(e,t,a,u){const f=Df(e),v={},x=rr(St(e,"name")),h=rr(St(e,"address")),z=rr(St(e,"description")),B=St(e,"TimeSpan"),Z=St(e,"TimeStamp"),U=St(e,"ExtendedData"),O=St(e,"visibility");let de,he=rr(St(e,"styleUrl")),ae=St(e,"LineStyle"),Ae=St(e,"PolyStyle");if(!f.geoms.length)return[];if(x&&(v.name=x),h&&(v.address=h),he){he[0]!=="#"&&(he=`#${he}`),v.styleUrl=he,t[he]&&(v.styleHash=t[he]),u[he]&&(v.styleMapHash=u[he],v.styleHash=t[u[he].normal??""]);const H=a[v.styleHash??""];if(H){ae||(ae=St(H,"LineStyle")),Ae||(Ae=St(H,"PolyStyle"));const ie=St(H,"IconStyle");if(ie){const _e=St(ie,"Icon");if(_e){const Se=rr(St(_e,"href"));Se&&(v.icon=Se)}}}}if(z&&(v.description=z),B){const H=rr(St(B,"begin")),ie=rr(St(B,"end"));H&&ie&&(v.timespan={begin:H,end:ie})}if(Z!==null&&(v.timestamp=rr(St(Z,"when"))??new Date().toISOString()),ae!==null){const H=Bw(rr(St(ae,"color"))),ie=H[0],_e=H[1],Se=Number.parseFloat(rr(St(ae,"width"))??"");ie&&(v.stroke=ie),Number.isNaN(_e)||(v["stroke-opacity"]=_e),Number.isNaN(Se)||(v["stroke-width"]=Se)}if(Ae){const H=Bw(rr(St(Ae,"color"))),ie=H[0],_e=H[1],Se=rr(St(Ae,"fill")),Ee=rr(St(Ae,"outline"));ie&&(v.fill=ie),Number.isNaN(_e)||(v["fill-opacity"]=_e),Se&&(v["fill-opacity"]=Se==="1"?v["fill-opacity"]||1:0),Ee&&(v["stroke-opacity"]=Ee==="1"?v["stroke-opacity"]||1:0)}if(U){const H=wn(U,"Data"),ie=wn(U,"SimpleData");for(de=0;de<H.length;de++)v[H[de].getAttribute("name")??""]=rr(St(H[de],"value"))??"";for(de=0;de<ie.length;de++)v[ie[de].getAttribute("name")??""]=rr(ie[de])??""}O!==null&&(v.visibility=rr(O)??""),f.coordTimes.length!==0&&(v.coordTimes=f.coordTimes.length===1?f.coordTimes[0]:f.coordTimes);const te={type:"Feature",geometry:f.geoms.length===1?f.geoms[0]:{type:"GeometryCollection",geometries:f.geoms},properties:v};return Ll(e,"id")&&(te.id=Ll(e,"id")??void 0),[te]}function OC(e,t){const a=wn(e,t),u=[],f=[];let v=[];const x=a.length;if(!(x<2)){for(let h=0;h<x;h++){const z=jC(a[h]);u.push(z.coordinates),z.time&&f.push(z.time),(z.heartRate||v.length)&&(v.length===0&&(v=new Array(h).fill(null)),v.push(z.heartRate))}return{line:u,times:f,heartRates:v}}}function ER(e){const t=wn(e,"trkseg"),a=[],u=[],f=[];let v;for(let h=0;h<t.length;h++)if(v=OC(t[h],"trkpt"),v!==void 0&&(v.line&&a.push(v.line),v.times&&v.times.length&&u.push(v.times),f.length||v.heartRates&&v.heartRates.length)){if(!f.length)for(let z=0;z<h;z++)f.push(new Array(a[z].length).fill(null));v.heartRates&&v.heartRates.length?f.push(v.heartRates):f.push(new Array(v.line.length).fill(null))}if(a.length===0)return;const x={...jv(e),...NC(St(e,"extensions"))};return u.length!==0&&(x.coordTimes=a.length===1?u[0]:u),f.length!==0&&(x.heartRates=a.length===1?f[0]:f),a.length===1?{type:"Feature",properties:x,geometry:{type:"LineString",coordinates:a[0]}}:{type:"Feature",properties:x,geometry:{type:"MultiLineString",coordinates:a}}}function AR(e){const t=OC(e,"rtept");return t===void 0?void 0:{type:"Feature",properties:{...jv(e),...NC(St(e,"extensions"))},geometry:{type:"LineString",coordinates:t.line}}}function PR(e){return{type:"Feature",properties:{...jv(e),..._0(e,["sym"])},geometry:{type:"Point",coordinates:jC(e).coordinates}}}function NC(e){const t={};if(e){const a=St(e,"line");if(a){const u=rr(St(a,"color")),f=Number.parseFloat(rr(St(a,"opacity"))??"0"),v=Number.parseFloat(rr(St(a,"width"))??"0");u&&(t.stroke=u),Number.isNaN(f)||(t["stroke-opacity"]=f),Number.isNaN(v)||(t["stroke-width"]=v*96/25.4)}}return t}function jv(e){const t=_0(e,["name","cmt","desc","type","time","keywords"]),a=wn(e,"link");if(a.length!==0){t.links=[];for(const u of Array.from(a)){const f={href:Ll(u,"href"),..._0(u,["text","type"])};t.links.push(f)}}return t}function Ow(e){let t=0;if(!e||!e.length)return t;for(let a=0;a<e.length;a++)t=(t<<5)-t+e.charCodeAt(a)|0;return t}function wn(e,t){return e.getElementsByTagName(t)}function Ll(e,t){return e.getAttribute(t)}function Nw(e,t){return Number.parseFloat(Ll(e,t)??"0")}function St(e,t){const a=wn(e,t);return a.length?a[0]:null}function MR(e){return e.normalize&&e.normalize(),e}function $C(e){return e.map(Number.parseFloat).map(t=>Number.isNaN(t)?null:t)}function rr(e){return e&&MR(e),e&&e.textContent}function _0(e,t){const a={};let u,f;for(f=0;f<t.length;f++)u=St(e,t[f]),u&&(a[t[f]]=rr(u)??"");return a}function UC(e){return $C(e.replace(/\s*/g,"").split(","))}function $w(e){const t=e.replace(/^\s*|\s*$/g,"").split(/\s+/),a=[];for(const u of t)a.push(UC(u));return a}function jC(e){const t=[Nw(e,"lon"),Nw(e,"lat")],a=St(e,"ele"),u=St(e,"gpxtpx:hr")||St(e,"hr"),f=St(e,"time");let v;return a&&(v=Number.parseFloat(rr(a)??"0"),Number.isNaN(v)||t.push(v)),{coordinates:t,time:f?rr(f):null,heartRate:u!==null?Number.parseFloat(rr(u)??"0"):null}}function zR(e){let t=e;try{typeof t=="string"&&(t=Uv(t))}catch{return null}try{return FC(t)}catch{}try{return BC(t)}catch{}return null}function ff(e){const t=e.toString(16);return t.length===1?`0${t}`:t}function LR(e){return`#${ff(e[0])}${ff(e[1])}${ff(e[2])}${e.length===4?ff(e[3]):""}`}class dt extends Array{constructor(t={}){super(),mr(this,"min",0),mr(this,"max",1),"min"in t&&(this.min=t.min),"max"in t&&(this.max=t.max),"stops"in t&&this.setStops(t.stops,{clone:!1})}static fromArrayDefinition(t){return new dt({stops:t.map(a=>({value:a[0],color:a[1]}))})}setStops(t,a={clone:!0}){const u=a.clone?this.clone():this;u.length=0;let f=Number.POSITIVE_INFINITY,v=Number.NEGATIVE_INFINITY;for(let x=0;x<t.length;x+=1)f=Math.min(f,t[x].value),v=Math.max(v,t[x].value),u.push({value:t[x].value,color:t[x].color.slice()});return u.sort((x,h)=>x.value<h.value?-1:1),this.min=f,this.max=v,u}scale(t,a,u={clone:!0}){const f=u.clone,v=this[0].value,x=this.at(-1).value-v,h=a-t,z=[];for(let B=0;B<this.length;B+=1){const Z=(this[B].value-v)/x*h+t;f?z.push({value:Z,color:this[B].color.slice()}):this[B].value=Z}return f?new dt({stops:z}):this}at(t){return t<0?this[this.length+t]:this[t]}clone(){return new dt({stops:this.getRawColorStops()})}getRawColorStops(){const t=[];for(let a=0;a<this.length;a+=1)t.push({value:this[a].value,color:this[a].color});return t}reverse(t={clone:!0}){const a=t.clone?this.clone():this;for(let u=0;u<~~(a.length/2);u+=1){const f=a[u].color;a[u].color=a.at(-(u+1)).color,a.at(-(u+1)).color=f}return a}getBounds(){return{min:this.min,max:this.max}}getColor(t,a={smooth:!0}){if(t<=this[0].value)return this[0].color;if(t>=this.at(-1).value)return this.at(-1).color;for(let u=0;u<this.length-1;u+=1){if(t>this[u+1].value)continue;const f=this[u].color;if(!a.smooth)return f.slice();const v=this[u].value,x=this[u+1].value,h=this[u+1].color,z=(x-t)/(x-v);return f.map((B,Z)=>Math.round(B*z+h[Z]*(1-z)))}return[0,0,0]}getColorHex(t,a={smooth:!0,withAlpha:!1}){return LR(this.getColor(t,a))}getColorRelative(t,a={smooth:!0}){const u=this.getBounds();return this.getColor(u.min+t*(u.max-u.min),a)}getCanvasStrip(t={horizontal:!0,size:512,smooth:!0}){const a=document.createElement("canvas");a.width=t.horizontal?t.size:1,a.height=t.horizontal?1:t.size;const u=a.getContext("2d");if(!u)throw new Error("Canvs context is missing");const f=u.getImageData(0,0,a.width,a.height),v=f.data,x=t.size,h=this[0].value,z=(this.at(-1).value-h)/x;for(let B=0;B<x;B+=1){const Z=this.getColor(h+B*z,{smooth:t.smooth});v[B*4]=Z[0],v[B*4+1]=Z[1],v[B*4+2]=Z[2],v[B*4+3]=Z.length>3?Z[3]:255}return u.putImageData(f,0,0),a}resample(t,a=15){const u=this.getBounds(),f=this.scale(0,1),v=1/(a-1);let x;if(t==="ease-in-square")x=Array.from({length:a},(h,z)=>{const B=z*v,Z=B**2,U=f.getColor(Z);return{value:B,color:U}});else if(t==="ease-out-square")x=Array.from({length:a},(h,z)=>{const B=z*v,Z=1-(1-B)**2,U=f.getColor(Z);return{value:B,color:U}});else if(t==="ease-out-sqrt")x=Array.from({length:a},(h,z)=>{const B=z*v,Z=B**.5,U=f.getColor(Z);return{value:B,color:U}});else if(t==="ease-in-sqrt")x=Array.from({length:a},(h,z)=>{const B=z*v,Z=1-(1-B)**.5,U=f.getColor(Z);return{value:B,color:U}});else if(t==="ease-out-exp")x=Array.from({length:a},(h,z)=>{const B=z*v,Z=1-2**(-10*B),U=f.getColor(Z);return{value:B,color:U}});else if(t==="ease-in-exp")x=Array.from({length:a},(h,z)=>{const B=z*v,Z=2**(10*B-10),U=f.getColor(Z);return{value:B,color:U}});else throw new Error("Invalid ressampling method.");return new dt({stops:x}).scale(u.min,u.max)}transparentStart(){const t=this.getRawColorStops();t.unshift({value:t[0].value,color:t[0].color.slice()}),t[1].value+=.001;for(const a of t)a.color.length===3&&a.color.push(255);return t[0].color[3]=0,new dt({stops:t})}hasTransparentStart(){return this[0].color.length===4&&this[0].color[3]===0}}const Vv={NULL:new dt({stops:[{value:0,color:[0,0,0,0]},{value:1,color:[0,0,0,0]}]}),GRAY:new dt({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),JET:new dt({stops:[{value:0,color:[0,0,131]},{value:.125,color:[0,60,170]},{value:.375,color:[5,255,255]},{value:.625,color:[255,255,0]},{value:.875,color:[250,0,0]},{value:1,color:[128,0,0]}]}),HSV:new dt({stops:[{value:0,color:[255,0,0]},{value:.169,color:[253,255,2]},{value:.173,color:[247,255,2]},{value:.337,color:[0,252,4]},{value:.341,color:[0,252,10]},{value:.506,color:[1,249,255]},{value:.671,color:[2,0,253]},{value:.675,color:[8,0,253]},{value:.839,color:[255,0,251]},{value:.843,color:[255,0,245]},{value:1,color:[255,0,6]}]}),HOT:new dt({stops:[{value:0,color:[0,0,0]},{value:.3,color:[230,0,0]},{value:.6,color:[255,210,0]},{value:1,color:[255,255,255]}]}),SPRING:new dt({stops:[{value:0,color:[255,0,255]},{value:1,color:[255,255,0]}]}),SUMMER:new dt({stops:[{value:0,color:[0,128,102]},{value:1,color:[255,255,102]}]}),AUTOMN:new dt({stops:[{value:0,color:[255,0,0]},{value:1,color:[255,255,0]}]}),WINTER:new dt({stops:[{value:0,color:[0,0,255]},{value:1,color:[0,255,128]}]}),BONE:new dt({stops:[{value:0,color:[0,0,0]},{value:.376,color:[84,84,116]},{value:.753,color:[169,200,200]},{value:1,color:[255,255,255]}]}),COPPER:new dt({stops:[{value:0,color:[0,0,0]},{value:.804,color:[255,160,102]},{value:1,color:[255,199,127]}]}),GREYS:new dt({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),YIGNBU:new dt({stops:[{value:0,color:[8,29,88]},{value:.125,color:[37,52,148]},{value:.25,color:[34,94,168]},{value:.375,color:[29,145,192]},{value:.5,color:[65,182,196]},{value:.625,color:[127,205,187]},{value:.75,color:[199,233,180]},{value:.875,color:[237,248,217]},{value:1,color:[255,255,217]}]}),GREENS:new dt({stops:[{value:0,color:[0,68,27]},{value:.125,color:[0,109,44]},{value:.25,color:[35,139,69]},{value:.375,color:[65,171,93]},{value:.5,color:[116,196,118]},{value:.625,color:[161,217,155]},{value:.75,color:[199,233,192]},{value:.875,color:[229,245,224]},{value:1,color:[247,252,245]}]}),YIORRD:new dt({stops:[{value:0,color:[128,0,38]},{value:.125,color:[189,0,38]},{value:.25,color:[227,26,28]},{value:.375,color:[252,78,42]},{value:.5,color:[253,141,60]},{value:.625,color:[254,178,76]},{value:.75,color:[254,217,118]},{value:.875,color:[255,237,160]},{value:1,color:[255,255,204]}]}),BLUERED:new dt({stops:[{value:0,color:[0,0,255]},{value:1,color:[255,0,0]}]}),RDBU:new dt({stops:[{value:0,color:[5,10,172]},{value:.35,color:[106,137,247]},{value:.5,color:[190,190,190]},{value:.6,color:[220,170,132]},{value:.7,color:[230,145,90]},{value:1,color:[178,10,28]}]}),PICNIC:new dt({stops:[{value:0,color:[0,0,255]},{value:.1,color:[51,153,255]},{value:.2,color:[102,204,255]},{value:.3,color:[153,204,255]},{value:.4,color:[204,204,255]},{value:.5,color:[255,255,255]},{value:.6,color:[255,204,255]},{value:.7,color:[255,153,255]},{value:.8,color:[255,102,204]},{value:.9,color:[255,102,102]},{value:1,color:[255,0,0]}]}),RAINBOW:new dt({stops:[{value:0,color:[150,0,90]},{value:.125,color:[0,0,200]},{value:.25,color:[0,25,255]},{value:.375,color:[0,152,255]},{value:.5,color:[44,255,150]},{value:.625,color:[151,255,0]},{value:.75,color:[255,234,0]},{value:.875,color:[255,111,0]},{value:1,color:[255,0,0]}]}),PORTLAND:new dt({stops:[{value:0,color:[12,51,131]},{value:.25,color:[10,136,186]},{value:.5,color:[242,211,56]},{value:.75,color:[242,143,56]},{value:1,color:[217,30,30]}]}),BLACKBODY:new dt({stops:[{value:0,color:[0,0,0]},{value:.2,color:[230,0,0]},{value:.4,color:[230,210,0]},{value:.7,color:[255,255,255]},{value:1,color:[160,200,255]}]}),EARTH:new dt({stops:[{value:0,color:[0,0,130]},{value:.1,color:[0,180,180]},{value:.2,color:[40,210,40]},{value:.4,color:[230,230,50]},{value:.6,color:[120,70,20]},{value:1,color:[255,255,255]}]}),ELECTRIC:new dt({stops:[{value:0,color:[0,0,0]},{value:.15,color:[30,0,100]},{value:.4,color:[120,0,100]},{value:.6,color:[160,90,0]},{value:.8,color:[230,200,0]},{value:1,color:[255,250,220]}]}),VIRIDIS:new dt({stops:[{value:0,color:[68,1,84]},{value:.13,color:[71,44,122]},{value:.25,color:[59,81,139]},{value:.38,color:[44,113,142]},{value:.5,color:[33,144,141]},{value:.63,color:[39,173,129]},{value:.75,color:[92,200,99]},{value:.88,color:[170,220,50]},{value:1,color:[253,231,37]}]}),INFERNO:new dt({stops:[{value:0,color:[0,0,4]},{value:.13,color:[31,12,72]},{value:.25,color:[85,15,109]},{value:.38,color:[136,34,106]},{value:.5,color:[186,54,85]},{value:.63,color:[227,89,51]},{value:.75,color:[249,140,10]},{value:.88,color:[249,201,50]},{value:1,color:[252,255,164]}]}),MAGMA:new dt({stops:[{value:0,color:[0,0,4]},{value:.13,color:[28,16,68]},{value:.25,color:[79,18,123]},{value:.38,color:[129,37,129]},{value:.5,color:[181,54,122]},{value:.63,color:[229,80,100]},{value:.75,color:[251,135,97]},{value:.88,color:[254,194,135]},{value:1,color:[252,253,191]}]}),PLASMA:new dt({stops:[{value:0,color:[13,8,135]},{value:.13,color:[75,3,161]},{value:.25,color:[125,3,168]},{value:.38,color:[168,34,150]},{value:.5,color:[203,70,121]},{value:.63,color:[229,107,93]},{value:.75,color:[248,148,65]},{value:.88,color:[253,195,40]},{value:1,color:[240,249,33]}]}),WARM:new dt({stops:[{value:0,color:[125,0,179]},{value:.13,color:[172,0,187]},{value:.25,color:[219,0,170]},{value:.38,color:[255,0,130]},{value:.5,color:[255,63,74]},{value:.63,color:[255,123,0]},{value:.75,color:[234,176,0]},{value:.88,color:[190,228,0]},{value:1,color:[147,255,0]}]}),COOL:new dt({stops:[{value:0,color:[125,0,179]},{value:.13,color:[116,0,218]},{value:.25,color:[98,74,237]},{value:.38,color:[68,146,231]},{value:.5,color:[0,204,197]},{value:.63,color:[0,247,146]},{value:.75,color:[0,255,88]},{value:.88,color:[40,255,8]},{value:1,color:[147,255,0]}]}),RAINBOW_SOFT:new dt({stops:[{value:0,color:[125,0,179]},{value:.1,color:[199,0,180]},{value:.2,color:[255,0,121]},{value:.3,color:[255,108,0]},{value:.4,color:[222,194,0]},{value:.5,color:[150,255,0]},{value:.6,color:[0,255,55]},{value:.7,color:[0,246,150]},{value:.8,color:[50,167,222]},{value:.9,color:[103,51,235]},{value:1,color:[124,0,186]}]}),BATHYMETRY:new dt({stops:[{value:0,color:[40,26,44]},{value:.13,color:[59,49,90]},{value:.25,color:[64,76,139]},{value:.38,color:[63,110,151]},{value:.5,color:[72,142,158]},{value:.63,color:[85,174,163]},{value:.75,color:[120,206,163]},{value:.88,color:[187,230,172]},{value:1,color:[253,254,204]}]}),CDOM:new dt({stops:[{value:0,color:[47,15,62]},{value:.13,color:[87,23,86]},{value:.25,color:[130,28,99]},{value:.38,color:[171,41,96]},{value:.5,color:[206,67,86]},{value:.63,color:[230,106,84]},{value:.75,color:[242,149,103]},{value:.88,color:[249,193,135]},{value:1,color:[254,237,176]}]}),CHLOROPHYLL:new dt({stops:[{value:0,color:[18,36,20]},{value:.13,color:[25,63,41]},{value:.25,color:[24,91,59]},{value:.38,color:[13,119,72]},{value:.5,color:[18,148,80]},{value:.63,color:[80,173,89]},{value:.75,color:[132,196,122]},{value:.88,color:[175,221,162]},{value:1,color:[215,249,208]}]}),DENSITY:new dt({stops:[{value:0,color:[54,14,36]},{value:.13,color:[89,23,80]},{value:.25,color:[110,45,132]},{value:.38,color:[120,77,178]},{value:.5,color:[120,113,213]},{value:.63,color:[115,151,228]},{value:.75,color:[134,185,227]},{value:.88,color:[177,214,227]},{value:1,color:[230,241,241]}]}),FREESURFACE_BLUE:new dt({stops:[{value:0,color:[30,4,110]},{value:.13,color:[47,14,176]},{value:.25,color:[41,45,236]},{value:.38,color:[25,99,212]},{value:.5,color:[68,131,200]},{value:.63,color:[114,156,197]},{value:.75,color:[157,181,203]},{value:.88,color:[200,208,216]},{value:1,color:[241,237,236]}]}),FREESURFACE_RED:new dt({stops:[{value:0,color:[60,9,18]},{value:.13,color:[100,17,27]},{value:.25,color:[142,20,29]},{value:.38,color:[177,43,27]},{value:.5,color:[192,87,63]},{value:.63,color:[205,125,105]},{value:.75,color:[216,162,148]},{value:.88,color:[227,199,193]},{value:1,color:[241,237,236]}]}),OXYGEN:new dt({stops:[{value:0,color:[64,5,5]},{value:.13,color:[106,6,15]},{value:.25,color:[144,26,7]},{value:.38,color:[168,64,3]},{value:.5,color:[188,100,4]},{value:.63,color:[206,136,11]},{value:.75,color:[220,174,25]},{value:.88,color:[231,215,44]},{value:1,color:[248,254,105]}]}),PAR:new dt({stops:[{value:0,color:[51,20,24]},{value:.13,color:[90,32,35]},{value:.25,color:[129,44,34]},{value:.38,color:[159,68,25]},{value:.5,color:[182,99,19]},{value:.63,color:[199,134,22]},{value:.75,color:[212,171,35]},{value:.88,color:[221,210,54]},{value:1,color:[225,253,75]}]}),PHASE:new dt({stops:[{value:0,color:[145,105,18]},{value:.13,color:[184,71,38]},{value:.25,color:[186,58,115]},{value:.38,color:[160,71,185]},{value:.5,color:[110,97,218]},{value:.63,color:[50,123,164]},{value:.75,color:[31,131,110]},{value:.88,color:[77,129,34]},{value:1,color:[145,105,18]}]}),SALINITY:new dt({stops:[{value:0,color:[42,24,108]},{value:.13,color:[33,50,162]},{value:.25,color:[15,90,145]},{value:.38,color:[40,118,137]},{value:.5,color:[59,146,135]},{value:.63,color:[79,175,126]},{value:.75,color:[120,203,104]},{value:.88,color:[193,221,100]},{value:1,color:[253,239,154]}]}),TEMPERATURE:new dt({stops:[{value:0,color:[4,35,51]},{value:.13,color:[23,51,122]},{value:.25,color:[85,59,157]},{value:.38,color:[129,79,143]},{value:.5,color:[175,95,130]},{value:.63,color:[222,112,101]},{value:.75,color:[249,146,66]},{value:.88,color:[249,196,65]},{value:1,color:[232,250,91]}]}),TURBIDITY:new dt({stops:[{value:0,color:[34,31,27]},{value:.13,color:[65,50,41]},{value:.25,color:[98,69,52]},{value:.38,color:[131,89,57]},{value:.5,color:[161,112,59]},{value:.63,color:[185,140,66]},{value:.75,color:[202,174,88]},{value:.88,color:[216,209,126]},{value:1,color:[233,246,171]}]}),VELOCITY_BLUE:new dt({stops:[{value:0,color:[17,32,64]},{value:.13,color:[35,52,116]},{value:.25,color:[29,81,156]},{value:.38,color:[31,113,162]},{value:.5,color:[50,144,169]},{value:.63,color:[87,173,176]},{value:.75,color:[149,196,189]},{value:.88,color:[203,221,211]},{value:1,color:[254,251,230]}]}),VELOCITY_GREEN:new dt({stops:[{value:0,color:[23,35,19]},{value:.13,color:[24,64,38]},{value:.25,color:[11,95,45]},{value:.38,color:[39,123,35]},{value:.5,color:[95,146,12]},{value:.63,color:[152,165,18]},{value:.75,color:[201,186,69]},{value:.88,color:[233,216,137]},{value:1,color:[255,253,205]}]}),CUBEHELIX:new dt({stops:[{value:0,color:[0,0,0]},{value:.07,color:[22,5,59]},{value:.13,color:[60,4,105]},{value:.2,color:[109,1,135]},{value:.27,color:[161,0,147]},{value:.33,color:[210,2,142]},{value:.4,color:[251,11,123]},{value:.47,color:[255,29,97]},{value:.53,color:[255,54,69]},{value:.6,color:[255,85,46]},{value:.67,color:[255,120,34]},{value:.73,color:[255,157,37]},{value:.8,color:[241,191,57]},{value:.87,color:[224,220,93]},{value:.93,color:[218,241,142]},{value:1,color:[227,253,198]}]}),CIVIDIS:new dt({stops:[{value:0,color:[0,32,77,255]},{value:.125,color:[5,54,110,255]},{value:.25,color:[65,77,108,255]},{value:.375,color:[97,100,111,255]},{value:.5,color:[125,124,121,255]},{value:.625,color:[156,149,120,255]},{value:.75,color:[190,175,111,255]},{value:.875,color:[225,204,94,255]},{value:1,color:[255,235,70,255]}]}),TURBO:new dt({stops:[{value:0,color:[48,18,59,255]},{value:.125,color:[70,107,227,255]},{value:.25,color:[40,187,236,255]},{value:.375,color:[49,242,153,255]},{value:.5,color:[162,252,60,255]},{value:.625,color:[237,208,58,255]},{value:.75,color:[251,128,34,255]},{value:.875,color:[210,49,5,255]},{value:1,color:[122,4,3,255]}]}),ROCKET:new dt({stops:[{value:0,color:[250,235,221,0]},{value:.133,color:[250,235,221,255]},{value:.266,color:[246,170,130,255]},{value:.4,color:[240,96,67,255]},{value:.533,color:[203,27,79,255]},{value:.666,color:[132,30,90,255]},{value:.8,color:[63,27,68,255]},{value:1,color:[3,5,26,255]}]}),MAKO:new dt({stops:[{value:0,color:[11,4,5,255]},{value:.125,color:[43,28,53,255]},{value:.25,color:[62,53,107,255]},{value:.375,color:[59,86,152,255]},{value:.5,color:[53,123,162,255]},{value:.625,color:[53,158,170,255]},{value:.75,color:[73,193,173,255]},{value:.875,color:[150,221,181,255]},{value:1,color:[222,245,229,255]}]})};async function RR(e,t={}){const a=t.download??!1,u=await DR(e);if(a){const f=t.filename??"maptiler_screenshot.png",v=document.createElement("a");v.style.display="none",document.body.appendChild(v),v.href=URL.createObjectURL(u),v.download=f,v.click(),setTimeout(()=>{document.body.removeChild(v),URL.revokeObjectURL(v.href)},0)}return u}function DR(e){return new Promise((t,a)=>{e.redraw(),e.once("idle",()=>{e.getCanvas().toBlob(u=>{if(!u)return a(Error("Screenshot could not be created."));t(u)},"image/png")})})}const Uw=[["#1D5B79","#468B97","#EF6262","#F3AA60"],["#614BC3","#33BBC5","#85E6C5","#C8FFE0"],["#461959","#7A316F","#CD6688","#AED8CC"],["#0079FF","#00DFA2","#F6FA70","#FF0060"],["#39B5E0","#A31ACB","#FF78F0","#F5EA5A"],["#37E2D5","#590696","#C70A80","#FBCB0A"],["#FFD36E","#FFF56D","#99FFCD","#9FB4FF"],["#00EAD3","#FFF5B7","#FF449F","#005F99"],["#10A19D","#540375","#FF7000","#FFBF00"]];function qv(){return Uw[~~(Math.random()*Uw.length)][~~(Math.random()*4)]}function lg(){return`maptiler_source_${MC()}`}function ug(){return`maptiler_layer_${MC()}`}function jw(e,t){if(t<=e[0].zoom)return e[0].value;if(t>=e[e.length-1].zoom)return e[e.length-1].value;for(let a=0;a<e.length-1;a+=1)if(t>=e[a].zoom&&t<e[a+1].zoom){const u=e[a+1].zoom-e[a].zoom,f=(t-e[a].zoom)/u;return f*e[a+1].value+(1-f)*e[a].value}return 0}function Rl(e){return["interpolate",["linear"],["zoom"],...e.flatMap(t=>[t.zoom,t.value])]}function nr(e){return["interpolate",["linear"],["zoom"],...e.flatMap(t=>[t.zoom,t.value])]}function FR(e,t){if(typeof t=="number"&&typeof e=="number")return 2*t+e;if(typeof t=="number"&&Array.isArray(e))return["interpolate",["linear"],["zoom"],...e.flatMap(a=>[a.zoom,2*t+a.value])];if(typeof e=="number"&&Array.isArray(t))return["interpolate",["linear"],["zoom"],...t.flatMap(a=>[a.zoom,2*a.value+e])];if(Array.isArray(e)&&Array.isArray(t)){const a=Array.from(new Set([...e.map(u=>u.zoom),...t.map(u=>u.zoom)])).sort((u,f)=>u<f?-1:1);return["interpolate",["linear"],["zoom"],...a.flatMap(u=>[u,2*jw(t,u)+jw(e,u)])]}return 0}function BR(e,t){return["interpolate",["linear"],["get",t],...e.flatMap(a=>[a.propertyValue,a.value])]}function VC(e){const t=e.trimStart(),a=`${t}${" ".repeat(e.length-t.length)}`,u=Array.from(a);if(!u.every(v=>v===" "||v==="_"))throw new Error("A dash pattern must be composed only of whitespace and underscore characters.");if(!(u.some(v=>v==="_")&&u.some(v=>v===" ")))throw new Error("A dash pattern must contain at least one underscore and one whitespace character");const f=[1];for(let v=1;v<u.length;v+=1){const x=u[v-1],h=u[v];x===h?f[f.length-1]+=1:f.push(1)}return f}function Vw(e,t){return["interpolate",["linear"],["get",t],...e.flatMap(a=>[a.value,a.color])]}function qw(e,t,a=!0){return a?["interpolate",["linear"],["zoom"],0,["interpolate",["linear"],["get",t],...e.flatMap(u=>[u.value,u.pointRadius*.025])],2,["interpolate",["linear"],["get",t],...e.flatMap(u=>[u.value,u.pointRadius*.05])],4,["interpolate",["linear"],["get",t],...e.flatMap(u=>[u.value,u.pointRadius*.1])],8,["interpolate",["linear"],["get",t],...e.flatMap(u=>[u.value,u.pointRadius*.25])],16,["interpolate",["linear"],["get",t],...e.flatMap(u=>[u.value,u.pointRadius])]]:["interpolate",["linear"],["get",t],...e.flatMap(u=>[u.value,u.pointRadius])]}function OR(e,t,a=!0){return a?["interpolate",["linear"],["zoom"],0,["interpolate",["linear"],["get",t],...e.flatMap(u=>[u.propertyValue,u.value*.025])],2,["interpolate",["linear"],["get",t],...e.flatMap(u=>[u.propertyValue,u.value*.05])],4,["interpolate",["linear"],["get",t],...e.flatMap(u=>[u.propertyValue,u.value*.1])],8,["interpolate",["linear"],["get",t],...e.flatMap(u=>[u.propertyValue,u.value*.25])],16,["interpolate",["linear"],["get",t],...e.flatMap(u=>[u.propertyValue,u.value])]]:["interpolate",["linear"],["get",t],...e.flatMap(u=>[u.propertyValue,u.value])]}function Zw(e,t){return e.every(a=>a.color[3]===e[0].color[3])?e[0].color[3]?e[0].color[3]/255:1:["interpolate",["linear"],["get",t],...e.getRawColorStops().flatMap(a=>{const u=a.value,f=a.color;return[u,f.length===4?f[3]/255:1]})]}function NR(e,t=10){return["interpolate",["linear"],["heatmap-density"],...Array.from({length:t+1},(a,u)=>{const f=u/t;return[f,e.getColorHex(f)]}).flat()]}async function $R(e,t,a={}){var u,f;if(!t.sourceId&&!t.data)throw new Error("Creating a polyline layer requires an existing .sourceId or a valid .data property");let v=t.data;if(typeof v=="string"){if(sg(v))v=`https://api.maptiler.com/data/${t.data}/features.json?key=${xn.apiKey}`;else if(((u=v.split(".").pop())==null?void 0:u.toLowerCase().trim())==="gpx"){const x=await(await fetch(v,a)).text();v=FC(x)}else if(((f=v.split(".").pop())==null?void 0:f.toLowerCase().trim())==="kml"){const x=await(await fetch(v,a)).text();v=BC(x)}else{const x=dR(v)??zR(v);x&&(v=x)}if(!v)throw new Error("Polyline data was provided as string but is incompatible with valid formats.")}return UR(e,{...t,data:v})}function UR(e,t){if(t.layerId&&e.getLayer(t.layerId))throw new Error(`A layer already exists with the layer id: ${t.layerId}`);const a=t.sourceId??lg(),u=t.layerId??ug(),f={polylineLayerId:u,polylineOutlineLayerId:"",polylineSourceId:a};t.data&&!e.getSource(a)&&e.addSource(a,{type:"geojson",data:t.data});const v=t.lineWidth??3,x=t.lineColor??qv(),h=t.lineOpacity??1,z=t.lineBlur??0,B=t.lineGapWidth??0;let Z=t.lineDashArray??null;const U=t.outlineWidth??1,O=t.outlineColor??"#FFFFFF",de=t.outlineOpacity??1,he=t.outlineBlur??0;if(typeof Z=="string"&&(Z=VC(Z)),t.outline===!0){const ae=`${u}_outline`;f.polylineOutlineLayerId=ae,e.addLayer({id:ae,type:"line",source:a,layout:{"line-join":t.lineJoin??"round","line-cap":t.lineCap??"round"},minzoom:t.minzoom??0,maxzoom:t.maxzoom??23,paint:{"line-opacity":typeof de=="number"?de:nr(de),"line-color":typeof O=="string"?O:Rl(O),"line-width":FR(v,U),"line-blur":typeof he=="number"?he:nr(he)}},t.beforeId)}return e.addLayer({id:u,type:"line",source:a,layout:{"line-join":t.lineJoin??"round","line-cap":t.lineCap??"round"},minzoom:t.minzoom??0,maxzoom:t.maxzoom??23,paint:{"line-opacity":typeof h=="number"?h:nr(h),"line-color":typeof x=="string"?x:Rl(x),"line-width":typeof v=="number"?v:nr(v),"line-blur":typeof z=="number"?z:nr(z),"line-gap-width":typeof B=="number"?B:nr(B),...Z&&{"line-dasharray":Z}}},t.beforeId),f}function jR(e,t){if(t.layerId&&e.getLayer(t.layerId))throw new Error(`A layer already exists with the layer id: ${t.layerId}`);const a=t.sourceId??lg(),u=t.layerId??ug(),f={polygonLayerId:u,polygonOutlineLayerId:t.outline?`${u}_outline`:"",polygonSourceId:a};if(t.data&&!e.getSource(a)){let ae=t.data;typeof ae=="string"&&sg(ae)&&(ae=`https://api.maptiler.com/data/${ae}/features.json?key=${xn.apiKey}`),e.addSource(a,{type:"geojson",data:ae})}let v=t.outlineDashArray??null;const x=t.outlineWidth??1,h=t.outlineColor??"#FFFFFF",z=t.outlineOpacity??1,B=t.outlineBlur??0,Z=t.fillColor??qv(),U=t.fillOpacity??1,O=t.outlinePosition??"center",de=t.pattern??null;typeof v=="string"&&(v=VC(v));const he=(ae=null)=>{if(e.addLayer({id:u,type:"fill",source:a,minzoom:t.minzoom??0,maxzoom:t.maxzoom??23,paint:{"fill-color":typeof Z=="string"?Z:Rl(Z),"fill-opacity":typeof U=="number"?U:nr(U),...ae&&{"fill-pattern":ae}}},t.beforeId),t.outline===!0){let Ae;O==="inside"?typeof x=="number"?Ae=.5*x:Ae=nr(x.map(({zoom:te,value:H})=>({zoom:te,value:.5*H}))):O==="outside"?typeof x=="number"?Ae=-.5*x:Ae=nr(x.map(te=>({zoom:te.zoom,value:-.5*te.value}))):Ae=0,e.addLayer({id:f.polygonOutlineLayerId,type:"line",source:a,layout:{"line-join":t.outlineJoin??"round","line-cap":t.outlineCap??"butt"},minzoom:t.minzoom??0,maxzoom:t.maxzoom??23,paint:{"line-opacity":typeof z=="number"?z:nr(z),"line-color":typeof h=="string"?h:Rl(h),"line-width":typeof x=="number"?x:nr(x),"line-blur":typeof B=="number"?B:nr(B),"line-offset":Ae,...v&&{"line-dasharray":v}}},t.beforeId)}};return de?e.hasImage(de)?he(de):e.loadImage(de).then(ae=>{e.addImage(de,ae.data),he(de)}).catch(ae=>(console.error("Could not load the pattern image.",ae.message),he())):he(),f}function VR(e,t){if(t.layerId&&e.getLayer(t.layerId))throw new Error(`A layer already exists with the layer id: ${t.layerId}`);const a=t.minPointRadius??10,u=t.maxPointRadius??50,f=t.cluster??!1,v=20,x=Array.isArray(t.pointColor)?t.pointColor:Vv.TURBO.scale(10,t.cluster?1e4:1e3).resample("ease-out-square"),h=x.getBounds(),z=t.sourceId??lg(),B=t.layerId??ug(),Z=t.showLabel??f,U=t.alignOnViewport??!0,O=t.outline??!1,de=t.outlineOpacity??1,he=t.outlineWidth??1,ae=t.outlineColor??"#FFFFFF";let Ae;const te=t.zoomCompensation??!0,H=t.minzoom??0,ie=t.maxzoom??23;typeof t.pointOpacity=="number"?Ae=t.pointOpacity:Array.isArray(t.pointOpacity)?Ae=nr(t.pointOpacity):t.cluster?Ae=Zw(x,"point_count"):t.property?Ae=Zw(x,t.property):Ae=nr([{zoom:H,value:0},{zoom:H+.25,value:1},{zoom:ie-.25,value:1},{zoom:ie,value:0}]);const _e={pointLayerId:B,clusterLayerId:"",labelLayerId:"",pointSourceId:z};if(t.data&&!e.getSource(z)){let Se=t.data;typeof Se=="string"&&sg(Se)&&(Se=`https://api.maptiler.com/data/${Se}/features.json?key=${xn.apiKey}`),e.addSource(z,{type:"geojson",data:Se,cluster:f})}if(f){_e.clusterLayerId=`${B}_cluster`;const Se=Array.from({length:v},(Ee,ke)=>{const Ze=h.min+ke*(h.max-h.min)/(v-1);return{value:Ze,pointRadius:a+(u-a)*(ke/(v-1))**.5,color:x.getColorHex(Ze)}});e.addLayer({id:_e.clusterLayerId,type:"circle",source:z,filter:["has","point_count"],paint:{"circle-color":typeof t.pointColor=="string"?t.pointColor:Vw(Se,"point_count"),"circle-radius":typeof t.pointRadius=="number"?t.pointRadius:Array.isArray(t.pointRadius)?nr(t.pointRadius):qw(Se,"point_count",!1),"circle-pitch-alignment":U?"viewport":"map","circle-pitch-scale":"map","circle-opacity":Ae,...O&&{"circle-stroke-opacity":typeof de=="number"?de:nr(de),"circle-stroke-width":typeof he=="number"?he:nr(he),"circle-stroke-color":typeof ae=="string"?ae:Rl(ae)}},minzoom:H,maxzoom:ie},t.beforeId),e.addLayer({id:_e.pointLayerId,type:"circle",source:z,filter:["!",["has","point_count"]],paint:{"circle-pitch-alignment":U?"viewport":"map","circle-pitch-scale":"map","circle-color":typeof t.pointColor=="string"?t.pointColor:x.getColorHex(x.getBounds().min),"circle-radius":typeof t.pointRadius=="number"?t.pointRadius:Array.isArray(t.pointRadius)?nr(t.pointRadius):Se[0].pointRadius*.75,"circle-opacity":Ae,...O&&{"circle-stroke-opacity":typeof de=="number"?de:nr(de),"circle-stroke-width":typeof he=="number"?he:nr(he),"circle-stroke-color":typeof ae=="string"?ae:Rl(ae)}},minzoom:H,maxzoom:ie},t.beforeId)}else{let Se=typeof t.pointColor=="string"?t.pointColor:Array.isArray(t.pointColor)?t.pointColor.getColorHex(t.pointColor.getBounds().min):qv(),Ee=typeof t.pointRadius=="number"?te?nr([{zoom:0,value:t.pointRadius*.025},{zoom:2,value:t.pointRadius*.05},{zoom:4,value:t.pointRadius*.1},{zoom:8,value:t.pointRadius*.25},{zoom:16,value:t.pointRadius*1}]):t.pointRadius:Array.isArray(t.pointRadius)?nr(t.pointRadius):te?nr([{zoom:0,value:a*.05},{zoom:2,value:a*.1},{zoom:4,value:a*.2},{zoom:8,value:a*.5},{zoom:16,value:a*1}]):a;if(t.property&&Array.isArray(t.pointColor)){const ke=Array.from({length:v},(Ze,mt)=>{const tt=h.min+mt*(h.max-h.min)/(v-1);return{value:tt,pointRadius:typeof t.pointRadius=="number"?t.pointRadius:a+(u-a)*(mt/(v-1))**.5,color:typeof t.pointColor=="string"?t.pointColor:x.getColorHex(tt)}});Se=Vw(ke,t.property),Ee=qw(ke,t.property,te)}e.addLayer({id:_e.pointLayerId,type:"circle",source:z,layout:{"circle-sort-key":t.property?["/",1,["get",t.property]]:0},paint:{"circle-pitch-alignment":U?"viewport":"map","circle-pitch-scale":"map","circle-color":Se,"circle-opacity":Ae,"circle-radius":Ee,...O&&{"circle-stroke-opacity":typeof de=="number"?de:nr(de),"circle-stroke-width":typeof he=="number"?he:nr(he),"circle-stroke-color":typeof ae=="string"?ae:Rl(ae)}},minzoom:H,maxzoom:ie},t.beforeId)}if(Z!==!1&&(t.cluster||t.property)){_e.labelLayerId=`${B}_label`;const Se=t.labelColor??"#fff",Ee=t.labelSize??12;e.addLayer({id:_e.labelLayerId,type:"symbol",source:z,filter:["has",t.cluster?"point_count":t.property],layout:{"text-field":t.cluster?"{point_count_abbreviated}":`{${t.property}}`,"text-font":["Noto Sans Regular"],"text-size":Ee,"text-pitch-alignment":U?"viewport":"map","symbol-sort-key":["/",1,["get",t.cluster?"point_count":t.property]]},paint:{"text-color":Se,"text-opacity":Ae},minzoom:H,maxzoom:ie},t.beforeId)}return _e}function qR(e,t){if(t.layerId&&e.getLayer(t.layerId))throw new Error(`A layer already exists with the layer id: ${t.layerId}`);const a=t.sourceId??lg(),u=t.layerId??ug(),f=t.minzoom??0,v=t.maxzoom??23,x=t.zoomCompensation??!0,h=t.opacity??[{zoom:f,value:0},{zoom:f+.25,value:1},{zoom:v-.25,value:1},{zoom:v,value:0}];let z=Array.isArray(t.colorRamp)?t.colorRamp:Vv.TURBO.transparentStart();const B=z.getBounds();(B.min!==0||B.max!==1)&&(z=z.scale(0,1)),z.hasTransparentStart()||(z=z.transparentStart());const Z=t.intensity??[{zoom:0,value:.01},{zoom:4,value:.2},{zoom:16,value:1}],U=t.property??null,O=t.weight??1;let de=1;U?typeof O=="number"?(de=O,typeof t.weight=="number"&&console.warn("The option `.property` is ignored when `.propertyValueWeights` is not of type `PropertyValueWeights`")):Array.isArray(O)?de=BR(O,U):console.warn("The option `.property` is ignored when `.propertyValueWeights` is not of type `PropertyValueWeights`"):typeof O=="number"?de=O:Array.isArray(O)&&console.warn("The options `.propertyValueWeights` can only be used when `.property` is provided.");const he=[{zoom:0,value:50*.025},{zoom:2,value:50*.05},{zoom:4,value:50*.1},{zoom:8,value:50*.25},{zoom:16,value:50}],ae=t.radius??(x?he:10);let Ae=1;typeof ae=="number"?Ae=ae:Array.isArray(ae)&&"zoom"in ae[0]?Ae=nr(ae):U&&Array.isArray(ae)&&"propertyValue"in ae[0]?Ae=OR(ae,U,x):!U&&Array.isArray(ae)&&"propertyValue"in ae[0]?(Ae=nr(he),console.warn("The option `.radius` can only be property-driven if the option `.property` is provided.")):Ae=nr(he);const te={heatmapLayerId:u,heatmapSourceId:a};if(t.data&&!e.getSource(a)){let H=t.data;typeof H=="string"&&sg(H)&&(H=`https://api.maptiler.com/data/${H}/features.json?key=${xn.apiKey}`),e.addSource(a,{type:"geojson",data:H})}return e.addLayer({id:u,type:"heatmap",source:a,minzoom:f,maxzoom:v,paint:{"heatmap-weight":de,"heatmap-intensity":typeof Z=="number"?Z:nr(Z),"heatmap-color":NR(z),"heatmap-radius":Ae,"heatmap-opacity":typeof h=="number"?h:nr(h)}},t.beforeId),te}const ZR={addPolyline:$R,addPolygon:jR,addPoint:VR,addHeatmap:qR,takeScreenshot:RR};cR();lt.Map;lt.Marker;lt.Popup;lt.Style;lt.CanvasSource;lt.GeoJSONSource;lt.ImageSource;lt.RasterTileSource;lt.RasterDEMTileSource;lt.VectorTileSource;lt.VideoSource;lt.NavigationControl;lt.GeolocateControl;lt.AttributionControl;lt.LogoControl;lt.ScaleControl;lt.FullscreenControl;lt.TerrainControl;lt.BoxZoomHandler;lt.ScrollZoomHandler;lt.CooperativeGesturesHandler;lt.KeyboardHandler;lt.TwoFingersTouchPitchHandler;lt.MapWheelEvent;lt.MapTouchEvent;lt.MapMouseEvent;lt.config;lt.getVersion;const GR=Za("MuiBox",["root"]),HR=GT(),WR=vL({themeId:HT,defaultTheme:HR,defaultClassName:GR.root,generateClassName:Pv.generate}),Gw={MAPTILER_API_KEY:"kf8ePBTXLGCU7i6Ij3Bs",MAPTILER_DATASET_ID:"57ce7daa-ea5b-4cd6-8975-32c41f5c5d90"};function KR(){const e=He.useRef(null),t=He.useRef(null),a=Gw.MAPTILER_DATASET_ID,u={lng:-157.9253,lat:21.4732},f=9.79;return xn.apiKey=Gw.MAPTILER_API_KEY,He.useEffect(()=>{t.current||(t.current=new RC({container:e.current,style:oC.DATAVIZ.LIGHT,center:[u.lng,u.lat],zoom:f,hash:!0}),t.current.on("load",()=>{ZR.addPoint(t.current,{data:a,pointColor:Vv.COOL.scale(0,30),property:"minimum_nights",pointOpacity:.5,showLabel:!0,labelColor:"black"})}))},[u.lng,u.lat,f]),Kt.jsxs(WR,{sx:{display:"flex"},children:[Kt.jsx(v3,{}),Kt.jsx("div",{className:"container",children:Kt.jsx("div",{ref:e,id:"map",className:"map"})})]})}function XR(){return Kt.jsx("div",{className:"App",children:Kt.jsx(KR,{})})}a_.createRoot(document.getElementById("root")).render(Kt.jsx(kl.StrictMode,{children:Kt.jsx(XR,{})}));
