function DI(e,t){for(var s=0;s<t.length;s++){const l=t[s];if(typeof l!="string"&&!Array.isArray(l)){for(const f in l)if(f!=="default"&&!(f in e)){const y=Object.getOwnPropertyDescriptor(l,f);y&&Object.defineProperty(e,f,y.get?y:{enumerable:!0,get:()=>l[f]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))l(f);new MutationObserver(f=>{for(const y of f)if(y.type==="childList")for(const x of y.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&l(x)}).observe(document,{childList:!0,subtree:!0});function s(f){const y={};return f.integrity&&(y.integrity=f.integrity),f.referrerPolicy&&(y.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?y.credentials="include":f.crossOrigin==="anonymous"?y.credentials="omit":y.credentials="same-origin",y}function l(f){if(f.ep)return;f.ep=!0;const y=s(f);fetch(f.href,y)}})();var FI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Fm(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Qs(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var s=function l(){return this instanceof l?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};s.prototype=t.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(e).forEach(function(l){var f=Object.getOwnPropertyDescriptor(e,l);Object.defineProperty(s,l,f.get?f:{enumerable:!0,get:function(){return e[l]}})}),s}var D2={exports:{}},Bm={},F2={exports:{}},Vt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kd=Symbol.for("react.element"),BI=Symbol.for("react.portal"),OI=Symbol.for("react.fragment"),NI=Symbol.for("react.strict_mode"),$I=Symbol.for("react.profiler"),jI=Symbol.for("react.provider"),UI=Symbol.for("react.context"),VI=Symbol.for("react.forward_ref"),GI=Symbol.for("react.suspense"),qI=Symbol.for("react.memo"),HI=Symbol.for("react.lazy"),lb=Symbol.iterator;function ZI(e){return e===null||typeof e!="object"?null:(e=lb&&e[lb]||e["@@iterator"],typeof e=="function"?e:null)}var B2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},O2=Object.assign,N2={};function Du(e,t,s){this.props=e,this.context=t,this.refs=N2,this.updater=s||B2}Du.prototype.isReactComponent={};Du.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Du.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function $2(){}$2.prototype=Du.prototype;function K0(e,t,s){this.props=e,this.context=t,this.refs=N2,this.updater=s||B2}var X0=K0.prototype=new $2;X0.constructor=K0;O2(X0,Du.prototype);X0.isPureReactComponent=!0;var cb=Array.isArray,j2=Object.prototype.hasOwnProperty,Y0={current:null},U2={key:!0,ref:!0,__self:!0,__source:!0};function V2(e,t,s){var l,f={},y=null,x=null;if(t!=null)for(l in t.ref!==void 0&&(x=t.ref),t.key!==void 0&&(y=""+t.key),t)j2.call(t,l)&&!U2.hasOwnProperty(l)&&(f[l]=t[l]);var u=arguments.length-2;if(u===1)f.children=s;else if(1<u){for(var P=Array(u),L=0;L<u;L++)P[L]=arguments[L+2];f.children=P}if(e&&e.defaultProps)for(l in u=e.defaultProps,u)f[l]===void 0&&(f[l]=u[l]);return{$$typeof:Kd,type:e,key:y,ref:x,props:f,_owner:Y0.current}}function WI(e,t){return{$$typeof:Kd,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function J0(e){return typeof e=="object"&&e!==null&&e.$$typeof===Kd}function KI(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(s){return t[s]})}var ub=/\/+/g;function Qy(e,t){return typeof e=="object"&&e!==null&&e.key!=null?KI(""+e.key):t.toString(36)}function Bf(e,t,s,l,f){var y=typeof e;(y==="undefined"||y==="boolean")&&(e=null);var x=!1;if(e===null)x=!0;else switch(y){case"string":case"number":x=!0;break;case"object":switch(e.$$typeof){case Kd:case BI:x=!0}}if(x)return x=e,f=f(x),e=l===""?"."+Qy(x,0):l,cb(f)?(s="",e!=null&&(s=e.replace(ub,"$&/")+"/"),Bf(f,t,s,"",function(L){return L})):f!=null&&(J0(f)&&(f=WI(f,s+(!f.key||x&&x.key===f.key?"":(""+f.key).replace(ub,"$&/")+"/")+e)),t.push(f)),1;if(x=0,l=l===""?".":l+":",cb(e))for(var u=0;u<e.length;u++){y=e[u];var P=l+Qy(y,u);x+=Bf(y,t,s,P,f)}else if(P=ZI(e),typeof P=="function")for(e=P.call(e),u=0;!(y=e.next()).done;)y=y.value,P=l+Qy(y,u++),x+=Bf(y,t,s,P,f);else if(y==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return x}function hf(e,t,s){if(e==null)return e;var l=[],f=0;return Bf(e,l,"","",function(y){return t.call(s,y,f++)}),l}function XI(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(s){(e._status===0||e._status===-1)&&(e._status=1,e._result=s)},function(s){(e._status===0||e._status===-1)&&(e._status=2,e._result=s)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var vi={current:null},Of={transition:null},YI={ReactCurrentDispatcher:vi,ReactCurrentBatchConfig:Of,ReactCurrentOwner:Y0};function G2(){throw Error("act(...) is not supported in production builds of React.")}Vt.Children={map:hf,forEach:function(e,t,s){hf(e,function(){t.apply(this,arguments)},s)},count:function(e){var t=0;return hf(e,function(){t++}),t},toArray:function(e){return hf(e,function(t){return t})||[]},only:function(e){if(!J0(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Vt.Component=Du;Vt.Fragment=OI;Vt.Profiler=$I;Vt.PureComponent=K0;Vt.StrictMode=NI;Vt.Suspense=GI;Vt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=YI;Vt.act=G2;Vt.cloneElement=function(e,t,s){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var l=O2({},e.props),f=e.key,y=e.ref,x=e._owner;if(t!=null){if(t.ref!==void 0&&(y=t.ref,x=Y0.current),t.key!==void 0&&(f=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(P in t)j2.call(t,P)&&!U2.hasOwnProperty(P)&&(l[P]=t[P]===void 0&&u!==void 0?u[P]:t[P])}var P=arguments.length-2;if(P===1)l.children=s;else if(1<P){u=Array(P);for(var L=0;L<P;L++)u[L]=arguments[L+2];l.children=u}return{$$typeof:Kd,type:e.type,key:f,ref:y,props:l,_owner:x}};Vt.createContext=function(e){return e={$$typeof:UI,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:jI,_context:e},e.Consumer=e};Vt.createElement=V2;Vt.createFactory=function(e){var t=V2.bind(null,e);return t.type=e,t};Vt.createRef=function(){return{current:null}};Vt.forwardRef=function(e){return{$$typeof:VI,render:e}};Vt.isValidElement=J0;Vt.lazy=function(e){return{$$typeof:HI,_payload:{_status:-1,_result:e},_init:XI}};Vt.memo=function(e,t){return{$$typeof:qI,type:e,compare:t===void 0?null:t}};Vt.startTransition=function(e){var t=Of.transition;Of.transition={};try{e()}finally{Of.transition=t}};Vt.unstable_act=G2;Vt.useCallback=function(e,t){return vi.current.useCallback(e,t)};Vt.useContext=function(e){return vi.current.useContext(e)};Vt.useDebugValue=function(){};Vt.useDeferredValue=function(e){return vi.current.useDeferredValue(e)};Vt.useEffect=function(e,t){return vi.current.useEffect(e,t)};Vt.useId=function(){return vi.current.useId()};Vt.useImperativeHandle=function(e,t,s){return vi.current.useImperativeHandle(e,t,s)};Vt.useInsertionEffect=function(e,t){return vi.current.useInsertionEffect(e,t)};Vt.useLayoutEffect=function(e,t){return vi.current.useLayoutEffect(e,t)};Vt.useMemo=function(e,t){return vi.current.useMemo(e,t)};Vt.useReducer=function(e,t,s){return vi.current.useReducer(e,t,s)};Vt.useRef=function(e){return vi.current.useRef(e)};Vt.useState=function(e){return vi.current.useState(e)};Vt.useSyncExternalStore=function(e,t,s){return vi.current.useSyncExternalStore(e,t,s)};Vt.useTransition=function(){return vi.current.useTransition()};Vt.version="18.3.1";F2.exports=Vt;var Te=F2.exports;const Xo=Fm(Te),R_=DI({__proto__:null,default:Xo},[Te]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var JI=Te,QI=Symbol.for("react.element"),eP=Symbol.for("react.fragment"),tP=Object.prototype.hasOwnProperty,nP=JI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,rP={key:!0,ref:!0,__self:!0,__source:!0};function q2(e,t,s){var l,f={},y=null,x=null;s!==void 0&&(y=""+s),t.key!==void 0&&(y=""+t.key),t.ref!==void 0&&(x=t.ref);for(l in t)tP.call(t,l)&&!rP.hasOwnProperty(l)&&(f[l]=t[l]);if(e&&e.defaultProps)for(l in t=e.defaultProps,t)f[l]===void 0&&(f[l]=t[l]);return{$$typeof:QI,type:e,key:y,ref:x,props:f,_owner:nP.current}}Bm.Fragment=eP;Bm.jsx=q2;Bm.jsxs=q2;D2.exports=Bm;var Be=D2.exports,D_={},H2={exports:{}},lo={},Z2={exports:{}},W2={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Pe,et){var lt=Pe.length;Pe.push(et);e:for(;0<lt;){var Ct=lt-1>>>1,Nt=Pe[Ct];if(0<f(Nt,et))Pe[Ct]=et,Pe[lt]=Nt,lt=Ct;else break e}}function s(Pe){return Pe.length===0?null:Pe[0]}function l(Pe){if(Pe.length===0)return null;var et=Pe[0],lt=Pe.pop();if(lt!==et){Pe[0]=lt;e:for(var Ct=0,Nt=Pe.length,gr=Nt>>>1;Ct<gr;){var Qt=2*(Ct+1)-1,_n=Pe[Qt],Pn=Qt+1,An=Pe[Pn];if(0>f(_n,lt))Pn<Nt&&0>f(An,_n)?(Pe[Ct]=An,Pe[Pn]=lt,Ct=Pn):(Pe[Ct]=_n,Pe[Qt]=lt,Ct=Qt);else if(Pn<Nt&&0>f(An,lt))Pe[Ct]=An,Pe[Pn]=lt,Ct=Pn;else break e}}return et}function f(Pe,et){var lt=Pe.sortIndex-et.sortIndex;return lt!==0?lt:Pe.id-et.id}if(typeof performance=="object"&&typeof performance.now=="function"){var y=performance;e.unstable_now=function(){return y.now()}}else{var x=Date,u=x.now();e.unstable_now=function(){return x.now()-u}}var P=[],L=[],U=1,N=null,D=3,se=!1,ne=!1,ee=!1,ke=typeof setTimeout=="function"?setTimeout:null,X=typeof clearTimeout=="function"?clearTimeout:null,Z=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function W(Pe){for(var et=s(L);et!==null;){if(et.callback===null)l(L);else if(et.startTime<=Pe)l(L),et.sortIndex=et.expirationTime,t(P,et);else break;et=s(L)}}function pe(Pe){if(ee=!1,W(Pe),!ne)if(s(P)!==null)ne=!0,yt(_e);else{var et=s(L);et!==null&&Tt(pe,et.startTime-Pe)}}function _e(Pe,et){ne=!1,ee&&(ee=!1,X(Re),Re=-1),se=!0;var lt=D;try{for(W(et),N=s(P);N!==null&&(!(N.expirationTime>et)||Pe&&!He());){var Ct=N.callback;if(typeof Ct=="function"){N.callback=null,D=N.priorityLevel;var Nt=Ct(N.expirationTime<=et);et=e.unstable_now(),typeof Nt=="function"?N.callback=Nt:N===s(P)&&l(P),W(et)}else l(P);N=s(P)}if(N!==null)var gr=!0;else{var Qt=s(L);Qt!==null&&Tt(pe,Qt.startTime-et),gr=!1}return gr}finally{N=null,D=lt,se=!1}}var be=!1,xe=null,Re=-1,tt=5,Oe=-1;function He(){return!(e.unstable_now()-Oe<tt)}function vt(){if(xe!==null){var Pe=e.unstable_now();Oe=Pe;var et=!0;try{et=xe(!0,Pe)}finally{et?dt():(be=!1,xe=null)}}else be=!1}var dt;if(typeof Z=="function")dt=function(){Z(vt)};else if(typeof MessageChannel<"u"){var ht=new MessageChannel,Lt=ht.port2;ht.port1.onmessage=vt,dt=function(){Lt.postMessage(null)}}else dt=function(){ke(vt,0)};function yt(Pe){xe=Pe,be||(be=!0,dt())}function Tt(Pe,et){Re=ke(function(){Pe(e.unstable_now())},et)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Pe){Pe.callback=null},e.unstable_continueExecution=function(){ne||se||(ne=!0,yt(_e))},e.unstable_forceFrameRate=function(Pe){0>Pe||125<Pe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):tt=0<Pe?Math.floor(1e3/Pe):5},e.unstable_getCurrentPriorityLevel=function(){return D},e.unstable_getFirstCallbackNode=function(){return s(P)},e.unstable_next=function(Pe){switch(D){case 1:case 2:case 3:var et=3;break;default:et=D}var lt=D;D=et;try{return Pe()}finally{D=lt}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Pe,et){switch(Pe){case 1:case 2:case 3:case 4:case 5:break;default:Pe=3}var lt=D;D=Pe;try{return et()}finally{D=lt}},e.unstable_scheduleCallback=function(Pe,et,lt){var Ct=e.unstable_now();switch(typeof lt=="object"&&lt!==null?(lt=lt.delay,lt=typeof lt=="number"&&0<lt?Ct+lt:Ct):lt=Ct,Pe){case 1:var Nt=-1;break;case 2:Nt=250;break;case 5:Nt=1073741823;break;case 4:Nt=1e4;break;default:Nt=5e3}return Nt=lt+Nt,Pe={id:U++,callback:et,priorityLevel:Pe,startTime:lt,expirationTime:Nt,sortIndex:-1},lt>Ct?(Pe.sortIndex=lt,t(L,Pe),s(P)===null&&Pe===s(L)&&(ee?(X(Re),Re=-1):ee=!0,Tt(pe,lt-Ct))):(Pe.sortIndex=Nt,t(P,Pe),ne||se||(ne=!0,yt(_e))),Pe},e.unstable_shouldYield=He,e.unstable_wrapCallback=function(Pe){var et=D;return function(){var lt=D;D=et;try{return Pe.apply(this,arguments)}finally{D=lt}}}})(W2);Z2.exports=W2;var iP=Z2.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oP=Te,ao=iP;function Ne(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)t+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var K2=new Set,kd={};function Kl(e,t){Eu(e,t),Eu(e+"Capture",t)}function Eu(e,t){for(kd[e]=t,e=0;e<t.length;e++)K2.add(t[e])}var Ws=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),F_=Object.prototype.hasOwnProperty,sP=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,hb={},db={};function aP(e){return F_.call(db,e)?!0:F_.call(hb,e)?!1:sP.test(e)?db[e]=!0:(hb[e]=!0,!1)}function lP(e,t,s,l){if(s!==null&&s.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return l?!1:s!==null?!s.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function cP(e,t,s,l){if(t===null||typeof t>"u"||lP(e,t,s,l))return!0;if(l)return!1;if(s!==null)switch(s.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function xi(e,t,s,l,f,y,x){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=l,this.attributeNamespace=f,this.mustUseProperty=s,this.propertyName=e,this.type=t,this.sanitizeURL=y,this.removeEmptyString=x}var Vr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Vr[e]=new xi(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Vr[t]=new xi(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Vr[e]=new xi(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Vr[e]=new xi(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Vr[e]=new xi(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Vr[e]=new xi(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Vr[e]=new xi(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Vr[e]=new xi(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Vr[e]=new xi(e,5,!1,e.toLowerCase(),null,!1,!1)});var Q0=/[\-:]([a-z])/g;function ev(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Q0,ev);Vr[t]=new xi(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Q0,ev);Vr[t]=new xi(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Q0,ev);Vr[t]=new xi(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Vr[e]=new xi(e,1,!1,e.toLowerCase(),null,!1,!1)});Vr.xlinkHref=new xi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Vr[e]=new xi(e,1,!1,e.toLowerCase(),null,!0,!0)});function tv(e,t,s,l){var f=Vr.hasOwnProperty(t)?Vr[t]:null;(f!==null?f.type!==0:l||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(cP(t,s,f,l)&&(s=null),l||f===null?aP(t)&&(s===null?e.removeAttribute(t):e.setAttribute(t,""+s)):f.mustUseProperty?e[f.propertyName]=s===null?f.type===3?!1:"":s:(t=f.attributeName,l=f.attributeNamespace,s===null?e.removeAttribute(t):(f=f.type,s=f===3||f===4&&s===!0?"":""+s,l?e.setAttributeNS(l,t,s):e.setAttribute(t,s))))}var ea=oP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,df=Symbol.for("react.element"),nu=Symbol.for("react.portal"),ru=Symbol.for("react.fragment"),nv=Symbol.for("react.strict_mode"),B_=Symbol.for("react.profiler"),X2=Symbol.for("react.provider"),Y2=Symbol.for("react.context"),rv=Symbol.for("react.forward_ref"),O_=Symbol.for("react.suspense"),N_=Symbol.for("react.suspense_list"),iv=Symbol.for("react.memo"),Fa=Symbol.for("react.lazy"),J2=Symbol.for("react.offscreen"),pb=Symbol.iterator;function Yh(e){return e===null||typeof e!="object"?null:(e=pb&&e[pb]||e["@@iterator"],typeof e=="function"?e:null)}var qn=Object.assign,e_;function cd(e){if(e_===void 0)try{throw Error()}catch(s){var t=s.stack.trim().match(/\n( *(at )?)/);e_=t&&t[1]||""}return`
`+e_+e}var t_=!1;function n_(e,t){if(!e||t_)return"";t_=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(L){var l=L}Reflect.construct(e,[],t)}else{try{t.call()}catch(L){l=L}e.call(t.prototype)}else{try{throw Error()}catch(L){l=L}e()}}catch(L){if(L&&l&&typeof L.stack=="string"){for(var f=L.stack.split(`
`),y=l.stack.split(`
`),x=f.length-1,u=y.length-1;1<=x&&0<=u&&f[x]!==y[u];)u--;for(;1<=x&&0<=u;x--,u--)if(f[x]!==y[u]){if(x!==1||u!==1)do if(x--,u--,0>u||f[x]!==y[u]){var P=`
`+f[x].replace(" at new "," at ");return e.displayName&&P.includes("<anonymous>")&&(P=P.replace("<anonymous>",e.displayName)),P}while(1<=x&&0<=u);break}}}finally{t_=!1,Error.prepareStackTrace=s}return(e=e?e.displayName||e.name:"")?cd(e):""}function uP(e){switch(e.tag){case 5:return cd(e.type);case 16:return cd("Lazy");case 13:return cd("Suspense");case 19:return cd("SuspenseList");case 0:case 2:case 15:return e=n_(e.type,!1),e;case 11:return e=n_(e.type.render,!1),e;case 1:return e=n_(e.type,!0),e;default:return""}}function $_(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ru:return"Fragment";case nu:return"Portal";case B_:return"Profiler";case nv:return"StrictMode";case O_:return"Suspense";case N_:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Y2:return(e.displayName||"Context")+".Consumer";case X2:return(e._context.displayName||"Context")+".Provider";case rv:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case iv:return t=e.displayName||null,t!==null?t:$_(e.type)||"Memo";case Fa:t=e._payload,e=e._init;try{return $_(e(t))}catch{}}return null}function hP(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return $_(t);case 8:return t===nv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ya(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Q2(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function dP(e){var t=Q2(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),l=""+e[t];if(!e.hasOwnProperty(t)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var f=s.get,y=s.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return f.call(this)},set:function(x){l=""+x,y.call(this,x)}}),Object.defineProperty(e,t,{enumerable:s.enumerable}),{getValue:function(){return l},setValue:function(x){l=""+x},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function pf(e){e._valueTracker||(e._valueTracker=dP(e))}function eS(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var s=t.getValue(),l="";return e&&(l=Q2(e)?e.checked?"true":"false":e.value),e=l,e!==s?(t.setValue(e),!0):!1}function im(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function j_(e,t){var s=t.checked;return qn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??e._wrapperState.initialChecked})}function fb(e,t){var s=t.defaultValue==null?"":t.defaultValue,l=t.checked!=null?t.checked:t.defaultChecked;s=Ya(t.value!=null?t.value:s),e._wrapperState={initialChecked:l,initialValue:s,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function tS(e,t){t=t.checked,t!=null&&tv(e,"checked",t,!1)}function U_(e,t){tS(e,t);var s=Ya(t.value),l=t.type;if(s!=null)l==="number"?(s===0&&e.value===""||e.value!=s)&&(e.value=""+s):e.value!==""+s&&(e.value=""+s);else if(l==="submit"||l==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?V_(e,t.type,s):t.hasOwnProperty("defaultValue")&&V_(e,t.type,Ya(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function mb(e,t,s){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var l=t.type;if(!(l!=="submit"&&l!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,s||t===e.value||(e.value=t),e.defaultValue=t}s=e.name,s!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,s!==""&&(e.name=s)}function V_(e,t,s){(t!=="number"||im(e.ownerDocument)!==e)&&(s==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+s&&(e.defaultValue=""+s))}var ud=Array.isArray;function fu(e,t,s,l){if(e=e.options,t){t={};for(var f=0;f<s.length;f++)t["$"+s[f]]=!0;for(s=0;s<e.length;s++)f=t.hasOwnProperty("$"+e[s].value),e[s].selected!==f&&(e[s].selected=f),f&&l&&(e[s].defaultSelected=!0)}else{for(s=""+Ya(s),t=null,f=0;f<e.length;f++){if(e[f].value===s){e[f].selected=!0,l&&(e[f].defaultSelected=!0);return}t!==null||e[f].disabled||(t=e[f])}t!==null&&(t.selected=!0)}}function G_(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Ne(91));return qn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function gb(e,t){var s=t.value;if(s==null){if(s=t.children,t=t.defaultValue,s!=null){if(t!=null)throw Error(Ne(92));if(ud(s)){if(1<s.length)throw Error(Ne(93));s=s[0]}t=s}t==null&&(t=""),s=t}e._wrapperState={initialValue:Ya(s)}}function nS(e,t){var s=Ya(t.value),l=Ya(t.defaultValue);s!=null&&(s=""+s,s!==e.value&&(e.value=s),t.defaultValue==null&&e.defaultValue!==s&&(e.defaultValue=s)),l!=null&&(e.defaultValue=""+l)}function yb(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function rS(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function q_(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?rS(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ff,iS=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,s,l,f){MSApp.execUnsafeLocalFunction(function(){return e(t,s,l,f)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ff=ff||document.createElement("div"),ff.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ff.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ed(e,t){if(t){var s=e.firstChild;if(s&&s===e.lastChild&&s.nodeType===3){s.nodeValue=t;return}}e.textContent=t}var md={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pP=["Webkit","ms","Moz","O"];Object.keys(md).forEach(function(e){pP.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),md[t]=md[e]})});function oS(e,t,s){return t==null||typeof t=="boolean"||t===""?"":s||typeof t!="number"||t===0||md.hasOwnProperty(e)&&md[e]?(""+t).trim():t+"px"}function sS(e,t){e=e.style;for(var s in t)if(t.hasOwnProperty(s)){var l=s.indexOf("--")===0,f=oS(s,t[s],l);s==="float"&&(s="cssFloat"),l?e.setProperty(s,f):e[s]=f}}var fP=qn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function H_(e,t){if(t){if(fP[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Ne(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Ne(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Ne(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Ne(62))}}function Z_(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var W_=null;function ov(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var K_=null,mu=null,gu=null;function _b(e){if(e=Jd(e)){if(typeof K_!="function")throw Error(Ne(280));var t=e.stateNode;t&&(t=Um(t),K_(e.stateNode,e.type,t))}}function aS(e){mu?gu?gu.push(e):gu=[e]:mu=e}function lS(){if(mu){var e=mu,t=gu;if(gu=mu=null,_b(e),t)for(e=0;e<t.length;e++)_b(t[e])}}function cS(e,t){return e(t)}function uS(){}var r_=!1;function hS(e,t,s){if(r_)return e(t,s);r_=!0;try{return cS(e,t,s)}finally{r_=!1,(mu!==null||gu!==null)&&(uS(),lS())}}function Id(e,t){var s=e.stateNode;if(s===null)return null;var l=Um(s);if(l===null)return null;s=l[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(e=e.type,l=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!l;break e;default:e=!1}if(e)return null;if(s&&typeof s!="function")throw Error(Ne(231,t,typeof s));return s}var X_=!1;if(Ws)try{var Jh={};Object.defineProperty(Jh,"passive",{get:function(){X_=!0}}),window.addEventListener("test",Jh,Jh),window.removeEventListener("test",Jh,Jh)}catch{X_=!1}function mP(e,t,s,l,f,y,x,u,P){var L=Array.prototype.slice.call(arguments,3);try{t.apply(s,L)}catch(U){this.onError(U)}}var gd=!1,om=null,sm=!1,Y_=null,gP={onError:function(e){gd=!0,om=e}};function yP(e,t,s,l,f,y,x,u,P){gd=!1,om=null,mP.apply(gP,arguments)}function _P(e,t,s,l,f,y,x,u,P){if(yP.apply(this,arguments),gd){if(gd){var L=om;gd=!1,om=null}else throw Error(Ne(198));sm||(sm=!0,Y_=L)}}function Xl(e){var t=e,s=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(s=t.return),e=t.return;while(e)}return t.tag===3?s:null}function dS(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function vb(e){if(Xl(e)!==e)throw Error(Ne(188))}function vP(e){var t=e.alternate;if(!t){if(t=Xl(e),t===null)throw Error(Ne(188));return t!==e?null:e}for(var s=e,l=t;;){var f=s.return;if(f===null)break;var y=f.alternate;if(y===null){if(l=f.return,l!==null){s=l;continue}break}if(f.child===y.child){for(y=f.child;y;){if(y===s)return vb(f),e;if(y===l)return vb(f),t;y=y.sibling}throw Error(Ne(188))}if(s.return!==l.return)s=f,l=y;else{for(var x=!1,u=f.child;u;){if(u===s){x=!0,s=f,l=y;break}if(u===l){x=!0,l=f,s=y;break}u=u.sibling}if(!x){for(u=y.child;u;){if(u===s){x=!0,s=y,l=f;break}if(u===l){x=!0,l=y,s=f;break}u=u.sibling}if(!x)throw Error(Ne(189))}}if(s.alternate!==l)throw Error(Ne(190))}if(s.tag!==3)throw Error(Ne(188));return s.stateNode.current===s?e:t}function pS(e){return e=vP(e),e!==null?fS(e):null}function fS(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=fS(e);if(t!==null)return t;e=e.sibling}return null}var mS=ao.unstable_scheduleCallback,xb=ao.unstable_cancelCallback,xP=ao.unstable_shouldYield,bP=ao.unstable_requestPaint,Qn=ao.unstable_now,wP=ao.unstable_getCurrentPriorityLevel,sv=ao.unstable_ImmediatePriority,gS=ao.unstable_UserBlockingPriority,am=ao.unstable_NormalPriority,SP=ao.unstable_LowPriority,yS=ao.unstable_IdlePriority,Om=null,ys=null;function TP(e){if(ys&&typeof ys.onCommitFiberRoot=="function")try{ys.onCommitFiberRoot(Om,e,void 0,(e.current.flags&128)===128)}catch{}}var Yo=Math.clz32?Math.clz32:EP,CP=Math.log,kP=Math.LN2;function EP(e){return e>>>=0,e===0?32:31-(CP(e)/kP|0)|0}var mf=64,gf=4194304;function hd(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function lm(e,t){var s=e.pendingLanes;if(s===0)return 0;var l=0,f=e.suspendedLanes,y=e.pingedLanes,x=s&268435455;if(x!==0){var u=x&~f;u!==0?l=hd(u):(y&=x,y!==0&&(l=hd(y)))}else x=s&~f,x!==0?l=hd(x):y!==0&&(l=hd(y));if(l===0)return 0;if(t!==0&&t!==l&&!(t&f)&&(f=l&-l,y=t&-t,f>=y||f===16&&(y&4194240)!==0))return t;if(l&4&&(l|=s&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=l;0<t;)s=31-Yo(t),f=1<<s,l|=e[s],t&=~f;return l}function IP(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function PP(e,t){for(var s=e.suspendedLanes,l=e.pingedLanes,f=e.expirationTimes,y=e.pendingLanes;0<y;){var x=31-Yo(y),u=1<<x,P=f[x];P===-1?(!(u&s)||u&l)&&(f[x]=IP(u,t)):P<=t&&(e.expiredLanes|=u),y&=~u}}function J_(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function _S(){var e=mf;return mf<<=1,!(mf&4194240)&&(mf=64),e}function i_(e){for(var t=[],s=0;31>s;s++)t.push(e);return t}function Xd(e,t,s){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Yo(t),e[t]=s}function AP(e,t){var s=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var l=e.eventTimes;for(e=e.expirationTimes;0<s;){var f=31-Yo(s),y=1<<f;t[f]=0,l[f]=-1,e[f]=-1,s&=~y}}function av(e,t){var s=e.entangledLanes|=t;for(e=e.entanglements;s;){var l=31-Yo(s),f=1<<l;f&t|e[l]&t&&(e[l]|=t),s&=~f}}var mn=0;function vS(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var xS,lv,bS,wS,SS,Q_=!1,yf=[],Va=null,Ga=null,qa=null,Pd=new Map,Ad=new Map,Oa=[],MP="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function bb(e,t){switch(e){case"focusin":case"focusout":Va=null;break;case"dragenter":case"dragleave":Ga=null;break;case"mouseover":case"mouseout":qa=null;break;case"pointerover":case"pointerout":Pd.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ad.delete(t.pointerId)}}function Qh(e,t,s,l,f,y){return e===null||e.nativeEvent!==y?(e={blockedOn:t,domEventName:s,eventSystemFlags:l,nativeEvent:y,targetContainers:[f]},t!==null&&(t=Jd(t),t!==null&&lv(t)),e):(e.eventSystemFlags|=l,t=e.targetContainers,f!==null&&t.indexOf(f)===-1&&t.push(f),e)}function zP(e,t,s,l,f){switch(t){case"focusin":return Va=Qh(Va,e,t,s,l,f),!0;case"dragenter":return Ga=Qh(Ga,e,t,s,l,f),!0;case"mouseover":return qa=Qh(qa,e,t,s,l,f),!0;case"pointerover":var y=f.pointerId;return Pd.set(y,Qh(Pd.get(y)||null,e,t,s,l,f)),!0;case"gotpointercapture":return y=f.pointerId,Ad.set(y,Qh(Ad.get(y)||null,e,t,s,l,f)),!0}return!1}function TS(e){var t=Dl(e.target);if(t!==null){var s=Xl(t);if(s!==null){if(t=s.tag,t===13){if(t=dS(s),t!==null){e.blockedOn=t,SS(e.priority,function(){bS(s)});return}}else if(t===3&&s.stateNode.current.memoizedState.isDehydrated){e.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Nf(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var s=e0(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(s===null){s=e.nativeEvent;var l=new s.constructor(s.type,s);W_=l,s.target.dispatchEvent(l),W_=null}else return t=Jd(s),t!==null&&lv(t),e.blockedOn=s,!1;t.shift()}return!0}function wb(e,t,s){Nf(e)&&s.delete(t)}function LP(){Q_=!1,Va!==null&&Nf(Va)&&(Va=null),Ga!==null&&Nf(Ga)&&(Ga=null),qa!==null&&Nf(qa)&&(qa=null),Pd.forEach(wb),Ad.forEach(wb)}function ed(e,t){e.blockedOn===t&&(e.blockedOn=null,Q_||(Q_=!0,ao.unstable_scheduleCallback(ao.unstable_NormalPriority,LP)))}function Md(e){function t(f){return ed(f,e)}if(0<yf.length){ed(yf[0],e);for(var s=1;s<yf.length;s++){var l=yf[s];l.blockedOn===e&&(l.blockedOn=null)}}for(Va!==null&&ed(Va,e),Ga!==null&&ed(Ga,e),qa!==null&&ed(qa,e),Pd.forEach(t),Ad.forEach(t),s=0;s<Oa.length;s++)l=Oa[s],l.blockedOn===e&&(l.blockedOn=null);for(;0<Oa.length&&(s=Oa[0],s.blockedOn===null);)TS(s),s.blockedOn===null&&Oa.shift()}var yu=ea.ReactCurrentBatchConfig,cm=!0;function RP(e,t,s,l){var f=mn,y=yu.transition;yu.transition=null;try{mn=1,cv(e,t,s,l)}finally{mn=f,yu.transition=y}}function DP(e,t,s,l){var f=mn,y=yu.transition;yu.transition=null;try{mn=4,cv(e,t,s,l)}finally{mn=f,yu.transition=y}}function cv(e,t,s,l){if(cm){var f=e0(e,t,s,l);if(f===null)f_(e,t,l,um,s),bb(e,l);else if(zP(f,e,t,s,l))l.stopPropagation();else if(bb(e,l),t&4&&-1<MP.indexOf(e)){for(;f!==null;){var y=Jd(f);if(y!==null&&xS(y),y=e0(e,t,s,l),y===null&&f_(e,t,l,um,s),y===f)break;f=y}f!==null&&l.stopPropagation()}else f_(e,t,l,null,s)}}var um=null;function e0(e,t,s,l){if(um=null,e=ov(l),e=Dl(e),e!==null)if(t=Xl(e),t===null)e=null;else if(s=t.tag,s===13){if(e=dS(t),e!==null)return e;e=null}else if(s===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return um=e,null}function CS(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(wP()){case sv:return 1;case gS:return 4;case am:case SP:return 16;case yS:return 536870912;default:return 16}default:return 16}}var ja=null,uv=null,$f=null;function kS(){if($f)return $f;var e,t=uv,s=t.length,l,f="value"in ja?ja.value:ja.textContent,y=f.length;for(e=0;e<s&&t[e]===f[e];e++);var x=s-e;for(l=1;l<=x&&t[s-l]===f[y-l];l++);return $f=f.slice(e,1<l?1-l:void 0)}function jf(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function _f(){return!0}function Sb(){return!1}function co(e){function t(s,l,f,y,x){this._reactName=s,this._targetInst=f,this.type=l,this.nativeEvent=y,this.target=x,this.currentTarget=null;for(var u in e)e.hasOwnProperty(u)&&(s=e[u],this[u]=s?s(y):y[u]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?_f:Sb,this.isPropagationStopped=Sb,this}return qn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=_f)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=_f)},persist:function(){},isPersistent:_f}),t}var Fu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hv=co(Fu),Yd=qn({},Fu,{view:0,detail:0}),FP=co(Yd),o_,s_,td,Nm=qn({},Yd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:dv,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==td&&(td&&e.type==="mousemove"?(o_=e.screenX-td.screenX,s_=e.screenY-td.screenY):s_=o_=0,td=e),o_)},movementY:function(e){return"movementY"in e?e.movementY:s_}}),Tb=co(Nm),BP=qn({},Nm,{dataTransfer:0}),OP=co(BP),NP=qn({},Yd,{relatedTarget:0}),a_=co(NP),$P=qn({},Fu,{animationName:0,elapsedTime:0,pseudoElement:0}),jP=co($P),UP=qn({},Fu,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),VP=co(UP),GP=qn({},Fu,{data:0}),Cb=co(GP),qP={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},HP={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ZP={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function WP(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=ZP[e])?!!t[e]:!1}function dv(){return WP}var KP=qn({},Yd,{key:function(e){if(e.key){var t=qP[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=jf(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?HP[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:dv,charCode:function(e){return e.type==="keypress"?jf(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?jf(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),XP=co(KP),YP=qn({},Nm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),kb=co(YP),JP=qn({},Yd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:dv}),QP=co(JP),eA=qn({},Fu,{propertyName:0,elapsedTime:0,pseudoElement:0}),tA=co(eA),nA=qn({},Nm,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),rA=co(nA),iA=[9,13,27,32],pv=Ws&&"CompositionEvent"in window,yd=null;Ws&&"documentMode"in document&&(yd=document.documentMode);var oA=Ws&&"TextEvent"in window&&!yd,ES=Ws&&(!pv||yd&&8<yd&&11>=yd),Eb=" ",Ib=!1;function IS(e,t){switch(e){case"keyup":return iA.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function PS(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var iu=!1;function sA(e,t){switch(e){case"compositionend":return PS(t);case"keypress":return t.which!==32?null:(Ib=!0,Eb);case"textInput":return e=t.data,e===Eb&&Ib?null:e;default:return null}}function aA(e,t){if(iu)return e==="compositionend"||!pv&&IS(e,t)?(e=kS(),$f=uv=ja=null,iu=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return ES&&t.locale!=="ko"?null:t.data;default:return null}}var lA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Pb(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!lA[e.type]:t==="textarea"}function AS(e,t,s,l){aS(l),t=hm(t,"onChange"),0<t.length&&(s=new hv("onChange","change",null,s,l),e.push({event:s,listeners:t}))}var _d=null,zd=null;function cA(e){jS(e,0)}function $m(e){var t=au(e);if(eS(t))return e}function uA(e,t){if(e==="change")return t}var MS=!1;if(Ws){var l_;if(Ws){var c_="oninput"in document;if(!c_){var Ab=document.createElement("div");Ab.setAttribute("oninput","return;"),c_=typeof Ab.oninput=="function"}l_=c_}else l_=!1;MS=l_&&(!document.documentMode||9<document.documentMode)}function Mb(){_d&&(_d.detachEvent("onpropertychange",zS),zd=_d=null)}function zS(e){if(e.propertyName==="value"&&$m(zd)){var t=[];AS(t,zd,e,ov(e)),hS(cA,t)}}function hA(e,t,s){e==="focusin"?(Mb(),_d=t,zd=s,_d.attachEvent("onpropertychange",zS)):e==="focusout"&&Mb()}function dA(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return $m(zd)}function pA(e,t){if(e==="click")return $m(t)}function fA(e,t){if(e==="input"||e==="change")return $m(t)}function mA(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Qo=typeof Object.is=="function"?Object.is:mA;function Ld(e,t){if(Qo(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var s=Object.keys(e),l=Object.keys(t);if(s.length!==l.length)return!1;for(l=0;l<s.length;l++){var f=s[l];if(!F_.call(t,f)||!Qo(e[f],t[f]))return!1}return!0}function zb(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Lb(e,t){var s=zb(e);e=0;for(var l;s;){if(s.nodeType===3){if(l=e+s.textContent.length,e<=t&&l>=t)return{node:s,offset:t-e};e=l}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=zb(s)}}function LS(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?LS(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function RS(){for(var e=window,t=im();t instanceof e.HTMLIFrameElement;){try{var s=typeof t.contentWindow.location.href=="string"}catch{s=!1}if(s)e=t.contentWindow;else break;t=im(e.document)}return t}function fv(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function gA(e){var t=RS(),s=e.focusedElem,l=e.selectionRange;if(t!==s&&s&&s.ownerDocument&&LS(s.ownerDocument.documentElement,s)){if(l!==null&&fv(s)){if(t=l.start,e=l.end,e===void 0&&(e=t),"selectionStart"in s)s.selectionStart=t,s.selectionEnd=Math.min(e,s.value.length);else if(e=(t=s.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var f=s.textContent.length,y=Math.min(l.start,f);l=l.end===void 0?y:Math.min(l.end,f),!e.extend&&y>l&&(f=l,l=y,y=f),f=Lb(s,y);var x=Lb(s,l);f&&x&&(e.rangeCount!==1||e.anchorNode!==f.node||e.anchorOffset!==f.offset||e.focusNode!==x.node||e.focusOffset!==x.offset)&&(t=t.createRange(),t.setStart(f.node,f.offset),e.removeAllRanges(),y>l?(e.addRange(t),e.extend(x.node,x.offset)):(t.setEnd(x.node,x.offset),e.addRange(t)))}}for(t=[],e=s;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<t.length;s++)e=t[s],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var yA=Ws&&"documentMode"in document&&11>=document.documentMode,ou=null,t0=null,vd=null,n0=!1;function Rb(e,t,s){var l=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;n0||ou==null||ou!==im(l)||(l=ou,"selectionStart"in l&&fv(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),vd&&Ld(vd,l)||(vd=l,l=hm(t0,"onSelect"),0<l.length&&(t=new hv("onSelect","select",null,t,s),e.push({event:t,listeners:l}),t.target=ou)))}function vf(e,t){var s={};return s[e.toLowerCase()]=t.toLowerCase(),s["Webkit"+e]="webkit"+t,s["Moz"+e]="moz"+t,s}var su={animationend:vf("Animation","AnimationEnd"),animationiteration:vf("Animation","AnimationIteration"),animationstart:vf("Animation","AnimationStart"),transitionend:vf("Transition","TransitionEnd")},u_={},DS={};Ws&&(DS=document.createElement("div").style,"AnimationEvent"in window||(delete su.animationend.animation,delete su.animationiteration.animation,delete su.animationstart.animation),"TransitionEvent"in window||delete su.transitionend.transition);function jm(e){if(u_[e])return u_[e];if(!su[e])return e;var t=su[e],s;for(s in t)if(t.hasOwnProperty(s)&&s in DS)return u_[e]=t[s];return e}var FS=jm("animationend"),BS=jm("animationiteration"),OS=jm("animationstart"),NS=jm("transitionend"),$S=new Map,Db="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Qa(e,t){$S.set(e,t),Kl(t,[e])}for(var h_=0;h_<Db.length;h_++){var d_=Db[h_],_A=d_.toLowerCase(),vA=d_[0].toUpperCase()+d_.slice(1);Qa(_A,"on"+vA)}Qa(FS,"onAnimationEnd");Qa(BS,"onAnimationIteration");Qa(OS,"onAnimationStart");Qa("dblclick","onDoubleClick");Qa("focusin","onFocus");Qa("focusout","onBlur");Qa(NS,"onTransitionEnd");Eu("onMouseEnter",["mouseout","mouseover"]);Eu("onMouseLeave",["mouseout","mouseover"]);Eu("onPointerEnter",["pointerout","pointerover"]);Eu("onPointerLeave",["pointerout","pointerover"]);Kl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Kl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Kl("onBeforeInput",["compositionend","keypress","textInput","paste"]);Kl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Kl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Kl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var dd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xA=new Set("cancel close invalid load scroll toggle".split(" ").concat(dd));function Fb(e,t,s){var l=e.type||"unknown-event";e.currentTarget=s,_P(l,t,void 0,e),e.currentTarget=null}function jS(e,t){t=(t&4)!==0;for(var s=0;s<e.length;s++){var l=e[s],f=l.event;l=l.listeners;e:{var y=void 0;if(t)for(var x=l.length-1;0<=x;x--){var u=l[x],P=u.instance,L=u.currentTarget;if(u=u.listener,P!==y&&f.isPropagationStopped())break e;Fb(f,u,L),y=P}else for(x=0;x<l.length;x++){if(u=l[x],P=u.instance,L=u.currentTarget,u=u.listener,P!==y&&f.isPropagationStopped())break e;Fb(f,u,L),y=P}}}if(sm)throw e=Y_,sm=!1,Y_=null,e}function Ln(e,t){var s=t[a0];s===void 0&&(s=t[a0]=new Set);var l=e+"__bubble";s.has(l)||(US(t,e,2,!1),s.add(l))}function p_(e,t,s){var l=0;t&&(l|=4),US(s,e,l,t)}var xf="_reactListening"+Math.random().toString(36).slice(2);function Rd(e){if(!e[xf]){e[xf]=!0,K2.forEach(function(s){s!=="selectionchange"&&(xA.has(s)||p_(s,!1,e),p_(s,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[xf]||(t[xf]=!0,p_("selectionchange",!1,t))}}function US(e,t,s,l){switch(CS(t)){case 1:var f=RP;break;case 4:f=DP;break;default:f=cv}s=f.bind(null,t,s,e),f=void 0,!X_||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(f=!0),l?f!==void 0?e.addEventListener(t,s,{capture:!0,passive:f}):e.addEventListener(t,s,!0):f!==void 0?e.addEventListener(t,s,{passive:f}):e.addEventListener(t,s,!1)}function f_(e,t,s,l,f){var y=l;if(!(t&1)&&!(t&2)&&l!==null)e:for(;;){if(l===null)return;var x=l.tag;if(x===3||x===4){var u=l.stateNode.containerInfo;if(u===f||u.nodeType===8&&u.parentNode===f)break;if(x===4)for(x=l.return;x!==null;){var P=x.tag;if((P===3||P===4)&&(P=x.stateNode.containerInfo,P===f||P.nodeType===8&&P.parentNode===f))return;x=x.return}for(;u!==null;){if(x=Dl(u),x===null)return;if(P=x.tag,P===5||P===6){l=y=x;continue e}u=u.parentNode}}l=l.return}hS(function(){var L=y,U=ov(s),N=[];e:{var D=$S.get(e);if(D!==void 0){var se=hv,ne=e;switch(e){case"keypress":if(jf(s)===0)break e;case"keydown":case"keyup":se=XP;break;case"focusin":ne="focus",se=a_;break;case"focusout":ne="blur",se=a_;break;case"beforeblur":case"afterblur":se=a_;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":se=Tb;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":se=OP;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":se=QP;break;case FS:case BS:case OS:se=jP;break;case NS:se=tA;break;case"scroll":se=FP;break;case"wheel":se=rA;break;case"copy":case"cut":case"paste":se=VP;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":se=kb}var ee=(t&4)!==0,ke=!ee&&e==="scroll",X=ee?D!==null?D+"Capture":null:D;ee=[];for(var Z=L,W;Z!==null;){W=Z;var pe=W.stateNode;if(W.tag===5&&pe!==null&&(W=pe,X!==null&&(pe=Id(Z,X),pe!=null&&ee.push(Dd(Z,pe,W)))),ke)break;Z=Z.return}0<ee.length&&(D=new se(D,ne,null,s,U),N.push({event:D,listeners:ee}))}}if(!(t&7)){e:{if(D=e==="mouseover"||e==="pointerover",se=e==="mouseout"||e==="pointerout",D&&s!==W_&&(ne=s.relatedTarget||s.fromElement)&&(Dl(ne)||ne[Ks]))break e;if((se||D)&&(D=U.window===U?U:(D=U.ownerDocument)?D.defaultView||D.parentWindow:window,se?(ne=s.relatedTarget||s.toElement,se=L,ne=ne?Dl(ne):null,ne!==null&&(ke=Xl(ne),ne!==ke||ne.tag!==5&&ne.tag!==6)&&(ne=null)):(se=null,ne=L),se!==ne)){if(ee=Tb,pe="onMouseLeave",X="onMouseEnter",Z="mouse",(e==="pointerout"||e==="pointerover")&&(ee=kb,pe="onPointerLeave",X="onPointerEnter",Z="pointer"),ke=se==null?D:au(se),W=ne==null?D:au(ne),D=new ee(pe,Z+"leave",se,s,U),D.target=ke,D.relatedTarget=W,pe=null,Dl(U)===L&&(ee=new ee(X,Z+"enter",ne,s,U),ee.target=W,ee.relatedTarget=ke,pe=ee),ke=pe,se&&ne)t:{for(ee=se,X=ne,Z=0,W=ee;W;W=qc(W))Z++;for(W=0,pe=X;pe;pe=qc(pe))W++;for(;0<Z-W;)ee=qc(ee),Z--;for(;0<W-Z;)X=qc(X),W--;for(;Z--;){if(ee===X||X!==null&&ee===X.alternate)break t;ee=qc(ee),X=qc(X)}ee=null}else ee=null;se!==null&&Bb(N,D,se,ee,!1),ne!==null&&ke!==null&&Bb(N,ke,ne,ee,!0)}}e:{if(D=L?au(L):window,se=D.nodeName&&D.nodeName.toLowerCase(),se==="select"||se==="input"&&D.type==="file")var _e=uA;else if(Pb(D))if(MS)_e=fA;else{_e=dA;var be=hA}else(se=D.nodeName)&&se.toLowerCase()==="input"&&(D.type==="checkbox"||D.type==="radio")&&(_e=pA);if(_e&&(_e=_e(e,L))){AS(N,_e,s,U);break e}be&&be(e,D,L),e==="focusout"&&(be=D._wrapperState)&&be.controlled&&D.type==="number"&&V_(D,"number",D.value)}switch(be=L?au(L):window,e){case"focusin":(Pb(be)||be.contentEditable==="true")&&(ou=be,t0=L,vd=null);break;case"focusout":vd=t0=ou=null;break;case"mousedown":n0=!0;break;case"contextmenu":case"mouseup":case"dragend":n0=!1,Rb(N,s,U);break;case"selectionchange":if(yA)break;case"keydown":case"keyup":Rb(N,s,U)}var xe;if(pv)e:{switch(e){case"compositionstart":var Re="onCompositionStart";break e;case"compositionend":Re="onCompositionEnd";break e;case"compositionupdate":Re="onCompositionUpdate";break e}Re=void 0}else iu?IS(e,s)&&(Re="onCompositionEnd"):e==="keydown"&&s.keyCode===229&&(Re="onCompositionStart");Re&&(ES&&s.locale!=="ko"&&(iu||Re!=="onCompositionStart"?Re==="onCompositionEnd"&&iu&&(xe=kS()):(ja=U,uv="value"in ja?ja.value:ja.textContent,iu=!0)),be=hm(L,Re),0<be.length&&(Re=new Cb(Re,e,null,s,U),N.push({event:Re,listeners:be}),xe?Re.data=xe:(xe=PS(s),xe!==null&&(Re.data=xe)))),(xe=oA?sA(e,s):aA(e,s))&&(L=hm(L,"onBeforeInput"),0<L.length&&(U=new Cb("onBeforeInput","beforeinput",null,s,U),N.push({event:U,listeners:L}),U.data=xe))}jS(N,t)})}function Dd(e,t,s){return{instance:e,listener:t,currentTarget:s}}function hm(e,t){for(var s=t+"Capture",l=[];e!==null;){var f=e,y=f.stateNode;f.tag===5&&y!==null&&(f=y,y=Id(e,s),y!=null&&l.unshift(Dd(e,y,f)),y=Id(e,t),y!=null&&l.push(Dd(e,y,f))),e=e.return}return l}function qc(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Bb(e,t,s,l,f){for(var y=t._reactName,x=[];s!==null&&s!==l;){var u=s,P=u.alternate,L=u.stateNode;if(P!==null&&P===l)break;u.tag===5&&L!==null&&(u=L,f?(P=Id(s,y),P!=null&&x.unshift(Dd(s,P,u))):f||(P=Id(s,y),P!=null&&x.push(Dd(s,P,u)))),s=s.return}x.length!==0&&e.push({event:t,listeners:x})}var bA=/\r\n?/g,wA=/\u0000|\uFFFD/g;function Ob(e){return(typeof e=="string"?e:""+e).replace(bA,`
`).replace(wA,"")}function bf(e,t,s){if(t=Ob(t),Ob(e)!==t&&s)throw Error(Ne(425))}function dm(){}var r0=null,i0=null;function o0(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var s0=typeof setTimeout=="function"?setTimeout:void 0,SA=typeof clearTimeout=="function"?clearTimeout:void 0,Nb=typeof Promise=="function"?Promise:void 0,TA=typeof queueMicrotask=="function"?queueMicrotask:typeof Nb<"u"?function(e){return Nb.resolve(null).then(e).catch(CA)}:s0;function CA(e){setTimeout(function(){throw e})}function m_(e,t){var s=t,l=0;do{var f=s.nextSibling;if(e.removeChild(s),f&&f.nodeType===8)if(s=f.data,s==="/$"){if(l===0){e.removeChild(f),Md(t);return}l--}else s!=="$"&&s!=="$?"&&s!=="$!"||l++;s=f}while(s);Md(t)}function Ha(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function $b(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var s=e.data;if(s==="$"||s==="$!"||s==="$?"){if(t===0)return e;t--}else s==="/$"&&t++}e=e.previousSibling}return null}var Bu=Math.random().toString(36).slice(2),gs="__reactFiber$"+Bu,Fd="__reactProps$"+Bu,Ks="__reactContainer$"+Bu,a0="__reactEvents$"+Bu,kA="__reactListeners$"+Bu,EA="__reactHandles$"+Bu;function Dl(e){var t=e[gs];if(t)return t;for(var s=e.parentNode;s;){if(t=s[Ks]||s[gs]){if(s=t.alternate,t.child!==null||s!==null&&s.child!==null)for(e=$b(e);e!==null;){if(s=e[gs])return s;e=$b(e)}return t}e=s,s=e.parentNode}return null}function Jd(e){return e=e[gs]||e[Ks],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function au(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ne(33))}function Um(e){return e[Fd]||null}var l0=[],lu=-1;function el(e){return{current:e}}function Rn(e){0>lu||(e.current=l0[lu],l0[lu]=null,lu--)}function En(e,t){lu++,l0[lu]=e.current,e.current=t}var Ja={},ri=el(Ja),Ri=el(!1),Gl=Ja;function Iu(e,t){var s=e.type.contextTypes;if(!s)return Ja;var l=e.stateNode;if(l&&l.__reactInternalMemoizedUnmaskedChildContext===t)return l.__reactInternalMemoizedMaskedChildContext;var f={},y;for(y in s)f[y]=t[y];return l&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=f),f}function Di(e){return e=e.childContextTypes,e!=null}function pm(){Rn(Ri),Rn(ri)}function jb(e,t,s){if(ri.current!==Ja)throw Error(Ne(168));En(ri,t),En(Ri,s)}function VS(e,t,s){var l=e.stateNode;if(t=t.childContextTypes,typeof l.getChildContext!="function")return s;l=l.getChildContext();for(var f in l)if(!(f in t))throw Error(Ne(108,hP(e)||"Unknown",f));return qn({},s,l)}function fm(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ja,Gl=ri.current,En(ri,e),En(Ri,Ri.current),!0}function Ub(e,t,s){var l=e.stateNode;if(!l)throw Error(Ne(169));s?(e=VS(e,t,Gl),l.__reactInternalMemoizedMergedChildContext=e,Rn(Ri),Rn(ri),En(ri,e)):Rn(Ri),En(Ri,s)}var Vs=null,Vm=!1,g_=!1;function GS(e){Vs===null?Vs=[e]:Vs.push(e)}function IA(e){Vm=!0,GS(e)}function tl(){if(!g_&&Vs!==null){g_=!0;var e=0,t=mn;try{var s=Vs;for(mn=1;e<s.length;e++){var l=s[e];do l=l(!0);while(l!==null)}Vs=null,Vm=!1}catch(f){throw Vs!==null&&(Vs=Vs.slice(e+1)),mS(sv,tl),f}finally{mn=t,g_=!1}}return null}var cu=[],uu=0,mm=null,gm=0,ko=[],Eo=0,ql=null,Gs=1,qs="";function Pl(e,t){cu[uu++]=gm,cu[uu++]=mm,mm=e,gm=t}function qS(e,t,s){ko[Eo++]=Gs,ko[Eo++]=qs,ko[Eo++]=ql,ql=e;var l=Gs;e=qs;var f=32-Yo(l)-1;l&=~(1<<f),s+=1;var y=32-Yo(t)+f;if(30<y){var x=f-f%5;y=(l&(1<<x)-1).toString(32),l>>=x,f-=x,Gs=1<<32-Yo(t)+f|s<<f|l,qs=y+e}else Gs=1<<y|s<<f|l,qs=e}function mv(e){e.return!==null&&(Pl(e,1),qS(e,1,0))}function gv(e){for(;e===mm;)mm=cu[--uu],cu[uu]=null,gm=cu[--uu],cu[uu]=null;for(;e===ql;)ql=ko[--Eo],ko[Eo]=null,qs=ko[--Eo],ko[Eo]=null,Gs=ko[--Eo],ko[Eo]=null}var oo=null,io=null,Nn=!1,Ko=null;function HS(e,t){var s=Po(5,null,null,0);s.elementType="DELETED",s.stateNode=t,s.return=e,t=e.deletions,t===null?(e.deletions=[s],e.flags|=16):t.push(s)}function Vb(e,t){switch(e.tag){case 5:var s=e.type;return t=t.nodeType!==1||s.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,oo=e,io=Ha(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,oo=e,io=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(s=ql!==null?{id:Gs,overflow:qs}:null,e.memoizedState={dehydrated:t,treeContext:s,retryLane:1073741824},s=Po(18,null,null,0),s.stateNode=t,s.return=e,e.child=s,oo=e,io=null,!0):!1;default:return!1}}function c0(e){return(e.mode&1)!==0&&(e.flags&128)===0}function u0(e){if(Nn){var t=io;if(t){var s=t;if(!Vb(e,t)){if(c0(e))throw Error(Ne(418));t=Ha(s.nextSibling);var l=oo;t&&Vb(e,t)?HS(l,s):(e.flags=e.flags&-4097|2,Nn=!1,oo=e)}}else{if(c0(e))throw Error(Ne(418));e.flags=e.flags&-4097|2,Nn=!1,oo=e}}}function Gb(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;oo=e}function wf(e){if(e!==oo)return!1;if(!Nn)return Gb(e),Nn=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!o0(e.type,e.memoizedProps)),t&&(t=io)){if(c0(e))throw ZS(),Error(Ne(418));for(;t;)HS(e,t),t=Ha(t.nextSibling)}if(Gb(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ne(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var s=e.data;if(s==="/$"){if(t===0){io=Ha(e.nextSibling);break e}t--}else s!=="$"&&s!=="$!"&&s!=="$?"||t++}e=e.nextSibling}io=null}}else io=oo?Ha(e.stateNode.nextSibling):null;return!0}function ZS(){for(var e=io;e;)e=Ha(e.nextSibling)}function Pu(){io=oo=null,Nn=!1}function yv(e){Ko===null?Ko=[e]:Ko.push(e)}var PA=ea.ReactCurrentBatchConfig;function nd(e,t,s){if(e=s.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(Ne(309));var l=s.stateNode}if(!l)throw Error(Ne(147,e));var f=l,y=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===y?t.ref:(t=function(x){var u=f.refs;x===null?delete u[y]:u[y]=x},t._stringRef=y,t)}if(typeof e!="string")throw Error(Ne(284));if(!s._owner)throw Error(Ne(290,e))}return e}function Sf(e,t){throw e=Object.prototype.toString.call(t),Error(Ne(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function qb(e){var t=e._init;return t(e._payload)}function WS(e){function t(X,Z){if(e){var W=X.deletions;W===null?(X.deletions=[Z],X.flags|=16):W.push(Z)}}function s(X,Z){if(!e)return null;for(;Z!==null;)t(X,Z),Z=Z.sibling;return null}function l(X,Z){for(X=new Map;Z!==null;)Z.key!==null?X.set(Z.key,Z):X.set(Z.index,Z),Z=Z.sibling;return X}function f(X,Z){return X=Xa(X,Z),X.index=0,X.sibling=null,X}function y(X,Z,W){return X.index=W,e?(W=X.alternate,W!==null?(W=W.index,W<Z?(X.flags|=2,Z):W):(X.flags|=2,Z)):(X.flags|=1048576,Z)}function x(X){return e&&X.alternate===null&&(X.flags|=2),X}function u(X,Z,W,pe){return Z===null||Z.tag!==6?(Z=S_(W,X.mode,pe),Z.return=X,Z):(Z=f(Z,W),Z.return=X,Z)}function P(X,Z,W,pe){var _e=W.type;return _e===ru?U(X,Z,W.props.children,pe,W.key):Z!==null&&(Z.elementType===_e||typeof _e=="object"&&_e!==null&&_e.$$typeof===Fa&&qb(_e)===Z.type)?(pe=f(Z,W.props),pe.ref=nd(X,Z,W),pe.return=X,pe):(pe=Wf(W.type,W.key,W.props,null,X.mode,pe),pe.ref=nd(X,Z,W),pe.return=X,pe)}function L(X,Z,W,pe){return Z===null||Z.tag!==4||Z.stateNode.containerInfo!==W.containerInfo||Z.stateNode.implementation!==W.implementation?(Z=T_(W,X.mode,pe),Z.return=X,Z):(Z=f(Z,W.children||[]),Z.return=X,Z)}function U(X,Z,W,pe,_e){return Z===null||Z.tag!==7?(Z=jl(W,X.mode,pe,_e),Z.return=X,Z):(Z=f(Z,W),Z.return=X,Z)}function N(X,Z,W){if(typeof Z=="string"&&Z!==""||typeof Z=="number")return Z=S_(""+Z,X.mode,W),Z.return=X,Z;if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case df:return W=Wf(Z.type,Z.key,Z.props,null,X.mode,W),W.ref=nd(X,null,Z),W.return=X,W;case nu:return Z=T_(Z,X.mode,W),Z.return=X,Z;case Fa:var pe=Z._init;return N(X,pe(Z._payload),W)}if(ud(Z)||Yh(Z))return Z=jl(Z,X.mode,W,null),Z.return=X,Z;Sf(X,Z)}return null}function D(X,Z,W,pe){var _e=Z!==null?Z.key:null;if(typeof W=="string"&&W!==""||typeof W=="number")return _e!==null?null:u(X,Z,""+W,pe);if(typeof W=="object"&&W!==null){switch(W.$$typeof){case df:return W.key===_e?P(X,Z,W,pe):null;case nu:return W.key===_e?L(X,Z,W,pe):null;case Fa:return _e=W._init,D(X,Z,_e(W._payload),pe)}if(ud(W)||Yh(W))return _e!==null?null:U(X,Z,W,pe,null);Sf(X,W)}return null}function se(X,Z,W,pe,_e){if(typeof pe=="string"&&pe!==""||typeof pe=="number")return X=X.get(W)||null,u(Z,X,""+pe,_e);if(typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case df:return X=X.get(pe.key===null?W:pe.key)||null,P(Z,X,pe,_e);case nu:return X=X.get(pe.key===null?W:pe.key)||null,L(Z,X,pe,_e);case Fa:var be=pe._init;return se(X,Z,W,be(pe._payload),_e)}if(ud(pe)||Yh(pe))return X=X.get(W)||null,U(Z,X,pe,_e,null);Sf(Z,pe)}return null}function ne(X,Z,W,pe){for(var _e=null,be=null,xe=Z,Re=Z=0,tt=null;xe!==null&&Re<W.length;Re++){xe.index>Re?(tt=xe,xe=null):tt=xe.sibling;var Oe=D(X,xe,W[Re],pe);if(Oe===null){xe===null&&(xe=tt);break}e&&xe&&Oe.alternate===null&&t(X,xe),Z=y(Oe,Z,Re),be===null?_e=Oe:be.sibling=Oe,be=Oe,xe=tt}if(Re===W.length)return s(X,xe),Nn&&Pl(X,Re),_e;if(xe===null){for(;Re<W.length;Re++)xe=N(X,W[Re],pe),xe!==null&&(Z=y(xe,Z,Re),be===null?_e=xe:be.sibling=xe,be=xe);return Nn&&Pl(X,Re),_e}for(xe=l(X,xe);Re<W.length;Re++)tt=se(xe,X,Re,W[Re],pe),tt!==null&&(e&&tt.alternate!==null&&xe.delete(tt.key===null?Re:tt.key),Z=y(tt,Z,Re),be===null?_e=tt:be.sibling=tt,be=tt);return e&&xe.forEach(function(He){return t(X,He)}),Nn&&Pl(X,Re),_e}function ee(X,Z,W,pe){var _e=Yh(W);if(typeof _e!="function")throw Error(Ne(150));if(W=_e.call(W),W==null)throw Error(Ne(151));for(var be=_e=null,xe=Z,Re=Z=0,tt=null,Oe=W.next();xe!==null&&!Oe.done;Re++,Oe=W.next()){xe.index>Re?(tt=xe,xe=null):tt=xe.sibling;var He=D(X,xe,Oe.value,pe);if(He===null){xe===null&&(xe=tt);break}e&&xe&&He.alternate===null&&t(X,xe),Z=y(He,Z,Re),be===null?_e=He:be.sibling=He,be=He,xe=tt}if(Oe.done)return s(X,xe),Nn&&Pl(X,Re),_e;if(xe===null){for(;!Oe.done;Re++,Oe=W.next())Oe=N(X,Oe.value,pe),Oe!==null&&(Z=y(Oe,Z,Re),be===null?_e=Oe:be.sibling=Oe,be=Oe);return Nn&&Pl(X,Re),_e}for(xe=l(X,xe);!Oe.done;Re++,Oe=W.next())Oe=se(xe,X,Re,Oe.value,pe),Oe!==null&&(e&&Oe.alternate!==null&&xe.delete(Oe.key===null?Re:Oe.key),Z=y(Oe,Z,Re),be===null?_e=Oe:be.sibling=Oe,be=Oe);return e&&xe.forEach(function(vt){return t(X,vt)}),Nn&&Pl(X,Re),_e}function ke(X,Z,W,pe){if(typeof W=="object"&&W!==null&&W.type===ru&&W.key===null&&(W=W.props.children),typeof W=="object"&&W!==null){switch(W.$$typeof){case df:e:{for(var _e=W.key,be=Z;be!==null;){if(be.key===_e){if(_e=W.type,_e===ru){if(be.tag===7){s(X,be.sibling),Z=f(be,W.props.children),Z.return=X,X=Z;break e}}else if(be.elementType===_e||typeof _e=="object"&&_e!==null&&_e.$$typeof===Fa&&qb(_e)===be.type){s(X,be.sibling),Z=f(be,W.props),Z.ref=nd(X,be,W),Z.return=X,X=Z;break e}s(X,be);break}else t(X,be);be=be.sibling}W.type===ru?(Z=jl(W.props.children,X.mode,pe,W.key),Z.return=X,X=Z):(pe=Wf(W.type,W.key,W.props,null,X.mode,pe),pe.ref=nd(X,Z,W),pe.return=X,X=pe)}return x(X);case nu:e:{for(be=W.key;Z!==null;){if(Z.key===be)if(Z.tag===4&&Z.stateNode.containerInfo===W.containerInfo&&Z.stateNode.implementation===W.implementation){s(X,Z.sibling),Z=f(Z,W.children||[]),Z.return=X,X=Z;break e}else{s(X,Z);break}else t(X,Z);Z=Z.sibling}Z=T_(W,X.mode,pe),Z.return=X,X=Z}return x(X);case Fa:return be=W._init,ke(X,Z,be(W._payload),pe)}if(ud(W))return ne(X,Z,W,pe);if(Yh(W))return ee(X,Z,W,pe);Sf(X,W)}return typeof W=="string"&&W!==""||typeof W=="number"?(W=""+W,Z!==null&&Z.tag===6?(s(X,Z.sibling),Z=f(Z,W),Z.return=X,X=Z):(s(X,Z),Z=S_(W,X.mode,pe),Z.return=X,X=Z),x(X)):s(X,Z)}return ke}var Au=WS(!0),KS=WS(!1),ym=el(null),_m=null,hu=null,_v=null;function vv(){_v=hu=_m=null}function xv(e){var t=ym.current;Rn(ym),e._currentValue=t}function h0(e,t,s){for(;e!==null;){var l=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,l!==null&&(l.childLanes|=t)):l!==null&&(l.childLanes&t)!==t&&(l.childLanes|=t),e===s)break;e=e.return}}function _u(e,t){_m=e,_v=hu=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Li=!0),e.firstContext=null)}function zo(e){var t=e._currentValue;if(_v!==e)if(e={context:e,memoizedValue:t,next:null},hu===null){if(_m===null)throw Error(Ne(308));hu=e,_m.dependencies={lanes:0,firstContext:e}}else hu=hu.next=e;return t}var Fl=null;function bv(e){Fl===null?Fl=[e]:Fl.push(e)}function XS(e,t,s,l){var f=t.interleaved;return f===null?(s.next=s,bv(t)):(s.next=f.next,f.next=s),t.interleaved=s,Xs(e,l)}function Xs(e,t){e.lanes|=t;var s=e.alternate;for(s!==null&&(s.lanes|=t),s=e,e=e.return;e!==null;)e.childLanes|=t,s=e.alternate,s!==null&&(s.childLanes|=t),s=e,e=e.return;return s.tag===3?s.stateNode:null}var Ba=!1;function wv(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function YS(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Hs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Za(e,t,s){var l=e.updateQueue;if(l===null)return null;if(l=l.shared,Jt&2){var f=l.pending;return f===null?t.next=t:(t.next=f.next,f.next=t),l.pending=t,Xs(e,s)}return f=l.interleaved,f===null?(t.next=t,bv(l)):(t.next=f.next,f.next=t),l.interleaved=t,Xs(e,s)}function Uf(e,t,s){if(t=t.updateQueue,t!==null&&(t=t.shared,(s&4194240)!==0)){var l=t.lanes;l&=e.pendingLanes,s|=l,t.lanes=s,av(e,s)}}function Hb(e,t){var s=e.updateQueue,l=e.alternate;if(l!==null&&(l=l.updateQueue,s===l)){var f=null,y=null;if(s=s.firstBaseUpdate,s!==null){do{var x={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};y===null?f=y=x:y=y.next=x,s=s.next}while(s!==null);y===null?f=y=t:y=y.next=t}else f=y=t;s={baseState:l.baseState,firstBaseUpdate:f,lastBaseUpdate:y,shared:l.shared,effects:l.effects},e.updateQueue=s;return}e=s.lastBaseUpdate,e===null?s.firstBaseUpdate=t:e.next=t,s.lastBaseUpdate=t}function vm(e,t,s,l){var f=e.updateQueue;Ba=!1;var y=f.firstBaseUpdate,x=f.lastBaseUpdate,u=f.shared.pending;if(u!==null){f.shared.pending=null;var P=u,L=P.next;P.next=null,x===null?y=L:x.next=L,x=P;var U=e.alternate;U!==null&&(U=U.updateQueue,u=U.lastBaseUpdate,u!==x&&(u===null?U.firstBaseUpdate=L:u.next=L,U.lastBaseUpdate=P))}if(y!==null){var N=f.baseState;x=0,U=L=P=null,u=y;do{var D=u.lane,se=u.eventTime;if((l&D)===D){U!==null&&(U=U.next={eventTime:se,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var ne=e,ee=u;switch(D=t,se=s,ee.tag){case 1:if(ne=ee.payload,typeof ne=="function"){N=ne.call(se,N,D);break e}N=ne;break e;case 3:ne.flags=ne.flags&-65537|128;case 0:if(ne=ee.payload,D=typeof ne=="function"?ne.call(se,N,D):ne,D==null)break e;N=qn({},N,D);break e;case 2:Ba=!0}}u.callback!==null&&u.lane!==0&&(e.flags|=64,D=f.effects,D===null?f.effects=[u]:D.push(u))}else se={eventTime:se,lane:D,tag:u.tag,payload:u.payload,callback:u.callback,next:null},U===null?(L=U=se,P=N):U=U.next=se,x|=D;if(u=u.next,u===null){if(u=f.shared.pending,u===null)break;D=u,u=D.next,D.next=null,f.lastBaseUpdate=D,f.shared.pending=null}}while(!0);if(U===null&&(P=N),f.baseState=P,f.firstBaseUpdate=L,f.lastBaseUpdate=U,t=f.shared.interleaved,t!==null){f=t;do x|=f.lane,f=f.next;while(f!==t)}else y===null&&(f.shared.lanes=0);Zl|=x,e.lanes=x,e.memoizedState=N}}function Zb(e,t,s){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var l=e[t],f=l.callback;if(f!==null){if(l.callback=null,l=s,typeof f!="function")throw Error(Ne(191,f));f.call(l)}}}var Qd={},_s=el(Qd),Bd=el(Qd),Od=el(Qd);function Bl(e){if(e===Qd)throw Error(Ne(174));return e}function Sv(e,t){switch(En(Od,t),En(Bd,e),En(_s,Qd),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:q_(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=q_(t,e)}Rn(_s),En(_s,t)}function Mu(){Rn(_s),Rn(Bd),Rn(Od)}function JS(e){Bl(Od.current);var t=Bl(_s.current),s=q_(t,e.type);t!==s&&(En(Bd,e),En(_s,s))}function Tv(e){Bd.current===e&&(Rn(_s),Rn(Bd))}var Vn=el(0);function xm(e){for(var t=e;t!==null;){if(t.tag===13){var s=t.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var y_=[];function Cv(){for(var e=0;e<y_.length;e++)y_[e]._workInProgressVersionPrimary=null;y_.length=0}var Vf=ea.ReactCurrentDispatcher,__=ea.ReactCurrentBatchConfig,Hl=0,Gn=null,fr=null,Er=null,bm=!1,xd=!1,Nd=0,AA=0;function Qr(){throw Error(Ne(321))}function kv(e,t){if(t===null)return!1;for(var s=0;s<t.length&&s<e.length;s++)if(!Qo(e[s],t[s]))return!1;return!0}function Ev(e,t,s,l,f,y){if(Hl=y,Gn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Vf.current=e===null||e.memoizedState===null?RA:DA,e=s(l,f),xd){y=0;do{if(xd=!1,Nd=0,25<=y)throw Error(Ne(301));y+=1,Er=fr=null,t.updateQueue=null,Vf.current=FA,e=s(l,f)}while(xd)}if(Vf.current=wm,t=fr!==null&&fr.next!==null,Hl=0,Er=fr=Gn=null,bm=!1,t)throw Error(Ne(300));return e}function Iv(){var e=Nd!==0;return Nd=0,e}function ds(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Er===null?Gn.memoizedState=Er=e:Er=Er.next=e,Er}function Lo(){if(fr===null){var e=Gn.alternate;e=e!==null?e.memoizedState:null}else e=fr.next;var t=Er===null?Gn.memoizedState:Er.next;if(t!==null)Er=t,fr=e;else{if(e===null)throw Error(Ne(310));fr=e,e={memoizedState:fr.memoizedState,baseState:fr.baseState,baseQueue:fr.baseQueue,queue:fr.queue,next:null},Er===null?Gn.memoizedState=Er=e:Er=Er.next=e}return Er}function $d(e,t){return typeof t=="function"?t(e):t}function v_(e){var t=Lo(),s=t.queue;if(s===null)throw Error(Ne(311));s.lastRenderedReducer=e;var l=fr,f=l.baseQueue,y=s.pending;if(y!==null){if(f!==null){var x=f.next;f.next=y.next,y.next=x}l.baseQueue=f=y,s.pending=null}if(f!==null){y=f.next,l=l.baseState;var u=x=null,P=null,L=y;do{var U=L.lane;if((Hl&U)===U)P!==null&&(P=P.next={lane:0,action:L.action,hasEagerState:L.hasEagerState,eagerState:L.eagerState,next:null}),l=L.hasEagerState?L.eagerState:e(l,L.action);else{var N={lane:U,action:L.action,hasEagerState:L.hasEagerState,eagerState:L.eagerState,next:null};P===null?(u=P=N,x=l):P=P.next=N,Gn.lanes|=U,Zl|=U}L=L.next}while(L!==null&&L!==y);P===null?x=l:P.next=u,Qo(l,t.memoizedState)||(Li=!0),t.memoizedState=l,t.baseState=x,t.baseQueue=P,s.lastRenderedState=l}if(e=s.interleaved,e!==null){f=e;do y=f.lane,Gn.lanes|=y,Zl|=y,f=f.next;while(f!==e)}else f===null&&(s.lanes=0);return[t.memoizedState,s.dispatch]}function x_(e){var t=Lo(),s=t.queue;if(s===null)throw Error(Ne(311));s.lastRenderedReducer=e;var l=s.dispatch,f=s.pending,y=t.memoizedState;if(f!==null){s.pending=null;var x=f=f.next;do y=e(y,x.action),x=x.next;while(x!==f);Qo(y,t.memoizedState)||(Li=!0),t.memoizedState=y,t.baseQueue===null&&(t.baseState=y),s.lastRenderedState=y}return[y,l]}function QS(){}function eT(e,t){var s=Gn,l=Lo(),f=t(),y=!Qo(l.memoizedState,f);if(y&&(l.memoizedState=f,Li=!0),l=l.queue,Pv(rT.bind(null,s,l,e),[e]),l.getSnapshot!==t||y||Er!==null&&Er.memoizedState.tag&1){if(s.flags|=2048,jd(9,nT.bind(null,s,l,f,t),void 0,null),Pr===null)throw Error(Ne(349));Hl&30||tT(s,t,f)}return f}function tT(e,t,s){e.flags|=16384,e={getSnapshot:t,value:s},t=Gn.updateQueue,t===null?(t={lastEffect:null,stores:null},Gn.updateQueue=t,t.stores=[e]):(s=t.stores,s===null?t.stores=[e]:s.push(e))}function nT(e,t,s,l){t.value=s,t.getSnapshot=l,iT(t)&&oT(e)}function rT(e,t,s){return s(function(){iT(t)&&oT(e)})}function iT(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!Qo(e,s)}catch{return!0}}function oT(e){var t=Xs(e,1);t!==null&&Jo(t,e,1,-1)}function Wb(e){var t=ds();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$d,lastRenderedState:e},t.queue=e,e=e.dispatch=LA.bind(null,Gn,e),[t.memoizedState,e]}function jd(e,t,s,l){return e={tag:e,create:t,destroy:s,deps:l,next:null},t=Gn.updateQueue,t===null?(t={lastEffect:null,stores:null},Gn.updateQueue=t,t.lastEffect=e.next=e):(s=t.lastEffect,s===null?t.lastEffect=e.next=e:(l=s.next,s.next=e,e.next=l,t.lastEffect=e)),e}function sT(){return Lo().memoizedState}function Gf(e,t,s,l){var f=ds();Gn.flags|=e,f.memoizedState=jd(1|t,s,void 0,l===void 0?null:l)}function Gm(e,t,s,l){var f=Lo();l=l===void 0?null:l;var y=void 0;if(fr!==null){var x=fr.memoizedState;if(y=x.destroy,l!==null&&kv(l,x.deps)){f.memoizedState=jd(t,s,y,l);return}}Gn.flags|=e,f.memoizedState=jd(1|t,s,y,l)}function Kb(e,t){return Gf(8390656,8,e,t)}function Pv(e,t){return Gm(2048,8,e,t)}function aT(e,t){return Gm(4,2,e,t)}function lT(e,t){return Gm(4,4,e,t)}function cT(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function uT(e,t,s){return s=s!=null?s.concat([e]):null,Gm(4,4,cT.bind(null,t,e),s)}function Av(){}function hT(e,t){var s=Lo();t=t===void 0?null:t;var l=s.memoizedState;return l!==null&&t!==null&&kv(t,l[1])?l[0]:(s.memoizedState=[e,t],e)}function dT(e,t){var s=Lo();t=t===void 0?null:t;var l=s.memoizedState;return l!==null&&t!==null&&kv(t,l[1])?l[0]:(e=e(),s.memoizedState=[e,t],e)}function pT(e,t,s){return Hl&21?(Qo(s,t)||(s=_S(),Gn.lanes|=s,Zl|=s,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Li=!0),e.memoizedState=s)}function MA(e,t){var s=mn;mn=s!==0&&4>s?s:4,e(!0);var l=__.transition;__.transition={};try{e(!1),t()}finally{mn=s,__.transition=l}}function fT(){return Lo().memoizedState}function zA(e,t,s){var l=Ka(e);if(s={lane:l,action:s,hasEagerState:!1,eagerState:null,next:null},mT(e))gT(t,s);else if(s=XS(e,t,s,l),s!==null){var f=_i();Jo(s,e,l,f),yT(s,t,l)}}function LA(e,t,s){var l=Ka(e),f={lane:l,action:s,hasEagerState:!1,eagerState:null,next:null};if(mT(e))gT(t,f);else{var y=e.alternate;if(e.lanes===0&&(y===null||y.lanes===0)&&(y=t.lastRenderedReducer,y!==null))try{var x=t.lastRenderedState,u=y(x,s);if(f.hasEagerState=!0,f.eagerState=u,Qo(u,x)){var P=t.interleaved;P===null?(f.next=f,bv(t)):(f.next=P.next,P.next=f),t.interleaved=f;return}}catch{}finally{}s=XS(e,t,f,l),s!==null&&(f=_i(),Jo(s,e,l,f),yT(s,t,l))}}function mT(e){var t=e.alternate;return e===Gn||t!==null&&t===Gn}function gT(e,t){xd=bm=!0;var s=e.pending;s===null?t.next=t:(t.next=s.next,s.next=t),e.pending=t}function yT(e,t,s){if(s&4194240){var l=t.lanes;l&=e.pendingLanes,s|=l,t.lanes=s,av(e,s)}}var wm={readContext:zo,useCallback:Qr,useContext:Qr,useEffect:Qr,useImperativeHandle:Qr,useInsertionEffect:Qr,useLayoutEffect:Qr,useMemo:Qr,useReducer:Qr,useRef:Qr,useState:Qr,useDebugValue:Qr,useDeferredValue:Qr,useTransition:Qr,useMutableSource:Qr,useSyncExternalStore:Qr,useId:Qr,unstable_isNewReconciler:!1},RA={readContext:zo,useCallback:function(e,t){return ds().memoizedState=[e,t===void 0?null:t],e},useContext:zo,useEffect:Kb,useImperativeHandle:function(e,t,s){return s=s!=null?s.concat([e]):null,Gf(4194308,4,cT.bind(null,t,e),s)},useLayoutEffect:function(e,t){return Gf(4194308,4,e,t)},useInsertionEffect:function(e,t){return Gf(4,2,e,t)},useMemo:function(e,t){var s=ds();return t=t===void 0?null:t,e=e(),s.memoizedState=[e,t],e},useReducer:function(e,t,s){var l=ds();return t=s!==void 0?s(t):t,l.memoizedState=l.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},l.queue=e,e=e.dispatch=zA.bind(null,Gn,e),[l.memoizedState,e]},useRef:function(e){var t=ds();return e={current:e},t.memoizedState=e},useState:Wb,useDebugValue:Av,useDeferredValue:function(e){return ds().memoizedState=e},useTransition:function(){var e=Wb(!1),t=e[0];return e=MA.bind(null,e[1]),ds().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,s){var l=Gn,f=ds();if(Nn){if(s===void 0)throw Error(Ne(407));s=s()}else{if(s=t(),Pr===null)throw Error(Ne(349));Hl&30||tT(l,t,s)}f.memoizedState=s;var y={value:s,getSnapshot:t};return f.queue=y,Kb(rT.bind(null,l,y,e),[e]),l.flags|=2048,jd(9,nT.bind(null,l,y,s,t),void 0,null),s},useId:function(){var e=ds(),t=Pr.identifierPrefix;if(Nn){var s=qs,l=Gs;s=(l&~(1<<32-Yo(l)-1)).toString(32)+s,t=":"+t+"R"+s,s=Nd++,0<s&&(t+="H"+s.toString(32)),t+=":"}else s=AA++,t=":"+t+"r"+s.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},DA={readContext:zo,useCallback:hT,useContext:zo,useEffect:Pv,useImperativeHandle:uT,useInsertionEffect:aT,useLayoutEffect:lT,useMemo:dT,useReducer:v_,useRef:sT,useState:function(){return v_($d)},useDebugValue:Av,useDeferredValue:function(e){var t=Lo();return pT(t,fr.memoizedState,e)},useTransition:function(){var e=v_($d)[0],t=Lo().memoizedState;return[e,t]},useMutableSource:QS,useSyncExternalStore:eT,useId:fT,unstable_isNewReconciler:!1},FA={readContext:zo,useCallback:hT,useContext:zo,useEffect:Pv,useImperativeHandle:uT,useInsertionEffect:aT,useLayoutEffect:lT,useMemo:dT,useReducer:x_,useRef:sT,useState:function(){return x_($d)},useDebugValue:Av,useDeferredValue:function(e){var t=Lo();return fr===null?t.memoizedState=e:pT(t,fr.memoizedState,e)},useTransition:function(){var e=x_($d)[0],t=Lo().memoizedState;return[e,t]},useMutableSource:QS,useSyncExternalStore:eT,useId:fT,unstable_isNewReconciler:!1};function Zo(e,t){if(e&&e.defaultProps){t=qn({},t),e=e.defaultProps;for(var s in e)t[s]===void 0&&(t[s]=e[s]);return t}return t}function d0(e,t,s,l){t=e.memoizedState,s=s(l,t),s=s==null?t:qn({},t,s),e.memoizedState=s,e.lanes===0&&(e.updateQueue.baseState=s)}var qm={isMounted:function(e){return(e=e._reactInternals)?Xl(e)===e:!1},enqueueSetState:function(e,t,s){e=e._reactInternals;var l=_i(),f=Ka(e),y=Hs(l,f);y.payload=t,s!=null&&(y.callback=s),t=Za(e,y,f),t!==null&&(Jo(t,e,f,l),Uf(t,e,f))},enqueueReplaceState:function(e,t,s){e=e._reactInternals;var l=_i(),f=Ka(e),y=Hs(l,f);y.tag=1,y.payload=t,s!=null&&(y.callback=s),t=Za(e,y,f),t!==null&&(Jo(t,e,f,l),Uf(t,e,f))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var s=_i(),l=Ka(e),f=Hs(s,l);f.tag=2,t!=null&&(f.callback=t),t=Za(e,f,l),t!==null&&(Jo(t,e,l,s),Uf(t,e,l))}};function Xb(e,t,s,l,f,y,x){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(l,y,x):t.prototype&&t.prototype.isPureReactComponent?!Ld(s,l)||!Ld(f,y):!0}function _T(e,t,s){var l=!1,f=Ja,y=t.contextType;return typeof y=="object"&&y!==null?y=zo(y):(f=Di(t)?Gl:ri.current,l=t.contextTypes,y=(l=l!=null)?Iu(e,f):Ja),t=new t(s,y),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=qm,e.stateNode=t,t._reactInternals=e,l&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=f,e.__reactInternalMemoizedMaskedChildContext=y),t}function Yb(e,t,s,l){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(s,l),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(s,l),t.state!==e&&qm.enqueueReplaceState(t,t.state,null)}function p0(e,t,s,l){var f=e.stateNode;f.props=s,f.state=e.memoizedState,f.refs={},wv(e);var y=t.contextType;typeof y=="object"&&y!==null?f.context=zo(y):(y=Di(t)?Gl:ri.current,f.context=Iu(e,y)),f.state=e.memoizedState,y=t.getDerivedStateFromProps,typeof y=="function"&&(d0(e,t,y,s),f.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(t=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),t!==f.state&&qm.enqueueReplaceState(f,f.state,null),vm(e,s,f,l),f.state=e.memoizedState),typeof f.componentDidMount=="function"&&(e.flags|=4194308)}function zu(e,t){try{var s="",l=t;do s+=uP(l),l=l.return;while(l);var f=s}catch(y){f=`
Error generating stack: `+y.message+`
`+y.stack}return{value:e,source:t,stack:f,digest:null}}function b_(e,t,s){return{value:e,source:null,stack:s??null,digest:t??null}}function f0(e,t){try{console.error(t.value)}catch(s){setTimeout(function(){throw s})}}var BA=typeof WeakMap=="function"?WeakMap:Map;function vT(e,t,s){s=Hs(-1,s),s.tag=3,s.payload={element:null};var l=t.value;return s.callback=function(){Tm||(Tm=!0,T0=l),f0(e,t)},s}function xT(e,t,s){s=Hs(-1,s),s.tag=3;var l=e.type.getDerivedStateFromError;if(typeof l=="function"){var f=t.value;s.payload=function(){return l(f)},s.callback=function(){f0(e,t)}}var y=e.stateNode;return y!==null&&typeof y.componentDidCatch=="function"&&(s.callback=function(){f0(e,t),typeof l!="function"&&(Wa===null?Wa=new Set([this]):Wa.add(this));var x=t.stack;this.componentDidCatch(t.value,{componentStack:x!==null?x:""})}),s}function Jb(e,t,s){var l=e.pingCache;if(l===null){l=e.pingCache=new BA;var f=new Set;l.set(t,f)}else f=l.get(t),f===void 0&&(f=new Set,l.set(t,f));f.has(s)||(f.add(s),e=YA.bind(null,e,t,s),t.then(e,e))}function Qb(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function ew(e,t,s,l,f){return e.mode&1?(e.flags|=65536,e.lanes=f,e):(e===t?e.flags|=65536:(e.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(t=Hs(-1,1),t.tag=2,Za(s,t,1))),s.lanes|=1),e)}var OA=ea.ReactCurrentOwner,Li=!1;function yi(e,t,s,l){t.child=e===null?KS(t,null,s,l):Au(t,e.child,s,l)}function tw(e,t,s,l,f){s=s.render;var y=t.ref;return _u(t,f),l=Ev(e,t,s,l,y,f),s=Iv(),e!==null&&!Li?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~f,Ys(e,t,f)):(Nn&&s&&mv(t),t.flags|=1,yi(e,t,l,f),t.child)}function nw(e,t,s,l,f){if(e===null){var y=s.type;return typeof y=="function"&&!Ov(y)&&y.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(t.tag=15,t.type=y,bT(e,t,y,l,f)):(e=Wf(s.type,null,l,t,t.mode,f),e.ref=t.ref,e.return=t,t.child=e)}if(y=e.child,!(e.lanes&f)){var x=y.memoizedProps;if(s=s.compare,s=s!==null?s:Ld,s(x,l)&&e.ref===t.ref)return Ys(e,t,f)}return t.flags|=1,e=Xa(y,l),e.ref=t.ref,e.return=t,t.child=e}function bT(e,t,s,l,f){if(e!==null){var y=e.memoizedProps;if(Ld(y,l)&&e.ref===t.ref)if(Li=!1,t.pendingProps=l=y,(e.lanes&f)!==0)e.flags&131072&&(Li=!0);else return t.lanes=e.lanes,Ys(e,t,f)}return m0(e,t,s,l,f)}function wT(e,t,s){var l=t.pendingProps,f=l.children,y=e!==null?e.memoizedState:null;if(l.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},En(pu,no),no|=s;else{if(!(s&1073741824))return e=y!==null?y.baseLanes|s:s,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,En(pu,no),no|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},l=y!==null?y.baseLanes:s,En(pu,no),no|=l}else y!==null?(l=y.baseLanes|s,t.memoizedState=null):l=s,En(pu,no),no|=l;return yi(e,t,f,s),t.child}function ST(e,t){var s=t.ref;(e===null&&s!==null||e!==null&&e.ref!==s)&&(t.flags|=512,t.flags|=2097152)}function m0(e,t,s,l,f){var y=Di(s)?Gl:ri.current;return y=Iu(t,y),_u(t,f),s=Ev(e,t,s,l,y,f),l=Iv(),e!==null&&!Li?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~f,Ys(e,t,f)):(Nn&&l&&mv(t),t.flags|=1,yi(e,t,s,f),t.child)}function rw(e,t,s,l,f){if(Di(s)){var y=!0;fm(t)}else y=!1;if(_u(t,f),t.stateNode===null)qf(e,t),_T(t,s,l),p0(t,s,l,f),l=!0;else if(e===null){var x=t.stateNode,u=t.memoizedProps;x.props=u;var P=x.context,L=s.contextType;typeof L=="object"&&L!==null?L=zo(L):(L=Di(s)?Gl:ri.current,L=Iu(t,L));var U=s.getDerivedStateFromProps,N=typeof U=="function"||typeof x.getSnapshotBeforeUpdate=="function";N||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(u!==l||P!==L)&&Yb(t,x,l,L),Ba=!1;var D=t.memoizedState;x.state=D,vm(t,l,x,f),P=t.memoizedState,u!==l||D!==P||Ri.current||Ba?(typeof U=="function"&&(d0(t,s,U,l),P=t.memoizedState),(u=Ba||Xb(t,s,u,l,D,P,L))?(N||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(t.flags|=4194308)):(typeof x.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=l,t.memoizedState=P),x.props=l,x.state=P,x.context=L,l=u):(typeof x.componentDidMount=="function"&&(t.flags|=4194308),l=!1)}else{x=t.stateNode,YS(e,t),u=t.memoizedProps,L=t.type===t.elementType?u:Zo(t.type,u),x.props=L,N=t.pendingProps,D=x.context,P=s.contextType,typeof P=="object"&&P!==null?P=zo(P):(P=Di(s)?Gl:ri.current,P=Iu(t,P));var se=s.getDerivedStateFromProps;(U=typeof se=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(u!==N||D!==P)&&Yb(t,x,l,P),Ba=!1,D=t.memoizedState,x.state=D,vm(t,l,x,f);var ne=t.memoizedState;u!==N||D!==ne||Ri.current||Ba?(typeof se=="function"&&(d0(t,s,se,l),ne=t.memoizedState),(L=Ba||Xb(t,s,L,l,D,ne,P)||!1)?(U||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(l,ne,P),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(l,ne,P)),typeof x.componentDidUpdate=="function"&&(t.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof x.componentDidUpdate!="function"||u===e.memoizedProps&&D===e.memoizedState||(t.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&D===e.memoizedState||(t.flags|=1024),t.memoizedProps=l,t.memoizedState=ne),x.props=l,x.state=ne,x.context=P,l=L):(typeof x.componentDidUpdate!="function"||u===e.memoizedProps&&D===e.memoizedState||(t.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&D===e.memoizedState||(t.flags|=1024),l=!1)}return g0(e,t,s,l,y,f)}function g0(e,t,s,l,f,y){ST(e,t);var x=(t.flags&128)!==0;if(!l&&!x)return f&&Ub(t,s,!1),Ys(e,t,y);l=t.stateNode,OA.current=t;var u=x&&typeof s.getDerivedStateFromError!="function"?null:l.render();return t.flags|=1,e!==null&&x?(t.child=Au(t,e.child,null,y),t.child=Au(t,null,u,y)):yi(e,t,u,y),t.memoizedState=l.state,f&&Ub(t,s,!0),t.child}function TT(e){var t=e.stateNode;t.pendingContext?jb(e,t.pendingContext,t.pendingContext!==t.context):t.context&&jb(e,t.context,!1),Sv(e,t.containerInfo)}function iw(e,t,s,l,f){return Pu(),yv(f),t.flags|=256,yi(e,t,s,l),t.child}var y0={dehydrated:null,treeContext:null,retryLane:0};function _0(e){return{baseLanes:e,cachePool:null,transitions:null}}function CT(e,t,s){var l=t.pendingProps,f=Vn.current,y=!1,x=(t.flags&128)!==0,u;if((u=x)||(u=e!==null&&e.memoizedState===null?!1:(f&2)!==0),u?(y=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(f|=1),En(Vn,f&1),e===null)return u0(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(x=l.children,e=l.fallback,y?(l=t.mode,y=t.child,x={mode:"hidden",children:x},!(l&1)&&y!==null?(y.childLanes=0,y.pendingProps=x):y=Wm(x,l,0,null),e=jl(e,l,s,null),y.return=t,e.return=t,y.sibling=e,t.child=y,t.child.memoizedState=_0(s),t.memoizedState=y0,e):Mv(t,x));if(f=e.memoizedState,f!==null&&(u=f.dehydrated,u!==null))return NA(e,t,x,l,u,f,s);if(y){y=l.fallback,x=t.mode,f=e.child,u=f.sibling;var P={mode:"hidden",children:l.children};return!(x&1)&&t.child!==f?(l=t.child,l.childLanes=0,l.pendingProps=P,t.deletions=null):(l=Xa(f,P),l.subtreeFlags=f.subtreeFlags&14680064),u!==null?y=Xa(u,y):(y=jl(y,x,s,null),y.flags|=2),y.return=t,l.return=t,l.sibling=y,t.child=l,l=y,y=t.child,x=e.child.memoizedState,x=x===null?_0(s):{baseLanes:x.baseLanes|s,cachePool:null,transitions:x.transitions},y.memoizedState=x,y.childLanes=e.childLanes&~s,t.memoizedState=y0,l}return y=e.child,e=y.sibling,l=Xa(y,{mode:"visible",children:l.children}),!(t.mode&1)&&(l.lanes=s),l.return=t,l.sibling=null,e!==null&&(s=t.deletions,s===null?(t.deletions=[e],t.flags|=16):s.push(e)),t.child=l,t.memoizedState=null,l}function Mv(e,t){return t=Wm({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Tf(e,t,s,l){return l!==null&&yv(l),Au(t,e.child,null,s),e=Mv(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function NA(e,t,s,l,f,y,x){if(s)return t.flags&256?(t.flags&=-257,l=b_(Error(Ne(422))),Tf(e,t,x,l)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(y=l.fallback,f=t.mode,l=Wm({mode:"visible",children:l.children},f,0,null),y=jl(y,f,x,null),y.flags|=2,l.return=t,y.return=t,l.sibling=y,t.child=l,t.mode&1&&Au(t,e.child,null,x),t.child.memoizedState=_0(x),t.memoizedState=y0,y);if(!(t.mode&1))return Tf(e,t,x,null);if(f.data==="$!"){if(l=f.nextSibling&&f.nextSibling.dataset,l)var u=l.dgst;return l=u,y=Error(Ne(419)),l=b_(y,l,void 0),Tf(e,t,x,l)}if(u=(x&e.childLanes)!==0,Li||u){if(l=Pr,l!==null){switch(x&-x){case 4:f=2;break;case 16:f=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:f=32;break;case 536870912:f=268435456;break;default:f=0}f=f&(l.suspendedLanes|x)?0:f,f!==0&&f!==y.retryLane&&(y.retryLane=f,Xs(e,f),Jo(l,e,f,-1))}return Bv(),l=b_(Error(Ne(421))),Tf(e,t,x,l)}return f.data==="$?"?(t.flags|=128,t.child=e.child,t=JA.bind(null,e),f._reactRetry=t,null):(e=y.treeContext,io=Ha(f.nextSibling),oo=t,Nn=!0,Ko=null,e!==null&&(ko[Eo++]=Gs,ko[Eo++]=qs,ko[Eo++]=ql,Gs=e.id,qs=e.overflow,ql=t),t=Mv(t,l.children),t.flags|=4096,t)}function ow(e,t,s){e.lanes|=t;var l=e.alternate;l!==null&&(l.lanes|=t),h0(e.return,t,s)}function w_(e,t,s,l,f){var y=e.memoizedState;y===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:l,tail:s,tailMode:f}:(y.isBackwards=t,y.rendering=null,y.renderingStartTime=0,y.last=l,y.tail=s,y.tailMode=f)}function kT(e,t,s){var l=t.pendingProps,f=l.revealOrder,y=l.tail;if(yi(e,t,l.children,s),l=Vn.current,l&2)l=l&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&ow(e,s,t);else if(e.tag===19)ow(e,s,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}l&=1}if(En(Vn,l),!(t.mode&1))t.memoizedState=null;else switch(f){case"forwards":for(s=t.child,f=null;s!==null;)e=s.alternate,e!==null&&xm(e)===null&&(f=s),s=s.sibling;s=f,s===null?(f=t.child,t.child=null):(f=s.sibling,s.sibling=null),w_(t,!1,f,s,y);break;case"backwards":for(s=null,f=t.child,t.child=null;f!==null;){if(e=f.alternate,e!==null&&xm(e)===null){t.child=f;break}e=f.sibling,f.sibling=s,s=f,f=e}w_(t,!0,s,null,y);break;case"together":w_(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function qf(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ys(e,t,s){if(e!==null&&(t.dependencies=e.dependencies),Zl|=t.lanes,!(s&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Ne(153));if(t.child!==null){for(e=t.child,s=Xa(e,e.pendingProps),t.child=s,s.return=t;e.sibling!==null;)e=e.sibling,s=s.sibling=Xa(e,e.pendingProps),s.return=t;s.sibling=null}return t.child}function $A(e,t,s){switch(t.tag){case 3:TT(t),Pu();break;case 5:JS(t);break;case 1:Di(t.type)&&fm(t);break;case 4:Sv(t,t.stateNode.containerInfo);break;case 10:var l=t.type._context,f=t.memoizedProps.value;En(ym,l._currentValue),l._currentValue=f;break;case 13:if(l=t.memoizedState,l!==null)return l.dehydrated!==null?(En(Vn,Vn.current&1),t.flags|=128,null):s&t.child.childLanes?CT(e,t,s):(En(Vn,Vn.current&1),e=Ys(e,t,s),e!==null?e.sibling:null);En(Vn,Vn.current&1);break;case 19:if(l=(s&t.childLanes)!==0,e.flags&128){if(l)return kT(e,t,s);t.flags|=128}if(f=t.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),En(Vn,Vn.current),l)break;return null;case 22:case 23:return t.lanes=0,wT(e,t,s)}return Ys(e,t,s)}var ET,v0,IT,PT;ET=function(e,t){for(var s=t.child;s!==null;){if(s.tag===5||s.tag===6)e.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};v0=function(){};IT=function(e,t,s,l){var f=e.memoizedProps;if(f!==l){e=t.stateNode,Bl(_s.current);var y=null;switch(s){case"input":f=j_(e,f),l=j_(e,l),y=[];break;case"select":f=qn({},f,{value:void 0}),l=qn({},l,{value:void 0}),y=[];break;case"textarea":f=G_(e,f),l=G_(e,l),y=[];break;default:typeof f.onClick!="function"&&typeof l.onClick=="function"&&(e.onclick=dm)}H_(s,l);var x;s=null;for(L in f)if(!l.hasOwnProperty(L)&&f.hasOwnProperty(L)&&f[L]!=null)if(L==="style"){var u=f[L];for(x in u)u.hasOwnProperty(x)&&(s||(s={}),s[x]="")}else L!=="dangerouslySetInnerHTML"&&L!=="children"&&L!=="suppressContentEditableWarning"&&L!=="suppressHydrationWarning"&&L!=="autoFocus"&&(kd.hasOwnProperty(L)?y||(y=[]):(y=y||[]).push(L,null));for(L in l){var P=l[L];if(u=f!=null?f[L]:void 0,l.hasOwnProperty(L)&&P!==u&&(P!=null||u!=null))if(L==="style")if(u){for(x in u)!u.hasOwnProperty(x)||P&&P.hasOwnProperty(x)||(s||(s={}),s[x]="");for(x in P)P.hasOwnProperty(x)&&u[x]!==P[x]&&(s||(s={}),s[x]=P[x])}else s||(y||(y=[]),y.push(L,s)),s=P;else L==="dangerouslySetInnerHTML"?(P=P?P.__html:void 0,u=u?u.__html:void 0,P!=null&&u!==P&&(y=y||[]).push(L,P)):L==="children"?typeof P!="string"&&typeof P!="number"||(y=y||[]).push(L,""+P):L!=="suppressContentEditableWarning"&&L!=="suppressHydrationWarning"&&(kd.hasOwnProperty(L)?(P!=null&&L==="onScroll"&&Ln("scroll",e),y||u===P||(y=[])):(y=y||[]).push(L,P))}s&&(y=y||[]).push("style",s);var L=y;(t.updateQueue=L)&&(t.flags|=4)}};PT=function(e,t,s,l){s!==l&&(t.flags|=4)};function rd(e,t){if(!Nn)switch(e.tailMode){case"hidden":t=e.tail;for(var s=null;t!==null;)t.alternate!==null&&(s=t),t=t.sibling;s===null?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var l=null;s!==null;)s.alternate!==null&&(l=s),s=s.sibling;l===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:l.sibling=null}}function ei(e){var t=e.alternate!==null&&e.alternate.child===e.child,s=0,l=0;if(t)for(var f=e.child;f!==null;)s|=f.lanes|f.childLanes,l|=f.subtreeFlags&14680064,l|=f.flags&14680064,f.return=e,f=f.sibling;else for(f=e.child;f!==null;)s|=f.lanes|f.childLanes,l|=f.subtreeFlags,l|=f.flags,f.return=e,f=f.sibling;return e.subtreeFlags|=l,e.childLanes=s,t}function jA(e,t,s){var l=t.pendingProps;switch(gv(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ei(t),null;case 1:return Di(t.type)&&pm(),ei(t),null;case 3:return l=t.stateNode,Mu(),Rn(Ri),Rn(ri),Cv(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(e===null||e.child===null)&&(wf(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ko!==null&&(E0(Ko),Ko=null))),v0(e,t),ei(t),null;case 5:Tv(t);var f=Bl(Od.current);if(s=t.type,e!==null&&t.stateNode!=null)IT(e,t,s,l,f),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!l){if(t.stateNode===null)throw Error(Ne(166));return ei(t),null}if(e=Bl(_s.current),wf(t)){l=t.stateNode,s=t.type;var y=t.memoizedProps;switch(l[gs]=t,l[Fd]=y,e=(t.mode&1)!==0,s){case"dialog":Ln("cancel",l),Ln("close",l);break;case"iframe":case"object":case"embed":Ln("load",l);break;case"video":case"audio":for(f=0;f<dd.length;f++)Ln(dd[f],l);break;case"source":Ln("error",l);break;case"img":case"image":case"link":Ln("error",l),Ln("load",l);break;case"details":Ln("toggle",l);break;case"input":fb(l,y),Ln("invalid",l);break;case"select":l._wrapperState={wasMultiple:!!y.multiple},Ln("invalid",l);break;case"textarea":gb(l,y),Ln("invalid",l)}H_(s,y),f=null;for(var x in y)if(y.hasOwnProperty(x)){var u=y[x];x==="children"?typeof u=="string"?l.textContent!==u&&(y.suppressHydrationWarning!==!0&&bf(l.textContent,u,e),f=["children",u]):typeof u=="number"&&l.textContent!==""+u&&(y.suppressHydrationWarning!==!0&&bf(l.textContent,u,e),f=["children",""+u]):kd.hasOwnProperty(x)&&u!=null&&x==="onScroll"&&Ln("scroll",l)}switch(s){case"input":pf(l),mb(l,y,!0);break;case"textarea":pf(l),yb(l);break;case"select":case"option":break;default:typeof y.onClick=="function"&&(l.onclick=dm)}l=f,t.updateQueue=l,l!==null&&(t.flags|=4)}else{x=f.nodeType===9?f:f.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=rS(s)),e==="http://www.w3.org/1999/xhtml"?s==="script"?(e=x.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof l.is=="string"?e=x.createElement(s,{is:l.is}):(e=x.createElement(s),s==="select"&&(x=e,l.multiple?x.multiple=!0:l.size&&(x.size=l.size))):e=x.createElementNS(e,s),e[gs]=t,e[Fd]=l,ET(e,t,!1,!1),t.stateNode=e;e:{switch(x=Z_(s,l),s){case"dialog":Ln("cancel",e),Ln("close",e),f=l;break;case"iframe":case"object":case"embed":Ln("load",e),f=l;break;case"video":case"audio":for(f=0;f<dd.length;f++)Ln(dd[f],e);f=l;break;case"source":Ln("error",e),f=l;break;case"img":case"image":case"link":Ln("error",e),Ln("load",e),f=l;break;case"details":Ln("toggle",e),f=l;break;case"input":fb(e,l),f=j_(e,l),Ln("invalid",e);break;case"option":f=l;break;case"select":e._wrapperState={wasMultiple:!!l.multiple},f=qn({},l,{value:void 0}),Ln("invalid",e);break;case"textarea":gb(e,l),f=G_(e,l),Ln("invalid",e);break;default:f=l}H_(s,f),u=f;for(y in u)if(u.hasOwnProperty(y)){var P=u[y];y==="style"?sS(e,P):y==="dangerouslySetInnerHTML"?(P=P?P.__html:void 0,P!=null&&iS(e,P)):y==="children"?typeof P=="string"?(s!=="textarea"||P!=="")&&Ed(e,P):typeof P=="number"&&Ed(e,""+P):y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&y!=="autoFocus"&&(kd.hasOwnProperty(y)?P!=null&&y==="onScroll"&&Ln("scroll",e):P!=null&&tv(e,y,P,x))}switch(s){case"input":pf(e),mb(e,l,!1);break;case"textarea":pf(e),yb(e);break;case"option":l.value!=null&&e.setAttribute("value",""+Ya(l.value));break;case"select":e.multiple=!!l.multiple,y=l.value,y!=null?fu(e,!!l.multiple,y,!1):l.defaultValue!=null&&fu(e,!!l.multiple,l.defaultValue,!0);break;default:typeof f.onClick=="function"&&(e.onclick=dm)}switch(s){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break e;case"img":l=!0;break e;default:l=!1}}l&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ei(t),null;case 6:if(e&&t.stateNode!=null)PT(e,t,e.memoizedProps,l);else{if(typeof l!="string"&&t.stateNode===null)throw Error(Ne(166));if(s=Bl(Od.current),Bl(_s.current),wf(t)){if(l=t.stateNode,s=t.memoizedProps,l[gs]=t,(y=l.nodeValue!==s)&&(e=oo,e!==null))switch(e.tag){case 3:bf(l.nodeValue,s,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&bf(l.nodeValue,s,(e.mode&1)!==0)}y&&(t.flags|=4)}else l=(s.nodeType===9?s:s.ownerDocument).createTextNode(l),l[gs]=t,t.stateNode=l}return ei(t),null;case 13:if(Rn(Vn),l=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Nn&&io!==null&&t.mode&1&&!(t.flags&128))ZS(),Pu(),t.flags|=98560,y=!1;else if(y=wf(t),l!==null&&l.dehydrated!==null){if(e===null){if(!y)throw Error(Ne(318));if(y=t.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(Ne(317));y[gs]=t}else Pu(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ei(t),y=!1}else Ko!==null&&(E0(Ko),Ko=null),y=!0;if(!y)return t.flags&65536?t:null}return t.flags&128?(t.lanes=s,t):(l=l!==null,l!==(e!==null&&e.memoizedState!==null)&&l&&(t.child.flags|=8192,t.mode&1&&(e===null||Vn.current&1?mr===0&&(mr=3):Bv())),t.updateQueue!==null&&(t.flags|=4),ei(t),null);case 4:return Mu(),v0(e,t),e===null&&Rd(t.stateNode.containerInfo),ei(t),null;case 10:return xv(t.type._context),ei(t),null;case 17:return Di(t.type)&&pm(),ei(t),null;case 19:if(Rn(Vn),y=t.memoizedState,y===null)return ei(t),null;if(l=(t.flags&128)!==0,x=y.rendering,x===null)if(l)rd(y,!1);else{if(mr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(x=xm(e),x!==null){for(t.flags|=128,rd(y,!1),l=x.updateQueue,l!==null&&(t.updateQueue=l,t.flags|=4),t.subtreeFlags=0,l=s,s=t.child;s!==null;)y=s,e=l,y.flags&=14680066,x=y.alternate,x===null?(y.childLanes=0,y.lanes=e,y.child=null,y.subtreeFlags=0,y.memoizedProps=null,y.memoizedState=null,y.updateQueue=null,y.dependencies=null,y.stateNode=null):(y.childLanes=x.childLanes,y.lanes=x.lanes,y.child=x.child,y.subtreeFlags=0,y.deletions=null,y.memoizedProps=x.memoizedProps,y.memoizedState=x.memoizedState,y.updateQueue=x.updateQueue,y.type=x.type,e=x.dependencies,y.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),s=s.sibling;return En(Vn,Vn.current&1|2),t.child}e=e.sibling}y.tail!==null&&Qn()>Lu&&(t.flags|=128,l=!0,rd(y,!1),t.lanes=4194304)}else{if(!l)if(e=xm(x),e!==null){if(t.flags|=128,l=!0,s=e.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),rd(y,!0),y.tail===null&&y.tailMode==="hidden"&&!x.alternate&&!Nn)return ei(t),null}else 2*Qn()-y.renderingStartTime>Lu&&s!==1073741824&&(t.flags|=128,l=!0,rd(y,!1),t.lanes=4194304);y.isBackwards?(x.sibling=t.child,t.child=x):(s=y.last,s!==null?s.sibling=x:t.child=x,y.last=x)}return y.tail!==null?(t=y.tail,y.rendering=t,y.tail=t.sibling,y.renderingStartTime=Qn(),t.sibling=null,s=Vn.current,En(Vn,l?s&1|2:s&1),t):(ei(t),null);case 22:case 23:return Fv(),l=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==l&&(t.flags|=8192),l&&t.mode&1?no&1073741824&&(ei(t),t.subtreeFlags&6&&(t.flags|=8192)):ei(t),null;case 24:return null;case 25:return null}throw Error(Ne(156,t.tag))}function UA(e,t){switch(gv(t),t.tag){case 1:return Di(t.type)&&pm(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Mu(),Rn(Ri),Rn(ri),Cv(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Tv(t),null;case 13:if(Rn(Vn),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Ne(340));Pu()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Rn(Vn),null;case 4:return Mu(),null;case 10:return xv(t.type._context),null;case 22:case 23:return Fv(),null;case 24:return null;default:return null}}var Cf=!1,ni=!1,VA=typeof WeakSet=="function"?WeakSet:Set,ut=null;function du(e,t){var s=e.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(l){Yn(e,t,l)}else s.current=null}function x0(e,t,s){try{s()}catch(l){Yn(e,t,l)}}var sw=!1;function GA(e,t){if(r0=cm,e=RS(),fv(e)){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else e:{s=(s=e.ownerDocument)&&s.defaultView||window;var l=s.getSelection&&s.getSelection();if(l&&l.rangeCount!==0){s=l.anchorNode;var f=l.anchorOffset,y=l.focusNode;l=l.focusOffset;try{s.nodeType,y.nodeType}catch{s=null;break e}var x=0,u=-1,P=-1,L=0,U=0,N=e,D=null;t:for(;;){for(var se;N!==s||f!==0&&N.nodeType!==3||(u=x+f),N!==y||l!==0&&N.nodeType!==3||(P=x+l),N.nodeType===3&&(x+=N.nodeValue.length),(se=N.firstChild)!==null;)D=N,N=se;for(;;){if(N===e)break t;if(D===s&&++L===f&&(u=x),D===y&&++U===l&&(P=x),(se=N.nextSibling)!==null)break;N=D,D=N.parentNode}N=se}s=u===-1||P===-1?null:{start:u,end:P}}else s=null}s=s||{start:0,end:0}}else s=null;for(i0={focusedElem:e,selectionRange:s},cm=!1,ut=t;ut!==null;)if(t=ut,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ut=e;else for(;ut!==null;){t=ut;try{var ne=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(ne!==null){var ee=ne.memoizedProps,ke=ne.memoizedState,X=t.stateNode,Z=X.getSnapshotBeforeUpdate(t.elementType===t.type?ee:Zo(t.type,ee),ke);X.__reactInternalSnapshotBeforeUpdate=Z}break;case 3:var W=t.stateNode.containerInfo;W.nodeType===1?W.textContent="":W.nodeType===9&&W.documentElement&&W.removeChild(W.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ne(163))}}catch(pe){Yn(t,t.return,pe)}if(e=t.sibling,e!==null){e.return=t.return,ut=e;break}ut=t.return}return ne=sw,sw=!1,ne}function bd(e,t,s){var l=t.updateQueue;if(l=l!==null?l.lastEffect:null,l!==null){var f=l=l.next;do{if((f.tag&e)===e){var y=f.destroy;f.destroy=void 0,y!==void 0&&x0(t,s,y)}f=f.next}while(f!==l)}}function Hm(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var s=t=t.next;do{if((s.tag&e)===e){var l=s.create;s.destroy=l()}s=s.next}while(s!==t)}}function b0(e){var t=e.ref;if(t!==null){var s=e.stateNode;switch(e.tag){case 5:e=s;break;default:e=s}typeof t=="function"?t(e):t.current=e}}function AT(e){var t=e.alternate;t!==null&&(e.alternate=null,AT(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[gs],delete t[Fd],delete t[a0],delete t[kA],delete t[EA])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function MT(e){return e.tag===5||e.tag===3||e.tag===4}function aw(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||MT(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function w0(e,t,s){var l=e.tag;if(l===5||l===6)e=e.stateNode,t?s.nodeType===8?s.parentNode.insertBefore(e,t):s.insertBefore(e,t):(s.nodeType===8?(t=s.parentNode,t.insertBefore(e,s)):(t=s,t.appendChild(e)),s=s._reactRootContainer,s!=null||t.onclick!==null||(t.onclick=dm));else if(l!==4&&(e=e.child,e!==null))for(w0(e,t,s),e=e.sibling;e!==null;)w0(e,t,s),e=e.sibling}function S0(e,t,s){var l=e.tag;if(l===5||l===6)e=e.stateNode,t?s.insertBefore(e,t):s.appendChild(e);else if(l!==4&&(e=e.child,e!==null))for(S0(e,t,s),e=e.sibling;e!==null;)S0(e,t,s),e=e.sibling}var Nr=null,Wo=!1;function Da(e,t,s){for(s=s.child;s!==null;)zT(e,t,s),s=s.sibling}function zT(e,t,s){if(ys&&typeof ys.onCommitFiberUnmount=="function")try{ys.onCommitFiberUnmount(Om,s)}catch{}switch(s.tag){case 5:ni||du(s,t);case 6:var l=Nr,f=Wo;Nr=null,Da(e,t,s),Nr=l,Wo=f,Nr!==null&&(Wo?(e=Nr,s=s.stateNode,e.nodeType===8?e.parentNode.removeChild(s):e.removeChild(s)):Nr.removeChild(s.stateNode));break;case 18:Nr!==null&&(Wo?(e=Nr,s=s.stateNode,e.nodeType===8?m_(e.parentNode,s):e.nodeType===1&&m_(e,s),Md(e)):m_(Nr,s.stateNode));break;case 4:l=Nr,f=Wo,Nr=s.stateNode.containerInfo,Wo=!0,Da(e,t,s),Nr=l,Wo=f;break;case 0:case 11:case 14:case 15:if(!ni&&(l=s.updateQueue,l!==null&&(l=l.lastEffect,l!==null))){f=l=l.next;do{var y=f,x=y.destroy;y=y.tag,x!==void 0&&(y&2||y&4)&&x0(s,t,x),f=f.next}while(f!==l)}Da(e,t,s);break;case 1:if(!ni&&(du(s,t),l=s.stateNode,typeof l.componentWillUnmount=="function"))try{l.props=s.memoizedProps,l.state=s.memoizedState,l.componentWillUnmount()}catch(u){Yn(s,t,u)}Da(e,t,s);break;case 21:Da(e,t,s);break;case 22:s.mode&1?(ni=(l=ni)||s.memoizedState!==null,Da(e,t,s),ni=l):Da(e,t,s);break;default:Da(e,t,s)}}function lw(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var s=e.stateNode;s===null&&(s=e.stateNode=new VA),t.forEach(function(l){var f=QA.bind(null,e,l);s.has(l)||(s.add(l),l.then(f,f))})}}function Ho(e,t){var s=t.deletions;if(s!==null)for(var l=0;l<s.length;l++){var f=s[l];try{var y=e,x=t,u=x;e:for(;u!==null;){switch(u.tag){case 5:Nr=u.stateNode,Wo=!1;break e;case 3:Nr=u.stateNode.containerInfo,Wo=!0;break e;case 4:Nr=u.stateNode.containerInfo,Wo=!0;break e}u=u.return}if(Nr===null)throw Error(Ne(160));zT(y,x,f),Nr=null,Wo=!1;var P=f.alternate;P!==null&&(P.return=null),f.return=null}catch(L){Yn(f,t,L)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)LT(t,e),t=t.sibling}function LT(e,t){var s=e.alternate,l=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ho(t,e),hs(e),l&4){try{bd(3,e,e.return),Hm(3,e)}catch(ee){Yn(e,e.return,ee)}try{bd(5,e,e.return)}catch(ee){Yn(e,e.return,ee)}}break;case 1:Ho(t,e),hs(e),l&512&&s!==null&&du(s,s.return);break;case 5:if(Ho(t,e),hs(e),l&512&&s!==null&&du(s,s.return),e.flags&32){var f=e.stateNode;try{Ed(f,"")}catch(ee){Yn(e,e.return,ee)}}if(l&4&&(f=e.stateNode,f!=null)){var y=e.memoizedProps,x=s!==null?s.memoizedProps:y,u=e.type,P=e.updateQueue;if(e.updateQueue=null,P!==null)try{u==="input"&&y.type==="radio"&&y.name!=null&&tS(f,y),Z_(u,x);var L=Z_(u,y);for(x=0;x<P.length;x+=2){var U=P[x],N=P[x+1];U==="style"?sS(f,N):U==="dangerouslySetInnerHTML"?iS(f,N):U==="children"?Ed(f,N):tv(f,U,N,L)}switch(u){case"input":U_(f,y);break;case"textarea":nS(f,y);break;case"select":var D=f._wrapperState.wasMultiple;f._wrapperState.wasMultiple=!!y.multiple;var se=y.value;se!=null?fu(f,!!y.multiple,se,!1):D!==!!y.multiple&&(y.defaultValue!=null?fu(f,!!y.multiple,y.defaultValue,!0):fu(f,!!y.multiple,y.multiple?[]:"",!1))}f[Fd]=y}catch(ee){Yn(e,e.return,ee)}}break;case 6:if(Ho(t,e),hs(e),l&4){if(e.stateNode===null)throw Error(Ne(162));f=e.stateNode,y=e.memoizedProps;try{f.nodeValue=y}catch(ee){Yn(e,e.return,ee)}}break;case 3:if(Ho(t,e),hs(e),l&4&&s!==null&&s.memoizedState.isDehydrated)try{Md(t.containerInfo)}catch(ee){Yn(e,e.return,ee)}break;case 4:Ho(t,e),hs(e);break;case 13:Ho(t,e),hs(e),f=e.child,f.flags&8192&&(y=f.memoizedState!==null,f.stateNode.isHidden=y,!y||f.alternate!==null&&f.alternate.memoizedState!==null||(Rv=Qn())),l&4&&lw(e);break;case 22:if(U=s!==null&&s.memoizedState!==null,e.mode&1?(ni=(L=ni)||U,Ho(t,e),ni=L):Ho(t,e),hs(e),l&8192){if(L=e.memoizedState!==null,(e.stateNode.isHidden=L)&&!U&&e.mode&1)for(ut=e,U=e.child;U!==null;){for(N=ut=U;ut!==null;){switch(D=ut,se=D.child,D.tag){case 0:case 11:case 14:case 15:bd(4,D,D.return);break;case 1:du(D,D.return);var ne=D.stateNode;if(typeof ne.componentWillUnmount=="function"){l=D,s=D.return;try{t=l,ne.props=t.memoizedProps,ne.state=t.memoizedState,ne.componentWillUnmount()}catch(ee){Yn(l,s,ee)}}break;case 5:du(D,D.return);break;case 22:if(D.memoizedState!==null){uw(N);continue}}se!==null?(se.return=D,ut=se):uw(N)}U=U.sibling}e:for(U=null,N=e;;){if(N.tag===5){if(U===null){U=N;try{f=N.stateNode,L?(y=f.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none"):(u=N.stateNode,P=N.memoizedProps.style,x=P!=null&&P.hasOwnProperty("display")?P.display:null,u.style.display=oS("display",x))}catch(ee){Yn(e,e.return,ee)}}}else if(N.tag===6){if(U===null)try{N.stateNode.nodeValue=L?"":N.memoizedProps}catch(ee){Yn(e,e.return,ee)}}else if((N.tag!==22&&N.tag!==23||N.memoizedState===null||N===e)&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===e)break e;for(;N.sibling===null;){if(N.return===null||N.return===e)break e;U===N&&(U=null),N=N.return}U===N&&(U=null),N.sibling.return=N.return,N=N.sibling}}break;case 19:Ho(t,e),hs(e),l&4&&lw(e);break;case 21:break;default:Ho(t,e),hs(e)}}function hs(e){var t=e.flags;if(t&2){try{e:{for(var s=e.return;s!==null;){if(MT(s)){var l=s;break e}s=s.return}throw Error(Ne(160))}switch(l.tag){case 5:var f=l.stateNode;l.flags&32&&(Ed(f,""),l.flags&=-33);var y=aw(e);S0(e,y,f);break;case 3:case 4:var x=l.stateNode.containerInfo,u=aw(e);w0(e,u,x);break;default:throw Error(Ne(161))}}catch(P){Yn(e,e.return,P)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function qA(e,t,s){ut=e,RT(e)}function RT(e,t,s){for(var l=(e.mode&1)!==0;ut!==null;){var f=ut,y=f.child;if(f.tag===22&&l){var x=f.memoizedState!==null||Cf;if(!x){var u=f.alternate,P=u!==null&&u.memoizedState!==null||ni;u=Cf;var L=ni;if(Cf=x,(ni=P)&&!L)for(ut=f;ut!==null;)x=ut,P=x.child,x.tag===22&&x.memoizedState!==null?hw(f):P!==null?(P.return=x,ut=P):hw(f);for(;y!==null;)ut=y,RT(y),y=y.sibling;ut=f,Cf=u,ni=L}cw(e)}else f.subtreeFlags&8772&&y!==null?(y.return=f,ut=y):cw(e)}}function cw(e){for(;ut!==null;){var t=ut;if(t.flags&8772){var s=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:ni||Hm(5,t);break;case 1:var l=t.stateNode;if(t.flags&4&&!ni)if(s===null)l.componentDidMount();else{var f=t.elementType===t.type?s.memoizedProps:Zo(t.type,s.memoizedProps);l.componentDidUpdate(f,s.memoizedState,l.__reactInternalSnapshotBeforeUpdate)}var y=t.updateQueue;y!==null&&Zb(t,y,l);break;case 3:var x=t.updateQueue;if(x!==null){if(s=null,t.child!==null)switch(t.child.tag){case 5:s=t.child.stateNode;break;case 1:s=t.child.stateNode}Zb(t,x,s)}break;case 5:var u=t.stateNode;if(s===null&&t.flags&4){s=u;var P=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":P.autoFocus&&s.focus();break;case"img":P.src&&(s.src=P.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var L=t.alternate;if(L!==null){var U=L.memoizedState;if(U!==null){var N=U.dehydrated;N!==null&&Md(N)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ne(163))}ni||t.flags&512&&b0(t)}catch(D){Yn(t,t.return,D)}}if(t===e){ut=null;break}if(s=t.sibling,s!==null){s.return=t.return,ut=s;break}ut=t.return}}function uw(e){for(;ut!==null;){var t=ut;if(t===e){ut=null;break}var s=t.sibling;if(s!==null){s.return=t.return,ut=s;break}ut=t.return}}function hw(e){for(;ut!==null;){var t=ut;try{switch(t.tag){case 0:case 11:case 15:var s=t.return;try{Hm(4,t)}catch(P){Yn(t,s,P)}break;case 1:var l=t.stateNode;if(typeof l.componentDidMount=="function"){var f=t.return;try{l.componentDidMount()}catch(P){Yn(t,f,P)}}var y=t.return;try{b0(t)}catch(P){Yn(t,y,P)}break;case 5:var x=t.return;try{b0(t)}catch(P){Yn(t,x,P)}}}catch(P){Yn(t,t.return,P)}if(t===e){ut=null;break}var u=t.sibling;if(u!==null){u.return=t.return,ut=u;break}ut=t.return}}var HA=Math.ceil,Sm=ea.ReactCurrentDispatcher,zv=ea.ReactCurrentOwner,Mo=ea.ReactCurrentBatchConfig,Jt=0,Pr=null,cr=null,Ur=0,no=0,pu=el(0),mr=0,Ud=null,Zl=0,Zm=0,Lv=0,wd=null,zi=null,Rv=0,Lu=1/0,Us=null,Tm=!1,T0=null,Wa=null,kf=!1,Ua=null,Cm=0,Sd=0,C0=null,Hf=-1,Zf=0;function _i(){return Jt&6?Qn():Hf!==-1?Hf:Hf=Qn()}function Ka(e){return e.mode&1?Jt&2&&Ur!==0?Ur&-Ur:PA.transition!==null?(Zf===0&&(Zf=_S()),Zf):(e=mn,e!==0||(e=window.event,e=e===void 0?16:CS(e.type)),e):1}function Jo(e,t,s,l){if(50<Sd)throw Sd=0,C0=null,Error(Ne(185));Xd(e,s,l),(!(Jt&2)||e!==Pr)&&(e===Pr&&(!(Jt&2)&&(Zm|=s),mr===4&&Na(e,Ur)),Fi(e,l),s===1&&Jt===0&&!(t.mode&1)&&(Lu=Qn()+500,Vm&&tl()))}function Fi(e,t){var s=e.callbackNode;PP(e,t);var l=lm(e,e===Pr?Ur:0);if(l===0)s!==null&&xb(s),e.callbackNode=null,e.callbackPriority=0;else if(t=l&-l,e.callbackPriority!==t){if(s!=null&&xb(s),t===1)e.tag===0?IA(dw.bind(null,e)):GS(dw.bind(null,e)),TA(function(){!(Jt&6)&&tl()}),s=null;else{switch(vS(l)){case 1:s=sv;break;case 4:s=gS;break;case 16:s=am;break;case 536870912:s=yS;break;default:s=am}s=UT(s,DT.bind(null,e))}e.callbackPriority=t,e.callbackNode=s}}function DT(e,t){if(Hf=-1,Zf=0,Jt&6)throw Error(Ne(327));var s=e.callbackNode;if(vu()&&e.callbackNode!==s)return null;var l=lm(e,e===Pr?Ur:0);if(l===0)return null;if(l&30||l&e.expiredLanes||t)t=km(e,l);else{t=l;var f=Jt;Jt|=2;var y=BT();(Pr!==e||Ur!==t)&&(Us=null,Lu=Qn()+500,$l(e,t));do try{KA();break}catch(u){FT(e,u)}while(!0);vv(),Sm.current=y,Jt=f,cr!==null?t=0:(Pr=null,Ur=0,t=mr)}if(t!==0){if(t===2&&(f=J_(e),f!==0&&(l=f,t=k0(e,f))),t===1)throw s=Ud,$l(e,0),Na(e,l),Fi(e,Qn()),s;if(t===6)Na(e,l);else{if(f=e.current.alternate,!(l&30)&&!ZA(f)&&(t=km(e,l),t===2&&(y=J_(e),y!==0&&(l=y,t=k0(e,y))),t===1))throw s=Ud,$l(e,0),Na(e,l),Fi(e,Qn()),s;switch(e.finishedWork=f,e.finishedLanes=l,t){case 0:case 1:throw Error(Ne(345));case 2:Al(e,zi,Us);break;case 3:if(Na(e,l),(l&130023424)===l&&(t=Rv+500-Qn(),10<t)){if(lm(e,0)!==0)break;if(f=e.suspendedLanes,(f&l)!==l){_i(),e.pingedLanes|=e.suspendedLanes&f;break}e.timeoutHandle=s0(Al.bind(null,e,zi,Us),t);break}Al(e,zi,Us);break;case 4:if(Na(e,l),(l&4194240)===l)break;for(t=e.eventTimes,f=-1;0<l;){var x=31-Yo(l);y=1<<x,x=t[x],x>f&&(f=x),l&=~y}if(l=f,l=Qn()-l,l=(120>l?120:480>l?480:1080>l?1080:1920>l?1920:3e3>l?3e3:4320>l?4320:1960*HA(l/1960))-l,10<l){e.timeoutHandle=s0(Al.bind(null,e,zi,Us),l);break}Al(e,zi,Us);break;case 5:Al(e,zi,Us);break;default:throw Error(Ne(329))}}}return Fi(e,Qn()),e.callbackNode===s?DT.bind(null,e):null}function k0(e,t){var s=wd;return e.current.memoizedState.isDehydrated&&($l(e,t).flags|=256),e=km(e,t),e!==2&&(t=zi,zi=s,t!==null&&E0(t)),e}function E0(e){zi===null?zi=e:zi.push.apply(zi,e)}function ZA(e){for(var t=e;;){if(t.flags&16384){var s=t.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var l=0;l<s.length;l++){var f=s[l],y=f.getSnapshot;f=f.value;try{if(!Qo(y(),f))return!1}catch{return!1}}}if(s=t.child,t.subtreeFlags&16384&&s!==null)s.return=t,t=s;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Na(e,t){for(t&=~Lv,t&=~Zm,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var s=31-Yo(t),l=1<<s;e[s]=-1,t&=~l}}function dw(e){if(Jt&6)throw Error(Ne(327));vu();var t=lm(e,0);if(!(t&1))return Fi(e,Qn()),null;var s=km(e,t);if(e.tag!==0&&s===2){var l=J_(e);l!==0&&(t=l,s=k0(e,l))}if(s===1)throw s=Ud,$l(e,0),Na(e,t),Fi(e,Qn()),s;if(s===6)throw Error(Ne(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Al(e,zi,Us),Fi(e,Qn()),null}function Dv(e,t){var s=Jt;Jt|=1;try{return e(t)}finally{Jt=s,Jt===0&&(Lu=Qn()+500,Vm&&tl())}}function Wl(e){Ua!==null&&Ua.tag===0&&!(Jt&6)&&vu();var t=Jt;Jt|=1;var s=Mo.transition,l=mn;try{if(Mo.transition=null,mn=1,e)return e()}finally{mn=l,Mo.transition=s,Jt=t,!(Jt&6)&&tl()}}function Fv(){no=pu.current,Rn(pu)}function $l(e,t){e.finishedWork=null,e.finishedLanes=0;var s=e.timeoutHandle;if(s!==-1&&(e.timeoutHandle=-1,SA(s)),cr!==null)for(s=cr.return;s!==null;){var l=s;switch(gv(l),l.tag){case 1:l=l.type.childContextTypes,l!=null&&pm();break;case 3:Mu(),Rn(Ri),Rn(ri),Cv();break;case 5:Tv(l);break;case 4:Mu();break;case 13:Rn(Vn);break;case 19:Rn(Vn);break;case 10:xv(l.type._context);break;case 22:case 23:Fv()}s=s.return}if(Pr=e,cr=e=Xa(e.current,null),Ur=no=t,mr=0,Ud=null,Lv=Zm=Zl=0,zi=wd=null,Fl!==null){for(t=0;t<Fl.length;t++)if(s=Fl[t],l=s.interleaved,l!==null){s.interleaved=null;var f=l.next,y=s.pending;if(y!==null){var x=y.next;y.next=f,l.next=x}s.pending=l}Fl=null}return e}function FT(e,t){do{var s=cr;try{if(vv(),Vf.current=wm,bm){for(var l=Gn.memoizedState;l!==null;){var f=l.queue;f!==null&&(f.pending=null),l=l.next}bm=!1}if(Hl=0,Er=fr=Gn=null,xd=!1,Nd=0,zv.current=null,s===null||s.return===null){mr=1,Ud=t,cr=null;break}e:{var y=e,x=s.return,u=s,P=t;if(t=Ur,u.flags|=32768,P!==null&&typeof P=="object"&&typeof P.then=="function"){var L=P,U=u,N=U.tag;if(!(U.mode&1)&&(N===0||N===11||N===15)){var D=U.alternate;D?(U.updateQueue=D.updateQueue,U.memoizedState=D.memoizedState,U.lanes=D.lanes):(U.updateQueue=null,U.memoizedState=null)}var se=Qb(x);if(se!==null){se.flags&=-257,ew(se,x,u,y,t),se.mode&1&&Jb(y,L,t),t=se,P=L;var ne=t.updateQueue;if(ne===null){var ee=new Set;ee.add(P),t.updateQueue=ee}else ne.add(P);break e}else{if(!(t&1)){Jb(y,L,t),Bv();break e}P=Error(Ne(426))}}else if(Nn&&u.mode&1){var ke=Qb(x);if(ke!==null){!(ke.flags&65536)&&(ke.flags|=256),ew(ke,x,u,y,t),yv(zu(P,u));break e}}y=P=zu(P,u),mr!==4&&(mr=2),wd===null?wd=[y]:wd.push(y),y=x;do{switch(y.tag){case 3:y.flags|=65536,t&=-t,y.lanes|=t;var X=vT(y,P,t);Hb(y,X);break e;case 1:u=P;var Z=y.type,W=y.stateNode;if(!(y.flags&128)&&(typeof Z.getDerivedStateFromError=="function"||W!==null&&typeof W.componentDidCatch=="function"&&(Wa===null||!Wa.has(W)))){y.flags|=65536,t&=-t,y.lanes|=t;var pe=xT(y,u,t);Hb(y,pe);break e}}y=y.return}while(y!==null)}NT(s)}catch(_e){t=_e,cr===s&&s!==null&&(cr=s=s.return);continue}break}while(!0)}function BT(){var e=Sm.current;return Sm.current=wm,e===null?wm:e}function Bv(){(mr===0||mr===3||mr===2)&&(mr=4),Pr===null||!(Zl&268435455)&&!(Zm&268435455)||Na(Pr,Ur)}function km(e,t){var s=Jt;Jt|=2;var l=BT();(Pr!==e||Ur!==t)&&(Us=null,$l(e,t));do try{WA();break}catch(f){FT(e,f)}while(!0);if(vv(),Jt=s,Sm.current=l,cr!==null)throw Error(Ne(261));return Pr=null,Ur=0,mr}function WA(){for(;cr!==null;)OT(cr)}function KA(){for(;cr!==null&&!xP();)OT(cr)}function OT(e){var t=jT(e.alternate,e,no);e.memoizedProps=e.pendingProps,t===null?NT(e):cr=t,zv.current=null}function NT(e){var t=e;do{var s=t.alternate;if(e=t.return,t.flags&32768){if(s=UA(s,t),s!==null){s.flags&=32767,cr=s;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{mr=6,cr=null;return}}else if(s=jA(s,t,no),s!==null){cr=s;return}if(t=t.sibling,t!==null){cr=t;return}cr=t=e}while(t!==null);mr===0&&(mr=5)}function Al(e,t,s){var l=mn,f=Mo.transition;try{Mo.transition=null,mn=1,XA(e,t,s,l)}finally{Mo.transition=f,mn=l}return null}function XA(e,t,s,l){do vu();while(Ua!==null);if(Jt&6)throw Error(Ne(327));s=e.finishedWork;var f=e.finishedLanes;if(s===null)return null;if(e.finishedWork=null,e.finishedLanes=0,s===e.current)throw Error(Ne(177));e.callbackNode=null,e.callbackPriority=0;var y=s.lanes|s.childLanes;if(AP(e,y),e===Pr&&(cr=Pr=null,Ur=0),!(s.subtreeFlags&2064)&&!(s.flags&2064)||kf||(kf=!0,UT(am,function(){return vu(),null})),y=(s.flags&15990)!==0,s.subtreeFlags&15990||y){y=Mo.transition,Mo.transition=null;var x=mn;mn=1;var u=Jt;Jt|=4,zv.current=null,GA(e,s),LT(s,e),gA(i0),cm=!!r0,i0=r0=null,e.current=s,qA(s),bP(),Jt=u,mn=x,Mo.transition=y}else e.current=s;if(kf&&(kf=!1,Ua=e,Cm=f),y=e.pendingLanes,y===0&&(Wa=null),TP(s.stateNode),Fi(e,Qn()),t!==null)for(l=e.onRecoverableError,s=0;s<t.length;s++)f=t[s],l(f.value,{componentStack:f.stack,digest:f.digest});if(Tm)throw Tm=!1,e=T0,T0=null,e;return Cm&1&&e.tag!==0&&vu(),y=e.pendingLanes,y&1?e===C0?Sd++:(Sd=0,C0=e):Sd=0,tl(),null}function vu(){if(Ua!==null){var e=vS(Cm),t=Mo.transition,s=mn;try{if(Mo.transition=null,mn=16>e?16:e,Ua===null)var l=!1;else{if(e=Ua,Ua=null,Cm=0,Jt&6)throw Error(Ne(331));var f=Jt;for(Jt|=4,ut=e.current;ut!==null;){var y=ut,x=y.child;if(ut.flags&16){var u=y.deletions;if(u!==null){for(var P=0;P<u.length;P++){var L=u[P];for(ut=L;ut!==null;){var U=ut;switch(U.tag){case 0:case 11:case 15:bd(8,U,y)}var N=U.child;if(N!==null)N.return=U,ut=N;else for(;ut!==null;){U=ut;var D=U.sibling,se=U.return;if(AT(U),U===L){ut=null;break}if(D!==null){D.return=se,ut=D;break}ut=se}}}var ne=y.alternate;if(ne!==null){var ee=ne.child;if(ee!==null){ne.child=null;do{var ke=ee.sibling;ee.sibling=null,ee=ke}while(ee!==null)}}ut=y}}if(y.subtreeFlags&2064&&x!==null)x.return=y,ut=x;else e:for(;ut!==null;){if(y=ut,y.flags&2048)switch(y.tag){case 0:case 11:case 15:bd(9,y,y.return)}var X=y.sibling;if(X!==null){X.return=y.return,ut=X;break e}ut=y.return}}var Z=e.current;for(ut=Z;ut!==null;){x=ut;var W=x.child;if(x.subtreeFlags&2064&&W!==null)W.return=x,ut=W;else e:for(x=Z;ut!==null;){if(u=ut,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:Hm(9,u)}}catch(_e){Yn(u,u.return,_e)}if(u===x){ut=null;break e}var pe=u.sibling;if(pe!==null){pe.return=u.return,ut=pe;break e}ut=u.return}}if(Jt=f,tl(),ys&&typeof ys.onPostCommitFiberRoot=="function")try{ys.onPostCommitFiberRoot(Om,e)}catch{}l=!0}return l}finally{mn=s,Mo.transition=t}}return!1}function pw(e,t,s){t=zu(s,t),t=vT(e,t,1),e=Za(e,t,1),t=_i(),e!==null&&(Xd(e,1,t),Fi(e,t))}function Yn(e,t,s){if(e.tag===3)pw(e,e,s);else for(;t!==null;){if(t.tag===3){pw(t,e,s);break}else if(t.tag===1){var l=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(Wa===null||!Wa.has(l))){e=zu(s,e),e=xT(t,e,1),t=Za(t,e,1),e=_i(),t!==null&&(Xd(t,1,e),Fi(t,e));break}}t=t.return}}function YA(e,t,s){var l=e.pingCache;l!==null&&l.delete(t),t=_i(),e.pingedLanes|=e.suspendedLanes&s,Pr===e&&(Ur&s)===s&&(mr===4||mr===3&&(Ur&130023424)===Ur&&500>Qn()-Rv?$l(e,0):Lv|=s),Fi(e,t)}function $T(e,t){t===0&&(e.mode&1?(t=gf,gf<<=1,!(gf&130023424)&&(gf=4194304)):t=1);var s=_i();e=Xs(e,t),e!==null&&(Xd(e,t,s),Fi(e,s))}function JA(e){var t=e.memoizedState,s=0;t!==null&&(s=t.retryLane),$T(e,s)}function QA(e,t){var s=0;switch(e.tag){case 13:var l=e.stateNode,f=e.memoizedState;f!==null&&(s=f.retryLane);break;case 19:l=e.stateNode;break;default:throw Error(Ne(314))}l!==null&&l.delete(t),$T(e,s)}var jT;jT=function(e,t,s){if(e!==null)if(e.memoizedProps!==t.pendingProps||Ri.current)Li=!0;else{if(!(e.lanes&s)&&!(t.flags&128))return Li=!1,$A(e,t,s);Li=!!(e.flags&131072)}else Li=!1,Nn&&t.flags&1048576&&qS(t,gm,t.index);switch(t.lanes=0,t.tag){case 2:var l=t.type;qf(e,t),e=t.pendingProps;var f=Iu(t,ri.current);_u(t,s),f=Ev(null,t,l,e,f,s);var y=Iv();return t.flags|=1,typeof f=="object"&&f!==null&&typeof f.render=="function"&&f.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Di(l)?(y=!0,fm(t)):y=!1,t.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,wv(t),f.updater=qm,t.stateNode=f,f._reactInternals=t,p0(t,l,e,s),t=g0(null,t,l,!0,y,s)):(t.tag=0,Nn&&y&&mv(t),yi(null,t,f,s),t=t.child),t;case 16:l=t.elementType;e:{switch(qf(e,t),e=t.pendingProps,f=l._init,l=f(l._payload),t.type=l,f=t.tag=tM(l),e=Zo(l,e),f){case 0:t=m0(null,t,l,e,s);break e;case 1:t=rw(null,t,l,e,s);break e;case 11:t=tw(null,t,l,e,s);break e;case 14:t=nw(null,t,l,Zo(l.type,e),s);break e}throw Error(Ne(306,l,""))}return t;case 0:return l=t.type,f=t.pendingProps,f=t.elementType===l?f:Zo(l,f),m0(e,t,l,f,s);case 1:return l=t.type,f=t.pendingProps,f=t.elementType===l?f:Zo(l,f),rw(e,t,l,f,s);case 3:e:{if(TT(t),e===null)throw Error(Ne(387));l=t.pendingProps,y=t.memoizedState,f=y.element,YS(e,t),vm(t,l,null,s);var x=t.memoizedState;if(l=x.element,y.isDehydrated)if(y={element:l,isDehydrated:!1,cache:x.cache,pendingSuspenseBoundaries:x.pendingSuspenseBoundaries,transitions:x.transitions},t.updateQueue.baseState=y,t.memoizedState=y,t.flags&256){f=zu(Error(Ne(423)),t),t=iw(e,t,l,s,f);break e}else if(l!==f){f=zu(Error(Ne(424)),t),t=iw(e,t,l,s,f);break e}else for(io=Ha(t.stateNode.containerInfo.firstChild),oo=t,Nn=!0,Ko=null,s=KS(t,null,l,s),t.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(Pu(),l===f){t=Ys(e,t,s);break e}yi(e,t,l,s)}t=t.child}return t;case 5:return JS(t),e===null&&u0(t),l=t.type,f=t.pendingProps,y=e!==null?e.memoizedProps:null,x=f.children,o0(l,f)?x=null:y!==null&&o0(l,y)&&(t.flags|=32),ST(e,t),yi(e,t,x,s),t.child;case 6:return e===null&&u0(t),null;case 13:return CT(e,t,s);case 4:return Sv(t,t.stateNode.containerInfo),l=t.pendingProps,e===null?t.child=Au(t,null,l,s):yi(e,t,l,s),t.child;case 11:return l=t.type,f=t.pendingProps,f=t.elementType===l?f:Zo(l,f),tw(e,t,l,f,s);case 7:return yi(e,t,t.pendingProps,s),t.child;case 8:return yi(e,t,t.pendingProps.children,s),t.child;case 12:return yi(e,t,t.pendingProps.children,s),t.child;case 10:e:{if(l=t.type._context,f=t.pendingProps,y=t.memoizedProps,x=f.value,En(ym,l._currentValue),l._currentValue=x,y!==null)if(Qo(y.value,x)){if(y.children===f.children&&!Ri.current){t=Ys(e,t,s);break e}}else for(y=t.child,y!==null&&(y.return=t);y!==null;){var u=y.dependencies;if(u!==null){x=y.child;for(var P=u.firstContext;P!==null;){if(P.context===l){if(y.tag===1){P=Hs(-1,s&-s),P.tag=2;var L=y.updateQueue;if(L!==null){L=L.shared;var U=L.pending;U===null?P.next=P:(P.next=U.next,U.next=P),L.pending=P}}y.lanes|=s,P=y.alternate,P!==null&&(P.lanes|=s),h0(y.return,s,t),u.lanes|=s;break}P=P.next}}else if(y.tag===10)x=y.type===t.type?null:y.child;else if(y.tag===18){if(x=y.return,x===null)throw Error(Ne(341));x.lanes|=s,u=x.alternate,u!==null&&(u.lanes|=s),h0(x,s,t),x=y.sibling}else x=y.child;if(x!==null)x.return=y;else for(x=y;x!==null;){if(x===t){x=null;break}if(y=x.sibling,y!==null){y.return=x.return,x=y;break}x=x.return}y=x}yi(e,t,f.children,s),t=t.child}return t;case 9:return f=t.type,l=t.pendingProps.children,_u(t,s),f=zo(f),l=l(f),t.flags|=1,yi(e,t,l,s),t.child;case 14:return l=t.type,f=Zo(l,t.pendingProps),f=Zo(l.type,f),nw(e,t,l,f,s);case 15:return bT(e,t,t.type,t.pendingProps,s);case 17:return l=t.type,f=t.pendingProps,f=t.elementType===l?f:Zo(l,f),qf(e,t),t.tag=1,Di(l)?(e=!0,fm(t)):e=!1,_u(t,s),_T(t,l,f),p0(t,l,f,s),g0(null,t,l,!0,e,s);case 19:return kT(e,t,s);case 22:return wT(e,t,s)}throw Error(Ne(156,t.tag))};function UT(e,t){return mS(e,t)}function eM(e,t,s,l){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Po(e,t,s,l){return new eM(e,t,s,l)}function Ov(e){return e=e.prototype,!(!e||!e.isReactComponent)}function tM(e){if(typeof e=="function")return Ov(e)?1:0;if(e!=null){if(e=e.$$typeof,e===rv)return 11;if(e===iv)return 14}return 2}function Xa(e,t){var s=e.alternate;return s===null?(s=Po(e.tag,t,e.key,e.mode),s.elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=t,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=e.flags&14680064,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,t=e.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s}function Wf(e,t,s,l,f,y){var x=2;if(l=e,typeof e=="function")Ov(e)&&(x=1);else if(typeof e=="string")x=5;else e:switch(e){case ru:return jl(s.children,f,y,t);case nv:x=8,f|=8;break;case B_:return e=Po(12,s,t,f|2),e.elementType=B_,e.lanes=y,e;case O_:return e=Po(13,s,t,f),e.elementType=O_,e.lanes=y,e;case N_:return e=Po(19,s,t,f),e.elementType=N_,e.lanes=y,e;case J2:return Wm(s,f,y,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case X2:x=10;break e;case Y2:x=9;break e;case rv:x=11;break e;case iv:x=14;break e;case Fa:x=16,l=null;break e}throw Error(Ne(130,e==null?e:typeof e,""))}return t=Po(x,s,t,f),t.elementType=e,t.type=l,t.lanes=y,t}function jl(e,t,s,l){return e=Po(7,e,l,t),e.lanes=s,e}function Wm(e,t,s,l){return e=Po(22,e,l,t),e.elementType=J2,e.lanes=s,e.stateNode={isHidden:!1},e}function S_(e,t,s){return e=Po(6,e,null,t),e.lanes=s,e}function T_(e,t,s){return t=Po(4,e.children!==null?e.children:[],e.key,t),t.lanes=s,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function nM(e,t,s,l,f){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=i_(0),this.expirationTimes=i_(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=i_(0),this.identifierPrefix=l,this.onRecoverableError=f,this.mutableSourceEagerHydrationData=null}function Nv(e,t,s,l,f,y,x,u,P){return e=new nM(e,t,s,u,P),t===1?(t=1,y===!0&&(t|=8)):t=0,y=Po(3,null,null,t),e.current=y,y.stateNode=e,y.memoizedState={element:l,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},wv(y),e}function rM(e,t,s){var l=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:nu,key:l==null?null:""+l,children:e,containerInfo:t,implementation:s}}function VT(e){if(!e)return Ja;e=e._reactInternals;e:{if(Xl(e)!==e||e.tag!==1)throw Error(Ne(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Di(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Ne(171))}if(e.tag===1){var s=e.type;if(Di(s))return VS(e,s,t)}return t}function GT(e,t,s,l,f,y,x,u,P){return e=Nv(s,l,!0,e,f,y,x,u,P),e.context=VT(null),s=e.current,l=_i(),f=Ka(s),y=Hs(l,f),y.callback=t??null,Za(s,y,f),e.current.lanes=f,Xd(e,f,l),Fi(e,l),e}function Km(e,t,s,l){var f=t.current,y=_i(),x=Ka(f);return s=VT(s),t.context===null?t.context=s:t.pendingContext=s,t=Hs(y,x),t.payload={element:e},l=l===void 0?null:l,l!==null&&(t.callback=l),e=Za(f,t,x),e!==null&&(Jo(e,f,x,y),Uf(e,f,x)),x}function Em(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function fw(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var s=e.retryLane;e.retryLane=s!==0&&s<t?s:t}}function $v(e,t){fw(e,t),(e=e.alternate)&&fw(e,t)}function iM(){return null}var qT=typeof reportError=="function"?reportError:function(e){console.error(e)};function jv(e){this._internalRoot=e}Xm.prototype.render=jv.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Ne(409));Km(e,t,null,null)};Xm.prototype.unmount=jv.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Wl(function(){Km(null,e,null,null)}),t[Ks]=null}};function Xm(e){this._internalRoot=e}Xm.prototype.unstable_scheduleHydration=function(e){if(e){var t=wS();e={blockedOn:null,target:e,priority:t};for(var s=0;s<Oa.length&&t!==0&&t<Oa[s].priority;s++);Oa.splice(s,0,e),s===0&&TS(e)}};function Uv(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Ym(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function mw(){}function oM(e,t,s,l,f){if(f){if(typeof l=="function"){var y=l;l=function(){var L=Em(x);y.call(L)}}var x=GT(t,l,e,0,null,!1,!1,"",mw);return e._reactRootContainer=x,e[Ks]=x.current,Rd(e.nodeType===8?e.parentNode:e),Wl(),x}for(;f=e.lastChild;)e.removeChild(f);if(typeof l=="function"){var u=l;l=function(){var L=Em(P);u.call(L)}}var P=Nv(e,0,!1,null,null,!1,!1,"",mw);return e._reactRootContainer=P,e[Ks]=P.current,Rd(e.nodeType===8?e.parentNode:e),Wl(function(){Km(t,P,s,l)}),P}function Jm(e,t,s,l,f){var y=s._reactRootContainer;if(y){var x=y;if(typeof f=="function"){var u=f;f=function(){var P=Em(x);u.call(P)}}Km(t,x,e,f)}else x=oM(s,t,e,f,l);return Em(x)}xS=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var s=hd(t.pendingLanes);s!==0&&(av(t,s|1),Fi(t,Qn()),!(Jt&6)&&(Lu=Qn()+500,tl()))}break;case 13:Wl(function(){var l=Xs(e,1);if(l!==null){var f=_i();Jo(l,e,1,f)}}),$v(e,1)}};lv=function(e){if(e.tag===13){var t=Xs(e,134217728);if(t!==null){var s=_i();Jo(t,e,134217728,s)}$v(e,134217728)}};bS=function(e){if(e.tag===13){var t=Ka(e),s=Xs(e,t);if(s!==null){var l=_i();Jo(s,e,t,l)}$v(e,t)}};wS=function(){return mn};SS=function(e,t){var s=mn;try{return mn=e,t()}finally{mn=s}};K_=function(e,t,s){switch(t){case"input":if(U_(e,s),t=s.name,s.type==="radio"&&t!=null){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<s.length;t++){var l=s[t];if(l!==e&&l.form===e.form){var f=Um(l);if(!f)throw Error(Ne(90));eS(l),U_(l,f)}}}break;case"textarea":nS(e,s);break;case"select":t=s.value,t!=null&&fu(e,!!s.multiple,t,!1)}};cS=Dv;uS=Wl;var sM={usingClientEntryPoint:!1,Events:[Jd,au,Um,aS,lS,Dv]},id={findFiberByHostInstance:Dl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},aM={bundleType:id.bundleType,version:id.version,rendererPackageName:id.rendererPackageName,rendererConfig:id.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ea.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=pS(e),e===null?null:e.stateNode},findFiberByHostInstance:id.findFiberByHostInstance||iM,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ef=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ef.isDisabled&&Ef.supportsFiber)try{Om=Ef.inject(aM),ys=Ef}catch{}}lo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sM;lo.createPortal=function(e,t){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Uv(t))throw Error(Ne(200));return rM(e,t,null,s)};lo.createRoot=function(e,t){if(!Uv(e))throw Error(Ne(299));var s=!1,l="",f=qT;return t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(l=t.identifierPrefix),t.onRecoverableError!==void 0&&(f=t.onRecoverableError)),t=Nv(e,1,!1,null,null,s,!1,l,f),e[Ks]=t.current,Rd(e.nodeType===8?e.parentNode:e),new jv(t)};lo.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Ne(188)):(e=Object.keys(e).join(","),Error(Ne(268,e)));return e=pS(t),e=e===null?null:e.stateNode,e};lo.flushSync=function(e){return Wl(e)};lo.hydrate=function(e,t,s){if(!Ym(t))throw Error(Ne(200));return Jm(null,e,t,!0,s)};lo.hydrateRoot=function(e,t,s){if(!Uv(e))throw Error(Ne(405));var l=s!=null&&s.hydratedSources||null,f=!1,y="",x=qT;if(s!=null&&(s.unstable_strictMode===!0&&(f=!0),s.identifierPrefix!==void 0&&(y=s.identifierPrefix),s.onRecoverableError!==void 0&&(x=s.onRecoverableError)),t=GT(t,null,e,1,s??null,f,!1,y,x),e[Ks]=t.current,Rd(e),l)for(e=0;e<l.length;e++)s=l[e],f=s._getVersion,f=f(s._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[s,f]:t.mutableSourceEagerHydrationData.push(s,f);return new Xm(t)};lo.render=function(e,t,s){if(!Ym(t))throw Error(Ne(200));return Jm(null,e,t,!1,s)};lo.unmountComponentAtNode=function(e){if(!Ym(e))throw Error(Ne(40));return e._reactRootContainer?(Wl(function(){Jm(null,null,e,!1,function(){e._reactRootContainer=null,e[Ks]=null})}),!0):!1};lo.unstable_batchedUpdates=Dv;lo.unstable_renderSubtreeIntoContainer=function(e,t,s,l){if(!Ym(s))throw Error(Ne(200));if(e==null||e._reactInternals===void 0)throw Error(Ne(38));return Jm(e,t,s,!1,l)};lo.version="18.3.1-next-f1338f8080-20240426";function HT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(HT)}catch(e){console.error(e)}}HT(),H2.exports=lo;var Vv=H2.exports;const If=Fm(Vv);var gw=Vv;D_.createRoot=gw.createRoot,D_.hydrateRoot=gw.hydrateRoot;var ZT={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.7.0/LICENSE.txt
 */(function(e,t){(function(s,l){e.exports=l()})(FI,function(){var s={},l={};function f(x,u,P){if(l[x]=P,x==="index"){var L="var sharedModule = {}; ("+l.shared+")(sharedModule); ("+l.worker+")(sharedModule);",U={};return l.shared(U),l.index(s,U),typeof window<"u"&&s.setWorkerUrl(window.URL.createObjectURL(new Blob([L],{type:"text/javascript"}))),s}}f("shared",["exports"],function(x){function u(i,r,o,c){return new(o||(o=Promise))(function(p,_){function v(k){try{S(c.next(k))}catch(E){_(E)}}function b(k){try{S(c.throw(k))}catch(E){_(E)}}function S(k){var E;k.done?p(k.value):(E=k.value,E instanceof o?E:new o(function(A){A(E)})).then(v,b)}S((c=c.apply(i,r||[])).next())})}function P(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}typeof SuppressedError=="function"&&SuppressedError;var L=U;function U(i,r){this.x=i,this.y=r}U.prototype={clone:function(){return new U(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,r){return this.clone()._rotateAround(i,r)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var r=i.x-this.x,o=i.y-this.y;return r*r+o*o},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,r){return Math.atan2(this.x*r-this.y*i,this.x*i+this.y*r)},_matMult:function(i){var r=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=r,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var r=Math.cos(i),o=Math.sin(i),c=o*this.x+r*this.y;return this.x=r*this.x-o*this.y,this.y=c,this},_rotateAround:function(i,r){var o=Math.cos(i),c=Math.sin(i),p=r.y+c*(this.x-r.x)+o*(this.y-r.y);return this.x=r.x+o*(this.x-r.x)-c*(this.y-r.y),this.y=p,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},U.convert=function(i){return i instanceof U?i:Array.isArray(i)?new U(i[0],i[1]):i};var N=P(L),D=se;function se(i,r,o,c){this.cx=3*i,this.bx=3*(o-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(c-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=r,this.p2x=o,this.p2y=c}se.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,r){if(r===void 0&&(r=1e-6),i<0)return 0;if(i>1)return 1;for(var o=i,c=0;c<8;c++){var p=this.sampleCurveX(o)-i;if(Math.abs(p)<r)return o;var _=this.sampleCurveDerivativeX(o);if(Math.abs(_)<1e-6)break;o-=p/_}var v=0,b=1;for(o=i,c=0;c<20&&(p=this.sampleCurveX(o),!(Math.abs(p-i)<r));c++)i>p?v=o:b=o,o=.5*(b-v)+v;return o},solve:function(i,r){return this.sampleCurveY(this.solveCurveX(i,r))}};var ne=P(D);let ee,ke;function X(){return ee==null&&(ee=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),ee}function Z(){if(ke==null&&(ke=!1,X())){const r=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(r){for(let c=0;c<5*5;c++){const p=4*c;r.fillStyle=`rgb(${p},${p+1},${p+2})`,r.fillRect(c%5,Math.floor(c/5),1,1)}const o=r.getImageData(0,0,5,5).data;for(let c=0;c<5*5*4;c++)if(c%4!=3&&o[c]!==c){ke=!0;break}}}return ke||!1}function W(i,r,o,c){const p=new ne(i,r,o,c);return _=>p.solve(_)}const pe=W(.25,.1,.25,1);function _e(i,r,o){return Math.min(o,Math.max(r,i))}function be(i,r,o){const c=o-r,p=((i-r)%c+c)%c+r;return p===r?o:p}function xe(i,...r){for(const o of r)for(const c in o)i[c]=o[c];return i}let Re=1;function tt(i,r,o){const c={};for(const p in i)c[p]=r.call(this,i[p],p,i);return c}function Oe(i,r,o){const c={};for(const p in i)r.call(this,i[p],p,i)&&(c[p]=i[p]);return c}function He(i){return Array.isArray(i)?i.map(He):typeof i=="object"&&i?tt(i,He):i}const vt={};function dt(i){vt[i]||(typeof console<"u"&&console.warn(i),vt[i]=!0)}function ht(i,r,o){return(o.y-i.y)*(r.x-i.x)>(r.y-i.y)*(o.x-i.x)}function Lt(i){return typeof WorkerGlobalScope<"u"&&i!==void 0&&i instanceof WorkerGlobalScope}let yt=null;function Tt(i){return typeof ImageBitmap<"u"&&i instanceof ImageBitmap}const Pe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function et(i,r,o,c,p){return u(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const _=new VideoFrame(i,{timestamp:0});try{const v=_==null?void 0:_.format;if(!v||!v.startsWith("BGR")&&!v.startsWith("RGB"))throw new Error(`Unrecognized format ${v}`);const b=v.startsWith("BGR"),S=new Uint8ClampedArray(c*p*4);if(yield _.copyTo(S,function(k,E,A,R,O){const j=4*Math.max(-E,0),V=(Math.max(0,A)-A)*R*4+j,Y=4*R,re=Math.max(0,E),ye=Math.max(0,A);return{rect:{x:re,y:ye,width:Math.min(k.width,E+R)-re,height:Math.min(k.height,A+O)-ye},layout:[{offset:V,stride:Y}]}}(i,r,o,c,p)),b)for(let k=0;k<S.length;k+=4){const E=S[k];S[k]=S[k+2],S[k+2]=E}return S}finally{_.close()}})}let lt,Ct;const Nt="AbortError";function gr(){return new Error(Nt)}const Qt={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function _n(i){return Qt.REGISTERED_PROTOCOLS[i.substring(0,i.indexOf("://"))]}const Pn="global-dispatcher";class An extends Error{constructor(r,o,c,p){super(`AJAXError: ${o} (${r}): ${c}`),this.status=r,this.statusText=o,this.url=c,this.body=p}}const yr=()=>Lt(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,$n=function(i,r){if(/:\/\//.test(i.url)&&!/^https?:|^file:/.test(i.url)){const c=_n(i.url);if(c)return c(i,r);if(Lt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:i,targetMapId:Pn},r)}if(!(/^file:/.test(o=i.url)||/^file:/.test(yr())&&!/^\w+:/.test(o))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(c,p){return u(this,void 0,void 0,function*(){const _=new Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,cache:c.cache,referrer:yr(),signal:p.signal});c.type!=="json"||_.headers.has("Accept")||_.headers.set("Accept","application/json");const v=yield fetch(_);if(!v.ok){const k=yield v.blob();throw new An(v.status,v.statusText,c.url,k)}let b;b=c.type==="arrayBuffer"||c.type==="image"?v.arrayBuffer():c.type==="json"?v.json():v.text();const S=yield b;if(p.signal.aborted)throw gr();return{data:S,cacheControl:v.headers.get("Cache-Control"),expires:v.headers.get("Expires")}})}(i,r);if(Lt(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:i,mustQueue:!0,targetMapId:Pn},r)}var o;return function(c,p){return new Promise((_,v)=>{var b;const S=new XMLHttpRequest;S.open(c.method||"GET",c.url,!0),c.type!=="arrayBuffer"&&c.type!=="image"||(S.responseType="arraybuffer");for(const k in c.headers)S.setRequestHeader(k,c.headers[k]);c.type==="json"&&(S.responseType="text",!((b=c.headers)===null||b===void 0)&&b.Accept||S.setRequestHeader("Accept","application/json")),S.withCredentials=c.credentials==="include",S.onerror=()=>{v(new Error(S.statusText))},S.onload=()=>{if(!p.signal.aborted)if((S.status>=200&&S.status<300||S.status===0)&&S.response!==null){let k=S.response;if(c.type==="json")try{k=JSON.parse(S.response)}catch(E){return void v(E)}_({data:k,cacheControl:S.getResponseHeader("Cache-Control"),expires:S.getResponseHeader("Expires")})}else{const k=new Blob([S.response],{type:S.getResponseHeader("Content-Type")});v(new An(S.status,S.statusText,c.url,k))}},p.signal.addEventListener("abort",()=>{S.abort(),v(gr())}),S.send(c.body)})}(i,r)};function si(i){if(!i||i.indexOf("://")<=0||i.indexOf("data:image/")===0||i.indexOf("blob:")===0)return!0;const r=new URL(i),o=window.location;return r.protocol===o.protocol&&r.host===o.host}function Bo(i,r,o){o[i]&&o[i].indexOf(r)!==-1||(o[i]=o[i]||[],o[i].push(r))}function ai(i,r,o){if(o&&o[i]){const c=o[i].indexOf(r);c!==-1&&o[i].splice(c,1)}}class ur{constructor(r,o={}){xe(this,o),this.type=r}}class zr extends ur{constructor(r,o={}){super("error",xe({error:r},o))}}class es{on(r,o){return this._listeners=this._listeners||{},Bo(r,o,this._listeners),this}off(r,o){return ai(r,o,this._listeners),ai(r,o,this._oneTimeListeners),this}once(r,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},Bo(r,o,this._oneTimeListeners),this):new Promise(c=>this.once(r,c))}fire(r,o){typeof r=="string"&&(r=new ur(r,o||{}));const c=r.type;if(this.listens(c)){r.target=this;const p=this._listeners&&this._listeners[c]?this._listeners[c].slice():[];for(const b of p)b.call(this,r);const _=this._oneTimeListeners&&this._oneTimeListeners[c]?this._oneTimeListeners[c].slice():[];for(const b of _)ai(c,b,this._oneTimeListeners),b.call(this,r);const v=this._eventedParent;v&&(xe(r,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),v.fire(r))}else r instanceof zr&&console.error(r.error);return this}listens(r){return this._listeners&&this._listeners[r]&&this._listeners[r].length>0||this._oneTimeListeners&&this._oneTimeListeners[r]&&this._oneTimeListeners[r].length>0||this._eventedParent&&this._eventedParent.listens(r)}setEventedParent(r,o){return this._eventedParent=r,this._eventedParentData=o,this}}var Se={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Oo=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Ss(i,r){const o={};for(const c in i)c!=="ref"&&(o[c]=i[c]);return Oo.forEach(c=>{c in r&&(o[c]=r[c])}),o}function $t(i,r){if(Array.isArray(i)){if(!Array.isArray(r)||i.length!==r.length)return!1;for(let o=0;o<i.length;o++)if(!$t(i[o],r[o]))return!1;return!0}if(typeof i=="object"&&i!==null&&r!==null){if(typeof r!="object"||Object.keys(i).length!==Object.keys(r).length)return!1;for(const o in i)if(!$t(i[o],r[o]))return!1;return!0}return i===r}function dn(i,r){i.push(r)}function No(i,r,o){dn(o,{command:"addSource",args:[i,r[i]]})}function ho(i,r,o){dn(r,{command:"removeSource",args:[i]}),o[i]=!0}function Oi(i,r,o,c){ho(i,o,c),No(i,r,o)}function Ni(i,r,o){let c;for(c in i[o])if(Object.prototype.hasOwnProperty.call(i[o],c)&&c!=="data"&&!$t(i[o][c],r[o][c]))return!1;for(c in r[o])if(Object.prototype.hasOwnProperty.call(r[o],c)&&c!=="data"&&!$t(i[o][c],r[o][c]))return!1;return!0}function nr(i,r,o,c,p,_){i=i||{},r=r||{};for(const v in i)Object.prototype.hasOwnProperty.call(i,v)&&($t(i[v],r[v])||o.push({command:_,args:[c,v,r[v],p]}));for(const v in r)Object.prototype.hasOwnProperty.call(r,v)&&!Object.prototype.hasOwnProperty.call(i,v)&&($t(i[v],r[v])||o.push({command:_,args:[c,v,r[v],p]}))}function Ts(i){return i.id}function ts(i,r){return i[r.id]=r,i}class Fe{constructor(r,o,c,p){this.message=(r?`${r}: `:"")+c,p&&(this.identifier=p),o!=null&&o.__line__&&(this.line=o.__line__)}}function wt(i,...r){for(const o of r)for(const c in o)i[c]=o[c];return i}class rr extends Error{constructor(r,o){super(o),this.message=o,this.key=r}}class wi{constructor(r,o=[]){this.parent=r,this.bindings={};for(const[c,p]of o)this.bindings[c]=p}concat(r){return new wi(this,r)}get(r){if(this.bindings[r])return this.bindings[r];if(this.parent)return this.parent.get(r);throw new Error(`${r} not found in scope.`)}has(r){return!!this.bindings[r]||!!this.parent&&this.parent.has(r)}}const $i={kind:"null"},Ve={kind:"number"},Mt={kind:"string"},_t={kind:"boolean"},Gr={kind:"color"},ji={kind:"object"},kt={kind:"value"},po={kind:"collator"},$o={kind:"formatted"},ns={kind:"padding"},fo={kind:"resolvedImage"},te={kind:"variableAnchorOffsetCollection"};function B(i,r){return{kind:"array",itemType:i,N:r}}function F(i){if(i.kind==="array"){const r=F(i.itemType);return typeof i.N=="number"?`array<${r}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${r}>`}return i.kind}const q=[$i,Ve,Mt,_t,Gr,$o,ji,B(kt),ns,fo,te];function J(i,r){if(r.kind==="error")return null;if(i.kind==="array"){if(r.kind==="array"&&(r.N===0&&r.itemType.kind==="value"||!J(i.itemType,r.itemType))&&(typeof i.N!="number"||i.N===r.N))return null}else{if(i.kind===r.kind)return null;if(i.kind==="value"){for(const o of q)if(!J(o,r))return null}}return`Expected ${F(i)} but found ${F(r)} instead.`}function ue(i,r){return r.some(o=>o.kind===i.kind)}function de(i,r){return r.some(o=>o==="null"?i===null:o==="array"?Array.isArray(i):o==="object"?i&&!Array.isArray(i)&&typeof i=="object":o===typeof i)}function ge(i,r){return i.kind==="array"&&r.kind==="array"?i.itemType.kind===r.itemType.kind&&typeof i.N=="number":i.kind===r.kind}const ae=.96422,Ee=.82521,ze=4/29,we=6/29,$e=3*we*we,ct=we*we*we,pt=Math.PI/180,jt=180/Math.PI;function Et(i){return(i%=360)<0&&(i+=360),i}function Ut([i,r,o,c]){let p,_;const v=Hn((.2225045*(i=Dt(i))+.7168786*(r=Dt(r))+.0606169*(o=Dt(o)))/1);i===r&&r===o?p=_=v:(p=Hn((.4360747*i+.3850649*r+.1430804*o)/ae),_=Hn((.0139322*i+.0971045*r+.7141733*o)/Ee));const b=116*v-16;return[b<0?0:b,500*(p-v),200*(v-_),c]}function Dt(i){return i<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function Hn(i){return i>ct?Math.pow(i,1/3):i/$e+ze}function Mn([i,r,o,c]){let p=(i+16)/116,_=isNaN(r)?p:p+r/500,v=isNaN(o)?p:p-o/200;return p=1*en(p),_=ae*en(_),v=Ee*en(v),[zt(3.1338561*_-1.6168667*p-.4906146*v),zt(-.9787684*_+1.9161415*p+.033454*v),zt(.0719453*_-.2289914*p+1.4052427*v),c]}function zt(i){return(i=i<=.00304?12.92*i:1.055*Math.pow(i,1/2.4)-.055)<0?0:i>1?1:i}function en(i){return i>we?i*i*i:$e*(i-ze)}function kn(i){return parseInt(i.padEnd(2,i),16)/255}function ir(i,r){return hr(r?i/100:i,0,1)}function hr(i,r,o){return Math.min(Math.max(r,i),o)}function Lr(i){return!i.some(Number.isNaN)}const ta={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class tn{constructor(r,o,c,p=1,_=!0){this.r=r,this.g=o,this.b=c,this.a=p,_||(this.r*=p,this.g*=p,this.b*=p,p||this.overwriteGetter("rgb",[r,o,c,p]))}static parse(r){if(r instanceof tn)return r;if(typeof r!="string")return;const o=function(c){if((c=c.toLowerCase().trim())==="transparent")return[0,0,0,0];const p=ta[c];if(p){const[v,b,S]=p;return[v/255,b/255,S/255,1]}if(c.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(c)){const v=c.length<6?1:2;let b=1;return[kn(c.slice(b,b+=v)),kn(c.slice(b,b+=v)),kn(c.slice(b,b+=v)),kn(c.slice(b,b+v)||"ff")]}if(c.startsWith("rgb")){const v=c.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(v){const[b,S,k,E,A,R,O,j,V,Y,re,ye]=v,ce=[E||" ",O||" ",Y].join("");if(ce==="  "||ce==="  /"||ce===",,"||ce===",,,"){const me=[k,R,V].join(""),Ce=me==="%%%"?100:me===""?255:0;if(Ce){const Le=[hr(+S/Ce,0,1),hr(+A/Ce,0,1),hr(+j/Ce,0,1),re?ir(+re,ye):1];if(Lr(Le))return Le}}return}}const _=c.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(_){const[v,b,S,k,E,A,R,O,j]=_,V=[S||" ",E||" ",R].join("");if(V==="  "||V==="  /"||V===",,"||V===",,,"){const Y=[+b,hr(+k,0,100),hr(+A,0,100),O?ir(+O,j):1];if(Lr(Y))return function([re,ye,ce,me]){function Ce(Le){const Xe=(Le+re/30)%12,ft=ye*Math.min(ce,1-ce);return ce-ft*Math.max(-1,Math.min(Xe-3,9-Xe,1))}return re=Et(re),ye/=100,ce/=100,[Ce(0),Ce(8),Ce(4),me]}(Y)}}}(r);return o?new tn(...o,!1):void 0}get rgb(){const{r,g:o,b:c,a:p}=this,_=p||1/0;return this.overwriteGetter("rgb",[r/_,o/_,c/_,p])}get hcl(){return this.overwriteGetter("hcl",function(r){const[o,c,p,_]=Ut(r),v=Math.sqrt(c*c+p*p);return[Math.round(1e4*v)?Et(Math.atan2(p,c)*jt):NaN,v,o,_]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Ut(this.rgb))}overwriteGetter(r,o){return Object.defineProperty(this,r,{value:o}),o}toString(){const[r,o,c,p]=this.rgb;return`rgba(${[r,o,c].map(_=>Math.round(255*_)).join(",")},${p})`}}tn.black=new tn(0,0,0,1),tn.white=new tn(1,1,1,1),tn.transparent=new tn(0,0,0,0),tn.red=new tn(1,0,0,1);class Vu{constructor(r,o,c){this.sensitivity=r?o?"variant":"case":o?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(r,o){return this.collator.compare(r,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Gu{constructor(r,o,c,p,_){this.text=r,this.image=o,this.scale=c,this.fontStack=p,this.textColor=_}}class li{constructor(r){this.sections=r}static fromString(r){return new li([new Gu(r,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(r=>r.text.length!==0||r.image&&r.image.name.length!==0)}static factory(r){return r instanceof li?r:li.fromString(r)}toString(){return this.sections.length===0?"":this.sections.map(r=>r.text).join("")}}class ci{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof ci)return r;if(typeof r=="number")return new ci([r,r,r,r]);if(Array.isArray(r)&&!(r.length<1||r.length>4)){for(const o of r)if(typeof o!="number")return;switch(r.length){case 1:r=[r[0],r[0],r[0],r[0]];break;case 2:r=[r[0],r[1],r[0],r[1]];break;case 3:r=[r[0],r[1],r[2],r[1]]}return new ci(r)}}toString(){return JSON.stringify(this.values)}}const Og=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Si{constructor(r){this.values=r.slice()}static parse(r){if(r instanceof Si)return r;if(Array.isArray(r)&&!(r.length<1)&&r.length%2==0){for(let o=0;o<r.length;o+=2){const c=r[o],p=r[o+1];if(typeof c!="string"||!Og.has(c)||!Array.isArray(p)||p.length!==2||typeof p[0]!="number"||typeof p[1]!="number")return}return new Si(r)}}toString(){return JSON.stringify(this.values)}}class ui{constructor(r){this.name=r.name,this.available=r.available}toString(){return this.name}static fromString(r){return r?new ui({name:r,available:!1}):null}}function na(i,r,o,c){return typeof i=="number"&&i>=0&&i<=255&&typeof r=="number"&&r>=0&&r<=255&&typeof o=="number"&&o>=0&&o<=255?c===void 0||typeof c=="number"&&c>=0&&c<=1?null:`Invalid rgba value [${[i,r,o,c].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof c=="number"?[i,r,o,c]:[i,r,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Cs(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof tn||i instanceof Vu||i instanceof li||i instanceof ci||i instanceof Si||i instanceof ui)return!0;if(Array.isArray(i)){for(const r of i)if(!Cs(r))return!1;return!0}if(typeof i=="object"){for(const r in i)if(!Cs(i[r]))return!1;return!0}return!1}function Zn(i){if(i===null)return $i;if(typeof i=="string")return Mt;if(typeof i=="boolean")return _t;if(typeof i=="number")return Ve;if(i instanceof tn)return Gr;if(i instanceof Vu)return po;if(i instanceof li)return $o;if(i instanceof ci)return ns;if(i instanceof Si)return te;if(i instanceof ui)return fo;if(Array.isArray(i)){const r=i.length;let o;for(const c of i){const p=Zn(c);if(o){if(o===p)continue;o=kt;break}o=p}return B(o||kt,r)}return ji}function nl(i){const r=typeof i;return i===null?"":r==="string"||r==="number"||r==="boolean"?String(i):i instanceof tn||i instanceof li||i instanceof ci||i instanceof Si||i instanceof ui?i.toString():JSON.stringify(i)}class Ui{constructor(r,o){this.type=r,this.value=o}static parse(r,o){if(r.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${r.length-1} instead.`);if(!Cs(r[1]))return o.error("invalid value");const c=r[1];let p=Zn(c);const _=o.expectedType;return p.kind!=="array"||p.N!==0||!_||_.kind!=="array"||typeof _.N=="number"&&_.N!==0||(p=_),new Ui(p,c)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class jn{constructor(r){this.name="ExpressionEvaluationError",this.message=r}toJSON(){return this.message}}const Yl={string:Mt,number:Ve,boolean:_t,object:ji};class Vi{constructor(r,o){this.type=r,this.args=o}static parse(r,o){if(r.length<2)return o.error("Expected at least one argument.");let c,p=1;const _=r[0];if(_==="array"){let b,S;if(r.length>2){const k=r[1];if(typeof k!="string"||!(k in Yl)||k==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);b=Yl[k],p++}else b=kt;if(r.length>3){if(r[2]!==null&&(typeof r[2]!="number"||r[2]<0||r[2]!==Math.floor(r[2])))return o.error('The length argument to "array" must be a positive integer literal',2);S=r[2],p++}c=B(b,S)}else{if(!Yl[_])throw new Error(`Types doesn't contain name = ${_}`);c=Yl[_]}const v=[];for(;p<r.length;p++){const b=o.parse(r[p],p,kt);if(!b)return null;v.push(b)}return new Vi(c,v)}evaluate(r){for(let o=0;o<this.args.length;o++){const c=this.args[o].evaluate(r);if(!J(this.type,Zn(c)))return c;if(o===this.args.length-1)throw new jn(`Expected value to be of type ${F(this.type)}, but found ${F(Zn(c))} instead.`)}throw new Error}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}const qu={"to-boolean":_t,"to-color":Gr,"to-number":Ve,"to-string":Mt};class Gi{constructor(r,o){this.type=r,this.args=o}static parse(r,o){if(r.length<2)return o.error("Expected at least one argument.");const c=r[0];if(!qu[c])throw new Error(`Can't parse ${c} as it is not part of the known types`);if((c==="to-boolean"||c==="to-string")&&r.length!==2)return o.error("Expected one argument.");const p=qu[c],_=[];for(let v=1;v<r.length;v++){const b=o.parse(r[v],v,kt);if(!b)return null;_.push(b)}return new Gi(p,_)}evaluate(r){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(r);case"color":{let o,c;for(const p of this.args){if(o=p.evaluate(r),c=null,o instanceof tn)return o;if(typeof o=="string"){const _=r.parseColor(o);if(_)return _}else if(Array.isArray(o)&&(c=o.length<3||o.length>4?`Invalid rbga value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:na(o[0],o[1],o[2],o[3]),!c))return new tn(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new jn(c||`Could not parse color from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"padding":{let o;for(const c of this.args){o=c.evaluate(r);const p=ci.parse(o);if(p)return p}throw new jn(`Could not parse padding from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"variableAnchorOffsetCollection":{let o;for(const c of this.args){o=c.evaluate(r);const p=Si.parse(o);if(p)return p}throw new jn(`Could not parse variableAnchorOffsetCollection from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"number":{let o=null;for(const c of this.args){if(o=c.evaluate(r),o===null)return 0;const p=Number(o);if(!isNaN(p))return p}throw new jn(`Could not convert ${JSON.stringify(o)} to number.`)}case"formatted":return li.fromString(nl(this.args[0].evaluate(r)));case"resolvedImage":return ui.fromString(nl(this.args[0].evaluate(r)));default:return nl(this.args[0].evaluate(r))}}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}const Ng=["Unknown","Point","LineString","Polygon"];class Jl{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Ng[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(r){let o=this._parseColorCache[r];return o||(o=this._parseColorCache[r]=tn.parse(r)),o}}class ks{constructor(r,o,c=[],p,_=new wi,v=[]){this.registry=r,this.path=c,this.key=c.map(b=>`[${b}]`).join(""),this.scope=_,this.errors=v,this.expectedType=p,this._isConstant=o}parse(r,o,c,p,_={}){return o?this.concat(o,c,p)._parse(r,_):this._parse(r,_)}_parse(r,o){function c(p,_,v){return v==="assert"?new Vi(_,[p]):v==="coerce"?new Gi(_,[p]):p}if(r!==null&&typeof r!="string"&&typeof r!="boolean"&&typeof r!="number"||(r=["literal",r]),Array.isArray(r)){if(r.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const p=r[0];if(typeof p!="string")return this.error(`Expression name must be a string, but found ${typeof p} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const _=this.registry[p];if(_){let v=_.parse(r,this);if(!v)return null;if(this.expectedType){const b=this.expectedType,S=v.type;if(b.kind!=="string"&&b.kind!=="number"&&b.kind!=="boolean"&&b.kind!=="object"&&b.kind!=="array"||S.kind!=="value")if(b.kind!=="color"&&b.kind!=="formatted"&&b.kind!=="resolvedImage"||S.kind!=="value"&&S.kind!=="string")if(b.kind!=="padding"||S.kind!=="value"&&S.kind!=="number"&&S.kind!=="array")if(b.kind!=="variableAnchorOffsetCollection"||S.kind!=="value"&&S.kind!=="array"){if(this.checkSubtype(b,S))return null}else v=c(v,b,o.typeAnnotation||"coerce");else v=c(v,b,o.typeAnnotation||"coerce");else v=c(v,b,o.typeAnnotation||"coerce");else v=c(v,b,o.typeAnnotation||"assert")}if(!(v instanceof Ui)&&v.type.kind!=="resolvedImage"&&this._isConstant(v)){const b=new Jl;try{v=new Ui(v.type,v.evaluate(b))}catch(S){return this.error(S.message),null}}return v}return this.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(r===void 0?"'undefined' value invalid. Use null instead.":typeof r=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof r} instead.`)}concat(r,o,c){const p=typeof r=="number"?this.path.concat(r):this.path,_=c?this.scope.concat(c):this.scope;return new ks(this.registry,this._isConstant,p,o||null,_,this.errors)}error(r,...o){const c=`${this.key}${o.map(p=>`[${p}]`).join("")}`;this.errors.push(new rr(c,r))}checkSubtype(r,o){const c=J(r,o);return c&&this.error(c),c}}class rs{constructor(r,o){this.type=o.type,this.bindings=[].concat(r),this.result=o}evaluate(r){return this.result.evaluate(r)}eachChild(r){for(const o of this.bindings)r(o[1]);r(this.result)}static parse(r,o){if(r.length<4)return o.error(`Expected at least 3 arguments, but found ${r.length-1} instead.`);const c=[];for(let _=1;_<r.length-1;_+=2){const v=r[_];if(typeof v!="string")return o.error(`Expected string, but found ${typeof v} instead.`,_);if(/[^a-zA-Z0-9_]/.test(v))return o.error("Variable names must contain only alphanumeric characters or '_'.",_);const b=o.parse(r[_+1],_+1);if(!b)return null;c.push([v,b])}const p=o.parse(r[r.length-1],r.length-1,o.expectedType,c);return p?new rs(c,p):null}outputDefined(){return this.result.outputDefined()}}class Ht{constructor(r,o){this.type=o.type,this.name=r,this.boundExpression=o}static parse(r,o){if(r.length!==2||typeof r[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const c=r[1];return o.scope.has(c)?new Ht(c,o.scope.get(c)):o.error(`Unknown variable "${c}". Make sure "${c}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(r){return this.boundExpression.evaluate(r)}eachChild(){}outputDefined(){return!1}}class Hu{constructor(r,o,c){this.type=r,this.index=o,this.input=c}static parse(r,o){if(r.length!==3)return o.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const c=o.parse(r[1],1,Ve),p=o.parse(r[2],2,B(o.expectedType||kt));return c&&p?new Hu(p.type.itemType,c,p):null}evaluate(r){const o=this.index.evaluate(r),c=this.input.evaluate(r);if(o<0)throw new jn(`Array index out of bounds: ${o} < 0.`);if(o>=c.length)throw new jn(`Array index out of bounds: ${o} > ${c.length-1}.`);if(o!==Math.floor(o))throw new jn(`Array index must be an integer, but found ${o} instead.`);return c[o]}eachChild(r){r(this.index),r(this.input)}outputDefined(){return!1}}class Zu{constructor(r,o){this.type=_t,this.needle=r,this.haystack=o}static parse(r,o){if(r.length!==3)return o.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const c=o.parse(r[1],1,kt),p=o.parse(r[2],2,kt);return c&&p?ue(c.type,[_t,Mt,Ve,$i,kt])?new Zu(c,p):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${F(c.type)} instead`):null}evaluate(r){const o=this.needle.evaluate(r),c=this.haystack.evaluate(r);if(!c)return!1;if(!de(o,["boolean","string","number","null"]))throw new jn(`Expected first argument to be of type boolean, string, number or null, but found ${F(Zn(o))} instead.`);if(!de(c,["string","array"]))throw new jn(`Expected second argument to be of type array or string, but found ${F(Zn(c))} instead.`);return c.indexOf(o)>=0}eachChild(r){r(this.needle),r(this.haystack)}outputDefined(){return!0}}class ra{constructor(r,o,c){this.type=Ve,this.needle=r,this.haystack=o,this.fromIndex=c}static parse(r,o){if(r.length<=2||r.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const c=o.parse(r[1],1,kt),p=o.parse(r[2],2,kt);if(!c||!p)return null;if(!ue(c.type,[_t,Mt,Ve,$i,kt]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${F(c.type)} instead`);if(r.length===4){const _=o.parse(r[3],3,Ve);return _?new ra(c,p,_):null}return new ra(c,p)}evaluate(r){const o=this.needle.evaluate(r),c=this.haystack.evaluate(r);if(!de(o,["boolean","string","number","null"]))throw new jn(`Expected first argument to be of type boolean, string, number or null, but found ${F(Zn(o))} instead.`);let p;if(this.fromIndex&&(p=this.fromIndex.evaluate(r)),de(c,["string"])){const _=c.indexOf(o,p);return _===-1?-1:[...c.slice(0,_)].length}if(de(c,["array"]))return c.indexOf(o,p);throw new jn(`Expected second argument to be of type array or string, but found ${F(Zn(c))} instead.`)}eachChild(r){r(this.needle),r(this.haystack),this.fromIndex&&r(this.fromIndex)}outputDefined(){return!1}}class Wu{constructor(r,o,c,p,_,v){this.inputType=r,this.type=o,this.input=c,this.cases=p,this.outputs=_,this.otherwise=v}static parse(r,o){if(r.length<5)return o.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if(r.length%2!=1)return o.error("Expected an even number of arguments.");let c,p;o.expectedType&&o.expectedType.kind!=="value"&&(p=o.expectedType);const _={},v=[];for(let k=2;k<r.length-1;k+=2){let E=r[k];const A=r[k+1];Array.isArray(E)||(E=[E]);const R=o.concat(k);if(E.length===0)return R.error("Expected at least one branch label.");for(const j of E){if(typeof j!="number"&&typeof j!="string")return R.error("Branch labels must be numbers or strings.");if(typeof j=="number"&&Math.abs(j)>Number.MAX_SAFE_INTEGER)return R.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof j=="number"&&Math.floor(j)!==j)return R.error("Numeric branch labels must be integer values.");if(c){if(R.checkSubtype(c,Zn(j)))return null}else c=Zn(j);if(_[String(j)]!==void 0)return R.error("Branch labels must be unique.");_[String(j)]=v.length}const O=o.parse(A,k,p);if(!O)return null;p=p||O.type,v.push(O)}const b=o.parse(r[1],1,kt);if(!b)return null;const S=o.parse(r[r.length-1],r.length-1,p);return S?b.type.kind!=="value"&&o.concat(1).checkSubtype(c,b.type)?null:new Wu(c,p,b,_,v,S):null}evaluate(r){const o=this.input.evaluate(r);return(Zn(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(r)}eachChild(r){r(this.input),this.outputs.forEach(r),r(this.otherwise)}outputDefined(){return this.outputs.every(r=>r.outputDefined())&&this.otherwise.outputDefined()}}class Ql{constructor(r,o,c){this.type=r,this.branches=o,this.otherwise=c}static parse(r,o){if(r.length<4)return o.error(`Expected at least 3 arguments, but found only ${r.length-1}.`);if(r.length%2!=0)return o.error("Expected an odd number of arguments.");let c;o.expectedType&&o.expectedType.kind!=="value"&&(c=o.expectedType);const p=[];for(let v=1;v<r.length-1;v+=2){const b=o.parse(r[v],v,_t);if(!b)return null;const S=o.parse(r[v+1],v+1,c);if(!S)return null;p.push([b,S]),c=c||S.type}const _=o.parse(r[r.length-1],r.length-1,c);if(!_)return null;if(!c)throw new Error("Can't infer output type");return new Ql(c,p,_)}evaluate(r){for(const[o,c]of this.branches)if(o.evaluate(r))return c.evaluate(r);return this.otherwise.evaluate(r)}eachChild(r){for(const[o,c]of this.branches)r(o),r(c);r(this.otherwise)}outputDefined(){return this.branches.every(([r,o])=>o.outputDefined())&&this.otherwise.outputDefined()}}class rl{constructor(r,o,c,p){this.type=r,this.input=o,this.beginIndex=c,this.endIndex=p}static parse(r,o){if(r.length<=2||r.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const c=o.parse(r[1],1,kt),p=o.parse(r[2],2,Ve);if(!c||!p)return null;if(!ue(c.type,[B(kt),Mt,kt]))return o.error(`Expected first argument to be of type array or string, but found ${F(c.type)} instead`);if(r.length===4){const _=o.parse(r[3],3,Ve);return _?new rl(c.type,c,p,_):null}return new rl(c.type,c,p)}evaluate(r){const o=this.input.evaluate(r),c=this.beginIndex.evaluate(r);let p;if(this.endIndex&&(p=this.endIndex.evaluate(r)),de(o,["string"]))return[...o].slice(c,p).join("");if(de(o,["array"]))return o.slice(c,p);throw new jn(`Expected first argument to be of type array or string, but found ${F(Zn(o))} instead.`)}eachChild(r){r(this.input),r(this.beginIndex),this.endIndex&&r(this.endIndex)}outputDefined(){return!1}}function ec(i,r){const o=i.length-1;let c,p,_=0,v=o,b=0;for(;_<=v;)if(b=Math.floor((_+v)/2),c=i[b],p=i[b+1],c<=r){if(b===o||r<p)return b;_=b+1}else{if(!(c>r))throw new jn("Input is not a number.");v=b-1}return 0}class ia{constructor(r,o,c){this.type=r,this.input=o,this.labels=[],this.outputs=[];for(const[p,_]of c)this.labels.push(p),this.outputs.push(_)}static parse(r,o){if(r.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return o.error("Expected an even number of arguments.");const c=o.parse(r[1],1,Ve);if(!c)return null;const p=[];let _=null;o.expectedType&&o.expectedType.kind!=="value"&&(_=o.expectedType);for(let v=1;v<r.length;v+=2){const b=v===1?-1/0:r[v],S=r[v+1],k=v,E=v+1;if(typeof b!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(p.length&&p[p.length-1][0]>=b)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',k);const A=o.parse(S,E,_);if(!A)return null;_=_||A.type,p.push([b,A])}return new ia(_,c,p)}evaluate(r){const o=this.labels,c=this.outputs;if(o.length===1)return c[0].evaluate(r);const p=this.input.evaluate(r);if(p<=o[0])return c[0].evaluate(r);const _=o.length;return p>=o[_-1]?c[_-1].evaluate(r):c[ec(o,p)].evaluate(r)}eachChild(r){r(this.input);for(const o of this.outputs)r(o)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}}function lp(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var $g=cp;function cp(i,r,o,c){this.cx=3*i,this.bx=3*(o-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(c-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=r,this.p2x=o,this.p2y=c}cp.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,r){if(r===void 0&&(r=1e-6),i<0)return 0;if(i>1)return 1;for(var o=i,c=0;c<8;c++){var p=this.sampleCurveX(o)-i;if(Math.abs(p)<r)return o;var _=this.sampleCurveDerivativeX(o);if(Math.abs(_)<1e-6)break;o-=p/_}var v=0,b=1;for(o=i,c=0;c<20&&(p=this.sampleCurveX(o),!(Math.abs(p-i)<r));c++)i>p?v=o:b=o,o=.5*(b-v)+v;return o},solve:function(i,r){return this.sampleCurveY(this.solveCurveX(i,r))}};var jg=lp($g);function Es(i,r,o){return i+o*(r-i)}function il(i,r,o){return i.map((c,p)=>Es(c,r[p],o))}const qr={number:Es,color:function(i,r,o,c="rgb"){switch(c){case"rgb":{const[p,_,v,b]=il(i.rgb,r.rgb,o);return new tn(p,_,v,b,!1)}case"hcl":{const[p,_,v,b]=i.hcl,[S,k,E,A]=r.hcl;let R,O;if(isNaN(p)||isNaN(S))isNaN(p)?isNaN(S)?R=NaN:(R=S,v!==1&&v!==0||(O=k)):(R=p,E!==1&&E!==0||(O=_));else{let ye=S-p;S>p&&ye>180?ye-=360:S<p&&p-S>180&&(ye+=360),R=p+o*ye}const[j,V,Y,re]=function([ye,ce,me,Ce]){return ye=isNaN(ye)?0:ye*pt,Mn([me,Math.cos(ye)*ce,Math.sin(ye)*ce,Ce])}([R,O??Es(_,k,o),Es(v,E,o),Es(b,A,o)]);return new tn(j,V,Y,re,!1)}case"lab":{const[p,_,v,b]=Mn(il(i.lab,r.lab,o));return new tn(p,_,v,b,!1)}}},array:il,padding:function(i,r,o){return new ci(il(i.values,r.values,o))},variableAnchorOffsetCollection:function(i,r,o){const c=i.values,p=r.values;if(c.length!==p.length)throw new jn(`Cannot interpolate values of different length. from: ${i.toString()}, to: ${r.toString()}`);const _=[];for(let v=0;v<c.length;v+=2){if(c[v]!==p[v])throw new jn(`Cannot interpolate values containing mismatched anchors. from[${v}]: ${c[v]}, to[${v}]: ${p[v]}`);_.push(c[v]);const[b,S]=c[v+1],[k,E]=p[v+1];_.push([Es(b,k,o),Es(S,E,o)])}return new Si(_)}};class Hr{constructor(r,o,c,p,_){this.type=r,this.operator=o,this.interpolation=c,this.input=p,this.labels=[],this.outputs=[];for(const[v,b]of _)this.labels.push(v),this.outputs.push(b)}static interpolationFactor(r,o,c,p){let _=0;if(r.name==="exponential")_=tc(o,r.base,c,p);else if(r.name==="linear")_=tc(o,1,c,p);else if(r.name==="cubic-bezier"){const v=r.controlPoints;_=new jg(v[0],v[1],v[2],v[3]).solve(tc(o,1,c,p))}return _}static parse(r,o){let[c,p,_,...v]=r;if(!Array.isArray(p)||p.length===0)return o.error("Expected an interpolation type expression.",1);if(p[0]==="linear")p={name:"linear"};else if(p[0]==="exponential"){const k=p[1];if(typeof k!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:k}}else{if(p[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(p[0])}`,1,0);{const k=p.slice(1);if(k.length!==4||k.some(E=>typeof E!="number"||E<0||E>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:k}}}if(r.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(_=o.parse(_,2,Ve),!_)return null;const b=[];let S=null;c==="interpolate-hcl"||c==="interpolate-lab"?S=Gr:o.expectedType&&o.expectedType.kind!=="value"&&(S=o.expectedType);for(let k=0;k<v.length;k+=2){const E=v[k],A=v[k+1],R=k+3,O=k+4;if(typeof E!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',R);if(b.length&&b[b.length-1][0]>=E)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',R);const j=o.parse(A,O,S);if(!j)return null;S=S||j.type,b.push([E,j])}return ge(S,Ve)||ge(S,Gr)||ge(S,ns)||ge(S,te)||ge(S,B(Ve))?new Hr(S,c,p,_,b):o.error(`Type ${F(S)} is not interpolatable.`)}evaluate(r){const o=this.labels,c=this.outputs;if(o.length===1)return c[0].evaluate(r);const p=this.input.evaluate(r);if(p<=o[0])return c[0].evaluate(r);const _=o.length;if(p>=o[_-1])return c[_-1].evaluate(r);const v=ec(o,p),b=Hr.interpolationFactor(this.interpolation,p,o[v],o[v+1]),S=c[v].evaluate(r),k=c[v+1].evaluate(r);switch(this.operator){case"interpolate":return qr[this.type.kind](S,k,b);case"interpolate-hcl":return qr.color(S,k,b,"hcl");case"interpolate-lab":return qr.color(S,k,b,"lab")}}eachChild(r){r(this.input);for(const o of this.outputs)r(o)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}}function tc(i,r,o,c){const p=c-o,_=i-o;return p===0?0:r===1?_/p:(Math.pow(r,_)-1)/(Math.pow(r,p)-1)}class nc{constructor(r,o){this.type=r,this.args=o}static parse(r,o){if(r.length<2)return o.error("Expectected at least one argument.");let c=null;const p=o.expectedType;p&&p.kind!=="value"&&(c=p);const _=[];for(const b of r.slice(1)){const S=o.parse(b,1+_.length,c,void 0,{typeAnnotation:"omit"});if(!S)return null;c=c||S.type,_.push(S)}if(!c)throw new Error("No output type");const v=p&&_.some(b=>J(p,b.type));return new nc(v?kt:c,_)}evaluate(r){let o,c=null,p=0;for(const _ of this.args)if(p++,c=_.evaluate(r),c&&c instanceof ui&&!c.available&&(o||(o=c.name),c=null,p===this.args.length&&(c=o)),c!==null)break;return c}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}}function rc(i,r){return i==="=="||i==="!="?r.kind==="boolean"||r.kind==="string"||r.kind==="number"||r.kind==="null"||r.kind==="value":r.kind==="string"||r.kind==="number"||r.kind==="value"}function up(i,r,o,c){return c.compare(r,o)===0}function oa(i,r,o){const c=i!=="=="&&i!=="!=";return class WT{constructor(_,v,b){this.type=_t,this.lhs=_,this.rhs=v,this.collator=b,this.hasUntypedArgument=_.type.kind==="value"||v.type.kind==="value"}static parse(_,v){if(_.length!==3&&_.length!==4)return v.error("Expected two or three arguments.");const b=_[0];let S=v.parse(_[1],1,kt);if(!S)return null;if(!rc(b,S.type))return v.concat(1).error(`"${b}" comparisons are not supported for type '${F(S.type)}'.`);let k=v.parse(_[2],2,kt);if(!k)return null;if(!rc(b,k.type))return v.concat(2).error(`"${b}" comparisons are not supported for type '${F(k.type)}'.`);if(S.type.kind!==k.type.kind&&S.type.kind!=="value"&&k.type.kind!=="value")return v.error(`Cannot compare types '${F(S.type)}' and '${F(k.type)}'.`);c&&(S.type.kind==="value"&&k.type.kind!=="value"?S=new Vi(k.type,[S]):S.type.kind!=="value"&&k.type.kind==="value"&&(k=new Vi(S.type,[k])));let E=null;if(_.length===4){if(S.type.kind!=="string"&&k.type.kind!=="string"&&S.type.kind!=="value"&&k.type.kind!=="value")return v.error("Cannot use collator to compare non-string types.");if(E=v.parse(_[3],3,po),!E)return null}return new WT(S,k,E)}evaluate(_){const v=this.lhs.evaluate(_),b=this.rhs.evaluate(_);if(c&&this.hasUntypedArgument){const S=Zn(v),k=Zn(b);if(S.kind!==k.kind||S.kind!=="string"&&S.kind!=="number")throw new jn(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${S.kind}, ${k.kind}) instead.`)}if(this.collator&&!c&&this.hasUntypedArgument){const S=Zn(v),k=Zn(b);if(S.kind!=="string"||k.kind!=="string")return r(_,v,b)}return this.collator?o(_,v,b,this.collator.evaluate(_)):r(_,v,b)}eachChild(_){_(this.lhs),_(this.rhs),this.collator&&_(this.collator)}outputDefined(){return!0}}}const Ug=oa("==",function(i,r,o){return r===o},up),hp=oa("!=",function(i,r,o){return r!==o},function(i,r,o,c){return!up(0,r,o,c)}),dp=oa("<",function(i,r,o){return r<o},function(i,r,o,c){return c.compare(r,o)<0}),Vg=oa(">",function(i,r,o){return r>o},function(i,r,o,c){return c.compare(r,o)>0}),Gg=oa("<=",function(i,r,o){return r<=o},function(i,r,o,c){return c.compare(r,o)<=0}),pp=oa(">=",function(i,r,o){return r>=o},function(i,r,o,c){return c.compare(r,o)>=0});class ol{constructor(r,o,c){this.type=po,this.locale=c,this.caseSensitive=r,this.diacriticSensitive=o}static parse(r,o){if(r.length!==2)return o.error("Expected one argument.");const c=r[1];if(typeof c!="object"||Array.isArray(c))return o.error("Collator options argument must be an object.");const p=o.parse(c["case-sensitive"]!==void 0&&c["case-sensitive"],1,_t);if(!p)return null;const _=o.parse(c["diacritic-sensitive"]!==void 0&&c["diacritic-sensitive"],1,_t);if(!_)return null;let v=null;return c.locale&&(v=o.parse(c.locale,1,Mt),!v)?null:new ol(p,_,v)}evaluate(r){return new Vu(this.caseSensitive.evaluate(r),this.diacriticSensitive.evaluate(r),this.locale?this.locale.evaluate(r):null)}eachChild(r){r(this.caseSensitive),r(this.diacriticSensitive),this.locale&&r(this.locale)}outputDefined(){return!1}}class Ku{constructor(r,o,c,p,_){this.type=Mt,this.number=r,this.locale=o,this.currency=c,this.minFractionDigits=p,this.maxFractionDigits=_}static parse(r,o){if(r.length!==3)return o.error("Expected two arguments.");const c=o.parse(r[1],1,Ve);if(!c)return null;const p=r[2];if(typeof p!="object"||Array.isArray(p))return o.error("NumberFormat options argument must be an object.");let _=null;if(p.locale&&(_=o.parse(p.locale,1,Mt),!_))return null;let v=null;if(p.currency&&(v=o.parse(p.currency,1,Mt),!v))return null;let b=null;if(p["min-fraction-digits"]&&(b=o.parse(p["min-fraction-digits"],1,Ve),!b))return null;let S=null;return p["max-fraction-digits"]&&(S=o.parse(p["max-fraction-digits"],1,Ve),!S)?null:new Ku(c,_,v,b,S)}evaluate(r){return new Intl.NumberFormat(this.locale?this.locale.evaluate(r):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(r):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(r):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(r):void 0}).format(this.number.evaluate(r))}eachChild(r){r(this.number),this.locale&&r(this.locale),this.currency&&r(this.currency),this.minFractionDigits&&r(this.minFractionDigits),this.maxFractionDigits&&r(this.maxFractionDigits)}outputDefined(){return!1}}class ic{constructor(r){this.type=$o,this.sections=r}static parse(r,o){if(r.length<2)return o.error("Expected at least one argument.");const c=r[1];if(!Array.isArray(c)&&typeof c=="object")return o.error("First argument must be an image or text section.");const p=[];let _=!1;for(let v=1;v<=r.length-1;++v){const b=r[v];if(_&&typeof b=="object"&&!Array.isArray(b)){_=!1;let S=null;if(b["font-scale"]&&(S=o.parse(b["font-scale"],1,Ve),!S))return null;let k=null;if(b["text-font"]&&(k=o.parse(b["text-font"],1,B(Mt)),!k))return null;let E=null;if(b["text-color"]&&(E=o.parse(b["text-color"],1,Gr),!E))return null;const A=p[p.length-1];A.scale=S,A.font=k,A.textColor=E}else{const S=o.parse(r[v],1,kt);if(!S)return null;const k=S.type.kind;if(k!=="string"&&k!=="value"&&k!=="null"&&k!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,p.push({content:S,scale:null,font:null,textColor:null})}}return new ic(p)}evaluate(r){return new li(this.sections.map(o=>{const c=o.content.evaluate(r);return Zn(c)===fo?new Gu("",c,null,null,null):new Gu(nl(c),null,o.scale?o.scale.evaluate(r):null,o.font?o.font.evaluate(r).join(","):null,o.textColor?o.textColor.evaluate(r):null)}))}eachChild(r){for(const o of this.sections)r(o.content),o.scale&&r(o.scale),o.font&&r(o.font),o.textColor&&r(o.textColor)}outputDefined(){return!1}}class Xu{constructor(r){this.type=fo,this.input=r}static parse(r,o){if(r.length!==2)return o.error("Expected two arguments.");const c=o.parse(r[1],1,Mt);return c?new Xu(c):o.error("No image name provided.")}evaluate(r){const o=this.input.evaluate(r),c=ui.fromString(o);return c&&r.availableImages&&(c.available=r.availableImages.indexOf(o)>-1),c}eachChild(r){r(this.input)}outputDefined(){return!1}}class Yu{constructor(r){this.type=Ve,this.input=r}static parse(r,o){if(r.length!==2)return o.error(`Expected 1 argument, but found ${r.length-1} instead.`);const c=o.parse(r[1],1);return c?c.type.kind!=="array"&&c.type.kind!=="string"&&c.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${F(c.type)} instead.`):new Yu(c):null}evaluate(r){const o=this.input.evaluate(r);if(typeof o=="string")return[...o].length;if(Array.isArray(o))return o.length;throw new jn(`Expected value to be of type string or array, but found ${F(Zn(o))} instead.`)}eachChild(r){r(this.input)}outputDefined(){return!1}}const mo=8192;function qg(i,r){const o=(180+i[0])/360,c=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,p=Math.pow(2,r.z);return[Math.round(o*p*mo),Math.round(c*p*mo)]}function Ju(i,r){const o=Math.pow(2,r.z);return[(p=(i[0]/mo+r.x)/o,360*p-180),(c=(i[1]/mo+r.y)/o,360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90)];var c,p}function Is(i,r){i[0]=Math.min(i[0],r[0]),i[1]=Math.min(i[1],r[1]),i[2]=Math.max(i[2],r[0]),i[3]=Math.max(i[3],r[1])}function is(i,r){return!(i[0]<=r[0]||i[2]>=r[2]||i[1]<=r[1]||i[3]>=r[3])}function Kt(i,r,o){const c=i[0]-r[0],p=i[1]-r[1],_=i[0]-o[0],v=i[1]-o[1];return c*v-_*p==0&&c*_<=0&&p*v<=0}function oc(i,r,o,c){return(p=[c[0]-o[0],c[1]-o[1]])[0]*(_=[r[0]-i[0],r[1]-i[1]])[1]-p[1]*_[0]!=0&&!(!mp(i,r,o,c)||!mp(o,c,i,r));var p,_}function Hg(i,r,o){for(const c of o)for(let p=0;p<c.length-1;++p)if(oc(i,r,c[p],c[p+1]))return!0;return!1}function sa(i,r,o=!1){let c=!1;for(const b of r)for(let S=0;S<b.length-1;S++){if(Kt(i,b[S],b[S+1]))return o;(_=b[S])[1]>(p=i)[1]!=(v=b[S+1])[1]>p[1]&&p[0]<(v[0]-_[0])*(p[1]-_[1])/(v[1]-_[1])+_[0]&&(c=!c)}var p,_,v;return c}function Zg(i,r){for(const o of r)if(sa(i,o))return!0;return!1}function fp(i,r){for(const o of i)if(!sa(o,r))return!1;for(let o=0;o<i.length-1;++o)if(Hg(i[o],i[o+1],r))return!1;return!0}function Wg(i,r){for(const o of r)if(fp(i,o))return!0;return!1}function mp(i,r,o,c){const p=c[0]-o[0],_=c[1]-o[1],v=(i[0]-o[0])*_-p*(i[1]-o[1]),b=(r[0]-o[0])*_-p*(r[1]-o[1]);return v>0&&b<0||v<0&&b>0}function Qu(i,r,o){const c=[];for(let p=0;p<i.length;p++){const _=[];for(let v=0;v<i[p].length;v++){const b=qg(i[p][v],o);Is(r,b),_.push(b)}c.push(_)}return c}function gp(i,r,o){const c=[];for(let p=0;p<i.length;p++){const _=Qu(i[p],r,o);c.push(_)}return c}function yp(i,r,o,c){if(i[0]<o[0]||i[0]>o[2]){const p=.5*c;let _=i[0]-o[0]>p?-c:o[0]-i[0]>p?c:0;_===0&&(_=i[0]-o[2]>p?-c:o[2]-i[0]>p?c:0),i[0]+=_}Is(r,i)}function _p(i,r,o,c){const p=Math.pow(2,c.z)*mo,_=[c.x*mo,c.y*mo],v=[];for(const b of i)for(const S of b){const k=[S.x+_[0],S.y+_[1]];yp(k,r,o,p),v.push(k)}return v}function vp(i,r,o,c){const p=Math.pow(2,c.z)*mo,_=[c.x*mo,c.y*mo],v=[];for(const S of i){const k=[];for(const E of S){const A=[E.x+_[0],E.y+_[1]];Is(r,A),k.push(A)}v.push(k)}if(r[2]-r[0]<=p/2){(b=r)[0]=b[1]=1/0,b[2]=b[3]=-1/0;for(const S of v)for(const k of S)yp(k,r,o,p)}var b;return v}class Ps{constructor(r,o){this.type=_t,this.geojson=r,this.geometries=o}static parse(r,o){if(r.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${r.length-1} instead.`);if(Cs(r[1])){const c=r[1];if(c.type==="FeatureCollection"){const p=[];for(const _ of c.features){const{type:v,coordinates:b}=_.geometry;v==="Polygon"&&p.push(b),v==="MultiPolygon"&&p.push(...b)}if(p.length)return new Ps(c,{type:"MultiPolygon",coordinates:p})}else if(c.type==="Feature"){const p=c.geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new Ps(c,c.geometry)}else if(c.type==="Polygon"||c.type==="MultiPolygon")return new Ps(c,c)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return function(o,c){const p=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],v=o.canonicalID();if(c.type==="Polygon"){const b=Qu(c.coordinates,_,v),S=_p(o.geometry(),p,_,v);if(!is(p,_))return!1;for(const k of S)if(!sa(k,b))return!1}if(c.type==="MultiPolygon"){const b=gp(c.coordinates,_,v),S=_p(o.geometry(),p,_,v);if(!is(p,_))return!1;for(const k of S)if(!Zg(k,b))return!1}return!0}(r,this.geometries);if(r.geometryType()==="LineString")return function(o,c){const p=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],v=o.canonicalID();if(c.type==="Polygon"){const b=Qu(c.coordinates,_,v),S=vp(o.geometry(),p,_,v);if(!is(p,_))return!1;for(const k of S)if(!fp(k,b))return!1}if(c.type==="MultiPolygon"){const b=gp(c.coordinates,_,v),S=vp(o.geometry(),p,_,v);if(!is(p,_))return!1;for(const k of S)if(!Wg(k,b))return!1}return!0}(r,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let xp=class{constructor(i=[],r=(o,c)=>o<c?-1:o>c?1:0){if(this.data=i,this.length=this.data.length,this.compare=r,this.length>0)for(let o=(this.length>>1)-1;o>=0;o--)this._down(o)}push(i){this.data.push(i),this._up(this.length++)}pop(){if(this.length===0)return;const i=this.data[0],r=this.data.pop();return--this.length>0&&(this.data[0]=r,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:r,compare:o}=this,c=r[i];for(;i>0;){const p=i-1>>1,_=r[p];if(o(c,_)>=0)break;r[i]=_,i=p}r[i]=c}_down(i){const{data:r,compare:o}=this,c=this.length>>1,p=r[i];for(;i<c;){let _=1+(i<<1);const v=_+1;if(v<this.length&&o(r[v],r[_])<0&&(_=v),o(r[_],p)>=0)break;r[i]=r[_],i=_}r[i]=p}};function Kg(i,r,o,c,p){bp(i,r,o,c||i.length-1,p||Xg)}function bp(i,r,o,c,p){for(;c>o;){if(c-o>600){var _=c-o+1,v=r-o+1,b=Math.log(_),S=.5*Math.exp(2*b/3),k=.5*Math.sqrt(b*S*(_-S)/_)*(v-_/2<0?-1:1);bp(i,r,Math.max(o,Math.floor(r-v*S/_+k)),Math.min(c,Math.floor(r+(_-v)*S/_+k)),p)}var E=i[r],A=o,R=c;for(sl(i,o,r),p(i[c],E)>0&&sl(i,o,c);A<R;){for(sl(i,A,R),A++,R--;p(i[A],E)<0;)A++;for(;p(i[R],E)>0;)R--}p(i[o],E)===0?sl(i,o,R):sl(i,++R,c),R<=r&&(o=R+1),r<=R&&(c=R-1)}}function sl(i,r,o){var c=i[r];i[r]=i[o],i[o]=c}function Xg(i,r){return i<r?-1:i>r?1:0}function sc(i,r){if(i.length<=1)return[i];const o=[];let c,p;for(const _ of i){const v=Jg(_);v!==0&&(_.area=Math.abs(v),p===void 0&&(p=v<0),p===v<0?(c&&o.push(c),c=[_]):c.push(_))}if(c&&o.push(c),r>1)for(let _=0;_<o.length;_++)o[_].length<=r||(Kg(o[_],r,1,o[_].length-1,Yg),o[_]=o[_].slice(0,r));return o}function Yg(i,r){return r.area-i.area}function Jg(i){let r=0;for(let o,c,p=0,_=i.length,v=_-1;p<_;v=p++)o=i[p],c=i[v],r+=(c.x-o.x)*(o.y+c.y);return r}const wp=1/298.257223563,Sp=wp*(2-wp),Tp=Math.PI/180;class eh{constructor(r){const o=6378.137*Tp*1e3,c=Math.cos(r*Tp),p=1/(1-Sp*(1-c*c)),_=Math.sqrt(p);this.kx=o*_*c,this.ky=o*_*p*(1-Sp)}distance(r,o){const c=this.wrap(r[0]-o[0])*this.kx,p=(r[1]-o[1])*this.ky;return Math.sqrt(c*c+p*p)}pointOnLine(r,o){let c,p,_,v,b=1/0;for(let S=0;S<r.length-1;S++){let k=r[S][0],E=r[S][1],A=this.wrap(r[S+1][0]-k)*this.kx,R=(r[S+1][1]-E)*this.ky,O=0;A===0&&R===0||(O=(this.wrap(o[0]-k)*this.kx*A+(o[1]-E)*this.ky*R)/(A*A+R*R),O>1?(k=r[S+1][0],E=r[S+1][1]):O>0&&(k+=A/this.kx*O,E+=R/this.ky*O)),A=this.wrap(o[0]-k)*this.kx,R=(o[1]-E)*this.ky;const j=A*A+R*R;j<b&&(b=j,c=k,p=E,_=S,v=O)}return{point:[c,p],index:_,t:Math.max(0,Math.min(1,v))}}wrap(r){for(;r<-180;)r+=360;for(;r>180;)r-=360;return r}}function Cp(i,r){return r[0]-i[0]}function ac(i){return i[1]-i[0]+1}function jo(i,r){return i[1]>=i[0]&&i[1]<r}function th(i,r){if(i[0]>i[1])return[null,null];const o=ac(i);if(r){if(o===2)return[i,null];const p=Math.floor(o/2);return[[i[0],i[0]+p],[i[0]+p,i[1]]]}if(o===1)return[i,null];const c=Math.floor(o/2)-1;return[[i[0],i[0]+c],[i[0]+c+1,i[1]]]}function nh(i,r){if(!jo(r,i.length))return[1/0,1/0,-1/0,-1/0];const o=[1/0,1/0,-1/0,-1/0];for(let c=r[0];c<=r[1];++c)Is(o,i[c]);return o}function rh(i){const r=[1/0,1/0,-1/0,-1/0];for(const o of i)for(const c of o)Is(r,c);return r}function lc(i){return i[0]!==-1/0&&i[1]!==-1/0&&i[2]!==1/0&&i[3]!==1/0}function ih(i,r,o){if(!lc(i)||!lc(r))return NaN;let c=0,p=0;return i[2]<r[0]&&(c=r[0]-i[2]),i[0]>r[2]&&(c=i[0]-r[2]),i[1]>r[3]&&(p=i[1]-r[3]),i[3]<r[1]&&(p=r[1]-i[3]),o.distance([0,0],[c,p])}function As(i,r,o){const c=o.pointOnLine(r,i);return o.distance(i,c.point)}function oh(i,r,o,c,p){const _=Math.min(As(i,[o,c],p),As(r,[o,c],p)),v=Math.min(As(o,[i,r],p),As(c,[i,r],p));return Math.min(_,v)}function Qg(i,r,o,c,p){if(!jo(r,i.length)||!jo(c,o.length))return 1/0;let _=1/0;for(let v=r[0];v<r[1];++v){const b=i[v],S=i[v+1];for(let k=c[0];k<c[1];++k){const E=o[k],A=o[k+1];if(oc(b,S,E,A))return 0;_=Math.min(_,oh(b,S,E,A,p))}}return _}function Dn(i,r,o,c,p){if(!jo(r,i.length)||!jo(c,o.length))return NaN;let _=1/0;for(let v=r[0];v<=r[1];++v)for(let b=c[0];b<=c[1];++b)if(_=Math.min(_,p.distance(i[v],o[b])),_===0)return _;return _}function ey(i,r,o){if(sa(i,r,!0))return 0;let c=1/0;for(const p of r){const _=p[0],v=p[p.length-1];if(_!==v&&(c=Math.min(c,As(i,[v,_],o)),c===0))return c;const b=o.pointOnLine(p,i);if(c=Math.min(c,o.distance(i,b.point)),c===0)return c}return c}function Rt(i,r,o,c){if(!jo(r,i.length))return NaN;for(let _=r[0];_<=r[1];++_)if(sa(i[_],o,!0))return 0;let p=1/0;for(let _=r[0];_<r[1];++_){const v=i[_],b=i[_+1];for(const S of o)for(let k=0,E=S.length,A=E-1;k<E;A=k++){const R=S[A],O=S[k];if(oc(v,b,R,O))return 0;p=Math.min(p,oh(v,b,R,O,c))}}return p}function cc(i,r){for(const o of i)for(const c of o)if(sa(c,r,!0))return!0;return!1}function pn(i,r,o,c=1/0){const p=rh(i),_=rh(r);if(c!==1/0&&ih(p,_,o)>=c)return c;if(is(p,_)){if(cc(i,r))return 0}else if(cc(r,i))return 0;let v=1/0;for(const b of i)for(let S=0,k=b.length,E=k-1;S<k;E=S++){const A=b[E],R=b[S];for(const O of r)for(let j=0,V=O.length,Y=V-1;j<V;Y=j++){const re=O[Y],ye=O[j];if(oc(A,R,re,ye))return 0;v=Math.min(v,oh(A,R,re,ye,o))}}return v}function nn(i,r,o,c,p,_){if(!_)return;const v=ih(nh(c,_),p,o);v<r&&i.push([v,_,[0,0]])}function Ms(i,r,o,c,p,_,v){if(!_||!v)return;const b=ih(nh(c,_),nh(p,v),o);b<r&&i.push([b,_,v])}function al(i,r,o,c,p=1/0){let _=Math.min(c.distance(i[0],o[0][0]),p);if(_===0)return _;const v=new xp([[0,[0,i.length-1],[0,0]]],Cp),b=rh(o);for(;v.length>0;){const S=v.pop();if(S[0]>=_)continue;const k=S[1],E=r?50:100;if(ac(k)<=E){if(!jo(k,i.length))return NaN;if(r){const A=Rt(i,k,o,c);if(isNaN(A)||A===0)return A;_=Math.min(_,A)}else for(let A=k[0];A<=k[1];++A){const R=ey(i[A],o,c);if(_=Math.min(_,R),_===0)return 0}}else{const A=th(k,r);nn(v,_,c,i,b,A[0]),nn(v,_,c,i,b,A[1])}}return _}function ll(i,r,o,c,p,_=1/0){let v=Math.min(_,p.distance(i[0],o[0]));if(v===0)return v;const b=new xp([[0,[0,i.length-1],[0,o.length-1]]],Cp);for(;b.length>0;){const S=b.pop();if(S[0]>=v)continue;const k=S[1],E=S[2],A=r?50:100,R=c?50:100;if(ac(k)<=A&&ac(E)<=R){if(!jo(k,i.length)&&jo(E,o.length))return NaN;let O;if(r&&c)O=Qg(i,k,o,E,p),v=Math.min(v,O);else if(r&&!c){const j=i.slice(k[0],k[1]+1);for(let V=E[0];V<=E[1];++V)if(O=As(o[V],j,p),v=Math.min(v,O),v===0)return v}else if(!r&&c){const j=o.slice(E[0],E[1]+1);for(let V=k[0];V<=k[1];++V)if(O=As(i[V],j,p),v=Math.min(v,O),v===0)return v}else O=Dn(i,k,o,E,p),v=Math.min(v,O)}else{const O=th(k,r),j=th(E,c);Ms(b,v,p,i,o,O[0],j[0]),Ms(b,v,p,i,o,O[0],j[1]),Ms(b,v,p,i,o,O[1],j[0]),Ms(b,v,p,i,o,O[1],j[1])}}return v}function sh(i){return i.type==="MultiPolygon"?i.coordinates.map(r=>({type:"Polygon",coordinates:r})):i.type==="MultiLineString"?i.coordinates.map(r=>({type:"LineString",coordinates:r})):i.type==="MultiPoint"?i.coordinates.map(r=>({type:"Point",coordinates:r})):[i]}class zs{constructor(r,o){this.type=Ve,this.geojson=r,this.geometries=o}static parse(r,o){if(r.length!==2)return o.error(`'distance' expression requires exactly one argument, but found ${r.length-1} instead.`);if(Cs(r[1])){const c=r[1];if(c.type==="FeatureCollection")return new zs(c,c.features.map(p=>sh(p.geometry)).flat());if(c.type==="Feature")return new zs(c,sh(c.geometry));if("type"in c&&"coordinates"in c)return new zs(c,sh(c))}return o.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return function(o,c){const p=o.geometry(),_=p.flat().map(S=>Ju([S.x,S.y],o.canonical));if(p.length===0)return NaN;const v=new eh(_[0][1]);let b=1/0;for(const S of c){switch(S.type){case"Point":b=Math.min(b,ll(_,!1,[S.coordinates],!1,v,b));break;case"LineString":b=Math.min(b,ll(_,!1,S.coordinates,!0,v,b));break;case"Polygon":b=Math.min(b,al(_,!1,S.coordinates,v,b))}if(b===0)return b}return b}(r,this.geometries);if(r.geometryType()==="LineString")return function(o,c){const p=o.geometry(),_=p.flat().map(S=>Ju([S.x,S.y],o.canonical));if(p.length===0)return NaN;const v=new eh(_[0][1]);let b=1/0;for(const S of c){switch(S.type){case"Point":b=Math.min(b,ll(_,!0,[S.coordinates],!1,v,b));break;case"LineString":b=Math.min(b,ll(_,!0,S.coordinates,!0,v,b));break;case"Polygon":b=Math.min(b,al(_,!0,S.coordinates,v,b))}if(b===0)return b}return b}(r,this.geometries);if(r.geometryType()==="Polygon")return function(o,c){const p=o.geometry();if(p.length===0||p[0].length===0)return NaN;const _=sc(p,0).map(S=>S.map(k=>k.map(E=>Ju([E.x,E.y],o.canonical)))),v=new eh(_[0][0][0][1]);let b=1/0;for(const S of c)for(const k of _){switch(S.type){case"Point":b=Math.min(b,al([S.coordinates],!1,k,v,b));break;case"LineString":b=Math.min(b,al(S.coordinates,!0,k,v,b));break;case"Polygon":b=Math.min(b,pn(k,S.coordinates,v,b))}if(b===0)return b}return b}(r,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const aa={"==":Ug,"!=":hp,">":Vg,"<":dp,">=":pp,"<=":Gg,array:Vi,at:Hu,boolean:Vi,case:Ql,coalesce:nc,collator:ol,format:ic,image:Xu,in:Zu,"index-of":ra,interpolate:Hr,"interpolate-hcl":Hr,"interpolate-lab":Hr,length:Yu,let:rs,literal:Ui,match:Wu,number:Vi,"number-format":Ku,object:Vi,slice:rl,step:ia,string:Vi,"to-boolean":Gi,"to-color":Gi,"to-number":Gi,"to-string":Gi,var:Ht,within:Ps,distance:zs};class Ti{constructor(r,o,c,p){this.name=r,this.type=o,this._evaluate=c,this.args=p}evaluate(r){return this._evaluate(r,this.args)}eachChild(r){this.args.forEach(r)}outputDefined(){return!1}static parse(r,o){const c=r[0],p=Ti.definitions[c];if(!p)return o.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0);const _=Array.isArray(p)?p[0]:p.type,v=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,b=v.filter(([k])=>!Array.isArray(k)||k.length===r.length-1);let S=null;for(const[k,E]of b){S=new ks(o.registry,cl,o.path,null,o.scope);const A=[];let R=!1;for(let O=1;O<r.length;O++){const j=r[O],V=Array.isArray(k)?k[O-1]:k.type,Y=S.parse(j,1+A.length,V);if(!Y){R=!0;break}A.push(Y)}if(!R)if(Array.isArray(k)&&k.length!==A.length)S.error(`Expected ${k.length} arguments, but found ${A.length} instead.`);else{for(let O=0;O<A.length;O++){const j=Array.isArray(k)?k[O]:k.type,V=A[O];S.concat(O+1).checkSubtype(j,V.type)}if(S.errors.length===0)return new Ti(c,_,E,A)}}if(b.length===1)o.errors.push(...S.errors);else{const k=(b.length?b:v).map(([A])=>{return R=A,Array.isArray(R)?`(${R.map(F).join(", ")})`:`(${F(R.type)}...)`;var R}).join(" | "),E=[];for(let A=1;A<r.length;A++){const R=o.parse(r[A],1+E.length);if(!R)return null;E.push(F(R.type))}o.error(`Expected arguments of type ${k}, but found (${E.join(", ")}) instead.`)}return null}static register(r,o){Ti.definitions=o;for(const c in o)r[c]=Ti}}function ah(i,[r,o,c,p]){r=r.evaluate(i),o=o.evaluate(i),c=c.evaluate(i);const _=p?p.evaluate(i):1,v=na(r,o,c,_);if(v)throw new jn(v);return new tn(r/255,o/255,c/255,_,!1)}function lh(i,r){return i in r}function ch(i,r){const o=r[i];return o===void 0?null:o}function Ls(i){return{type:i}}function cl(i){if(i instanceof Ht)return cl(i.boundExpression);if(i instanceof Ti&&i.name==="error"||i instanceof ol||i instanceof Ps||i instanceof zs)return!1;const r=i instanceof Gi||i instanceof Vi;let o=!0;return i.eachChild(c=>{o=r?o&&cl(c):o&&c instanceof Ui}),!!o&&ul(i)&&hl(i,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function ul(i){if(i instanceof Ti&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof Ps||i instanceof zs)return!1;let r=!0;return i.eachChild(o=>{r&&!ul(o)&&(r=!1)}),r}function la(i){if(i instanceof Ti&&i.name==="feature-state")return!1;let r=!0;return i.eachChild(o=>{r&&!la(o)&&(r=!1)}),r}function hl(i,r){if(i instanceof Ti&&r.indexOf(i.name)>=0)return!1;let o=!0;return i.eachChild(c=>{o&&!hl(c,r)&&(o=!1)}),o}function uc(i){return{result:"success",value:i}}function ca(i){return{result:"error",value:i}}function ua(i){return i["property-type"]==="data-driven"||i["property-type"]==="cross-faded-data-driven"}function kp(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function uh(i){return!!i.expression&&i.expression.interpolated}function Gt(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function hc(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function ty(i){return i}function Ep(i,r){const o=r.type==="color",c=i.stops&&typeof i.stops[0][0]=="object",p=c||!(c||i.property!==void 0),_=i.type||(uh(r)?"exponential":"interval");if(o||r.type==="padding"){const E=o?tn.parse:ci.parse;(i=wt({},i)).stops&&(i.stops=i.stops.map(A=>[A[0],E(A[1])])),i.default=E(i.default?i.default:r.default)}if(i.colorSpace&&(v=i.colorSpace)!=="rgb"&&v!=="hcl"&&v!=="lab")throw new Error(`Unknown color space: "${i.colorSpace}"`);var v;let b,S,k;if(_==="exponential")b=Pp;else if(_==="interval")b=dc;else if(_==="categorical"){b=Ip,S=Object.create(null);for(const E of i.stops)S[E[0]]=E[1];k=typeof i.stops[0][0]}else{if(_!=="identity")throw new Error(`Unknown function type "${_}"`);b=Ap}if(c){const E={},A=[];for(let j=0;j<i.stops.length;j++){const V=i.stops[j],Y=V[0].zoom;E[Y]===void 0&&(E[Y]={zoom:Y,type:i.type,property:i.property,default:i.default,stops:[]},A.push(Y)),E[Y].stops.push([V[0].value,V[1]])}const R=[];for(const j of A)R.push([E[j].zoom,Ep(E[j],r)]);const O={name:"linear"};return{kind:"composite",interpolationType:O,interpolationFactor:Hr.interpolationFactor.bind(void 0,O),zoomStops:R.map(j=>j[0]),evaluate:({zoom:j},V)=>Pp({stops:R,base:i.base},r,j).evaluate(j,V)}}if(p){const E=_==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:E,interpolationFactor:Hr.interpolationFactor.bind(void 0,E),zoomStops:i.stops.map(A=>A[0]),evaluate:({zoom:A})=>b(i,r,A,S,k)}}return{kind:"source",evaluate(E,A){const R=A&&A.properties?A.properties[i.property]:void 0;return R===void 0?ha(i.default,r.default):b(i,r,R,S,k)}}}function ha(i,r,o){return i!==void 0?i:r!==void 0?r:o!==void 0?o:void 0}function Ip(i,r,o,c,p){return ha(typeof o===p?c[o]:void 0,i.default,r.default)}function dc(i,r,o){if(Gt(o)!=="number")return ha(i.default,r.default);const c=i.stops.length;if(c===1||o<=i.stops[0][0])return i.stops[0][1];if(o>=i.stops[c-1][0])return i.stops[c-1][1];const p=ec(i.stops.map(_=>_[0]),o);return i.stops[p][1]}function Pp(i,r,o){const c=i.base!==void 0?i.base:1;if(Gt(o)!=="number")return ha(i.default,r.default);const p=i.stops.length;if(p===1||o<=i.stops[0][0])return i.stops[0][1];if(o>=i.stops[p-1][0])return i.stops[p-1][1];const _=ec(i.stops.map(E=>E[0]),o),v=function(E,A,R,O){const j=O-R,V=E-R;return j===0?0:A===1?V/j:(Math.pow(A,V)-1)/(Math.pow(A,j)-1)}(o,c,i.stops[_][0],i.stops[_+1][0]),b=i.stops[_][1],S=i.stops[_+1][1],k=qr[r.type]||ty;return typeof b.evaluate=="function"?{evaluate(...E){const A=b.evaluate.apply(void 0,E),R=S.evaluate.apply(void 0,E);if(A!==void 0&&R!==void 0)return k(A,R,v,i.colorSpace)}}:k(b,S,v,i.colorSpace)}function Ap(i,r,o){switch(r.type){case"color":o=tn.parse(o);break;case"formatted":o=li.fromString(o.toString());break;case"resolvedImage":o=ui.fromString(o.toString());break;case"padding":o=ci.parse(o);break;default:Gt(o)===r.type||r.type==="enum"&&r.values[o]||(o=void 0)}return ha(o,i.default,r.default)}Ti.register(aa,{error:[{kind:"error"},[Mt],(i,[r])=>{throw new jn(r.evaluate(i))}],typeof:[Mt,[kt],(i,[r])=>F(Zn(r.evaluate(i)))],"to-rgba":[B(Ve,4),[Gr],(i,[r])=>{const[o,c,p,_]=r.evaluate(i).rgb;return[255*o,255*c,255*p,_]}],rgb:[Gr,[Ve,Ve,Ve],ah],rgba:[Gr,[Ve,Ve,Ve,Ve],ah],has:{type:_t,overloads:[[[Mt],(i,[r])=>lh(r.evaluate(i),i.properties())],[[Mt,ji],(i,[r,o])=>lh(r.evaluate(i),o.evaluate(i))]]},get:{type:kt,overloads:[[[Mt],(i,[r])=>ch(r.evaluate(i),i.properties())],[[Mt,ji],(i,[r,o])=>ch(r.evaluate(i),o.evaluate(i))]]},"feature-state":[kt,[Mt],(i,[r])=>ch(r.evaluate(i),i.featureState||{})],properties:[ji,[],i=>i.properties()],"geometry-type":[Mt,[],i=>i.geometryType()],id:[kt,[],i=>i.id()],zoom:[Ve,[],i=>i.globals.zoom],"heatmap-density":[Ve,[],i=>i.globals.heatmapDensity||0],"line-progress":[Ve,[],i=>i.globals.lineProgress||0],accumulated:[kt,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[Ve,Ls(Ve),(i,r)=>{let o=0;for(const c of r)o+=c.evaluate(i);return o}],"*":[Ve,Ls(Ve),(i,r)=>{let o=1;for(const c of r)o*=c.evaluate(i);return o}],"-":{type:Ve,overloads:[[[Ve,Ve],(i,[r,o])=>r.evaluate(i)-o.evaluate(i)],[[Ve],(i,[r])=>-r.evaluate(i)]]},"/":[Ve,[Ve,Ve],(i,[r,o])=>r.evaluate(i)/o.evaluate(i)],"%":[Ve,[Ve,Ve],(i,[r,o])=>r.evaluate(i)%o.evaluate(i)],ln2:[Ve,[],()=>Math.LN2],pi:[Ve,[],()=>Math.PI],e:[Ve,[],()=>Math.E],"^":[Ve,[Ve,Ve],(i,[r,o])=>Math.pow(r.evaluate(i),o.evaluate(i))],sqrt:[Ve,[Ve],(i,[r])=>Math.sqrt(r.evaluate(i))],log10:[Ve,[Ve],(i,[r])=>Math.log(r.evaluate(i))/Math.LN10],ln:[Ve,[Ve],(i,[r])=>Math.log(r.evaluate(i))],log2:[Ve,[Ve],(i,[r])=>Math.log(r.evaluate(i))/Math.LN2],sin:[Ve,[Ve],(i,[r])=>Math.sin(r.evaluate(i))],cos:[Ve,[Ve],(i,[r])=>Math.cos(r.evaluate(i))],tan:[Ve,[Ve],(i,[r])=>Math.tan(r.evaluate(i))],asin:[Ve,[Ve],(i,[r])=>Math.asin(r.evaluate(i))],acos:[Ve,[Ve],(i,[r])=>Math.acos(r.evaluate(i))],atan:[Ve,[Ve],(i,[r])=>Math.atan(r.evaluate(i))],min:[Ve,Ls(Ve),(i,r)=>Math.min(...r.map(o=>o.evaluate(i)))],max:[Ve,Ls(Ve),(i,r)=>Math.max(...r.map(o=>o.evaluate(i)))],abs:[Ve,[Ve],(i,[r])=>Math.abs(r.evaluate(i))],round:[Ve,[Ve],(i,[r])=>{const o=r.evaluate(i);return o<0?-Math.round(-o):Math.round(o)}],floor:[Ve,[Ve],(i,[r])=>Math.floor(r.evaluate(i))],ceil:[Ve,[Ve],(i,[r])=>Math.ceil(r.evaluate(i))],"filter-==":[_t,[Mt,kt],(i,[r,o])=>i.properties()[r.value]===o.value],"filter-id-==":[_t,[kt],(i,[r])=>i.id()===r.value],"filter-type-==":[_t,[Mt],(i,[r])=>i.geometryType()===r.value],"filter-<":[_t,[Mt,kt],(i,[r,o])=>{const c=i.properties()[r.value],p=o.value;return typeof c==typeof p&&c<p}],"filter-id-<":[_t,[kt],(i,[r])=>{const o=i.id(),c=r.value;return typeof o==typeof c&&o<c}],"filter->":[_t,[Mt,kt],(i,[r,o])=>{const c=i.properties()[r.value],p=o.value;return typeof c==typeof p&&c>p}],"filter-id->":[_t,[kt],(i,[r])=>{const o=i.id(),c=r.value;return typeof o==typeof c&&o>c}],"filter-<=":[_t,[Mt,kt],(i,[r,o])=>{const c=i.properties()[r.value],p=o.value;return typeof c==typeof p&&c<=p}],"filter-id-<=":[_t,[kt],(i,[r])=>{const o=i.id(),c=r.value;return typeof o==typeof c&&o<=c}],"filter->=":[_t,[Mt,kt],(i,[r,o])=>{const c=i.properties()[r.value],p=o.value;return typeof c==typeof p&&c>=p}],"filter-id->=":[_t,[kt],(i,[r])=>{const o=i.id(),c=r.value;return typeof o==typeof c&&o>=c}],"filter-has":[_t,[kt],(i,[r])=>r.value in i.properties()],"filter-has-id":[_t,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[_t,[B(Mt)],(i,[r])=>r.value.indexOf(i.geometryType())>=0],"filter-id-in":[_t,[B(kt)],(i,[r])=>r.value.indexOf(i.id())>=0],"filter-in-small":[_t,[Mt,B(kt)],(i,[r,o])=>o.value.indexOf(i.properties()[r.value])>=0],"filter-in-large":[_t,[Mt,B(kt)],(i,[r,o])=>function(c,p,_,v){for(;_<=v;){const b=_+v>>1;if(p[b]===c)return!0;p[b]>c?v=b-1:_=b+1}return!1}(i.properties()[r.value],o.value,0,o.value.length-1)],all:{type:_t,overloads:[[[_t,_t],(i,[r,o])=>r.evaluate(i)&&o.evaluate(i)],[Ls(_t),(i,r)=>{for(const o of r)if(!o.evaluate(i))return!1;return!0}]]},any:{type:_t,overloads:[[[_t,_t],(i,[r,o])=>r.evaluate(i)||o.evaluate(i)],[Ls(_t),(i,r)=>{for(const o of r)if(o.evaluate(i))return!0;return!1}]]},"!":[_t,[_t],(i,[r])=>!r.evaluate(i)],"is-supported-script":[_t,[Mt],(i,[r])=>{const o=i.globals&&i.globals.isSupportedScript;return!o||o(r.evaluate(i))}],upcase:[Mt,[Mt],(i,[r])=>r.evaluate(i).toUpperCase()],downcase:[Mt,[Mt],(i,[r])=>r.evaluate(i).toLowerCase()],concat:[Mt,Ls(kt),(i,r)=>r.map(o=>nl(o.evaluate(i))).join("")],"resolved-locale":[Mt,[po],(i,[r])=>r.evaluate(i).resolvedLocale()]});class pc{constructor(r,o){var c;this.expression=r,this._warningHistory={},this._evaluator=new Jl,this._defaultValue=o?(c=o).type==="color"&&hc(c.default)?new tn(0,0,0,0):c.type==="color"?tn.parse(c.default)||null:c.type==="padding"?ci.parse(c.default)||null:c.type==="variableAnchorOffsetCollection"?Si.parse(c.default)||null:c.default===void 0?null:c.default:null,this._enumValues=o&&o.type==="enum"?o.values:null}evaluateWithoutErrorHandling(r,o,c,p,_,v){return this._evaluator.globals=r,this._evaluator.feature=o,this._evaluator.featureState=c,this._evaluator.canonical=p,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=v,this.expression.evaluate(this._evaluator)}evaluate(r,o,c,p,_,v){this._evaluator.globals=r,this._evaluator.feature=o||null,this._evaluator.featureState=c||null,this._evaluator.canonical=p,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=v||null;try{const b=this.expression.evaluate(this._evaluator);if(b==null||typeof b=="number"&&b!=b)return this._defaultValue;if(this._enumValues&&!(b in this._enumValues))throw new jn(`Expected value to be one of ${Object.keys(this._enumValues).map(S=>JSON.stringify(S)).join(", ")}, but found ${JSON.stringify(b)} instead.`);return b}catch(b){return this._warningHistory[b.message]||(this._warningHistory[b.message]=!0,typeof console<"u"&&console.warn(b.message)),this._defaultValue}}}function fc(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in aa}function da(i,r){const o=new ks(aa,cl,[],r?function(p){const _={color:Gr,string:Mt,number:Ve,enum:Mt,boolean:_t,formatted:$o,padding:ns,resolvedImage:fo,variableAnchorOffsetCollection:te};return p.type==="array"?B(_[p.value]||kt,p.length):_[p.type]}(r):void 0),c=o.parse(i,void 0,void 0,void 0,r&&r.type==="string"?{typeAnnotation:"coerce"}:void 0);return c?uc(new pc(c,r)):ca(o.errors)}class pa{constructor(r,o){this.kind=r,this._styleExpression=o,this.isStateDependent=r!=="constant"&&!la(o.expression)}evaluateWithoutErrorHandling(r,o,c,p,_,v){return this._styleExpression.evaluateWithoutErrorHandling(r,o,c,p,_,v)}evaluate(r,o,c,p,_,v){return this._styleExpression.evaluate(r,o,c,p,_,v)}}class fa{constructor(r,o,c,p){this.kind=r,this.zoomStops=c,this._styleExpression=o,this.isStateDependent=r!=="camera"&&!la(o.expression),this.interpolationType=p}evaluateWithoutErrorHandling(r,o,c,p,_,v){return this._styleExpression.evaluateWithoutErrorHandling(r,o,c,p,_,v)}evaluate(r,o,c,p,_,v){return this._styleExpression.evaluate(r,o,c,p,_,v)}interpolationFactor(r,o,c){return this.interpolationType?Hr.interpolationFactor(this.interpolationType,r,o,c):0}}function hh(i,r){const o=da(i,r);if(o.result==="error")return o;const c=o.value.expression,p=ul(c);if(!p&&!ua(r))return ca([new rr("","data expressions not supported")]);const _=hl(c,["zoom"]);if(!_&&!kp(r))return ca([new rr("","zoom expressions not supported")]);const v=dl(c);return v||_?v instanceof rr?ca([v]):v instanceof Hr&&!uh(r)?ca([new rr("",'"interpolate" expressions cannot be used with this property')]):uc(v?new fa(p?"camera":"composite",o.value,v.labels,v instanceof Hr?v.interpolation:void 0):new pa(p?"constant":"source",o.value)):ca([new rr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class ma{constructor(r,o){this._parameters=r,this._specification=o,wt(this,Ep(this._parameters,this._specification))}static deserialize(r){return new ma(r._parameters,r._specification)}static serialize(r){return{_parameters:r._parameters,_specification:r._specification}}}function dl(i){let r=null;if(i instanceof rs)r=dl(i.result);else if(i instanceof nc){for(const o of i.args)if(r=dl(o),r)break}else(i instanceof ia||i instanceof Hr)&&i.input instanceof Ti&&i.input.name==="zoom"&&(r=i);return r instanceof rr||i.eachChild(o=>{const c=dl(o);c instanceof rr?r=c:!r&&c?r=new rr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&c&&r!==c&&(r=new rr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),r}function mc(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const r of i.slice(1))if(!mc(r)&&typeof r!="boolean")return!1;return!0;default:return!0}}const gc={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function dh(i){if(i==null)return{filter:()=>!0,needGeometry:!1};mc(i)||(i=yc(i));const r=da(i,gc);if(r.result==="error")throw new Error(r.value.map(o=>`${o.key}: ${o.message}`).join(", "));return{filter:(o,c,p)=>r.value.evaluate(o,c,{},p),needGeometry:Mp(i)}}function ny(i,r){return i<r?-1:i>r?1:0}function Mp(i){if(!Array.isArray(i))return!1;if(i[0]==="within"||i[0]==="distance")return!0;for(let r=1;r<i.length;r++)if(Mp(i[r]))return!0;return!1}function yc(i){if(!i)return!0;const r=i[0];return i.length<=1?r!=="any":r==="=="?ph(i[1],i[2],"=="):r==="!="?_r(ph(i[1],i[2],"==")):r==="<"||r===">"||r==="<="||r===">="?ph(i[1],i[2],r):r==="any"?(o=i.slice(1),["any"].concat(o.map(yc))):r==="all"?["all"].concat(i.slice(1).map(yc)):r==="none"?["all"].concat(i.slice(1).map(yc).map(_r)):r==="in"?pl(i[1],i.slice(2)):r==="!in"?_r(pl(i[1],i.slice(2))):r==="has"?fl(i[1]):r!=="!has"||_r(fl(i[1]));var o}function ph(i,r,o){switch(i){case"$type":return[`filter-type-${o}`,r];case"$id":return[`filter-id-${o}`,r];default:return[`filter-${o}`,i,r]}}function pl(i,r){if(r.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",r]];case"$id":return["filter-id-in",["literal",r]];default:return r.length>200&&!r.some(o=>typeof o!=typeof r[0])?["filter-in-large",i,["literal",r.sort(ny)]]:["filter-in-small",i,["literal",r]]}}function fl(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function _r(i){return["!",i]}function Rs(i){const r=typeof i;if(r==="number"||r==="boolean"||r==="string"||i==null)return JSON.stringify(i);if(Array.isArray(i)){let p="[";for(const _ of i)p+=`${Rs(_)},`;return`${p}]`}const o=Object.keys(i).sort();let c="{";for(let p=0;p<o.length;p++)c+=`${JSON.stringify(o[p])}:${Rs(i[o[p]])},`;return`${c}}`}function zp(i){let r="";for(const o of Oo)r+=`/${Rs(i[o])}`;return r}function Lp(i){const r=i.value;return r?[new Fe(i.key,r,"constants have been deprecated as of v8")]:[]}function Fn(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function qi(i){if(Array.isArray(i))return i.map(qi);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const r={};for(const o in i)r[o]=qi(i[o]);return r}return Fn(i)}function hi(i){const r=i.key,o=i.value,c=i.valueSpec||{},p=i.objectElementValidators||{},_=i.style,v=i.styleSpec,b=i.validateSpec;let S=[];const k=Gt(o);if(k!=="object")return[new Fe(r,o,`object expected, ${k} found`)];for(const E in o){const A=E.split(".")[0],R=c[A]||c["*"];let O;if(p[A])O=p[A];else if(c[A])O=b;else if(p["*"])O=p["*"];else{if(!c["*"]){S.push(new Fe(r,o[E],`unknown property "${E}"`));continue}O=b}S=S.concat(O({key:(r&&`${r}.`)+E,value:o[E],valueSpec:R,style:_,styleSpec:v,object:o,objectKey:E,validateSpec:b},o))}for(const E in c)p[E]||c[E].required&&c[E].default===void 0&&o[E]===void 0&&S.push(new Fe(r,o,`missing required property "${E}"`));return S}function ml(i){const r=i.value,o=i.valueSpec,c=i.style,p=i.styleSpec,_=i.key,v=i.arrayElementValidator||i.validateSpec;if(Gt(r)!=="array")return[new Fe(_,r,`array expected, ${Gt(r)} found`)];if(o.length&&r.length!==o.length)return[new Fe(_,r,`array length ${o.length} expected, length ${r.length} found`)];if(o["min-length"]&&r.length<o["min-length"])return[new Fe(_,r,`array length at least ${o["min-length"]} expected, length ${r.length} found`)];let b={type:o.value,values:o.values};p.$version<7&&(b.function=o.function),Gt(o.value)==="object"&&(b=o.value);let S=[];for(let k=0;k<r.length;k++)S=S.concat(v({array:r,arrayIndex:k,value:r[k],valueSpec:b,validateSpec:i.validateSpec,style:c,styleSpec:p,key:`${_}[${k}]`}));return S}function fh(i){const r=i.key,o=i.value,c=i.valueSpec;let p=Gt(o);return p==="number"&&o!=o&&(p="NaN"),p!=="number"?[new Fe(r,o,`number expected, ${p} found`)]:"minimum"in c&&o<c.minimum?[new Fe(r,o,`${o} is less than the minimum value ${c.minimum}`)]:"maximum"in c&&o>c.maximum?[new Fe(r,o,`${o} is greater than the maximum value ${c.maximum}`)]:[]}function _c(i){const r=i.valueSpec,o=Fn(i.value.type);let c,p,_,v={};const b=o!=="categorical"&&i.value.property===void 0,S=!b,k=Gt(i.value.stops)==="array"&&Gt(i.value.stops[0])==="array"&&Gt(i.value.stops[0][0])==="object",E=hi({key:i.key,value:i.value,valueSpec:i.styleSpec.function,validateSpec:i.validateSpec,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(O){if(o==="identity")return[new Fe(O.key,O.value,'identity function may not have a "stops" property')];let j=[];const V=O.value;return j=j.concat(ml({key:O.key,value:V,valueSpec:O.valueSpec,validateSpec:O.validateSpec,style:O.style,styleSpec:O.styleSpec,arrayElementValidator:A})),Gt(V)==="array"&&V.length===0&&j.push(new Fe(O.key,V,"array must have at least one stop")),j},default:function(O){return O.validateSpec({key:O.key,value:O.value,valueSpec:r,validateSpec:O.validateSpec,style:O.style,styleSpec:O.styleSpec})}}});return o==="identity"&&b&&E.push(new Fe(i.key,i.value,'missing required property "property"')),o==="identity"||i.value.stops||E.push(new Fe(i.key,i.value,'missing required property "stops"')),o==="exponential"&&i.valueSpec.expression&&!uh(i.valueSpec)&&E.push(new Fe(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(S&&!ua(i.valueSpec)?E.push(new Fe(i.key,i.value,"property functions not supported")):b&&!kp(i.valueSpec)&&E.push(new Fe(i.key,i.value,"zoom functions not supported"))),o!=="categorical"&&!k||i.value.property!==void 0||E.push(new Fe(i.key,i.value,'"property" property is required')),E;function A(O){let j=[];const V=O.value,Y=O.key;if(Gt(V)!=="array")return[new Fe(Y,V,`array expected, ${Gt(V)} found`)];if(V.length!==2)return[new Fe(Y,V,`array length 2 expected, length ${V.length} found`)];if(k){if(Gt(V[0])!=="object")return[new Fe(Y,V,`object expected, ${Gt(V[0])} found`)];if(V[0].zoom===void 0)return[new Fe(Y,V,"object stop key must have zoom")];if(V[0].value===void 0)return[new Fe(Y,V,"object stop key must have value")];if(_&&_>Fn(V[0].zoom))return[new Fe(Y,V[0].zoom,"stop zoom values must appear in ascending order")];Fn(V[0].zoom)!==_&&(_=Fn(V[0].zoom),p=void 0,v={}),j=j.concat(hi({key:`${Y}[0]`,value:V[0],valueSpec:{zoom:{}},validateSpec:O.validateSpec,style:O.style,styleSpec:O.styleSpec,objectElementValidators:{zoom:fh,value:R}}))}else j=j.concat(R({key:`${Y}[0]`,value:V[0],valueSpec:{},validateSpec:O.validateSpec,style:O.style,styleSpec:O.styleSpec},V));return fc(qi(V[1]))?j.concat([new Fe(`${Y}[1]`,V[1],"expressions are not allowed in function stops.")]):j.concat(O.validateSpec({key:`${Y}[1]`,value:V[1],valueSpec:r,validateSpec:O.validateSpec,style:O.style,styleSpec:O.styleSpec}))}function R(O,j){const V=Gt(O.value),Y=Fn(O.value),re=O.value!==null?O.value:j;if(c){if(V!==c)return[new Fe(O.key,re,`${V} stop domain type must match previous stop domain type ${c}`)]}else c=V;if(V!=="number"&&V!=="string"&&V!=="boolean")return[new Fe(O.key,re,"stop domain value must be a number, string, or boolean")];if(V!=="number"&&o!=="categorical"){let ye=`number expected, ${V} found`;return ua(r)&&o===void 0&&(ye+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Fe(O.key,re,ye)]}return o!=="categorical"||V!=="number"||isFinite(Y)&&Math.floor(Y)===Y?o!=="categorical"&&V==="number"&&p!==void 0&&Y<p?[new Fe(O.key,re,"stop domain values must appear in ascending order")]:(p=Y,o==="categorical"&&Y in v?[new Fe(O.key,re,"stop domain values must be unique")]:(v[Y]=!0,[])):[new Fe(O.key,re,`integer expected, found ${Y}`)]}}function ga(i){const r=(i.expressionContext==="property"?hh:da)(qi(i.value),i.valueSpec);if(r.result==="error")return r.value.map(c=>new Fe(`${i.key}${c.key}`,i.value,c.message));const o=r.value.expression||r.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!o.outputDefined())return[new Fe(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!la(o))return[new Fe(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter"&&!la(o))return[new Fe(i.key,i.value,'"feature-state" data expressions are not supported with filters.')];if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!hl(o,["zoom","feature-state"]))return[new Fe(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!ul(o))return[new Fe(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Uo(i){const r=i.key,o=i.value,c=i.valueSpec,p=[];return Array.isArray(c.values)?c.values.indexOf(Fn(o))===-1&&p.push(new Fe(r,o,`expected one of [${c.values.join(", ")}], ${JSON.stringify(o)} found`)):Object.keys(c.values).indexOf(Fn(o))===-1&&p.push(new Fe(r,o,`expected one of [${Object.keys(c.values).join(", ")}], ${JSON.stringify(o)} found`)),p}function mh(i){return mc(qi(i.value))?ga(wt({},i,{expressionContext:"filter",valueSpec:{value:"boolean"}})):vc(i)}function vc(i){const r=i.value,o=i.key;if(Gt(r)!=="array")return[new Fe(o,r,`array expected, ${Gt(r)} found`)];const c=i.styleSpec;let p,_=[];if(r.length<1)return[new Fe(o,r,"filter array must have at least 1 element")];switch(_=_.concat(Uo({key:`${o}[0]`,value:r[0],valueSpec:c.filter_operator,style:i.style,styleSpec:i.styleSpec})),Fn(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&Fn(r[1])==="$type"&&_.push(new Fe(o,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":r.length!==3&&_.push(new Fe(o,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&(p=Gt(r[1]),p!=="string"&&_.push(new Fe(`${o}[1]`,r[1],`string expected, ${p} found`)));for(let v=2;v<r.length;v++)p=Gt(r[v]),Fn(r[1])==="$type"?_=_.concat(Uo({key:`${o}[${v}]`,value:r[v],valueSpec:c.geometry_type,style:i.style,styleSpec:i.styleSpec})):p!=="string"&&p!=="number"&&p!=="boolean"&&_.push(new Fe(`${o}[${v}]`,r[v],`string, number, or boolean expected, ${p} found`));break;case"any":case"all":case"none":for(let v=1;v<r.length;v++)_=_.concat(vc({key:`${o}[${v}]`,value:r[v],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":p=Gt(r[1]),r.length!==2?_.push(new Fe(o,r,`filter array for "${r[0]}" operator must have 2 elements`)):p!=="string"&&_.push(new Fe(`${o}[1]`,r[1],`string expected, ${p} found`))}return _}function gh(i,r){const o=i.key,c=i.validateSpec,p=i.style,_=i.styleSpec,v=i.value,b=i.objectKey,S=_[`${r}_${i.layerType}`];if(!S)return[];const k=b.match(/^(.*)-transition$/);if(r==="paint"&&k&&S[k[1]]&&S[k[1]].transition)return c({key:o,value:v,valueSpec:_.transition,style:p,styleSpec:_});const E=i.valueSpec||S[b];if(!E)return[new Fe(o,v,`unknown property "${b}"`)];let A;if(Gt(v)==="string"&&ua(E)&&!E.tokens&&(A=/^{([^}]+)}$/.exec(v)))return[new Fe(o,v,`"${b}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(A[1])} }\`.`)];const R=[];return i.layerType==="symbol"&&(b==="text-field"&&p&&!p.glyphs&&R.push(new Fe(o,v,'use of "text-field" requires a style "glyphs" property')),b==="text-font"&&hc(qi(v))&&Fn(v.type)==="identity"&&R.push(new Fe(o,v,'"text-font" does not support identity functions'))),R.concat(c({key:i.key,value:v,valueSpec:E,style:p,styleSpec:_,expressionContext:"property",propertyType:r,propertyKey:b}))}function xc(i){return gh(i,"paint")}function yh(i){return gh(i,"layout")}function _h(i){let r=[];const o=i.value,c=i.key,p=i.style,_=i.styleSpec;o.type||o.ref||r.push(new Fe(c,o,'either "type" or "ref" is required'));let v=Fn(o.type);const b=Fn(o.ref);if(o.id){const S=Fn(o.id);for(let k=0;k<i.arrayIndex;k++){const E=p.layers[k];Fn(E.id)===S&&r.push(new Fe(c,o.id,`duplicate layer id "${o.id}", previously used at line ${E.id.__line__}`))}}if("ref"in o){let S;["type","source","source-layer","filter","layout"].forEach(k=>{k in o&&r.push(new Fe(c,o[k],`"${k}" is prohibited for ref layers`))}),p.layers.forEach(k=>{Fn(k.id)===b&&(S=k)}),S?S.ref?r.push(new Fe(c,o.ref,"ref cannot reference another ref layer")):v=Fn(S.type):r.push(new Fe(c,o.ref,`ref layer "${b}" not found`))}else if(v!=="background")if(o.source){const S=p.sources&&p.sources[o.source],k=S&&Fn(S.type);S?k==="vector"&&v==="raster"?r.push(new Fe(c,o.source,`layer "${o.id}" requires a raster source`)):k!=="raster-dem"&&v==="hillshade"?r.push(new Fe(c,o.source,`layer "${o.id}" requires a raster-dem source`)):k==="raster"&&v!=="raster"?r.push(new Fe(c,o.source,`layer "${o.id}" requires a vector source`)):k!=="vector"||o["source-layer"]?k==="raster-dem"&&v!=="hillshade"?r.push(new Fe(c,o.source,"raster-dem source can only be used with layer type 'hillshade'.")):v!=="line"||!o.paint||!o.paint["line-gradient"]||k==="geojson"&&S.lineMetrics||r.push(new Fe(c,o,`layer "${o.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):r.push(new Fe(c,o,`layer "${o.id}" must specify a "source-layer"`)):r.push(new Fe(c,o.source,`source "${o.source}" not found`))}else r.push(new Fe(c,o,'missing required property "source"'));return r=r.concat(hi({key:c,value:o,valueSpec:_.layer,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,objectElementValidators:{"*":()=>[],type:()=>i.validateSpec({key:`${c}.type`,value:o.type,valueSpec:_.layer.type,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,object:o,objectKey:"type"}),filter:mh,layout:S=>hi({layer:o,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":k=>yh(wt({layerType:v},k))}}),paint:S=>hi({layer:o,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":k=>xc(wt({layerType:v},k))}})}})),r}function Ds(i){const r=i.value,o=i.key,c=Gt(r);return c!=="string"?[new Fe(o,r,`string expected, ${c} found`)]:[]}const bc={promoteId:function({key:i,value:r}){if(Gt(r)==="string")return Ds({key:i,value:r});{const o=[];for(const c in r)o.push(...Ds({key:`${i}.${c}`,value:r[c]}));return o}}};function gl(i){const r=i.value,o=i.key,c=i.styleSpec,p=i.style,_=i.validateSpec;if(!r.type)return[new Fe(o,r,'"type" is required')];const v=Fn(r.type);let b;switch(v){case"vector":case"raster":return b=hi({key:o,value:r,valueSpec:c[`source_${v.replace("-","_")}`],style:i.style,styleSpec:c,objectElementValidators:bc,validateSpec:_}),b;case"raster-dem":return b=function(S){var k;const E=(k=S.sourceName)!==null&&k!==void 0?k:"",A=S.value,R=S.styleSpec,O=R.source_raster_dem,j=S.style;let V=[];const Y=Gt(A);if(A===void 0)return V;if(Y!=="object")return V.push(new Fe("source_raster_dem",A,`object expected, ${Y} found`)),V;const re=Fn(A.encoding)==="custom",ye=["redFactor","greenFactor","blueFactor","baseShift"],ce=S.value.encoding?`"${S.value.encoding}"`:"Default";for(const me in A)!re&&ye.includes(me)?V.push(new Fe(me,A[me],`In "${E}": "${me}" is only valid when "encoding" is set to "custom". ${ce} encoding found`)):O[me]?V=V.concat(S.validateSpec({key:me,value:A[me],valueSpec:O[me],validateSpec:S.validateSpec,style:j,styleSpec:R})):V.push(new Fe(me,A[me],`unknown property "${me}"`));return V}({sourceName:o,value:r,style:i.style,styleSpec:c,validateSpec:_}),b;case"geojson":if(b=hi({key:o,value:r,valueSpec:c.source_geojson,style:p,styleSpec:c,validateSpec:_,objectElementValidators:bc}),r.cluster)for(const S in r.clusterProperties){const[k,E]=r.clusterProperties[S],A=typeof k=="string"?[k,["accumulated"],["get",S]]:k;b.push(...ga({key:`${o}.${S}.map`,value:E,validateSpec:_,expressionContext:"cluster-map"})),b.push(...ga({key:`${o}.${S}.reduce`,value:A,validateSpec:_,expressionContext:"cluster-reduce"}))}return b;case"video":return hi({key:o,value:r,valueSpec:c.source_video,style:p,validateSpec:_,styleSpec:c});case"image":return hi({key:o,value:r,valueSpec:c.source_image,style:p,validateSpec:_,styleSpec:c});case"canvas":return[new Fe(o,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Uo({key:`${o}.type`,value:r.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:p,validateSpec:_,styleSpec:c})}}function vh(i){const r=i.value,o=i.styleSpec,c=o.light,p=i.style;let _=[];const v=Gt(r);if(r===void 0)return _;if(v!=="object")return _=_.concat([new Fe("light",r,`object expected, ${v} found`)]),_;for(const b in r){const S=b.match(/^(.*)-transition$/);_=_.concat(S&&c[S[1]]&&c[S[1]].transition?i.validateSpec({key:b,value:r[b],valueSpec:o.transition,validateSpec:i.validateSpec,style:p,styleSpec:o}):c[b]?i.validateSpec({key:b,value:r[b],valueSpec:c[b],validateSpec:i.validateSpec,style:p,styleSpec:o}):[new Fe(b,r[b],`unknown property "${b}"`)])}return _}function xh(i){const r=i.value,o=i.styleSpec,c=o.sky,p=i.style,_=Gt(r);if(r===void 0)return[];if(_!=="object")return[new Fe("sky",r,`object expected, ${_} found`)];let v=[];for(const b in r)v=v.concat(c[b]?i.validateSpec({key:b,value:r[b],valueSpec:c[b],style:p,styleSpec:o}):[new Fe(b,r[b],`unknown property "${b}"`)]);return v}function bh(i){const r=i.value,o=i.styleSpec,c=o.terrain,p=i.style;let _=[];const v=Gt(r);if(r===void 0)return _;if(v!=="object")return _=_.concat([new Fe("terrain",r,`object expected, ${v} found`)]),_;for(const b in r)_=_.concat(c[b]?i.validateSpec({key:b,value:r[b],valueSpec:c[b],validateSpec:i.validateSpec,style:p,styleSpec:o}):[new Fe(b,r[b],`unknown property "${b}"`)]);return _}function wh(i){let r=[];const o=i.value,c=i.key;if(Array.isArray(o)){const p=[],_=[];for(const v in o)o[v].id&&p.includes(o[v].id)&&r.push(new Fe(c,o,`all the sprites' ids must be unique, but ${o[v].id} is duplicated`)),p.push(o[v].id),o[v].url&&_.includes(o[v].url)&&r.push(new Fe(c,o,`all the sprites' URLs must be unique, but ${o[v].url} is duplicated`)),_.push(o[v].url),r=r.concat(hi({key:`${c}[${v}]`,value:o[v],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:i.validateSpec}));return r}return Ds({key:c,value:o})}const wc={"*":()=>[],array:ml,boolean:function(i){const r=i.value,o=i.key,c=Gt(r);return c!=="boolean"?[new Fe(o,r,`boolean expected, ${c} found`)]:[]},number:fh,color:function(i){const r=i.key,o=i.value,c=Gt(o);return c!=="string"?[new Fe(r,o,`color expected, ${c} found`)]:tn.parse(String(o))?[]:[new Fe(r,o,`color expected, "${o}" found`)]},constants:Lp,enum:Uo,filter:mh,function:_c,layer:_h,object:hi,source:gl,light:vh,sky:xh,terrain:bh,projection:function(i){const r=i.value,o=i.styleSpec,c=o.projection,p=i.style,_=Gt(r);if(r===void 0)return[];if(_!=="object")return[new Fe("projection",r,`object expected, ${_} found`)];let v=[];for(const b in r)v=v.concat(c[b]?i.validateSpec({key:b,value:r[b],valueSpec:c[b],style:p,styleSpec:o}):[new Fe(b,r[b],`unknown property "${b}"`)]);return v},string:Ds,formatted:function(i){return Ds(i).length===0?[]:ga(i)},resolvedImage:function(i){return Ds(i).length===0?[]:ga(i)},padding:function(i){const r=i.key,o=i.value;if(Gt(o)==="array"){if(o.length<1||o.length>4)return[new Fe(r,o,`padding requires 1 to 4 values; ${o.length} values found`)];const c={type:"number"};let p=[];for(let _=0;_<o.length;_++)p=p.concat(i.validateSpec({key:`${r}[${_}]`,value:o[_],validateSpec:i.validateSpec,valueSpec:c}));return p}return fh({key:r,value:o,valueSpec:{}})},variableAnchorOffsetCollection:function(i){const r=i.key,o=i.value,c=Gt(o),p=i.styleSpec;if(c!=="array"||o.length<1||o.length%2!=0)return[new Fe(r,o,"variableAnchorOffsetCollection requires a non-empty array of even length")];let _=[];for(let v=0;v<o.length;v+=2)_=_.concat(Uo({key:`${r}[${v}]`,value:o[v],valueSpec:p.layout_symbol["text-anchor"]})),_=_.concat(ml({key:`${r}[${v+1}]`,value:o[v+1],valueSpec:{length:2,value:"number"},validateSpec:i.validateSpec,style:i.style,styleSpec:p}));return _},sprite:wh};function ya(i){const r=i.value,o=i.valueSpec,c=i.styleSpec;return i.validateSpec=ya,o.expression&&hc(Fn(r))?_c(i):o.expression&&fc(qi(r))?ga(i):o.type&&wc[o.type]?wc[o.type](i):hi(wt({},i,{valueSpec:o.type?c[o.type]:o}))}function Rp(i){const r=i.value,o=i.key,c=Ds(i);return c.length||(r.indexOf("{fontstack}")===-1&&c.push(new Fe(o,r,'"glyphs" url must include a "{fontstack}" token')),r.indexOf("{range}")===-1&&c.push(new Fe(o,r,'"glyphs" url must include a "{range}" token'))),c}function Ci(i,r=Se){let o=[];return o=o.concat(ya({key:"",value:i,valueSpec:r.$root,styleSpec:r,style:i,validateSpec:ya,objectElementValidators:{glyphs:Rp,"*":()=>[]}})),i.constants&&(o=o.concat(Lp({key:"constants",value:i.constants,style:i,styleSpec:r,validateSpec:ya}))),Sh(o)}function go(i){return function(r){return i({...r,validateSpec:ya})}}function Sh(i){return[].concat(i).sort((r,o)=>r.line-o.line)}function Hi(i){return function(...r){return Sh(i.apply(this,r))}}Ci.source=Hi(go(gl)),Ci.sprite=Hi(go(wh)),Ci.glyphs=Hi(go(Rp)),Ci.light=Hi(go(vh)),Ci.sky=Hi(go(xh)),Ci.terrain=Hi(go(bh)),Ci.layer=Hi(go(_h)),Ci.filter=Hi(go(mh)),Ci.paintProperty=Hi(go(xc)),Ci.layoutProperty=Hi(go(yh));const Fs=Ci,ry=Fs.light,iy=Fs.sky,Dp=Fs.paintProperty,Fp=Fs.layoutProperty;function Th(i,r){let o=!1;if(r&&r.length)for(const c of r)i.fire(new zr(new Error(c.message))),o=!0;return o}class _a{constructor(r,o,c){const p=this.cells=[];if(r instanceof ArrayBuffer){this.arrayBuffer=r;const v=new Int32Array(this.arrayBuffer);r=v[0],this.d=(o=v[1])+2*(c=v[2]);for(let S=0;S<this.d*this.d;S++){const k=v[3+S],E=v[3+S+1];p.push(k===E?null:v.subarray(k,E))}const b=v[3+p.length+1];this.keys=v.subarray(v[3+p.length],b),this.bboxes=v.subarray(b),this.insert=this._insertReadonly}else{this.d=o+2*c;for(let v=0;v<this.d*this.d;v++)p.push([]);this.keys=[],this.bboxes=[]}this.n=o,this.extent=r,this.padding=c,this.scale=o/r,this.uid=0;const _=c/o*r;this.min=-_,this.max=r+_}insert(r,o,c,p,_){this._forEachCell(o,c,p,_,this._insertCell,this.uid++,void 0,void 0),this.keys.push(r),this.bboxes.push(o),this.bboxes.push(c),this.bboxes.push(p),this.bboxes.push(_)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(r,o,c,p,_,v){this.cells[_].push(v)}query(r,o,c,p,_){const v=this.min,b=this.max;if(r<=v&&o<=v&&b<=c&&b<=p&&!_)return Array.prototype.slice.call(this.keys);{const S=[];return this._forEachCell(r,o,c,p,this._queryCell,S,{},_),S}}_queryCell(r,o,c,p,_,v,b,S){const k=this.cells[_];if(k!==null){const E=this.keys,A=this.bboxes;for(let R=0;R<k.length;R++){const O=k[R];if(b[O]===void 0){const j=4*O;(S?S(A[j+0],A[j+1],A[j+2],A[j+3]):r<=A[j+2]&&o<=A[j+3]&&c>=A[j+0]&&p>=A[j+1])?(b[O]=!0,v.push(E[O])):b[O]=!1}}}}_forEachCell(r,o,c,p,_,v,b,S){const k=this._convertToCellCoord(r),E=this._convertToCellCoord(o),A=this._convertToCellCoord(c),R=this._convertToCellCoord(p);for(let O=k;O<=A;O++)for(let j=E;j<=R;j++){const V=this.d*j+O;if((!S||S(this._convertFromCellCoord(O),this._convertFromCellCoord(j),this._convertFromCellCoord(O+1),this._convertFromCellCoord(j+1)))&&_.call(this,r,o,c,p,V,v,b,S))return}}_convertFromCellCoord(r){return(r-this.padding)/this.scale}_convertToCellCoord(r){return Math.max(0,Math.min(this.d-1,Math.floor(r*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const r=this.cells,o=3+this.cells.length+1+1;let c=0;for(let v=0;v<this.cells.length;v++)c+=this.cells[v].length;const p=new Int32Array(o+c+this.keys.length+this.bboxes.length);p[0]=this.extent,p[1]=this.n,p[2]=this.padding;let _=o;for(let v=0;v<r.length;v++){const b=r[v];p[3+v]=_,p.set(b,_),_+=b.length}return p[3+r.length]=_,p.set(this.keys,_),_+=this.keys.length,p[3+r.length+1]=_,p.set(this.bboxes,_),_+=this.bboxes.length,p.buffer}static serialize(r,o){const c=r.toArrayBuffer();return o&&o.push(c),{buffer:c}}static deserialize(r){return new _a(r.buffer)}}const ki={};function Qe(i,r,o={}){if(ki[i])throw new Error(`${i} is already registered.`);Object.defineProperty(r,"_classRegistryKey",{value:i,writeable:!1}),ki[i]={klass:r,omit:o.omit||[],shallow:o.shallow||[]}}Qe("Object",Object),Qe("TransferableGridIndex",_a),Qe("Color",tn),Qe("Error",Error),Qe("AJAXError",An),Qe("ResolvedImage",ui),Qe("StylePropertyFunction",ma),Qe("StyleExpression",pc,{omit:["_evaluator"]}),Qe("ZoomDependentExpression",fa),Qe("ZoomConstantExpression",pa),Qe("CompoundExpression",Ti,{omit:["_evaluate"]});for(const i in aa)aa[i]._classRegistryKey||Qe(`Expression_${i}`,aa[i]);function Sc(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function Ch(i){return i.$name||i.constructor._classRegistryKey}function Bp(i){return!function(r){if(r===null||typeof r!="object")return!1;const o=Ch(r);return!(!o||o==="Object")}(i)&&(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob||i instanceof Error||Sc(i)||Tt(i)||ArrayBuffer.isView(i)||i instanceof ImageData)}function va(i,r){if(Bp(i))return(Sc(i)||Tt(i))&&r&&r.push(i),ArrayBuffer.isView(i)&&r&&r.push(i.buffer),i instanceof ImageData&&r&&r.push(i.data.buffer),i;if(Array.isArray(i)){const _=[];for(const v of i)_.push(va(v,r));return _}if(typeof i!="object")throw new Error("can't serialize object of type "+typeof i);const o=Ch(i);if(!o)throw new Error(`can't serialize object of unregistered class ${i.constructor.name}`);if(!ki[o])throw new Error(`${o} is not registered.`);const{klass:c}=ki[o],p=c.serialize?c.serialize(i,r):{};if(c.serialize){if(r&&p===r[r.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const _ in i){if(!i.hasOwnProperty(_)||ki[o].omit.indexOf(_)>=0)continue;const v=i[_];p[_]=ki[o].shallow.indexOf(_)>=0?v:va(v,r)}i instanceof Error&&(p.message=i.message)}if(p.$name)throw new Error("$name property is reserved for worker serialization logic.");return o!=="Object"&&(p.$name=o),p}function xa(i){if(Bp(i))return i;if(Array.isArray(i))return i.map(xa);if(typeof i!="object")throw new Error("can't deserialize object of type "+typeof i);const r=Ch(i)||"Object";if(!ki[r])throw new Error(`can't deserialize unregistered class ${r}`);const{klass:o}=ki[r];if(!o)throw new Error(`can't deserialize unregistered class ${r}`);if(o.deserialize)return o.deserialize(i);const c=Object.create(o.prototype);for(const p of Object.keys(i)){if(p==="$name")continue;const _=i[p];c[p]=ki[r].shallow.indexOf(p)>=0?_:xa(_)}return c}class kh{constructor(){this.first=!0}update(r,o){const c=Math.floor(r);return this.first?(this.first=!1,this.lastIntegerZoom=c,this.lastIntegerZoomTime=0,this.lastZoom=r,this.lastFloorZoom=c,!0):(this.lastFloorZoom>c?(this.lastIntegerZoom=c+1,this.lastIntegerZoomTime=o):this.lastFloorZoom<c&&(this.lastIntegerZoom=c,this.lastIntegerZoomTime=o),r!==this.lastZoom&&(this.lastZoom=r,this.lastFloorZoom=c,!0))}}const Bt={"Latin-1 Supplement":i=>i>=128&&i<=255,"Hangul Jamo":i=>i>=4352&&i<=4607,Khmer:i=>i>=6016&&i<=6143,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Katakana:i=>i>=12448&&i<=12543,Kanbun:i=>i>=12688&&i<=12703,"CJK Strokes":i=>i>=12736&&i<=12783,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"Private Use Area":i=>i>=57344&&i<=63743,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519};function Eh(i){for(const r of i)if(Ph(r.charCodeAt(0)))return!0;return!1}function oy(i){for(const r of i)if(!ba(r.charCodeAt(0)))return!1;return!0}function Ih(i){const r=i.map(o=>{try{return new RegExp(`\\p{sc=${o}}`,"u").source}catch{return null}}).filter(o=>o);return new RegExp(r.join("|"),"u")}const sy=Ih(["Arab","Dupl","Mong","Ougr","Syrc"]);function ba(i){return!sy.test(String.fromCodePoint(i))}const Op=Ih(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Ph(i){return!(i!==746&&i!==747&&(i<4352||!(Bt["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||Bt["CJK Compatibility"](i)||Bt["CJK Strokes"](i)||!(!Bt["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||Bt["Enclosed CJK Letters and Months"](i)||Bt["Ideographic Description Characters"](i)||Bt.Kanbun(i)||Bt.Katakana(i)&&i!==12540||!(!Bt["Halfwidth and Fullwidth Forms"](i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!Bt["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||Bt["Vertical Forms"](i)||Bt["Yijing Hexagram Symbols"](i)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(i))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(i))||Op.test(String.fromCodePoint(i)))))}function Np(i){return!(Ph(i)||function(r){return!!(Bt["Latin-1 Supplement"](r)&&(r===167||r===169||r===174||r===177||r===188||r===189||r===190||r===215||r===247)||Bt["General Punctuation"](r)&&(r===8214||r===8224||r===8225||r===8240||r===8241||r===8251||r===8252||r===8258||r===8263||r===8264||r===8265||r===8273)||Bt["Letterlike Symbols"](r)||Bt["Number Forms"](r)||Bt["Miscellaneous Technical"](r)&&(r>=8960&&r<=8967||r>=8972&&r<=8991||r>=8996&&r<=9e3||r===9003||r>=9085&&r<=9114||r>=9150&&r<=9165||r===9167||r>=9169&&r<=9179||r>=9186&&r<=9215)||Bt["Control Pictures"](r)&&r!==9251||Bt["Optical Character Recognition"](r)||Bt["Enclosed Alphanumerics"](r)||Bt["Geometric Shapes"](r)||Bt["Miscellaneous Symbols"](r)&&!(r>=9754&&r<=9759)||Bt["Miscellaneous Symbols and Arrows"](r)&&(r>=11026&&r<=11055||r>=11088&&r<=11097||r>=11192&&r<=11243)||Bt["CJK Symbols and Punctuation"](r)||Bt.Katakana(r)||Bt["Private Use Area"](r)||Bt["CJK Compatibility Forms"](r)||Bt["Small Form Variants"](r)||Bt["Halfwidth and Fullwidth Forms"](r)||r===8734||r===8756||r===8757||r>=9984&&r<=10087||r>=10102&&r<=10131||r===65532||r===65533)}(i))}const ay=Ih(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Ah(i){return ay.test(String.fromCodePoint(i))}function ly(i,r){return!(!r&&Ah(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||Bt.Khmer(i))}function cy(i){for(const r of i)if(Ah(r.charCodeAt(0)))return!0;return!1}const di=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(i){this.pluginStatus=i.pluginStatus,this.pluginURL=i.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(i){this.applyArabicShaping=i.applyArabicShaping,this.processBidirectionalText=i.processBidirectionalText,this.processStyledBidirectionalText=i.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class vn{constructor(r,o){this.zoom=r,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.zoomHistory=o.zoomHistory,this.transition=o.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new kh,this.transition={})}isSupportedScript(r){return function(o,c){for(const p of o)if(!ly(p.charCodeAt(0),c))return!1;return!0}(r,di.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const r=this.zoom,o=r-Math.floor(r),c=this.crossFadingFactor();return r>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:o+(1-o)*c}:{fromScale:.5,toScale:1,t:1-(1-c)*o}}}class wa{constructor(r,o){this.property=r,this.value=o,this.expression=function(c,p){if(hc(c))return new ma(c,p);if(fc(c)){const _=hh(c,p);if(_.result==="error")throw new Error(_.value.map(v=>`${v.key}: ${v.message}`).join(", "));return _.value}{let _=c;return p.type==="color"&&typeof c=="string"?_=tn.parse(c):p.type!=="padding"||typeof c!="number"&&!Array.isArray(c)?p.type==="variableAnchorOffsetCollection"&&Array.isArray(c)&&(_=Si.parse(c)):_=ci.parse(c),{kind:"constant",evaluate:()=>_}}}(o===void 0?r.specification.default:o,r.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(r,o,c){return this.property.possiblyEvaluate(this,r,o,c)}}class Tc{constructor(r){this.property=r,this.value=new wa(r,void 0)}transitioned(r,o){return new $p(this.property,this.value,o,xe({},r.transition,this.transition),r.now)}untransitioned(){return new $p(this.property,this.value,null,{},0)}}class Cc{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitionablePropertyValues)}getValue(r){return He(this._values[r].value.value)}setValue(r,o){Object.prototype.hasOwnProperty.call(this._values,r)||(this._values[r]=new Tc(this._values[r].property)),this._values[r].value=new wa(this._values[r].property,o===null?void 0:He(o))}getTransition(r){return He(this._values[r].transition)}setTransition(r,o){Object.prototype.hasOwnProperty.call(this._values,r)||(this._values[r]=new Tc(this._values[r].property)),this._values[r].transition=He(o)||void 0}serialize(){const r={};for(const o of Object.keys(this._values)){const c=this.getValue(o);c!==void 0&&(r[o]=c);const p=this.getTransition(o);p!==void 0&&(r[`${o}-transition`]=p)}return r}transitioned(r,o){const c=new yl(this._properties);for(const p of Object.keys(this._values))c._values[p]=this._values[p].transitioned(r,o._values[p]);return c}untransitioned(){const r=new yl(this._properties);for(const o of Object.keys(this._values))r._values[o]=this._values[o].untransitioned();return r}}class $p{constructor(r,o,c,p,_){this.property=r,this.value=o,this.begin=_+p.delay||0,this.end=this.begin+p.duration||0,r.specification.transition&&(p.delay||p.duration)&&(this.prior=c)}possiblyEvaluate(r,o,c){const p=r.now||0,_=this.value.possiblyEvaluate(r,o,c),v=this.prior;if(v){if(p>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(p<this.begin)return v.possiblyEvaluate(r,o,c);{const b=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(r,o,c),_,function(S){if(S<=0)return 0;if(S>=1)return 1;const k=S*S,E=k*S;return 4*(S<.5?E:3*(S-k)+E-.75)}(b))}}return _}}class yl{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitioningPropertyValues)}possiblyEvaluate(r,o,c){const p=new vl(this._properties);for(const _ of Object.keys(this._values))p._values[_]=this._values[_].possiblyEvaluate(r,o,c);return p}hasTransition(){for(const r of Object.keys(this._values))if(this._values[r].prior)return!0;return!1}}class _l{constructor(r){this._properties=r,this._values=Object.create(r.defaultPropertyValues)}hasValue(r){return this._values[r].value!==void 0}getValue(r){return He(this._values[r].value)}setValue(r,o){this._values[r]=new wa(this._values[r].property,o===null?void 0:He(o))}serialize(){const r={};for(const o of Object.keys(this._values)){const c=this.getValue(o);c!==void 0&&(r[o]=c)}return r}possiblyEvaluate(r,o,c){const p=new vl(this._properties);for(const _ of Object.keys(this._values))p._values[_]=this._values[_].possiblyEvaluate(r,o,c);return p}}class yo{constructor(r,o,c){this.property=r,this.value=o,this.parameters=c}isConstant(){return this.value.kind==="constant"}constantOr(r){return this.value.kind==="constant"?this.value.value:r}evaluate(r,o,c,p){return this.property.evaluate(this.value,this.parameters,r,o,c,p)}}class vl{constructor(r){this._properties=r,this._values=Object.create(r.defaultPossiblyEvaluatedValues)}get(r){return this._values[r]}}class rt{constructor(r){this.specification=r}possiblyEvaluate(r,o){if(r.isDataDriven())throw new Error("Value should not be data driven");return r.expression.evaluate(o)}interpolate(r,o,c){const p=qr[this.specification.type];return p?p(r,o,c):r}}class gt{constructor(r,o){this.specification=r,this.overrides=o}possiblyEvaluate(r,o,c,p){return new yo(this,r.expression.kind==="constant"||r.expression.kind==="camera"?{kind:"constant",value:r.expression.evaluate(o,null,{},c,p)}:r.expression,o)}interpolate(r,o,c){if(r.value.kind!=="constant"||o.value.kind!=="constant")return r;if(r.value.value===void 0||o.value.value===void 0)return new yo(this,{kind:"constant",value:void 0},r.parameters);const p=qr[this.specification.type];if(p){const _=p(r.value.value,o.value.value,c);return new yo(this,{kind:"constant",value:_},r.parameters)}return r}evaluate(r,o,c,p,_,v){return r.kind==="constant"?r.value:r.evaluate(o,c,p,_,v)}}class kc extends gt{possiblyEvaluate(r,o,c,p){if(r.value===void 0)return new yo(this,{kind:"constant",value:void 0},o);if(r.expression.kind==="constant"){const _=r.expression.evaluate(o,null,{},c,p),v=r.property.specification.type==="resolvedImage"&&typeof _!="string"?_.name:_,b=this._calculate(v,v,v,o);return new yo(this,{kind:"constant",value:b},o)}if(r.expression.kind==="camera"){const _=this._calculate(r.expression.evaluate({zoom:o.zoom-1}),r.expression.evaluate({zoom:o.zoom}),r.expression.evaluate({zoom:o.zoom+1}),o);return new yo(this,{kind:"constant",value:_},o)}return new yo(this,r.expression,o)}evaluate(r,o,c,p,_,v){if(r.kind==="source"){const b=r.evaluate(o,c,p,_,v);return this._calculate(b,b,b,o)}return r.kind==="composite"?this._calculate(r.evaluate({zoom:Math.floor(o.zoom)-1},c,p),r.evaluate({zoom:Math.floor(o.zoom)},c,p),r.evaluate({zoom:Math.floor(o.zoom)+1},c,p),o):r.value}_calculate(r,o,c,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:r,to:o}:{from:c,to:o}}interpolate(r){return r}}class Ec{constructor(r){this.specification=r}possiblyEvaluate(r,o,c,p){if(r.value!==void 0){if(r.expression.kind==="constant"){const _=r.expression.evaluate(o,null,{},c,p);return this._calculate(_,_,_,o)}return this._calculate(r.expression.evaluate(new vn(Math.floor(o.zoom-1),o)),r.expression.evaluate(new vn(Math.floor(o.zoom),o)),r.expression.evaluate(new vn(Math.floor(o.zoom+1),o)),o)}}_calculate(r,o,c,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:r,to:o}:{from:c,to:o}}interpolate(r){return r}}class Mh{constructor(r){this.specification=r}possiblyEvaluate(r,o,c,p){return!!r.expression.evaluate(o,null,{},c,p)}interpolate(){return!1}}class g{constructor(r){this.properties=r,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const o in r){const c=r[o];c.specification.overridable&&this.overridableProperties.push(o);const p=this.defaultPropertyValues[o]=new wa(c,void 0),_=this.defaultTransitionablePropertyValues[o]=new Tc(c);this.defaultTransitioningPropertyValues[o]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[o]=p.possiblyEvaluate({})}}}Qe("DataDrivenProperty",gt),Qe("DataConstantProperty",rt),Qe("CrossFadedDataDrivenProperty",kc),Qe("CrossFadedProperty",Ec),Qe("ColorRampProperty",Mh);const n="-transition";class a extends es{constructor(r,o){if(super(),this.id=r.id,this.type=r.type,this._featureFilter={filter:()=>!0,needGeometry:!1},r.type!=="custom"&&(this.metadata=r.metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type!=="background"&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),o.layout&&(this._unevaluatedLayout=new _l(o.layout)),o.paint)){this._transitionablePaint=new Cc(o.paint);for(const c in r.paint)this.setPaintProperty(c,r.paint[c],{validate:!1});for(const c in r.layout)this.setLayoutProperty(c,r.layout[c],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new vl(o.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)}setLayoutProperty(r,o,c={}){o!=null&&this._validate(Fp,`layers.${this.id}.layout.${r}`,r,o,c)||(r!=="visibility"?this._unevaluatedLayout.setValue(r,o):this.visibility=o)}getPaintProperty(r){return r.endsWith(n)?this._transitionablePaint.getTransition(r.slice(0,-11)):this._transitionablePaint.getValue(r)}setPaintProperty(r,o,c={}){if(o!=null&&this._validate(Dp,`layers.${this.id}.paint.${r}`,r,o,c))return!1;if(r.endsWith(n))return this._transitionablePaint.setTransition(r.slice(0,-11),o||void 0),!1;{const p=this._transitionablePaint._values[r],_=p.property.specification["property-type"]==="cross-faded-data-driven",v=p.value.isDataDriven(),b=p.value;this._transitionablePaint.setValue(r,o),this._handleSpecialPaintPropertyUpdate(r);const S=this._transitionablePaint._values[r].value;return S.isDataDriven()||v||_||this._handleOverridablePaintPropertyUpdate(r,b,S)}}_handleSpecialPaintPropertyUpdate(r){}_handleOverridablePaintPropertyUpdate(r,o,c){return!1}isHidden(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"}updateTransitions(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(r,o){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,o)}serialize(){const r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),Oe(r,(o,c)=>!(o===void 0||c==="layout"&&!Object.keys(o).length||c==="paint"&&!Object.keys(o).length))}_validate(r,o,c,p,_={}){return(!_||_.validate!==!1)&&Th(this,r.call(Fs,{key:o,layerType:this.type,objectKey:c,value:p,styleSpec:Se,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const r in this.paint._values){const o=this.paint.get(r);if(o instanceof yo&&ua(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}}const h={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class d{constructor(r,o){this._structArray=r,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class m{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(r,o){return r._trim(),o&&(r.isTransferred=!0,o.push(r.arrayBuffer)),{length:r.length,arrayBuffer:r.arrayBuffer}}static deserialize(r){const o=Object.create(this.prototype);return o.arrayBuffer=r.arrayBuffer,o.length=r.length,o.capacity=r.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(r){this.reserve(r),this.length=r}reserve(r){if(r>this.capacity){this.capacity=Math.max(r,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function w(i,r=1){let o=0,c=0;return{members:i.map(p=>{const _=h[p.type].BYTES_PER_ELEMENT,v=o=T(o,Math.max(r,_)),b=p.components||1;return c=Math.max(c,_),o+=_*b,{name:p.name,type:p.type,components:b,offset:v}}),size:T(o,Math.max(c,r)),alignment:r}}function T(i,r){return Math.ceil(i/r)*r}class C extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o){const c=this.length;return this.resize(c+1),this.emplace(c,r,o)}emplace(r,o,c){const p=2*r;return this.int16[p+0]=o,this.int16[p+1]=c,r}}C.prototype.bytesPerElement=4,Qe("StructArrayLayout2i4",C);class I extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,c){const p=this.length;return this.resize(p+1),this.emplace(p,r,o,c)}emplace(r,o,c,p){const _=3*r;return this.int16[_+0]=o,this.int16[_+1]=c,this.int16[_+2]=p,r}}I.prototype.bytesPerElement=6,Qe("StructArrayLayout3i6",I);class M extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,c,p){const _=this.length;return this.resize(_+1),this.emplace(_,r,o,c,p)}emplace(r,o,c,p,_){const v=4*r;return this.int16[v+0]=o,this.int16[v+1]=c,this.int16[v+2]=p,this.int16[v+3]=_,r}}M.prototype.bytesPerElement=8,Qe("StructArrayLayout4i8",M);class z extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,c,p,_,v){const b=this.length;return this.resize(b+1),this.emplace(b,r,o,c,p,_,v)}emplace(r,o,c,p,_,v,b){const S=6*r;return this.int16[S+0]=o,this.int16[S+1]=c,this.int16[S+2]=p,this.int16[S+3]=_,this.int16[S+4]=v,this.int16[S+5]=b,r}}z.prototype.bytesPerElement=12,Qe("StructArrayLayout2i4i12",z);class $ extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,c,p,_,v){const b=this.length;return this.resize(b+1),this.emplace(b,r,o,c,p,_,v)}emplace(r,o,c,p,_,v,b){const S=4*r,k=8*r;return this.int16[S+0]=o,this.int16[S+1]=c,this.uint8[k+4]=p,this.uint8[k+5]=_,this.uint8[k+6]=v,this.uint8[k+7]=b,r}}$.prototype.bytesPerElement=8,Qe("StructArrayLayout2i4ub8",$);class G extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o){const c=this.length;return this.resize(c+1),this.emplace(c,r,o)}emplace(r,o,c){const p=2*r;return this.float32[p+0]=o,this.float32[p+1]=c,r}}G.prototype.bytesPerElement=8,Qe("StructArrayLayout2f8",G);class H extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,o,c,p,_,v,b,S,k,E){const A=this.length;return this.resize(A+1),this.emplace(A,r,o,c,p,_,v,b,S,k,E)}emplace(r,o,c,p,_,v,b,S,k,E,A){const R=10*r;return this.uint16[R+0]=o,this.uint16[R+1]=c,this.uint16[R+2]=p,this.uint16[R+3]=_,this.uint16[R+4]=v,this.uint16[R+5]=b,this.uint16[R+6]=S,this.uint16[R+7]=k,this.uint16[R+8]=E,this.uint16[R+9]=A,r}}H.prototype.bytesPerElement=20,Qe("StructArrayLayout10ui20",H);class Q extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,o,c,p,_,v,b,S,k,E,A,R){const O=this.length;return this.resize(O+1),this.emplace(O,r,o,c,p,_,v,b,S,k,E,A,R)}emplace(r,o,c,p,_,v,b,S,k,E,A,R,O){const j=12*r;return this.int16[j+0]=o,this.int16[j+1]=c,this.int16[j+2]=p,this.int16[j+3]=_,this.uint16[j+4]=v,this.uint16[j+5]=b,this.uint16[j+6]=S,this.uint16[j+7]=k,this.int16[j+8]=E,this.int16[j+9]=A,this.int16[j+10]=R,this.int16[j+11]=O,r}}Q.prototype.bytesPerElement=24,Qe("StructArrayLayout4i4ui4i24",Q);class ie extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,c){const p=this.length;return this.resize(p+1),this.emplace(p,r,o,c)}emplace(r,o,c,p){const _=3*r;return this.float32[_+0]=o,this.float32[_+1]=c,this.float32[_+2]=p,r}}ie.prototype.bytesPerElement=12,Qe("StructArrayLayout3f12",ie);class oe extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r){const o=this.length;return this.resize(o+1),this.emplace(o,r)}emplace(r,o){return this.uint32[1*r+0]=o,r}}oe.prototype.bytesPerElement=4,Qe("StructArrayLayout1ul4",oe);class le extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,o,c,p,_,v,b,S,k){const E=this.length;return this.resize(E+1),this.emplace(E,r,o,c,p,_,v,b,S,k)}emplace(r,o,c,p,_,v,b,S,k,E){const A=10*r,R=5*r;return this.int16[A+0]=o,this.int16[A+1]=c,this.int16[A+2]=p,this.int16[A+3]=_,this.int16[A+4]=v,this.int16[A+5]=b,this.uint32[R+3]=S,this.uint16[A+8]=k,this.uint16[A+9]=E,r}}le.prototype.bytesPerElement=20,Qe("StructArrayLayout6i1ul2ui20",le);class K extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,c,p,_,v){const b=this.length;return this.resize(b+1),this.emplace(b,r,o,c,p,_,v)}emplace(r,o,c,p,_,v,b){const S=6*r;return this.int16[S+0]=o,this.int16[S+1]=c,this.int16[S+2]=p,this.int16[S+3]=_,this.int16[S+4]=v,this.int16[S+5]=b,r}}K.prototype.bytesPerElement=12,Qe("StructArrayLayout2i2i2i12",K);class he extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,c,p,_){const v=this.length;return this.resize(v+1),this.emplace(v,r,o,c,p,_)}emplace(r,o,c,p,_,v){const b=4*r,S=8*r;return this.float32[b+0]=o,this.float32[b+1]=c,this.float32[b+2]=p,this.int16[S+6]=_,this.int16[S+7]=v,r}}he.prototype.bytesPerElement=16,Qe("StructArrayLayout2f1f2i16",he);class fe extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,c,p,_,v){const b=this.length;return this.resize(b+1),this.emplace(b,r,o,c,p,_,v)}emplace(r,o,c,p,_,v,b){const S=16*r,k=4*r,E=8*r;return this.uint8[S+0]=o,this.uint8[S+1]=c,this.float32[k+1]=p,this.float32[k+2]=_,this.int16[E+6]=v,this.int16[E+7]=b,r}}fe.prototype.bytesPerElement=16,Qe("StructArrayLayout2ub2f2i16",fe);class ve extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,o,c){const p=this.length;return this.resize(p+1),this.emplace(p,r,o,c)}emplace(r,o,c,p){const _=3*r;return this.uint16[_+0]=o,this.uint16[_+1]=c,this.uint16[_+2]=p,r}}ve.prototype.bytesPerElement=6,Qe("StructArrayLayout3ui6",ve);class Me extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,c,p,_,v,b,S,k,E,A,R,O,j,V,Y,re){const ye=this.length;return this.resize(ye+1),this.emplace(ye,r,o,c,p,_,v,b,S,k,E,A,R,O,j,V,Y,re)}emplace(r,o,c,p,_,v,b,S,k,E,A,R,O,j,V,Y,re,ye){const ce=24*r,me=12*r,Ce=48*r;return this.int16[ce+0]=o,this.int16[ce+1]=c,this.uint16[ce+2]=p,this.uint16[ce+3]=_,this.uint32[me+2]=v,this.uint32[me+3]=b,this.uint32[me+4]=S,this.uint16[ce+10]=k,this.uint16[ce+11]=E,this.uint16[ce+12]=A,this.float32[me+7]=R,this.float32[me+8]=O,this.uint8[Ce+36]=j,this.uint8[Ce+37]=V,this.uint8[Ce+38]=Y,this.uint32[me+10]=re,this.int16[ce+22]=ye,r}}Me.prototype.bytesPerElement=48,Qe("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Me);class De extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,c,p,_,v,b,S,k,E,A,R,O,j,V,Y,re,ye,ce,me,Ce,Le,Xe,ft,We,qe,st,nt){const Je=this.length;return this.resize(Je+1),this.emplace(Je,r,o,c,p,_,v,b,S,k,E,A,R,O,j,V,Y,re,ye,ce,me,Ce,Le,Xe,ft,We,qe,st,nt)}emplace(r,o,c,p,_,v,b,S,k,E,A,R,O,j,V,Y,re,ye,ce,me,Ce,Le,Xe,ft,We,qe,st,nt,Je){const Ie=32*r,at=16*r;return this.int16[Ie+0]=o,this.int16[Ie+1]=c,this.int16[Ie+2]=p,this.int16[Ie+3]=_,this.int16[Ie+4]=v,this.int16[Ie+5]=b,this.int16[Ie+6]=S,this.int16[Ie+7]=k,this.uint16[Ie+8]=E,this.uint16[Ie+9]=A,this.uint16[Ie+10]=R,this.uint16[Ie+11]=O,this.uint16[Ie+12]=j,this.uint16[Ie+13]=V,this.uint16[Ie+14]=Y,this.uint16[Ie+15]=re,this.uint16[Ie+16]=ye,this.uint16[Ie+17]=ce,this.uint16[Ie+18]=me,this.uint16[Ie+19]=Ce,this.uint16[Ie+20]=Le,this.uint16[Ie+21]=Xe,this.uint16[Ie+22]=ft,this.uint32[at+12]=We,this.float32[at+13]=qe,this.float32[at+14]=st,this.uint16[Ie+30]=nt,this.uint16[Ie+31]=Je,r}}De.prototype.bytesPerElement=64,Qe("StructArrayLayout8i15ui1ul2f2ui64",De);class Ze extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r){const o=this.length;return this.resize(o+1),this.emplace(o,r)}emplace(r,o){return this.float32[1*r+0]=o,r}}Ze.prototype.bytesPerElement=4,Qe("StructArrayLayout1f4",Ze);class Ye extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,c){const p=this.length;return this.resize(p+1),this.emplace(p,r,o,c)}emplace(r,o,c,p){const _=3*r;return this.uint16[6*r+0]=o,this.float32[_+1]=c,this.float32[_+2]=p,r}}Ye.prototype.bytesPerElement=12,Qe("StructArrayLayout1ui2f12",Ye);class Ue extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,o,c){const p=this.length;return this.resize(p+1),this.emplace(p,r,o,c)}emplace(r,o,c,p){const _=4*r;return this.uint32[2*r+0]=o,this.uint16[_+2]=c,this.uint16[_+3]=p,r}}Ue.prototype.bytesPerElement=8,Qe("StructArrayLayout1ul2ui8",Ue);class je extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,o){const c=this.length;return this.resize(c+1),this.emplace(c,r,o)}emplace(r,o,c){const p=2*r;return this.uint16[p+0]=o,this.uint16[p+1]=c,r}}je.prototype.bytesPerElement=4,Qe("StructArrayLayout2ui4",je);class it extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r){const o=this.length;return this.resize(o+1),this.emplace(o,r)}emplace(r,o){return this.uint16[1*r+0]=o,r}}it.prototype.bytesPerElement=2,Qe("StructArrayLayout1ui2",it);class St extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,c,p){const _=this.length;return this.resize(_+1),this.emplace(_,r,o,c,p)}emplace(r,o,c,p,_){const v=4*r;return this.float32[v+0]=o,this.float32[v+1]=c,this.float32[v+2]=p,this.float32[v+3]=_,r}}St.prototype.bytesPerElement=16,Qe("StructArrayLayout4f16",St);class Ge extends d{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new N(this.anchorPointX,this.anchorPointY)}}Ge.prototype.size=20;class Ke extends le{get(r){return new Ge(this,r)}}Qe("CollisionBoxArray",Ke);class xt extends d{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(r){this._structArray.uint8[this._pos1+37]=r}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(r){this._structArray.uint8[this._pos1+38]=r}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(r){this._structArray.uint32[this._pos4+10]=r}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}xt.prototype.size=48;class xn extends Me{get(r){return new xt(this,r)}}Qe("PlacedSymbolArray",xn);class Pt extends d{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(r){this._structArray.uint32[this._pos4+12]=r}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Pt.prototype.size=64;class Ft extends De{get(r){return new Pt(this,r)}}Qe("SymbolInstanceArray",Ft);class bn extends Ze{getoffsetX(r){return this.float32[1*r+0]}}Qe("GlyphOffsetArray",bn);class vr extends I{getx(r){return this.int16[3*r+0]}gety(r){return this.int16[3*r+1]}gettileUnitDistanceFromAnchor(r){return this.int16[3*r+2]}}Qe("SymbolLineVertexArray",vr);class Zi extends d{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Zi.prototype.size=12;class wn extends Ye{get(r){return new Zi(this,r)}}Qe("TextAnchorOffsetArray",wn);class Zr extends d{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Zr.prototype.size=8;class Rr extends Ue{get(r){return new Zr(this,r)}}Qe("FeatureIndexArray",Rr);class xr extends C{}class Dr extends C{}class _o extends C{}class Sa extends z{}class Ic extends ${}class Ta extends G{}class Ei extends H{}class Pc extends Q{}class zh extends ie{}class Ii extends oe{}class Pi extends K{}class os extends fe{}class Wi extends ve{}class dr extends je{}const br=w([{name:"a_pos",components:2,type:"Int16"}],4),{members:pi}=br;class Ot{constructor(r=[]){this.segments=r}prepareSegment(r,o,c,p){let _=this.segments[this.segments.length-1];return r>Ot.MAX_VERTEX_ARRAY_LENGTH&&dt(`Max vertices per segment is ${Ot.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${r}`),(!_||_.vertexLength+r>Ot.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==p)&&(_={vertexOffset:o.length,primitiveOffset:c.length,vertexLength:0,primitiveLength:0},p!==void 0&&(_.sortKey=p),this.segments.push(_)),_}get(){return this.segments}destroy(){for(const r of this.segments)for(const o in r.vaos)r.vaos[o].destroy()}static simpleSegment(r,o,c,p){return new Ot([{vertexOffset:r,primitiveOffset:o,vertexLength:c,primitiveLength:p,vaos:{},sortKey:0}])}}function Bs(i,r){return 256*(i=_e(Math.floor(i),0,255))+_e(Math.floor(r),0,255)}Ot.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Qe("SegmentVector",Ot);const Ca=w([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var ka={exports:{}},jp={exports:{}};jp.exports=function(i,r){var o,c,p,_,v,b,S,k;for(c=i.length-(o=3&i.length),p=r,v=3432918353,b=461845907,k=0;k<c;)S=255&i.charCodeAt(k)|(255&i.charCodeAt(++k))<<8|(255&i.charCodeAt(++k))<<16|(255&i.charCodeAt(++k))<<24,++k,p=27492+(65535&(_=5*(65535&(p=(p^=S=(65535&(S=(S=(65535&S)*v+(((S>>>16)*v&65535)<<16)&4294967295)<<15|S>>>17))*b+(((S>>>16)*b&65535)<<16)&4294967295)<<13|p>>>19))+((5*(p>>>16)&65535)<<16)&4294967295))+((58964+(_>>>16)&65535)<<16);switch(S=0,o){case 3:S^=(255&i.charCodeAt(k+2))<<16;case 2:S^=(255&i.charCodeAt(k+1))<<8;case 1:p^=S=(65535&(S=(S=(65535&(S^=255&i.charCodeAt(k)))*v+(((S>>>16)*v&65535)<<16)&4294967295)<<15|S>>>17))*b+(((S>>>16)*b&65535)<<16)&4294967295}return p^=i.length,p=2246822507*(65535&(p^=p>>>16))+((2246822507*(p>>>16)&65535)<<16)&4294967295,p=3266489909*(65535&(p^=p>>>13))+((3266489909*(p>>>16)&65535)<<16)&4294967295,(p^=p>>>16)>>>0};var uy=jp.exports,Up={exports:{}};Up.exports=function(i,r){for(var o,c=i.length,p=r^c,_=0;c>=4;)o=1540483477*(65535&(o=255&i.charCodeAt(_)|(255&i.charCodeAt(++_))<<8|(255&i.charCodeAt(++_))<<16|(255&i.charCodeAt(++_))<<24))+((1540483477*(o>>>16)&65535)<<16),p=1540483477*(65535&p)+((1540483477*(p>>>16)&65535)<<16)^(o=1540483477*(65535&(o^=o>>>24))+((1540483477*(o>>>16)&65535)<<16)),c-=4,++_;switch(c){case 3:p^=(255&i.charCodeAt(_+2))<<16;case 2:p^=(255&i.charCodeAt(_+1))<<8;case 1:p=1540483477*(65535&(p^=255&i.charCodeAt(_)))+((1540483477*(p>>>16)&65535)<<16)}return p=1540483477*(65535&(p^=p>>>13))+((1540483477*(p>>>16)&65535)<<16),(p^=p>>>15)>>>0};var ss=uy,Vp=Up.exports;ka.exports=ss,ka.exports.murmur3=ss,ka.exports.murmur2=Vp;var Ac=P(ka.exports);class xl{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(r,o,c,p){this.ids.push(Mc(r)),this.positions.push(o,c,p)}getPositions(r){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const o=Mc(r);let c=0,p=this.ids.length-1;for(;c<p;){const v=c+p>>1;this.ids[v]>=o?p=v:c=v+1}const _=[];for(;this.ids[c]===o;)_.push({index:this.positions[3*c],start:this.positions[3*c+1],end:this.positions[3*c+2]}),c++;return _}static serialize(r,o){const c=new Float64Array(r.ids),p=new Uint32Array(r.positions);return zc(c,p,0,c.length-1),o&&o.push(c.buffer,p.buffer),{ids:c,positions:p}}static deserialize(r){const o=new xl;return o.ids=r.ids,o.positions=r.positions,o.indexed=!0,o}}function Mc(i){const r=+i;return!isNaN(r)&&r<=Number.MAX_SAFE_INTEGER?r:Ac(String(i))}function zc(i,r,o,c){for(;o<c;){const p=i[o+c>>1];let _=o-1,v=c+1;for(;;){do _++;while(i[_]<p);do v--;while(i[v]>p);if(_>=v)break;Ea(i,_,v),Ea(r,3*_,3*v),Ea(r,3*_+1,3*v+1),Ea(r,3*_+2,3*v+2)}v-o<c-v?(zc(i,r,o,v),o=v+1):(zc(i,r,v+1,c),c=v)}}function Ea(i,r,o){const c=i[r];i[r]=i[o],i[o]=c}Qe("FeaturePositionMap",xl);class bl{constructor(r,o){this.gl=r.gl,this.location=o}}class Gp extends bl{constructor(r,o){super(r,o),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))}}class Cx extends bl{constructor(r,o){super(r,o),this.current=[0,0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))}}class kx extends bl{constructor(r,o){super(r,o),this.current=tn.transparent}set(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))}}const Vk=new Float32Array(16);function hy(i){return[Bs(255*i.r,255*i.g),Bs(255*i.b,255*i.a)]}class Lh{constructor(r,o,c){this.value=r,this.uniformNames=o.map(p=>`u_${p}`),this.type=c}setUniform(r,o,c){r.set(c.constantOr(this.value))}getBinding(r,o,c){return this.type==="color"?new kx(r,o):new Gp(r,o)}}class Lc{constructor(r,o){this.uniformNames=o.map(c=>`u_${c}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(r,o){this.pixelRatioFrom=o.pixelRatio,this.pixelRatioTo=r.pixelRatio,this.patternFrom=o.tlbr,this.patternTo=r.tlbr}setUniform(r,o,c,p){const _=p==="u_pattern_to"?this.patternTo:p==="u_pattern_from"?this.patternFrom:p==="u_pixel_ratio_to"?this.pixelRatioTo:p==="u_pixel_ratio_from"?this.pixelRatioFrom:null;_&&r.set(_)}getBinding(r,o,c){return c.substr(0,9)==="u_pattern"?new Cx(r,o):new Gp(r,o)}}class Os{constructor(r,o,c,p){this.expression=r,this.type=c,this.maxValue=0,this.paintVertexAttributes=o.map(_=>({name:`a_${_}`,type:"Float32",components:c==="color"?2:1,offset:0})),this.paintVertexArray=new p}populatePaintArray(r,o,c,p,_){const v=this.paintVertexArray.length,b=this.expression.evaluate(new vn(0),o,{},p,[],_);this.paintVertexArray.resize(r),this._setPaintValue(v,r,b)}updatePaintArray(r,o,c,p){const _=this.expression.evaluate({zoom:0},c,p);this._setPaintValue(r,o,_)}_setPaintValue(r,o,c){if(this.type==="color"){const p=hy(c);for(let _=r;_<o;_++)this.paintVertexArray.emplace(_,p[0],p[1])}else{for(let p=r;p<o;p++)this.paintVertexArray.emplace(p,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Vo{constructor(r,o,c,p,_,v){this.expression=r,this.uniformNames=o.map(b=>`u_${b}_t`),this.type=c,this.useIntegerZoom=p,this.zoom=_,this.maxValue=0,this.paintVertexAttributes=o.map(b=>({name:`a_${b}`,type:"Float32",components:c==="color"?4:2,offset:0})),this.paintVertexArray=new v}populatePaintArray(r,o,c,p,_){const v=this.expression.evaluate(new vn(this.zoom),o,{},p,[],_),b=this.expression.evaluate(new vn(this.zoom+1),o,{},p,[],_),S=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValue(S,r,v,b)}updatePaintArray(r,o,c,p){const _=this.expression.evaluate({zoom:this.zoom},c,p),v=this.expression.evaluate({zoom:this.zoom+1},c,p);this._setPaintValue(r,o,_,v)}_setPaintValue(r,o,c,p){if(this.type==="color"){const _=hy(c),v=hy(p);for(let b=r;b<o;b++)this.paintVertexArray.emplace(b,_[0],_[1],v[0],v[1])}else{for(let _=r;_<o;_++)this.paintVertexArray.emplace(_,c,p);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(p))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(r,o){const c=this.useIntegerZoom?Math.floor(o.zoom):o.zoom,p=_e(this.expression.interpolationFactor(c,this.zoom,this.zoom+1),0,1);r.set(p)}getBinding(r,o,c){return new Gp(r,o)}}class Ia{constructor(r,o,c,p,_,v){this.expression=r,this.type=o,this.useIntegerZoom=c,this.zoom=p,this.layerId=v,this.zoomInPaintVertexArray=new _,this.zoomOutPaintVertexArray=new _}populatePaintArray(r,o,c){const p=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(r),this.zoomOutPaintVertexArray.resize(r),this._setPaintValues(p,r,o.patterns&&o.patterns[this.layerId],c)}updatePaintArray(r,o,c,p,_){this._setPaintValues(r,o,c.patterns&&c.patterns[this.layerId],_)}_setPaintValues(r,o,c,p){if(!p||!c)return;const{min:_,mid:v,max:b}=c,S=p[_],k=p[v],E=p[b];if(S&&k&&E)for(let A=r;A<o;A++)this.zoomInPaintVertexArray.emplace(A,k.tl[0],k.tl[1],k.br[0],k.br[1],S.tl[0],S.tl[1],S.br[0],S.br[1],k.pixelRatio,S.pixelRatio),this.zoomOutPaintVertexArray.emplace(A,k.tl[0],k.tl[1],k.br[0],k.br[1],E.tl[0],E.tl[1],E.br[0],E.br[1],k.pixelRatio,E.pixelRatio)}upload(r){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=r.createVertexBuffer(this.zoomInPaintVertexArray,Ca.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=r.createVertexBuffer(this.zoomOutPaintVertexArray,Ca.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Ex{constructor(r,o,c){this.binders={},this._buffers=[];const p=[];for(const _ in r.paint._values){if(!c(_))continue;const v=r.paint.get(_);if(!(v instanceof yo&&ua(v.property.specification)))continue;const b=Gk(_,r.type),S=v.value,k=v.property.specification.type,E=v.property.useIntegerZoom,A=v.property.specification["property-type"],R=A==="cross-faded"||A==="cross-faded-data-driven";if(S.kind==="constant")this.binders[_]=R?new Lc(S.value,b):new Lh(S.value,b,k),p.push(`/u_${_}`);else if(S.kind==="source"||R){const O=Ix(_,k,"source");this.binders[_]=R?new Ia(S,k,E,o,O,r.id):new Os(S,b,k,O),p.push(`/a_${_}`)}else{const O=Ix(_,k,"composite");this.binders[_]=new Vo(S,b,k,E,o,O),p.push(`/z_${_}`)}}this.cacheKey=p.sort().join("")}getMaxValue(r){const o=this.binders[r];return o instanceof Os||o instanceof Vo?o.maxValue:0}populatePaintArrays(r,o,c,p,_){for(const v in this.binders){const b=this.binders[v];(b instanceof Os||b instanceof Vo||b instanceof Ia)&&b.populatePaintArray(r,o,c,p,_)}}setConstantPatternPositions(r,o){for(const c in this.binders){const p=this.binders[c];p instanceof Lc&&p.setConstantPatternPositions(r,o)}}updatePaintArrays(r,o,c,p,_){let v=!1;for(const b in r){const S=o.getPositions(b);for(const k of S){const E=c.feature(k.index);for(const A in this.binders){const R=this.binders[A];if((R instanceof Os||R instanceof Vo||R instanceof Ia)&&R.expression.isStateDependent===!0){const O=p.paint.get(A);R.expression=O.value,R.updatePaintArray(k.start,k.end,E,r[b],_),v=!0}}}}return v}defines(){const r=[];for(const o in this.binders){const c=this.binders[o];(c instanceof Lh||c instanceof Lc)&&r.push(...c.uniformNames.map(p=>`#define HAS_UNIFORM_${p}`))}return r}getBinderAttributes(){const r=[];for(const o in this.binders){const c=this.binders[o];if(c instanceof Os||c instanceof Vo)for(let p=0;p<c.paintVertexAttributes.length;p++)r.push(c.paintVertexAttributes[p].name);else if(c instanceof Ia)for(let p=0;p<Ca.members.length;p++)r.push(Ca.members[p].name)}return r}getBinderUniforms(){const r=[];for(const o in this.binders){const c=this.binders[o];if(c instanceof Lh||c instanceof Lc||c instanceof Vo)for(const p of c.uniformNames)r.push(p)}return r}getPaintVertexBuffers(){return this._buffers}getUniforms(r,o){const c=[];for(const p in this.binders){const _=this.binders[p];if(_ instanceof Lh||_ instanceof Lc||_ instanceof Vo){for(const v of _.uniformNames)if(o[v]){const b=_.getBinding(r,o[v],v);c.push({name:v,property:p,binding:b})}}}return c}setUniforms(r,o,c,p){for(const{name:_,property:v,binding:b}of o)this.binders[v].setUniform(b,p,c.get(v),_)}updatePaintBuffers(r){this._buffers=[];for(const o in this.binders){const c=this.binders[o];if(r&&c instanceof Ia){const p=r.fromScale===2?c.zoomInPaintVertexBuffer:c.zoomOutPaintVertexBuffer;p&&this._buffers.push(p)}else(c instanceof Os||c instanceof Vo)&&c.paintVertexBuffer&&this._buffers.push(c.paintVertexBuffer)}}upload(r){for(const o in this.binders){const c=this.binders[o];(c instanceof Os||c instanceof Vo||c instanceof Ia)&&c.upload(r)}this.updatePaintBuffers()}destroy(){for(const r in this.binders){const o=this.binders[r];(o instanceof Os||o instanceof Vo||o instanceof Ia)&&o.destroy()}}}class wl{constructor(r,o,c=()=>!0){this.programConfigurations={};for(const p of r)this.programConfigurations[p.id]=new Ex(p,o,c);this.needsUpload=!1,this._featureMap=new xl,this._bufferOffset=0}populatePaintArrays(r,o,c,p,_,v){for(const b in this.programConfigurations)this.programConfigurations[b].populatePaintArrays(r,o,p,_,v);o.id!==void 0&&this._featureMap.add(o.id,c,this._bufferOffset,r),this._bufferOffset=r,this.needsUpload=!0}updatePaintArrays(r,o,c,p){for(const _ of c)this.needsUpload=this.programConfigurations[_.id].updatePaintArrays(r,this._featureMap,o,_,p)||this.needsUpload}get(r){return this.programConfigurations[r]}upload(r){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(r);this.needsUpload=!1}}destroy(){for(const r in this.programConfigurations)this.programConfigurations[r].destroy()}}function Gk(i,r){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[i]||[i.replace(`${r}-`,"").replace(/-/g,"_")]}function Ix(i,r,o){const c={color:{source:G,composite:St},number:{source:Ze,composite:G}},p=function(_){return{"line-pattern":{source:Ei,composite:Ei},"fill-pattern":{source:Ei,composite:Ei},"fill-extrusion-pattern":{source:Ei,composite:Ei}}[_]}(i);return p&&p[o]||c[r][o]}Qe("ConstantBinder",Lh),Qe("CrossFadedConstantBinder",Lc),Qe("SourceExpressionBinder",Os),Qe("CrossFadedCompositeBinder",Ia),Qe("CompositeExpressionBinder",Vo),Qe("ProgramConfiguration",Ex,{omit:["_buffers"]}),Qe("ProgramConfigurationSet",wl);const Wn=8192,dy=Math.pow(2,14)-1,Px=-dy-1;function Sl(i){const r=Wn/i.extent,o=i.loadGeometry();for(let c=0;c<o.length;c++){const p=o[c];for(let _=0;_<p.length;_++){const v=p[_],b=Math.round(v.x*r),S=Math.round(v.y*r);v.x=_e(b,Px,dy),v.y=_e(S,Px,dy),(b<v.x||b>v.x+1||S<v.y||S>v.y+1)&&dt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return o}function Tl(i,r){return{type:i.type,id:i.id,properties:i.properties,geometry:r?Sl(i):[]}}function qp(i,r,o,c,p){i.emplaceBack(2*r+(c+1)/2,2*o+(p+1)/2)}class py{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(o=>o.id),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new Dr,this.indexArray=new Wi,this.segments=new Ot,this.programConfigurations=new wl(r.layers,r.zoom),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(r,o,c){const p=this.layers[0],_=[];let v=null,b=!1;p.type==="circle"&&(v=p.layout.get("circle-sort-key"),b=!v.isConstant());for(const{feature:S,id:k,index:E,sourceLayerIndex:A}of r){const R=this.layers[0]._featureFilter.needGeometry,O=Tl(S,R);if(!this.layers[0]._featureFilter.filter(new vn(this.zoom),O,c))continue;const j=b?v.evaluate(O,{},c):void 0,V={id:k,properties:S.properties,type:S.type,sourceLayerIndex:A,index:E,geometry:R?O.geometry:Sl(S),patterns:{},sortKey:j};_.push(V)}b&&_.sort((S,k)=>S.sortKey-k.sortKey);for(const S of _){const{geometry:k,index:E,sourceLayerIndex:A}=S,R=r[E].feature;this.addFeature(S,k,E,c),o.featureIndex.insert(R,k,E,A,this.index)}}update(r,o,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,o,this.stateDependentLayers,c)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,pi),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(r,o,c,p){for(const _ of o)for(const v of _){const b=v.x,S=v.y;if(b<0||b>=Wn||S<0||S>=Wn)continue;const k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,r.sortKey),E=k.vertexLength;qp(this.layoutVertexArray,b,S,-1,-1),qp(this.layoutVertexArray,b,S,1,-1),qp(this.layoutVertexArray,b,S,1,1),qp(this.layoutVertexArray,b,S,-1,1),this.indexArray.emplaceBack(E,E+1,E+2),this.indexArray.emplaceBack(E,E+3,E+2),k.vertexLength+=4,k.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,c,{},p)}}function Ax(i,r){for(let o=0;o<i.length;o++)if(Rc(r,i[o]))return!0;for(let o=0;o<r.length;o++)if(Rc(i,r[o]))return!0;return!!fy(i,r)}function qk(i,r,o){return!!Rc(i,r)||!!my(r,i,o)}function Mx(i,r){if(i.length===1)return Lx(r,i[0]);for(let o=0;o<r.length;o++){const c=r[o];for(let p=0;p<c.length;p++)if(Rc(i,c[p]))return!0}for(let o=0;o<i.length;o++)if(Lx(r,i[o]))return!0;for(let o=0;o<r.length;o++)if(fy(i,r[o]))return!0;return!1}function Hk(i,r,o){if(i.length>1){if(fy(i,r))return!0;for(let c=0;c<r.length;c++)if(my(r[c],i,o))return!0}for(let c=0;c<i.length;c++)if(my(i[c],r,o))return!0;return!1}function fy(i,r){if(i.length===0||r.length===0)return!1;for(let o=0;o<i.length-1;o++){const c=i[o],p=i[o+1];for(let _=0;_<r.length-1;_++)if(Zk(c,p,r[_],r[_+1]))return!0}return!1}function Zk(i,r,o,c){return ht(i,o,c)!==ht(r,o,c)&&ht(i,r,o)!==ht(i,r,c)}function my(i,r,o){const c=o*o;if(r.length===1)return i.distSqr(r[0])<c;for(let p=1;p<r.length;p++)if(zx(i,r[p-1],r[p])<c)return!0;return!1}function zx(i,r,o){const c=r.distSqr(o);if(c===0)return i.distSqr(r);const p=((i.x-r.x)*(o.x-r.x)+(i.y-r.y)*(o.y-r.y))/c;return i.distSqr(p<0?r:p>1?o:o.sub(r)._mult(p)._add(r))}function Lx(i,r){let o,c,p,_=!1;for(let v=0;v<i.length;v++){o=i[v];for(let b=0,S=o.length-1;b<o.length;S=b++)c=o[b],p=o[S],c.y>r.y!=p.y>r.y&&r.x<(p.x-c.x)*(r.y-c.y)/(p.y-c.y)+c.x&&(_=!_)}return _}function Rc(i,r){let o=!1;for(let c=0,p=i.length-1;c<i.length;p=c++){const _=i[c],v=i[p];_.y>r.y!=v.y>r.y&&r.x<(v.x-_.x)*(r.y-_.y)/(v.y-_.y)+_.x&&(o=!o)}return o}function Wk(i,r,o){const c=o[0],p=o[2];if(i.x<c.x&&r.x<c.x||i.x>p.x&&r.x>p.x||i.y<c.y&&r.y<c.y||i.y>p.y&&r.y>p.y)return!1;const _=ht(i,r,o[0]);return _!==ht(i,r,o[1])||_!==ht(i,r,o[2])||_!==ht(i,r,o[3])}function Rh(i,r,o){const c=r.paint.get(i).value;return c.kind==="constant"?c.value:o.programConfigurations.get(r.id).getMaxValue(i)}function Hp(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function Zp(i,r,o,c,p){if(!r[0]&&!r[1])return i;const _=N.convert(r)._mult(p);o==="viewport"&&_._rotate(-c);const v=[];for(let b=0;b<i.length;b++)v.push(i[b].sub(_));return v}let Rx,Dx;Qe("CircleBucket",py,{omit:["layers"]});var Kk={get paint(){return Dx=Dx||new g({"circle-radius":new gt(Se.paint_circle["circle-radius"]),"circle-color":new gt(Se.paint_circle["circle-color"]),"circle-blur":new gt(Se.paint_circle["circle-blur"]),"circle-opacity":new gt(Se.paint_circle["circle-opacity"]),"circle-translate":new rt(Se.paint_circle["circle-translate"]),"circle-translate-anchor":new rt(Se.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new rt(Se.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new rt(Se.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new gt(Se.paint_circle["circle-stroke-width"]),"circle-stroke-color":new gt(Se.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new gt(Se.paint_circle["circle-stroke-opacity"])})},get layout(){return Rx=Rx||new g({"circle-sort-key":new gt(Se.layout_circle["circle-sort-key"])})}},Wr=1e-6,Dc=typeof Float32Array<"u"?Float32Array:Array;function gy(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function Fx(i,r,o){var c=r[0],p=r[1],_=r[2],v=r[3],b=r[4],S=r[5],k=r[6],E=r[7],A=r[8],R=r[9],O=r[10],j=r[11],V=r[12],Y=r[13],re=r[14],ye=r[15],ce=o[0],me=o[1],Ce=o[2],Le=o[3];return i[0]=ce*c+me*b+Ce*A+Le*V,i[1]=ce*p+me*S+Ce*R+Le*Y,i[2]=ce*_+me*k+Ce*O+Le*re,i[3]=ce*v+me*E+Ce*j+Le*ye,i[4]=(ce=o[4])*c+(me=o[5])*b+(Ce=o[6])*A+(Le=o[7])*V,i[5]=ce*p+me*S+Ce*R+Le*Y,i[6]=ce*_+me*k+Ce*O+Le*re,i[7]=ce*v+me*E+Ce*j+Le*ye,i[8]=(ce=o[8])*c+(me=o[9])*b+(Ce=o[10])*A+(Le=o[11])*V,i[9]=ce*p+me*S+Ce*R+Le*Y,i[10]=ce*_+me*k+Ce*O+Le*re,i[11]=ce*v+me*E+Ce*j+Le*ye,i[12]=(ce=o[12])*c+(me=o[13])*b+(Ce=o[14])*A+(Le=o[15])*V,i[13]=ce*p+me*S+Ce*R+Le*Y,i[14]=ce*_+me*k+Ce*O+Le*re,i[15]=ce*v+me*E+Ce*j+Le*ye,i}Math.hypot||(Math.hypot=function(){for(var i=0,r=arguments.length;r--;)i+=arguments[r]*arguments[r];return Math.sqrt(i)});var Dh,Xk=Fx;function Wp(i,r,o){var c=r[0],p=r[1],_=r[2],v=r[3];return i[0]=o[0]*c+o[4]*p+o[8]*_+o[12]*v,i[1]=o[1]*c+o[5]*p+o[9]*_+o[13]*v,i[2]=o[2]*c+o[6]*p+o[10]*_+o[14]*v,i[3]=o[3]*c+o[7]*p+o[11]*_+o[15]*v,i}Dh=new Dc(4),Dc!=Float32Array&&(Dh[0]=0,Dh[1]=0,Dh[2]=0,Dh[3]=0);class Yk extends a{constructor(r){super(r,Kk)}createBucket(r){return new py(r)}queryRadius(r){const o=r;return Rh("circle-radius",this,o)+Rh("circle-stroke-width",this,o)+Hp(this.paint.get("circle-translate"))}queryIntersectsFeature(r,o,c,p,_,v,b,S){const k=Zp(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),v.angle,b),E=this.paint.get("circle-radius").evaluate(o,c)+this.paint.get("circle-stroke-width").evaluate(o,c),A=this.paint.get("circle-pitch-alignment")==="map",R=A?k:function(j,V){return j.map(Y=>Bx(Y,V))}(k,S),O=A?E*b:E;for(const j of p)for(const V of j){const Y=A?V:Bx(V,S);let re=O;const ye=Wp([],[V.x,V.y,0,1],S);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?re*=ye[3]/v.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(re*=v.cameraToCenterDistance/ye[3]),qk(R,Y,re))return!0}return!1}}function Bx(i,r){const o=Wp([],[i.x,i.y,0,1],r);return new N(o[0]/o[3],o[1]/o[3])}class Ox extends py{}let Nx;Qe("HeatmapBucket",Ox,{omit:["layers"]});var Jk={get paint(){return Nx=Nx||new g({"heatmap-radius":new gt(Se.paint_heatmap["heatmap-radius"]),"heatmap-weight":new gt(Se.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new rt(Se.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Mh(Se.paint_heatmap["heatmap-color"]),"heatmap-opacity":new rt(Se.paint_heatmap["heatmap-opacity"])})}};function yy(i,{width:r,height:o},c,p){if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==r*o*c)throw new RangeError(`mismatched image size. expected: ${p.length} but got: ${r*o*c}`)}else p=new Uint8Array(r*o*c);return i.width=r,i.height=o,i.data=p,i}function $x(i,{width:r,height:o},c){if(r===i.width&&o===i.height)return;const p=yy({},{width:r,height:o},c);_y(i,p,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,r),height:Math.min(i.height,o)},c),i.width=r,i.height=o,i.data=p.data}function _y(i,r,o,c,p,_){if(p.width===0||p.height===0)return r;if(p.width>i.width||p.height>i.height||o.x>i.width-p.width||o.y>i.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>r.width||p.height>r.height||c.x>r.width-p.width||c.y>r.height-p.height)throw new RangeError("out of range destination coordinates for image copy");const v=i.data,b=r.data;if(v===b)throw new Error("srcData equals dstData, so image is already copied");for(let S=0;S<p.height;S++){const k=((o.y+S)*i.width+o.x)*_,E=((c.y+S)*r.width+c.x)*_;for(let A=0;A<p.width*_;A++)b[E+A]=v[k+A]}return r}class Fh{constructor(r,o){yy(this,r,1,o)}resize(r){$x(this,r,1)}clone(){return new Fh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,o,c,p,_){_y(r,o,c,p,_,1)}}class Ki{constructor(r,o){yy(this,r,4,o)}resize(r){$x(this,r,4)}replace(r,o){o?this.data.set(r):this.data=r instanceof Uint8ClampedArray?new Uint8Array(r.buffer):r}clone(){return new Ki({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,o,c,p,_){_y(r,o,c,p,_,4)}}function jx(i){const r={},o=i.resolution||256,c=i.clips?i.clips.length:1,p=i.image||new Ki({width:o,height:c});if(Math.log(o)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${o}`);const _=(v,b,S)=>{r[i.evaluationKey]=S;const k=i.expression.evaluate(r);p.data[v+b+0]=Math.floor(255*k.r/k.a),p.data[v+b+1]=Math.floor(255*k.g/k.a),p.data[v+b+2]=Math.floor(255*k.b/k.a),p.data[v+b+3]=Math.floor(255*k.a)};if(i.clips)for(let v=0,b=0;v<c;++v,b+=4*o)for(let S=0,k=0;S<o;S++,k+=4){const E=S/(o-1),{start:A,end:R}=i.clips[v];_(b,k,A*(1-E)+R*E)}else for(let v=0,b=0;v<o;v++,b+=4)_(0,b,v/(o-1));return p}Qe("AlphaImage",Fh),Qe("RGBAImage",Ki);const vy="big-fb";class Qk extends a{createBucket(r){return new Ox(r)}constructor(r){super(r,Jk),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){r==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=jx({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(vy)&&this.heatmapFbos.delete(vy)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Ux;var eE={get paint(){return Ux=Ux||new g({"hillshade-illumination-direction":new rt(Se.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new rt(Se.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new rt(Se.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new rt(Se.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new rt(Se.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new rt(Se.paint_hillshade["hillshade-accent-color"])})}};class tE extends a{constructor(r){super(r,eE)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const nE=w([{name:"a_pos",components:2,type:"Int16"}],4),{members:rE}=nE;function Vx(i,r,o=2){const c=r&&r.length,p=c?r[0]*o:i.length;let _=Gx(i,0,p,o,!0);const v=[];if(!_||_.next===_.prev)return v;let b,S,k;if(c&&(_=function(E,A,R,O){const j=[];for(let V=0,Y=A.length;V<Y;V++){const re=Gx(E,A[V]*O,V<Y-1?A[V+1]*O:E.length,O,!1);re===re.next&&(re.steiner=!0),j.push(hE(re))}j.sort(lE);for(let V=0;V<j.length;V++)R=cE(j[V],R);return R}(i,r,_,o)),i.length>80*o){b=1/0,S=1/0;let E=-1/0,A=-1/0;for(let R=o;R<p;R+=o){const O=i[R],j=i[R+1];O<b&&(b=O),j<S&&(S=j),O>E&&(E=O),j>A&&(A=j)}k=Math.max(E-b,A-S),k=k!==0?32767/k:0}return Bh(_,v,o,b,S,k,0),v}function Gx(i,r,o,c,p){let _;if(p===function(v,b,S,k){let E=0;for(let A=b,R=S-k;A<S;A+=k)E+=(v[R]-v[A])*(v[A+1]+v[R+1]),R=A;return E}(i,r,o,c)>0)for(let v=r;v<o;v+=c)_=Zx(v/c|0,i[v],i[v+1],_);else for(let v=o-c;v>=r;v-=c)_=Zx(v/c|0,i[v],i[v+1],_);return _&&Kp(_,_.next)&&(Nh(_),_=_.next),_}function Cl(i,r){if(!i)return i;r||(r=i);let o,c=i;do if(o=!1,c.steiner||!Kp(c,c.next)&&Un(c.prev,c,c.next)!==0)c=c.next;else{if(Nh(c),c=r=c.prev,c===c.next)break;o=!0}while(o||c!==r);return r}function Bh(i,r,o,c,p,_,v){if(!i)return;!v&&_&&function(S,k,E,A){let R=S;do R.z===0&&(R.z=xy(R.x,R.y,k,E,A)),R.prevZ=R.prev,R.nextZ=R.next,R=R.next;while(R!==S);R.prevZ.nextZ=null,R.prevZ=null,function(O){let j,V=1;do{let Y,re=O;O=null;let ye=null;for(j=0;re;){j++;let ce=re,me=0;for(let Le=0;Le<V&&(me++,ce=ce.nextZ,ce);Le++);let Ce=V;for(;me>0||Ce>0&&ce;)me!==0&&(Ce===0||!ce||re.z<=ce.z)?(Y=re,re=re.nextZ,me--):(Y=ce,ce=ce.nextZ,Ce--),ye?ye.nextZ=Y:O=Y,Y.prevZ=ye,ye=Y;re=ce}ye.nextZ=null,V*=2}while(j>1)}(R)}(i,c,p,_);let b=i;for(;i.prev!==i.next;){const S=i.prev,k=i.next;if(_?oE(i,c,p,_):iE(i))r.push(S.i,i.i,k.i),Nh(i),i=k.next,b=k.next;else if((i=k)===b){v?v===1?Bh(i=sE(Cl(i),r),r,o,c,p,_,2):v===2&&aE(i,r,o,c,p,_):Bh(Cl(i),r,o,c,p,_,1);break}}}function iE(i){const r=i.prev,o=i,c=i.next;if(Un(r,o,c)>=0)return!1;const p=r.x,_=o.x,v=c.x,b=r.y,S=o.y,k=c.y,E=p<_?p<v?p:v:_<v?_:v,A=b<S?b<k?b:k:S<k?S:k,R=p>_?p>v?p:v:_>v?_:v,O=b>S?b>k?b:k:S>k?S:k;let j=c.next;for(;j!==r;){if(j.x>=E&&j.x<=R&&j.y>=A&&j.y<=O&&Fc(p,b,_,S,v,k,j.x,j.y)&&Un(j.prev,j,j.next)>=0)return!1;j=j.next}return!0}function oE(i,r,o,c){const p=i.prev,_=i,v=i.next;if(Un(p,_,v)>=0)return!1;const b=p.x,S=_.x,k=v.x,E=p.y,A=_.y,R=v.y,O=b<S?b<k?b:k:S<k?S:k,j=E<A?E<R?E:R:A<R?A:R,V=b>S?b>k?b:k:S>k?S:k,Y=E>A?E>R?E:R:A>R?A:R,re=xy(O,j,r,o,c),ye=xy(V,Y,r,o,c);let ce=i.prevZ,me=i.nextZ;for(;ce&&ce.z>=re&&me&&me.z<=ye;){if(ce.x>=O&&ce.x<=V&&ce.y>=j&&ce.y<=Y&&ce!==p&&ce!==v&&Fc(b,E,S,A,k,R,ce.x,ce.y)&&Un(ce.prev,ce,ce.next)>=0||(ce=ce.prevZ,me.x>=O&&me.x<=V&&me.y>=j&&me.y<=Y&&me!==p&&me!==v&&Fc(b,E,S,A,k,R,me.x,me.y)&&Un(me.prev,me,me.next)>=0))return!1;me=me.nextZ}for(;ce&&ce.z>=re;){if(ce.x>=O&&ce.x<=V&&ce.y>=j&&ce.y<=Y&&ce!==p&&ce!==v&&Fc(b,E,S,A,k,R,ce.x,ce.y)&&Un(ce.prev,ce,ce.next)>=0)return!1;ce=ce.prevZ}for(;me&&me.z<=ye;){if(me.x>=O&&me.x<=V&&me.y>=j&&me.y<=Y&&me!==p&&me!==v&&Fc(b,E,S,A,k,R,me.x,me.y)&&Un(me.prev,me,me.next)>=0)return!1;me=me.nextZ}return!0}function sE(i,r){let o=i;do{const c=o.prev,p=o.next.next;!Kp(c,p)&&qx(c,o,o.next,p)&&Oh(c,p)&&Oh(p,c)&&(r.push(c.i,o.i,p.i),Nh(o),Nh(o.next),o=i=p),o=o.next}while(o!==i);return Cl(o)}function aE(i,r,o,c,p,_){let v=i;do{let b=v.next.next;for(;b!==v.prev;){if(v.i!==b.i&&dE(v,b)){let S=Hx(v,b);return v=Cl(v,v.next),S=Cl(S,S.next),Bh(v,r,o,c,p,_,0),void Bh(S,r,o,c,p,_,0)}b=b.next}v=v.next}while(v!==i)}function lE(i,r){return i.x-r.x}function cE(i,r){const o=function(p,_){let v=_;const b=p.x,S=p.y;let k,E=-1/0;do{if(S<=v.y&&S>=v.next.y&&v.next.y!==v.y){const V=v.x+(S-v.y)*(v.next.x-v.x)/(v.next.y-v.y);if(V<=b&&V>E&&(E=V,k=v.x<v.next.x?v:v.next,V===b))return k}v=v.next}while(v!==_);if(!k)return null;const A=k,R=k.x,O=k.y;let j=1/0;v=k;do{if(b>=v.x&&v.x>=R&&b!==v.x&&Fc(S<O?b:E,S,R,O,S<O?E:b,S,v.x,v.y)){const V=Math.abs(S-v.y)/(b-v.x);Oh(v,p)&&(V<j||V===j&&(v.x>k.x||v.x===k.x&&uE(k,v)))&&(k=v,j=V)}v=v.next}while(v!==A);return k}(i,r);if(!o)return r;const c=Hx(o,i);return Cl(c,c.next),Cl(o,o.next)}function uE(i,r){return Un(i.prev,i,r.prev)<0&&Un(r.next,i,i.next)<0}function xy(i,r,o,c,p){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-o)*p|0)|i<<8))|i<<4))|i<<2))|i<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-c)*p|0)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function hE(i){let r=i,o=i;do(r.x<o.x||r.x===o.x&&r.y<o.y)&&(o=r),r=r.next;while(r!==i);return o}function Fc(i,r,o,c,p,_,v,b){return(p-v)*(r-b)>=(i-v)*(_-b)&&(i-v)*(c-b)>=(o-v)*(r-b)&&(o-v)*(_-b)>=(p-v)*(c-b)}function dE(i,r){return i.next.i!==r.i&&i.prev.i!==r.i&&!function(o,c){let p=o;do{if(p.i!==o.i&&p.next.i!==o.i&&p.i!==c.i&&p.next.i!==c.i&&qx(p,p.next,o,c))return!0;p=p.next}while(p!==o);return!1}(i,r)&&(Oh(i,r)&&Oh(r,i)&&function(o,c){let p=o,_=!1;const v=(o.x+c.x)/2,b=(o.y+c.y)/2;do p.y>b!=p.next.y>b&&p.next.y!==p.y&&v<(p.next.x-p.x)*(b-p.y)/(p.next.y-p.y)+p.x&&(_=!_),p=p.next;while(p!==o);return _}(i,r)&&(Un(i.prev,i,r.prev)||Un(i,r.prev,r))||Kp(i,r)&&Un(i.prev,i,i.next)>0&&Un(r.prev,r,r.next)>0)}function Un(i,r,o){return(r.y-i.y)*(o.x-r.x)-(r.x-i.x)*(o.y-r.y)}function Kp(i,r){return i.x===r.x&&i.y===r.y}function qx(i,r,o,c){const p=Yp(Un(i,r,o)),_=Yp(Un(i,r,c)),v=Yp(Un(o,c,i)),b=Yp(Un(o,c,r));return p!==_&&v!==b||!(p!==0||!Xp(i,o,r))||!(_!==0||!Xp(i,c,r))||!(v!==0||!Xp(o,i,c))||!(b!==0||!Xp(o,r,c))}function Xp(i,r,o){return r.x<=Math.max(i.x,o.x)&&r.x>=Math.min(i.x,o.x)&&r.y<=Math.max(i.y,o.y)&&r.y>=Math.min(i.y,o.y)}function Yp(i){return i>0?1:i<0?-1:0}function Oh(i,r){return Un(i.prev,i,i.next)<0?Un(i,r,i.next)>=0&&Un(i,i.prev,r)>=0:Un(i,r,i.prev)<0||Un(i,i.next,r)<0}function Hx(i,r){const o=by(i.i,i.x,i.y),c=by(r.i,r.x,r.y),p=i.next,_=r.prev;return i.next=r,r.prev=i,o.next=p,p.prev=o,c.next=o,o.prev=c,_.next=c,c.prev=_,c}function Zx(i,r,o,c){const p=by(i,r,o);return c?(p.next=c.next,p.prev=c,c.next.prev=p,c.next=p):(p.prev=p,p.next=p),p}function Nh(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function by(i,r,o){return{i,x:r,y:o,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function wy(i,r,o){const c=o.patternDependencies;let p=!1;for(const _ of r){const v=_.paint.get(`${i}-pattern`);v.isConstant()||(p=!0);const b=v.constantOr(null);b&&(p=!0,c[b.to]=!0,c[b.from]=!0)}return p}function Sy(i,r,o,c,p){const _=p.patternDependencies;for(const v of r){const b=v.paint.get(`${i}-pattern`).value;if(b.kind!=="constant"){let S=b.evaluate({zoom:c-1},o,{},p.availableImages),k=b.evaluate({zoom:c},o,{},p.availableImages),E=b.evaluate({zoom:c+1},o,{},p.availableImages);S=S&&S.name?S.name:S,k=k&&k.name?k.name:k,E=E&&E.name?E.name:E,_[S]=!0,_[k]=!0,_[E]=!0,o.patterns[v.id]={min:S,mid:k,max:E}}}return o}class Ty{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(o=>o.id),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new _o,this.indexArray=new Wi,this.indexArray2=new dr,this.programConfigurations=new wl(r.layers,r.zoom),this.segments=new Ot,this.segments2=new Ot,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(r,o,c){this.hasPattern=wy("fill",this.layers,o);const p=this.layers[0].layout.get("fill-sort-key"),_=!p.isConstant(),v=[];for(const{feature:b,id:S,index:k,sourceLayerIndex:E}of r){const A=this.layers[0]._featureFilter.needGeometry,R=Tl(b,A);if(!this.layers[0]._featureFilter.filter(new vn(this.zoom),R,c))continue;const O=_?p.evaluate(R,{},c,o.availableImages):void 0,j={id:S,properties:b.properties,type:b.type,sourceLayerIndex:E,index:k,geometry:A?R.geometry:Sl(b),patterns:{},sortKey:O};v.push(j)}_&&v.sort((b,S)=>b.sortKey-S.sortKey);for(const b of v){const{geometry:S,index:k,sourceLayerIndex:E}=b;if(this.hasPattern){const A=Sy("fill",this.layers,b,this.zoom,o);this.patternFeatures.push(A)}else this.addFeature(b,S,k,c,{});o.featureIndex.insert(r[k].feature,S,k,E,this.index)}}update(r,o,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,o,this.stateDependentLayers,c)}addFeatures(r,o,c){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,o,c)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,rE),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.indexBuffer2=r.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(r,o,c,p,_){for(const v of sc(o,500)){let b=0;for(const O of v)b+=O.length;const S=this.segments.prepareSegment(b,this.layoutVertexArray,this.indexArray),k=S.vertexLength,E=[],A=[];for(const O of v){if(O.length===0)continue;O!==v[0]&&A.push(E.length/2);const j=this.segments2.prepareSegment(O.length,this.layoutVertexArray,this.indexArray2),V=j.vertexLength;this.layoutVertexArray.emplaceBack(O[0].x,O[0].y),this.indexArray2.emplaceBack(V+O.length-1,V),E.push(O[0].x),E.push(O[0].y);for(let Y=1;Y<O.length;Y++)this.layoutVertexArray.emplaceBack(O[Y].x,O[Y].y),this.indexArray2.emplaceBack(V+Y-1,V+Y),E.push(O[Y].x),E.push(O[Y].y);j.vertexLength+=O.length,j.primitiveLength+=O.length}const R=Vx(E,A);for(let O=0;O<R.length;O+=3)this.indexArray.emplaceBack(k+R[O],k+R[O+1],k+R[O+2]);S.vertexLength+=b,S.primitiveLength+=R.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,c,_,p)}}let Wx,Kx;Qe("FillBucket",Ty,{omit:["layers","patternFeatures"]});var pE={get paint(){return Kx=Kx||new g({"fill-antialias":new rt(Se.paint_fill["fill-antialias"]),"fill-opacity":new gt(Se.paint_fill["fill-opacity"]),"fill-color":new gt(Se.paint_fill["fill-color"]),"fill-outline-color":new gt(Se.paint_fill["fill-outline-color"]),"fill-translate":new rt(Se.paint_fill["fill-translate"]),"fill-translate-anchor":new rt(Se.paint_fill["fill-translate-anchor"]),"fill-pattern":new kc(Se.paint_fill["fill-pattern"])})},get layout(){return Wx=Wx||new g({"fill-sort-key":new gt(Se.layout_fill["fill-sort-key"])})}};class fE extends a{constructor(r){super(r,pE)}recalculate(r,o){super.recalculate(r,o);const c=this.paint._values["fill-outline-color"];c.value.kind==="constant"&&c.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(r){return new Ty(r)}queryRadius(){return Hp(this.paint.get("fill-translate"))}queryIntersectsFeature(r,o,c,p,_,v,b){return Mx(Zp(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),v.angle,b),p)}isTileClipped(){return!0}}const mE=w([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),gE=w([{name:"a_centroid",components:2,type:"Int16"}],4),{members:yE}=mE;var Pa={},_E=L,Xx=Bc;function Bc(i,r,o,c,p){this.properties={},this.extent=o,this.type=0,this._pbf=i,this._geometry=-1,this._keys=c,this._values=p,i.readFields(vE,this,r)}function vE(i,r,o){i==1?r.id=o.readVarint():i==2?function(c,p){for(var _=c.readVarint()+c.pos;c.pos<_;){var v=p._keys[c.readVarint()],b=p._values[c.readVarint()];p.properties[v]=b}}(o,r):i==3?r.type=o.readVarint():i==4&&(r._geometry=o.pos)}function xE(i){for(var r,o,c=0,p=0,_=i.length,v=_-1;p<_;v=p++)c+=((o=i[v]).x-(r=i[p]).x)*(r.y+o.y);return c}Bc.types=["Unknown","Point","LineString","Polygon"],Bc.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var r,o=i.readVarint()+i.pos,c=1,p=0,_=0,v=0,b=[];i.pos<o;){if(p<=0){var S=i.readVarint();c=7&S,p=S>>3}if(p--,c===1||c===2)_+=i.readSVarint(),v+=i.readSVarint(),c===1&&(r&&b.push(r),r=[]),r.push(new _E(_,v));else{if(c!==7)throw new Error("unknown command "+c);r&&r.push(r[0].clone())}}return r&&b.push(r),b},Bc.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var r=i.readVarint()+i.pos,o=1,c=0,p=0,_=0,v=1/0,b=-1/0,S=1/0,k=-1/0;i.pos<r;){if(c<=0){var E=i.readVarint();o=7&E,c=E>>3}if(c--,o===1||o===2)(p+=i.readSVarint())<v&&(v=p),p>b&&(b=p),(_+=i.readSVarint())<S&&(S=_),_>k&&(k=_);else if(o!==7)throw new Error("unknown command "+o)}return[v,S,b,k]},Bc.prototype.toGeoJSON=function(i,r,o){var c,p,_=this.extent*Math.pow(2,o),v=this.extent*i,b=this.extent*r,S=this.loadGeometry(),k=Bc.types[this.type];function E(O){for(var j=0;j<O.length;j++){var V=O[j];O[j]=[360*(V.x+v)/_-180,360/Math.PI*Math.atan(Math.exp((180-360*(V.y+b)/_)*Math.PI/180))-90]}}switch(this.type){case 1:var A=[];for(c=0;c<S.length;c++)A[c]=S[c][0];E(S=A);break;case 2:for(c=0;c<S.length;c++)E(S[c]);break;case 3:for(S=function(O){var j=O.length;if(j<=1)return[O];for(var V,Y,re=[],ye=0;ye<j;ye++){var ce=xE(O[ye]);ce!==0&&(Y===void 0&&(Y=ce<0),Y===ce<0?(V&&re.push(V),V=[O[ye]]):V.push(O[ye]))}return V&&re.push(V),re}(S),c=0;c<S.length;c++)for(p=0;p<S[c].length;p++)E(S[c][p])}S.length===1?S=S[0]:k="Multi"+k;var R={type:"Feature",geometry:{type:k,coordinates:S},properties:this.properties};return"id"in this&&(R.id=this.id),R};var bE=Xx,Yx=Jx;function Jx(i,r){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(wE,this,r),this.length=this._features.length}function wE(i,r,o){i===15?r.version=o.readVarint():i===1?r.name=o.readString():i===5?r.extent=o.readVarint():i===2?r._features.push(o.pos):i===3?r._keys.push(o.readString()):i===4&&r._values.push(function(c){for(var p=null,_=c.readVarint()+c.pos;c.pos<_;){var v=c.readVarint()>>3;p=v===1?c.readString():v===2?c.readFloat():v===3?c.readDouble():v===4?c.readVarint64():v===5?c.readVarint():v===6?c.readSVarint():v===7?c.readBoolean():null}return p}(o))}Jx.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var r=this._pbf.readVarint()+this._pbf.pos;return new bE(this._pbf,r,this.extent,this._keys,this._values)};var SE=Yx;function TE(i,r,o){if(i===3){var c=new SE(o,o.readVarint()+o.pos);c.length&&(r[c.name]=c)}}Pa.VectorTile=function(i,r){this.layers=i.readFields(TE,{},r)},Pa.VectorTileFeature=Xx,Pa.VectorTileLayer=Yx;const CE=Pa.VectorTileFeature.types,Cy=Math.pow(2,13);function $h(i,r,o,c,p,_,v,b){i.emplaceBack(r,o,2*Math.floor(c*Cy)+v,p*Cy*2,_*Cy*2,Math.round(b))}class ky{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(o=>o.id),this.index=r.index,this.hasPattern=!1,this.layoutVertexArray=new Sa,this.centroidVertexArray=new xr,this.indexArray=new Wi,this.programConfigurations=new wl(r.layers,r.zoom),this.segments=new Ot,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(r,o,c){this.features=[],this.hasPattern=wy("fill-extrusion",this.layers,o);for(const{feature:p,id:_,index:v,sourceLayerIndex:b}of r){const S=this.layers[0]._featureFilter.needGeometry,k=Tl(p,S);if(!this.layers[0]._featureFilter.filter(new vn(this.zoom),k,c))continue;const E={id:_,sourceLayerIndex:b,index:v,geometry:S?k.geometry:Sl(p),properties:p.properties,type:p.type,patterns:{}};this.hasPattern?this.features.push(Sy("fill-extrusion",this.layers,E,this.zoom,o)):this.addFeature(E,E.geometry,v,c,{}),o.featureIndex.insert(p,E.geometry,v,b,this.index,!0)}}addFeatures(r,o,c){for(const p of this.features){const{geometry:_}=p;this.addFeature(p,_,p.index,o,c)}}update(r,o,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,o,this.stateDependentLayers,c)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,yE),this.centroidVertexBuffer=r.createVertexBuffer(this.centroidVertexArray,gE.members,!0),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(r,o,c,p,_){for(const v of sc(o,500)){const b={x:0,y:0,vertexCount:0};let S=0;for(const j of v)S+=j.length;let k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const j of v){if(j.length===0||EE(j))continue;let V=0;for(let Y=0;Y<j.length;Y++){const re=j[Y];if(Y>=1){const ye=j[Y-1];if(!kE(re,ye)){k.vertexLength+4>Ot.MAX_VERTEX_ARRAY_LENGTH&&(k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const ce=re.sub(ye)._perp()._unit(),me=ye.dist(re);V+me>32768&&(V=0),$h(this.layoutVertexArray,re.x,re.y,ce.x,ce.y,0,0,V),$h(this.layoutVertexArray,re.x,re.y,ce.x,ce.y,0,1,V),b.x+=2*re.x,b.y+=2*re.y,b.vertexCount+=2,V+=me,$h(this.layoutVertexArray,ye.x,ye.y,ce.x,ce.y,0,0,V),$h(this.layoutVertexArray,ye.x,ye.y,ce.x,ce.y,0,1,V),b.x+=2*ye.x,b.y+=2*ye.y,b.vertexCount+=2;const Ce=k.vertexLength;this.indexArray.emplaceBack(Ce,Ce+2,Ce+1),this.indexArray.emplaceBack(Ce+1,Ce+2,Ce+3),k.vertexLength+=4,k.primitiveLength+=2}}}}if(k.vertexLength+S>Ot.MAX_VERTEX_ARRAY_LENGTH&&(k=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray)),CE[r.type]!=="Polygon")continue;const E=[],A=[],R=k.vertexLength;for(const j of v)if(j.length!==0){j!==v[0]&&A.push(E.length/2);for(let V=0;V<j.length;V++){const Y=j[V];$h(this.layoutVertexArray,Y.x,Y.y,0,0,1,1,0),b.x+=Y.x,b.y+=Y.y,b.vertexCount+=1,E.push(Y.x),E.push(Y.y)}}const O=Vx(E,A);for(let j=0;j<O.length;j+=3)this.indexArray.emplaceBack(R+O[j],R+O[j+2],R+O[j+1]);k.primitiveLength+=O.length/3,k.vertexLength+=S;for(let j=0;j<b.vertexCount;j++){const V=Math.floor(b.x/b.vertexCount),Y=Math.floor(b.y/b.vertexCount);this.centroidVertexArray.emplaceBack(V,Y)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,c,_,p)}}function kE(i,r){return i.x===r.x&&(i.x<0||i.x>Wn)||i.y===r.y&&(i.y<0||i.y>Wn)}function EE(i){return i.every(r=>r.x<0)||i.every(r=>r.x>Wn)||i.every(r=>r.y<0)||i.every(r=>r.y>Wn)}let Qx;Qe("FillExtrusionBucket",ky,{omit:["layers","features"]});var IE={get paint(){return Qx=Qx||new g({"fill-extrusion-opacity":new rt(Se["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new gt(Se["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new rt(Se["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new rt(Se["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new kc(Se["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new gt(Se["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new gt(Se["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new rt(Se["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class PE extends a{constructor(r){super(r,IE)}createBucket(r){return new ky(r)}queryRadius(){return Hp(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(r,o,c,p,_,v,b,S){const k=Zp(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),v.angle,b),E=this.paint.get("fill-extrusion-height").evaluate(o,c),A=this.paint.get("fill-extrusion-base").evaluate(o,c),R=function(j,V,Y,re){const ye=[];for(const ce of j){const me=[ce.x,ce.y,0,1];Wp(me,me,V),ye.push(new N(me[0]/me[3],me[1]/me[3]))}return ye}(k,S),O=function(j,V,Y,re){const ye=[],ce=[],me=re[8]*V,Ce=re[9]*V,Le=re[10]*V,Xe=re[11]*V,ft=re[8]*Y,We=re[9]*Y,qe=re[10]*Y,st=re[11]*Y;for(const nt of j){const Je=[],Ie=[];for(const at of nt){const ot=at.x,bt=at.y,cn=re[0]*ot+re[4]*bt+re[12],on=re[1]*ot+re[5]*bt+re[13],or=re[2]*ot+re[6]*bt+re[14],vo=re[3]*ot+re[7]*bt+re[15],Sr=or+Le,sr=vo+Xe,Kr=cn+ft,Xr=on+We,Yr=or+qe,Bn=vo+st,ar=new N((cn+me)/sr,(on+Ce)/sr);ar.z=Sr/sr,Je.push(ar);const Fr=new N(Kr/Bn,Xr/Bn);Fr.z=Yr/Bn,Ie.push(Fr)}ye.push(Je),ce.push(Ie)}return[ye,ce]}(p,A,E,S);return function(j,V,Y){let re=1/0;Mx(Y,V)&&(re=e1(Y,V[0]));for(let ye=0;ye<V.length;ye++){const ce=V[ye],me=j[ye];for(let Ce=0;Ce<ce.length-1;Ce++){const Le=ce[Ce],Xe=[Le,ce[Ce+1],me[Ce+1],me[Ce],Le];Ax(Y,Xe)&&(re=Math.min(re,e1(Y,Xe)))}}return re!==1/0&&re}(O[0],O[1],R)}}function jh(i,r){return i.x*r.x+i.y*r.y}function e1(i,r){if(i.length===1){let o=0;const c=r[o++];let p;for(;!p||c.equals(p);)if(p=r[o++],!p)return 1/0;for(;o<r.length;o++){const _=r[o],v=i[0],b=p.sub(c),S=_.sub(c),k=v.sub(c),E=jh(b,b),A=jh(b,S),R=jh(S,S),O=jh(k,b),j=jh(k,S),V=E*R-A*A,Y=(R*O-A*j)/V,re=(E*j-A*O)/V,ye=c.z*(1-Y-re)+p.z*Y+_.z*re;if(isFinite(ye))return ye}return 1/0}{let o=1/0;for(const c of r)o=Math.min(o,c.z);return o}}const AE=w([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:ME}=AE,zE=w([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:LE}=zE,RE=Pa.VectorTileFeature.types,DE=Math.cos(Math.PI/180*37.5),t1=Math.pow(2,14)/.5;class Ey{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(o=>o.id),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new Ic,this.layoutVertexArray2=new Ta,this.indexArray=new Wi,this.programConfigurations=new wl(r.layers,r.zoom),this.segments=new Ot,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(r,o,c){this.hasPattern=wy("line",this.layers,o);const p=this.layers[0].layout.get("line-sort-key"),_=!p.isConstant(),v=[];for(const{feature:b,id:S,index:k,sourceLayerIndex:E}of r){const A=this.layers[0]._featureFilter.needGeometry,R=Tl(b,A);if(!this.layers[0]._featureFilter.filter(new vn(this.zoom),R,c))continue;const O=_?p.evaluate(R,{},c):void 0,j={id:S,properties:b.properties,type:b.type,sourceLayerIndex:E,index:k,geometry:A?R.geometry:Sl(b),patterns:{},sortKey:O};v.push(j)}_&&v.sort((b,S)=>b.sortKey-S.sortKey);for(const b of v){const{geometry:S,index:k,sourceLayerIndex:E}=b;if(this.hasPattern){const A=Sy("line",this.layers,b,this.zoom,o);this.patternFeatures.push(A)}else this.addFeature(b,S,k,c,{});o.featureIndex.insert(r[k].feature,S,k,E,this.index)}}update(r,o,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,o,this.stateDependentLayers,c)}addFeatures(r,o,c){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,o,c)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=r.createVertexBuffer(this.layoutVertexArray2,LE)),this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,ME),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(r){if(r.properties&&Object.prototype.hasOwnProperty.call(r.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(r.properties,"mapbox_clip_end"))return{start:+r.properties.mapbox_clip_start,end:+r.properties.mapbox_clip_end}}addFeature(r,o,c,p,_){const v=this.layers[0].layout,b=v.get("line-join").evaluate(r,{}),S=v.get("line-cap"),k=v.get("line-miter-limit"),E=v.get("line-round-limit");this.lineClips=this.lineFeatureClips(r);for(const A of o)this.addLine(A,r,b,S,k,E);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,c,_,p)}addLine(r,o,c,p,_,v){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let re=0;re<r.length-1;re++)this.totalDistance+=r[re].dist(r[re+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const b=RE[o.type]==="Polygon";let S=r.length;for(;S>=2&&r[S-1].equals(r[S-2]);)S--;let k=0;for(;k<S-1&&r[k].equals(r[k+1]);)k++;if(S<(b?3:2))return;c==="bevel"&&(_=1.05);const E=this.overscaling<=16?15*Wn/(512*this.overscaling):0,A=this.segments.prepareSegment(10*S,this.layoutVertexArray,this.indexArray);let R,O,j,V,Y;this.e1=this.e2=-1,b&&(R=r[S-2],Y=r[k].sub(R)._unit()._perp());for(let re=k;re<S;re++){if(j=re===S-1?b?r[k+1]:void 0:r[re+1],j&&r[re].equals(j))continue;Y&&(V=Y),R&&(O=R),R=r[re],Y=j?j.sub(R)._unit()._perp():V,V=V||Y;let ye=V.add(Y);ye.x===0&&ye.y===0||ye._unit();const ce=V.x*Y.x+V.y*Y.y,me=ye.x*Y.x+ye.y*Y.y,Ce=me!==0?1/me:1/0,Le=2*Math.sqrt(2-2*me),Xe=me<DE&&O&&j,ft=V.x*Y.y-V.y*Y.x>0;if(Xe&&re>k){const st=R.dist(O);if(st>2*E){const nt=R.sub(R.sub(O)._mult(E/st)._round());this.updateDistance(O,nt),this.addCurrentVertex(nt,V,0,0,A),O=nt}}const We=O&&j;let qe=We?c:b?"butt":p;if(We&&qe==="round"&&(Ce<v?qe="miter":Ce<=2&&(qe="fakeround")),qe==="miter"&&Ce>_&&(qe="bevel"),qe==="bevel"&&(Ce>2&&(qe="flipbevel"),Ce<_&&(qe="miter")),O&&this.updateDistance(O,R),qe==="miter")ye._mult(Ce),this.addCurrentVertex(R,ye,0,0,A);else if(qe==="flipbevel"){if(Ce>100)ye=Y.mult(-1);else{const st=Ce*V.add(Y).mag()/V.sub(Y).mag();ye._perp()._mult(st*(ft?-1:1))}this.addCurrentVertex(R,ye,0,0,A),this.addCurrentVertex(R,ye.mult(-1),0,0,A)}else if(qe==="bevel"||qe==="fakeround"){const st=-Math.sqrt(Ce*Ce-1),nt=ft?st:0,Je=ft?0:st;if(O&&this.addCurrentVertex(R,V,nt,Je,A),qe==="fakeround"){const Ie=Math.round(180*Le/Math.PI/20);for(let at=1;at<Ie;at++){let ot=at/Ie;if(ot!==.5){const cn=ot-.5;ot+=ot*cn*(ot-1)*((1.0904+ce*(ce*(3.55645-1.43519*ce)-3.2452))*cn*cn+(.848013+ce*(.215638*ce-1.06021)))}const bt=Y.sub(V)._mult(ot)._add(V)._unit()._mult(ft?-1:1);this.addHalfVertex(R,bt.x,bt.y,!1,ft,0,A)}}j&&this.addCurrentVertex(R,Y,-nt,-Je,A)}else if(qe==="butt")this.addCurrentVertex(R,ye,0,0,A);else if(qe==="square"){const st=O?1:-1;this.addCurrentVertex(R,ye,st,st,A)}else qe==="round"&&(O&&(this.addCurrentVertex(R,V,0,0,A),this.addCurrentVertex(R,V,1,1,A,!0)),j&&(this.addCurrentVertex(R,Y,-1,-1,A,!0),this.addCurrentVertex(R,Y,0,0,A)));if(Xe&&re<S-1){const st=R.dist(j);if(st>2*E){const nt=R.add(j.sub(R)._mult(E/st)._round());this.updateDistance(R,nt),this.addCurrentVertex(nt,Y,0,0,A),R=nt}}}}addCurrentVertex(r,o,c,p,_,v=!1){const b=o.y*p-o.x,S=-o.y-o.x*p;this.addHalfVertex(r,o.x+o.y*c,o.y-o.x*c,v,!1,c,_),this.addHalfVertex(r,b,S,v,!0,-p,_),this.distance>t1/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(r,o,c,p,_,v))}addHalfVertex({x:r,y:o},c,p,_,v,b,S){const k=.5*(this.lineClips?this.scaledDistance*(t1-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((r<<1)+(_?1:0),(o<<1)+(v?1:0),Math.round(63*c)+128,Math.round(63*p)+128,1+(b===0?0:b<0?-1:1)|(63&k)<<2,k>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const E=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,E),S.primitiveLength++),v?this.e2=E:this.e1=E}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(r,o){this.distance+=r.dist(o),this.updateScaledDistance()}}let n1,r1;Qe("LineBucket",Ey,{omit:["layers","patternFeatures"]});var i1={get paint(){return r1=r1||new g({"line-opacity":new gt(Se.paint_line["line-opacity"]),"line-color":new gt(Se.paint_line["line-color"]),"line-translate":new rt(Se.paint_line["line-translate"]),"line-translate-anchor":new rt(Se.paint_line["line-translate-anchor"]),"line-width":new gt(Se.paint_line["line-width"]),"line-gap-width":new gt(Se.paint_line["line-gap-width"]),"line-offset":new gt(Se.paint_line["line-offset"]),"line-blur":new gt(Se.paint_line["line-blur"]),"line-dasharray":new Ec(Se.paint_line["line-dasharray"]),"line-pattern":new kc(Se.paint_line["line-pattern"]),"line-gradient":new Mh(Se.paint_line["line-gradient"])})},get layout(){return n1=n1||new g({"line-cap":new rt(Se.layout_line["line-cap"]),"line-join":new gt(Se.layout_line["line-join"]),"line-miter-limit":new rt(Se.layout_line["line-miter-limit"]),"line-round-limit":new rt(Se.layout_line["line-round-limit"]),"line-sort-key":new gt(Se.layout_line["line-sort-key"])})}};class FE extends gt{possiblyEvaluate(r,o){return o=new vn(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,zoomHistory:o.zoomHistory,transition:o.transition}),super.possiblyEvaluate(r,o)}evaluate(r,o,c,p){return o=xe({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(r,o,c,p)}}let Jp;class BE extends a{constructor(r){super(r,i1),this.gradientVersion=0,Jp||(Jp=new FE(i1.paint.properties["line-width"].specification),Jp.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(r){if(r==="line-gradient"){const o=this.gradientExpression();this.stepInterpolant=!!function(c){return c._styleExpression!==void 0}(o)&&o._styleExpression.expression instanceof ia,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(r,o){super.recalculate(r,o),this.paint._values["line-floorwidth"]=Jp.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)}createBucket(r){return new Ey(r)}queryRadius(r){const o=r,c=o1(Rh("line-width",this,o),Rh("line-gap-width",this,o)),p=Rh("line-offset",this,o);return c/2+Math.abs(p)+Hp(this.paint.get("line-translate"))}queryIntersectsFeature(r,o,c,p,_,v,b){const S=Zp(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),v.angle,b),k=b/2*o1(this.paint.get("line-width").evaluate(o,c),this.paint.get("line-gap-width").evaluate(o,c)),E=this.paint.get("line-offset").evaluate(o,c);return E&&(p=function(A,R){const O=[];for(let j=0;j<A.length;j++){const V=A[j],Y=[];for(let re=0;re<V.length;re++){const ye=V[re-1],ce=V[re],me=V[re+1],Ce=re===0?new N(0,0):ce.sub(ye)._unit()._perp(),Le=re===V.length-1?new N(0,0):me.sub(ce)._unit()._perp(),Xe=Ce._add(Le)._unit(),ft=Xe.x*Le.x+Xe.y*Le.y;ft!==0&&Xe._mult(1/ft),Y.push(Xe._mult(R)._add(ce))}O.push(Y)}return O}(p,E*b)),function(A,R,O){for(let j=0;j<R.length;j++){const V=R[j];if(A.length>=3){for(let Y=0;Y<V.length;Y++)if(Rc(A,V[Y]))return!0}if(Hk(A,V,O))return!0}return!1}(S,p,k)}isTileClipped(){return!0}}function o1(i,r){return r>0?r+2*i:i}const OE=w([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),NE=w([{name:"a_projected_pos",components:3,type:"Float32"}],4);w([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const $E=w([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);w([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const s1=w([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),jE=w([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function UE(i,r,o){return i.sections.forEach(c=>{c.text=function(p,_,v){const b=_.layout.get("text-transform").evaluate(v,{});return b==="uppercase"?p=p.toLocaleUpperCase():b==="lowercase"&&(p=p.toLocaleLowerCase()),di.applyArabicShaping&&(p=di.applyArabicShaping(p)),p}(c.text,r,o)}),i}w([{name:"triangle",components:3,type:"Uint16"}]),w([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),w([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),w([{type:"Float32",name:"offsetX"}]),w([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),w([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Uh={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var Jn=24,a1=rn,l1=function(i,r,o,c,p){var _,v,b=8*p-c-1,S=(1<<b)-1,k=S>>1,E=-7,A=p-1,R=-1,O=i[r+A];for(A+=R,_=O&(1<<-E)-1,O>>=-E,E+=b;E>0;_=256*_+i[r+A],A+=R,E-=8);for(v=_&(1<<-E)-1,_>>=-E,E+=c;E>0;v=256*v+i[r+A],A+=R,E-=8);if(_===0)_=1-k;else{if(_===S)return v?NaN:1/0*(O?-1:1);v+=Math.pow(2,c),_-=k}return(O?-1:1)*v*Math.pow(2,_-c)},c1=function(i,r,o,c,p,_){var v,b,S,k=8*_-p-1,E=(1<<k)-1,A=E>>1,R=p===23?Math.pow(2,-24)-Math.pow(2,-77):0,O=0,j=1,V=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(b=isNaN(r)?1:0,v=E):(v=Math.floor(Math.log(r)/Math.LN2),r*(S=Math.pow(2,-v))<1&&(v--,S*=2),(r+=v+A>=1?R/S:R*Math.pow(2,1-A))*S>=2&&(v++,S/=2),v+A>=E?(b=0,v=E):v+A>=1?(b=(r*S-1)*Math.pow(2,p),v+=A):(b=r*Math.pow(2,A-1)*Math.pow(2,p),v=0));p>=8;i[o+O]=255&b,O+=j,b/=256,p-=8);for(v=v<<p|b,k+=p;k>0;i[o+O]=255&v,O+=j,v/=256,k-=8);i[o+O-j]|=128*V};function rn(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}rn.Varint=0,rn.Fixed64=1,rn.Bytes=2,rn.Fixed32=5;var Iy=4294967296,u1=1/Iy,h1=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function Ns(i){return i.type===rn.Bytes?i.readVarint()+i.pos:i.pos+1}function Oc(i,r,o){return o?4294967296*r+(i>>>0):4294967296*(r>>>0)+(i>>>0)}function d1(i,r,o){var c=r<=16383?1:r<=2097151?2:r<=268435455?3:Math.floor(Math.log(r)/(7*Math.LN2));o.realloc(c);for(var p=o.pos-1;p>=i;p--)o.buf[p+c]=o.buf[p]}function VE(i,r){for(var o=0;o<i.length;o++)r.writeVarint(i[o])}function GE(i,r){for(var o=0;o<i.length;o++)r.writeSVarint(i[o])}function qE(i,r){for(var o=0;o<i.length;o++)r.writeFloat(i[o])}function HE(i,r){for(var o=0;o<i.length;o++)r.writeDouble(i[o])}function ZE(i,r){for(var o=0;o<i.length;o++)r.writeBoolean(i[o])}function WE(i,r){for(var o=0;o<i.length;o++)r.writeFixed32(i[o])}function KE(i,r){for(var o=0;o<i.length;o++)r.writeSFixed32(i[o])}function XE(i,r){for(var o=0;o<i.length;o++)r.writeFixed64(i[o])}function YE(i,r){for(var o=0;o<i.length;o++)r.writeSFixed64(i[o])}function Qp(i,r){return(i[r]|i[r+1]<<8|i[r+2]<<16)+16777216*i[r+3]}function Nc(i,r,o){i[o]=r,i[o+1]=r>>>8,i[o+2]=r>>>16,i[o+3]=r>>>24}function p1(i,r){return(i[r]|i[r+1]<<8|i[r+2]<<16)+(i[r+3]<<24)}rn.prototype={destroy:function(){this.buf=null},readFields:function(i,r,o){for(o=o||this.length;this.pos<o;){var c=this.readVarint(),p=c>>3,_=this.pos;this.type=7&c,i(p,r,this),this.pos===_&&this.skip(c)}return r},readMessage:function(i,r){return this.readFields(i,r,this.readVarint()+this.pos)},readFixed32:function(){var i=Qp(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=p1(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=Qp(this.buf,this.pos)+Qp(this.buf,this.pos+4)*Iy;return this.pos+=8,i},readSFixed64:function(){var i=Qp(this.buf,this.pos)+p1(this.buf,this.pos+4)*Iy;return this.pos+=8,i},readFloat:function(){var i=l1(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=l1(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var r,o,c=this.buf;return r=127&(o=c[this.pos++]),o<128?r:(r|=(127&(o=c[this.pos++]))<<7,o<128?r:(r|=(127&(o=c[this.pos++]))<<14,o<128?r:(r|=(127&(o=c[this.pos++]))<<21,o<128?r:function(p,_,v){var b,S,k=v.buf;if(b=(112&(S=k[v.pos++]))>>4,S<128||(b|=(127&(S=k[v.pos++]))<<3,S<128)||(b|=(127&(S=k[v.pos++]))<<10,S<128)||(b|=(127&(S=k[v.pos++]))<<17,S<128)||(b|=(127&(S=k[v.pos++]))<<24,S<128)||(b|=(1&(S=k[v.pos++]))<<31,S<128))return Oc(p,b,_);throw new Error("Expected varint not more than 10 bytes")}(r|=(15&(o=c[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?(i+1)/-2:i/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var i=this.readVarint()+this.pos,r=this.pos;return this.pos=i,i-r>=12&&h1?function(o,c,p){return h1.decode(o.subarray(c,p))}(this.buf,r,i):function(o,c,p){for(var _="",v=c;v<p;){var b,S,k,E=o[v],A=null,R=E>239?4:E>223?3:E>191?2:1;if(v+R>p)break;R===1?E<128&&(A=E):R===2?(192&(b=o[v+1]))==128&&(A=(31&E)<<6|63&b)<=127&&(A=null):R===3?(S=o[v+2],(192&(b=o[v+1]))==128&&(192&S)==128&&((A=(15&E)<<12|(63&b)<<6|63&S)<=2047||A>=55296&&A<=57343)&&(A=null)):R===4&&(S=o[v+2],k=o[v+3],(192&(b=o[v+1]))==128&&(192&S)==128&&(192&k)==128&&((A=(15&E)<<18|(63&b)<<12|(63&S)<<6|63&k)<=65535||A>=1114112)&&(A=null)),A===null?(A=65533,R=1):A>65535&&(A-=65536,_+=String.fromCharCode(A>>>10&1023|55296),A=56320|1023&A),_+=String.fromCharCode(A),v+=R}return _}(this.buf,r,i)},readBytes:function(){var i=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,i);return this.pos=i,r},readPackedVarint:function(i,r){if(this.type!==rn.Bytes)return i.push(this.readVarint(r));var o=Ns(this);for(i=i||[];this.pos<o;)i.push(this.readVarint(r));return i},readPackedSVarint:function(i){if(this.type!==rn.Bytes)return i.push(this.readSVarint());var r=Ns(this);for(i=i||[];this.pos<r;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==rn.Bytes)return i.push(this.readBoolean());var r=Ns(this);for(i=i||[];this.pos<r;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==rn.Bytes)return i.push(this.readFloat());var r=Ns(this);for(i=i||[];this.pos<r;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==rn.Bytes)return i.push(this.readDouble());var r=Ns(this);for(i=i||[];this.pos<r;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==rn.Bytes)return i.push(this.readFixed32());var r=Ns(this);for(i=i||[];this.pos<r;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==rn.Bytes)return i.push(this.readSFixed32());var r=Ns(this);for(i=i||[];this.pos<r;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==rn.Bytes)return i.push(this.readFixed64());var r=Ns(this);for(i=i||[];this.pos<r;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==rn.Bytes)return i.push(this.readSFixed64());var r=Ns(this);for(i=i||[];this.pos<r;)i.push(this.readSFixed64());return i},skip:function(i){var r=7&i;if(r===rn.Varint)for(;this.buf[this.pos++]>127;);else if(r===rn.Bytes)this.pos=this.readVarint()+this.pos;else if(r===rn.Fixed32)this.pos+=4;else{if(r!==rn.Fixed64)throw new Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(i,r){this.writeVarint(i<<3|r)},realloc:function(i){for(var r=this.length||16;r<this.pos+i;)r*=2;if(r!==this.length){var o=new Uint8Array(r);o.set(this.buf),this.buf=o,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),Nc(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),Nc(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),Nc(this.buf,-1&i,this.pos),Nc(this.buf,Math.floor(i*u1),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),Nc(this.buf,-1&i,this.pos),Nc(this.buf,Math.floor(i*u1),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?function(r,o){var c,p;if(r>=0?(c=r%4294967296|0,p=r/4294967296|0):(p=~(-r/4294967296),4294967295^(c=~(-r%4294967296))?c=c+1|0:(c=0,p=p+1|0)),r>=18446744073709552e3||r<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");o.realloc(10),function(_,v,b){b.buf[b.pos++]=127&_|128,_>>>=7,b.buf[b.pos++]=127&_|128,_>>>=7,b.buf[b.pos++]=127&_|128,_>>>=7,b.buf[b.pos++]=127&_|128,b.buf[b.pos]=127&(_>>>=7)}(c,0,o),function(_,v){var b=(7&_)<<4;v.buf[v.pos++]|=b|((_>>>=3)?128:0),_&&(v.buf[v.pos++]=127&_|((_>>>=7)?128:0),_&&(v.buf[v.pos++]=127&_|((_>>>=7)?128:0),_&&(v.buf[v.pos++]=127&_|((_>>>=7)?128:0),_&&(v.buf[v.pos++]=127&_|((_>>>=7)?128:0),_&&(v.buf[v.pos++]=127&_)))))}(p,o)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?2*-i-1:2*i)},writeBoolean:function(i){this.writeVarint(!!i)},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var r=this.pos;this.pos=function(c,p,_){for(var v,b,S=0;S<p.length;S++){if((v=p.charCodeAt(S))>55295&&v<57344){if(!b){v>56319||S+1===p.length?(c[_++]=239,c[_++]=191,c[_++]=189):b=v;continue}if(v<56320){c[_++]=239,c[_++]=191,c[_++]=189,b=v;continue}v=b-55296<<10|v-56320|65536,b=null}else b&&(c[_++]=239,c[_++]=191,c[_++]=189,b=null);v<128?c[_++]=v:(v<2048?c[_++]=v>>6|192:(v<65536?c[_++]=v>>12|224:(c[_++]=v>>18|240,c[_++]=v>>12&63|128),c[_++]=v>>6&63|128),c[_++]=63&v|128)}return _}(this.buf,i,this.pos);var o=this.pos-r;o>=128&&d1(r,o,this),this.pos=r-1,this.writeVarint(o),this.pos+=o},writeFloat:function(i){this.realloc(4),c1(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),c1(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var r=i.length;this.writeVarint(r),this.realloc(r);for(var o=0;o<r;o++)this.buf[this.pos++]=i[o]},writeRawMessage:function(i,r){this.pos++;var o=this.pos;i(r,this);var c=this.pos-o;c>=128&&d1(o,c,this),this.pos=o-1,this.writeVarint(c),this.pos+=c},writeMessage:function(i,r,o){this.writeTag(i,rn.Bytes),this.writeRawMessage(r,o)},writePackedVarint:function(i,r){r.length&&this.writeMessage(i,VE,r)},writePackedSVarint:function(i,r){r.length&&this.writeMessage(i,GE,r)},writePackedBoolean:function(i,r){r.length&&this.writeMessage(i,ZE,r)},writePackedFloat:function(i,r){r.length&&this.writeMessage(i,qE,r)},writePackedDouble:function(i,r){r.length&&this.writeMessage(i,HE,r)},writePackedFixed32:function(i,r){r.length&&this.writeMessage(i,WE,r)},writePackedSFixed32:function(i,r){r.length&&this.writeMessage(i,KE,r)},writePackedFixed64:function(i,r){r.length&&this.writeMessage(i,XE,r)},writePackedSFixed64:function(i,r){r.length&&this.writeMessage(i,YE,r)},writeBytesField:function(i,r){this.writeTag(i,rn.Bytes),this.writeBytes(r)},writeFixed32Field:function(i,r){this.writeTag(i,rn.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(i,r){this.writeTag(i,rn.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(i,r){this.writeTag(i,rn.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(i,r){this.writeTag(i,rn.Fixed64),this.writeSFixed64(r)},writeVarintField:function(i,r){this.writeTag(i,rn.Varint),this.writeVarint(r)},writeSVarintField:function(i,r){this.writeTag(i,rn.Varint),this.writeSVarint(r)},writeStringField:function(i,r){this.writeTag(i,rn.Bytes),this.writeString(r)},writeFloatField:function(i,r){this.writeTag(i,rn.Fixed32),this.writeFloat(r)},writeDoubleField:function(i,r){this.writeTag(i,rn.Fixed64),this.writeDouble(r)},writeBooleanField:function(i,r){this.writeVarintField(i,!!r)}};var Py=P(a1);const Ay=3;function JE(i,r,o){i===1&&o.readMessage(QE,r)}function QE(i,r,o){if(i===3){const{id:c,bitmap:p,width:_,height:v,left:b,top:S,advance:k}=o.readMessage(eI,{});r.push({id:c,bitmap:new Fh({width:_+2*Ay,height:v+2*Ay},p),metrics:{width:_,height:v,left:b,top:S,advance:k}})}}function eI(i,r,o){i===1?r.id=o.readVarint():i===2?r.bitmap=o.readBytes():i===3?r.width=o.readVarint():i===4?r.height=o.readVarint():i===5?r.left=o.readSVarint():i===6?r.top=o.readSVarint():i===7&&(r.advance=o.readVarint())}const f1=Ay;function m1(i){let r=0,o=0;for(const v of i)r+=v.w*v.h,o=Math.max(o,v.w);i.sort((v,b)=>b.h-v.h);const c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(r/.95)),o),h:1/0}];let p=0,_=0;for(const v of i)for(let b=c.length-1;b>=0;b--){const S=c[b];if(!(v.w>S.w||v.h>S.h)){if(v.x=S.x,v.y=S.y,_=Math.max(_,v.y+v.h),p=Math.max(p,v.x+v.w),v.w===S.w&&v.h===S.h){const k=c.pop();b<c.length&&(c[b]=k)}else v.h===S.h?(S.x+=v.w,S.w-=v.w):v.w===S.w?(S.y+=v.h,S.h-=v.h):(c.push({x:S.x+v.w,y:S.y,w:S.w-v.w,h:v.h}),S.y+=v.h,S.h-=v.h);break}}return{w:p,h:_,fill:r/(p*_)||0}}const fi=1;class My{constructor(r,{pixelRatio:o,version:c,stretchX:p,stretchY:_,content:v,textFitWidth:b,textFitHeight:S}){this.paddedRect=r,this.pixelRatio=o,this.stretchX=p,this.stretchY=_,this.content=v,this.version=c,this.textFitWidth=b,this.textFitHeight=S}get tl(){return[this.paddedRect.x+fi,this.paddedRect.y+fi]}get br(){return[this.paddedRect.x+this.paddedRect.w-fi,this.paddedRect.y+this.paddedRect.h-fi]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*fi)/this.pixelRatio,(this.paddedRect.h-2*fi)/this.pixelRatio]}}class g1{constructor(r,o){const c={},p={};this.haveRenderCallbacks=[];const _=[];this.addImages(r,c,_),this.addImages(o,p,_);const{w:v,h:b}=m1(_),S=new Ki({width:v||1,height:b||1});for(const k in r){const E=r[k],A=c[k].paddedRect;Ki.copy(E.data,S,{x:0,y:0},{x:A.x+fi,y:A.y+fi},E.data)}for(const k in o){const E=o[k],A=p[k].paddedRect,R=A.x+fi,O=A.y+fi,j=E.data.width,V=E.data.height;Ki.copy(E.data,S,{x:0,y:0},{x:R,y:O},E.data),Ki.copy(E.data,S,{x:0,y:V-1},{x:R,y:O-1},{width:j,height:1}),Ki.copy(E.data,S,{x:0,y:0},{x:R,y:O+V},{width:j,height:1}),Ki.copy(E.data,S,{x:j-1,y:0},{x:R-1,y:O},{width:1,height:V}),Ki.copy(E.data,S,{x:0,y:0},{x:R+j,y:O},{width:1,height:V})}this.image=S,this.iconPositions=c,this.patternPositions=p}addImages(r,o,c){for(const p in r){const _=r[p],v={x:0,y:0,w:_.data.width+2*fi,h:_.data.height+2*fi};c.push(v),o[p]=new My(v,_),_.hasRenderCallback&&this.haveRenderCallbacks.push(p)}}patchUpdatedImages(r,o){r.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const c in r.updatedImages)this.patchUpdatedImage(this.iconPositions[c],r.getImage(c),o),this.patchUpdatedImage(this.patternPositions[c],r.getImage(c),o)}patchUpdatedImage(r,o,c){if(!r||!o||r.version===o.version)return;r.version=o.version;const[p,_]=r.tl;c.update(o.data,void 0,{x:p,y:_})}}var Aa;Qe("ImagePosition",My),Qe("ImageAtlas",g1),x.ah=void 0,(Aa=x.ah||(x.ah={}))[Aa.none=0]="none",Aa[Aa.horizontal=1]="horizontal",Aa[Aa.vertical=2]="vertical",Aa[Aa.horizontalOnly=3]="horizontalOnly";const Vh=-17;class Gh{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(r,o){const c=new Gh;return c.scale=r||1,c.fontStack=o,c}static forImage(r){const o=new Gh;return o.imageName=r,o}}class $c{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(r,o){const c=new $c;for(let p=0;p<r.sections.length;p++){const _=r.sections[p];_.image?c.addImageSection(_):c.addTextSection(_,o)}return c}length(){return this.text.length}getSection(r){return this.sections[this.sectionIndex[r]]}getSectionIndex(r){return this.sectionIndex[r]}getCharCode(r){return this.text.charCodeAt(r)}verticalizePunctuation(){this.text=function(r){let o="";for(let c=0;c<r.length;c++){const p=r.charCodeAt(c+1)||null,_=r.charCodeAt(c-1)||null;o+=p&&Np(p)&&!Uh[r[c+1]]||_&&Np(_)&&!Uh[r[c-1]]||!Uh[r[c]]?r[c]:Uh[r[c]]}return o}(this.text)}trim(){let r=0;for(let c=0;c<this.text.length&&tf[this.text.charCodeAt(c)];c++)r++;let o=this.text.length;for(let c=this.text.length-1;c>=0&&c>=r&&tf[this.text.charCodeAt(c)];c--)o--;this.text=this.text.substring(r,o),this.sectionIndex=this.sectionIndex.slice(r,o)}substring(r,o){const c=new $c;return c.text=this.text.substring(r,o),c.sectionIndex=this.sectionIndex.slice(r,o),c.sections=this.sections,c}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((r,o)=>Math.max(r,this.sections[o].scale),0)}addTextSection(r,o){this.text+=r.text,this.sections.push(Gh.forText(r.scale,r.fontStack||o));const c=this.sections.length-1;for(let p=0;p<r.text.length;++p)this.sectionIndex.push(c)}addImageSection(r){const o=r.image?r.image.name:"";if(o.length===0)return void dt("Can't add FormattedSection with an empty image.");const c=this.getNextImageSectionCharCode();c?(this.text+=String.fromCharCode(c),this.sections.push(Gh.forImage(o)),this.sectionIndex.push(this.sections.length-1)):dt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function ef(i,r,o,c,p,_,v,b,S,k,E,A,R,O,j){const V=$c.fromFeature(i,p);let Y;A===x.ah.vertical&&V.verticalizePunctuation();const{processBidirectionalText:re,processStyledBidirectionalText:ye}=di;if(re&&V.sections.length===1){Y=[];const Ce=re(V.toString(),zy(V,k,_,r,c,O));for(const Le of Ce){const Xe=new $c;Xe.text=Le,Xe.sections=V.sections;for(let ft=0;ft<Le.length;ft++)Xe.sectionIndex.push(0);Y.push(Xe)}}else if(ye){Y=[];const Ce=ye(V.text,V.sectionIndex,zy(V,k,_,r,c,O));for(const Le of Ce){const Xe=new $c;Xe.text=Le[0],Xe.sectionIndex=Le[1],Xe.sections=V.sections,Y.push(Xe)}}else Y=function(Ce,Le){const Xe=[],ft=Ce.text;let We=0;for(const qe of Le)Xe.push(Ce.substring(We,qe)),We=qe;return We<ft.length&&Xe.push(Ce.substring(We,ft.length)),Xe}(V,zy(V,k,_,r,c,O));const ce=[],me={positionedLines:ce,text:V.toString(),top:E[1],bottom:E[1],left:E[0],right:E[0],writingMode:A,iconsInText:!1,verticalizable:!1};return function(Ce,Le,Xe,ft,We,qe,st,nt,Je,Ie,at,ot){let bt=0,cn=Vh,on=0,or=0;const vo=nt==="right"?1:nt==="left"?0:.5;let Sr=0;for(const Bn of We){Bn.trim();const ar=Bn.getMaxScale(),Fr=(ar-1)*Jn,Tr={positionedGlyphs:[],lineOffset:0};Ce.positionedLines[Sr]=Tr;const Jr=Tr.positionedGlyphs;let Cr=0;if(!Bn.length()){cn+=qe,++Sr;continue}for(let mi=0;mi<Bn.length();mi++){const qt=Bn.getSection(mi),fn=Bn.getSectionIndex(mi),Sn=Bn.getCharCode(mi);let Ai=0,zn=null,Gc=null,ls=null,cs=Jn;const xo=!(Je===x.ah.horizontal||!at&&!Ph(Sn)||at&&(tf[Sn]||(sr=Sn,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(sr)))));if(qt.imageName){const Ji=ft[qt.imageName];if(!Ji)continue;ls=qt.imageName,Ce.iconsInText=Ce.iconsInText||!0,Gc=Ji.paddedRect;const pr=Ji.displaySize;qt.scale=qt.scale*Jn/ot,zn={width:pr[0],height:pr[1],left:fi,top:-f1,advance:xo?pr[1]:pr[0]},Ai=Fr+(Jn-pr[1]*qt.scale),cs=zn.advance;const $s=xo?pr[0]*qt.scale-Jn*ar:pr[1]*qt.scale-Jn*ar;$s>0&&$s>Cr&&(Cr=$s)}else{const Ji=Xe[qt.fontStack],pr=Ji&&Ji[Sn];if(pr&&pr.rect)Gc=pr.rect,zn=pr.metrics;else{const $s=Le[qt.fontStack],Xh=$s&&$s[Sn];if(!Xh)continue;zn=Xh.metrics}Ai=(ar-qt.scale)*Jn}xo?(Ce.verticalizable=!0,Jr.push({glyph:Sn,imageName:ls,x:bt,y:cn+Ai,vertical:xo,scale:qt.scale,fontStack:qt.fontStack,sectionIndex:fn,metrics:zn,rect:Gc}),bt+=cs*qt.scale+Ie):(Jr.push({glyph:Sn,imageName:ls,x:bt,y:cn+Ai,vertical:xo,scale:qt.scale,fontStack:qt.fontStack,sectionIndex:fn,metrics:zn,rect:Gc}),bt+=zn.advance*qt.scale+Ie)}Jr.length!==0&&(on=Math.max(bt-Ie,on),iI(Jr,0,Jr.length-1,vo,Cr)),bt=0;const Yi=qe*ar+Cr;Tr.lineOffset=Math.max(Cr,Fr),cn+=Yi,or=Math.max(Yi,or),++Sr}var sr;const Kr=cn-Vh,{horizontalAlign:Xr,verticalAlign:Yr}=Ly(st);(function(Bn,ar,Fr,Tr,Jr,Cr,Yi,mi,qt){const fn=(ar-Fr)*Jr;let Sn=0;Sn=Cr!==Yi?-mi*Tr-Vh:(-Tr*qt+.5)*Yi;for(const Ai of Bn)for(const zn of Ai.positionedGlyphs)zn.x+=fn,zn.y+=Sn})(Ce.positionedLines,vo,Xr,Yr,on,or,qe,Kr,We.length),Ce.top+=-Yr*Kr,Ce.bottom=Ce.top+Kr,Ce.left+=-Xr*on,Ce.right=Ce.left+on}(me,r,o,c,Y,v,b,S,A,k,R,j),!function(Ce){for(const Le of Ce)if(Le.positionedGlyphs.length!==0)return!1;return!0}(ce)&&me}const tf={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},tI={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},nI={40:!0};function y1(i,r,o,c,p,_){if(r.imageName){const v=c[r.imageName];return v?v.displaySize[0]*r.scale*Jn/_+p:0}{const v=o[r.fontStack],b=v&&v[i];return b?b.metrics.advance*r.scale+p:0}}function _1(i,r,o,c){const p=Math.pow(i-r,2);return c?i<r?p/2:2*p:p+Math.abs(o)*o}function rI(i,r,o){let c=0;return i===10&&(c-=1e4),o&&(c+=150),i!==40&&i!==65288||(c+=50),r!==41&&r!==65289||(c+=50),c}function v1(i,r,o,c,p,_){let v=null,b=_1(r,o,p,_);for(const S of c){const k=_1(r-S.x,o,p,_)+S.badness;k<=b&&(v=S,b=k)}return{index:i,x:r,priorBreak:v,badness:b}}function x1(i){return i?x1(i.priorBreak).concat(i.index):[]}function zy(i,r,o,c,p,_){if(!i)return[];const v=[],b=function(A,R,O,j,V,Y){let re=0;for(let ye=0;ye<A.length();ye++){const ce=A.getSection(ye);re+=y1(A.getCharCode(ye),ce,j,V,R,Y)}return re/Math.max(1,Math.ceil(re/O))}(i,r,o,c,p,_),S=i.text.indexOf("​")>=0;let k=0;for(let A=0;A<i.length();A++){const R=i.getSection(A),O=i.getCharCode(A);if(tf[O]||(k+=y1(O,R,c,p,r,_)),A<i.length()-1){const j=!((E=O)<11904)&&(!!Bt["CJK Compatibility Forms"](E)||!!Bt["CJK Compatibility"](E)||!!Bt["CJK Strokes"](E)||!!Bt["CJK Symbols and Punctuation"](E)||!!Bt["Enclosed CJK Letters and Months"](E)||!!Bt["Halfwidth and Fullwidth Forms"](E)||!!Bt["Ideographic Description Characters"](E)||!!Bt["Vertical Forms"](E)||Op.test(String.fromCodePoint(E)));(tI[O]||j||R.imageName||A!==i.length()-2&&nI[i.getCharCode(A+1)])&&v.push(v1(A+1,k,b,v,rI(O,i.getCharCode(A+1),j&&S),!1))}}var E;return x1(v1(i.length(),k,b,v,0,!0))}function Ly(i){let r=.5,o=.5;switch(i){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:r,verticalAlign:o}}function iI(i,r,o,c,p){if(!c&&!p)return;const _=i[o],v=(i[o].x+_.metrics.advance*_.scale)*c;for(let b=r;b<=o;b++)i[b].x-=v,i[b].y+=p}function oI(i,r,o){const{horizontalAlign:c,verticalAlign:p}=Ly(o),_=r[0]-i.displaySize[0]*c,v=r[1]-i.displaySize[1]*p;return{image:i,top:v,bottom:v+i.displaySize[1],left:_,right:_+i.displaySize[0]}}function b1(i){var r,o;let c=i.left,p=i.top,_=i.right-c,v=i.bottom-p;const b=(r=i.image.textFitWidth)!==null&&r!==void 0?r:"stretchOrShrink",S=(o=i.image.textFitHeight)!==null&&o!==void 0?o:"stretchOrShrink",k=(i.image.content[2]-i.image.content[0])/(i.image.content[3]-i.image.content[1]);if(S==="proportional"){if(b==="stretchOnly"&&_/v<k||b==="proportional"){const E=Math.ceil(v*k);c*=E/_,_=E}}else if(b==="proportional"&&S==="stretchOnly"&&k!==0&&_/v>k){const E=Math.ceil(_/k);p*=E/v,v=E}return{x1:c,y1:p,x2:c+_,y2:p+v}}function w1(i,r,o,c,p,_){const v=i.image;let b;if(v.content){const Y=v.content,re=v.pixelRatio||1;b=[Y[0]/re,Y[1]/re,v.displaySize[0]-Y[2]/re,v.displaySize[1]-Y[3]/re]}const S=r.left*_,k=r.right*_;let E,A,R,O;o==="width"||o==="both"?(O=p[0]+S-c[3],A=p[0]+k+c[1]):(O=p[0]+(S+k-v.displaySize[0])/2,A=O+v.displaySize[0]);const j=r.top*_,V=r.bottom*_;return o==="height"||o==="both"?(E=p[1]+j-c[0],R=p[1]+V+c[2]):(E=p[1]+(j+V-v.displaySize[1])/2,R=E+v.displaySize[1]),{image:v,top:E,right:A,bottom:R,left:O,collisionPadding:b}}const qh=255,as=128,Ma=qh*as;function S1(i,r){const{expression:o}=r;if(o.kind==="constant")return{kind:"constant",layoutSize:o.evaluate(new vn(i+1))};if(o.kind==="source")return{kind:"source"};{const{zoomStops:c,interpolationType:p}=o;let _=0;for(;_<c.length&&c[_]<=i;)_++;_=Math.max(0,_-1);let v=_;for(;v<c.length&&c[v]<i+1;)v++;v=Math.min(c.length-1,v);const b=c[_],S=c[v];return o.kind==="composite"?{kind:"composite",minZoom:b,maxZoom:S,interpolationType:p}:{kind:"camera",minZoom:b,maxZoom:S,minSize:o.evaluate(new vn(b)),maxSize:o.evaluate(new vn(S)),interpolationType:p}}}function Ry(i,r,o){let c="never";const p=i.get(r);return p?c=p:i.get(o)&&(c="always"),c}const sI=Pa.VectorTileFeature.types,aI=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function nf(i,r,o,c,p,_,v,b,S,k,E,A,R){const O=b?Math.min(Ma,Math.round(b[0])):0,j=b?Math.min(Ma,Math.round(b[1])):0;i.emplaceBack(r,o,Math.round(32*c),Math.round(32*p),_,v,(O<<1)+(S?1:0),j,16*k,16*E,256*A,256*R)}function Dy(i,r,o){i.emplaceBack(r.x,r.y,o),i.emplaceBack(r.x,r.y,o),i.emplaceBack(r.x,r.y,o),i.emplaceBack(r.x,r.y,o)}function lI(i){for(const r of i.sections)if(cy(r.text))return!0;return!1}class Fy{constructor(r){this.layoutVertexArray=new Pc,this.indexArray=new Wi,this.programConfigurations=r,this.segments=new Ot,this.dynamicLayoutVertexArray=new zh,this.opacityVertexArray=new Ii,this.hasVisibleVertices=!1,this.placedSymbolArray=new xn}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(r,o,c,p){this.isEmpty()||(c&&(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,OE.members),this.indexBuffer=r.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=r.createVertexBuffer(this.dynamicLayoutVertexArray,NE.members,!0),this.opacityVertexBuffer=r.createVertexBuffer(this.opacityVertexArray,aI,!0),this.opacityVertexBuffer.itemSize=1),(c||p)&&this.programConfigurations.upload(r))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Qe("SymbolBuffers",Fy);class By{constructor(r,o,c){this.layoutVertexArray=new r,this.layoutAttributes=o,this.indexArray=new c,this.segments=new Ot,this.collisionVertexArray=new os}upload(r){this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=r.createVertexBuffer(this.collisionVertexArray,$E.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Qe("CollisionBuffers",By);class jc{constructor(r){this.collisionBoxArray=r.collisionBoxArray,this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(v=>v.id),this.index=r.index,this.pixelRatio=r.pixelRatio,this.sourceLayerIndex=r.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=gy([]),this.placementViewportMatrix=gy([]);const o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=S1(this.zoom,o["text-size"]),this.iconSizeData=S1(this.zoom,o["icon-size"]);const c=this.layers[0].layout,p=c.get("symbol-sort-key"),_=c.get("symbol-z-order");this.canOverlap=Ry(c,"text-overlap","text-allow-overlap")!=="never"||Ry(c,"icon-overlap","icon-allow-overlap")!=="never"||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey=_!=="viewport-y"&&!p.isConstant(),this.sortFeaturesByY=(_==="viewport-y"||_==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,c.get("symbol-placement")==="point"&&(this.writingModes=c.get("text-writing-mode").map(v=>x.ah[v])),this.stateDependentLayerIds=this.layers.filter(v=>v.isStateDependent()).map(v=>v.id),this.sourceID=r.sourceID}createArrays(){this.text=new Fy(new wl(this.layers,this.zoom,r=>/^text/.test(r))),this.icon=new Fy(new wl(this.layers,this.zoom,r=>/^icon/.test(r))),this.glyphOffsetArray=new bn,this.lineVertexArray=new vr,this.symbolInstances=new Ft,this.textAnchorOffsets=new wn}calculateGlyphDependencies(r,o,c,p,_){for(let v=0;v<r.length;v++)if(o[r.charCodeAt(v)]=!0,(c||p)&&_){const b=Uh[r.charAt(v)];b&&(o[b.charCodeAt(0)]=!0)}}populate(r,o,c){const p=this.layers[0],_=p.layout,v=_.get("text-font"),b=_.get("text-field"),S=_.get("icon-image"),k=(b.value.kind!=="constant"||b.value.value instanceof li&&!b.value.value.isEmpty()||b.value.value.toString().length>0)&&(v.value.kind!=="constant"||v.value.value.length>0),E=S.value.kind!=="constant"||!!S.value.value||Object.keys(S.parameters).length>0,A=_.get("symbol-sort-key");if(this.features=[],!k&&!E)return;const R=o.iconDependencies,O=o.glyphDependencies,j=o.availableImages,V=new vn(this.zoom);for(const{feature:Y,id:re,index:ye,sourceLayerIndex:ce}of r){const me=p._featureFilter.needGeometry,Ce=Tl(Y,me);if(!p._featureFilter.filter(V,Ce,c))continue;let Le,Xe;if(me||(Ce.geometry=Sl(Y)),k){const We=p.getValueAndResolveTokens("text-field",Ce,c,j),qe=li.factory(We),st=this.hasRTLText=this.hasRTLText||lI(qe);(!st||di.getRTLTextPluginStatus()==="unavailable"||st&&di.isParsed())&&(Le=UE(qe,p,Ce))}if(E){const We=p.getValueAndResolveTokens("icon-image",Ce,c,j);Xe=We instanceof ui?We:ui.fromString(We)}if(!Le&&!Xe)continue;const ft=this.sortFeaturesByKey?A.evaluate(Ce,{},c):void 0;if(this.features.push({id:re,text:Le,icon:Xe,index:ye,sourceLayerIndex:ce,geometry:Ce.geometry,properties:Y.properties,type:sI[Y.type],sortKey:ft}),Xe&&(R[Xe.name]=!0),Le){const We=v.evaluate(Ce,{},c).join(","),qe=_.get("text-rotation-alignment")!=="viewport"&&_.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(x.ah.vertical)>=0;for(const st of Le.sections)if(st.image)R[st.image.name]=!0;else{const nt=Eh(Le.toString()),Je=st.fontStack||We,Ie=O[Je]=O[Je]||{};this.calculateGlyphDependencies(st.text,Ie,qe,this.allowVerticalPlacement,nt)}}}_.get("symbol-placement")==="line"&&(this.features=function(Y){const re={},ye={},ce=[];let me=0;function Ce(We){ce.push(Y[We]),me++}function Le(We,qe,st){const nt=ye[We];return delete ye[We],ye[qe]=nt,ce[nt].geometry[0].pop(),ce[nt].geometry[0]=ce[nt].geometry[0].concat(st[0]),nt}function Xe(We,qe,st){const nt=re[qe];return delete re[qe],re[We]=nt,ce[nt].geometry[0].shift(),ce[nt].geometry[0]=st[0].concat(ce[nt].geometry[0]),nt}function ft(We,qe,st){const nt=st?qe[0][qe[0].length-1]:qe[0][0];return`${We}:${nt.x}:${nt.y}`}for(let We=0;We<Y.length;We++){const qe=Y[We],st=qe.geometry,nt=qe.text?qe.text.toString():null;if(!nt){Ce(We);continue}const Je=ft(nt,st),Ie=ft(nt,st,!0);if(Je in ye&&Ie in re&&ye[Je]!==re[Ie]){const at=Xe(Je,Ie,st),ot=Le(Je,Ie,ce[at].geometry);delete re[Je],delete ye[Ie],ye[ft(nt,ce[ot].geometry,!0)]=ot,ce[at].geometry=null}else Je in ye?Le(Je,Ie,st):Ie in re?Xe(Je,Ie,st):(Ce(We),re[Je]=me-1,ye[Ie]=me-1)}return ce.filter(We=>We.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Y,re)=>Y.sortKey-re.sortKey)}update(r,o,c){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(r,o,this.layers,c),this.icon.programConfigurations.updatePaintArrays(r,o,this.layers,c))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(r){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(r),this.iconCollisionBox.upload(r)),this.text.upload(r,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(r,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(r,o){const c=this.lineVertexArray.length;if(r.segment!==void 0){let p=r.dist(o[r.segment+1]),_=r.dist(o[r.segment]);const v={};for(let b=r.segment+1;b<o.length;b++)v[b]={x:o[b].x,y:o[b].y,tileUnitDistanceFromAnchor:p},b<o.length-1&&(p+=o[b+1].dist(o[b]));for(let b=r.segment||0;b>=0;b--)v[b]={x:o[b].x,y:o[b].y,tileUnitDistanceFromAnchor:_},b>0&&(_+=o[b-1].dist(o[b]));for(let b=0;b<o.length;b++){const S=v[b];this.lineVertexArray.emplaceBack(S.x,S.y,S.tileUnitDistanceFromAnchor)}}return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}}addSymbols(r,o,c,p,_,v,b,S,k,E,A,R){const O=r.indexArray,j=r.layoutVertexArray,V=r.segments.prepareSegment(4*o.length,j,O,this.canOverlap?v.sortKey:void 0),Y=this.glyphOffsetArray.length,re=V.vertexLength,ye=this.allowVerticalPlacement&&b===x.ah.vertical?Math.PI/2:0,ce=v.text&&v.text.sections;for(let me=0;me<o.length;me++){const{tl:Ce,tr:Le,bl:Xe,br:ft,tex:We,pixelOffsetTL:qe,pixelOffsetBR:st,minFontScaleX:nt,minFontScaleY:Je,glyphOffset:Ie,isSDF:at,sectionIndex:ot}=o[me],bt=V.vertexLength,cn=Ie[1];nf(j,S.x,S.y,Ce.x,cn+Ce.y,We.x,We.y,c,at,qe.x,qe.y,nt,Je),nf(j,S.x,S.y,Le.x,cn+Le.y,We.x+We.w,We.y,c,at,st.x,qe.y,nt,Je),nf(j,S.x,S.y,Xe.x,cn+Xe.y,We.x,We.y+We.h,c,at,qe.x,st.y,nt,Je),nf(j,S.x,S.y,ft.x,cn+ft.y,We.x+We.w,We.y+We.h,c,at,st.x,st.y,nt,Je),Dy(r.dynamicLayoutVertexArray,S,ye),O.emplaceBack(bt,bt+1,bt+2),O.emplaceBack(bt+1,bt+2,bt+3),V.vertexLength+=4,V.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ie[0]),me!==o.length-1&&ot===o[me+1].sectionIndex||r.programConfigurations.populatePaintArrays(j.length,v,v.index,{},R,ce&&ce[ot])}r.placedSymbolArray.emplaceBack(S.x,S.y,Y,this.glyphOffsetArray.length-Y,re,k,E,S.segment,c?c[0]:0,c?c[1]:0,p[0],p[1],b,0,!1,0,A)}_addCollisionDebugVertex(r,o,c,p,_,v){return o.emplaceBack(0,0),r.emplaceBack(c.x,c.y,p,_,Math.round(v.x),Math.round(v.y))}addCollisionDebugVertices(r,o,c,p,_,v,b){const S=_.segments.prepareSegment(4,_.layoutVertexArray,_.indexArray),k=S.vertexLength,E=_.layoutVertexArray,A=_.collisionVertexArray,R=b.anchorX,O=b.anchorY;this._addCollisionDebugVertex(E,A,v,R,O,new N(r,o)),this._addCollisionDebugVertex(E,A,v,R,O,new N(c,o)),this._addCollisionDebugVertex(E,A,v,R,O,new N(c,p)),this._addCollisionDebugVertex(E,A,v,R,O,new N(r,p)),S.vertexLength+=4;const j=_.indexArray;j.emplaceBack(k,k+1),j.emplaceBack(k+1,k+2),j.emplaceBack(k+2,k+3),j.emplaceBack(k+3,k),S.primitiveLength+=4}addDebugCollisionBoxes(r,o,c,p){for(let _=r;_<o;_++){const v=this.collisionBoxArray.get(_);this.addCollisionDebugVertices(v.x1,v.y1,v.x2,v.y2,p?this.textCollisionBox:this.iconCollisionBox,v.anchorPoint,c)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new By(Pi,s1.members,dr),this.iconCollisionBox=new By(Pi,s1.members,dr);for(let r=0;r<this.symbolInstances.length;r++){const o=this.symbolInstances.get(r);this.addDebugCollisionBoxes(o.textBoxStartIndex,o.textBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.iconBoxStartIndex,o.iconBoxEndIndex,o,!1),this.addDebugCollisionBoxes(o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o,!1)}}_deserializeCollisionBoxesForSymbol(r,o,c,p,_,v,b,S,k){const E={};for(let A=o;A<c;A++){const R=r.get(A);E.textBox={x1:R.x1,y1:R.y1,x2:R.x2,y2:R.y2,anchorPointX:R.anchorPointX,anchorPointY:R.anchorPointY},E.textFeatureIndex=R.featureIndex;break}for(let A=p;A<_;A++){const R=r.get(A);E.verticalTextBox={x1:R.x1,y1:R.y1,x2:R.x2,y2:R.y2,anchorPointX:R.anchorPointX,anchorPointY:R.anchorPointY},E.verticalTextFeatureIndex=R.featureIndex;break}for(let A=v;A<b;A++){const R=r.get(A);E.iconBox={x1:R.x1,y1:R.y1,x2:R.x2,y2:R.y2,anchorPointX:R.anchorPointX,anchorPointY:R.anchorPointY},E.iconFeatureIndex=R.featureIndex;break}for(let A=S;A<k;A++){const R=r.get(A);E.verticalIconBox={x1:R.x1,y1:R.y1,x2:R.x2,y2:R.y2,anchorPointX:R.anchorPointX,anchorPointY:R.anchorPointY},E.verticalIconFeatureIndex=R.featureIndex;break}return E}deserializeCollisionBoxes(r){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const c=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(r,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(r,o){const c=r.placedSymbolArray.get(o),p=c.vertexStartIndex+4*c.numGlyphs;for(let _=c.vertexStartIndex;_<p;_+=4)r.indexArray.emplaceBack(_,_+1,_+2),r.indexArray.emplaceBack(_+1,_+2,_+3)}getSortedSymbolIndexes(r){if(this.sortedAngle===r&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(r),c=Math.cos(r),p=[],_=[],v=[];for(let b=0;b<this.symbolInstances.length;++b){v.push(b);const S=this.symbolInstances.get(b);p.push(0|Math.round(o*S.anchorX+c*S.anchorY)),_.push(S.featureIndex)}return v.sort((b,S)=>p[b]-p[S]||_[S]-_[b]),v}addToSortKeyRanges(r,o){const c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===o?c.symbolInstanceEnd=r+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:r,symbolInstanceEnd:r+1})}sortFeatures(r){if(this.sortFeaturesByY&&this.sortedAngle!==r&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(r),this.sortedAngle=r,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const c=this.symbolInstances.get(o);this.featureSortOrder.push(c.featureIndex),[c.rightJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.leftJustifiedTextSymbolIndex].forEach((p,_,v)=>{p>=0&&v.indexOf(p)===_&&this.addIndicesForPlacedSymbol(this.text,p)}),c.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,c.verticalPlacedTextSymbolIndex),c.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,c.placedIconSymbolIndex),c.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,c.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let T1,C1;Qe("SymbolBucket",jc,{omit:["layers","collisionBoxArray","features","compareText"]}),jc.MAX_GLYPHS=65535,jc.addDynamicAttributes=Dy;var Oy={get paint(){return C1=C1||new g({"icon-opacity":new gt(Se.paint_symbol["icon-opacity"]),"icon-color":new gt(Se.paint_symbol["icon-color"]),"icon-halo-color":new gt(Se.paint_symbol["icon-halo-color"]),"icon-halo-width":new gt(Se.paint_symbol["icon-halo-width"]),"icon-halo-blur":new gt(Se.paint_symbol["icon-halo-blur"]),"icon-translate":new rt(Se.paint_symbol["icon-translate"]),"icon-translate-anchor":new rt(Se.paint_symbol["icon-translate-anchor"]),"text-opacity":new gt(Se.paint_symbol["text-opacity"]),"text-color":new gt(Se.paint_symbol["text-color"],{runtimeType:Gr,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new gt(Se.paint_symbol["text-halo-color"]),"text-halo-width":new gt(Se.paint_symbol["text-halo-width"]),"text-halo-blur":new gt(Se.paint_symbol["text-halo-blur"]),"text-translate":new rt(Se.paint_symbol["text-translate"]),"text-translate-anchor":new rt(Se.paint_symbol["text-translate-anchor"])})},get layout(){return T1=T1||new g({"symbol-placement":new rt(Se.layout_symbol["symbol-placement"]),"symbol-spacing":new rt(Se.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new rt(Se.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new gt(Se.layout_symbol["symbol-sort-key"]),"symbol-z-order":new rt(Se.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new rt(Se.layout_symbol["icon-allow-overlap"]),"icon-overlap":new rt(Se.layout_symbol["icon-overlap"]),"icon-ignore-placement":new rt(Se.layout_symbol["icon-ignore-placement"]),"icon-optional":new rt(Se.layout_symbol["icon-optional"]),"icon-rotation-alignment":new rt(Se.layout_symbol["icon-rotation-alignment"]),"icon-size":new gt(Se.layout_symbol["icon-size"]),"icon-text-fit":new rt(Se.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new rt(Se.layout_symbol["icon-text-fit-padding"]),"icon-image":new gt(Se.layout_symbol["icon-image"]),"icon-rotate":new gt(Se.layout_symbol["icon-rotate"]),"icon-padding":new gt(Se.layout_symbol["icon-padding"]),"icon-keep-upright":new rt(Se.layout_symbol["icon-keep-upright"]),"icon-offset":new gt(Se.layout_symbol["icon-offset"]),"icon-anchor":new gt(Se.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new rt(Se.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new rt(Se.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new rt(Se.layout_symbol["text-rotation-alignment"]),"text-field":new gt(Se.layout_symbol["text-field"]),"text-font":new gt(Se.layout_symbol["text-font"]),"text-size":new gt(Se.layout_symbol["text-size"]),"text-max-width":new gt(Se.layout_symbol["text-max-width"]),"text-line-height":new rt(Se.layout_symbol["text-line-height"]),"text-letter-spacing":new gt(Se.layout_symbol["text-letter-spacing"]),"text-justify":new gt(Se.layout_symbol["text-justify"]),"text-radial-offset":new gt(Se.layout_symbol["text-radial-offset"]),"text-variable-anchor":new rt(Se.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new gt(Se.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new gt(Se.layout_symbol["text-anchor"]),"text-max-angle":new rt(Se.layout_symbol["text-max-angle"]),"text-writing-mode":new rt(Se.layout_symbol["text-writing-mode"]),"text-rotate":new gt(Se.layout_symbol["text-rotate"]),"text-padding":new rt(Se.layout_symbol["text-padding"]),"text-keep-upright":new rt(Se.layout_symbol["text-keep-upright"]),"text-transform":new gt(Se.layout_symbol["text-transform"]),"text-offset":new gt(Se.layout_symbol["text-offset"]),"text-allow-overlap":new rt(Se.layout_symbol["text-allow-overlap"]),"text-overlap":new rt(Se.layout_symbol["text-overlap"]),"text-ignore-placement":new rt(Se.layout_symbol["text-ignore-placement"]),"text-optional":new rt(Se.layout_symbol["text-optional"])})}};class k1{constructor(r){if(r.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=r.property.overrides?r.property.overrides.runtimeType:$i,this.defaultValue=r}evaluate(r){if(r.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(r.formattedSection))return o.getOverride(r.formattedSection)}return r.feature&&r.featureState?this.defaultValue.evaluate(r.feature,r.featureState):this.defaultValue.property.specification.default}eachChild(r){this.defaultValue.isConstant()||r(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Qe("FormatSectionOverride",k1,{omit:["defaultValue"]});class rf extends a{constructor(r){super(r,Oy)}recalculate(r,o){if(super.recalculate(r,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const c=this.layout.get("text-writing-mode");if(c){const p=[];for(const _ of c)p.indexOf(_)<0&&p.push(_);this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(r,o,c,p){const _=this.layout.get(r).evaluate(o,{},c,p),v=this._unevaluatedLayout._values[r];return v.isDataDriven()||fc(v.value)||!_?_:function(b,S){return S.replace(/{([^{}]+)}/g,(k,E)=>b&&E in b?String(b[E]):"")}(o.properties,_)}createBucket(r){return new jc(r)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const r of Oy.paint.overridableProperties){if(!rf.hasPaintOverride(this.layout,r))continue;const o=this.paint.get(r),c=new k1(o),p=new pc(c,o.property.specification);let _=null;_=o.value.kind==="constant"||o.value.kind==="source"?new pa("source",p):new fa("composite",p,o.value.zoomStops),this.paint._values[r]=new yo(o.property,_,o.parameters)}}_handleOverridablePaintPropertyUpdate(r,o,c){return!(!this.layout||o.isDataDriven()||c.isDataDriven())&&rf.hasPaintOverride(this.layout,r)}static hasPaintOverride(r,o){const c=r.get("text-field"),p=Oy.paint.properties[o];let _=!1;const v=b=>{for(const S of b)if(p.overrides&&p.overrides.hasOverride(S))return void(_=!0)};if(c.value.kind==="constant"&&c.value.value instanceof li)v(c.value.value.sections);else if(c.value.kind==="source"){const b=k=>{_||(k instanceof Ui&&Zn(k.value)===$o?v(k.value.sections):k instanceof ic?v(k.sections):k.eachChild(b))},S=c.value;S._styleExpression&&b(S._styleExpression.expression)}return _}}let E1;var cI={get paint(){return E1=E1||new g({"background-color":new rt(Se.paint_background["background-color"]),"background-pattern":new Ec(Se.paint_background["background-pattern"]),"background-opacity":new rt(Se.paint_background["background-opacity"])})}};class uI extends a{constructor(r){super(r,cI)}}let I1;var hI={get paint(){return I1=I1||new g({"raster-opacity":new rt(Se.paint_raster["raster-opacity"]),"raster-hue-rotate":new rt(Se.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new rt(Se.paint_raster["raster-brightness-min"]),"raster-brightness-max":new rt(Se.paint_raster["raster-brightness-max"]),"raster-saturation":new rt(Se.paint_raster["raster-saturation"]),"raster-contrast":new rt(Se.paint_raster["raster-contrast"]),"raster-resampling":new rt(Se.paint_raster["raster-resampling"]),"raster-fade-duration":new rt(Se.paint_raster["raster-fade-duration"])})}};class dI extends a{constructor(r){super(r,hI)}}class pI extends a{constructor(r){super(r,{}),this.onAdd=o=>{this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)},this.onRemove=o=>{this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)},this.implementation=r}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class fI{constructor(r){this._methodToThrottle=r,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Ny=63710088e-1;class za{constructor(r,o){if(isNaN(r)||isNaN(o))throw new Error(`Invalid LngLat object: (${r}, ${o})`);if(this.lng=+r,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new za(be(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(r){const o=Math.PI/180,c=this.lat*o,p=r.lat*o,_=Math.sin(c)*Math.sin(p)+Math.cos(c)*Math.cos(p)*Math.cos((r.lng-this.lng)*o);return Ny*Math.acos(Math.min(_,1))}static convert(r){if(r instanceof za)return r;if(Array.isArray(r)&&(r.length===2||r.length===3))return new za(Number(r[0]),Number(r[1]));if(!Array.isArray(r)&&typeof r=="object"&&r!==null)return new za(Number("lng"in r?r.lng:r.lon),Number(r.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const P1=2*Math.PI*Ny;function A1(i){return P1*Math.cos(i*Math.PI/180)}function M1(i){return(180+i)/360}function z1(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function L1(i,r){return i/A1(r)}function $y(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}class Hh{constructor(r,o,c=0){this.x=+r,this.y=+o,this.z=+c}static fromLngLat(r,o=0){const c=za.convert(r);return new Hh(M1(c.lng),z1(c.lat),L1(o,c.lat))}toLngLat(){return new za(360*this.x-180,$y(this.y))}toAltitude(){return this.z*A1($y(this.y))}meterInMercatorCoordinateUnits(){return 1/P1*(r=$y(this.y),1/Math.cos(r*Math.PI/180));var r}}function R1(i,r,o){var c=2*Math.PI*6378137/256/Math.pow(2,o);return[i*c-2*Math.PI*6378137/2,r*c-2*Math.PI*6378137/2]}class jy{constructor(r,o,c){if(!function(p,_,v){return!(p<0||p>25||v<0||v>=Math.pow(2,p)||_<0||_>=Math.pow(2,p))}(r,o,c))throw new Error(`x=${o}, y=${c}, z=${r} outside of bounds. 0<=x<${Math.pow(2,r)}, 0<=y<${Math.pow(2,r)} 0<=z<=25 `);this.z=r,this.x=o,this.y=c,this.key=Zh(0,r,r,o,c)}equals(r){return this.z===r.z&&this.x===r.x&&this.y===r.y}url(r,o,c){const p=(v=this.y,b=this.z,S=R1(256*(_=this.x),256*(v=Math.pow(2,b)-v-1),b),k=R1(256*(_+1),256*(v+1),b),S[0]+","+S[1]+","+k[0]+","+k[1]);var _,v,b,S,k;const E=function(A,R,O){let j,V="";for(let Y=A;Y>0;Y--)j=1<<Y-1,V+=(R&j?1:0)+(O&j?2:0);return V}(this.z,this.x,this.y);return r[(this.x+this.y)%r.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(c==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,o>1?"@2x":"").replace(/{quadkey}/g,E).replace(/{bbox-epsg-3857}/g,p)}isChildOf(r){const o=this.z-r.z;return o>0&&r.x===this.x>>o&&r.y===this.y>>o}getTilePoint(r){const o=Math.pow(2,this.z);return new N((r.x*o-this.x)*Wn,(r.y*o-this.y)*Wn)}toString(){return`${this.z}/${this.x}/${this.y}`}}class D1{constructor(r,o){this.wrap=r,this.canonical=o,this.key=Zh(r,o.z,o.z,o.x,o.y)}}class Xi{constructor(r,o,c,p,_){if(r<c)throw new Error(`overscaledZ should be >= z; overscaledZ = ${r}; z = ${c}`);this.overscaledZ=r,this.wrap=o,this.canonical=new jy(c,+p,+_),this.key=Zh(o,r,c,p,_)}clone(){return new Xi(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(r){return this.overscaledZ===r.overscaledZ&&this.wrap===r.wrap&&this.canonical.equals(r.canonical)}scaledTo(r){if(r>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${r}; overscaledZ = ${this.overscaledZ}`);const o=this.canonical.z-r;return r>this.canonical.z?new Xi(r,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Xi(r,this.wrap,r,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(r,o){if(r>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${r}; overscaledZ = ${this.overscaledZ}`);const c=this.canonical.z-r;return r>this.canonical.z?Zh(this.wrap*+o,r,this.canonical.z,this.canonical.x,this.canonical.y):Zh(this.wrap*+o,r,r,this.canonical.x>>c,this.canonical.y>>c)}isChildOf(r){if(r.wrap!==this.wrap)return!1;const o=this.canonical.z-r.canonical.z;return r.overscaledZ===0||r.overscaledZ<this.overscaledZ&&r.canonical.x===this.canonical.x>>o&&r.canonical.y===this.canonical.y>>o}children(r){if(this.overscaledZ>=r)return[new Xi(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,c=2*this.canonical.x,p=2*this.canonical.y;return[new Xi(o,this.wrap,o,c,p),new Xi(o,this.wrap,o,c+1,p),new Xi(o,this.wrap,o,c,p+1),new Xi(o,this.wrap,o,c+1,p+1)]}isLessThan(r){return this.wrap<r.wrap||!(this.wrap>r.wrap)&&(this.overscaledZ<r.overscaledZ||!(this.overscaledZ>r.overscaledZ)&&(this.canonical.x<r.canonical.x||!(this.canonical.x>r.canonical.x)&&this.canonical.y<r.canonical.y))}wrapped(){return new Xi(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(r){return new Xi(this.overscaledZ,r,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new D1(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(r){return this.canonical.getTilePoint(new Hh(r.x-this.wrap,r.y))}}function Zh(i,r,o,c,p){(i*=2)<0&&(i=-1*i-1);const _=1<<o;return(_*_*i+_*p+c).toString(36)+o.toString(36)+r.toString(36)}Qe("CanonicalTileID",jy),Qe("OverscaledTileID",Xi,{omit:["posMatrix"]});class F1{constructor(r,o,c,p=1,_=1,v=1,b=0){if(this.uid=r,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(c&&!["mapbox","terrarium","custom"].includes(c))return void dt(`"${c}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=o.height;const S=this.dim=o.height-2;switch(this.data=new Uint32Array(o.data.buffer),c){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=p,this.greenFactor=_,this.blueFactor=v,this.baseShift=b;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let k=0;k<S;k++)this.data[this._idx(-1,k)]=this.data[this._idx(0,k)],this.data[this._idx(S,k)]=this.data[this._idx(S-1,k)],this.data[this._idx(k,-1)]=this.data[this._idx(k,0)],this.data[this._idx(k,S)]=this.data[this._idx(k,S-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(S,-1)]=this.data[this._idx(S-1,0)],this.data[this._idx(-1,S)]=this.data[this._idx(0,S-1)],this.data[this._idx(S,S)]=this.data[this._idx(S-1,S-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let k=0;k<S;k++)for(let E=0;E<S;E++){const A=this.get(k,E);A>this.max&&(this.max=A),A<this.min&&(this.min=A)}}get(r,o){const c=new Uint8Array(this.data.buffer),p=4*this._idx(r,o);return this.unpack(c[p],c[p+1],c[p+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(r,o){if(r<-1||r>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(r+1)}unpack(r,o,c){return r*this.redFactor+o*this.greenFactor+c*this.blueFactor-this.baseShift}getPixels(){return new Ki({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(r,o,c){if(this.dim!==r.dim)throw new Error("dem dimension mismatch");let p=o*this.dim,_=o*this.dim+this.dim,v=c*this.dim,b=c*this.dim+this.dim;switch(o){case-1:p=_-1;break;case 1:_=p+1}switch(c){case-1:v=b-1;break;case 1:b=v+1}const S=-o*this.dim,k=-c*this.dim;for(let E=v;E<b;E++)for(let A=p;A<_;A++)this.data[this._idx(A,E)]=r.data[this._idx(A+S,E+k)]}}Qe("DEMData",F1);class B1{constructor(r){this._stringToNumber={},this._numberToString=[];for(let o=0;o<r.length;o++){const c=r[o];this._stringToNumber[c]=o,this._numberToString[o]=c}}encode(r){return this._stringToNumber[r]}decode(r){if(r>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${r} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[r]}}class O1{constructor(r,o,c,p,_){this.type="Feature",this._vectorTileFeature=r,r._z=o,r._x=c,r._y=p,this.properties=r.properties,this.id=_}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(r){this._geometry=r}toJSON(){const r={geometry:this.geometry};for(const o in this)o!=="_geometry"&&o!=="_vectorTileFeature"&&(r[o]=this[o]);return r}}class N1{constructor(r,o){this.tileID=r,this.x=r.canonical.x,this.y=r.canonical.y,this.z=r.canonical.z,this.grid=new _a(Wn,16,0),this.grid3D=new _a(Wn,16,0),this.featureIndexArray=new Rr,this.promoteId=o}insert(r,o,c,p,_,v){const b=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,p,_);const S=v?this.grid3D:this.grid;for(let k=0;k<o.length;k++){const E=o[k],A=[1/0,1/0,-1/0,-1/0];for(let R=0;R<E.length;R++){const O=E[R];A[0]=Math.min(A[0],O.x),A[1]=Math.min(A[1],O.y),A[2]=Math.max(A[2],O.x),A[3]=Math.max(A[3],O.y)}A[0]<Wn&&A[1]<Wn&&A[2]>=0&&A[3]>=0&&S.insert(b,A[0],A[1],A[2],A[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Pa.VectorTile(new Py(this.rawTileData)).layers,this.sourceLayerCoder=new B1(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(r,o,c,p){this.loadVTLayers();const _=r.params||{},v=Wn/r.tileSize/r.scale,b=dh(_.filter),S=r.queryGeometry,k=r.queryPadding*v,E=j1(S),A=this.grid.query(E.minX-k,E.minY-k,E.maxX+k,E.maxY+k),R=j1(r.cameraQueryGeometry),O=this.grid3D.query(R.minX-k,R.minY-k,R.maxX+k,R.maxY+k,(Y,re,ye,ce)=>function(me,Ce,Le,Xe,ft){for(const qe of me)if(Ce<=qe.x&&Le<=qe.y&&Xe>=qe.x&&ft>=qe.y)return!0;const We=[new N(Ce,Le),new N(Ce,ft),new N(Xe,ft),new N(Xe,Le)];if(me.length>2){for(const qe of We)if(Rc(me,qe))return!0}for(let qe=0;qe<me.length-1;qe++)if(Wk(me[qe],me[qe+1],We))return!0;return!1}(r.cameraQueryGeometry,Y-k,re-k,ye+k,ce+k));for(const Y of O)A.push(Y);A.sort(mI);const j={};let V;for(let Y=0;Y<A.length;Y++){const re=A[Y];if(re===V)continue;V=re;const ye=this.featureIndexArray.get(re);let ce=null;this.loadMatchingFeature(j,ye.bucketIndex,ye.sourceLayerIndex,ye.featureIndex,b,_.layers,_.availableImages,o,c,p,(me,Ce,Le)=>(ce||(ce=Sl(me)),Ce.queryIntersectsFeature(S,me,Le,ce,this.z,r.transform,v,r.pixelPosMatrix)))}return j}loadMatchingFeature(r,o,c,p,_,v,b,S,k,E,A){const R=this.bucketLayerIDs[o];if(v&&!function(Y,re){for(let ye=0;ye<Y.length;ye++)if(re.indexOf(Y[ye])>=0)return!0;return!1}(v,R))return;const O=this.sourceLayerCoder.decode(c),j=this.vtLayers[O].feature(p);if(_.needGeometry){const Y=Tl(j,!0);if(!_.filter(new vn(this.tileID.overscaledZ),Y,this.tileID.canonical))return}else if(!_.filter(new vn(this.tileID.overscaledZ),j))return;const V=this.getId(j,O);for(let Y=0;Y<R.length;Y++){const re=R[Y];if(v&&v.indexOf(re)<0)continue;const ye=S[re];if(!ye)continue;let ce={};V&&E&&(ce=E.getState(ye.sourceLayer||"_geojsonTileLayer",V));const me=xe({},k[re]);me.paint=$1(me.paint,ye.paint,j,ce,b),me.layout=$1(me.layout,ye.layout,j,ce,b);const Ce=!A||A(j,ye,ce);if(!Ce)continue;const Le=new O1(j,this.z,this.x,this.y,V);Le.layer=me;let Xe=r[re];Xe===void 0&&(Xe=r[re]=[]),Xe.push({featureIndex:p,feature:Le,intersectionZ:Ce})}}lookupSymbolFeatures(r,o,c,p,_,v,b,S){const k={};this.loadVTLayers();const E=dh(_);for(const A of r)this.loadMatchingFeature(k,c,p,A,E,v,b,S,o);return k}hasLayer(r){for(const o of this.bucketLayerIDs)for(const c of o)if(r===c)return!0;return!1}getId(r,o){let c=r.id;return this.promoteId&&(c=r.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[o]],typeof c=="boolean"&&(c=Number(c))),c}}function $1(i,r,o,c,p){return tt(i,(_,v)=>{const b=r instanceof vl?r.get(v):null;return b&&b.evaluate?b.evaluate(o,c,p):b})}function j1(i){let r=1/0,o=1/0,c=-1/0,p=-1/0;for(const _ of i)r=Math.min(r,_.x),o=Math.min(o,_.y),c=Math.max(c,_.x),p=Math.max(p,_.y);return{minX:r,minY:o,maxX:c,maxY:p}}function mI(i,r){return r-i}function U1(i,r,o,c,p){const _=[];for(let v=0;v<i.length;v++){const b=i[v];let S;for(let k=0;k<b.length-1;k++){let E=b[k],A=b[k+1];E.x<r&&A.x<r||(E.x<r?E=new N(r,E.y+(r-E.x)/(A.x-E.x)*(A.y-E.y))._round():A.x<r&&(A=new N(r,E.y+(r-E.x)/(A.x-E.x)*(A.y-E.y))._round()),E.y<o&&A.y<o||(E.y<o?E=new N(E.x+(o-E.y)/(A.y-E.y)*(A.x-E.x),o)._round():A.y<o&&(A=new N(E.x+(o-E.y)/(A.y-E.y)*(A.x-E.x),o)._round()),E.x>=c&&A.x>=c||(E.x>=c?E=new N(c,E.y+(c-E.x)/(A.x-E.x)*(A.y-E.y))._round():A.x>=c&&(A=new N(c,E.y+(c-E.x)/(A.x-E.x)*(A.y-E.y))._round()),E.y>=p&&A.y>=p||(E.y>=p?E=new N(E.x+(p-E.y)/(A.y-E.y)*(A.x-E.x),p)._round():A.y>=p&&(A=new N(E.x+(p-E.y)/(A.y-E.y)*(A.x-E.x),p)._round()),S&&E.equals(S[S.length-1])||(S=[E],_.push(S)),S.push(A)))))}}return _}Qe("FeatureIndex",N1,{omit:["rawTileData","sourceLayerCoder"]});class La extends N{constructor(r,o,c,p){super(r,o),this.angle=c,p!==void 0&&(this.segment=p)}clone(){return new La(this.x,this.y,this.angle,this.segment)}}function V1(i,r,o,c,p){if(r.segment===void 0||o===0)return!0;let _=r,v=r.segment+1,b=0;for(;b>-o/2;){if(v--,v<0)return!1;b-=i[v].dist(_),_=i[v]}b+=i[v].dist(i[v+1]),v++;const S=[];let k=0;for(;b<o/2;){const E=i[v],A=i[v+1];if(!A)return!1;let R=i[v-1].angleTo(E)-E.angleTo(A);for(R=Math.abs((R+3*Math.PI)%(2*Math.PI)-Math.PI),S.push({distance:b,angleDelta:R}),k+=R;b-S[0].distance>c;)k-=S.shift().angleDelta;if(k>p)return!1;v++,b+=E.dist(A)}return!0}function G1(i){let r=0;for(let o=0;o<i.length-1;o++)r+=i[o].dist(i[o+1]);return r}function q1(i,r,o){return i?.6*r*o:0}function H1(i,r){return Math.max(i?i.right-i.left:0,r?r.right-r.left:0)}function gI(i,r,o,c,p,_){const v=q1(o,p,_),b=H1(o,c)*_;let S=0;const k=G1(i)/2;for(let E=0;E<i.length-1;E++){const A=i[E],R=i[E+1],O=A.dist(R);if(S+O>k){const j=(k-S)/O,V=qr.number(A.x,R.x,j),Y=qr.number(A.y,R.y,j),re=new La(V,Y,R.angleTo(A),E);return re._round(),!v||V1(i,re,b,v,r)?re:void 0}S+=O}}function yI(i,r,o,c,p,_,v,b,S){const k=q1(c,_,v),E=H1(c,p),A=E*v,R=i[0].x===0||i[0].x===S||i[0].y===0||i[0].y===S;return r-A<r/4&&(r=A+r/4),Z1(i,R?r/2*b%r:(E/2+2*_)*v*b%r,r,k,o,A,R,!1,S)}function Z1(i,r,o,c,p,_,v,b,S){const k=_/2,E=G1(i);let A=0,R=r-o,O=[];for(let j=0;j<i.length-1;j++){const V=i[j],Y=i[j+1],re=V.dist(Y),ye=Y.angleTo(V);for(;R+o<A+re;){R+=o;const ce=(R-A)/re,me=qr.number(V.x,Y.x,ce),Ce=qr.number(V.y,Y.y,ce);if(me>=0&&me<S&&Ce>=0&&Ce<S&&R-k>=0&&R+k<=E){const Le=new La(me,Ce,ye,j);Le._round(),c&&!V1(i,Le,_,c,p)||O.push(Le)}}A+=re}return b||O.length||v||(O=Z1(i,A/2,o,c,p,_,v,!0,S)),O}Qe("Anchor",La);const Uc=fi;function W1(i,r,o,c){const p=[],_=i.image,v=_.pixelRatio,b=_.paddedRect.w-2*Uc,S=_.paddedRect.h-2*Uc;let k={x1:i.left,y1:i.top,x2:i.right,y2:i.bottom};const E=_.stretchX||[[0,b]],A=_.stretchY||[[0,S]],R=(Ie,at)=>Ie+at[1]-at[0],O=E.reduce(R,0),j=A.reduce(R,0),V=b-O,Y=S-j;let re=0,ye=O,ce=0,me=j,Ce=0,Le=V,Xe=0,ft=Y;if(_.content&&c){const Ie=_.content,at=Ie[2]-Ie[0],ot=Ie[3]-Ie[1];(_.textFitWidth||_.textFitHeight)&&(k=b1(i)),re=of(E,0,Ie[0]),ce=of(A,0,Ie[1]),ye=of(E,Ie[0],Ie[2]),me=of(A,Ie[1],Ie[3]),Ce=Ie[0]-re,Xe=Ie[1]-ce,Le=at-ye,ft=ot-me}const We=k.x1,qe=k.y1,st=k.x2-We,nt=k.y2-qe,Je=(Ie,at,ot,bt)=>{const cn=sf(Ie.stretch-re,ye,st,We),on=af(Ie.fixed-Ce,Le,Ie.stretch,O),or=sf(at.stretch-ce,me,nt,qe),vo=af(at.fixed-Xe,ft,at.stretch,j),Sr=sf(ot.stretch-re,ye,st,We),sr=af(ot.fixed-Ce,Le,ot.stretch,O),Kr=sf(bt.stretch-ce,me,nt,qe),Xr=af(bt.fixed-Xe,ft,bt.stretch,j),Yr=new N(cn,or),Bn=new N(Sr,or),ar=new N(Sr,Kr),Fr=new N(cn,Kr),Tr=new N(on/v,vo/v),Jr=new N(sr/v,Xr/v),Cr=r*Math.PI/180;if(Cr){const qt=Math.sin(Cr),fn=Math.cos(Cr),Sn=[fn,-qt,qt,fn];Yr._matMult(Sn),Bn._matMult(Sn),Fr._matMult(Sn),ar._matMult(Sn)}const Yi=Ie.stretch+Ie.fixed,mi=at.stretch+at.fixed;return{tl:Yr,tr:Bn,bl:Fr,br:ar,tex:{x:_.paddedRect.x+Uc+Yi,y:_.paddedRect.y+Uc+mi,w:ot.stretch+ot.fixed-Yi,h:bt.stretch+bt.fixed-mi},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Tr,pixelOffsetBR:Jr,minFontScaleX:Le/v/st,minFontScaleY:ft/v/nt,isSDF:o}};if(c&&(_.stretchX||_.stretchY)){const Ie=K1(E,V,O),at=K1(A,Y,j);for(let ot=0;ot<Ie.length-1;ot++){const bt=Ie[ot],cn=Ie[ot+1];for(let on=0;on<at.length-1;on++)p.push(Je(bt,at[on],cn,at[on+1]))}}else p.push(Je({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:b+1},{fixed:0,stretch:S+1}));return p}function of(i,r,o){let c=0;for(const p of i)c+=Math.max(r,Math.min(o,p[1]))-Math.max(r,Math.min(o,p[0]));return c}function K1(i,r,o){const c=[{fixed:-Uc,stretch:0}];for(const[p,_]of i){const v=c[c.length-1];c.push({fixed:p-v.stretch,stretch:v.stretch}),c.push({fixed:p-v.stretch,stretch:v.stretch+(_-p)})}return c.push({fixed:r+Uc,stretch:o}),c}function sf(i,r,o,c){return i/r*o+c}function af(i,r,o,c){return i-r*o/c}class lf{constructor(r,o,c,p,_,v,b,S,k,E){var A;if(this.boxStartIndex=r.length,k){let R=v.top,O=v.bottom;const j=v.collisionPadding;j&&(R-=j[1],O+=j[3]);let V=O-R;V>0&&(V=Math.max(10,V),this.circleDiameter=V)}else{const R=!((A=v.image)===null||A===void 0)&&A.content&&(v.image.textFitWidth||v.image.textFitHeight)?b1(v):{x1:v.left,y1:v.top,x2:v.right,y2:v.bottom};R.y1=R.y1*b-S[0],R.y2=R.y2*b+S[2],R.x1=R.x1*b-S[3],R.x2=R.x2*b+S[1];const O=v.collisionPadding;if(O&&(R.x1-=O[0]*b,R.y1-=O[1]*b,R.x2+=O[2]*b,R.y2+=O[3]*b),E){const j=new N(R.x1,R.y1),V=new N(R.x2,R.y1),Y=new N(R.x1,R.y2),re=new N(R.x2,R.y2),ye=E*Math.PI/180;j._rotate(ye),V._rotate(ye),Y._rotate(ye),re._rotate(ye),R.x1=Math.min(j.x,V.x,Y.x,re.x),R.x2=Math.max(j.x,V.x,Y.x,re.x),R.y1=Math.min(j.y,V.y,Y.y,re.y),R.y2=Math.max(j.y,V.y,Y.y,re.y)}r.emplaceBack(o.x,o.y,R.x1,R.y1,R.x2,R.y2,c,p,_)}this.boxEndIndex=r.length}}class _I{constructor(r=[],o=(c,p)=>c<p?-1:c>p?1:0){if(this.data=r,this.length=this.data.length,this.compare=o,this.length>0)for(let c=(this.length>>1)-1;c>=0;c--)this._down(c)}push(r){this.data.push(r),this._up(this.length++)}pop(){if(this.length===0)return;const r=this.data[0],o=this.data.pop();return--this.length>0&&(this.data[0]=o,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:o,compare:c}=this,p=o[r];for(;r>0;){const _=r-1>>1,v=o[_];if(c(p,v)>=0)break;o[r]=v,r=_}o[r]=p}_down(r){const{data:o,compare:c}=this,p=this.length>>1,_=o[r];for(;r<p;){let v=1+(r<<1);const b=v+1;if(b<this.length&&c(o[b],o[v])<0&&(v=b),c(o[v],_)>=0)break;o[r]=o[v],r=v}o[r]=_}}function vI(i,r=1,o=!1){let c=1/0,p=1/0,_=-1/0,v=-1/0;const b=i[0];for(let O=0;O<b.length;O++){const j=b[O];(!O||j.x<c)&&(c=j.x),(!O||j.y<p)&&(p=j.y),(!O||j.x>_)&&(_=j.x),(!O||j.y>v)&&(v=j.y)}const S=Math.min(_-c,v-p);let k=S/2;const E=new _I([],xI);if(S===0)return new N(c,p);for(let O=c;O<_;O+=S)for(let j=p;j<v;j+=S)E.push(new Vc(O+k,j+k,k,i));let A=function(O){let j=0,V=0,Y=0;const re=O[0];for(let ye=0,ce=re.length,me=ce-1;ye<ce;me=ye++){const Ce=re[ye],Le=re[me],Xe=Ce.x*Le.y-Le.x*Ce.y;V+=(Ce.x+Le.x)*Xe,Y+=(Ce.y+Le.y)*Xe,j+=3*Xe}return new Vc(V/j,Y/j,0,O)}(i),R=E.length;for(;E.length;){const O=E.pop();(O.d>A.d||!A.d)&&(A=O,o&&console.log("found best %d after %d probes",Math.round(1e4*O.d)/1e4,R)),O.max-A.d<=r||(k=O.h/2,E.push(new Vc(O.p.x-k,O.p.y-k,k,i)),E.push(new Vc(O.p.x+k,O.p.y-k,k,i)),E.push(new Vc(O.p.x-k,O.p.y+k,k,i)),E.push(new Vc(O.p.x+k,O.p.y+k,k,i)),R+=4)}return o&&(console.log(`num probes: ${R}`),console.log(`best distance: ${A.d}`)),A.p}function xI(i,r){return r.max-i.max}function Vc(i,r,o,c){this.p=new N(i,r),this.h=o,this.d=function(p,_){let v=!1,b=1/0;for(let S=0;S<_.length;S++){const k=_[S];for(let E=0,A=k.length,R=A-1;E<A;R=E++){const O=k[E],j=k[R];O.y>p.y!=j.y>p.y&&p.x<(j.x-O.x)*(p.y-O.y)/(j.y-O.y)+O.x&&(v=!v),b=Math.min(b,zx(p,O,j))}}return(v?1:-1)*Math.sqrt(b)}(this.p,c),this.max=this.d+this.h*Math.SQRT2}var wr;x.aq=void 0,(wr=x.aq||(x.aq={}))[wr.center=1]="center",wr[wr.left=2]="left",wr[wr.right=3]="right",wr[wr.top=4]="top",wr[wr.bottom=5]="bottom",wr[wr["top-left"]=6]="top-left",wr[wr["top-right"]=7]="top-right",wr[wr["bottom-left"]=8]="bottom-left",wr[wr["bottom-right"]=9]="bottom-right";const Ra=7,Uy=Number.POSITIVE_INFINITY;function X1(i,r){return r[1]!==Uy?function(o,c,p){let _=0,v=0;switch(c=Math.abs(c),p=Math.abs(p),o){case"top-right":case"top-left":case"top":v=p-Ra;break;case"bottom-right":case"bottom-left":case"bottom":v=-p+Ra}switch(o){case"top-right":case"bottom-right":case"right":_=-c;break;case"top-left":case"bottom-left":case"left":_=c}return[_,v]}(i,r[0],r[1]):function(o,c){let p=0,_=0;c<0&&(c=0);const v=c/Math.SQRT2;switch(o){case"top-right":case"top-left":_=v-Ra;break;case"bottom-right":case"bottom-left":_=-v+Ra;break;case"bottom":_=-c+Ra;break;case"top":_=c-Ra}switch(o){case"top-right":case"bottom-right":p=-v;break;case"top-left":case"bottom-left":p=v;break;case"left":p=c;break;case"right":p=-c}return[p,_]}(i,r[0])}function Y1(i,r,o){var c;const p=i.layout,_=(c=p.get("text-variable-anchor-offset"))===null||c===void 0?void 0:c.evaluate(r,{},o);if(_){const b=_.values,S=[];for(let k=0;k<b.length;k+=2){const E=S[k]=b[k],A=b[k+1].map(R=>R*Jn);E.startsWith("top")?A[1]-=Ra:E.startsWith("bottom")&&(A[1]+=Ra),S[k+1]=A}return new Si(S)}const v=p.get("text-variable-anchor");if(v){let b;b=i._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[p.get("text-radial-offset").evaluate(r,{},o)*Jn,Uy]:p.get("text-offset").evaluate(r,{},o).map(k=>k*Jn);const S=[];for(const k of v)S.push(k,X1(k,b));return new Si(S)}return null}function Vy(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function bI(i,r,o,c,p,_,v,b,S,k,E){let A=_.textMaxSize.evaluate(r,{});A===void 0&&(A=v);const R=i.layers[0].layout,O=R.get("icon-offset").evaluate(r,{},E),j=Q1(o.horizontal),V=v/24,Y=i.tilePixelRatio*V,re=i.tilePixelRatio*A/24,ye=i.tilePixelRatio*b,ce=i.tilePixelRatio*R.get("symbol-spacing"),me=R.get("text-padding")*i.tilePixelRatio,Ce=function(Ie,at,ot,bt=1){const cn=Ie.get("icon-padding").evaluate(at,{},ot),on=cn&&cn.values;return[on[0]*bt,on[1]*bt,on[2]*bt,on[3]*bt]}(R,r,E,i.tilePixelRatio),Le=R.get("text-max-angle")/180*Math.PI,Xe=R.get("text-rotation-alignment")!=="viewport"&&R.get("symbol-placement")!=="point",ft=R.get("icon-rotation-alignment")==="map"&&R.get("symbol-placement")!=="point",We=R.get("symbol-placement"),qe=ce/2,st=R.get("icon-text-fit");let nt;c&&st!=="none"&&(i.allowVerticalPlacement&&o.vertical&&(nt=w1(c,o.vertical,st,R.get("icon-text-fit-padding"),O,V)),j&&(c=w1(c,j,st,R.get("icon-text-fit-padding"),O,V)));const Je=(Ie,at)=>{at.x<0||at.x>=Wn||at.y<0||at.y>=Wn||function(ot,bt,cn,on,or,vo,Sr,sr,Kr,Xr,Yr,Bn,ar,Fr,Tr,Jr,Cr,Yi,mi,qt,fn,Sn,Ai,zn,Gc){const ls=ot.addToLineVertexArray(bt,cn);let cs,xo,Ji,pr,$s=0,Xh=0,rb=0,ib=0,Yy=-1,Jy=-1;const js={};let ob=Ac("");if(ot.allowVerticalPlacement&&on.vertical){const Br=sr.layout.get("text-rotate").evaluate(fn,{},zn)+90;Ji=new lf(Kr,bt,Xr,Yr,Bn,on.vertical,ar,Fr,Tr,Br),Sr&&(pr=new lf(Kr,bt,Xr,Yr,Bn,Sr,Cr,Yi,Tr,Br))}if(or){const Br=sr.layout.get("icon-rotate").evaluate(fn,{}),Qi=sr.layout.get("icon-text-fit")!=="none",kl=W1(or,Br,Ai,Qi),qo=Sr?W1(Sr,Br,Ai,Qi):void 0;xo=new lf(Kr,bt,Xr,Yr,Bn,or,Cr,Yi,!1,Br),$s=4*kl.length;const El=ot.iconSizeData;let us=null;El.kind==="source"?(us=[as*sr.layout.get("icon-size").evaluate(fn,{})],us[0]>Ma&&dt(`${ot.layerIds[0]}: Value for "icon-size" is >= ${qh}. Reduce your "icon-size".`)):El.kind==="composite"&&(us=[as*Sn.compositeIconSizes[0].evaluate(fn,{},zn),as*Sn.compositeIconSizes[1].evaluate(fn,{},zn)],(us[0]>Ma||us[1]>Ma)&&dt(`${ot.layerIds[0]}: Value for "icon-size" is >= ${qh}. Reduce your "icon-size".`)),ot.addSymbols(ot.icon,kl,us,qt,mi,fn,x.ah.none,bt,ls.lineStartIndex,ls.lineLength,-1,zn),Yy=ot.icon.placedSymbolArray.length-1,qo&&(Xh=4*qo.length,ot.addSymbols(ot.icon,qo,us,qt,mi,fn,x.ah.vertical,bt,ls.lineStartIndex,ls.lineLength,-1,zn),Jy=ot.icon.placedSymbolArray.length-1)}const sb=Object.keys(on.horizontal);for(const Br of sb){const Qi=on.horizontal[Br];if(!cs){ob=Ac(Qi.text);const qo=sr.layout.get("text-rotate").evaluate(fn,{},zn);cs=new lf(Kr,bt,Xr,Yr,Bn,Qi,ar,Fr,Tr,qo)}const kl=Qi.positionedLines.length===1;if(rb+=J1(ot,bt,Qi,vo,sr,Tr,fn,Jr,ls,on.vertical?x.ah.horizontal:x.ah.horizontalOnly,kl?sb:[Br],js,Yy,Sn,zn),kl)break}on.vertical&&(ib+=J1(ot,bt,on.vertical,vo,sr,Tr,fn,Jr,ls,x.ah.vertical,["vertical"],js,Jy,Sn,zn));const TI=cs?cs.boxStartIndex:ot.collisionBoxArray.length,CI=cs?cs.boxEndIndex:ot.collisionBoxArray.length,kI=Ji?Ji.boxStartIndex:ot.collisionBoxArray.length,EI=Ji?Ji.boxEndIndex:ot.collisionBoxArray.length,II=xo?xo.boxStartIndex:ot.collisionBoxArray.length,PI=xo?xo.boxEndIndex:ot.collisionBoxArray.length,AI=pr?pr.boxStartIndex:ot.collisionBoxArray.length,MI=pr?pr.boxEndIndex:ot.collisionBoxArray.length;let Go=-1;const uf=(Br,Qi)=>Br&&Br.circleDiameter?Math.max(Br.circleDiameter,Qi):Qi;Go=uf(cs,Go),Go=uf(Ji,Go),Go=uf(xo,Go),Go=uf(pr,Go);const ab=Go>-1?1:0;ab&&(Go*=Gc/Jn),ot.glyphOffsetArray.length>=jc.MAX_GLYPHS&&dt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),fn.sortKey!==void 0&&ot.addToSortKeyRanges(ot.symbolInstances.length,fn.sortKey);const zI=Y1(sr,fn,zn),[LI,RI]=function(Br,Qi){const kl=Br.length,qo=Qi==null?void 0:Qi.values;if((qo==null?void 0:qo.length)>0)for(let El=0;El<qo.length;El+=2){const us=qo[El+1];Br.emplaceBack(x.aq[qo[El]],us[0],us[1])}return[kl,Br.length]}(ot.textAnchorOffsets,zI);ot.symbolInstances.emplaceBack(bt.x,bt.y,js.right>=0?js.right:-1,js.center>=0?js.center:-1,js.left>=0?js.left:-1,js.vertical||-1,Yy,Jy,ob,TI,CI,kI,EI,II,PI,AI,MI,Xr,rb,ib,$s,Xh,ab,0,ar,Go,LI,RI)}(i,at,Ie,o,c,p,nt,i.layers[0],i.collisionBoxArray,r.index,r.sourceLayerIndex,i.index,Y,[me,me,me,me],Xe,S,ye,Ce,ft,O,r,_,k,E,v)};if(We==="line")for(const Ie of U1(r.geometry,0,0,Wn,Wn)){const at=yI(Ie,ce,Le,o.vertical||j,c,24,re,i.overscaling,Wn);for(const ot of at)j&&wI(i,j.text,qe,ot)||Je(Ie,ot)}else if(We==="line-center"){for(const Ie of r.geometry)if(Ie.length>1){const at=gI(Ie,Le,o.vertical||j,c,24,re);at&&Je(Ie,at)}}else if(r.type==="Polygon")for(const Ie of sc(r.geometry,0)){const at=vI(Ie,16);Je(Ie[0],new La(at.x,at.y,0))}else if(r.type==="LineString")for(const Ie of r.geometry)Je(Ie,new La(Ie[0].x,Ie[0].y,0));else if(r.type==="Point")for(const Ie of r.geometry)for(const at of Ie)Je([at],new La(at.x,at.y,0))}function J1(i,r,o,c,p,_,v,b,S,k,E,A,R,O,j){const V=function(ye,ce,me,Ce,Le,Xe,ft,We){const qe=Ce.layout.get("text-rotate").evaluate(Xe,{})*Math.PI/180,st=[];for(const nt of ce.positionedLines)for(const Je of nt.positionedGlyphs){if(!Je.rect)continue;const Ie=Je.rect||{};let at=f1+1,ot=!0,bt=1,cn=0;const on=(Le||We)&&Je.vertical,or=Je.metrics.advance*Je.scale/2;if(We&&ce.verticalizable&&(cn=nt.lineOffset/2-(Je.imageName?-(Jn-Je.metrics.width*Je.scale)/2:(Je.scale-1)*Jn)),Je.imageName){const qt=ft[Je.imageName];ot=qt.sdf,bt=qt.pixelRatio,at=fi/bt}const vo=Le?[Je.x+or,Je.y]:[0,0];let Sr=Le?[0,0]:[Je.x+or+me[0],Je.y+me[1]-cn],sr=[0,0];on&&(sr=Sr,Sr=[0,0]);const Kr=Je.metrics.isDoubleResolution?2:1,Xr=(Je.metrics.left-at)*Je.scale-or+Sr[0],Yr=(-Je.metrics.top-at)*Je.scale+Sr[1],Bn=Xr+Ie.w/Kr*Je.scale/bt,ar=Yr+Ie.h/Kr*Je.scale/bt,Fr=new N(Xr,Yr),Tr=new N(Bn,Yr),Jr=new N(Xr,ar),Cr=new N(Bn,ar);if(on){const qt=new N(-or,or-Vh),fn=-Math.PI/2,Sn=Jn/2-or,Ai=new N(5-Vh-Sn,-(Je.imageName?Sn:0)),zn=new N(...sr);Fr._rotateAround(fn,qt)._add(Ai)._add(zn),Tr._rotateAround(fn,qt)._add(Ai)._add(zn),Jr._rotateAround(fn,qt)._add(Ai)._add(zn),Cr._rotateAround(fn,qt)._add(Ai)._add(zn)}if(qe){const qt=Math.sin(qe),fn=Math.cos(qe),Sn=[fn,-qt,qt,fn];Fr._matMult(Sn),Tr._matMult(Sn),Jr._matMult(Sn),Cr._matMult(Sn)}const Yi=new N(0,0),mi=new N(0,0);st.push({tl:Fr,tr:Tr,bl:Jr,br:Cr,tex:Ie,writingMode:ce.writingMode,glyphOffset:vo,sectionIndex:Je.sectionIndex,isSDF:ot,pixelOffsetTL:Yi,pixelOffsetBR:mi,minFontScaleX:0,minFontScaleY:0})}return st}(0,o,b,p,_,v,c,i.allowVerticalPlacement),Y=i.textSizeData;let re=null;Y.kind==="source"?(re=[as*p.layout.get("text-size").evaluate(v,{})],re[0]>Ma&&dt(`${i.layerIds[0]}: Value for "text-size" is >= ${qh}. Reduce your "text-size".`)):Y.kind==="composite"&&(re=[as*O.compositeTextSizes[0].evaluate(v,{},j),as*O.compositeTextSizes[1].evaluate(v,{},j)],(re[0]>Ma||re[1]>Ma)&&dt(`${i.layerIds[0]}: Value for "text-size" is >= ${qh}. Reduce your "text-size".`)),i.addSymbols(i.text,V,re,b,_,v,k,r,S.lineStartIndex,S.lineLength,R,j);for(const ye of E)A[ye]=i.text.placedSymbolArray.length-1;return 4*V.length}function Q1(i){for(const r in i)return i[r];return null}function wI(i,r,o,c){const p=i.compareText;if(r in p){const _=p[r];for(let v=_.length-1;v>=0;v--)if(c.dist(_[v])<o)return!0}else p[r]=[];return p[r].push(c),!1}const eb=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Gy{static from(r){if(!(r instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[o,c]=new Uint8Array(r,0,2);if(o!==219)throw new Error("Data does not appear to be in a KDBush format.");const p=c>>4;if(p!==1)throw new Error(`Got v${p} data when expected v1.`);const _=eb[15&c];if(!_)throw new Error("Unrecognized array type.");const[v]=new Uint16Array(r,2,1),[b]=new Uint32Array(r,4,1);return new Gy(b,v,_,r)}constructor(r,o=64,c=Float64Array,p){if(isNaN(r)||r<0)throw new Error(`Unpexpected numItems value: ${r}.`);this.numItems=+r,this.nodeSize=Math.min(Math.max(+o,2),65535),this.ArrayType=c,this.IndexArrayType=r<65536?Uint16Array:Uint32Array;const _=eb.indexOf(this.ArrayType),v=2*r*this.ArrayType.BYTES_PER_ELEMENT,b=r*this.IndexArrayType.BYTES_PER_ELEMENT,S=(8-b%8)%8;if(_<0)throw new Error(`Unexpected typed array class: ${c}.`);p&&p instanceof ArrayBuffer?(this.data=p,this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+b+S,2*r),this._pos=2*r,this._finished=!0):(this.data=new ArrayBuffer(8+v+b+S),this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+b+S,2*r),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+_]),new Uint16Array(this.data,2,1)[0]=o,new Uint32Array(this.data,4,1)[0]=r)}add(r,o){const c=this._pos>>1;return this.ids[c]=c,this.coords[this._pos++]=r,this.coords[this._pos++]=o,c}finish(){const r=this._pos>>1;if(r!==this.numItems)throw new Error(`Added ${r} items when expected ${this.numItems}.`);return qy(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(r,o,c,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:v,nodeSize:b}=this,S=[0,_.length-1,0],k=[];for(;S.length;){const E=S.pop()||0,A=S.pop()||0,R=S.pop()||0;if(A-R<=b){for(let Y=R;Y<=A;Y++){const re=v[2*Y],ye=v[2*Y+1];re>=r&&re<=c&&ye>=o&&ye<=p&&k.push(_[Y])}continue}const O=R+A>>1,j=v[2*O],V=v[2*O+1];j>=r&&j<=c&&V>=o&&V<=p&&k.push(_[O]),(E===0?r<=j:o<=V)&&(S.push(R),S.push(O-1),S.push(1-E)),(E===0?c>=j:p>=V)&&(S.push(O+1),S.push(A),S.push(1-E))}return k}within(r,o,c){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:p,coords:_,nodeSize:v}=this,b=[0,p.length-1,0],S=[],k=c*c;for(;b.length;){const E=b.pop()||0,A=b.pop()||0,R=b.pop()||0;if(A-R<=v){for(let Y=R;Y<=A;Y++)nb(_[2*Y],_[2*Y+1],r,o)<=k&&S.push(p[Y]);continue}const O=R+A>>1,j=_[2*O],V=_[2*O+1];nb(j,V,r,o)<=k&&S.push(p[O]),(E===0?r-c<=j:o-c<=V)&&(b.push(R),b.push(O-1),b.push(1-E)),(E===0?r+c>=j:o+c>=V)&&(b.push(O+1),b.push(A),b.push(1-E))}return S}}function qy(i,r,o,c,p,_){if(p-c<=o)return;const v=c+p>>1;tb(i,r,v,c,p,_),qy(i,r,o,c,v-1,1-_),qy(i,r,o,v+1,p,1-_)}function tb(i,r,o,c,p,_){for(;p>c;){if(p-c>600){const k=p-c+1,E=o-c+1,A=Math.log(k),R=.5*Math.exp(2*A/3),O=.5*Math.sqrt(A*R*(k-R)/k)*(E-k/2<0?-1:1);tb(i,r,o,Math.max(c,Math.floor(o-E*R/k+O)),Math.min(p,Math.floor(o+(k-E)*R/k+O)),_)}const v=r[2*o+_];let b=c,S=p;for(Wh(i,r,c,o),r[2*p+_]>v&&Wh(i,r,c,p);b<S;){for(Wh(i,r,b,S),b++,S--;r[2*b+_]<v;)b++;for(;r[2*S+_]>v;)S--}r[2*c+_]===v?Wh(i,r,c,S):(S++,Wh(i,r,S,p)),S<=o&&(c=S+1),o<=S&&(p=S-1)}}function Wh(i,r,o,c){Hy(i,o,c),Hy(r,2*o,2*c),Hy(r,2*o+1,2*c+1)}function Hy(i,r,o){const c=i[r];i[r]=i[o],i[o]=c}function nb(i,r,o,c){const p=i-o,_=r-c;return p*p+_*_}var Zy;x.bg=void 0,(Zy=x.bg||(x.bg={})).create="create",Zy.load="load",Zy.fullLoad="fullLoad";let cf=null,Kh=[];const Wy=1e3/60,Ky="loadTime",Xy="fullLoadTime",SI={mark(i){performance.mark(i)},frame(i){const r=i;cf!=null&&Kh.push(r-cf),cf=r},clearMetrics(){cf=null,Kh=[],performance.clearMeasures(Ky),performance.clearMeasures(Xy);for(const i in x.bg)performance.clearMarks(x.bg[i])},getPerformanceMetrics(){performance.measure(Ky,x.bg.create,x.bg.load),performance.measure(Xy,x.bg.create,x.bg.fullLoad);const i=performance.getEntriesByName(Ky)[0].duration,r=performance.getEntriesByName(Xy)[0].duration,o=Kh.length,c=1/(Kh.reduce((_,v)=>_+v,0)/o/1e3),p=Kh.filter(_=>_>Wy).reduce((_,v)=>_+(v-Wy)/Wy,0);return{loadTime:i,fullLoadTime:r,fps:c,percentDroppedFrames:p/(o+p)*100,totalFrames:o}}};x.$=class extends M{},x.A=Dc,x.B=iy,x.C=function(i){if(yt==null){const r=i.navigator?i.navigator.userAgent:null;yt=!!i.safari||!(!r||!(/\b(iPad|iPhone|iPod)\b/.test(r)||r.match("Safari")&&!r.match("Chrome")))}return yt},x.D=rt,x.E=es,x.F=class{constructor(i,r){this.target=i,this.mapId=r,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new fI(()=>this.process()),this.subscription=function(o,c,p,_){return o.addEventListener(c,p,!1),{unsubscribe:()=>{o.removeEventListener(c,p,!1)}}}(this.target,"message",o=>this.receive(o)),this.globalScope=Lt(self)?i:window}registerMessageHandler(i,r){this.messageHandlers[i]=r}sendAsync(i,r){return new Promise((o,c)=>{const p=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[p]={resolve:o,reject:c},r&&r.signal.addEventListener("abort",()=>{delete this.resolveRejects[p];const b={id:p,type:"<cancel>",origin:location.origin,targetMapId:i.targetMapId,sourceMapId:this.mapId};this.target.postMessage(b)},{once:!0});const _=[],v=Object.assign(Object.assign({},i),{id:p,sourceMapId:this.mapId,origin:location.origin,data:va(i.data,_)});this.target.postMessage(v,{transfer:_})})}receive(i){const r=i.data,o=r.id;if(!(r.origin!=="file://"&&location.origin!=="file://"&&r.origin!=="resource://android"&&location.origin!=="resource://android"&&r.origin!==location.origin||r.targetMapId&&this.mapId!==r.targetMapId)){if(r.type==="<cancel>"){delete this.tasks[o];const c=this.abortControllers[o];return delete this.abortControllers[o],void(c&&c.abort())}if(Lt(self)||r.mustQueue)return this.tasks[o]=r,this.taskQueue.push(o),void this.invoker.trigger();this.processTask(o,r)}}process(){if(this.taskQueue.length===0)return;const i=this.taskQueue.shift(),r=this.tasks[i];delete this.tasks[i],this.taskQueue.length>0&&this.invoker.trigger(),r&&this.processTask(i,r)}processTask(i,r){return u(this,void 0,void 0,function*(){if(r.type==="<response>"){const p=this.resolveRejects[i];return delete this.resolveRejects[i],p?void(r.error?p.reject(xa(r.error)):p.resolve(xa(r.data))):void 0}if(!this.messageHandlers[r.type])return void this.completeTask(i,new Error(`Could not find a registered handler for ${r.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const o=xa(r.data),c=new AbortController;this.abortControllers[i]=c;try{const p=yield this.messageHandlers[r.type](r.sourceMapId,o,c);this.completeTask(i,null,p)}catch(p){this.completeTask(i,p)}})}completeTask(i,r,o){const c=[];delete this.abortControllers[i];const p={id:i,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:r?va(r):null,data:va(o,c)};this.target.postMessage(p,{transfer:c})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},x.G=Pn,x.H=function(){var i=new Dc(16);return Dc!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},x.I=My,x.J=function(i,r,o){var c,p,_,v,b,S,k,E,A,R,O,j,V=o[0],Y=o[1],re=o[2];return r===i?(i[12]=r[0]*V+r[4]*Y+r[8]*re+r[12],i[13]=r[1]*V+r[5]*Y+r[9]*re+r[13],i[14]=r[2]*V+r[6]*Y+r[10]*re+r[14],i[15]=r[3]*V+r[7]*Y+r[11]*re+r[15]):(p=r[1],_=r[2],v=r[3],b=r[4],S=r[5],k=r[6],E=r[7],A=r[8],R=r[9],O=r[10],j=r[11],i[0]=c=r[0],i[1]=p,i[2]=_,i[3]=v,i[4]=b,i[5]=S,i[6]=k,i[7]=E,i[8]=A,i[9]=R,i[10]=O,i[11]=j,i[12]=c*V+b*Y+A*re+r[12],i[13]=p*V+S*Y+R*re+r[13],i[14]=_*V+k*Y+O*re+r[14],i[15]=v*V+E*Y+j*re+r[15]),i},x.K=function(i,r,o){var c=o[0],p=o[1],_=o[2];return i[0]=r[0]*c,i[1]=r[1]*c,i[2]=r[2]*c,i[3]=r[3]*c,i[4]=r[4]*p,i[5]=r[5]*p,i[6]=r[6]*p,i[7]=r[7]*p,i[8]=r[8]*_,i[9]=r[9]*_,i[10]=r[10]*_,i[11]=r[11]*_,i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15],i},x.L=Fx,x.M=function(i,r){const o={};for(let c=0;c<r.length;c++){const p=r[c];p in i&&(o[p]=i[p])}return o},x.N=za,x.O=M1,x.P=N,x.Q=z1,x.R=Ki,x.S=Xi,x.T=Cc,x.U=X,x.V=Z,x.W=et,x.X=Wn,x.Y=w,x.Z=Hh,x._=u,x.a=Qt,x.a$=function(i,r){var o=i[0],c=i[1],p=i[2],_=i[3],v=i[4],b=i[5],S=i[6],k=i[7],E=i[8],A=i[9],R=i[10],O=i[11],j=i[12],V=i[13],Y=i[14],re=i[15],ye=r[0],ce=r[1],me=r[2],Ce=r[3],Le=r[4],Xe=r[5],ft=r[6],We=r[7],qe=r[8],st=r[9],nt=r[10],Je=r[11],Ie=r[12],at=r[13],ot=r[14],bt=r[15];return Math.abs(o-ye)<=Wr*Math.max(1,Math.abs(o),Math.abs(ye))&&Math.abs(c-ce)<=Wr*Math.max(1,Math.abs(c),Math.abs(ce))&&Math.abs(p-me)<=Wr*Math.max(1,Math.abs(p),Math.abs(me))&&Math.abs(_-Ce)<=Wr*Math.max(1,Math.abs(_),Math.abs(Ce))&&Math.abs(v-Le)<=Wr*Math.max(1,Math.abs(v),Math.abs(Le))&&Math.abs(b-Xe)<=Wr*Math.max(1,Math.abs(b),Math.abs(Xe))&&Math.abs(S-ft)<=Wr*Math.max(1,Math.abs(S),Math.abs(ft))&&Math.abs(k-We)<=Wr*Math.max(1,Math.abs(k),Math.abs(We))&&Math.abs(E-qe)<=Wr*Math.max(1,Math.abs(E),Math.abs(qe))&&Math.abs(A-st)<=Wr*Math.max(1,Math.abs(A),Math.abs(st))&&Math.abs(R-nt)<=Wr*Math.max(1,Math.abs(R),Math.abs(nt))&&Math.abs(O-Je)<=Wr*Math.max(1,Math.abs(O),Math.abs(Je))&&Math.abs(j-Ie)<=Wr*Math.max(1,Math.abs(j),Math.abs(Ie))&&Math.abs(V-at)<=Wr*Math.max(1,Math.abs(V),Math.abs(at))&&Math.abs(Y-ot)<=Wr*Math.max(1,Math.abs(Y),Math.abs(ot))&&Math.abs(re-bt)<=Wr*Math.max(1,Math.abs(re),Math.abs(bt))},x.a0=Ot,x.a1=jy,x.a2=Fe,x.a3=i=>{const r=window.document.createElement("video");return r.muted=!0,new Promise(o=>{r.onloadstart=()=>{o(r)};for(const c of i){const p=window.document.createElement("source");si(c)||(r.crossOrigin="Anonymous"),p.src=c,r.appendChild(p)}})},x.a4=function(){return Re++},x.a5=Ke,x.a6=jc,x.a7=dh,x.a8=Tl,x.a9=O1,x.aA=function(i){if(i.type==="custom")return new pI(i);switch(i.type){case"background":return new uI(i);case"circle":return new Yk(i);case"fill":return new fE(i);case"fill-extrusion":return new PE(i);case"heatmap":return new Qk(i);case"hillshade":return new tE(i);case"line":return new BE(i);case"raster":return new dI(i);case"symbol":return new rf(i)}},x.aB=He,x.aC=function(i,r){if(!i)return[{command:"setStyle",args:[r]}];let o=[];try{if(!$t(i.version,r.version))return[{command:"setStyle",args:[r]}];$t(i.center,r.center)||o.push({command:"setCenter",args:[r.center]}),$t(i.zoom,r.zoom)||o.push({command:"setZoom",args:[r.zoom]}),$t(i.bearing,r.bearing)||o.push({command:"setBearing",args:[r.bearing]}),$t(i.pitch,r.pitch)||o.push({command:"setPitch",args:[r.pitch]}),$t(i.sprite,r.sprite)||o.push({command:"setSprite",args:[r.sprite]}),$t(i.glyphs,r.glyphs)||o.push({command:"setGlyphs",args:[r.glyphs]}),$t(i.transition,r.transition)||o.push({command:"setTransition",args:[r.transition]}),$t(i.light,r.light)||o.push({command:"setLight",args:[r.light]}),$t(i.terrain,r.terrain)||o.push({command:"setTerrain",args:[r.terrain]}),$t(i.sky,r.sky)||o.push({command:"setSky",args:[r.sky]}),$t(i.projection,r.projection)||o.push({command:"setProjection",args:[r.projection]});const c={},p=[];(function(v,b,S,k){let E;for(E in b=b||{},v=v||{})Object.prototype.hasOwnProperty.call(v,E)&&(Object.prototype.hasOwnProperty.call(b,E)||ho(E,S,k));for(E in b)Object.prototype.hasOwnProperty.call(b,E)&&(Object.prototype.hasOwnProperty.call(v,E)?$t(v[E],b[E])||(v[E].type==="geojson"&&b[E].type==="geojson"&&Ni(v,b,E)?dn(S,{command:"setGeoJSONSourceData",args:[E,b[E].data]}):Oi(E,b,S,k)):No(E,b,S))})(i.sources,r.sources,p,c);const _=[];i.layers&&i.layers.forEach(v=>{"source"in v&&c[v.source]?o.push({command:"removeLayer",args:[v.id]}):_.push(v)}),o=o.concat(p),function(v,b,S){b=b||[];const k=(v=v||[]).map(Ts),E=b.map(Ts),A=v.reduce(ts,{}),R=b.reduce(ts,{}),O=k.slice(),j=Object.create(null);let V,Y,re,ye,ce;for(let me=0,Ce=0;me<k.length;me++)V=k[me],Object.prototype.hasOwnProperty.call(R,V)?Ce++:(dn(S,{command:"removeLayer",args:[V]}),O.splice(O.indexOf(V,Ce),1));for(let me=0,Ce=0;me<E.length;me++)V=E[E.length-1-me],O[O.length-1-me]!==V&&(Object.prototype.hasOwnProperty.call(A,V)?(dn(S,{command:"removeLayer",args:[V]}),O.splice(O.lastIndexOf(V,O.length-Ce),1)):Ce++,ye=O[O.length-me],dn(S,{command:"addLayer",args:[R[V],ye]}),O.splice(O.length-me,0,V),j[V]=!0);for(let me=0;me<E.length;me++)if(V=E[me],Y=A[V],re=R[V],!j[V]&&!$t(Y,re))if($t(Y.source,re.source)&&$t(Y["source-layer"],re["source-layer"])&&$t(Y.type,re.type)){for(ce in nr(Y.layout,re.layout,S,V,null,"setLayoutProperty"),nr(Y.paint,re.paint,S,V,null,"setPaintProperty"),$t(Y.filter,re.filter)||dn(S,{command:"setFilter",args:[V,re.filter]}),$t(Y.minzoom,re.minzoom)&&$t(Y.maxzoom,re.maxzoom)||dn(S,{command:"setLayerZoomRange",args:[V,re.minzoom,re.maxzoom]}),Y)Object.prototype.hasOwnProperty.call(Y,ce)&&ce!=="layout"&&ce!=="paint"&&ce!=="filter"&&ce!=="metadata"&&ce!=="minzoom"&&ce!=="maxzoom"&&(ce.indexOf("paint.")===0?nr(Y[ce],re[ce],S,V,ce.slice(6),"setPaintProperty"):$t(Y[ce],re[ce])||dn(S,{command:"setLayerProperty",args:[V,ce,re[ce]]}));for(ce in re)Object.prototype.hasOwnProperty.call(re,ce)&&!Object.prototype.hasOwnProperty.call(Y,ce)&&ce!=="layout"&&ce!=="paint"&&ce!=="filter"&&ce!=="metadata"&&ce!=="minzoom"&&ce!=="maxzoom"&&(ce.indexOf("paint.")===0?nr(Y[ce],re[ce],S,V,ce.slice(6),"setPaintProperty"):$t(Y[ce],re[ce])||dn(S,{command:"setLayerProperty",args:[V,ce,re[ce]]}))}else dn(S,{command:"removeLayer",args:[V]}),ye=O[O.lastIndexOf(V)+1],dn(S,{command:"addLayer",args:[re,ye]})}(_,r.layers,o)}catch(c){console.warn("Unable to compute style diff:",c),o=[{command:"setStyle",args:[r]}]}return o},x.aD=function(i){const r=[],o=i.id;return o===void 0&&r.push({message:`layers.${o}: missing required property "id"`}),i.render===void 0&&r.push({message:`layers.${o}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&r.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),r},x.aE=function i(r,o){if(Array.isArray(r)){if(!Array.isArray(o)||r.length!==o.length)return!1;for(let c=0;c<r.length;c++)if(!i(r[c],o[c]))return!1;return!0}if(typeof r=="object"&&r!==null&&o!==null){if(typeof o!="object"||Object.keys(r).length!==Object.keys(o).length)return!1;for(const c in r)if(!i(r[c],o[c]))return!1;return!0}return r===o},x.aF=tt,x.aG=Oe,x.aH=class extends bl{constructor(i,r){super(i,r),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},x.aI=Gp,x.aJ=class extends bl{constructor(i,r){super(i,r),this.current=Vk}set(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let r=1;r<16;r++)if(i[r]!==this.current[r]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}},x.aK=Cx,x.aL=kx,x.aM=tn,x.aN=class extends bl{constructor(i,r){super(i,r),this.current=[0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))}},x.aO=class extends bl{constructor(i,r){super(i,r),this.current=[0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))}},x.aP=function(i,r,o,c,p,_,v){var b=1/(r-o),S=1/(c-p),k=1/(_-v);return i[0]=-2*b,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*S,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*k,i[11]=0,i[12]=(r+o)*b,i[13]=(p+c)*S,i[14]=(v+_)*k,i[15]=1,i},x.aQ=Xk,x.aR=class extends he{},x.aS=jE,x.aT=class extends ve{},x.aU=vy,x.aV=function(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))},x.aW=jx,x.aX=xr,x.aY=Wi,x.aZ=class extends it{},x.a_=function(i,r){return i[0]===r[0]&&i[1]===r[1]&&i[2]===r[2]&&i[3]===r[3]&&i[4]===r[4]&&i[5]===r[5]&&i[6]===r[6]&&i[7]===r[7]&&i[8]===r[8]&&i[9]===r[9]&&i[10]===r[10]&&i[11]===r[11]&&i[12]===r[12]&&i[13]===r[13]&&i[14]===r[14]&&i[15]===r[15]},x.aa=function(i){const r={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,c,p,_)=>{const v=p||_;return r[c]=!v||v.toLowerCase(),""}),r["max-age"]){const o=parseInt(r["max-age"],10);isNaN(o)?delete r["max-age"]:r["max-age"]=o}return r},x.ab=function(i,r){const o=[];for(const c in i)c in r||o.push(c);return o},x.ac=_e,x.ad=function(i,r,o){var c=Math.sin(o),p=Math.cos(o),_=r[0],v=r[1],b=r[2],S=r[3],k=r[4],E=r[5],A=r[6],R=r[7];return r!==i&&(i[8]=r[8],i[9]=r[9],i[10]=r[10],i[11]=r[11],i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15]),i[0]=_*p+k*c,i[1]=v*p+E*c,i[2]=b*p+A*c,i[3]=S*p+R*c,i[4]=k*p-_*c,i[5]=E*p-v*c,i[6]=A*p-b*c,i[7]=R*p-S*c,i},x.ae=function(i){var r=new Dc(16);return r[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=i[3],r[4]=i[4],r[5]=i[5],r[6]=i[6],r[7]=i[7],r[8]=i[8],r[9]=i[9],r[10]=i[10],r[11]=i[11],r[12]=i[12],r[13]=i[13],r[14]=i[14],r[15]=i[15],r},x.af=Wp,x.ag=function(i,r){let o=0,c=0;if(i.kind==="constant")c=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:p,minZoom:_,maxZoom:v}=i,b=p?_e(Hr.interpolationFactor(p,r,_,v),0,1):0;i.kind==="camera"?c=qr.number(i.minSize,i.maxSize,b):o=b}return{uSizeT:o,uSize:c}},x.ai=function(i,{uSize:r,uSizeT:o},{lowerSize:c,upperSize:p}){return i.kind==="source"?c/as:i.kind==="composite"?qr.number(c/as,p/as,o):r},x.aj=Dy,x.ak=function(i,r,o,c){const p=r.y-i.y,_=r.x-i.x,v=c.y-o.y,b=c.x-o.x,S=v*_-b*p;if(S===0)return null;const k=(b*(i.y-o.y)-v*(i.x-o.x))/S;return new N(i.x+k*_,i.y+k*p)},x.al=U1,x.am=Ax,x.an=gy,x.ao=function(i){let r=1/0,o=1/0,c=-1/0,p=-1/0;for(const _ of i)r=Math.min(r,_.x),o=Math.min(o,_.y),c=Math.max(c,_.x),p=Math.max(p,_.y);return[r,o,c,p]},x.ap=Jn,x.ar=Ry,x.as=function(i,r){var o=r[0],c=r[1],p=r[2],_=r[3],v=r[4],b=r[5],S=r[6],k=r[7],E=r[8],A=r[9],R=r[10],O=r[11],j=r[12],V=r[13],Y=r[14],re=r[15],ye=o*b-c*v,ce=o*S-p*v,me=o*k-_*v,Ce=c*S-p*b,Le=c*k-_*b,Xe=p*k-_*S,ft=E*V-A*j,We=E*Y-R*j,qe=E*re-O*j,st=A*Y-R*V,nt=A*re-O*V,Je=R*re-O*Y,Ie=ye*Je-ce*nt+me*st+Ce*qe-Le*We+Xe*ft;return Ie?(i[0]=(b*Je-S*nt+k*st)*(Ie=1/Ie),i[1]=(p*nt-c*Je-_*st)*Ie,i[2]=(V*Xe-Y*Le+re*Ce)*Ie,i[3]=(R*Le-A*Xe-O*Ce)*Ie,i[4]=(S*qe-v*Je-k*We)*Ie,i[5]=(o*Je-p*qe+_*We)*Ie,i[6]=(Y*me-j*Xe-re*ce)*Ie,i[7]=(E*Xe-R*me+O*ce)*Ie,i[8]=(v*nt-b*qe+k*ft)*Ie,i[9]=(c*qe-o*nt-_*ft)*Ie,i[10]=(j*Le-V*me+re*ye)*Ie,i[11]=(A*me-E*Le-O*ye)*Ie,i[12]=(b*We-v*st-S*ft)*Ie,i[13]=(o*st-c*We+p*ft)*Ie,i[14]=(V*ce-j*Ce-Y*ye)*Ie,i[15]=(E*Ce-A*ce+R*ye)*Ie,i):null},x.at=Vy,x.au=Ly,x.av=Gy,x.aw=function(){const i={},r=Se.$version;for(const o in Se.$root){const c=Se.$root[o];if(c.required){let p=null;p=o==="version"?r:c.type==="array"?[]:{},p!=null&&(i[o]=p)}}return i},x.ax=kh,x.ay=yr,x.az=function(i){i=i.slice();const r=Object.create(null);for(let o=0;o<i.length;o++)r[i[o].id]=i[o];for(let o=0;o<i.length;o++)"ref"in i[o]&&(i[o]=Ss(i[o],r[i[o].ref]));return i},x.b=Tt,x.b0=function(i,r){return i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i[4]=r[4],i[5]=r[5],i[6]=r[6],i[7]=r[7],i[8]=r[8],i[9]=r[9],i[10]=r[10],i[11]=r[11],i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15],i},x.b1=function(i,r,o){return i[0]=r[0]*o[0],i[1]=r[1]*o[1],i[2]=r[2]*o[2],i[3]=r[3]*o[3],i},x.b2=function(i,r){return i[0]*r[0]+i[1]*r[1]+i[2]*r[2]+i[3]*r[3]},x.b3=be,x.b4=D1,x.b5=L1,x.b6=function(i,r,o,c,p){var _,v=1/Math.tan(r/2);return i[0]=v/o,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=v,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,p!=null&&p!==1/0?(i[10]=(p+c)*(_=1/(c-p)),i[14]=2*p*c*_):(i[10]=-1,i[14]=-2*c),i},x.b7=function(i,r,o){var c=Math.sin(o),p=Math.cos(o),_=r[4],v=r[5],b=r[6],S=r[7],k=r[8],E=r[9],A=r[10],R=r[11];return r!==i&&(i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15]),i[4]=_*p+k*c,i[5]=v*p+E*c,i[6]=b*p+A*c,i[7]=S*p+R*c,i[8]=k*p-_*c,i[9]=E*p-v*c,i[10]=A*p-b*c,i[11]=R*p-S*c,i},x.b8=W,x.b9=pe,x.bA=a1,x.bB=function(i){return i.message===Nt},x.bC=da,x.bD=di,x.ba=function(i){return i*Math.PI/180},x.bb=function(i,r){const{x:o,y:c}=Hh.fromLngLat(r);return!(i<0||i>25||c<0||c>=1||o<0||o>=1)},x.bc=function(i,r){return i[0]=r[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=r[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=r[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},x.bd=class extends I{},x.be=Ny,x.bf=SI,x.bh=An,x.bi=function(i,r){Qt.REGISTERED_PROTOCOLS[i]=r},x.bj=function(i){delete Qt.REGISTERED_PROTOCOLS[i]},x.bk=function(i,r){const o={};for(let p=0;p<i.length;p++){const _=r&&r[i[p].id]||zp(i[p]);r&&(r[i[p].id]=_);let v=o[_];v||(v=o[_]=[]),v.push(i[p])}const c=[];for(const p in o)c.push(o[p]);return c},x.bl=Qe,x.bm=B1,x.bn=N1,x.bo=g1,x.bp=function(i){i.bucket.createArrays(),i.bucket.tilePixelRatio=Wn/(512*i.bucket.overscaling),i.bucket.compareText={},i.bucket.iconsNeedLinear=!1;const r=i.bucket.layers[0],o=r.layout,c=r._unevaluatedLayout._values,p={layoutIconSize:c["icon-size"].possiblyEvaluate(new vn(i.bucket.zoom+1),i.canonical),layoutTextSize:c["text-size"].possiblyEvaluate(new vn(i.bucket.zoom+1),i.canonical),textMaxSize:c["text-size"].possiblyEvaluate(new vn(18))};if(i.bucket.textSizeData.kind==="composite"){const{minZoom:k,maxZoom:E}=i.bucket.textSizeData;p.compositeTextSizes=[c["text-size"].possiblyEvaluate(new vn(k),i.canonical),c["text-size"].possiblyEvaluate(new vn(E),i.canonical)]}if(i.bucket.iconSizeData.kind==="composite"){const{minZoom:k,maxZoom:E}=i.bucket.iconSizeData;p.compositeIconSizes=[c["icon-size"].possiblyEvaluate(new vn(k),i.canonical),c["icon-size"].possiblyEvaluate(new vn(E),i.canonical)]}const _=o.get("text-line-height")*Jn,v=o.get("text-rotation-alignment")!=="viewport"&&o.get("symbol-placement")!=="point",b=o.get("text-keep-upright"),S=o.get("text-size");for(const k of i.bucket.features){const E=o.get("text-font").evaluate(k,{},i.canonical).join(","),A=S.evaluate(k,{},i.canonical),R=p.layoutTextSize.evaluate(k,{},i.canonical),O=p.layoutIconSize.evaluate(k,{},i.canonical),j={horizontal:{},vertical:void 0},V=k.text;let Y,re=[0,0];if(V){const me=V.toString(),Ce=o.get("text-letter-spacing").evaluate(k,{},i.canonical)*Jn,Le=oy(me)?Ce:0,Xe=o.get("text-anchor").evaluate(k,{},i.canonical),ft=Y1(r,k,i.canonical);if(!ft){const nt=o.get("text-radial-offset").evaluate(k,{},i.canonical);re=nt?X1(Xe,[nt*Jn,Uy]):o.get("text-offset").evaluate(k,{},i.canonical).map(Je=>Je*Jn)}let We=v?"center":o.get("text-justify").evaluate(k,{},i.canonical);const qe=o.get("symbol-placement")==="point"?o.get("text-max-width").evaluate(k,{},i.canonical)*Jn:1/0,st=()=>{i.bucket.allowVerticalPlacement&&Eh(me)&&(j.vertical=ef(V,i.glyphMap,i.glyphPositions,i.imagePositions,E,qe,_,Xe,"left",Le,re,x.ah.vertical,!0,R,A))};if(!v&&ft){const nt=new Set;if(We==="auto")for(let Ie=0;Ie<ft.values.length;Ie+=2)nt.add(Vy(ft.values[Ie]));else nt.add(We);let Je=!1;for(const Ie of nt)if(!j.horizontal[Ie])if(Je)j.horizontal[Ie]=j.horizontal[0];else{const at=ef(V,i.glyphMap,i.glyphPositions,i.imagePositions,E,qe,_,"center",Ie,Le,re,x.ah.horizontal,!1,R,A);at&&(j.horizontal[Ie]=at,Je=at.positionedLines.length===1)}st()}else{We==="auto"&&(We=Vy(Xe));const nt=ef(V,i.glyphMap,i.glyphPositions,i.imagePositions,E,qe,_,Xe,We,Le,re,x.ah.horizontal,!1,R,A);nt&&(j.horizontal[We]=nt),st(),Eh(me)&&v&&b&&(j.vertical=ef(V,i.glyphMap,i.glyphPositions,i.imagePositions,E,qe,_,Xe,We,Le,re,x.ah.vertical,!1,R,A))}}let ye=!1;if(k.icon&&k.icon.name){const me=i.imageMap[k.icon.name];me&&(Y=oI(i.imagePositions[k.icon.name],o.get("icon-offset").evaluate(k,{},i.canonical),o.get("icon-anchor").evaluate(k,{},i.canonical)),ye=!!me.sdf,i.bucket.sdfIcons===void 0?i.bucket.sdfIcons=ye:i.bucket.sdfIcons!==ye&&dt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(me.pixelRatio!==i.bucket.pixelRatio||o.get("icon-rotate").constantOr(1)!==0)&&(i.bucket.iconsNeedLinear=!0))}const ce=Q1(j.horizontal)||j.vertical;i.bucket.iconsInText=!!ce&&ce.iconsInText,(ce||Y)&&bI(i.bucket,k,j,Y,i.imageMap,p,R,O,re,ye,i.canonical)}i.showCollisionBoxes&&i.bucket.generateCollisionDebugBuffers()},x.bq=Ey,x.br=Ty,x.bs=ky,x.bt=Pa,x.bu=Py,x.bv=class{constructor(i){this._marks={start:[i.url,"start"].join("#"),end:[i.url,"end"].join("#"),measure:i.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let i=performance.getEntriesByName(this._marks.measure);return i.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),i=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),i}},x.bw=function(i,r,o,c,p){return u(this,void 0,void 0,function*(){if(Z())try{return yield et(i,r,o,c,p)}catch{}return function(_,v,b,S,k){const E=_.width,A=_.height;lt&&Ct||(lt=new OffscreenCanvas(E,A),Ct=lt.getContext("2d",{willReadFrequently:!0})),lt.width=E,lt.height=A,Ct.drawImage(_,0,0,E,A);const R=Ct.getImageData(v,b,S,k);return Ct.clearRect(0,0,E,A),R.data}(i,r,o,c,p)})},x.bx=F1,x.by=P,x.bz=L,x.c=gr,x.d=i=>u(void 0,void 0,void 0,function*(){if(i.byteLength===0)return createImageBitmap(new ImageData(1,1));const r=new Blob([new Uint8Array(i)],{type:"image/png"});try{return createImageBitmap(r)}catch(o){throw new Error(`Could not load image because of ${o.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),x.e=xe,x.f=i=>new Promise((r,o)=>{const c=new Image;c.onload=()=>{r(c),URL.revokeObjectURL(c.src),c.onload=null,window.requestAnimationFrame(()=>{c.src=Pe})},c.onerror=()=>o(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const p=new Blob([new Uint8Array(i)],{type:"image/png"});c.src=i.byteLength?URL.createObjectURL(p):Pe}),x.g=_n,x.h=(i,r)=>$n(xe(i,{type:"json"}),r),x.i=Lt,x.j=zr,x.k=ur,x.l=(i,r)=>$n(xe(i,{type:"arrayBuffer"}),r),x.m=$n,x.n=function(i){return new Py(i).readFields(JE,[])},x.o=Fh,x.p=m1,x.q=g,x.r=ry,x.s=si,x.t=Th,x.u=Fs,x.v=Se,x.w=dt,x.x=function([i,r,o]){return r+=90,r*=Math.PI/180,o*=Math.PI/180,{x:i*Math.cos(r)*Math.sin(o),y:i*Math.sin(r)*Math.sin(o),z:i*Math.cos(o)}},x.y=qr,x.z=vn}),f("worker",["./shared"],function(x){class u{constructor(B){this.keyCache={},B&&this.replace(B)}replace(B){this._layerConfigs={},this._layers={},this.update(B,[])}update(B,F){for(const J of B){this._layerConfigs[J.id]=J;const ue=this._layers[J.id]=x.aA(J);ue._featureFilter=x.a7(ue.filter),this.keyCache[J.id]&&delete this.keyCache[J.id]}for(const J of F)delete this.keyCache[J],delete this._layerConfigs[J],delete this._layers[J];this.familiesBySource={};const q=x.bk(Object.values(this._layerConfigs),this.keyCache);for(const J of q){const ue=J.map(we=>this._layers[we.id]),de=ue[0];if(de.visibility==="none")continue;const ge=de.source||"";let ae=this.familiesBySource[ge];ae||(ae=this.familiesBySource[ge]={});const Ee=de.sourceLayer||"_geojsonTileLayer";let ze=ae[Ee];ze||(ze=ae[Ee]=[]),ze.push(ue)}}}class P{constructor(B){const F={},q=[];for(const ge in B){const ae=B[ge],Ee=F[ge]={};for(const ze in ae){const we=ae[+ze];if(!we||we.bitmap.width===0||we.bitmap.height===0)continue;const $e={x:0,y:0,w:we.bitmap.width+2,h:we.bitmap.height+2};q.push($e),Ee[ze]={rect:$e,metrics:we.metrics}}}const{w:J,h:ue}=x.p(q),de=new x.o({width:J||1,height:ue||1});for(const ge in B){const ae=B[ge];for(const Ee in ae){const ze=ae[+Ee];if(!ze||ze.bitmap.width===0||ze.bitmap.height===0)continue;const we=F[ge][Ee].rect;x.o.copy(ze.bitmap,de,{x:0,y:0},{x:we.x+1,y:we.y+1},ze.bitmap)}}this.image=de,this.positions=F}}x.bl("GlyphAtlas",P);class L{constructor(B){this.tileID=new x.S(B.tileID.overscaledZ,B.tileID.wrap,B.tileID.canonical.z,B.tileID.canonical.x,B.tileID.canonical.y),this.uid=B.uid,this.zoom=B.zoom,this.pixelRatio=B.pixelRatio,this.tileSize=B.tileSize,this.source=B.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=B.showCollisionBoxes,this.collectResourceTiming=!!B.collectResourceTiming,this.returnDependencies=!!B.returnDependencies,this.promoteId=B.promoteId,this.inFlightDependencies=[]}parse(B,F,q,J){return x._(this,void 0,void 0,function*(){this.status="parsing",this.data=B,this.collisionBoxArray=new x.a5;const ue=new x.bm(Object.keys(B.layers).sort()),de=new x.bn(this.tileID,this.promoteId);de.bucketLayerIDs=[];const ge={},ae={featureIndex:de,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:q},Ee=F.familiesBySource[this.source];for(const zt in Ee){const en=B.layers[zt];if(!en)continue;en.version===1&&x.w(`Vector tile source "${this.source}" layer "${zt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const kn=ue.encode(zt),ir=[];for(let hr=0;hr<en.length;hr++){const Lr=en.feature(hr),ta=de.getId(Lr,zt);ir.push({feature:Lr,id:ta,index:hr,sourceLayerIndex:kn})}for(const hr of Ee[zt]){const Lr=hr[0];Lr.source!==this.source&&x.w(`layer.source = ${Lr.source} does not equal this.source = ${this.source}`),Lr.minzoom&&this.zoom<Math.floor(Lr.minzoom)||Lr.maxzoom&&this.zoom>=Lr.maxzoom||Lr.visibility!=="none"&&(U(hr,this.zoom,q),(ge[Lr.id]=Lr.createBucket({index:de.bucketLayerIDs.length,layers:hr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:kn,sourceID:this.source})).populate(ir,ae,this.tileID.canonical),de.bucketLayerIDs.push(hr.map(ta=>ta.id)))}}const ze=x.aF(ae.glyphDependencies,zt=>Object.keys(zt).map(Number));this.inFlightDependencies.forEach(zt=>zt==null?void 0:zt.abort()),this.inFlightDependencies=[];let we=Promise.resolve({});if(Object.keys(ze).length){const zt=new AbortController;this.inFlightDependencies.push(zt),we=J.sendAsync({type:"GG",data:{stacks:ze,source:this.source,tileID:this.tileID,type:"glyphs"}},zt)}const $e=Object.keys(ae.iconDependencies);let ct=Promise.resolve({});if($e.length){const zt=new AbortController;this.inFlightDependencies.push(zt),ct=J.sendAsync({type:"GI",data:{icons:$e,source:this.source,tileID:this.tileID,type:"icons"}},zt)}const pt=Object.keys(ae.patternDependencies);let jt=Promise.resolve({});if(pt.length){const zt=new AbortController;this.inFlightDependencies.push(zt),jt=J.sendAsync({type:"GI",data:{icons:pt,source:this.source,tileID:this.tileID,type:"patterns"}},zt)}const[Et,Ut,Dt]=yield Promise.all([we,ct,jt]),Hn=new P(Et),Mn=new x.bo(Ut,Dt);for(const zt in ge){const en=ge[zt];en instanceof x.a6?(U(en.layers,this.zoom,q),x.bp({bucket:en,glyphMap:Et,glyphPositions:Hn.positions,imageMap:Ut,imagePositions:Mn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):en.hasPattern&&(en instanceof x.bq||en instanceof x.br||en instanceof x.bs)&&(U(en.layers,this.zoom,q),en.addFeatures(ae,this.tileID.canonical,Mn.patternPositions))}return this.status="done",{buckets:Object.values(ge).filter(zt=>!zt.isEmpty()),featureIndex:de,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Hn.image,imageAtlas:Mn,glyphMap:this.returnDependencies?Et:null,iconMap:this.returnDependencies?Ut:null,glyphPositions:this.returnDependencies?Hn.positions:null}})}}function U(te,B,F){const q=new x.z(B);for(const J of te)J.recalculate(q,F)}class N{constructor(B,F,q){this.actor=B,this.layerIndex=F,this.availableImages=q,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(B,F){return x._(this,void 0,void 0,function*(){const q=yield x.l(B.request,F);try{return{vectorTile:new x.bt.VectorTile(new x.bu(q.data)),rawData:q.data,cacheControl:q.cacheControl,expires:q.expires}}catch(J){const ue=new Uint8Array(q.data);let de=`Unable to parse the tile at ${B.request.url}, `;throw de+=ue[0]===31&&ue[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${J.message}`,new Error(de)}})}loadTile(B){return x._(this,void 0,void 0,function*(){const F=B.uid,q=!!(B&&B.request&&B.request.collectResourceTiming)&&new x.bv(B.request),J=new L(B);this.loading[F]=J;const ue=new AbortController;J.abort=ue;try{const de=yield this.loadVectorTile(B,ue);if(delete this.loading[F],!de)return null;const ge=de.rawData,ae={};de.expires&&(ae.expires=de.expires),de.cacheControl&&(ae.cacheControl=de.cacheControl);const Ee={};if(q){const we=q.finish();we&&(Ee.resourceTiming=JSON.parse(JSON.stringify(we)))}J.vectorTile=de.vectorTile;const ze=J.parse(de.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[F]=J,this.fetching[F]={rawTileData:ge,cacheControl:ae,resourceTiming:Ee};try{const we=yield ze;return x.e({rawTileData:ge.slice(0)},we,ae,Ee)}finally{delete this.fetching[F]}}catch(de){throw delete this.loading[F],J.status="done",this.loaded[F]=J,de}})}reloadTile(B){return x._(this,void 0,void 0,function*(){const F=B.uid;if(!this.loaded||!this.loaded[F])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const q=this.loaded[F];if(q.showCollisionBoxes=B.showCollisionBoxes,q.status==="parsing"){const J=yield q.parse(q.vectorTile,this.layerIndex,this.availableImages,this.actor);let ue;if(this.fetching[F]){const{rawTileData:de,cacheControl:ge,resourceTiming:ae}=this.fetching[F];delete this.fetching[F],ue=x.e({rawTileData:de.slice(0)},J,ge,ae)}else ue=J;return ue}if(q.status==="done"&&q.vectorTile)return q.parse(q.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(B){return x._(this,void 0,void 0,function*(){const F=this.loading,q=B.uid;F&&F[q]&&F[q].abort&&(F[q].abort.abort(),delete F[q])})}removeTile(B){return x._(this,void 0,void 0,function*(){this.loaded&&this.loaded[B.uid]&&delete this.loaded[B.uid]})}}class D{constructor(){this.loaded={}}loadTile(B){return x._(this,void 0,void 0,function*(){const{uid:F,encoding:q,rawImageData:J,redFactor:ue,greenFactor:de,blueFactor:ge,baseShift:ae}=B,Ee=J.width+2,ze=J.height+2,we=x.b(J)?new x.R({width:Ee,height:ze},yield x.bw(J,-1,-1,Ee,ze)):J,$e=new x.bx(F,we,q,ue,de,ge,ae);return this.loaded=this.loaded||{},this.loaded[F]=$e,$e})}removeTile(B){const F=this.loaded,q=B.uid;F&&F[q]&&delete F[q]}}function se(te,B){if(te.length!==0){ne(te[0],B);for(var F=1;F<te.length;F++)ne(te[F],!B)}}function ne(te,B){for(var F=0,q=0,J=0,ue=te.length,de=ue-1;J<ue;de=J++){var ge=(te[J][0]-te[de][0])*(te[de][1]+te[J][1]),ae=F+ge;q+=Math.abs(F)>=Math.abs(ge)?F-ae+ge:ge-ae+F,F=ae}F+q>=0!=!!B&&te.reverse()}var ee=x.by(function te(B,F){var q,J=B&&B.type;if(J==="FeatureCollection")for(q=0;q<B.features.length;q++)te(B.features[q],F);else if(J==="GeometryCollection")for(q=0;q<B.geometries.length;q++)te(B.geometries[q],F);else if(J==="Feature")te(B.geometry,F);else if(J==="Polygon")se(B.coordinates,F);else if(J==="MultiPolygon")for(q=0;q<B.coordinates.length;q++)se(B.coordinates[q],F);return B});const ke=x.bt.VectorTileFeature.prototype.toGeoJSON;var X={exports:{}},Z=x.bz,W=x.bt.VectorTileFeature,pe=_e;function _e(te,B){this.options=B||{},this.features=te,this.length=te.length}function be(te,B){this.id=typeof te.id=="number"?te.id:void 0,this.type=te.type,this.rawGeometry=te.type===1?[te.geometry]:te.geometry,this.properties=te.tags,this.extent=B||4096}_e.prototype.feature=function(te){return new be(this.features[te],this.options.extent)},be.prototype.loadGeometry=function(){var te=this.rawGeometry;this.geometry=[];for(var B=0;B<te.length;B++){for(var F=te[B],q=[],J=0;J<F.length;J++)q.push(new Z(F[J][0],F[J][1]));this.geometry.push(q)}return this.geometry},be.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var te=this.geometry,B=1/0,F=-1/0,q=1/0,J=-1/0,ue=0;ue<te.length;ue++)for(var de=te[ue],ge=0;ge<de.length;ge++){var ae=de[ge];B=Math.min(B,ae.x),F=Math.max(F,ae.x),q=Math.min(q,ae.y),J=Math.max(J,ae.y)}return[B,q,F,J]},be.prototype.toGeoJSON=W.prototype.toGeoJSON;var xe=x.bA,Re=pe;function tt(te){var B=new xe;return function(F,q){for(var J in F.layers)q.writeMessage(3,Oe,F.layers[J])}(te,B),B.finish()}function Oe(te,B){var F;B.writeVarintField(15,te.version||1),B.writeStringField(1,te.name||""),B.writeVarintField(5,te.extent||4096);var q={keys:[],values:[],keycache:{},valuecache:{}};for(F=0;F<te.length;F++)q.feature=te.feature(F),B.writeMessage(2,He,q);var J=q.keys;for(F=0;F<J.length;F++)B.writeStringField(3,J[F]);var ue=q.values;for(F=0;F<ue.length;F++)B.writeMessage(4,yt,ue[F])}function He(te,B){var F=te.feature;F.id!==void 0&&B.writeVarintField(1,F.id),B.writeMessage(2,vt,te),B.writeVarintField(3,F.type),B.writeMessage(4,Lt,F)}function vt(te,B){var F=te.feature,q=te.keys,J=te.values,ue=te.keycache,de=te.valuecache;for(var ge in F.properties){var ae=F.properties[ge],Ee=ue[ge];if(ae!==null){Ee===void 0&&(q.push(ge),ue[ge]=Ee=q.length-1),B.writeVarint(Ee);var ze=typeof ae;ze!=="string"&&ze!=="boolean"&&ze!=="number"&&(ae=JSON.stringify(ae));var we=ze+":"+ae,$e=de[we];$e===void 0&&(J.push(ae),de[we]=$e=J.length-1),B.writeVarint($e)}}}function dt(te,B){return(B<<3)+(7&te)}function ht(te){return te<<1^te>>31}function Lt(te,B){for(var F=te.loadGeometry(),q=te.type,J=0,ue=0,de=F.length,ge=0;ge<de;ge++){var ae=F[ge],Ee=1;q===1&&(Ee=ae.length),B.writeVarint(dt(1,Ee));for(var ze=q===3?ae.length-1:ae.length,we=0;we<ze;we++){we===1&&q!==1&&B.writeVarint(dt(2,ze-1));var $e=ae[we].x-J,ct=ae[we].y-ue;B.writeVarint(ht($e)),B.writeVarint(ht(ct)),J+=$e,ue+=ct}q===3&&B.writeVarint(dt(7,1))}}function yt(te,B){var F=typeof te;F==="string"?B.writeStringField(1,te):F==="boolean"?B.writeBooleanField(7,te):F==="number"&&(te%1!=0?B.writeDoubleField(3,te):te<0?B.writeSVarintField(6,te):B.writeVarintField(5,te))}X.exports=tt,X.exports.fromVectorTileJs=tt,X.exports.fromGeojsonVt=function(te,B){B=B||{};var F={};for(var q in te)F[q]=new Re(te[q].features,B),F[q].name=q,F[q].version=B.version,F[q].extent=B.extent;return tt({layers:F})},X.exports.GeoJSONWrapper=Re;var Tt=x.by(X.exports);const Pe={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:te=>te},et=Math.fround||(lt=new Float32Array(1),te=>(lt[0]=+te,lt[0]));var lt;const Ct=3,Nt=5,gr=6;class Qt{constructor(B){this.options=Object.assign(Object.create(Pe),B),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(B){const{log:F,minZoom:q,maxZoom:J}=this.options;F&&console.time("total time");const ue=`prepare ${B.length} points`;F&&console.time(ue),this.points=B;const de=[];for(let ae=0;ae<B.length;ae++){const Ee=B[ae];if(!Ee.geometry)continue;const[ze,we]=Ee.geometry.coordinates,$e=et(An(ze)),ct=et(yr(we));de.push($e,ct,1/0,ae,-1,1),this.options.reduce&&de.push(0)}let ge=this.trees[J+1]=this._createTree(de);F&&console.timeEnd(ue);for(let ae=J;ae>=q;ae--){const Ee=+Date.now();ge=this.trees[ae]=this._createTree(this._cluster(ge,ae)),F&&console.log("z%d: %d clusters in %dms",ae,ge.numItems,+Date.now()-Ee)}return F&&console.timeEnd("total time"),this}getClusters(B,F){let q=((B[0]+180)%360+360)%360-180;const J=Math.max(-90,Math.min(90,B[1]));let ue=B[2]===180?180:((B[2]+180)%360+360)%360-180;const de=Math.max(-90,Math.min(90,B[3]));if(B[2]-B[0]>=360)q=-180,ue=180;else if(q>ue){const we=this.getClusters([q,J,180,de],F),$e=this.getClusters([-180,J,ue,de],F);return we.concat($e)}const ge=this.trees[this._limitZoom(F)],ae=ge.range(An(q),yr(de),An(ue),yr(J)),Ee=ge.data,ze=[];for(const we of ae){const $e=this.stride*we;ze.push(Ee[$e+Nt]>1?_n(Ee,$e,this.clusterProps):this.points[Ee[$e+Ct]])}return ze}getChildren(B){const F=this._getOriginId(B),q=this._getOriginZoom(B),J="No cluster with the specified id.",ue=this.trees[q];if(!ue)throw new Error(J);const de=ue.data;if(F*this.stride>=de.length)throw new Error(J);const ge=this.options.radius/(this.options.extent*Math.pow(2,q-1)),ae=ue.within(de[F*this.stride],de[F*this.stride+1],ge),Ee=[];for(const ze of ae){const we=ze*this.stride;de[we+4]===B&&Ee.push(de[we+Nt]>1?_n(de,we,this.clusterProps):this.points[de[we+Ct]])}if(Ee.length===0)throw new Error(J);return Ee}getLeaves(B,F,q){const J=[];return this._appendLeaves(J,B,F=F||10,q=q||0,0),J}getTile(B,F,q){const J=this.trees[this._limitZoom(B)],ue=Math.pow(2,B),{extent:de,radius:ge}=this.options,ae=ge/de,Ee=(q-ae)/ue,ze=(q+1+ae)/ue,we={features:[]};return this._addTileFeatures(J.range((F-ae)/ue,Ee,(F+1+ae)/ue,ze),J.data,F,q,ue,we),F===0&&this._addTileFeatures(J.range(1-ae/ue,Ee,1,ze),J.data,ue,q,ue,we),F===ue-1&&this._addTileFeatures(J.range(0,Ee,ae/ue,ze),J.data,-1,q,ue,we),we.features.length?we:null}getClusterExpansionZoom(B){let F=this._getOriginZoom(B)-1;for(;F<=this.options.maxZoom;){const q=this.getChildren(B);if(F++,q.length!==1)break;B=q[0].properties.cluster_id}return F}_appendLeaves(B,F,q,J,ue){const de=this.getChildren(F);for(const ge of de){const ae=ge.properties;if(ae&&ae.cluster?ue+ae.point_count<=J?ue+=ae.point_count:ue=this._appendLeaves(B,ae.cluster_id,q,J,ue):ue<J?ue++:B.push(ge),B.length===q)break}return ue}_createTree(B){const F=new x.av(B.length/this.stride|0,this.options.nodeSize,Float32Array);for(let q=0;q<B.length;q+=this.stride)F.add(B[q],B[q+1]);return F.finish(),F.data=B,F}_addTileFeatures(B,F,q,J,ue,de){for(const ge of B){const ae=ge*this.stride,Ee=F[ae+Nt]>1;let ze,we,$e;if(Ee)ze=Pn(F,ae,this.clusterProps),we=F[ae],$e=F[ae+1];else{const jt=this.points[F[ae+Ct]];ze=jt.properties;const[Et,Ut]=jt.geometry.coordinates;we=An(Et),$e=yr(Ut)}const ct={type:1,geometry:[[Math.round(this.options.extent*(we*ue-q)),Math.round(this.options.extent*($e*ue-J))]],tags:ze};let pt;pt=Ee||this.options.generateId?F[ae+Ct]:this.points[F[ae+Ct]].id,pt!==void 0&&(ct.id=pt),de.features.push(ct)}}_limitZoom(B){return Math.max(this.options.minZoom,Math.min(Math.floor(+B),this.options.maxZoom+1))}_cluster(B,F){const{radius:q,extent:J,reduce:ue,minPoints:de}=this.options,ge=q/(J*Math.pow(2,F)),ae=B.data,Ee=[],ze=this.stride;for(let we=0;we<ae.length;we+=ze){if(ae[we+2]<=F)continue;ae[we+2]=F;const $e=ae[we],ct=ae[we+1],pt=B.within(ae[we],ae[we+1],ge),jt=ae[we+Nt];let Et=jt;for(const Ut of pt){const Dt=Ut*ze;ae[Dt+2]>F&&(Et+=ae[Dt+Nt])}if(Et>jt&&Et>=de){let Ut,Dt=$e*jt,Hn=ct*jt,Mn=-1;const zt=((we/ze|0)<<5)+(F+1)+this.points.length;for(const en of pt){const kn=en*ze;if(ae[kn+2]<=F)continue;ae[kn+2]=F;const ir=ae[kn+Nt];Dt+=ae[kn]*ir,Hn+=ae[kn+1]*ir,ae[kn+4]=zt,ue&&(Ut||(Ut=this._map(ae,we,!0),Mn=this.clusterProps.length,this.clusterProps.push(Ut)),ue(Ut,this._map(ae,kn)))}ae[we+4]=zt,Ee.push(Dt/Et,Hn/Et,1/0,zt,-1,Et),ue&&Ee.push(Mn)}else{for(let Ut=0;Ut<ze;Ut++)Ee.push(ae[we+Ut]);if(Et>1)for(const Ut of pt){const Dt=Ut*ze;if(!(ae[Dt+2]<=F)){ae[Dt+2]=F;for(let Hn=0;Hn<ze;Hn++)Ee.push(ae[Dt+Hn])}}}}return Ee}_getOriginId(B){return B-this.points.length>>5}_getOriginZoom(B){return(B-this.points.length)%32}_map(B,F,q){if(B[F+Nt]>1){const de=this.clusterProps[B[F+gr]];return q?Object.assign({},de):de}const J=this.points[B[F+Ct]].properties,ue=this.options.map(J);return q&&ue===J?Object.assign({},ue):ue}}function _n(te,B,F){return{type:"Feature",id:te[B+Ct],properties:Pn(te,B,F),geometry:{type:"Point",coordinates:[(q=te[B],360*(q-.5)),$n(te[B+1])]}};var q}function Pn(te,B,F){const q=te[B+Nt],J=q>=1e4?`${Math.round(q/1e3)}k`:q>=1e3?Math.round(q/100)/10+"k":q,ue=te[B+gr],de=ue===-1?{}:Object.assign({},F[ue]);return Object.assign(de,{cluster:!0,cluster_id:te[B+Ct],point_count:q,point_count_abbreviated:J})}function An(te){return te/360+.5}function yr(te){const B=Math.sin(te*Math.PI/180),F=.5-.25*Math.log((1+B)/(1-B))/Math.PI;return F<0?0:F>1?1:F}function $n(te){const B=(180-360*te)*Math.PI/180;return 360*Math.atan(Math.exp(B))/Math.PI-90}function si(te,B,F,q){let J=q;const ue=B+(F-B>>1);let de,ge=F-B;const ae=te[B],Ee=te[B+1],ze=te[F],we=te[F+1];for(let $e=B+3;$e<F;$e+=3){const ct=Bo(te[$e],te[$e+1],ae,Ee,ze,we);if(ct>J)de=$e,J=ct;else if(ct===J){const pt=Math.abs($e-ue);pt<ge&&(de=$e,ge=pt)}}J>q&&(de-B>3&&si(te,B,de,q),te[de+2]=J,F-de>3&&si(te,de,F,q))}function Bo(te,B,F,q,J,ue){let de=J-F,ge=ue-q;if(de!==0||ge!==0){const ae=((te-F)*de+(B-q)*ge)/(de*de+ge*ge);ae>1?(F=J,q=ue):ae>0&&(F+=de*ae,q+=ge*ae)}return de=te-F,ge=B-q,de*de+ge*ge}function ai(te,B,F,q){const J={id:te??null,type:B,geometry:F,tags:q,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(B==="Point"||B==="MultiPoint"||B==="LineString")ur(J,F);else if(B==="Polygon")ur(J,F[0]);else if(B==="MultiLineString")for(const ue of F)ur(J,ue);else if(B==="MultiPolygon")for(const ue of F)ur(J,ue[0]);return J}function ur(te,B){for(let F=0;F<B.length;F+=3)te.minX=Math.min(te.minX,B[F]),te.minY=Math.min(te.minY,B[F+1]),te.maxX=Math.max(te.maxX,B[F]),te.maxY=Math.max(te.maxY,B[F+1])}function zr(te,B,F,q){if(!B.geometry)return;const J=B.geometry.coordinates;if(J&&J.length===0)return;const ue=B.geometry.type,de=Math.pow(F.tolerance/((1<<F.maxZoom)*F.extent),2);let ge=[],ae=B.id;if(F.promoteId?ae=B.properties[F.promoteId]:F.generateId&&(ae=q||0),ue==="Point")es(J,ge);else if(ue==="MultiPoint")for(const Ee of J)es(Ee,ge);else if(ue==="LineString")Se(J,ge,de,!1);else if(ue==="MultiLineString"){if(F.lineMetrics){for(const Ee of J)ge=[],Se(Ee,ge,de,!1),te.push(ai(ae,"LineString",ge,B.properties));return}Oo(J,ge,de,!1)}else if(ue==="Polygon")Oo(J,ge,de,!0);else{if(ue!=="MultiPolygon"){if(ue==="GeometryCollection"){for(const Ee of B.geometry.geometries)zr(te,{id:ae,geometry:Ee,properties:B.properties},F,q);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Ee of J){const ze=[];Oo(Ee,ze,de,!0),ge.push(ze)}}te.push(ai(ae,ue,ge,B.properties))}function es(te,B){B.push(Ss(te[0]),$t(te[1]),0)}function Se(te,B,F,q){let J,ue,de=0;for(let ae=0;ae<te.length;ae++){const Ee=Ss(te[ae][0]),ze=$t(te[ae][1]);B.push(Ee,ze,0),ae>0&&(de+=q?(J*ze-Ee*ue)/2:Math.sqrt(Math.pow(Ee-J,2)+Math.pow(ze-ue,2))),J=Ee,ue=ze}const ge=B.length-3;B[2]=1,si(B,0,ge,F),B[ge+2]=1,B.size=Math.abs(de),B.start=0,B.end=B.size}function Oo(te,B,F,q){for(let J=0;J<te.length;J++){const ue=[];Se(te[J],ue,F,q),B.push(ue)}}function Ss(te){return te/360+.5}function $t(te){const B=Math.sin(te*Math.PI/180),F=.5-.25*Math.log((1+B)/(1-B))/Math.PI;return F<0?0:F>1?1:F}function dn(te,B,F,q,J,ue,de,ge){if(q/=B,ue>=(F/=B)&&de<q)return te;if(de<F||ue>=q)return null;const ae=[];for(const Ee of te){const ze=Ee.geometry;let we=Ee.type;const $e=J===0?Ee.minX:Ee.minY,ct=J===0?Ee.maxX:Ee.maxY;if($e>=F&&ct<q){ae.push(Ee);continue}if(ct<F||$e>=q)continue;let pt=[];if(we==="Point"||we==="MultiPoint")No(ze,pt,F,q,J);else if(we==="LineString")ho(ze,pt,F,q,J,!1,ge.lineMetrics);else if(we==="MultiLineString")Ni(ze,pt,F,q,J,!1);else if(we==="Polygon")Ni(ze,pt,F,q,J,!0);else if(we==="MultiPolygon")for(const jt of ze){const Et=[];Ni(jt,Et,F,q,J,!0),Et.length&&pt.push(Et)}if(pt.length){if(ge.lineMetrics&&we==="LineString"){for(const jt of pt)ae.push(ai(Ee.id,we,jt,Ee.tags));continue}we!=="LineString"&&we!=="MultiLineString"||(pt.length===1?(we="LineString",pt=pt[0]):we="MultiLineString"),we!=="Point"&&we!=="MultiPoint"||(we=pt.length===3?"Point":"MultiPoint"),ae.push(ai(Ee.id,we,pt,Ee.tags))}}return ae.length?ae:null}function No(te,B,F,q,J){for(let ue=0;ue<te.length;ue+=3){const de=te[ue+J];de>=F&&de<=q&&nr(B,te[ue],te[ue+1],te[ue+2])}}function ho(te,B,F,q,J,ue,de){let ge=Oi(te);const ae=J===0?Ts:ts;let Ee,ze,we=te.start;for(let Et=0;Et<te.length-3;Et+=3){const Ut=te[Et],Dt=te[Et+1],Hn=te[Et+2],Mn=te[Et+3],zt=te[Et+4],en=J===0?Ut:Dt,kn=J===0?Mn:zt;let ir=!1;de&&(Ee=Math.sqrt(Math.pow(Ut-Mn,2)+Math.pow(Dt-zt,2))),en<F?kn>F&&(ze=ae(ge,Ut,Dt,Mn,zt,F),de&&(ge.start=we+Ee*ze)):en>q?kn<q&&(ze=ae(ge,Ut,Dt,Mn,zt,q),de&&(ge.start=we+Ee*ze)):nr(ge,Ut,Dt,Hn),kn<F&&en>=F&&(ze=ae(ge,Ut,Dt,Mn,zt,F),ir=!0),kn>q&&en<=q&&(ze=ae(ge,Ut,Dt,Mn,zt,q),ir=!0),!ue&&ir&&(de&&(ge.end=we+Ee*ze),B.push(ge),ge=Oi(te)),de&&(we+=Ee)}let $e=te.length-3;const ct=te[$e],pt=te[$e+1],jt=J===0?ct:pt;jt>=F&&jt<=q&&nr(ge,ct,pt,te[$e+2]),$e=ge.length-3,ue&&$e>=3&&(ge[$e]!==ge[0]||ge[$e+1]!==ge[1])&&nr(ge,ge[0],ge[1],ge[2]),ge.length&&B.push(ge)}function Oi(te){const B=[];return B.size=te.size,B.start=te.start,B.end=te.end,B}function Ni(te,B,F,q,J,ue){for(const de of te)ho(de,B,F,q,J,ue,!1)}function nr(te,B,F,q){te.push(B,F,q)}function Ts(te,B,F,q,J,ue){const de=(ue-B)/(q-B);return nr(te,ue,F+(J-F)*de,1),de}function ts(te,B,F,q,J,ue){const de=(ue-F)/(J-F);return nr(te,B+(q-B)*de,ue,1),de}function Fe(te,B){const F=[];for(let q=0;q<te.length;q++){const J=te[q],ue=J.type;let de;if(ue==="Point"||ue==="MultiPoint"||ue==="LineString")de=wt(J.geometry,B);else if(ue==="MultiLineString"||ue==="Polygon"){de=[];for(const ge of J.geometry)de.push(wt(ge,B))}else if(ue==="MultiPolygon"){de=[];for(const ge of J.geometry){const ae=[];for(const Ee of ge)ae.push(wt(Ee,B));de.push(ae)}}F.push(ai(J.id,ue,de,J.tags))}return F}function wt(te,B){const F=[];F.size=te.size,te.start!==void 0&&(F.start=te.start,F.end=te.end);for(let q=0;q<te.length;q+=3)F.push(te[q]+B,te[q+1],te[q+2]);return F}function rr(te,B){if(te.transformed)return te;const F=1<<te.z,q=te.x,J=te.y;for(const ue of te.features){const de=ue.geometry,ge=ue.type;if(ue.geometry=[],ge===1)for(let ae=0;ae<de.length;ae+=2)ue.geometry.push(wi(de[ae],de[ae+1],B,F,q,J));else for(let ae=0;ae<de.length;ae++){const Ee=[];for(let ze=0;ze<de[ae].length;ze+=2)Ee.push(wi(de[ae][ze],de[ae][ze+1],B,F,q,J));ue.geometry.push(Ee)}}return te.transformed=!0,te}function wi(te,B,F,q,J,ue){return[Math.round(F*(te*q-J)),Math.round(F*(B*q-ue))]}function $i(te,B,F,q,J){const ue=B===J.maxZoom?0:J.tolerance/((1<<B)*J.extent),de={features:[],numPoints:0,numSimplified:0,numFeatures:te.length,source:null,x:F,y:q,z:B,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const ge of te)Ve(de,ge,ue,J);return de}function Ve(te,B,F,q){const J=B.geometry,ue=B.type,de=[];if(te.minX=Math.min(te.minX,B.minX),te.minY=Math.min(te.minY,B.minY),te.maxX=Math.max(te.maxX,B.maxX),te.maxY=Math.max(te.maxY,B.maxY),ue==="Point"||ue==="MultiPoint")for(let ge=0;ge<J.length;ge+=3)de.push(J[ge],J[ge+1]),te.numPoints++,te.numSimplified++;else if(ue==="LineString")Mt(de,J,te,F,!1,!1);else if(ue==="MultiLineString"||ue==="Polygon")for(let ge=0;ge<J.length;ge++)Mt(de,J[ge],te,F,ue==="Polygon",ge===0);else if(ue==="MultiPolygon")for(let ge=0;ge<J.length;ge++){const ae=J[ge];for(let Ee=0;Ee<ae.length;Ee++)Mt(de,ae[Ee],te,F,!0,Ee===0)}if(de.length){let ge=B.tags||null;if(ue==="LineString"&&q.lineMetrics){ge={};for(const Ee in B.tags)ge[Ee]=B.tags[Ee];ge.mapbox_clip_start=J.start/J.size,ge.mapbox_clip_end=J.end/J.size}const ae={geometry:de,type:ue==="Polygon"||ue==="MultiPolygon"?3:ue==="LineString"||ue==="MultiLineString"?2:1,tags:ge};B.id!==null&&(ae.id=B.id),te.features.push(ae)}}function Mt(te,B,F,q,J,ue){const de=q*q;if(q>0&&B.size<(J?de:q))return void(F.numPoints+=B.length/3);const ge=[];for(let ae=0;ae<B.length;ae+=3)(q===0||B[ae+2]>de)&&(F.numSimplified++,ge.push(B[ae],B[ae+1])),F.numPoints++;J&&function(ae,Ee){let ze=0;for(let we=0,$e=ae.length,ct=$e-2;we<$e;ct=we,we+=2)ze+=(ae[we]-ae[ct])*(ae[we+1]+ae[ct+1]);if(ze>0===Ee)for(let we=0,$e=ae.length;we<$e/2;we+=2){const ct=ae[we],pt=ae[we+1];ae[we]=ae[$e-2-we],ae[we+1]=ae[$e-1-we],ae[$e-2-we]=ct,ae[$e-1-we]=pt}}(ge,ue),te.push(ge)}const _t={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Gr{constructor(B,F){const q=(F=this.options=function(ue,de){for(const ge in de)ue[ge]=de[ge];return ue}(Object.create(_t),F)).debug;if(q&&console.time("preprocess data"),F.maxZoom<0||F.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(F.promoteId&&F.generateId)throw new Error("promoteId and generateId cannot be used together.");let J=function(ue,de){const ge=[];if(ue.type==="FeatureCollection")for(let ae=0;ae<ue.features.length;ae++)zr(ge,ue.features[ae],de,ae);else zr(ge,ue.type==="Feature"?ue:{geometry:ue},de);return ge}(B,F);this.tiles={},this.tileCoords=[],q&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",F.indexMaxZoom,F.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),J=function(ue,de){const ge=de.buffer/de.extent;let ae=ue;const Ee=dn(ue,1,-1-ge,ge,0,-1,2,de),ze=dn(ue,1,1-ge,2+ge,0,-1,2,de);return(Ee||ze)&&(ae=dn(ue,1,-ge,1+ge,0,-1,2,de)||[],Ee&&(ae=Fe(Ee,1).concat(ae)),ze&&(ae=ae.concat(Fe(ze,-1)))),ae}(J,F),J.length&&this.splitTile(J,0,0,0),q&&(J.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(B,F,q,J,ue,de,ge){const ae=[B,F,q,J],Ee=this.options,ze=Ee.debug;for(;ae.length;){J=ae.pop(),q=ae.pop(),F=ae.pop(),B=ae.pop();const we=1<<F,$e=ji(F,q,J);let ct=this.tiles[$e];if(!ct&&(ze>1&&console.time("creation"),ct=this.tiles[$e]=$i(B,F,q,J,Ee),this.tileCoords.push({z:F,x:q,y:J}),ze)){ze>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",F,q,J,ct.numFeatures,ct.numPoints,ct.numSimplified),console.timeEnd("creation"));const ir=`z${F}`;this.stats[ir]=(this.stats[ir]||0)+1,this.total++}if(ct.source=B,ue==null){if(F===Ee.indexMaxZoom||ct.numPoints<=Ee.indexMaxPoints)continue}else{if(F===Ee.maxZoom||F===ue)continue;if(ue!=null){const ir=ue-F;if(q!==de>>ir||J!==ge>>ir)continue}}if(ct.source=null,B.length===0)continue;ze>1&&console.time("clipping");const pt=.5*Ee.buffer/Ee.extent,jt=.5-pt,Et=.5+pt,Ut=1+pt;let Dt=null,Hn=null,Mn=null,zt=null,en=dn(B,we,q-pt,q+Et,0,ct.minX,ct.maxX,Ee),kn=dn(B,we,q+jt,q+Ut,0,ct.minX,ct.maxX,Ee);B=null,en&&(Dt=dn(en,we,J-pt,J+Et,1,ct.minY,ct.maxY,Ee),Hn=dn(en,we,J+jt,J+Ut,1,ct.minY,ct.maxY,Ee),en=null),kn&&(Mn=dn(kn,we,J-pt,J+Et,1,ct.minY,ct.maxY,Ee),zt=dn(kn,we,J+jt,J+Ut,1,ct.minY,ct.maxY,Ee),kn=null),ze>1&&console.timeEnd("clipping"),ae.push(Dt||[],F+1,2*q,2*J),ae.push(Hn||[],F+1,2*q,2*J+1),ae.push(Mn||[],F+1,2*q+1,2*J),ae.push(zt||[],F+1,2*q+1,2*J+1)}}getTile(B,F,q){B=+B,F=+F,q=+q;const J=this.options,{extent:ue,debug:de}=J;if(B<0||B>24)return null;const ge=1<<B,ae=ji(B,F=F+ge&ge-1,q);if(this.tiles[ae])return rr(this.tiles[ae],ue);de>1&&console.log("drilling down to z%d-%d-%d",B,F,q);let Ee,ze=B,we=F,$e=q;for(;!Ee&&ze>0;)ze--,we>>=1,$e>>=1,Ee=this.tiles[ji(ze,we,$e)];return Ee&&Ee.source?(de>1&&(console.log("found parent tile z%d-%d-%d",ze,we,$e),console.time("drilling down")),this.splitTile(Ee.source,ze,we,$e,B,F,q),de>1&&console.timeEnd("drilling down"),this.tiles[ae]?rr(this.tiles[ae],ue):null):null}}function ji(te,B,F){return 32*((1<<te)*F+B)+te}function kt(te,B){return B?te.properties[B]:te.id}function po(te,B){if(te==null)return!0;if(te.type==="Feature")return kt(te,B)!=null;if(te.type==="FeatureCollection"){const F=new Set;for(const q of te.features){const J=kt(q,B);if(J==null||F.has(J))return!1;F.add(J)}return!0}return!1}function $o(te,B){const F=new Map;if(te!=null)if(te.type==="Feature")F.set(kt(te,B),te);else for(const q of te.features)F.set(kt(q,B),q);return F}class ns extends N{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(B,F){return x._(this,void 0,void 0,function*(){const q=B.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const J=this._geoJSONIndex.getTile(q.z,q.x,q.y);if(!J)return null;const ue=new class{constructor(ge){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=x.X,this.length=ge.length,this._features=ge}feature(ge){return new class{constructor(ae){this._feature=ae,this.extent=x.X,this.type=ae.type,this.properties=ae.tags,"id"in ae&&!isNaN(ae.id)&&(this.id=parseInt(ae.id,10))}loadGeometry(){if(this._feature.type===1){const ae=[];for(const Ee of this._feature.geometry)ae.push([new x.P(Ee[0],Ee[1])]);return ae}{const ae=[];for(const Ee of this._feature.geometry){const ze=[];for(const we of Ee)ze.push(new x.P(we[0],we[1]));ae.push(ze)}return ae}}toGeoJSON(ae,Ee,ze){return ke.call(this,ae,Ee,ze)}}(this._features[ge])}}(J.features);let de=Tt(ue);return de.byteOffset===0&&de.byteLength===de.buffer.byteLength||(de=new Uint8Array(de)),{vectorTile:ue,rawData:de.buffer}})}loadData(B){return x._(this,void 0,void 0,function*(){var F;(F=this._pendingRequest)===null||F===void 0||F.abort();const q=!!(B&&B.request&&B.request.collectResourceTiming)&&new x.bv(B.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(B,this._pendingRequest),this._geoJSONIndex=B.cluster?new Qt(function({superclusterOptions:de,clusterProperties:ge}){if(!ge||!de)return de;const ae={},Ee={},ze={accumulated:null,zoom:0},we={properties:null},$e=Object.keys(ge);for(const ct of $e){const[pt,jt]=ge[ct],Et=x.bC(jt),Ut=x.bC(typeof pt=="string"?[pt,["accumulated"],["get",ct]]:pt);ae[ct]=Et.value,Ee[ct]=Ut.value}return de.map=ct=>{we.properties=ct;const pt={};for(const jt of $e)pt[jt]=ae[jt].evaluate(ze,we);return pt},de.reduce=(ct,pt)=>{we.properties=pt;for(const jt of $e)ze.accumulated=ct[jt],ct[jt]=Ee[jt].evaluate(ze,we)},de}(B)).load((yield this._pendingData).features):(J=yield this._pendingData,new Gr(J,B.geojsonVtOptions)),this.loaded={};const ue={};if(q){const de=q.finish();de&&(ue.resourceTiming={},ue.resourceTiming[B.source]=JSON.parse(JSON.stringify(de)))}return ue}catch(ue){if(delete this._pendingRequest,x.bB(ue))return{abandoned:!0};throw ue}var J})}getData(){return x._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(B){const F=this.loaded;return F&&F[B.uid]?super.reloadTile(B):this.loadTile(B)}loadAndProcessGeoJSON(B,F){return x._(this,void 0,void 0,function*(){let q=yield this.loadGeoJSON(B,F);if(delete this._pendingRequest,typeof q!="object")throw new Error(`Input data given to '${B.source}' is not a valid GeoJSON object.`);if(ee(q,!0),B.filter){const J=x.bC(B.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(J.result==="error")throw new Error(J.value.map(de=>`${de.key}: ${de.message}`).join(", "));q={type:"FeatureCollection",features:q.features.filter(de=>J.value.evaluate({zoom:0},de))}}return q})}loadGeoJSON(B,F){return x._(this,void 0,void 0,function*(){const{promoteId:q}=B;if(B.request){const J=yield x.h(B.request,F);return this._dataUpdateable=po(J.data,q)?$o(J.data,q):void 0,J.data}if(typeof B.data=="string")try{const J=JSON.parse(B.data);return this._dataUpdateable=po(J,q)?$o(J,q):void 0,J}catch{throw new Error(`Input data given to '${B.source}' is not a valid GeoJSON object.`)}if(!B.dataDiff)throw new Error(`Input data given to '${B.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${B.source}`);return function(J,ue,de){var ge,ae,Ee,ze;if(ue.removeAll&&J.clear(),ue.remove)for(const we of ue.remove)J.delete(we);if(ue.add)for(const we of ue.add){const $e=kt(we,de);$e!=null&&J.set($e,we)}if(ue.update)for(const we of ue.update){let $e=J.get(we.id);if($e==null)continue;const ct=!we.removeAllProperties&&(((ge=we.removeProperties)===null||ge===void 0?void 0:ge.length)>0||((ae=we.addOrUpdateProperties)===null||ae===void 0?void 0:ae.length)>0);if((we.newGeometry||we.removeAllProperties||ct)&&($e=Object.assign({},$e),J.set(we.id,$e),ct&&($e.properties=Object.assign({},$e.properties))),we.newGeometry&&($e.geometry=we.newGeometry),we.removeAllProperties)$e.properties={};else if(((Ee=we.removeProperties)===null||Ee===void 0?void 0:Ee.length)>0)for(const pt of we.removeProperties)Object.prototype.hasOwnProperty.call($e.properties,pt)&&delete $e.properties[pt];if(((ze=we.addOrUpdateProperties)===null||ze===void 0?void 0:ze.length)>0)for(const{key:pt,value:jt}of we.addOrUpdateProperties)$e.properties[pt]=jt}}(this._dataUpdateable,B.dataDiff,q),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(B){return x._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(B){return this._geoJSONIndex.getClusterExpansionZoom(B.clusterId)}getClusterChildren(B){return this._geoJSONIndex.getChildren(B.clusterId)}getClusterLeaves(B){return this._geoJSONIndex.getLeaves(B.clusterId,B.limit,B.offset)}}class fo{constructor(B){this.self=B,this.actor=new x.F(B),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(F,q)=>{if(this.externalWorkerSourceTypes[F])throw new Error(`Worker source with name "${F}" already registered.`);this.externalWorkerSourceTypes[F]=q},this.self.addProtocol=x.bi,this.self.removeProtocol=x.bj,this.self.registerRTLTextPlugin=F=>{if(x.bD.isParsed())throw new Error("RTL text plugin already registered.");x.bD.setMethods(F)},this.actor.registerMessageHandler("LDT",(F,q)=>this._getDEMWorkerSource(F,q.source).loadTile(q)),this.actor.registerMessageHandler("RDT",(F,q)=>x._(this,void 0,void 0,function*(){this._getDEMWorkerSource(F,q.source).removeTile(q)})),this.actor.registerMessageHandler("GCEZ",(F,q)=>x._(this,void 0,void 0,function*(){return this._getWorkerSource(F,q.type,q.source).getClusterExpansionZoom(q)})),this.actor.registerMessageHandler("GCC",(F,q)=>x._(this,void 0,void 0,function*(){return this._getWorkerSource(F,q.type,q.source).getClusterChildren(q)})),this.actor.registerMessageHandler("GCL",(F,q)=>x._(this,void 0,void 0,function*(){return this._getWorkerSource(F,q.type,q.source).getClusterLeaves(q)})),this.actor.registerMessageHandler("LD",(F,q)=>this._getWorkerSource(F,q.type,q.source).loadData(q)),this.actor.registerMessageHandler("GD",(F,q)=>this._getWorkerSource(F,q.type,q.source).getData()),this.actor.registerMessageHandler("LT",(F,q)=>this._getWorkerSource(F,q.type,q.source).loadTile(q)),this.actor.registerMessageHandler("RT",(F,q)=>this._getWorkerSource(F,q.type,q.source).reloadTile(q)),this.actor.registerMessageHandler("AT",(F,q)=>this._getWorkerSource(F,q.type,q.source).abortTile(q)),this.actor.registerMessageHandler("RMT",(F,q)=>this._getWorkerSource(F,q.type,q.source).removeTile(q)),this.actor.registerMessageHandler("RS",(F,q)=>x._(this,void 0,void 0,function*(){if(!this.workerSources[F]||!this.workerSources[F][q.type]||!this.workerSources[F][q.type][q.source])return;const J=this.workerSources[F][q.type][q.source];delete this.workerSources[F][q.type][q.source],J.removeSource!==void 0&&J.removeSource(q)})),this.actor.registerMessageHandler("RM",F=>x._(this,void 0,void 0,function*(){delete this.layerIndexes[F],delete this.availableImages[F],delete this.workerSources[F],delete this.demWorkerSources[F]})),this.actor.registerMessageHandler("SR",(F,q)=>x._(this,void 0,void 0,function*(){this.referrer=q})),this.actor.registerMessageHandler("SRPS",(F,q)=>this._syncRTLPluginState(F,q)),this.actor.registerMessageHandler("IS",(F,q)=>x._(this,void 0,void 0,function*(){this.self.importScripts(q)})),this.actor.registerMessageHandler("SI",(F,q)=>this._setImages(F,q)),this.actor.registerMessageHandler("UL",(F,q)=>x._(this,void 0,void 0,function*(){this._getLayerIndex(F).update(q.layers,q.removedIds)})),this.actor.registerMessageHandler("SL",(F,q)=>x._(this,void 0,void 0,function*(){this._getLayerIndex(F).replace(q)}))}_setImages(B,F){return x._(this,void 0,void 0,function*(){this.availableImages[B]=F;for(const q in this.workerSources[B]){const J=this.workerSources[B][q];for(const ue in J)J[ue].availableImages=F}})}_syncRTLPluginState(B,F){return x._(this,void 0,void 0,function*(){if(x.bD.isParsed())return x.bD.getState();if(F.pluginStatus!=="loading")return x.bD.setState(F),F;const q=F.pluginURL;if(this.self.importScripts(q),x.bD.isParsed()){const J={pluginStatus:"loaded",pluginURL:q};return x.bD.setState(J),J}throw x.bD.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${q}`)})}_getAvailableImages(B){let F=this.availableImages[B];return F||(F=[]),F}_getLayerIndex(B){let F=this.layerIndexes[B];return F||(F=this.layerIndexes[B]=new u),F}_getWorkerSource(B,F,q){if(this.workerSources[B]||(this.workerSources[B]={}),this.workerSources[B][F]||(this.workerSources[B][F]={}),!this.workerSources[B][F][q]){const J={sendAsync:(ue,de)=>(ue.targetMapId=B,this.actor.sendAsync(ue,de))};switch(F){case"vector":this.workerSources[B][F][q]=new N(J,this._getLayerIndex(B),this._getAvailableImages(B));break;case"geojson":this.workerSources[B][F][q]=new ns(J,this._getLayerIndex(B),this._getAvailableImages(B));break;default:this.workerSources[B][F][q]=new this.externalWorkerSourceTypes[F](J,this._getLayerIndex(B),this._getAvailableImages(B))}}return this.workerSources[B][F][q]}_getDEMWorkerSource(B,F){return this.demWorkerSources[B]||(this.demWorkerSources[B]={}),this.demWorkerSources[B][F]||(this.demWorkerSources[B][F]=new D),this.demWorkerSources[B][F]}}return x.i(self)&&(self.worker=new fo(self)),fo}),f("index",["exports","./shared"],function(x,u){var P="4.7.0";let L,U;const N={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:g=>new Promise((n,a)=>{const h=requestAnimationFrame(n);g.signal.addEventListener("abort",()=>{cancelAnimationFrame(h),a(u.c())})}),getImageData(g,n=0){return this.getImageCanvasContext(g).getImageData(-n,-n,g.width+2*n,g.height+2*n)},getImageCanvasContext(g){const n=window.document.createElement("canvas"),a=n.getContext("2d",{willReadFrequently:!0});if(!a)throw new Error("failed to create canvas 2d context");return n.width=g.width,n.height=g.height,a.drawImage(g,0,0,g.width,g.height),a},resolveURL:g=>(L||(L=document.createElement("a")),L.href=g,L.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(U==null&&(U=matchMedia("(prefers-reduced-motion: reduce)")),U.matches)}};class D{static testProp(n){if(!D.docStyle)return n[0];for(let a=0;a<n.length;a++)if(n[a]in D.docStyle)return n[a];return n[0]}static create(n,a,h){const d=window.document.createElement(n);return a!==void 0&&(d.className=a),h&&h.appendChild(d),d}static createNS(n,a){return window.document.createElementNS(n,a)}static disableDrag(){D.docStyle&&D.selectProp&&(D.userSelect=D.docStyle[D.selectProp],D.docStyle[D.selectProp]="none")}static enableDrag(){D.docStyle&&D.selectProp&&(D.docStyle[D.selectProp]=D.userSelect)}static setTransform(n,a){n.style[D.transformProp]=a}static addEventListener(n,a,h,d={}){n.addEventListener(a,h,"passive"in d?d:d.capture)}static removeEventListener(n,a,h,d={}){n.removeEventListener(a,h,"passive"in d?d:d.capture)}static suppressClickInternal(n){n.preventDefault(),n.stopPropagation(),window.removeEventListener("click",D.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",D.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",D.suppressClickInternal,!0)},0)}static getScale(n){const a=n.getBoundingClientRect();return{x:a.width/n.offsetWidth||1,y:a.height/n.offsetHeight||1,boundingClientRect:a}}static getPoint(n,a,h){const d=a.boundingClientRect;return new u.P((h.clientX-d.left)/a.x-n.clientLeft,(h.clientY-d.top)/a.y-n.clientTop)}static mousePos(n,a){const h=D.getScale(n);return D.getPoint(n,h,a)}static touchPos(n,a){const h=[],d=D.getScale(n);for(let m=0;m<a.length;m++)h.push(D.getPoint(n,d,a[m]));return h}static mouseButton(n){return n.button}static remove(n){n.parentNode&&n.parentNode.removeChild(n)}}D.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,D.selectProp=D.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),D.transformProp=D.testProp(["transform","WebkitTransform"]);const se={supported:!1,testSupport:function(g){!ke&&ee&&(X?Z(g):ne=g)}};let ne,ee,ke=!1,X=!1;function Z(g){const n=g.createTexture();g.bindTexture(g.TEXTURE_2D,n);try{if(g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,ee),g.isContextLost())return;se.supported=!0}catch{}g.deleteTexture(n),ke=!0}var W;typeof document<"u"&&(ee=document.createElement("img"),ee.onload=()=>{ne&&Z(ne),ne=null,X=!0},ee.onerror=()=>{ke=!0,ne=null},ee.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(g){let n,a,h,d;g.resetRequestQueue=()=>{n=[],a=0,h=0,d={}},g.addThrottleControl=C=>{const I=h++;return d[I]=C,I},g.removeThrottleControl=C=>{delete d[C],w()},g.getImage=(C,I,M=!0)=>new Promise((z,$)=>{se.supported&&(C.headers||(C.headers={}),C.headers.accept="image/webp,*/*"),u.e(C,{type:"image"}),n.push({abortController:I,requestParameters:C,supportImageRefresh:M,state:"queued",onError:G=>{$(G)},onSuccess:G=>{z(G)}}),w()});const m=C=>u._(this,void 0,void 0,function*(){C.state="running";const{requestParameters:I,supportImageRefresh:M,onError:z,onSuccess:$,abortController:G}=C,H=M===!1&&!u.i(self)&&!u.g(I.url)&&(!I.headers||Object.keys(I.headers).reduce((oe,le)=>oe&&le==="accept",!0));a++;const Q=H?T(I,G):u.m(I,G);try{const oe=yield Q;delete C.abortController,C.state="completed",oe.data instanceof HTMLImageElement||u.b(oe.data)?$(oe):oe.data&&$({data:yield(ie=oe.data,typeof createImageBitmap=="function"?u.d(ie):u.f(ie)),cacheControl:oe.cacheControl,expires:oe.expires})}catch(oe){delete C.abortController,z(oe)}finally{a--,w()}var ie}),w=()=>{const C=(()=>{for(const I of Object.keys(d))if(d[I]())return!0;return!1})()?u.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:u.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let I=a;I<C&&n.length>0;I++){const M=n.shift();M.abortController.signal.aborted?I--:m(M)}},T=(C,I)=>new Promise((M,z)=>{const $=new Image,G=C.url,H=C.credentials;H&&H==="include"?$.crossOrigin="use-credentials":(H&&H==="same-origin"||!u.s(G))&&($.crossOrigin="anonymous"),I.signal.addEventListener("abort",()=>{$.src="",z(u.c())}),$.fetchPriority="high",$.onload=()=>{$.onerror=$.onload=null,M({data:$})},$.onerror=()=>{$.onerror=$.onload=null,I.signal.aborted||z(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},$.src=G})}(W||(W={})),W.resetRequestQueue();class pe{constructor(n){this._transformRequestFn=n}transformRequest(n,a){return this._transformRequestFn&&this._transformRequestFn(n,a)||{url:n}}setTransformRequest(n){this._transformRequestFn=n}}function _e(g){var n=new u.A(3);return n[0]=g[0],n[1]=g[1],n[2]=g[2],n}var be,xe=function(g,n,a){return g[0]=n[0]-a[0],g[1]=n[1]-a[1],g[2]=n[2]-a[2],g};be=new u.A(3),u.A!=Float32Array&&(be[0]=0,be[1]=0,be[2]=0);var Re=function(g){var n=g[0],a=g[1];return n*n+a*a};function tt(g){const n=[];if(typeof g=="string")n.push({id:"default",url:g});else if(g&&g.length>0){const a=[];for(const{id:h,url:d}of g){const m=`${h}${d}`;a.indexOf(m)===-1&&(a.push(m),n.push({id:h,url:d}))}}return n}function Oe(g,n,a){const h=g.split("?");return h[0]+=`${n}${a}`,h.join("?")}(function(){var g=new u.A(2);u.A!=Float32Array&&(g[0]=0,g[1]=0)})();class He{constructor(n,a,h,d){this.context=n,this.format=h,this.texture=n.gl.createTexture(),this.update(a,d)}update(n,a,h){const{width:d,height:m}=n,w=!(this.size&&this.size[0]===d&&this.size[1]===m||h),{context:T}=this,{gl:C}=T;if(this.useMipmap=!!(a&&a.useMipmap),C.bindTexture(C.TEXTURE_2D,this.texture),T.pixelStoreUnpackFlipY.set(!1),T.pixelStoreUnpack.set(1),T.pixelStoreUnpackPremultiplyAlpha.set(this.format===C.RGBA&&(!a||a.premultiply!==!1)),w)this.size=[d,m],n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||u.b(n)?C.texImage2D(C.TEXTURE_2D,0,this.format,this.format,C.UNSIGNED_BYTE,n):C.texImage2D(C.TEXTURE_2D,0,this.format,d,m,0,this.format,C.UNSIGNED_BYTE,n.data);else{const{x:I,y:M}=h||{x:0,y:0};n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||u.b(n)?C.texSubImage2D(C.TEXTURE_2D,0,I,M,C.RGBA,C.UNSIGNED_BYTE,n):C.texSubImage2D(C.TEXTURE_2D,0,I,M,d,m,C.RGBA,C.UNSIGNED_BYTE,n.data)}this.useMipmap&&this.isSizePowerOfTwo()&&C.generateMipmap(C.TEXTURE_2D)}bind(n,a,h){const{context:d}=this,{gl:m}=d;m.bindTexture(m.TEXTURE_2D,this.texture),h!==m.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(h=m.LINEAR),n!==this.filter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,n),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,h||n),this.filter=n),a!==this.wrap&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,a),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,a),this.wrap=a)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:n}=this.context;n.deleteTexture(this.texture),this.texture=null}}function vt(g){const{userImage:n}=g;return!!(n&&n.render&&n.render())&&(g.data.replace(new Uint8Array(n.data.buffer)),!0)}class dt extends u.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new u.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(n){if(this.loaded!==n&&(this.loaded=n,n)){for(const{ids:a,promiseResolve:h}of this.requestors)h(this._getImagesForIds(a));this.requestors=[]}}getImage(n){const a=this.images[n];if(a&&!a.data&&a.spriteData){const h=a.spriteData;a.data=new u.R({width:h.width,height:h.height},h.context.getImageData(h.x,h.y,h.width,h.height).data),a.spriteData=null}return a}addImage(n,a){if(this.images[n])throw new Error(`Image id ${n} already exist, use updateImage instead`);this._validate(n,a)&&(this.images[n]=a)}_validate(n,a){let h=!0;const d=a.data||a.spriteData;return this._validateStretch(a.stretchX,d&&d.width)||(this.fire(new u.j(new Error(`Image "${n}" has invalid "stretchX" value`))),h=!1),this._validateStretch(a.stretchY,d&&d.height)||(this.fire(new u.j(new Error(`Image "${n}" has invalid "stretchY" value`))),h=!1),this._validateContent(a.content,a)||(this.fire(new u.j(new Error(`Image "${n}" has invalid "content" value`))),h=!1),h}_validateStretch(n,a){if(!n)return!0;let h=0;for(const d of n){if(d[0]<h||d[1]<d[0]||a<d[1])return!1;h=d[1]}return!0}_validateContent(n,a){if(!n)return!0;if(n.length!==4)return!1;const h=a.spriteData,d=h&&h.width||a.data.width,m=h&&h.height||a.data.height;return!(n[0]<0||d<n[0]||n[1]<0||m<n[1]||n[2]<0||d<n[2]||n[3]<0||m<n[3]||n[2]<n[0]||n[3]<n[1])}updateImage(n,a,h=!0){const d=this.getImage(n);if(h&&(d.data.width!==a.data.width||d.data.height!==a.data.height))throw new Error(`size mismatch between old image (${d.data.width}x${d.data.height}) and new image (${a.data.width}x${a.data.height}).`);a.version=d.version+1,this.images[n]=a,this.updatedImages[n]=!0}removeImage(n){const a=this.images[n];delete this.images[n],delete this.patterns[n],a.userImage&&a.userImage.onRemove&&a.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(n){return new Promise((a,h)=>{let d=!0;if(!this.isLoaded())for(const m of n)this.images[m]||(d=!1);this.isLoaded()||d?a(this._getImagesForIds(n)):this.requestors.push({ids:n,promiseResolve:a})})}_getImagesForIds(n){const a={};for(const h of n){let d=this.getImage(h);d||(this.fire(new u.k("styleimagemissing",{id:h})),d=this.getImage(h)),d?a[h]={data:d.data.clone(),pixelRatio:d.pixelRatio,sdf:d.sdf,version:d.version,stretchX:d.stretchX,stretchY:d.stretchY,content:d.content,textFitWidth:d.textFitWidth,textFitHeight:d.textFitHeight,hasRenderCallback:!!(d.userImage&&d.userImage.render)}:u.w(`Image "${h}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return a}getPixelSize(){const{width:n,height:a}=this.atlasImage;return{width:n,height:a}}getPattern(n){const a=this.patterns[n],h=this.getImage(n);if(!h)return null;if(a&&a.position.version===h.version)return a.position;if(a)a.position.version=h.version;else{const d={w:h.data.width+2,h:h.data.height+2,x:0,y:0},m=new u.I(d,h);this.patterns[n]={bin:d,position:m}}return this._updatePatternAtlas(),this.patterns[n].position}bind(n){const a=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new He(n,this.atlasImage,a.RGBA),this.atlasTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE)}_updatePatternAtlas(){const n=[];for(const m in this.patterns)n.push(this.patterns[m].bin);const{w:a,h}=u.p(n),d=this.atlasImage;d.resize({width:a||1,height:h||1});for(const m in this.patterns){const{bin:w}=this.patterns[m],T=w.x+1,C=w.y+1,I=this.getImage(m).data,M=I.width,z=I.height;u.R.copy(I,d,{x:0,y:0},{x:T,y:C},{width:M,height:z}),u.R.copy(I,d,{x:0,y:z-1},{x:T,y:C-1},{width:M,height:1}),u.R.copy(I,d,{x:0,y:0},{x:T,y:C+z},{width:M,height:1}),u.R.copy(I,d,{x:M-1,y:0},{x:T-1,y:C},{width:1,height:z}),u.R.copy(I,d,{x:0,y:0},{x:T+M,y:C},{width:1,height:z})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(n){for(const a of n){if(this.callbackDispatchedThisFrame[a])continue;this.callbackDispatchedThisFrame[a]=!0;const h=this.getImage(a);h||u.w(`Image with ID: "${a}" was not found`),vt(h)&&this.updateImage(a,h)}}}const ht=1e20;function Lt(g,n,a,h,d,m,w,T,C){for(let I=n;I<n+h;I++)yt(g,a*m+I,m,d,w,T,C);for(let I=a;I<a+d;I++)yt(g,I*m+n,1,h,w,T,C)}function yt(g,n,a,h,d,m,w){m[0]=0,w[0]=-ht,w[1]=ht,d[0]=g[n];for(let T=1,C=0,I=0;T<h;T++){d[T]=g[n+T*a];const M=T*T;do{const z=m[C];I=(d[T]-d[z]+M-z*z)/(T-z)/2}while(I<=w[C]&&--C>-1);C++,m[C]=T,w[C]=I,w[C+1]=ht}for(let T=0,C=0;T<h;T++){for(;w[C+1]<T;)C++;const I=m[C],M=T-I;g[n+T*a]=d[I]+M*M}}class Tt{constructor(n,a){this.requestManager=n,this.localIdeographFontFamily=a,this.entries={}}setURL(n){this.url=n}getGlyphs(n){return u._(this,void 0,void 0,function*(){const a=[];for(const m in n)for(const w of n[m])a.push(this._getAndCacheGlyphsPromise(m,w));const h=yield Promise.all(a),d={};for(const{stack:m,id:w,glyph:T}of h)d[m]||(d[m]={}),d[m][w]=T&&{id:T.id,bitmap:T.bitmap.clone(),metrics:T.metrics};return d})}_getAndCacheGlyphsPromise(n,a){return u._(this,void 0,void 0,function*(){let h=this.entries[n];h||(h=this.entries[n]={glyphs:{},requests:{},ranges:{}});let d=h.glyphs[a];if(d!==void 0)return{stack:n,id:a,glyph:d};if(d=this._tinySDF(h,n,a),d)return h.glyphs[a]=d,{stack:n,id:a,glyph:d};const m=Math.floor(a/256);if(256*m>65535)throw new Error("glyphs > 65535 not supported");if(h.ranges[m])return{stack:n,id:a,glyph:d};if(!this.url)throw new Error("glyphsUrl is not set");if(!h.requests[m]){const T=Tt.loadGlyphRange(n,m,this.url,this.requestManager);h.requests[m]=T}const w=yield h.requests[m];for(const T in w)this._doesCharSupportLocalGlyph(+T)||(h.glyphs[+T]=w[+T]);return h.ranges[m]=!0,{stack:n,id:a,glyph:w[a]||null}})}_doesCharSupportLocalGlyph(n){return!!this.localIdeographFontFamily&&new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(n))}_tinySDF(n,a,h){const d=this.localIdeographFontFamily;if(!d||!this._doesCharSupportLocalGlyph(h))return;let m=n.tinySDF;if(!m){let T="400";/bold/i.test(a)?T="900":/medium/i.test(a)?T="500":/light/i.test(a)&&(T="200"),m=n.tinySDF=new Tt.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:d,fontWeight:T})}const w=m.draw(String.fromCharCode(h));return{id:h,bitmap:new u.o({width:w.width||60,height:w.height||60},w.data),metrics:{width:w.glyphWidth/2||24,height:w.glyphHeight/2||24,left:w.glyphLeft/2+.5||0,top:w.glyphTop/2-27.5||-8,advance:w.glyphAdvance/2||24,isDoubleResolution:!0}}}}Tt.loadGlyphRange=function(g,n,a,h){return u._(this,void 0,void 0,function*(){const d=256*n,m=d+255,w=h.transformRequest(a.replace("{fontstack}",g).replace("{range}",`${d}-${m}`),"Glyphs"),T=yield u.l(w,new AbortController);if(!T||!T.data)throw new Error(`Could not load glyph range. range: ${n}, ${d}-${m}`);const C={};for(const I of u.n(T.data))C[I.id]=I;return C})},Tt.TinySDF=class{constructor({fontSize:g=24,buffer:n=3,radius:a=8,cutoff:h=.25,fontFamily:d="sans-serif",fontWeight:m="normal",fontStyle:w="normal"}={}){this.buffer=n,this.cutoff=h,this.radius=a;const T=this.size=g+4*n,C=this._createCanvas(T),I=this.ctx=C.getContext("2d",{willReadFrequently:!0});I.font=`${w} ${m} ${g}px ${d}`,I.textBaseline="alphabetic",I.textAlign="left",I.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Uint16Array(T)}_createCanvas(g){const n=document.createElement("canvas");return n.width=n.height=g,n}draw(g){const{width:n,actualBoundingBoxAscent:a,actualBoundingBoxDescent:h,actualBoundingBoxLeft:d,actualBoundingBoxRight:m}=this.ctx.measureText(g),w=Math.ceil(a),T=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(m-d))),C=Math.min(this.size-this.buffer,w+Math.ceil(h)),I=T+2*this.buffer,M=C+2*this.buffer,z=Math.max(I*M,0),$=new Uint8ClampedArray(z),G={data:$,width:I,height:M,glyphWidth:T,glyphHeight:C,glyphTop:w,glyphLeft:0,glyphAdvance:n};if(T===0||C===0)return G;const{ctx:H,buffer:Q,gridInner:ie,gridOuter:oe}=this;H.clearRect(Q,Q,T,C),H.fillText(g,Q,Q+w);const le=H.getImageData(Q,Q,T,C);oe.fill(ht,0,z),ie.fill(0,0,z);for(let K=0;K<C;K++)for(let he=0;he<T;he++){const fe=le.data[4*(K*T+he)+3]/255;if(fe===0)continue;const ve=(K+Q)*I+he+Q;if(fe===1)oe[ve]=0,ie[ve]=ht;else{const Me=.5-fe;oe[ve]=Me>0?Me*Me:0,ie[ve]=Me<0?Me*Me:0}}Lt(oe,0,0,I,M,I,this.f,this.v,this.z),Lt(ie,Q,Q,T,C,I,this.f,this.v,this.z);for(let K=0;K<z;K++){const he=Math.sqrt(oe[K])-Math.sqrt(ie[K]);$[K]=Math.round(255-255*(he/this.radius+this.cutoff))}return G}};class Pe{constructor(){this.specification=u.v.light.position}possiblyEvaluate(n,a){return u.x(n.expression.evaluate(a))}interpolate(n,a,h){return{x:u.y.number(n.x,a.x,h),y:u.y.number(n.y,a.y,h),z:u.y.number(n.z,a.z,h)}}}let et;class lt extends u.E{constructor(n){super(),et=et||new u.q({anchor:new u.D(u.v.light.anchor),position:new Pe,color:new u.D(u.v.light.color),intensity:new u.D(u.v.light.intensity)}),this._transitionable=new u.T(et),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(n,a={}){if(!this._validate(u.r,n,a))for(const h in n){const d=n[h];h.endsWith("-transition")?this._transitionable.setTransition(h.slice(0,-11),d):this._transitionable.setValue(h,d)}}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,a,h){return(!h||h.validate!==!1)&&u.t(this,n.call(u.u,{value:a,style:{glyphs:!0,sprite:!0},styleSpec:u.v}))}}const Ct=new u.q({"sky-color":new u.D(u.v.sky["sky-color"]),"horizon-color":new u.D(u.v.sky["horizon-color"]),"fog-color":new u.D(u.v.sky["fog-color"]),"fog-ground-blend":new u.D(u.v.sky["fog-ground-blend"]),"horizon-fog-blend":new u.D(u.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new u.D(u.v.sky["sky-horizon-blend"]),"atmosphere-blend":new u.D(u.v.sky["atmosphere-blend"])});class Nt extends u.E{constructor(n){super(),this._transitionable=new u.T(Ct),this.setSky(n),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new u.z(0))}setSky(n,a={}){if(!this._validate(u.B,n,a)){n||(n={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const h in n){const d=n[h];h.endsWith("-transition")?this._transitionable.setTransition(h.slice(0,-11),d):this._transitionable.setValue(h,d)}}}getSky(){return this._transitionable.serialize()}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,a,h={}){return(h==null?void 0:h.validate)!==!1&&u.t(this,n.call(u.u,u.e({value:a,style:{glyphs:!0,sprite:!0},styleSpec:u.v})))}calculateFogBlendOpacity(n){return n<60?0:n<70?(n-60)/10:1}}class gr{constructor(n,a){this.width=n,this.height=a,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(n,a){const h=n.join(",")+String(a);return this.dashEntry[h]||(this.dashEntry[h]=this.addDash(n,a)),this.dashEntry[h]}getDashRanges(n,a,h){const d=[];let m=n.length%2==1?-n[n.length-1]*h:0,w=n[0]*h,T=!0;d.push({left:m,right:w,isDash:T,zeroLength:n[0]===0});let C=n[0];for(let I=1;I<n.length;I++){T=!T;const M=n[I];m=C*h,C+=M,w=C*h,d.push({left:m,right:w,isDash:T,zeroLength:M===0})}return d}addRoundDash(n,a,h){const d=a/2;for(let m=-h;m<=h;m++){const w=this.width*(this.nextRow+h+m);let T=0,C=n[T];for(let I=0;I<this.width;I++){I/C.right>1&&(C=n[++T]);const M=Math.abs(I-C.left),z=Math.abs(I-C.right),$=Math.min(M,z);let G;const H=m/h*(d+1);if(C.isDash){const Q=d-Math.abs(H);G=Math.sqrt($*$+Q*Q)}else G=d-Math.sqrt($*$+H*H);this.data[w+I]=Math.max(0,Math.min(255,G+128))}}}addRegularDash(n){for(let T=n.length-1;T>=0;--T){const C=n[T],I=n[T+1];C.zeroLength?n.splice(T,1):I&&I.isDash===C.isDash&&(I.left=C.left,n.splice(T,1))}const a=n[0],h=n[n.length-1];a.isDash===h.isDash&&(a.left=h.left-this.width,h.right=a.right+this.width);const d=this.width*this.nextRow;let m=0,w=n[m];for(let T=0;T<this.width;T++){T/w.right>1&&(w=n[++m]);const C=Math.abs(T-w.left),I=Math.abs(T-w.right),M=Math.min(C,I);this.data[d+T]=Math.max(0,Math.min(255,(w.isDash?M:-M)+128))}}addDash(n,a){const h=a?7:0,d=2*h+1;if(this.nextRow+d>this.height)return u.w("LineAtlas out of space"),null;let m=0;for(let T=0;T<n.length;T++)m+=n[T];if(m!==0){const T=this.width/m,C=this.getDashRanges(n,this.width,T);a?this.addRoundDash(C,T,h):this.addRegularDash(C)}const w={y:(this.nextRow+h+.5)/this.height,height:2*h/this.height,width:m};return this.nextRow+=d,this.dirty=!0,w}bind(n){const a=n.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))}}const Qt="maplibre_preloaded_worker_pool";class _n{constructor(){this.active={}}acquire(n){if(!this.workers)for(this.workers=[];this.workers.length<_n.workerCount;)this.workers.push(new Worker(u.a.WORKER_URL));return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(a=>{a.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Qt]}numActive(){return Object.keys(this.active).length}}const Pn=Math.floor(N.hardwareConcurrency/2);let An,yr;function $n(){return An||(An=new _n),An}_n.workerCount=u.C(globalThis)?Math.max(Math.min(Pn,3),1):1;class si{constructor(n,a){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=a;const h=this.workerPool.acquire(a);for(let d=0;d<h.length;d++){const m=new u.F(h[d],a);m.name=`Worker ${d}`,this.actors.push(m)}if(!this.actors.length)throw new Error("No actors found")}broadcast(n,a){const h=[];for(const d of this.actors)h.push(d.sendAsync({type:n,data:a}));return Promise.all(h)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(n=!0){this.actors.forEach(a=>{a.remove()}),this.actors=[],n&&this.workerPool.release(this.id)}registerMessageHandler(n,a){for(const h of this.actors)h.registerMessageHandler(n,a)}}function Bo(){return yr||(yr=new si($n(),u.G),yr.registerMessageHandler("GR",(g,n,a)=>u.m(n,a))),yr}function ai(g,n){const a=u.H();return u.J(a,a,[1,1,0]),u.K(a,a,[.5*g.width,.5*g.height,1]),u.L(a,a,g.calculatePosMatrix(n.toUnwrapped()))}function ur(g,n,a,h,d,m){const w=function(z,$,G){if(z)for(const H of z){const Q=$[H];if(Q&&Q.source===G&&Q.type==="fill-extrusion")return!0}else for(const H in $){const Q=$[H];if(Q.source===G&&Q.type==="fill-extrusion")return!0}return!1}(d&&d.layers,n,g.id),T=m.maxPitchScaleFactor(),C=g.tilesIn(h,T,w);C.sort(zr);const I=[];for(const z of C)I.push({wrappedTileID:z.tileID.wrapped().key,queryResults:z.tile.queryRenderedFeatures(n,a,g._state,z.queryGeometry,z.cameraQueryGeometry,z.scale,d,m,T,ai(g.transform,z.tileID))});const M=function(z){const $={},G={};for(const H of z){const Q=H.queryResults,ie=H.wrappedTileID,oe=G[ie]=G[ie]||{};for(const le in Q){const K=Q[le],he=oe[le]=oe[le]||{},fe=$[le]=$[le]||[];for(const ve of K)he[ve.featureIndex]||(he[ve.featureIndex]=!0,fe.push(ve))}}return $}(I);for(const z in M)M[z].forEach($=>{const G=$.feature,H=g.getFeatureState(G.layer["source-layer"],G.id);G.source=G.layer.source,G.layer["source-layer"]&&(G.sourceLayer=G.layer["source-layer"]),G.state=H});return M}function zr(g,n){const a=g.tileID,h=n.tileID;return a.overscaledZ-h.overscaledZ||a.canonical.y-h.canonical.y||a.wrap-h.wrap||a.canonical.x-h.canonical.x}function es(g,n,a){return u._(this,void 0,void 0,function*(){let h=g;if(g.url?h=(yield u.h(n.transformRequest(g.url,"Source"),a)).data:yield N.frameAsync(a),!h)return null;const d=u.M(u.e(h,g),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in h&&h.vector_layers&&(d.vectorLayerIds=h.vector_layers.map(m=>m.id)),d})}class Se{constructor(n,a){n&&(a?this.setSouthWest(n).setNorthEast(a):Array.isArray(n)&&(n.length===4?this.setSouthWest([n[0],n[1]]).setNorthEast([n[2],n[3]]):this.setSouthWest(n[0]).setNorthEast(n[1])))}setNorthEast(n){return this._ne=n instanceof u.N?new u.N(n.lng,n.lat):u.N.convert(n),this}setSouthWest(n){return this._sw=n instanceof u.N?new u.N(n.lng,n.lat):u.N.convert(n),this}extend(n){const a=this._sw,h=this._ne;let d,m;if(n instanceof u.N)d=n,m=n;else{if(!(n instanceof Se))return Array.isArray(n)?n.length===4||n.every(Array.isArray)?this.extend(Se.convert(n)):this.extend(u.N.convert(n)):n&&("lng"in n||"lon"in n)&&"lat"in n?this.extend(u.N.convert(n)):this;if(d=n._sw,m=n._ne,!d||!m)return this}return a||h?(a.lng=Math.min(d.lng,a.lng),a.lat=Math.min(d.lat,a.lat),h.lng=Math.max(m.lng,h.lng),h.lat=Math.max(m.lat,h.lat)):(this._sw=new u.N(d.lng,d.lat),this._ne=new u.N(m.lng,m.lat)),this}getCenter(){return new u.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new u.N(this.getWest(),this.getNorth())}getSouthEast(){return new u.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(n){const{lng:a,lat:h}=u.N.convert(n);let d=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=h&&h<=this._ne.lat&&d}static convert(n){return n instanceof Se?n:n&&new Se(n)}static fromLngLat(n,a=0){const h=360*a/40075017,d=h/Math.cos(Math.PI/180*n.lat);return new Se(new u.N(n.lng-d,n.lat-h),new u.N(n.lng+d,n.lat+h))}adjustAntiMeridian(){const n=new u.N(this._sw.lng,this._sw.lat),a=new u.N(this._ne.lng,this._ne.lat);return new Se(n,n.lng>a.lng?new u.N(a.lng+360,a.lat):a)}}class Oo{constructor(n,a,h){this.bounds=Se.convert(this.validateBounds(n)),this.minzoom=a||0,this.maxzoom=h||24}validateBounds(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]}contains(n){const a=Math.pow(2,n.z),h=Math.floor(u.O(this.bounds.getWest())*a),d=Math.floor(u.Q(this.bounds.getNorth())*a),m=Math.ceil(u.O(this.bounds.getEast())*a),w=Math.ceil(u.Q(this.bounds.getSouth())*a);return n.x>=h&&n.x<m&&n.y>=d&&n.y<w}}class Ss extends u.E{constructor(n,a,h,d){if(super(),this.id=n,this.dispatcher=h,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,u.e(this,u.M(a,["url","scheme","tileSize","promoteId"])),this._options=u.e({type:"vector"},a),this._collectResourceTiming=a.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(d)}load(){return u._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new u.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const n=yield es(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),n&&(u.e(this,n),n.bounds&&(this.tileBounds=new Oo(n.bounds,this.minzoom,this.maxzoom)),this.fire(new u.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.k("data",{dataType:"source",sourceDataType:"content"})))}catch(n){this._tileJSONRequest=null,this.fire(new u.j(n))}})}loaded(){return this._loaded}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}onAdd(n){this.map=n,this.load()}setSourceProperty(n){this._tileJSONRequest&&this._tileJSONRequest.abort(),n(),this.load()}setTiles(n){return this.setSourceProperty(()=>{this._options.tiles=n}),this}setUrl(n){return this.setSourceProperty(()=>{this.url=n,this._options.url=n}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return u.e({},this._options)}loadTile(n){return u._(this,void 0,void 0,function*(){const a=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),h={request:this.map._requestManager.transformRequest(a,"Tile"),uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};h.request.collectResourceTiming=this._collectResourceTiming;let d="RT";if(n.actor&&n.state!=="expired"){if(n.state==="loading")return new Promise((m,w)=>{n.reloadPromise={resolve:m,reject:w}})}else n.actor=this.dispatcher.getActor(),d="LT";n.abortController=new AbortController;try{const m=yield n.actor.sendAsync({type:d,data:h},n.abortController);if(delete n.abortController,n.aborted)return;this._afterTileLoadWorkerResponse(n,m)}catch(m){if(delete n.abortController,n.aborted)return;if(m&&m.status!==404)throw m;this._afterTileLoadWorkerResponse(n,null)}})}_afterTileLoadWorkerResponse(n,a){if(a&&a.resourceTiming&&(n.resourceTiming=a.resourceTiming),a&&this.map._refreshExpiredTiles&&n.setExpiryData(a),n.loadVectorData(a,this.map.painter),n.reloadPromise){const h=n.reloadPromise;n.reloadPromise=null,this.loadTile(n).then(h.resolve).catch(h.reject)}}abortTile(n){return u._(this,void 0,void 0,function*(){n.abortController&&(n.abortController.abort(),delete n.abortController),n.actor&&(yield n.actor.sendAsync({type:"AT",data:{uid:n.uid,type:this.type,source:this.id}}))})}unloadTile(n){return u._(this,void 0,void 0,function*(){n.unloadVectorData(),n.actor&&(yield n.actor.sendAsync({type:"RMT",data:{uid:n.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class $t extends u.E{constructor(n,a,h,d){super(),this.id=n,this.dispatcher=h,this.setEventedParent(d),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=u.e({type:"raster"},a),u.e(this,u.M(a,["url","scheme","tileSize"]))}load(){return u._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new u.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const n=yield es(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,n&&(u.e(this,n),n.bounds&&(this.tileBounds=new Oo(n.bounds,this.minzoom,this.maxzoom)),this.fire(new u.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.k("data",{dataType:"source",sourceDataType:"content"})))}catch(n){this._tileJSONRequest=null,this.fire(new u.j(n))}})}loaded(){return this._loaded}onAdd(n){this.map=n,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(n){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),n(),this.load()}setTiles(n){return this.setSourceProperty(()=>{this._options.tiles=n}),this}setUrl(n){return this.setSourceProperty(()=>{this.url=n,this._options.url=n}),this}serialize(){return u.e({},this._options)}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}loadTile(n){return u._(this,void 0,void 0,function*(){const a=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);n.abortController=new AbortController;try{const h=yield W.getImage(this.map._requestManager.transformRequest(a,"Tile"),n.abortController,this.map._refreshExpiredTiles);if(delete n.abortController,n.aborted)return void(n.state="unloaded");if(h&&h.data){this.map._refreshExpiredTiles&&h.cacheControl&&h.expires&&n.setExpiryData({cacheControl:h.cacheControl,expires:h.expires});const d=this.map.painter.context,m=d.gl,w=h.data;n.texture=this.map.painter.getTileTexture(w.width),n.texture?n.texture.update(w,{useMipmap:!0}):(n.texture=new He(d,w,m.RGBA,{useMipmap:!0}),n.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE,m.LINEAR_MIPMAP_NEAREST)),n.state="loaded"}}catch(h){if(delete n.abortController,n.aborted)n.state="unloaded";else if(h)throw n.state="errored",h}})}abortTile(n){return u._(this,void 0,void 0,function*(){n.abortController&&(n.abortController.abort(),delete n.abortController)})}unloadTile(n){return u._(this,void 0,void 0,function*(){n.texture&&this.map.painter.saveTileTexture(n.texture)})}hasTransition(){return!1}}class dn extends $t{constructor(n,a,h,d){super(n,a,h,d),this.type="raster-dem",this.maxzoom=22,this._options=u.e({type:"raster-dem"},a),this.encoding=a.encoding||"mapbox",this.redFactor=a.redFactor,this.greenFactor=a.greenFactor,this.blueFactor=a.blueFactor,this.baseShift=a.baseShift}loadTile(n){return u._(this,void 0,void 0,function*(){const a=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),h=this.map._requestManager.transformRequest(a,"Tile");n.neighboringTiles=this._getNeighboringTiles(n.tileID),n.abortController=new AbortController;try{const d=yield W.getImage(h,n.abortController,this.map._refreshExpiredTiles);if(delete n.abortController,n.aborted)return void(n.state="unloaded");if(d&&d.data){const m=d.data;this.map._refreshExpiredTiles&&d.cacheControl&&d.expires&&n.setExpiryData({cacheControl:d.cacheControl,expires:d.expires});const w=u.b(m)&&u.U()?m:yield this.readImageNow(m),T={type:this.type,uid:n.uid,source:this.id,rawImageData:w,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!n.actor||n.state==="expired"){n.actor=this.dispatcher.getActor();const C=yield n.actor.sendAsync({type:"LDT",data:T});n.dem=C,n.needsHillshadePrepare=!0,n.needsTerrainPrepare=!0,n.state="loaded"}}}catch(d){if(delete n.abortController,n.aborted)n.state="unloaded";else if(d)throw n.state="errored",d}})}readImageNow(n){return u._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&u.V()){const a=n.width+2,h=n.height+2;try{return new u.R({width:a,height:h},yield u.W(n,-1,-1,a,h))}catch{}}return N.getImageData(n,1)})}_getNeighboringTiles(n){const a=n.canonical,h=Math.pow(2,a.z),d=(a.x-1+h)%h,m=a.x===0?n.wrap-1:n.wrap,w=(a.x+1+h)%h,T=a.x+1===h?n.wrap+1:n.wrap,C={};return C[new u.S(n.overscaledZ,m,a.z,d,a.y).key]={backfilled:!1},C[new u.S(n.overscaledZ,T,a.z,w,a.y).key]={backfilled:!1},a.y>0&&(C[new u.S(n.overscaledZ,m,a.z,d,a.y-1).key]={backfilled:!1},C[new u.S(n.overscaledZ,n.wrap,a.z,a.x,a.y-1).key]={backfilled:!1},C[new u.S(n.overscaledZ,T,a.z,w,a.y-1).key]={backfilled:!1}),a.y+1<h&&(C[new u.S(n.overscaledZ,m,a.z,d,a.y+1).key]={backfilled:!1},C[new u.S(n.overscaledZ,n.wrap,a.z,a.x,a.y+1).key]={backfilled:!1},C[new u.S(n.overscaledZ,T,a.z,w,a.y+1).key]={backfilled:!1}),C}unloadTile(n){return u._(this,void 0,void 0,function*(){n.demTexture&&this.map.painter.saveTileTexture(n.demTexture),n.fbo&&(n.fbo.destroy(),delete n.fbo),n.dem&&delete n.dem,delete n.neighboringTiles,n.state="unloaded",n.actor&&(yield n.actor.sendAsync({type:"RDT",data:{type:this.type,uid:n.uid,source:this.id}}))})}}class No extends u.E{constructor(n,a,h,d){super(),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=h.getActor(),this.setEventedParent(d),this._data=a.data,this._options=u.e({},a),this._collectResourceTiming=a.collectResourceTiming,a.maxzoom!==void 0&&(this.maxzoom=a.maxzoom),a.type&&(this.type=a.type),a.attribution&&(this.attribution=a.attribution),this.promoteId=a.promoteId;const m=u.X/this.tileSize;a.clusterMaxZoom!==void 0&&this.maxzoom<=a.clusterMaxZoom&&u.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${a.clusterMaxZoom}".`),this.workerOptions=u.e({source:this.id,cluster:a.cluster||!1,geojsonVtOptions:{buffer:(a.buffer!==void 0?a.buffer:128)*m,tolerance:(a.tolerance!==void 0?a.tolerance:.375)*m,extent:u.X,maxZoom:this.maxzoom,lineMetrics:a.lineMetrics||!1,generateId:a.generateId||!1},superclusterOptions:{maxZoom:a.clusterMaxZoom!==void 0?a.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,a.clusterMinPoints||2),extent:u.X,radius:(a.clusterRadius||50)*m,log:!1,generateId:a.generateId||!1},clusterProperties:a.clusterProperties,filter:a.filter},a.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return u._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(n){this.map=n,this.load()}setData(n){return this._data=n,this._updateWorkerData(),this}updateData(n){return this._updateWorkerData(n),this}getData(){return u._(this,void 0,void 0,function*(){const n=u.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:n})})}setClusterOptions(n){return this.workerOptions.cluster=n.cluster,n&&(n.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=n.clusterRadius),n.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=n.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(n){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:n,source:this.id}})}getClusterChildren(n){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:n,source:this.id}})}getClusterLeaves(n,a,h){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:n,limit:a,offset:h}})}_updateWorkerData(n){return u._(this,void 0,void 0,function*(){const a=u.e({type:this.type},this.workerOptions);n?a.dataDiff=n:typeof this._data=="string"?(a.request=this.map._requestManager.transformRequest(N.resolveURL(this._data),"Source"),a.request.collectResourceTiming=this._collectResourceTiming):a.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new u.k("dataloading",{dataType:"source"}));try{const h=yield this.actor.sendAsync({type:"LD",data:a});if(this._pendingLoads--,this._removed||h.abandoned)return void this.fire(new u.k("dataabort",{dataType:"source"}));let d=null;h.resourceTiming&&h.resourceTiming[this.id]&&(d=h.resourceTiming[this.id].slice(0));const m={dataType:"source"};this._collectResourceTiming&&d&&d.length>0&&u.e(m,{resourceTiming:d}),this.fire(new u.k("data",Object.assign(Object.assign({},m),{sourceDataType:"metadata"}))),this.fire(new u.k("data",Object.assign(Object.assign({},m),{sourceDataType:"content"})))}catch(h){if(this._pendingLoads--,this._removed)return void this.fire(new u.k("dataabort",{dataType:"source"}));this.fire(new u.j(h))}})}loaded(){return this._pendingLoads===0}loadTile(n){return u._(this,void 0,void 0,function*(){const a=n.actor?"RT":"LT";n.actor=this.actor;const h={type:this.type,uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};n.abortController=new AbortController;const d=yield this.actor.sendAsync({type:a,data:h},n.abortController);delete n.abortController,n.unloadVectorData(),n.aborted||n.loadVectorData(d,this.map.painter,a==="RT")})}abortTile(n){return u._(this,void 0,void 0,function*(){n.abortController&&(n.abortController.abort(),delete n.abortController),n.aborted=!0})}unloadTile(n){return u._(this,void 0,void 0,function*(){n.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:n.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return u.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var ho=u.Y([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Oi extends u.E{constructor(n,a,h,d){super(),this.id=n,this.dispatcher=h,this.coordinates=a.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(d),this.options=a}load(n){return u._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new u.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const a=yield W.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,a&&a.data&&(this.image=a.data,n&&(this.coordinates=n),this._finishLoading())}catch(a){this._request=null,this._loaded=!0,this.fire(new u.j(a))}})}loaded(){return this._loaded}updateImage(n){return n.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=n.url,this.load(n.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new u.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(n){this.coordinates=n;const a=n.map(u.Z.fromLngLat);this.tileID=function(d){let m=1/0,w=1/0,T=-1/0,C=-1/0;for(const $ of d)m=Math.min(m,$.x),w=Math.min(w,$.y),T=Math.max(T,$.x),C=Math.max(C,$.y);const I=Math.max(T-m,C-w),M=Math.max(0,Math.floor(-Math.log(I)/Math.LN2)),z=Math.pow(2,M);return new u.a1(M,Math.floor((m+T)/2*z),Math.floor((w+C)/2*z))}(a),this.minzoom=this.maxzoom=this.tileID.z;const h=a.map(d=>this.tileID.getTilePoint(d)._round());return this._boundsArray=new u.$,this._boundsArray.emplaceBack(h[0].x,h[0].y,0,0),this._boundsArray.emplaceBack(h[1].x,h[1].y,u.X,0),this._boundsArray.emplaceBack(h[3].x,h[3].y,0,u.X),this._boundsArray.emplaceBack(h[2].x,h[2].y,u.X,u.X),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new u.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const n=this.map.painter.context,a=n.gl;this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,ho.members)),this.boundsSegments||(this.boundsSegments=u.a0.simpleSegment(0,0,4,2)),this.texture||(this.texture=new He(n,this.image,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let h=!1;for(const d in this.tiles){const m=this.tiles[d];m.state!=="loaded"&&(m.state="loaded",m.texture=this.texture,h=!0)}h&&this.fire(new u.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(n){return u._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={}):n.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Ni extends Oi{constructor(n,a,h,d){super(n,a,h,d),this.roundZoom=!0,this.type="video",this.options=a}load(){return u._(this,void 0,void 0,function*(){this._loaded=!1;const n=this.options;this.urls=[];for(const a of n.urls)this.urls.push(this.map._requestManager.transformRequest(a,"Source").url);try{const a=yield u.a3(this.urls);if(this._loaded=!0,!a)return;this.video=a,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(a){this.fire(new u.j(a))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(n){if(this.video){const a=this.video.seekable;n<a.start(0)||n>a.end(0)?this.fire(new u.j(new u.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${a.start(0)} and ${a.end(0)}-second mark.`))):this.video.currentTime=n}}getVideo(){return this.video}onAdd(n){this.map||(this.map=n,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const n=this.map.painter.context,a=n.gl;this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,ho.members)),this.boundsSegments||(this.boundsSegments=u.a0.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,this.video)):(this.texture=new He(n,this.video,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let h=!1;for(const d in this.tiles){const m=this.tiles[d];m.state!=="loaded"&&(m.state="loaded",m.texture=this.texture,h=!0)}h&&this.fire(new u.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class nr extends Oi{constructor(n,a,h,d){super(n,a,h,d),a.coordinates?Array.isArray(a.coordinates)&&a.coordinates.length===4&&!a.coordinates.some(m=>!Array.isArray(m)||m.length!==2||m.some(w=>typeof w!="number"))||this.fire(new u.j(new u.a2(`sources.${n}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new u.j(new u.a2(`sources.${n}`,null,'missing required property "coordinates"'))),a.animate&&typeof a.animate!="boolean"&&this.fire(new u.j(new u.a2(`sources.${n}`,null,'optional "animate" property must be a boolean value'))),a.canvas?typeof a.canvas=="string"||a.canvas instanceof HTMLCanvasElement||this.fire(new u.j(new u.a2(`sources.${n}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new u.j(new u.a2(`sources.${n}`,null,'missing required property "canvas"'))),this.options=a,this.animate=a.animate===void 0||a.animate}load(){return u._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new u.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(n){this.map=n,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let n=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,n=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,n=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const a=this.map.painter.context,h=a.gl;this.boundsBuffer||(this.boundsBuffer=a.createVertexBuffer(this._boundsArray,ho.members)),this.boundsSegments||(this.boundsSegments=u.a0.simpleSegment(0,0,4,2)),this.texture?(n||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new He(a,this.canvas,h.RGBA,{premultiply:!0});let d=!1;for(const m in this.tiles){const w=this.tiles[m];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture,d=!0)}d&&this.fire(new u.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const n of[this.canvas.width,this.canvas.height])if(isNaN(n)||n<=0)return!0;return!1}}const Ts={},ts=g=>{switch(g){case"geojson":return No;case"image":return Oi;case"raster":return $t;case"raster-dem":return dn;case"vector":return Ss;case"video":return Ni;case"canvas":return nr}return Ts[g]},Fe="RTLPluginLoaded";class wt extends u.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Bo()}_syncState(n){return this.status=n,this.dispatcher.broadcast("SRPS",{pluginStatus:n,pluginURL:this.url}).catch(a=>{throw this.status="error",a})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(n){return u._(this,arguments,void 0,function*(a,h=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=N.resolveURL(a),!this.url)throw new Error(`requested url ${a} is invalid`);if(this.status==="unavailable"){if(!h)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return u._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new u.k(Fe))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let rr=null;function wi(){return rr||(rr=new wt),rr}class $i{constructor(n,a){this.timeAdded=0,this.fadeEndTime=0,this.tileID=n,this.uid=u.a4(),this.uses=0,this.tileSize=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(n){const a=n+this.timeAdded;a<this.fadeEndTime||(this.fadeEndTime=a)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(n){this.demTexture&&n.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(n,a,h){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",n){n.featureIndex&&(this.latestFeatureIndex=n.featureIndex,n.rawTileData?(this.latestRawTileData=n.rawTileData,this.latestFeatureIndex.rawTileData=n.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=n.collisionBoxArray,this.buckets=function(d,m){const w={};if(!m)return w;for(const T of d){const C=T.layerIds.map(I=>m.getLayer(I)).filter(Boolean);if(C.length!==0){T.layers=C,T.stateDependentLayerIds&&(T.stateDependentLayers=T.stateDependentLayerIds.map(I=>C.filter(M=>M.id===I)[0]));for(const I of C)w[I.id]=T}}return w}(n.buckets,a.style),this.hasSymbolBuckets=!1;for(const d in this.buckets){const m=this.buckets[d];if(m instanceof u.a6){if(this.hasSymbolBuckets=!0,!h)break;m.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const d in this.buckets){const m=this.buckets[d];if(m instanceof u.a6&&m.hasRTLText){this.hasRTLText=!0,wi().lazyLoad();break}}this.queryPadding=0;for(const d in this.buckets){const m=this.buckets[d];this.queryPadding=Math.max(this.queryPadding,a.style.getLayer(d).queryRadius(m))}n.imageAtlas&&(this.imageAtlas=n.imageAtlas),n.glyphAtlasImage&&(this.glyphAtlasImage=n.glyphAtlasImage)}else this.collisionBoxArray=new u.a5}unloadVectorData(){for(const n in this.buckets)this.buckets[n].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(n){return this.buckets[n.id]}upload(n){for(const h in this.buckets){const d=this.buckets[h];d.uploadPending()&&d.upload(n)}const a=n.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new He(n,this.imageAtlas.image,a.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new He(n,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null)}prepare(n){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(n,this.imageAtlasTexture)}queryRenderedFeatures(n,a,h,d,m,w,T,C,I,M){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:d,cameraQueryGeometry:m,scale:w,tileSize:this.tileSize,pixelPosMatrix:M,transform:C,params:T,queryPadding:this.queryPadding*I},n,a,h):{}}querySourceFeatures(n,a){const h=this.latestFeatureIndex;if(!h||!h.rawTileData)return;const d=h.loadVTLayers(),m=a&&a.sourceLayer?a.sourceLayer:"",w=d._geojsonTileLayer||d[m];if(!w)return;const T=u.a7(a&&a.filter),{z:C,x:I,y:M}=this.tileID.canonical,z={z:C,x:I,y:M};for(let $=0;$<w.length;$++){const G=w.feature($);if(T.needGeometry){const ie=u.a8(G,!0);if(!T.filter(new u.z(this.tileID.overscaledZ),ie,this.tileID.canonical))continue}else if(!T.filter(new u.z(this.tileID.overscaledZ),G))continue;const H=h.getId(G,m),Q=new u.a9(G,C,I,M,H);Q.tile=z,n.push(Q)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(n){const a=this.expirationTime;if(n.cacheControl){const h=u.aa(n.cacheControl);h["max-age"]&&(this.expirationTime=Date.now()+1e3*h["max-age"])}else n.expires&&(this.expirationTime=new Date(n.expires).getTime());if(this.expirationTime){const h=Date.now();let d=!1;if(this.expirationTime>h)d=!1;else if(a)if(this.expirationTime<a)d=!0;else{const m=this.expirationTime-a;m?this.expirationTime=h+Math.max(m,3e4):d=!0}else d=!0;d?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(n,a){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(n).length===0)return;const h=this.latestFeatureIndex.loadVTLayers();for(const d in this.buckets){if(!a.style.hasLayer(d))continue;const m=this.buckets[d],w=m.layers[0].sourceLayer||"_geojsonTileLayer",T=h[w],C=n[w];if(!T||!C||Object.keys(C).length===0)continue;m.update(C,T,this.imageAtlas&&this.imageAtlas.patternPositions||{});const I=a&&a.style&&a.style.getLayer(d);I&&(this.queryPadding=Math.max(this.queryPadding,I.queryRadius(m)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<N.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(n){this.symbolFadeHoldUntil=N.now()+n}setDependencies(n,a){const h={};for(const d of a)h[d]=!0;this.dependencies[n]=h}hasDependency(n,a){for(const h of n){const d=this.dependencies[h];if(d){for(const m of a)if(d[m])return!0}}return!1}}class Ve{constructor(n,a){this.max=n,this.onRemove=a,this.reset()}reset(){for(const n in this.data)for(const a of this.data[n])a.timeout&&clearTimeout(a.timeout),this.onRemove(a.value);return this.data={},this.order=[],this}add(n,a,h){const d=n.wrapped().key;this.data[d]===void 0&&(this.data[d]=[]);const m={value:a,timeout:void 0};if(h!==void 0&&(m.timeout=setTimeout(()=>{this.remove(n,m)},h)),this.data[d].push(m),this.order.push(d),this.order.length>this.max){const w=this._getAndRemoveByKey(this.order[0]);w&&this.onRemove(w)}return this}has(n){return n.wrapped().key in this.data}getAndRemove(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null}_getAndRemoveByKey(n){const a=this.data[n].shift();return a.timeout&&clearTimeout(a.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),a.value}getByKey(n){const a=this.data[n];return a?a[0].value:null}get(n){return this.has(n)?this.data[n.wrapped().key][0].value:null}remove(n,a){if(!this.has(n))return this;const h=n.wrapped().key,d=a===void 0?0:this.data[h].indexOf(a),m=this.data[h][d];return this.data[h].splice(d,1),m.timeout&&clearTimeout(m.timeout),this.data[h].length===0&&delete this.data[h],this.onRemove(m.value),this.order.splice(this.order.indexOf(h),1),this}setMaxSize(n){for(this.max=n;this.order.length>this.max;){const a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this}filter(n){const a=[];for(const h in this.data)for(const d of this.data[h])n(d.value)||a.push(d);for(const h of a)this.remove(h.value.tileID,h)}}class Mt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(n,a,h){const d=String(a);if(this.stateChanges[n]=this.stateChanges[n]||{},this.stateChanges[n][d]=this.stateChanges[n][d]||{},u.e(this.stateChanges[n][d],h),this.deletedStates[n]===null){this.deletedStates[n]={};for(const m in this.state[n])m!==d&&(this.deletedStates[n][m]=null)}else if(this.deletedStates[n]&&this.deletedStates[n][d]===null){this.deletedStates[n][d]={};for(const m in this.state[n][d])h[m]||(this.deletedStates[n][d][m]=null)}else for(const m in h)this.deletedStates[n]&&this.deletedStates[n][d]&&this.deletedStates[n][d][m]===null&&delete this.deletedStates[n][d][m]}removeFeatureState(n,a,h){if(this.deletedStates[n]===null)return;const d=String(a);if(this.deletedStates[n]=this.deletedStates[n]||{},h&&a!==void 0)this.deletedStates[n][d]!==null&&(this.deletedStates[n][d]=this.deletedStates[n][d]||{},this.deletedStates[n][d][h]=null);else if(a!==void 0)if(this.stateChanges[n]&&this.stateChanges[n][d])for(h in this.deletedStates[n][d]={},this.stateChanges[n][d])this.deletedStates[n][d][h]=null;else this.deletedStates[n][d]=null;else this.deletedStates[n]=null}getState(n,a){const h=String(a),d=u.e({},(this.state[n]||{})[h],(this.stateChanges[n]||{})[h]);if(this.deletedStates[n]===null)return{};if(this.deletedStates[n]){const m=this.deletedStates[n][a];if(m===null)return{};for(const w in m)delete d[w]}return d}initializeTileState(n,a){n.setFeatureState(this.state,a)}coalesceChanges(n,a){const h={};for(const d in this.stateChanges){this.state[d]=this.state[d]||{};const m={};for(const w in this.stateChanges[d])this.state[d][w]||(this.state[d][w]={}),u.e(this.state[d][w],this.stateChanges[d][w]),m[w]=this.state[d][w];h[d]=m}for(const d in this.deletedStates){this.state[d]=this.state[d]||{};const m={};if(this.deletedStates[d]===null)for(const w in this.state[d])m[w]={},this.state[d][w]={};else for(const w in this.deletedStates[d]){if(this.deletedStates[d][w]===null)this.state[d][w]={};else for(const T of Object.keys(this.deletedStates[d][w]))delete this.state[d][w][T];m[w]=this.state[d][w]}h[d]=h[d]||{},u.e(h[d],m)}if(this.stateChanges={},this.deletedStates={},Object.keys(h).length!==0)for(const d in n)n[d].setFeatureState(h,a)}}class _t extends u.E{constructor(n,a,h){super(),this.id=n,this.dispatcher=h,this.on("data",d=>this._dataHandler(d)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((d,m,w,T)=>{const C=new(ts(m.type))(d,m,w,T);if(C.id!==d)throw new Error(`Expected Source id to be ${d} instead of ${C.id}`);return C})(n,a,h,this),this._tiles={},this._cache=new Ve(0,d=>this._unloadTile(d)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Mt,this._didEmitContent=!1,this._updated=!1}onAdd(n){this.map=n,this._maxTileCacheSize=n?n._maxTileCacheSize:null,this._maxTileCacheZoomLevels=n?n._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(n)}onRemove(n){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(n)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const n in this._tiles){const a=this._tiles[n];if(a.state!=="loaded"&&a.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(n,a,h){return u._(this,void 0,void 0,function*(){try{yield this._source.loadTile(n),this._tileLoaded(n,a,h)}catch(d){n.state="errored",d.status!==404?this._source.fire(new u.j(d,{tile:n})):this.update(this.transform,this.terrain)}})}_unloadTile(n){this._source.unloadTile&&this._source.unloadTile(n)}_abortTile(n){this._source.abortTile&&this._source.abortTile(n),this._source.fire(new u.k("dataabort",{tile:n,coord:n.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(n){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const a in this._tiles){const h=this._tiles[a];h.upload(n),h.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(n=>n.tileID).sort(Gr).map(n=>n.key)}getRenderableIds(n){const a=[];for(const h in this._tiles)this._isIdRenderable(h,n)&&a.push(this._tiles[h]);return n?a.sort((h,d)=>{const m=h.tileID,w=d.tileID,T=new u.P(m.canonical.x,m.canonical.y)._rotate(this.transform.angle),C=new u.P(w.canonical.x,w.canonical.y)._rotate(this.transform.angle);return m.overscaledZ-w.overscaledZ||C.y-T.y||C.x-T.x}).map(h=>h.tileID.key):a.map(h=>h.tileID).sort(Gr).map(h=>h.key)}hasRenderableParent(n){const a=this.findLoadedParent(n,0);return!!a&&this._isIdRenderable(a.tileID.key)}_isIdRenderable(n,a){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(a||!this._tiles[n].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const n in this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(n,"reloading")}}_reloadTile(n,a){return u._(this,void 0,void 0,function*(){const h=this._tiles[n];h&&(h.state!=="loading"&&(h.state=a),yield this._loadTile(h,n,a))})}_tileLoaded(n,a,h){n.timeAdded=N.now(),h==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(a,n),this.getSource().type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),n.aborted||this._source.fire(new u.k("data",{dataType:"source",tile:n,coord:n.tileID}))}_backfillDEM(n){const a=this.getRenderableIds();for(let d=0;d<a.length;d++){const m=a[d];if(n.neighboringTiles&&n.neighboringTiles[m]){const w=this.getTileByID(m);h(n,w),h(w,n)}}function h(d,m){d.needsHillshadePrepare=!0,d.needsTerrainPrepare=!0;let w=m.tileID.canonical.x-d.tileID.canonical.x;const T=m.tileID.canonical.y-d.tileID.canonical.y,C=Math.pow(2,d.tileID.canonical.z),I=m.tileID.key;w===0&&T===0||Math.abs(T)>1||(Math.abs(w)>1&&(Math.abs(w+C)===1?w+=C:Math.abs(w-C)===1&&(w-=C)),m.dem&&d.dem&&(d.dem.backfillBorder(m.dem,w,T),d.neighboringTiles&&d.neighboringTiles[I]&&(d.neighboringTiles[I].backfilled=!0)))}}getTile(n){return this.getTileByID(n.key)}getTileByID(n){return this._tiles[n]}_retainLoadedChildren(n,a,h,d){for(const m in this._tiles){let w=this._tiles[m];if(d[m]||!w.hasData()||w.tileID.overscaledZ<=a||w.tileID.overscaledZ>h)continue;let T=w.tileID;for(;w&&w.tileID.overscaledZ>a+1;){const I=w.tileID.scaledTo(w.tileID.overscaledZ-1);w=this._tiles[I.key],w&&w.hasData()&&(T=I)}let C=T;for(;C.overscaledZ>a;)if(C=C.scaledTo(C.overscaledZ-1),n[C.key]){d[T.key]=T;break}}}findLoadedParent(n,a){if(n.key in this._loadedParentTiles){const h=this._loadedParentTiles[n.key];return h&&h.tileID.overscaledZ>=a?h:null}for(let h=n.overscaledZ-1;h>=a;h--){const d=n.scaledTo(h),m=this._getLoadedTile(d);if(m)return m}}findLoadedSibling(n){return this._getLoadedTile(n)}_getLoadedTile(n){const a=this._tiles[n.key];return a&&a.hasData()?a:this._cache.getByKey(n.wrapped().key)}updateCacheSize(n){const a=Math.ceil(n.width/this._source.tileSize)+1,h=Math.ceil(n.height/this._source.tileSize)+1,d=Math.floor(a*h*(this._maxTileCacheZoomLevels===null?u.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),m=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,d):d;this._cache.setMaxSize(m)}handleWrapJump(n){const a=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,a){const h={};for(const d in this._tiles){const m=this._tiles[d];m.tileID=m.tileID.unwrapTo(m.tileID.wrap+a),h[m.tileID.key]=m}this._tiles=h;for(const d in this._timers)clearTimeout(this._timers[d]),delete this._timers[d];for(const d in this._tiles)this._setTileReloadTimer(d,this._tiles[d])}}_updateCoveredAndRetainedTiles(n,a,h,d,m,w){const T={},C={},I=Object.keys(n),M=N.now();for(const z of I){const $=n[z],G=this._tiles[z];if(!G||G.fadeEndTime!==0&&G.fadeEndTime<=M)continue;const H=this.findLoadedParent($,a),Q=this.findLoadedSibling($),ie=H||Q||null;ie&&(this._addTile(ie.tileID),T[ie.tileID.key]=ie.tileID),C[z]=$}this._retainLoadedChildren(C,d,h,n);for(const z in T)n[z]||(this._coveredTiles[z]=!0,n[z]=T[z]);if(w){const z={},$={};for(const G of m)this._tiles[G.key].hasData()?z[G.key]=G:$[G.key]=G;for(const G in $){const H=$[G].children(this._source.maxzoom);this._tiles[H[0].key]&&this._tiles[H[1].key]&&this._tiles[H[2].key]&&this._tiles[H[3].key]&&(z[H[0].key]=n[H[0].key]=H[0],z[H[1].key]=n[H[1].key]=H[1],z[H[2].key]=n[H[2].key]=H[2],z[H[3].key]=n[H[3].key]=H[3],delete $[G])}for(const G in $){const H=$[G],Q=this.findLoadedParent(H,this._source.minzoom),ie=this.findLoadedSibling(H),oe=Q||ie||null;if(oe){z[oe.tileID.key]=n[oe.tileID.key]=oe.tileID;for(const le in z)z[le].isChildOf(oe.tileID)&&delete z[le]}}for(const G in this._tiles)z[G]||(this._coveredTiles[G]=!0)}}update(n,a){if(!this._sourceLoaded||this._paused)return;let h;this.transform=n,this.terrain=a,this.updateCacheSize(n),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?h=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(M=>new u.S(M.canonical.z,M.wrap,M.canonical.z,M.canonical.x,M.canonical.y)):(h=n.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:a}),this._source.hasTile&&(h=h.filter(M=>this._source.hasTile(M)))):h=[];const d=n.coveringZoomLevel(this._source),m=Math.max(d-_t.maxOverzooming,this._source.minzoom),w=Math.max(d+_t.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const M={};for(const z of h)if(z.canonical.z>this._source.minzoom){const $=z.scaledTo(z.canonical.z-1);M[$.key]=$;const G=z.scaledTo(Math.max(this._source.minzoom,Math.min(z.canonical.z,5)));M[G.key]=G}h=h.concat(Object.values(M))}const T=h.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,T&&this.fire(new u.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const C=this._updateRetainedTiles(h,d);ji(this._source.type)&&this._updateCoveredAndRetainedTiles(C,m,w,d,h,a);for(const M in C)this._tiles[M].clearFadeHold();const I=u.ab(this._tiles,C);for(const M of I){const z=this._tiles[M];z.hasSymbolBuckets&&!z.holdingForFade()?z.setHoldDuration(this.map._fadeDuration):z.hasSymbolBuckets&&!z.symbolFadeFinished()||this._removeTile(M)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(n)}_updateRetainedTiles(n,a){var h;const d={},m={},w=Math.max(a-_t.maxOverzooming,this._source.minzoom),T=Math.max(a+_t.maxUnderzooming,this._source.minzoom),C={};for(const I of n){const M=this._addTile(I);d[I.key]=I,M.hasData()||a<this._source.maxzoom&&(C[I.key]=I)}this._retainLoadedChildren(C,a,T,d);for(const I of n){let M=this._tiles[I.key];if(M.hasData())continue;if(a+1>this._source.maxzoom){const $=I.children(this._source.maxzoom)[0],G=this.getTile($);if(G&&G.hasData()){d[$.key]=$;continue}}else{const $=I.children(this._source.maxzoom);if(d[$[0].key]&&d[$[1].key]&&d[$[2].key]&&d[$[3].key])continue}let z=M.wasRequested();for(let $=I.overscaledZ-1;$>=w;--$){const G=I.scaledTo($);if(m[G.key])break;if(m[G.key]=!0,M=this.getTile(G),!M&&z&&(M=this._addTile(G)),M){const H=M.hasData();if((H||!(!((h=this.map)===null||h===void 0)&&h.cancelPendingTileRequestsWhileZooming)||z)&&(d[G.key]=G),z=M.wasRequested(),H)break}}}return d}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const n in this._tiles){const a=[];let h,d=this._tiles[n].tileID;for(;d.overscaledZ>0;){if(d.key in this._loadedParentTiles){h=this._loadedParentTiles[d.key];break}a.push(d.key);const m=d.scaledTo(d.overscaledZ-1);if(h=this._getLoadedTile(m),h)break;d=m}for(const m of a)this._loadedParentTiles[m]=h}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const n in this._tiles){const a=this._tiles[n].tileID,h=this._getLoadedTile(a);this._loadedSiblingTiles[a.key]=h}}_addTile(n){let a=this._tiles[n.key];if(a)return a;a=this._cache.getAndRemove(n),a&&(this._setTileReloadTimer(n.key,a),a.tileID=n,this._state.initializeTileState(a,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,a)));const h=a;return a||(a=new $i(n,this._source.tileSize*n.overscaleFactor()),this._loadTile(a,n.key,a.state)),a.uses++,this._tiles[n.key]=a,h||this._source.fire(new u.k("dataloading",{tile:a,coord:a.tileID,dataType:"source"})),a}_setTileReloadTimer(n,a){n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);const h=a.getExpiryTimeout();h&&(this._timers[n]=setTimeout(()=>{this._reloadTile(n,"expired"),delete this._timers[n]},h))}_removeTile(n){const a=this._tiles[n];a&&(a.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),a.uses>0||(a.hasData()&&a.state!=="reloading"?this._cache.add(a.tileID,a,a.getExpiryTimeout()):(a.aborted=!0,this._abortTile(a),this._unloadTile(a))))}_dataHandler(n){const a=n.sourceDataType;n.dataType==="source"&&a==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&n.dataType==="source"&&a==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const n in this._tiles)this._removeTile(n);this._cache.reset()}tilesIn(n,a,h){const d=[],m=this.transform;if(!m)return d;const w=h?m.getCameraQueryGeometry(n):n,T=n.map(H=>m.pointCoordinate(H,this.terrain)),C=w.map(H=>m.pointCoordinate(H,this.terrain)),I=this.getIds();let M=1/0,z=1/0,$=-1/0,G=-1/0;for(const H of C)M=Math.min(M,H.x),z=Math.min(z,H.y),$=Math.max($,H.x),G=Math.max(G,H.y);for(let H=0;H<I.length;H++){const Q=this._tiles[I[H]];if(Q.holdingForFade())continue;const ie=Q.tileID,oe=Math.pow(2,m.zoom-Q.tileID.overscaledZ),le=a*Q.queryPadding*u.X/Q.tileSize/oe,K=[ie.getTilePoint(new u.Z(M,z)),ie.getTilePoint(new u.Z($,G))];if(K[0].x-le<u.X&&K[0].y-le<u.X&&K[1].x+le>=0&&K[1].y+le>=0){const he=T.map(ve=>ie.getTilePoint(ve)),fe=C.map(ve=>ie.getTilePoint(ve));d.push({tile:Q,tileID:ie,queryGeometry:he,cameraQueryGeometry:fe,scale:oe})}}return d}getVisibleCoordinates(n){const a=this.getRenderableIds(n).map(h=>this._tiles[h].tileID);for(const h of a)h.posMatrix=this.transform.calculatePosMatrix(h.toUnwrapped());return a}hasTransition(){if(this._source.hasTransition())return!0;if(ji(this._source.type)){const n=N.now();for(const a in this._tiles)if(this._tiles[a].fadeEndTime>=n)return!0}return!1}setFeatureState(n,a,h){this._state.updateState(n=n||"_geojsonTileLayer",a,h)}removeFeatureState(n,a,h){this._state.removeFeatureState(n=n||"_geojsonTileLayer",a,h)}getFeatureState(n,a){return this._state.getState(n=n||"_geojsonTileLayer",a)}setDependencies(n,a,h){const d=this._tiles[n];d&&d.setDependencies(a,h)}reloadTilesForDependencies(n,a){for(const h in this._tiles)this._tiles[h].hasDependency(n,a)&&this._reloadTile(h,"reloading");this._cache.filter(h=>!h.hasDependency(n,a))}}function Gr(g,n){const a=Math.abs(2*g.wrap)-+(g.wrap<0),h=Math.abs(2*n.wrap)-+(n.wrap<0);return g.overscaledZ-n.overscaledZ||h-a||n.canonical.y-g.canonical.y||n.canonical.x-g.canonical.x}function ji(g){return g==="raster"||g==="image"||g==="video"}_t.maxOverzooming=10,_t.maxUnderzooming=3;class kt{constructor(n,a){this.reset(n,a)}reset(n,a){this.points=n||[],this._distances=[0];for(let h=1;h<this.points.length;h++)this._distances[h]=this._distances[h-1]+this.points[h].dist(this.points[h-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(n){if(this.points.length===1)return this.points[0];n=u.ac(n,0,1);let a=1,h=this._distances[a];const d=n*this.paddedLength+this.padding;for(;h<d&&a<this._distances.length;)h=this._distances[++a];const m=a-1,w=this._distances[m],T=h-w,C=T>0?(d-w)/T:0;return this.points[m].mult(1-C).add(this.points[a].mult(C))}}function po(g,n){let a=!0;return g==="always"||g!=="never"&&n!=="never"||(a=!1),a}class $o{constructor(n,a,h){const d=this.boxCells=[],m=this.circleCells=[];this.xCellCount=Math.ceil(n/h),this.yCellCount=Math.ceil(a/h);for(let w=0;w<this.xCellCount*this.yCellCount;w++)d.push([]),m.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=a,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/a,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(n,a,h,d,m){this._forEachCell(a,h,d,m,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(a),this.bboxes.push(h),this.bboxes.push(d),this.bboxes.push(m)}insertCircle(n,a,h,d){this._forEachCell(a-d,h-d,a+d,h+d,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(a),this.circles.push(h),this.circles.push(d)}_insertBoxCell(n,a,h,d,m,w){this.boxCells[m].push(w)}_insertCircleCell(n,a,h,d,m,w){this.circleCells[m].push(w)}_query(n,a,h,d,m,w,T){if(h<0||n>this.width||d<0||a>this.height)return[];const C=[];if(n<=0&&a<=0&&this.width<=h&&this.height<=d){if(m)return[{key:null,x1:n,y1:a,x2:h,y2:d}];for(let I=0;I<this.boxKeys.length;I++)C.push({key:this.boxKeys[I],x1:this.bboxes[4*I],y1:this.bboxes[4*I+1],x2:this.bboxes[4*I+2],y2:this.bboxes[4*I+3]});for(let I=0;I<this.circleKeys.length;I++){const M=this.circles[3*I],z=this.circles[3*I+1],$=this.circles[3*I+2];C.push({key:this.circleKeys[I],x1:M-$,y1:z-$,x2:M+$,y2:z+$})}}else this._forEachCell(n,a,h,d,this._queryCell,C,{hitTest:m,overlapMode:w,seenUids:{box:{},circle:{}}},T);return C}query(n,a,h,d){return this._query(n,a,h,d,!1,null)}hitTest(n,a,h,d,m,w){return this._query(n,a,h,d,!0,m,w).length>0}hitTestCircle(n,a,h,d,m){const w=n-h,T=n+h,C=a-h,I=a+h;if(T<0||w>this.width||I<0||C>this.height)return!1;const M=[];return this._forEachCell(w,C,T,I,this._queryCellCircle,M,{hitTest:!0,overlapMode:d,circle:{x:n,y:a,radius:h},seenUids:{box:{},circle:{}}},m),M.length>0}_queryCell(n,a,h,d,m,w,T,C){const{seenUids:I,hitTest:M,overlapMode:z}=T,$=this.boxCells[m];if($!==null){const H=this.bboxes;for(const Q of $)if(!I.box[Q]){I.box[Q]=!0;const ie=4*Q,oe=this.boxKeys[Q];if(n<=H[ie+2]&&a<=H[ie+3]&&h>=H[ie+0]&&d>=H[ie+1]&&(!C||C(oe))&&(!M||!po(z,oe.overlapMode))&&(w.push({key:oe,x1:H[ie],y1:H[ie+1],x2:H[ie+2],y2:H[ie+3]}),M))return!0}}const G=this.circleCells[m];if(G!==null){const H=this.circles;for(const Q of G)if(!I.circle[Q]){I.circle[Q]=!0;const ie=3*Q,oe=this.circleKeys[Q];if(this._circleAndRectCollide(H[ie],H[ie+1],H[ie+2],n,a,h,d)&&(!C||C(oe))&&(!M||!po(z,oe.overlapMode))){const le=H[ie],K=H[ie+1],he=H[ie+2];if(w.push({key:oe,x1:le-he,y1:K-he,x2:le+he,y2:K+he}),M)return!0}}}return!1}_queryCellCircle(n,a,h,d,m,w,T,C){const{circle:I,seenUids:M,overlapMode:z}=T,$=this.boxCells[m];if($!==null){const H=this.bboxes;for(const Q of $)if(!M.box[Q]){M.box[Q]=!0;const ie=4*Q,oe=this.boxKeys[Q];if(this._circleAndRectCollide(I.x,I.y,I.radius,H[ie+0],H[ie+1],H[ie+2],H[ie+3])&&(!C||C(oe))&&!po(z,oe.overlapMode))return w.push(!0),!0}}const G=this.circleCells[m];if(G!==null){const H=this.circles;for(const Q of G)if(!M.circle[Q]){M.circle[Q]=!0;const ie=3*Q,oe=this.circleKeys[Q];if(this._circlesCollide(H[ie],H[ie+1],H[ie+2],I.x,I.y,I.radius)&&(!C||C(oe))&&!po(z,oe.overlapMode))return w.push(!0),!0}}}_forEachCell(n,a,h,d,m,w,T,C){const I=this._convertToXCellCoord(n),M=this._convertToYCellCoord(a),z=this._convertToXCellCoord(h),$=this._convertToYCellCoord(d);for(let G=I;G<=z;G++)for(let H=M;H<=$;H++)if(m.call(this,n,a,h,d,this.xCellCount*H+G,w,T,C))return}_convertToXCellCoord(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))}_convertToYCellCoord(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))}_circlesCollide(n,a,h,d,m,w){const T=d-n,C=m-a,I=h+w;return I*I>T*T+C*C}_circleAndRectCollide(n,a,h,d,m,w,T){const C=(w-d)/2,I=Math.abs(n-(d+C));if(I>C+h)return!1;const M=(T-m)/2,z=Math.abs(a-(m+M));if(z>M+h)return!1;if(I<=C||z<=M)return!0;const $=I-C,G=z-M;return $*$+G*G<=h*h}}function ns(g,n,a,h,d){const m=u.H();return n?(u.K(m,m,[1/d,1/d,1]),a||u.ad(m,m,h.angle)):u.L(m,h.labelPlaneMatrix,g),m}function fo(g,n,a,h,d){if(n){const m=u.ae(g);return u.K(m,m,[d,d,1]),a||u.ad(m,m,-h.angle),m}return h.glCoordMatrix}function te(g,n,a,h){let d;h?(d=[g,n,h(g,n),1],u.af(d,d,a)):(d=[g,n,0,1],jt(d,d,a));const m=d[3];return{point:new u.P(d[0]/m,d[1]/m),signedDistanceFromCamera:m,isOccluded:!1}}function B(g,n){return .5+g/n*.5}function F(g,n){return g.x>=-n[0]&&g.x<=n[0]&&g.y>=-n[1]&&g.y<=n[1]}function q(g,n,a,h,d,m,w,T,C,I,M,z,$,G,H){const Q=h?g.textSizeData:g.iconSizeData,ie=u.ag(Q,a.transform.zoom),oe=[256/a.width*2+1,256/a.height*2+1],le=h?g.text.dynamicLayoutVertexArray:g.icon.dynamicLayoutVertexArray;le.clear();const K=g.lineVertexArray,he=h?g.text.placedSymbolArray:g.icon.placedSymbolArray,fe=a.transform.width/a.transform.height;let ve=!1;for(let Me=0;Me<he.length;Me++){const De=he.get(Me);if(De.hidden||De.writingMode===u.ah.vertical&&!ve){pt(De.numGlyphs,le);continue}ve=!1;const Ze=te(De.anchorX,De.anchorY,n,H);if(!F(Ze.point,oe)){pt(De.numGlyphs,le);continue}const Ye=B(a.transform.cameraToCenterDistance,Ze.signedDistanceFromCamera),Ue=u.ai(Q,ie,De),je=w?Ue/Ye:Ue*Ye,it={getElevation:H,labelPlaneMatrix:d,lineVertexArray:K,pitchWithMap:w,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:I,tileAnchorPoint:new u.P(De.anchorX,De.anchorY),unwrappedTileID:M,width:z,height:$,translation:G},St=de(it,De,je,!1,T,n,m,g.glyphOffsetArray,le,fe,C);ve=St.useVertical,(St.notEnoughRoom||ve||St.needsFlipping&&de(it,De,je,!0,T,n,m,g.glyphOffsetArray,le,fe,C).notEnoughRoom)&&pt(De.numGlyphs,le)}h?g.text.dynamicLayoutVertexBuffer.updateData(le):g.icon.dynamicLayoutVertexBuffer.updateData(le)}function J(g,n,a,h,d,m,w,T){const C=m.glyphStartIndex+m.numGlyphs,I=m.lineStartIndex,M=m.lineStartIndex+m.lineLength,z=n.getoffsetX(m.glyphStartIndex),$=n.getoffsetX(C-1),G=$e(g*z,a,h,d,m.segment,I,M,T,w);if(!G)return null;const H=$e(g*$,a,h,d,m.segment,I,M,T,w);return H?T.projectionCache.anyProjectionOccluded?null:{first:G,last:H}:null}function ue(g,n,a,h){return g===u.ah.horizontal&&Math.abs(a.y-n.y)>Math.abs(a.x-n.x)*h?{useVertical:!0}:(g===u.ah.vertical?n.y<a.y:n.x>a.x)?{needsFlipping:!0}:null}function de(g,n,a,h,d,m,w,T,C,I,M){const z=a/24,$=n.lineOffsetX*z,G=n.lineOffsetY*z;let H;if(n.numGlyphs>1){const Q=n.glyphStartIndex+n.numGlyphs,ie=n.lineStartIndex,oe=n.lineStartIndex+n.lineLength,le=J(z,T,$,G,h,n,M,g);if(!le)return{notEnoughRoom:!0};const K=te(le.first.point.x,le.first.point.y,w,g.getElevation).point,he=te(le.last.point.x,le.last.point.y,w,g.getElevation).point;if(d&&!h){const fe=ue(n.writingMode,K,he,I);if(fe)return fe}H=[le.first];for(let fe=n.glyphStartIndex+1;fe<Q-1;fe++)H.push($e(z*T.getoffsetX(fe),$,G,h,n.segment,ie,oe,g,M));H.push(le.last)}else{if(d&&!h){const ie=te(g.tileAnchorPoint.x,g.tileAnchorPoint.y,m,g.getElevation).point,oe=n.lineStartIndex+n.segment+1,le=new u.P(g.lineVertexArray.getx(oe),g.lineVertexArray.gety(oe)),K=te(le.x,le.y,m,g.getElevation),he=K.signedDistanceFromCamera>0?K.point:function(ve,Me,De,Ze,Ye,Ue){return ge(ve,Me,De,1,Ye,Ue)}(g.tileAnchorPoint,le,ie,0,m,g),fe=ue(n.writingMode,ie,he,I);if(fe)return fe}const Q=$e(z*T.getoffsetX(n.glyphStartIndex),$,G,h,n.segment,n.lineStartIndex,n.lineStartIndex+n.lineLength,g,M);if(!Q||g.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};H=[Q]}for(const Q of H)u.aj(C,Q.point,Q.angle);return{}}function ge(g,n,a,h,d,m){const w=g.add(g.sub(n)._unit()),T=d!==void 0?te(w.x,w.y,d,m.getElevation).point:Ee(w.x,w.y,m).point,C=a.sub(T);return a.add(C._mult(h/C.mag()))}function ae(g,n,a){const h=n.projectionCache;if(h.projections[g])return h.projections[g];const d=new u.P(n.lineVertexArray.getx(g),n.lineVertexArray.gety(g)),m=Ee(d.x,d.y,n);if(m.signedDistanceFromCamera>0)return h.projections[g]=m.point,h.anyProjectionOccluded=h.anyProjectionOccluded||m.isOccluded,m.point;const w=g-a.direction;return function(T,C,I,M,z){return ge(T,C,I,M,void 0,z)}(a.distanceFromAnchor===0?n.tileAnchorPoint:new u.P(n.lineVertexArray.getx(w),n.lineVertexArray.gety(w)),d,a.previousVertex,a.absOffsetX-a.distanceFromAnchor+1,n)}function Ee(g,n,a){const h=g+a.translation[0],d=n+a.translation[1];let m;return!a.pitchWithMap&&a.projection.useSpecialProjectionForSymbols?(m=a.projection.projectTileCoordinates(h,d,a.unwrappedTileID,a.getElevation),m.point.x=(.5*m.point.x+.5)*a.width,m.point.y=(.5*-m.point.y+.5)*a.height):(m=te(h,d,a.labelPlaneMatrix,a.getElevation),m.isOccluded=!1),m}function ze(g,n,a){return g._unit()._perp()._mult(n*a)}function we(g,n,a,h,d,m,w,T,C){if(T.projectionCache.offsets[g])return T.projectionCache.offsets[g];const I=a.add(n);if(g+C.direction<h||g+C.direction>=d)return T.projectionCache.offsets[g]=I,I;const M=ae(g+C.direction,T,C),z=ze(M.sub(a),w,C.direction),$=a.add(z),G=M.add(z);return T.projectionCache.offsets[g]=u.ak(m,I,$,G)||I,T.projectionCache.offsets[g]}function $e(g,n,a,h,d,m,w,T,C){const I=h?g-n:g+n;let M=I>0?1:-1,z=0;h&&(M*=-1,z=Math.PI),M<0&&(z+=Math.PI);let $,G=M>0?m+d:m+d+1;T.projectionCache.cachedAnchorPoint?$=T.projectionCache.cachedAnchorPoint:($=Ee(T.tileAnchorPoint.x,T.tileAnchorPoint.y,T).point,T.projectionCache.cachedAnchorPoint=$);let H,Q,ie=$,oe=$,le=0,K=0;const he=Math.abs(I),fe=[];let ve;for(;le+K<=he;){if(G+=M,G<m||G>=w)return null;le+=K,oe=ie,Q=H;const Ze={absOffsetX:he,direction:M,distanceFromAnchor:le,previousVertex:oe};if(ie=ae(G,T,Ze),a===0)fe.push(oe),ve=ie.sub(oe);else{let Ye;const Ue=ie.sub(oe);Ye=Ue.mag()===0?ze(ae(G+M,T,Ze).sub(ie),a,M):ze(Ue,a,M),Q||(Q=oe.add(Ye)),H=we(G,Ye,ie,m,w,Q,a,T,Ze),fe.push(Q),ve=H.sub(Q)}K=ve.mag()}const Me=ve._mult((he-le)/K)._add(Q||oe),De=z+Math.atan2(ie.y-oe.y,ie.x-oe.x);return fe.push(Me),{point:Me,angle:C?De:0,path:fe}}const ct=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function pt(g,n){for(let a=0;a<g;a++){const h=n.length;n.resize(h+4),n.float32.set(ct,3*h)}}function jt(g,n,a){const h=n[0],d=n[1];return g[0]=a[0]*h+a[4]*d+a[12],g[1]=a[1]*h+a[5]*d+a[13],g[3]=a[3]*h+a[7]*d+a[15],g}const Et=100;class Ut{constructor(n,a,h=new $o(n.width+200,n.height+200,25),d=new $o(n.width+200,n.height+200,25)){this.transform=n,this.mapProjection=a,this.grid=h,this.ignoredGrid=d,this.pitchFactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+Et,this.screenBottomBoundary=n.height+Et,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(n,a,h,d,m,w,T,C,I,M,z){const $=n.anchorPointX+C[0],G=n.anchorPointY+C[1],H=this.projectAndGetPerspectiveRatio(d,$,G,m,M),Q=h*H.perspectiveRatio;let ie;if(w||T)ie=this._projectCollisionBox(n,Q,d,m,w,T,C,H,M,z);else{const fe=H.point.x+(z?z.x*Q:0),ve=H.point.y+(z?z.y*Q:0);ie={allPointsOccluded:!1,box:[fe+n.x1*Q,ve+n.y1*Q,fe+n.x2*Q,ve+n.y2*Q]}}const[oe,le,K,he]=ie.box;return this.mapProjection.useSpecialProjectionForSymbols&&(w?ie.allPointsOccluded:this.mapProjection.isOccluded($,G,m))||H.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(oe,le,K,he)||a!=="always"&&this.grid.hitTest(oe,le,K,he,a,I)?{box:[oe,le,K,he],placeable:!1,offscreen:!1}:{box:[oe,le,K,he],placeable:!0,offscreen:this.isOffscreen(oe,le,K,he)}}placeCollisionCircles(n,a,h,d,m,w,T,C,I,M,z,$,G,H,Q,ie){const oe=[],le=new u.P(a.anchorX,a.anchorY),K=this.getPerspectiveRatio(w,le.x,le.y,T,ie),he=(z?m/K:m*K)/u.ap,fe={getElevation:ie,labelPlaneMatrix:C,lineVertexArray:h,pitchWithMap:z,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:le,unwrappedTileID:T,width:this.transform.width,height:this.transform.height,translation:Q},ve=J(he,d,a.lineOffsetX*he,a.lineOffsetY*he,!1,a,!1,fe);let Me=!1,De=!1,Ze=!0;if(ve){const Ye=.5*G*K+H,Ue=new u.P(-100,-100),je=new u.P(this.screenRightBoundary,this.screenBottomBoundary),it=new kt,St=ve.first,Ge=ve.last;let Ke=[];for(let Pt=St.path.length-1;Pt>=1;Pt--)Ke.push(St.path[Pt]);for(let Pt=1;Pt<Ge.path.length;Pt++)Ke.push(Ge.path[Pt]);const xt=2.5*Ye;if(I){const Pt=this.projectPathToScreenSpace(Ke,fe,I);Ke=Pt.some(Ft=>Ft.signedDistanceFromCamera<=0)?[]:Pt.map(Ft=>Ft.point)}let xn=[];if(Ke.length>0){const Pt=Ke[0].clone(),Ft=Ke[0].clone();for(let bn=1;bn<Ke.length;bn++)Pt.x=Math.min(Pt.x,Ke[bn].x),Pt.y=Math.min(Pt.y,Ke[bn].y),Ft.x=Math.max(Ft.x,Ke[bn].x),Ft.y=Math.max(Ft.y,Ke[bn].y);xn=Pt.x>=Ue.x&&Ft.x<=je.x&&Pt.y>=Ue.y&&Ft.y<=je.y?[Ke]:Ft.x<Ue.x||Pt.x>je.x||Ft.y<Ue.y||Pt.y>je.y?[]:u.al([Ke],Ue.x,Ue.y,je.x,je.y)}for(const Pt of xn){it.reset(Pt,.25*Ye);let Ft=0;Ft=it.length<=.5*Ye?1:Math.ceil(it.paddedLength/xt)+1;for(let bn=0;bn<Ft;bn++){const vr=bn/Math.max(Ft-1,1),Zi=it.lerp(vr),wn=Zi.x+Et,Zr=Zi.y+Et;oe.push(wn,Zr,Ye,0);const Rr=wn-Ye,xr=Zr-Ye,Dr=wn+Ye,_o=Zr+Ye;if(Ze=Ze&&this.isOffscreen(Rr,xr,Dr,_o),De=De||this.isInsideGrid(Rr,xr,Dr,_o),n!=="always"&&this.grid.hitTestCircle(wn,Zr,Ye,n,$)&&(Me=!0,!M))return{circles:[],offscreen:!1,collisionDetected:Me}}}}return{circles:!M&&Me||!De||K<this.perspectiveRatioCutoff?[]:oe,offscreen:Ze,collisionDetected:Me}}projectPathToScreenSpace(n,a,h){return n.map(d=>te(d.x,d.y,h,a.getElevation))}queryRenderedSymbols(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const a=[];let h=1/0,d=1/0,m=-1/0,w=-1/0;for(const M of n){const z=new u.P(M.x+Et,M.y+Et);h=Math.min(h,z.x),d=Math.min(d,z.y),m=Math.max(m,z.x),w=Math.max(w,z.y),a.push(z)}const T=this.grid.query(h,d,m,w).concat(this.ignoredGrid.query(h,d,m,w)),C={},I={};for(const M of T){const z=M.key;if(C[z.bucketInstanceId]===void 0&&(C[z.bucketInstanceId]={}),C[z.bucketInstanceId][z.featureIndex])continue;const $=[new u.P(M.x1,M.y1),new u.P(M.x2,M.y1),new u.P(M.x2,M.y2),new u.P(M.x1,M.y2)];u.am(a,$)&&(C[z.bucketInstanceId][z.featureIndex]=!0,I[z.bucketInstanceId]===void 0&&(I[z.bucketInstanceId]=[]),I[z.bucketInstanceId].push(z.featureIndex))}return I}insertCollisionBox(n,a,h,d,m,w){(h?this.ignoredGrid:this.grid).insert({bucketInstanceId:d,featureIndex:m,collisionGroupID:w,overlapMode:a},n[0],n[1],n[2],n[3])}insertCollisionCircles(n,a,h,d,m,w){const T=h?this.ignoredGrid:this.grid,C={bucketInstanceId:d,featureIndex:m,collisionGroupID:w,overlapMode:a};for(let I=0;I<n.length;I+=4)T.insertCircle(C,n[I],n[I+1],n[I+2])}projectAndGetPerspectiveRatio(n,a,h,d,m){let w;m?(w=[a,h,m(a,h),1],u.af(w,w,n)):(w=[a,h,0,1],jt(w,w,n));const T=w[3];return{point:new u.P((w[0]/T+1)/2*this.transform.width+Et,(-w[1]/T+1)/2*this.transform.height+Et),perspectiveRatio:.5+this.transform.cameraToCenterDistance/T*.5,isOccluded:!1,signedDistanceFromCamera:T}}getPerspectiveRatio(n,a,h,d,m){const w=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(a,h,d,m):te(a,h,n,m);return .5+this.transform.cameraToCenterDistance/w.signedDistanceFromCamera*.5}isOffscreen(n,a,h,d){return h<Et||n>=this.screenRightBoundary||d<Et||a>this.screenBottomBoundary}isInsideGrid(n,a,h,d){return h>=0&&n<this.gridRightBoundary&&d>=0&&a<this.gridBottomBoundary}getViewportMatrix(){const n=u.an([]);return u.J(n,n,[-100,-100,0]),n}_projectCollisionBox(n,a,h,d,m,w,T,C,I,M){let z=new u.P(1,0),$=new u.P(0,1);const G=new u.P(n.anchorPointX+T[0],n.anchorPointY+T[1]);if(w&&!m){const Ze=this.projectAndGetPerspectiveRatio(h,G.x+1,G.y,d,I).point.sub(C.point).unit(),Ye=Math.atan(Ze.y/Ze.x)+(Ze.x<0?Math.PI:0),Ue=Math.sin(Ye),je=Math.cos(Ye);z=new u.P(je,Ue),$=new u.P(-Ue,je)}else if(!w&&m){const Ze=-this.transform.angle,Ye=Math.sin(Ze),Ue=Math.cos(Ze);z=new u.P(Ue,Ye),$=new u.P(-Ye,Ue)}let H=C.point,Q=a;if(m){H=G;const Ze=this.transform.zoom-Math.floor(this.transform.zoom);Q=Math.pow(2,-Ze),Q*=this.mapProjection.getPitchedTextCorrection(this.transform,G,d),M||(Q*=u.ac(.5+C.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}M&&(H=H.add(z.mult(M.x*Q)).add($.mult(M.y*Q)));const ie=n.x1*Q,oe=n.x2*Q,le=(ie+oe)/2,K=n.y1*Q,he=n.y2*Q,fe=(K+he)/2,ve=[{offsetX:ie,offsetY:K},{offsetX:le,offsetY:K},{offsetX:oe,offsetY:K},{offsetX:oe,offsetY:fe},{offsetX:oe,offsetY:he},{offsetX:le,offsetY:he},{offsetX:ie,offsetY:he},{offsetX:ie,offsetY:fe}];let Me=[];for(const{offsetX:Ze,offsetY:Ye}of ve)Me.push(new u.P(H.x+z.x*Ze+$.x*Ye,H.y+z.y*Ze+$.y*Ye));let De=!1;if(m){const Ze=Me.map(Ye=>this.projectAndGetPerspectiveRatio(h,Ye.x,Ye.y,d,I));De=Ze.some(Ye=>!Ye.isOccluded),Me=Ze.map(Ye=>Ye.point)}else De=!0;return{box:u.ao(Me),allPointsOccluded:!De}}}function Dt(g,n,a){return n*(u.X/(g.tileSize*Math.pow(2,a-g.tileID.overscaledZ)))}class Hn{constructor(n,a,h,d){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?a:-a))):d&&h?1:0,this.placed=h}isHidden(){return this.opacity===0&&!this.placed}}class Mn{constructor(n,a,h,d,m){this.text=new Hn(n?n.text:null,a,h,m),this.icon=new Hn(n?n.icon:null,a,d,m)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class zt{constructor(n,a,h){this.text=n,this.icon=a,this.skipFade=h}}class en{constructor(){this.invProjMatrix=u.H(),this.viewportMatrix=u.H(),this.circles=[]}}class kn{constructor(n,a,h,d,m){this.bucketInstanceId=n,this.featureIndex=a,this.sourceLayerIndex=h,this.bucketIndex=d,this.tileID=m}}class ir{constructor(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}}get(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){const a=++this.maxGroupID;this.collisionGroups[n]={ID:a,predicate:h=>h.collisionGroupID===a}}return this.collisionGroups[n]}}function hr(g,n,a,h,d){const{horizontalAlign:m,verticalAlign:w}=u.au(g);return new u.P(-(m-.5)*n+h[0]*d,-(w-.5)*a+h[1]*d)}class Lr{constructor(n,a,h,d,m,w){this.transform=n.clone(),this.terrain=h,this.collisionIndex=new Ut(this.transform,a),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=d,this.retainedQueryData={},this.collisionGroups=new ir(m),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(n){const a=this.terrain;return a?(h,d)=>a.getElevation(n,h,d):null}getBucketParts(n,a,h,d){const m=h.getBucket(a),w=h.latestFeatureIndex;if(!m||!w||a.id!==m.layerIds[0])return;const T=h.collisionBoxArray,C=m.layers[0].layout,I=m.layers[0].paint,M=Math.pow(2,this.transform.zoom-h.tileID.overscaledZ),z=h.tileSize/u.X,$=h.tileID.toUnwrapped(),G=this.transform.calculatePosMatrix($),H=C.get("text-pitch-alignment")==="map",Q=C.get("text-rotation-alignment")==="map",ie=Dt(h,1,this.transform.zoom),oe=this.collisionIndex.mapProjection.translatePosition(this.transform,h,I.get("text-translate"),I.get("text-translate-anchor")),le=this.collisionIndex.mapProjection.translatePosition(this.transform,h,I.get("icon-translate"),I.get("icon-translate-anchor")),K=ns(G,H,Q,this.transform,ie);let he=null;if(H){const ve=fo(G,H,Q,this.transform,ie);he=u.L([],this.transform.labelPlaneMatrix,ve)}this.retainedQueryData[m.bucketInstanceId]=new kn(m.bucketInstanceId,w,m.sourceLayerIndex,m.index,h.tileID);const fe={bucket:m,layout:C,translationText:oe,translationIcon:le,posMatrix:G,unwrappedTileID:$,textLabelPlaneMatrix:K,labelToScreenMatrix:he,scale:M,textPixelRatio:z,holdingForFade:h.holdingForFade(),collisionBoxArray:T,partiallyEvaluatedTextSize:u.ag(m.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(m.sourceID)};if(d)for(const ve of m.sortKeyRanges){const{sortKey:Me,symbolInstanceStart:De,symbolInstanceEnd:Ze}=ve;n.push({sortKey:Me,symbolInstanceStart:De,symbolInstanceEnd:Ze,parameters:fe})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:m.symbolInstances.length,parameters:fe})}attemptAnchorPlacement(n,a,h,d,m,w,T,C,I,M,z,$,G,H,Q,ie,oe,le,K){const he=u.aq[n.textAnchor],fe=[n.textOffset0,n.textOffset1],ve=hr(he,h,d,fe,m),Me=this.collisionIndex.placeCollisionBox(a,$,C,I,M,T,w,ie,z.predicate,K,ve);if((!le||this.collisionIndex.placeCollisionBox(le,$,C,I,M,T,w,oe,z.predicate,K,ve).placeable)&&Me.placeable){let De;if(this.prevPlacement&&this.prevPlacement.variableOffsets[G.crossTileID]&&this.prevPlacement.placements[G.crossTileID]&&this.prevPlacement.placements[G.crossTileID].text&&(De=this.prevPlacement.variableOffsets[G.crossTileID].anchor),G.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[G.crossTileID]={textOffset:fe,width:h,height:d,anchor:he,textBoxScale:m,prevAnchor:De},this.markUsedJustification(H,he,G,Q),H.allowVerticalPlacement&&(this.markUsedOrientation(H,Q,G),this.placedOrientations[G.crossTileID]=Q),{shift:ve,placedGlyphBoxes:Me}}}placeLayerBucketPart(n,a,h){const{bucket:d,layout:m,translationText:w,translationIcon:T,posMatrix:C,unwrappedTileID:I,textLabelPlaneMatrix:M,labelToScreenMatrix:z,textPixelRatio:$,holdingForFade:G,collisionBoxArray:H,partiallyEvaluatedTextSize:Q,collisionGroup:ie}=n.parameters,oe=m.get("text-optional"),le=m.get("icon-optional"),K=u.ar(m,"text-overlap","text-allow-overlap"),he=K==="always",fe=u.ar(m,"icon-overlap","icon-allow-overlap"),ve=fe==="always",Me=m.get("text-rotation-alignment")==="map",De=m.get("text-pitch-alignment")==="map",Ze=m.get("icon-text-fit")!=="none",Ye=m.get("symbol-z-order")==="viewport-y",Ue=he&&(ve||!d.hasIconData()||le),je=ve&&(he||!d.hasTextData()||oe);!d.collisionArrays&&H&&d.deserializeCollisionBoxes(H);const it=this._getTerrainElevationFunc(this.retainedQueryData[d.bucketInstanceId].tileID),St=(Ge,Ke,xt)=>{var xn,Pt;if(a[Ge.crossTileID])return;if(G)return void(this.placements[Ge.crossTileID]=new zt(!1,!1,!1));let Ft=!1,bn=!1,vr=!0,Zi=null,wn={box:null,placeable:!1,offscreen:null},Zr={box:null,placeable:!1,offscreen:null},Rr=null,xr=null,Dr=null,_o=0,Sa=0,Ic=0;Ke.textFeatureIndex?_o=Ke.textFeatureIndex:Ge.useRuntimeCollisionCircles&&(_o=Ge.featureIndex),Ke.verticalTextFeatureIndex&&(Sa=Ke.verticalTextFeatureIndex);const Ta=Ke.textBox;if(Ta){const Ii=dr=>{let br=u.ah.horizontal;if(d.allowVerticalPlacement&&!dr&&this.prevPlacement){const pi=this.prevPlacement.placedOrientations[Ge.crossTileID];pi&&(this.placedOrientations[Ge.crossTileID]=pi,br=pi,this.markUsedOrientation(d,br,Ge))}return br},Pi=(dr,br)=>{if(d.allowVerticalPlacement&&Ge.numVerticalGlyphVertices>0&&Ke.verticalTextBox){for(const pi of d.writingModes)if(pi===u.ah.vertical?(wn=br(),Zr=wn):wn=dr(),wn&&wn.placeable)break}else wn=dr()},os=Ge.textAnchorOffsetStartIndex,Wi=Ge.textAnchorOffsetEndIndex;if(Wi===os){const dr=(br,pi)=>{const Ot=this.collisionIndex.placeCollisionBox(br,K,$,C,I,De,Me,w,ie.predicate,it);return Ot&&Ot.placeable&&(this.markUsedOrientation(d,pi,Ge),this.placedOrientations[Ge.crossTileID]=pi),Ot};Pi(()=>dr(Ta,u.ah.horizontal),()=>{const br=Ke.verticalTextBox;return d.allowVerticalPlacement&&Ge.numVerticalGlyphVertices>0&&br?dr(br,u.ah.vertical):{box:null,offscreen:null}}),Ii(wn&&wn.placeable)}else{let dr=u.aq[(Pt=(xn=this.prevPlacement)===null||xn===void 0?void 0:xn.variableOffsets[Ge.crossTileID])===null||Pt===void 0?void 0:Pt.anchor];const br=(Ot,Bs,Ca)=>{const ka=Ot.x2-Ot.x1,jp=Ot.y2-Ot.y1,uy=Ge.textBoxScale,Up=Ze&&fe==="never"?Bs:null;let ss=null,Vp=K==="never"?1:2,Ac="never";dr&&Vp++;for(let xl=0;xl<Vp;xl++){for(let Mc=os;Mc<Wi;Mc++){const zc=d.textAnchorOffsets.get(Mc);if(dr&&zc.textAnchor!==dr)continue;const Ea=this.attemptAnchorPlacement(zc,Ot,ka,jp,uy,Me,De,$,C,I,ie,Ac,Ge,d,Ca,w,T,Up,it);if(Ea&&(ss=Ea.placedGlyphBoxes,ss&&ss.placeable))return Ft=!0,Zi=Ea.shift,ss}dr?dr=null:Ac=K}return h&&!ss&&(ss={box:this.collisionIndex.placeCollisionBox(Ta,"always",$,C,I,De,Me,w,ie.predicate,it,new u.P(0,0)).box,offscreen:!1,placeable:!1}),ss};Pi(()=>br(Ta,Ke.iconBox,u.ah.horizontal),()=>{const Ot=Ke.verticalTextBox;return d.allowVerticalPlacement&&(!wn||!wn.placeable)&&Ge.numVerticalGlyphVertices>0&&Ot?br(Ot,Ke.verticalIconBox,u.ah.vertical):{box:null,occluded:!0,offscreen:null}}),wn&&(Ft=wn.placeable,vr=wn.offscreen);const pi=Ii(wn&&wn.placeable);if(!Ft&&this.prevPlacement){const Ot=this.prevPlacement.variableOffsets[Ge.crossTileID];Ot&&(this.variableOffsets[Ge.crossTileID]=Ot,this.markUsedJustification(d,Ot.anchor,Ge,pi))}}}if(Rr=wn,Ft=Rr&&Rr.placeable,vr=Rr&&Rr.offscreen,Ge.useRuntimeCollisionCircles){const Ii=d.text.placedSymbolArray.get(Ge.centerJustifiedTextSymbolIndex),Pi=u.ai(d.textSizeData,Q,Ii),os=m.get("text-padding");xr=this.collisionIndex.placeCollisionCircles(K,Ii,d.lineVertexArray,d.glyphOffsetArray,Pi,C,I,M,z,h,De,ie.predicate,Ge.collisionCircleDiameter,os,w,it),xr.circles.length&&xr.collisionDetected&&!h&&u.w("Collisions detected, but collision boxes are not shown"),Ft=he||xr.circles.length>0&&!xr.collisionDetected,vr=vr&&xr.offscreen}if(Ke.iconFeatureIndex&&(Ic=Ke.iconFeatureIndex),Ke.iconBox){const Ii=Pi=>this.collisionIndex.placeCollisionBox(Pi,fe,$,C,I,De,Me,T,ie.predicate,it,Ze&&Zi?Zi:void 0);Zr&&Zr.placeable&&Ke.verticalIconBox?(Dr=Ii(Ke.verticalIconBox),bn=Dr.placeable):(Dr=Ii(Ke.iconBox),bn=Dr.placeable),vr=vr&&Dr.offscreen}const Ei=oe||Ge.numHorizontalGlyphVertices===0&&Ge.numVerticalGlyphVertices===0,Pc=le||Ge.numIconVertices===0;Ei||Pc?Pc?Ei||(bn=bn&&Ft):Ft=bn&&Ft:bn=Ft=bn&&Ft;const zh=bn&&Dr.placeable;if(Ft&&Rr.placeable&&this.collisionIndex.insertCollisionBox(Rr.box,K,m.get("text-ignore-placement"),d.bucketInstanceId,Zr&&Zr.placeable&&Sa?Sa:_o,ie.ID),zh&&this.collisionIndex.insertCollisionBox(Dr.box,fe,m.get("icon-ignore-placement"),d.bucketInstanceId,Ic,ie.ID),xr&&Ft&&this.collisionIndex.insertCollisionCircles(xr.circles,K,m.get("text-ignore-placement"),d.bucketInstanceId,_o,ie.ID),h&&this.storeCollisionData(d.bucketInstanceId,xt,Ke,Rr,Dr,xr),Ge.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(d.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Ge.crossTileID]=new zt(Ft||Ue,bn||je,vr||d.justReloaded),a[Ge.crossTileID]=!0};if(Ye){if(n.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Ge=d.getSortedSymbolIndexes(this.transform.angle);for(let Ke=Ge.length-1;Ke>=0;--Ke){const xt=Ge[Ke];St(d.symbolInstances.get(xt),d.collisionArrays[xt],xt)}}else for(let Ge=n.symbolInstanceStart;Ge<n.symbolInstanceEnd;Ge++)St(d.symbolInstances.get(Ge),d.collisionArrays[Ge],Ge);if(h&&d.bucketInstanceId in this.collisionCircleArrays){const Ge=this.collisionCircleArrays[d.bucketInstanceId];u.as(Ge.invProjMatrix,C),Ge.viewportMatrix=this.collisionIndex.getViewportMatrix()}d.justReloaded=!1}storeCollisionData(n,a,h,d,m,w){if(h.textBox||h.iconBox){let T,C;this.collisionBoxArrays.has(n)?T=this.collisionBoxArrays.get(n):(T=new Map,this.collisionBoxArrays.set(n,T)),T.has(a)?C=T.get(a):(C={text:null,icon:null},T.set(a,C)),h.textBox&&(C.text=d.box),h.iconBox&&(C.icon=m.box)}if(w){let T=this.collisionCircleArrays[n];T===void 0&&(T=this.collisionCircleArrays[n]=new en);for(let C=0;C<w.circles.length;C+=4)T.circles.push(w.circles[C+0]),T.circles.push(w.circles[C+1]),T.circles.push(w.circles[C+2]),T.circles.push(w.collisionDetected?1:0)}}markUsedJustification(n,a,h,d){let m;m=d===u.ah.vertical?h.verticalPlacedTextSymbolIndex:{left:h.leftJustifiedTextSymbolIndex,center:h.centerJustifiedTextSymbolIndex,right:h.rightJustifiedTextSymbolIndex}[u.at(a)];const w=[h.leftJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.rightJustifiedTextSymbolIndex,h.verticalPlacedTextSymbolIndex];for(const T of w)T>=0&&(n.text.placedSymbolArray.get(T).crossTileID=m>=0&&T!==m?0:h.crossTileID)}markUsedOrientation(n,a,h){const d=a===u.ah.horizontal||a===u.ah.horizontalOnly?a:0,m=a===u.ah.vertical?a:0,w=[h.leftJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.rightJustifiedTextSymbolIndex];for(const T of w)n.text.placedSymbolArray.get(T).placedOrientation=d;h.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(h.verticalPlacedTextSymbolIndex).placedOrientation=m)}commit(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;const a=this.prevPlacement;let h=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;const d=a?a.symbolFadeChange(n):1,m=a?a.opacities:{},w=a?a.variableOffsets:{},T=a?a.placedOrientations:{};for(const C in this.placements){const I=this.placements[C],M=m[C];M?(this.opacities[C]=new Mn(M,d,I.text,I.icon),h=h||I.text!==M.text.placed||I.icon!==M.icon.placed):(this.opacities[C]=new Mn(null,d,I.text,I.icon,I.skipFade),h=h||I.text||I.icon)}for(const C in m){const I=m[C];if(!this.opacities[C]){const M=new Mn(I,d,!1,!1);M.isHidden()||(this.opacities[C]=M,h=h||I.text.placed||I.icon.placed)}}for(const C in w)this.variableOffsets[C]||!this.opacities[C]||this.opacities[C].isHidden()||(this.variableOffsets[C]=w[C]);for(const C in T)this.placedOrientations[C]||!this.opacities[C]||this.opacities[C].isHidden()||(this.placedOrientations[C]=T[C]);if(a&&a.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");h?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:n)}updateLayerOpacities(n,a){const h={};for(const d of a){const m=d.getBucket(n);m&&d.latestFeatureIndex&&n.id===m.layerIds[0]&&this.updateBucketOpacities(m,d.tileID,h,d.collisionBoxArray)}}updateBucketOpacities(n,a,h,d){n.hasTextData()&&(n.text.opacityVertexArray.clear(),n.text.hasVisibleVertices=!1),n.hasIconData()&&(n.icon.opacityVertexArray.clear(),n.icon.hasVisibleVertices=!1),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();const m=n.layers[0],w=m.layout,T=new Mn(null,0,!1,!1,!0),C=w.get("text-allow-overlap"),I=w.get("icon-allow-overlap"),M=m._unevaluatedLayout.hasValue("text-variable-anchor")||m._unevaluatedLayout.hasValue("text-variable-anchor-offset"),z=w.get("text-rotation-alignment")==="map",$=w.get("text-pitch-alignment")==="map",G=w.get("icon-text-fit")!=="none",H=new Mn(null,0,C&&(I||!n.hasIconData()||w.get("icon-optional")),I&&(C||!n.hasTextData()||w.get("text-optional")),!0);!n.collisionArrays&&d&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(d);const Q=(oe,le,K)=>{for(let he=0;he<le/4;he++)oe.opacityVertexArray.emplaceBack(K);oe.hasVisibleVertices=oe.hasVisibleVertices||K!==na},ie=this.collisionBoxArrays.get(n.bucketInstanceId);for(let oe=0;oe<n.symbolInstances.length;oe++){const le=n.symbolInstances.get(oe),{numHorizontalGlyphVertices:K,numVerticalGlyphVertices:he,crossTileID:fe}=le;let ve=this.opacities[fe];h[fe]?ve=T:ve||(ve=H,this.opacities[fe]=ve),h[fe]=!0;const Me=le.numIconVertices>0,De=this.placedOrientations[le.crossTileID],Ze=De===u.ah.vertical,Ye=De===u.ah.horizontal||De===u.ah.horizontalOnly;if(K>0||he>0){const je=ui(ve.text);Q(n.text,K,Ze?na:je),Q(n.text,he,Ye?na:je);const it=ve.text.isHidden();[le.rightJustifiedTextSymbolIndex,le.centerJustifiedTextSymbolIndex,le.leftJustifiedTextSymbolIndex].forEach(Ke=>{Ke>=0&&(n.text.placedSymbolArray.get(Ke).hidden=it||Ze?1:0)}),le.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(le.verticalPlacedTextSymbolIndex).hidden=it||Ye?1:0);const St=this.variableOffsets[le.crossTileID];St&&this.markUsedJustification(n,St.anchor,le,De);const Ge=this.placedOrientations[le.crossTileID];Ge&&(this.markUsedJustification(n,"left",le,Ge),this.markUsedOrientation(n,Ge,le))}if(Me){const je=ui(ve.icon),it=!(G&&le.verticalPlacedIconSymbolIndex&&Ze);le.placedIconSymbolIndex>=0&&(Q(n.icon,le.numIconVertices,it?je:na),n.icon.placedSymbolArray.get(le.placedIconSymbolIndex).hidden=ve.icon.isHidden()),le.verticalPlacedIconSymbolIndex>=0&&(Q(n.icon,le.numVerticalIconVertices,it?na:je),n.icon.placedSymbolArray.get(le.verticalPlacedIconSymbolIndex).hidden=ve.icon.isHidden())}const Ue=ie&&ie.has(oe)?ie.get(oe):{text:null,icon:null};if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){const je=n.collisionArrays[oe];if(je){let it=new u.P(0,0);if(je.textBox||je.verticalTextBox){let St=!0;if(M){const Ge=this.variableOffsets[fe];Ge?(it=hr(Ge.anchor,Ge.width,Ge.height,Ge.textOffset,Ge.textBoxScale),z&&it._rotate($?this.transform.angle:-this.transform.angle)):St=!1}if(je.textBox||je.verticalTextBox){let Ge;je.textBox&&(Ge=Ze),je.verticalTextBox&&(Ge=Ye),ta(n.textCollisionBox.collisionVertexArray,ve.text.placed,!St||Ge,Ue.text,it.x,it.y)}}if(je.iconBox||je.verticalIconBox){const St=!!(!Ye&&je.verticalIconBox);let Ge;je.iconBox&&(Ge=St),je.verticalIconBox&&(Ge=!St),ta(n.iconCollisionBox.collisionVertexArray,ve.icon.placed,Ge,Ue.icon,G?it.x:0,G?it.y:0)}}}}if(n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.text.opacityVertexArray.length!==n.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${n.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${n.text.layoutVertexArray.length}) / 4`);if(n.icon.opacityVertexArray.length!==n.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${n.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${n.icon.layoutVertexArray.length}) / 4`);if(n.bucketInstanceId in this.collisionCircleArrays){const oe=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=oe.invProjMatrix,n.placementViewportMatrix=oe.viewportMatrix,n.collisionCircleArray=oe.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}}symbolFadeChange(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(n){return Math.max(0,(this.transform.zoom-n)/1.5)}hasTransitions(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(n,a){const h=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*h>n}setStale(){this.stale=!0}}function ta(g,n,a,h,d,m){h&&h.length!==0||(h=[0,0,0,0]);const w=h[0]-Et,T=h[1]-Et,C=h[2]-Et,I=h[3]-Et;g.emplaceBack(n?1:0,a?1:0,d||0,m||0,w,T),g.emplaceBack(n?1:0,a?1:0,d||0,m||0,C,T),g.emplaceBack(n?1:0,a?1:0,d||0,m||0,C,I),g.emplaceBack(n?1:0,a?1:0,d||0,m||0,w,I)}const tn=Math.pow(2,25),Vu=Math.pow(2,24),Gu=Math.pow(2,17),li=Math.pow(2,16),ci=Math.pow(2,9),Og=Math.pow(2,8),Si=Math.pow(2,1);function ui(g){if(g.opacity===0&&!g.placed)return 0;if(g.opacity===1&&g.placed)return 4294967295;const n=g.placed?1:0,a=Math.floor(127*g.opacity);return a*tn+n*Vu+a*Gu+n*li+a*ci+n*Og+a*Si+n}const na=0;function Cs(){return{isOccluded:(g,n,a)=>!1,getPitchedTextCorrection:(g,n,a)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(g,n,a,h){throw new Error("Not implemented.")},translatePosition:(g,n,a,h)=>function(d,m,w,T,C=!1){if(!w[0]&&!w[1])return[0,0];const I=C?T==="map"?d.angle:0:T==="viewport"?-d.angle:0;if(I){const M=Math.sin(I),z=Math.cos(I);w=[w[0]*z-w[1]*M,w[0]*M+w[1]*z]}return[C?w[0]:Dt(m,w[0],d.zoom),C?w[1]:Dt(m,w[1],d.zoom)]}(g,n,a,h),getCircleRadiusCorrection:g=>1}}class Zn{constructor(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&!n.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(n,a,h,d,m){const w=this._bucketParts;for(;this._currentTileIndex<n.length;)if(a.getBucketParts(w,d,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,m())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,w.sort((T,C)=>T.sortKey-C.sortKey));this._currentPartIndex<w.length;)if(a.placeLayerBucketPart(w[this._currentPartIndex],this._seenCrossTileIDs,h),this._currentPartIndex++,m())return!0;return!1}}class nl{constructor(n,a,h,d,m,w,T,C){this.placement=new Lr(n,Cs(),a,w,T,C),this._currentPlacementIndex=h.length-1,this._forceFullPlacement=d,this._showCollisionBoxes=m,this._done=!1}isDone(){return this._done}continuePlacement(n,a,h){const d=N.now(),m=()=>!this._forceFullPlacement&&N.now()-d>2;for(;this._currentPlacementIndex>=0;){const w=a[n[this._currentPlacementIndex]],T=this.placement.collisionIndex.transform.zoom;if(w.type==="symbol"&&(!w.minzoom||w.minzoom<=T)&&(!w.maxzoom||w.maxzoom>T)){if(this._inProgressLayer||(this._inProgressLayer=new Zn(w)),this._inProgressLayer.continuePlacement(h[w.source],this.placement,this._showCollisionBoxes,w,m))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(n){return this.placement.commit(n),this.placement}}const Ui=512/u.X/2;class jn{constructor(n,a,h){this.tileID=n,this.bucketInstanceId=h,this._symbolsByKey={};const d=new Map;for(let m=0;m<a.length;m++){const w=a.get(m),T=w.key,C=d.get(T);C?C.push(w):d.set(T,[w])}for(const[m,w]of d){const T={positions:w.map(C=>({x:Math.floor(C.anchorX*Ui),y:Math.floor(C.anchorY*Ui)})),crossTileIDs:w.map(C=>C.crossTileID)};if(T.positions.length>128){const C=new u.av(T.positions.length,16,Uint16Array);for(const{x:I,y:M}of T.positions)C.add(I,M);C.finish(),delete T.positions,T.index=C}this._symbolsByKey[m]=T}}getScaledCoordinates(n,a){const{x:h,y:d,z:m}=this.tileID.canonical,{x:w,y:T,z:C}=a.canonical,I=Ui/Math.pow(2,C-m),M=(T*u.X+n.anchorY)*I,z=d*u.X*Ui;return{x:Math.floor((w*u.X+n.anchorX)*I-h*u.X*Ui),y:Math.floor(M-z)}}findMatches(n,a,h){const d=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z);for(let m=0;m<n.length;m++){const w=n.get(m);if(w.crossTileID)continue;const T=this._symbolsByKey[w.key];if(!T)continue;const C=this.getScaledCoordinates(w,a);if(T.index){const I=T.index.range(C.x-d,C.y-d,C.x+d,C.y+d).sort();for(const M of I){const z=T.crossTileIDs[M];if(!h[z]){h[z]=!0,w.crossTileID=z;break}}}else if(T.positions)for(let I=0;I<T.positions.length;I++){const M=T.positions[I],z=T.crossTileIDs[I];if(Math.abs(M.x-C.x)<=d&&Math.abs(M.y-C.y)<=d&&!h[z]){h[z]=!0,w.crossTileID=z;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:n})=>n)}}class Yl{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Vi{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(n){const a=Math.round((n-this.lng)/360);if(a!==0)for(const h in this.indexes){const d=this.indexes[h],m={};for(const w in d){const T=d[w];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+a),m[T.tileID.key]=T}this.indexes[h]=m}this.lng=n}addBucket(n,a,h){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(let m=0;m<a.symbolInstances.length;m++)a.symbolInstances.get(m).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});const d=this.usedCrossTileIDs[n.overscaledZ];for(const m in this.indexes){const w=this.indexes[m];if(Number(m)>n.overscaledZ)for(const T in w){const C=w[T];C.tileID.isChildOf(n)&&C.findMatches(a.symbolInstances,n,d)}else{const T=w[n.scaledTo(Number(m)).key];T&&T.findMatches(a.symbolInstances,n,d)}}for(let m=0;m<a.symbolInstances.length;m++){const w=a.symbolInstances.get(m);w.crossTileID||(w.crossTileID=h.generate(),d[w.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new jn(n,a.symbolInstances,a.bucketInstanceId),!0}removeBucketCrossTileIDs(n,a){for(const h of a.getCrossTileIDsLists())for(const d of h)delete this.usedCrossTileIDs[n][d]}removeStaleBuckets(n){let a=!1;for(const h in this.indexes){const d=this.indexes[h];for(const m in d)n[d[m].bucketInstanceId]||(this.removeBucketCrossTileIDs(h,d[m]),delete d[m],a=!0)}return a}}class qu{constructor(){this.layerIndexes={},this.crossTileIDs=new Yl,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(n,a,h){let d=this.layerIndexes[n.id];d===void 0&&(d=this.layerIndexes[n.id]=new Vi);let m=!1;const w={};d.handleWrapJump(h);for(const T of a){const C=T.getBucket(n);C&&n.id===C.layerIds[0]&&(C.bucketInstanceId||(C.bucketInstanceId=++this.maxBucketInstanceId),d.addBucket(T.tileID,C,this.crossTileIDs)&&(m=!0),w[C.bucketInstanceId]=!0)}return d.removeStaleBuckets(w)&&(m=!0),m}pruneUnusedLayers(n){const a={};n.forEach(h=>{a[h]=!0});for(const h in this.layerIndexes)a[h]||delete this.layerIndexes[h]}}const Gi=(g,n)=>u.t(g,n&&n.filter(a=>a.identifier!=="source.canvas")),Ng=u.aw();class Jl extends u.E{constructor(n,a={}){super(),this._rtlPluginLoaded=()=>{for(const h in this.sourceCaches){const d=this.sourceCaches[h].getSource().type;d!=="vector"&&d!=="geojson"||this.sourceCaches[h].reload()}},this.map=n,this.dispatcher=new si($n(),n._getMapId()),this.dispatcher.registerMessageHandler("GG",(h,d)=>this.getGlyphs(h,d)),this.dispatcher.registerMessageHandler("GI",(h,d)=>this.getImages(h,d)),this.imageManager=new dt,this.imageManager.setEventedParent(this),this.glyphManager=new Tt(n._requestManager,a.localIdeographFontFamily),this.lineAtlas=new gr(256,512),this.crossTileSymbolIndex=new qu,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new u.ax,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",u.ay()),wi().on(Fe,this._rtlPluginLoaded),this.on("data",h=>{if(h.dataType!=="source"||h.sourceDataType!=="metadata")return;const d=this.sourceCaches[h.sourceId];if(!d)return;const m=d.getSource();if(m&&m.vectorLayerIds)for(const w in this._layers){const T=this._layers[w];T.source===m.id&&this._validateLayer(T)}})}loadURL(n,a={},h){this.fire(new u.k("dataloading",{dataType:"style"})),a.validate=typeof a.validate!="boolean"||a.validate;const d=this.map._requestManager.transformRequest(n,"Style");this._loadStyleRequest=new AbortController;const m=this._loadStyleRequest;u.h(d,this._loadStyleRequest).then(w=>{this._loadStyleRequest=null,this._load(w.data,a,h)}).catch(w=>{this._loadStyleRequest=null,w&&!m.signal.aborted&&this.fire(new u.j(w))})}loadJSON(n,a={},h){this.fire(new u.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,N.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,a.validate=a.validate!==!1,this._load(n,a,h)}).catch(()=>{})}loadEmpty(){this.fire(new u.k("dataloading",{dataType:"style"})),this._load(Ng,{validate:!1})}_load(n,a,h){var d;const m=a.transformStyle?a.transformStyle(h,n):n;if(!a.validate||!Gi(this,u.u(m))){this._loaded=!0,this.stylesheet=m;for(const w in m.sources)this.addSource(w,m.sources[w],{validate:!1});m.sprite?this._loadSprite(m.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(m.glyphs),this._createLayers(),this.light=new lt(this.stylesheet.light),this.sky=new Nt(this.stylesheet.sky),this.map.setTerrain((d=this.stylesheet.terrain)!==null&&d!==void 0?d:null),this.fire(new u.k("data",{dataType:"style"})),this.fire(new u.k("style.load"))}}_createLayers(){const n=u.az(this.stylesheet.layers);this.dispatcher.broadcast("SL",n),this._order=n.map(a=>a.id),this._layers={},this._serializedLayers=null;for(const a of n){const h=u.aA(a);h.setEventedParent(this,{layer:{id:a.id}}),this._layers[a.id]=h}}_loadSprite(n,a=!1,h=void 0){let d;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(m,w,T,C){return u._(this,void 0,void 0,function*(){const I=tt(m),M=T>1?"@2x":"",z={},$={};for(const{id:G,url:H}of I){const Q=w.transformRequest(Oe(H,M,".json"),"SpriteJSON");z[G]=u.h(Q,C);const ie=w.transformRequest(Oe(H,M,".png"),"SpriteImage");$[G]=W.getImage(ie,C)}return yield Promise.all([...Object.values(z),...Object.values($)]),function(G,H){return u._(this,void 0,void 0,function*(){const Q={};for(const ie in G){Q[ie]={};const oe=N.getImageCanvasContext((yield H[ie]).data),le=(yield G[ie]).data;for(const K in le){const{width:he,height:fe,x:ve,y:Me,sdf:De,pixelRatio:Ze,stretchX:Ye,stretchY:Ue,content:je,textFitWidth:it,textFitHeight:St}=le[K];Q[ie][K]={data:null,pixelRatio:Ze,sdf:De,stretchX:Ye,stretchY:Ue,content:je,textFitWidth:it,textFitHeight:St,spriteData:{width:he,height:fe,x:ve,y:Me,context:oe}}}}return Q})}(z,$)})}(n,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(m=>{if(this._spriteRequest=null,m)for(const w in m){this._spritesImagesIds[w]=[];const T=this._spritesImagesIds[w]?this._spritesImagesIds[w].filter(C=>!(C in m)):[];for(const C of T)this.imageManager.removeImage(C),this._changedImages[C]=!0;for(const C in m[w]){const I=w==="default"?C:`${w}:${C}`;this._spritesImagesIds[w].push(I),I in this.imageManager.images?this.imageManager.updateImage(I,m[w][C],!1):this.imageManager.addImage(I,m[w][C]),a&&(this._changedImages[I]=!0)}}}).catch(m=>{this._spriteRequest=null,d=m,this.fire(new u.j(d))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),a&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new u.k("data",{dataType:"style"})),h&&h(d)})}_unloadSprite(){for(const n of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(n),this._changedImages[n]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new u.k("data",{dataType:"style"}))}_validateLayer(n){const a=this.sourceCaches[n.source];if(!a)return;const h=n.sourceLayer;if(!h)return;const d=a.getSource();(d.type==="geojson"||d.vectorLayerIds&&d.vectorLayerIds.indexOf(h)===-1)&&this.fire(new u.j(new Error(`Source layer "${h}" does not exist on source "${d.id}" as specified by style layer "${n.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const n in this.sourceCaches)if(!this.sourceCaches[n].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(n,a=!1){const h=this._serializedAllLayers();if(!n||n.length===0)return Object.values(a?u.aB(h):h);const d=[];for(const m of n)if(h[m]){const w=a?u.aB(h[m]):h[m];d.push(w)}return d}_serializedAllLayers(){let n=this._serializedLayers;if(n)return n;n=this._serializedLayers={};const a=Object.keys(this._layers);for(const h of a){const d=this._layers[h];d.type!=="custom"&&(n[h]=d.serialize())}return n}hasTransitions(){if(this.light&&this.light.hasTransition()||this.sky&&this.sky.hasTransition())return!0;for(const n in this.sourceCaches)if(this.sourceCaches[n].hasTransition())return!0;for(const n in this._layers)if(this._layers[n].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(n){if(!this._loaded)return;const a=this._changed;if(a){const d=Object.keys(this._updatedLayers),m=Object.keys(this._removedLayers);(d.length||m.length)&&this._updateWorkerLayers(d,m);for(const w in this._updatedSources){const T=this._updatedSources[w];if(T==="reload")this._reloadSource(w);else{if(T!=="clear")throw new Error(`Invalid action ${T}`);this._clearSource(w)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const w in this._updatedPaintProps)this._layers[w].updateTransitions(n);this.light.updateTransitions(n),this.sky.updateTransitions(n),this._resetUpdates()}const h={};for(const d in this.sourceCaches){const m=this.sourceCaches[d];h[d]=m.used,m.used=!1}for(const d of this._order){const m=this._layers[d];m.recalculate(n,this._availableImages),!m.isHidden(n.zoom)&&m.source&&(this.sourceCaches[m.source].used=!0)}for(const d in h){const m=this.sourceCaches[d];!!h[d]!=!!m.used&&m.fire(new u.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:d}))}this.light.recalculate(n),this.sky.recalculate(n),this.z=n.zoom,a&&this.fire(new u.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const n=Object.keys(this._changedImages);if(n.length){for(const a in this.sourceCaches)this.sourceCaches[a].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const n in this.sourceCaches)this.sourceCaches[n].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(n,a){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(n,!1),removedIds:a})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(n,a={}){var h;this._checkLoaded();const d=this.serialize();if(n=a.transformStyle?a.transformStyle(d,n):n,((h=a.validate)===null||h===void 0||h)&&Gi(this,u.u(n)))return!1;(n=u.aB(n)).layers=u.az(n.layers);const m=u.aC(d,n),w=this._getOperationsToPerform(m);if(w.unimplemented.length>0)throw new Error(`Unimplemented: ${w.unimplemented.join(", ")}.`);if(w.operations.length===0)return!1;for(const T of w.operations)T();return this.stylesheet=n,this._serializedLayers=null,!0}_getOperationsToPerform(n){const a=[],h=[];for(const d of n)switch(d.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":a.push(()=>this.addLayer.apply(this,d.args));break;case"removeLayer":a.push(()=>this.removeLayer.apply(this,d.args));break;case"setPaintProperty":a.push(()=>this.setPaintProperty.apply(this,d.args));break;case"setLayoutProperty":a.push(()=>this.setLayoutProperty.apply(this,d.args));break;case"setFilter":a.push(()=>this.setFilter.apply(this,d.args));break;case"addSource":a.push(()=>this.addSource.apply(this,d.args));break;case"removeSource":a.push(()=>this.removeSource.apply(this,d.args));break;case"setLayerZoomRange":a.push(()=>this.setLayerZoomRange.apply(this,d.args));break;case"setLight":a.push(()=>this.setLight.apply(this,d.args));break;case"setGeoJSONSourceData":a.push(()=>this.setGeoJSONSourceData.apply(this,d.args));break;case"setGlyphs":a.push(()=>this.setGlyphs.apply(this,d.args));break;case"setSprite":a.push(()=>this.setSprite.apply(this,d.args));break;case"setSky":a.push(()=>this.setSky.apply(this,d.args));break;case"setTerrain":a.push(()=>this.map.setTerrain.apply(this,d.args));break;case"setTransition":a.push(()=>{});break;default:h.push(d.command)}return{operations:a,unimplemented:h}}addImage(n,a){if(this.getImage(n))return this.fire(new u.j(new Error(`An image named "${n}" already exists.`)));this.imageManager.addImage(n,a),this._afterImageUpdated(n)}updateImage(n,a){this.imageManager.updateImage(n,a)}getImage(n){return this.imageManager.getImage(n)}removeImage(n){if(!this.getImage(n))return this.fire(new u.j(new Error(`An image named "${n}" does not exist.`)));this.imageManager.removeImage(n),this._afterImageUpdated(n)}_afterImageUpdated(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new u.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(n,a,h={}){if(this._checkLoaded(),this.sourceCaches[n]!==void 0)throw new Error(`Source "${n}" already exists.`);if(!a.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(a).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(a.type)>=0&&this._validate(u.u.source,`sources.${n}`,a,null,h))return;this.map&&this.map._collectResourceTiming&&(a.collectResourceTiming=!0);const d=this.sourceCaches[n]=new _t(n,a,this.dispatcher);d.style=this,d.setEventedParent(this,()=>({isSourceLoaded:d.loaded(),source:d.serialize(),sourceId:n})),d.onAdd(this.map),this._changed=!0}removeSource(n){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error("There is no source with this ID");for(const h in this._layers)if(this._layers[h].source===n)return this.fire(new u.j(new Error(`Source "${n}" cannot be removed while layer "${h}" is using it.`)));const a=this.sourceCaches[n];delete this.sourceCaches[n],delete this._updatedSources[n],a.fire(new u.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:n})),a.setEventedParent(null),a.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(n,a){if(this._checkLoaded(),this.sourceCaches[n]===void 0)throw new Error(`There is no source with this ID=${n}`);const h=this.sourceCaches[n].getSource();if(h.type!=="geojson")throw new Error(`geojsonSource.type is ${h.type}, which is !== 'geojson`);h.setData(a),this._changed=!0}getSource(n){return this.sourceCaches[n]&&this.sourceCaches[n].getSource()}addLayer(n,a,h={}){this._checkLoaded();const d=n.id;if(this.getLayer(d))return void this.fire(new u.j(new Error(`Layer "${d}" already exists on this map.`)));let m;if(n.type==="custom"){if(Gi(this,u.aD(n)))return;m=u.aA(n)}else{if("source"in n&&typeof n.source=="object"&&(this.addSource(d,n.source),n=u.aB(n),n=u.e(n,{source:d})),this._validate(u.u.layer,`layers.${d}`,n,{arrayIndex:-1},h))return;m=u.aA(n),this._validateLayer(m),m.setEventedParent(this,{layer:{id:d}})}const w=a?this._order.indexOf(a):this._order.length;if(a&&w===-1)this.fire(new u.j(new Error(`Cannot add layer "${d}" before non-existing layer "${a}".`)));else{if(this._order.splice(w,0,d),this._layerOrderChanged=!0,this._layers[d]=m,this._removedLayers[d]&&m.source&&m.type!=="custom"){const T=this._removedLayers[d];delete this._removedLayers[d],T.type!==m.type?this._updatedSources[m.source]="clear":(this._updatedSources[m.source]="reload",this.sourceCaches[m.source].pause())}this._updateLayer(m),m.onAdd&&m.onAdd(this.map)}}moveLayer(n,a){if(this._checkLoaded(),this._changed=!0,!this._layers[n])return void this.fire(new u.j(new Error(`The layer '${n}' does not exist in the map's style and cannot be moved.`)));if(n===a)return;const h=this._order.indexOf(n);this._order.splice(h,1);const d=a?this._order.indexOf(a):this._order.length;a&&d===-1?this.fire(new u.j(new Error(`Cannot move layer "${n}" before non-existing layer "${a}".`))):(this._order.splice(d,0,n),this._layerOrderChanged=!0)}removeLayer(n){this._checkLoaded();const a=this._layers[n];if(!a)return void this.fire(new u.j(new Error(`Cannot remove non-existing layer "${n}".`)));a.setEventedParent(null);const h=this._order.indexOf(n);this._order.splice(h,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=a,delete this._layers[n],this._serializedLayers&&delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],a.onRemove&&a.onRemove(this.map)}getLayer(n){return this._layers[n]}getLayersOrder(){return[...this._order]}hasLayer(n){return n in this._layers}setLayerZoomRange(n,a,h){this._checkLoaded();const d=this.getLayer(n);d?d.minzoom===a&&d.maxzoom===h||(a!=null&&(d.minzoom=a),h!=null&&(d.maxzoom=h),this._updateLayer(d)):this.fire(new u.j(new Error(`Cannot set the zoom range of non-existing layer "${n}".`)))}setFilter(n,a,h={}){this._checkLoaded();const d=this.getLayer(n);if(d){if(!u.aE(d.filter,a))return a==null?(d.filter=void 0,void this._updateLayer(d)):void(this._validate(u.u.filter,`layers.${d.id}.filter`,a,null,h)||(d.filter=u.aB(a),this._updateLayer(d)))}else this.fire(new u.j(new Error(`Cannot filter non-existing layer "${n}".`)))}getFilter(n){return u.aB(this.getLayer(n).filter)}setLayoutProperty(n,a,h,d={}){this._checkLoaded();const m=this.getLayer(n);m?u.aE(m.getLayoutProperty(a),h)||(m.setLayoutProperty(a,h,d),this._updateLayer(m)):this.fire(new u.j(new Error(`Cannot style non-existing layer "${n}".`)))}getLayoutProperty(n,a){const h=this.getLayer(n);if(h)return h.getLayoutProperty(a);this.fire(new u.j(new Error(`Cannot get style of non-existing layer "${n}".`)))}setPaintProperty(n,a,h,d={}){this._checkLoaded();const m=this.getLayer(n);m?u.aE(m.getPaintProperty(a),h)||(m.setPaintProperty(a,h,d)&&this._updateLayer(m),this._changed=!0,this._updatedPaintProps[n]=!0,this._serializedLayers=null):this.fire(new u.j(new Error(`Cannot style non-existing layer "${n}".`)))}getPaintProperty(n,a){return this.getLayer(n).getPaintProperty(a)}setFeatureState(n,a){this._checkLoaded();const h=n.source,d=n.sourceLayer,m=this.sourceCaches[h];if(m===void 0)return void this.fire(new u.j(new Error(`The source '${h}' does not exist in the map's style.`)));const w=m.getSource().type;w==="geojson"&&d?this.fire(new u.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):w!=="vector"||d?(n.id===void 0&&this.fire(new u.j(new Error("The feature id parameter must be provided."))),m.setFeatureState(d,n.id,a)):this.fire(new u.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(n,a){this._checkLoaded();const h=n.source,d=this.sourceCaches[h];if(d===void 0)return void this.fire(new u.j(new Error(`The source '${h}' does not exist in the map's style.`)));const m=d.getSource().type,w=m==="vector"?n.sourceLayer:void 0;m!=="vector"||w?a&&typeof n.id!="string"&&typeof n.id!="number"?this.fire(new u.j(new Error("A feature id is required to remove its specific state property."))):d.removeFeatureState(w,n.id,a):this.fire(new u.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(n){this._checkLoaded();const a=n.source,h=n.sourceLayer,d=this.sourceCaches[a];if(d!==void 0)return d.getSource().type!=="vector"||h?(n.id===void 0&&this.fire(new u.j(new Error("The feature id parameter must be provided."))),d.getFeatureState(h,n.id)):void this.fire(new u.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new u.j(new Error(`The source '${a}' does not exist in the map's style.`)))}getTransition(){return u.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const n=u.aF(this.sourceCaches,m=>m.serialize()),a=this._serializeByIds(this._order,!0),h=this.map.getTerrain()||void 0,d=this.stylesheet;return u.aG({version:d.version,name:d.name,metadata:d.metadata,light:d.light,sky:d.sky,center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch,sprite:d.sprite,glyphs:d.glyphs,transition:d.transition,sources:n,layers:a,terrain:h},m=>m!==void 0)}_updateLayer(n){this._updatedLayers[n.id]=!0,n.source&&!this._updatedSources[n.source]&&this.sourceCaches[n.source].getSource().type!=="raster"&&(this._updatedSources[n.source]="reload",this.sourceCaches[n.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(n){const a=w=>this._layers[w].type==="fill-extrusion",h={},d=[];for(let w=this._order.length-1;w>=0;w--){const T=this._order[w];if(a(T)){h[T]=w;for(const C of n){const I=C[T];if(I)for(const M of I)d.push(M)}}}d.sort((w,T)=>T.intersectionZ-w.intersectionZ);const m=[];for(let w=this._order.length-1;w>=0;w--){const T=this._order[w];if(a(T))for(let C=d.length-1;C>=0;C--){const I=d[C].feature;if(h[I.layer.id]<w)break;m.push(I),d.pop()}else for(const C of n){const I=C[T];if(I)for(const M of I)m.push(M.feature)}}return m}queryRenderedFeatures(n,a,h){a&&a.filter&&this._validate(u.u.filter,"queryRenderedFeatures.filter",a.filter,null,a);const d={};if(a&&a.layers){if(!Array.isArray(a.layers))return this.fire(new u.j(new Error("parameters.layers must be an Array."))),[];for(const T of a.layers){const C=this._layers[T];if(!C)return this.fire(new u.j(new Error(`The layer '${T}' does not exist in the map's style and cannot be queried for features.`))),[];d[C.source]=!0}}const m=[];a.availableImages=this._availableImages;const w=this._serializedAllLayers();for(const T in this.sourceCaches)a.layers&&!d[T]||m.push(ur(this.sourceCaches[T],this._layers,w,n,a,h));return this.placement&&m.push(function(T,C,I,M,z,$,G){const H={},Q=$.queryRenderedSymbols(M),ie=[];for(const oe of Object.keys(Q).map(Number))ie.push(G[oe]);ie.sort(zr);for(const oe of ie){const le=oe.featureIndex.lookupSymbolFeatures(Q[oe.bucketInstanceId],C,oe.bucketIndex,oe.sourceLayerIndex,z.filter,z.layers,z.availableImages,T);for(const K in le){const he=H[K]=H[K]||[],fe=le[K];fe.sort((ve,Me)=>{const De=oe.featureSortOrder;if(De){const Ze=De.indexOf(ve.featureIndex);return De.indexOf(Me.featureIndex)-Ze}return Me.featureIndex-ve.featureIndex});for(const ve of fe)he.push(ve)}}for(const oe in H)H[oe].forEach(le=>{const K=le.feature,he=I[T[oe].source].getFeatureState(K.layer["source-layer"],K.id);K.source=K.layer.source,K.layer["source-layer"]&&(K.sourceLayer=K.layer["source-layer"]),K.state=he});return H}(this._layers,w,this.sourceCaches,n,a,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(m)}querySourceFeatures(n,a){a&&a.filter&&this._validate(u.u.filter,"querySourceFeatures.filter",a.filter,null,a);const h=this.sourceCaches[n];return h?function(d,m){const w=d.getRenderableIds().map(I=>d.getTileByID(I)),T=[],C={};for(let I=0;I<w.length;I++){const M=w[I],z=M.tileID.canonical.key;C[z]||(C[z]=!0,M.querySourceFeatures(T,m))}return T}(h,a):[]}getLight(){return this.light.getLight()}setLight(n,a={}){this._checkLoaded();const h=this.light.getLight();let d=!1;for(const w in n)if(!u.aE(n[w],h[w])){d=!0;break}if(!d)return;const m={now:N.now(),transition:u.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(n,a),this.light.updateTransitions(m)}getSky(){var n;return(n=this.stylesheet)===null||n===void 0?void 0:n.sky}setSky(n,a={}){const h=this.getSky();let d=!1;if(!n&&!h)return;if(n&&!h)d=!0;else if(!n&&h)d=!0;else for(const w in n)if(!u.aE(n[w],h[w])){d=!0;break}if(!d)return;const m={now:N.now(),transition:u.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=n,this.sky.setSky(n,a),this.sky.updateTransitions(m)}_validate(n,a,h,d,m={}){return(!m||m.validate!==!1)&&Gi(this,n.call(u.u,u.e({key:a,style:this.serialize(),value:h,styleSpec:u.v},d)))}_remove(n=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),wi().off(Fe,this._rtlPluginLoaded);for(const a in this._layers)this._layers[a].setEventedParent(null);for(const a in this.sourceCaches){const h=this.sourceCaches[a];h.setEventedParent(null),h.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),n&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(n)}_clearSource(n){this.sourceCaches[n].clearTiles()}_reloadSource(n){this.sourceCaches[n].resume(),this.sourceCaches[n].reload()}_updateSources(n){for(const a in this.sourceCaches)this.sourceCaches[a].update(n,this.map.terrain)}_generateCollisionBoxes(){for(const n in this.sourceCaches)this._reloadSource(n)}_updatePlacement(n,a,h,d,m=!1){let w=!1,T=!1;const C={};for(const I of this._order){const M=this._layers[I];if(M.type!=="symbol")continue;if(!C[M.source]){const $=this.sourceCaches[M.source];C[M.source]=$.getRenderableIds(!0).map(G=>$.getTileByID(G)).sort((G,H)=>H.tileID.overscaledZ-G.tileID.overscaledZ||(G.tileID.isLessThan(H.tileID)?-1:1))}const z=this.crossTileSymbolIndex.addLayer(M,C[M.source],n.center.lng);w=w||z}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((m=m||this._layerOrderChanged||h===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(N.now(),n.zoom))&&(this.pauseablePlacement=new nl(n,this.map.terrain,this._order,m,a,h,d,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,C),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(N.now()),T=!0),w&&this.pauseablePlacement.placement.setStale()),T||w)for(const I of this._order){const M=this._layers[I];M.type==="symbol"&&this.placement.updateLayerOpacities(M,C[M.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(N.now())}_releaseSymbolFadeTiles(){for(const n in this.sourceCaches)this.sourceCaches[n].releaseSymbolFadeTiles()}getImages(n,a){return u._(this,void 0,void 0,function*(){const h=yield this.imageManager.getImages(a.icons);this._updateTilesForChangedImages();const d=this.sourceCaches[a.source];return d&&d.setDependencies(a.tileID.key,a.type,a.icons),h})}getGlyphs(n,a){return u._(this,void 0,void 0,function*(){const h=yield this.glyphManager.getGlyphs(a.stacks),d=this.sourceCaches[a.source];return d&&d.setDependencies(a.tileID.key,a.type,[""]),h})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(n,a={}){this._checkLoaded(),n&&this._validate(u.u.glyphs,"glyphs",n,null,a)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=n,this.glyphManager.entries={},this.glyphManager.setURL(n))}addSprite(n,a,h={},d){this._checkLoaded();const m=[{id:n,url:a}],w=[...tt(this.stylesheet.sprite),...m];this._validate(u.u.sprite,"sprite",w,null,h)||(this.stylesheet.sprite=w,this._loadSprite(m,!0,d))}removeSprite(n){this._checkLoaded();const a=tt(this.stylesheet.sprite);if(a.find(h=>h.id===n)){if(this._spritesImagesIds[n])for(const h of this._spritesImagesIds[n])this.imageManager.removeImage(h),this._changedImages[h]=!0;a.splice(a.findIndex(h=>h.id===n),1),this.stylesheet.sprite=a.length>0?a:void 0,delete this._spritesImagesIds[n],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new u.k("data",{dataType:"style"}))}else this.fire(new u.j(new Error(`Sprite "${n}" doesn't exists on this map.`)))}getSprite(){return tt(this.stylesheet.sprite)}setSprite(n,a={},h){this._checkLoaded(),n&&this._validate(u.u.sprite,"sprite",n,null,a)||(this.stylesheet.sprite=n,n?this._loadSprite(n,!0,h):(this._unloadSprite(),h&&h(null)))}}var ks=u.Y([{name:"a_pos",type:"Int16",components:2}]);const rs={prelude:Ht(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Ht(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Ht(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Ht(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Ht("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Ht(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,get_elevation(floor(a_pos*0.5)),1);gl_Position=u_matrix*pos;}`),heatmapTexture:Ht(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Ht("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Ht("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Ht("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Ht(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Ht(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Ht(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Ht(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Ht(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Ht(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Ht(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Ht(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Ht(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Ht(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Ht(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Ht(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Ht(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Ht(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Ht(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Ht(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Ht("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;varying vec2 v_texture_pos;varying float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture2D(u_texture,v_texture_pos);if (v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);gl_FragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {gl_FragColor=surface_color;}}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform mat4 u_fog_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Ht("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Ht("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);}"),sky:Ht("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform float u_horizon;uniform float u_sky_horizon_blend;void main() {float y=gl_FragCoord.y;if (y > u_horizon) {float blend=y-u_horizon;if (blend < u_sky_horizon_blend) {gl_FragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {gl_FragColor=u_sky_color;}}}","attribute vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Ht(g,n){const a=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,h=n.match(/attribute ([\w]+) ([\w]+)/g),d=g.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),m=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=m?m.concat(d):d,T={};return{fragmentSource:g=g.replace(a,(C,I,M,z,$)=>(T[$]=!0,I==="define"?`
#ifndef HAS_UNIFORM_u_${$}
varying ${M} ${z} ${$};
#else
uniform ${M} ${z} u_${$};
#endif
`:`
#ifdef HAS_UNIFORM_u_${$}
    ${M} ${z} ${$} = u_${$};
#endif
`)),vertexSource:n=n.replace(a,(C,I,M,z,$)=>{const G=z==="float"?"vec2":"vec4",H=$.match(/color/)?"color":G;return T[$]?I==="define"?`
#ifndef HAS_UNIFORM_u_${$}
uniform lowp float u_${$}_t;
attribute ${M} ${G} a_${$};
varying ${M} ${z} ${$};
#else
uniform ${M} ${z} u_${$};
#endif
`:H==="vec4"?`
#ifndef HAS_UNIFORM_u_${$}
    ${$} = a_${$};
#else
    ${M} ${z} ${$} = u_${$};
#endif
`:`
#ifndef HAS_UNIFORM_u_${$}
    ${$} = unpack_mix_${H}(a_${$}, u_${$}_t);
#else
    ${M} ${z} ${$} = u_${$};
#endif
`:I==="define"?`
#ifndef HAS_UNIFORM_u_${$}
uniform lowp float u_${$}_t;
attribute ${M} ${G} a_${$};
#else
uniform ${M} ${z} u_${$};
#endif
`:H==="vec4"?`
#ifndef HAS_UNIFORM_u_${$}
    ${M} ${z} ${$} = a_${$};
#else
    ${M} ${z} ${$} = u_${$};
#endif
`:`
#ifndef HAS_UNIFORM_u_${$}
    ${M} ${z} ${$} = unpack_mix_${H}(a_${$}, u_${$}_t);
#else
    ${M} ${z} ${$} = u_${$};
#endif
`}),staticAttributes:h,staticUniforms:w}}class Hu{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(n,a,h,d,m,w,T,C,I){this.context=n;let M=this.boundPaintVertexBuffers.length!==d.length;for(let z=0;!M&&z<d.length;z++)this.boundPaintVertexBuffers[z]!==d[z]&&(M=!0);!this.vao||this.boundProgram!==a||this.boundLayoutVertexBuffer!==h||M||this.boundIndexBuffer!==m||this.boundVertexOffset!==w||this.boundDynamicVertexBuffer!==T||this.boundDynamicVertexBuffer2!==C||this.boundDynamicVertexBuffer3!==I?this.freshBind(a,h,d,m,w,T,C,I):(n.bindVertexArray.set(this.vao),T&&T.bind(),m&&m.dynamicDraw&&m.bind(),C&&C.bind(),I&&I.bind())}freshBind(n,a,h,d,m,w,T,C){const I=n.numAttributes,M=this.context,z=M.gl;this.vao&&this.destroy(),this.vao=M.createVertexArray(),M.bindVertexArray.set(this.vao),this.boundProgram=n,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=h,this.boundIndexBuffer=d,this.boundVertexOffset=m,this.boundDynamicVertexBuffer=w,this.boundDynamicVertexBuffer2=T,this.boundDynamicVertexBuffer3=C,a.enableAttributes(z,n);for(const $ of h)$.enableAttributes(z,n);w&&w.enableAttributes(z,n),T&&T.enableAttributes(z,n),C&&C.enableAttributes(z,n),a.bind(),a.setVertexAttribPointers(z,n,m);for(const $ of h)$.bind(),$.setVertexAttribPointers(z,n,m);w&&(w.bind(),w.setVertexAttribPointers(z,n,m)),d&&d.bind(),T&&(T.bind(),T.setVertexAttribPointers(z,n,m)),C&&(C.bind(),C.setVertexAttribPointers(z,n,m)),M.currentNumAttributes=I}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Zu=(g,n,a,h,d)=>({u_matrix:g,u_texture:0,u_ele_delta:n,u_fog_matrix:a,u_fog_color:h?h.properties.get("fog-color"):u.aM.white,u_fog_ground_blend:h?h.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:h?h.calculateFogBlendOpacity(d):0,u_horizon_color:h?h.properties.get("horizon-color"):u.aM.white,u_horizon_fog_blend:h?h.properties.get("horizon-fog-blend"):1});function ra(g){const n=[];for(let a=0;a<g.length;a++){if(g[a]===null)continue;const h=g[a].split(" ");n.push(h.pop())}return n}class Wu{constructor(n,a,h,d,m,w){const T=n.gl;this.program=T.createProgram();const C=ra(a.staticAttributes),I=h?h.getBinderAttributes():[],M=C.concat(I),z=rs.prelude.staticUniforms?ra(rs.prelude.staticUniforms):[],$=a.staticUniforms?ra(a.staticUniforms):[],G=h?h.getBinderUniforms():[],H=z.concat($).concat(G),Q=[];for(const ve of H)Q.indexOf(ve)<0&&Q.push(ve);const ie=h?h.defines():[];m&&ie.push("#define OVERDRAW_INSPECTOR;"),w&&ie.push("#define TERRAIN3D;");const oe=ie.concat(rs.prelude.fragmentSource,a.fragmentSource).join(`
`),le=ie.concat(rs.prelude.vertexSource,a.vertexSource).join(`
`),K=T.createShader(T.FRAGMENT_SHADER);if(T.isContextLost())return void(this.failedToCreate=!0);if(T.shaderSource(K,oe),T.compileShader(K),!T.getShaderParameter(K,T.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${T.getShaderInfoLog(K)}`);T.attachShader(this.program,K);const he=T.createShader(T.VERTEX_SHADER);if(T.isContextLost())return void(this.failedToCreate=!0);if(T.shaderSource(he,le),T.compileShader(he),!T.getShaderParameter(he,T.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${T.getShaderInfoLog(he)}`);T.attachShader(this.program,he),this.attributes={};const fe={};this.numAttributes=M.length;for(let ve=0;ve<this.numAttributes;ve++)M[ve]&&(T.bindAttribLocation(this.program,ve,M[ve]),this.attributes[M[ve]]=ve);if(T.linkProgram(this.program),!T.getProgramParameter(this.program,T.LINK_STATUS))throw new Error(`Program failed to link: ${T.getProgramInfoLog(this.program)}`);T.deleteShader(he),T.deleteShader(K);for(let ve=0;ve<Q.length;ve++){const Me=Q[ve];if(Me&&!fe[Me]){const De=T.getUniformLocation(this.program,Me);De&&(fe[Me]=De)}}this.fixedUniforms=d(n,fe),this.terrainUniforms=((ve,Me)=>({u_depth:new u.aH(ve,Me.u_depth),u_terrain:new u.aH(ve,Me.u_terrain),u_terrain_dim:new u.aI(ve,Me.u_terrain_dim),u_terrain_matrix:new u.aJ(ve,Me.u_terrain_matrix),u_terrain_unpack:new u.aK(ve,Me.u_terrain_unpack),u_terrain_exaggeration:new u.aI(ve,Me.u_terrain_exaggeration)}))(n,fe),this.binderUniforms=h?h.getUniforms(n,fe):[]}draw(n,a,h,d,m,w,T,C,I,M,z,$,G,H,Q,ie,oe,le){const K=n.gl;if(this.failedToCreate)return;if(n.program.set(this.program),n.setDepthMode(h),n.setStencilMode(d),n.setColorMode(m),n.setCullFace(w),C){n.activeTexture.set(K.TEXTURE2),K.bindTexture(K.TEXTURE_2D,C.depthTexture),n.activeTexture.set(K.TEXTURE3),K.bindTexture(K.TEXTURE_2D,C.texture);for(const fe in this.terrainUniforms)this.terrainUniforms[fe].set(C[fe])}for(const fe in this.fixedUniforms)this.fixedUniforms[fe].set(T[fe]);Q&&Q.setUniforms(n,this.binderUniforms,G,{zoom:H});let he=0;switch(a){case K.LINES:he=2;break;case K.TRIANGLES:he=3;break;case K.LINE_STRIP:he=1}for(const fe of $.get()){const ve=fe.vaos||(fe.vaos={});(ve[I]||(ve[I]=new Hu)).bind(n,this,M,Q?Q.getPaintVertexBuffers():[],z,fe.vertexOffset,ie,oe,le),K.drawElements(a,fe.primitiveLength*he,K.UNSIGNED_SHORT,fe.primitiveOffset*he*2)}}}function Ql(g,n,a){const h=1/Dt(a,1,n.transform.tileZoom),d=Math.pow(2,a.tileID.overscaledZ),m=a.tileSize*Math.pow(2,n.transform.tileZoom)/d,w=m*(a.tileID.canonical.x+a.tileID.wrap*d),T=m*a.tileID.canonical.y;return{u_image:0,u_texsize:a.imageAtlasTexture.size,u_scale:[h,g.fromScale,g.toScale],u_fade:g.t,u_pixel_coord_upper:[w>>16,T>>16],u_pixel_coord_lower:[65535&w,65535&T]}}const rl=(g,n,a,h)=>{const d=n.style.light,m=d.properties.get("position"),w=[m.x,m.y,m.z],T=function(){var I=new u.A(9);return u.A!=Float32Array&&(I[1]=0,I[2]=0,I[3]=0,I[5]=0,I[6]=0,I[7]=0),I[0]=1,I[4]=1,I[8]=1,I}();d.properties.get("anchor")==="viewport"&&function(I,M){var z=Math.sin(M),$=Math.cos(M);I[0]=$,I[1]=z,I[2]=0,I[3]=-z,I[4]=$,I[5]=0,I[6]=0,I[7]=0,I[8]=1}(T,-n.transform.angle),function(I,M,z){var $=M[0],G=M[1],H=M[2];I[0]=$*z[0]+G*z[3]+H*z[6],I[1]=$*z[1]+G*z[4]+H*z[7],I[2]=$*z[2]+G*z[5]+H*z[8]}(w,w,T);const C=d.properties.get("color");return{u_matrix:g,u_lightpos:w,u_lightintensity:d.properties.get("intensity"),u_lightcolor:[C.r,C.g,C.b],u_vertical_gradient:+a,u_opacity:h}},ec=(g,n,a,h,d,m,w)=>u.e(rl(g,n,a,h),Ql(m,n,w),{u_height_factor:-Math.pow(2,d.overscaledZ)/w.tileSize/8}),ia=g=>({u_matrix:g}),lp=(g,n,a,h)=>u.e(ia(g),Ql(a,n,h)),$g=(g,n)=>({u_matrix:g,u_world:n}),cp=(g,n,a,h,d)=>u.e(lp(g,n,a,h),{u_world:d}),jg=(g,n,a,h)=>{const d=g.transform;let m,w;if(h.paint.get("circle-pitch-alignment")==="map"){const T=Dt(a,1,d.zoom);m=!0,w=[T,T]}else m=!1,w=d.pixelsToGLUnits;return{u_camera_to_center_distance:d.cameraToCenterDistance,u_scale_with_map:+(h.paint.get("circle-pitch-scale")==="map"),u_matrix:g.translatePosMatrix(n.posMatrix,a,h.paint.get("circle-translate"),h.paint.get("circle-translate-anchor")),u_pitch_with_map:+m,u_device_pixel_ratio:g.pixelRatio,u_extrude_scale:w}},Es=(g,n,a)=>({u_matrix:g,u_inv_matrix:n,u_camera_to_center_distance:a.cameraToCenterDistance,u_viewport_size:[a.width,a.height]}),il=(g,n,a=1)=>({u_matrix:g,u_color:n,u_overlay:0,u_overlay_scale:a}),qr=g=>({u_matrix:g}),Hr=(g,n,a,h)=>({u_matrix:g,u_extrude_scale:Dt(n,1,a),u_intensity:h}),tc=(g,n,a,h)=>{const d=u.H();u.aP(d,0,g.width,g.height,0,0,1);const m=g.context.gl;return{u_matrix:d,u_world:[m.drawingBufferWidth,m.drawingBufferHeight],u_image:a,u_color_ramp:h,u_opacity:n.paint.get("heatmap-opacity")}};function nc(g,n){const a=Math.pow(2,n.canonical.z),h=n.canonical.y;return[new u.Z(0,h/a).toLngLat().lat,new u.Z(0,(h+1)/a).toLngLat().lat]}const rc=(g,n,a,h)=>{const d=g.transform;return{u_matrix:dp(g,n,a,h),u_ratio:1/Dt(n,1,d.zoom),u_device_pixel_ratio:g.pixelRatio,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},up=(g,n,a,h,d)=>u.e(rc(g,n,a,d),{u_image:0,u_image_height:h}),oa=(g,n,a,h,d)=>{const m=g.transform,w=hp(n,m);return{u_matrix:dp(g,n,a,d),u_texsize:n.imageAtlasTexture.size,u_ratio:1/Dt(n,1,m.zoom),u_device_pixel_ratio:g.pixelRatio,u_image:0,u_scale:[w,h.fromScale,h.toScale],u_fade:h.t,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}},Ug=(g,n,a,h,d,m)=>{const w=g.lineAtlas,T=hp(n,g.transform),C=a.layout.get("line-cap")==="round",I=w.getDash(h.from,C),M=w.getDash(h.to,C),z=I.width*d.fromScale,$=M.width*d.toScale;return u.e(rc(g,n,a,m),{u_patternscale_a:[T/z,-I.height/2],u_patternscale_b:[T/$,-M.height/2],u_sdfgamma:w.width/(256*Math.min(z,$)*g.pixelRatio)/2,u_image:0,u_tex_y_a:I.y,u_tex_y_b:M.y,u_mix:d.t})};function hp(g,n){return 1/Dt(g,1,n.tileZoom)}function dp(g,n,a,h){return g.translatePosMatrix(h?h.posMatrix:n.tileID.posMatrix,n,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}const Vg=(g,n,a,h,d)=>{return{u_matrix:g,u_tl_parent:n,u_scale_parent:a,u_buffer_scale:1,u_fade_t:h.mix,u_opacity:h.opacity*d.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:d.paint.get("raster-brightness-min"),u_brightness_high:d.paint.get("raster-brightness-max"),u_saturation_factor:(w=d.paint.get("raster-saturation"),w>0?1-1/(1.001-w):-w),u_contrast_factor:(m=d.paint.get("raster-contrast"),m>0?1/(1-m):1+m),u_spin_weights:Gg(d.paint.get("raster-hue-rotate"))};var m,w};function Gg(g){g*=Math.PI/180;const n=Math.sin(g),a=Math.cos(g);return[(2*a+1)/3,(-Math.sqrt(3)*n-a+1)/3,(Math.sqrt(3)*n-a+1)/3]}const pp=(g,n,a,h,d,m,w,T,C,I,M,z,$,G)=>{const H=w.transform;return{u_is_size_zoom_constant:+(g==="constant"||g==="source"),u_is_size_feature_constant:+(g==="constant"||g==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:H.cameraToCenterDistance,u_pitch:H.pitch/360*2*Math.PI,u_rotate_symbol:+a,u_aspect_ratio:H.width/H.height,u_fade_change:w.options.fadeDuration?w.symbolFadeChange:1,u_matrix:T,u_label_plane_matrix:C,u_coord_matrix:I,u_is_text:+z,u_pitch_with_map:+h,u_is_along_line:d,u_is_variable_anchor:m,u_texsize:$,u_texture:0,u_translation:M,u_pitched_scale:G}},ol=(g,n,a,h,d,m,w,T,C,I,M,z,$,G,H)=>{const Q=w.transform;return u.e(pp(g,n,a,h,d,m,w,T,C,I,M,z,$,H),{u_gamma_scale:h?Math.cos(Q._pitch)*Q.cameraToCenterDistance:1,u_device_pixel_ratio:w.pixelRatio,u_is_halo:+G})},Ku=(g,n,a,h,d,m,w,T,C,I,M,z,$,G)=>u.e(ol(g,n,a,h,d,m,w,T,C,I,M,!0,z,!0,G),{u_texsize_icon:$,u_texture_icon:1}),ic=(g,n,a)=>({u_matrix:g,u_opacity:n,u_color:a}),Xu=(g,n,a,h,d,m)=>u.e(function(w,T,C,I){const M=C.imageManager.getPattern(w.from.toString()),z=C.imageManager.getPattern(w.to.toString()),{width:$,height:G}=C.imageManager.getPixelSize(),H=Math.pow(2,I.tileID.overscaledZ),Q=I.tileSize*Math.pow(2,C.transform.tileZoom)/H,ie=Q*(I.tileID.canonical.x+I.tileID.wrap*H),oe=Q*I.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:M.tl,u_pattern_br_a:M.br,u_pattern_tl_b:z.tl,u_pattern_br_b:z.br,u_texsize:[$,G],u_mix:T.t,u_pattern_size_a:M.displaySize,u_pattern_size_b:z.displaySize,u_scale_a:T.fromScale,u_scale_b:T.toScale,u_tile_units_to_pixels:1/Dt(I,1,C.transform.tileZoom),u_pixel_coord_upper:[ie>>16,oe>>16],u_pixel_coord_lower:[65535&ie,65535&oe]}}(h,m,a,d),{u_matrix:g,u_opacity:n}),Yu={fillExtrusion:(g,n)=>({u_matrix:new u.aJ(g,n.u_matrix),u_lightpos:new u.aN(g,n.u_lightpos),u_lightintensity:new u.aI(g,n.u_lightintensity),u_lightcolor:new u.aN(g,n.u_lightcolor),u_vertical_gradient:new u.aI(g,n.u_vertical_gradient),u_opacity:new u.aI(g,n.u_opacity)}),fillExtrusionPattern:(g,n)=>({u_matrix:new u.aJ(g,n.u_matrix),u_lightpos:new u.aN(g,n.u_lightpos),u_lightintensity:new u.aI(g,n.u_lightintensity),u_lightcolor:new u.aN(g,n.u_lightcolor),u_vertical_gradient:new u.aI(g,n.u_vertical_gradient),u_height_factor:new u.aI(g,n.u_height_factor),u_image:new u.aH(g,n.u_image),u_texsize:new u.aO(g,n.u_texsize),u_pixel_coord_upper:new u.aO(g,n.u_pixel_coord_upper),u_pixel_coord_lower:new u.aO(g,n.u_pixel_coord_lower),u_scale:new u.aN(g,n.u_scale),u_fade:new u.aI(g,n.u_fade),u_opacity:new u.aI(g,n.u_opacity)}),fill:(g,n)=>({u_matrix:new u.aJ(g,n.u_matrix)}),fillPattern:(g,n)=>({u_matrix:new u.aJ(g,n.u_matrix),u_image:new u.aH(g,n.u_image),u_texsize:new u.aO(g,n.u_texsize),u_pixel_coord_upper:new u.aO(g,n.u_pixel_coord_upper),u_pixel_coord_lower:new u.aO(g,n.u_pixel_coord_lower),u_scale:new u.aN(g,n.u_scale),u_fade:new u.aI(g,n.u_fade)}),fillOutline:(g,n)=>({u_matrix:new u.aJ(g,n.u_matrix),u_world:new u.aO(g,n.u_world)}),fillOutlinePattern:(g,n)=>({u_matrix:new u.aJ(g,n.u_matrix),u_world:new u.aO(g,n.u_world),u_image:new u.aH(g,n.u_image),u_texsize:new u.aO(g,n.u_texsize),u_pixel_coord_upper:new u.aO(g,n.u_pixel_coord_upper),u_pixel_coord_lower:new u.aO(g,n.u_pixel_coord_lower),u_scale:new u.aN(g,n.u_scale),u_fade:new u.aI(g,n.u_fade)}),circle:(g,n)=>({u_camera_to_center_distance:new u.aI(g,n.u_camera_to_center_distance),u_scale_with_map:new u.aH(g,n.u_scale_with_map),u_pitch_with_map:new u.aH(g,n.u_pitch_with_map),u_extrude_scale:new u.aO(g,n.u_extrude_scale),u_device_pixel_ratio:new u.aI(g,n.u_device_pixel_ratio),u_matrix:new u.aJ(g,n.u_matrix)}),collisionBox:(g,n)=>({u_matrix:new u.aJ(g,n.u_matrix),u_pixel_extrude_scale:new u.aO(g,n.u_pixel_extrude_scale)}),collisionCircle:(g,n)=>({u_matrix:new u.aJ(g,n.u_matrix),u_inv_matrix:new u.aJ(g,n.u_inv_matrix),u_camera_to_center_distance:new u.aI(g,n.u_camera_to_center_distance),u_viewport_size:new u.aO(g,n.u_viewport_size)}),debug:(g,n)=>({u_color:new u.aL(g,n.u_color),u_matrix:new u.aJ(g,n.u_matrix),u_overlay:new u.aH(g,n.u_overlay),u_overlay_scale:new u.aI(g,n.u_overlay_scale)}),clippingMask:(g,n)=>({u_matrix:new u.aJ(g,n.u_matrix)}),heatmap:(g,n)=>({u_extrude_scale:new u.aI(g,n.u_extrude_scale),u_intensity:new u.aI(g,n.u_intensity),u_matrix:new u.aJ(g,n.u_matrix)}),heatmapTexture:(g,n)=>({u_matrix:new u.aJ(g,n.u_matrix),u_world:new u.aO(g,n.u_world),u_image:new u.aH(g,n.u_image),u_color_ramp:new u.aH(g,n.u_color_ramp),u_opacity:new u.aI(g,n.u_opacity)}),hillshade:(g,n)=>({u_matrix:new u.aJ(g,n.u_matrix),u_image:new u.aH(g,n.u_image),u_latrange:new u.aO(g,n.u_latrange),u_light:new u.aO(g,n.u_light),u_shadow:new u.aL(g,n.u_shadow),u_highlight:new u.aL(g,n.u_highlight),u_accent:new u.aL(g,n.u_accent)}),hillshadePrepare:(g,n)=>({u_matrix:new u.aJ(g,n.u_matrix),u_image:new u.aH(g,n.u_image),u_dimension:new u.aO(g,n.u_dimension),u_zoom:new u.aI(g,n.u_zoom),u_unpack:new u.aK(g,n.u_unpack)}),line:(g,n)=>({u_matrix:new u.aJ(g,n.u_matrix),u_ratio:new u.aI(g,n.u_ratio),u_device_pixel_ratio:new u.aI(g,n.u_device_pixel_ratio),u_units_to_pixels:new u.aO(g,n.u_units_to_pixels)}),lineGradient:(g,n)=>({u_matrix:new u.aJ(g,n.u_matrix),u_ratio:new u.aI(g,n.u_ratio),u_device_pixel_ratio:new u.aI(g,n.u_device_pixel_ratio),u_units_to_pixels:new u.aO(g,n.u_units_to_pixels),u_image:new u.aH(g,n.u_image),u_image_height:new u.aI(g,n.u_image_height)}),linePattern:(g,n)=>({u_matrix:new u.aJ(g,n.u_matrix),u_texsize:new u.aO(g,n.u_texsize),u_ratio:new u.aI(g,n.u_ratio),u_device_pixel_ratio:new u.aI(g,n.u_device_pixel_ratio),u_image:new u.aH(g,n.u_image),u_units_to_pixels:new u.aO(g,n.u_units_to_pixels),u_scale:new u.aN(g,n.u_scale),u_fade:new u.aI(g,n.u_fade)}),lineSDF:(g,n)=>({u_matrix:new u.aJ(g,n.u_matrix),u_ratio:new u.aI(g,n.u_ratio),u_device_pixel_ratio:new u.aI(g,n.u_device_pixel_ratio),u_units_to_pixels:new u.aO(g,n.u_units_to_pixels),u_patternscale_a:new u.aO(g,n.u_patternscale_a),u_patternscale_b:new u.aO(g,n.u_patternscale_b),u_sdfgamma:new u.aI(g,n.u_sdfgamma),u_image:new u.aH(g,n.u_image),u_tex_y_a:new u.aI(g,n.u_tex_y_a),u_tex_y_b:new u.aI(g,n.u_tex_y_b),u_mix:new u.aI(g,n.u_mix)}),raster:(g,n)=>({u_matrix:new u.aJ(g,n.u_matrix),u_tl_parent:new u.aO(g,n.u_tl_parent),u_scale_parent:new u.aI(g,n.u_scale_parent),u_buffer_scale:new u.aI(g,n.u_buffer_scale),u_fade_t:new u.aI(g,n.u_fade_t),u_opacity:new u.aI(g,n.u_opacity),u_image0:new u.aH(g,n.u_image0),u_image1:new u.aH(g,n.u_image1),u_brightness_low:new u.aI(g,n.u_brightness_low),u_brightness_high:new u.aI(g,n.u_brightness_high),u_saturation_factor:new u.aI(g,n.u_saturation_factor),u_contrast_factor:new u.aI(g,n.u_contrast_factor),u_spin_weights:new u.aN(g,n.u_spin_weights)}),symbolIcon:(g,n)=>({u_is_size_zoom_constant:new u.aH(g,n.u_is_size_zoom_constant),u_is_size_feature_constant:new u.aH(g,n.u_is_size_feature_constant),u_size_t:new u.aI(g,n.u_size_t),u_size:new u.aI(g,n.u_size),u_camera_to_center_distance:new u.aI(g,n.u_camera_to_center_distance),u_pitch:new u.aI(g,n.u_pitch),u_rotate_symbol:new u.aH(g,n.u_rotate_symbol),u_aspect_ratio:new u.aI(g,n.u_aspect_ratio),u_fade_change:new u.aI(g,n.u_fade_change),u_matrix:new u.aJ(g,n.u_matrix),u_label_plane_matrix:new u.aJ(g,n.u_label_plane_matrix),u_coord_matrix:new u.aJ(g,n.u_coord_matrix),u_is_text:new u.aH(g,n.u_is_text),u_pitch_with_map:new u.aH(g,n.u_pitch_with_map),u_is_along_line:new u.aH(g,n.u_is_along_line),u_is_variable_anchor:new u.aH(g,n.u_is_variable_anchor),u_texsize:new u.aO(g,n.u_texsize),u_texture:new u.aH(g,n.u_texture),u_translation:new u.aO(g,n.u_translation),u_pitched_scale:new u.aI(g,n.u_pitched_scale)}),symbolSDF:(g,n)=>({u_is_size_zoom_constant:new u.aH(g,n.u_is_size_zoom_constant),u_is_size_feature_constant:new u.aH(g,n.u_is_size_feature_constant),u_size_t:new u.aI(g,n.u_size_t),u_size:new u.aI(g,n.u_size),u_camera_to_center_distance:new u.aI(g,n.u_camera_to_center_distance),u_pitch:new u.aI(g,n.u_pitch),u_rotate_symbol:new u.aH(g,n.u_rotate_symbol),u_aspect_ratio:new u.aI(g,n.u_aspect_ratio),u_fade_change:new u.aI(g,n.u_fade_change),u_matrix:new u.aJ(g,n.u_matrix),u_label_plane_matrix:new u.aJ(g,n.u_label_plane_matrix),u_coord_matrix:new u.aJ(g,n.u_coord_matrix),u_is_text:new u.aH(g,n.u_is_text),u_pitch_with_map:new u.aH(g,n.u_pitch_with_map),u_is_along_line:new u.aH(g,n.u_is_along_line),u_is_variable_anchor:new u.aH(g,n.u_is_variable_anchor),u_texsize:new u.aO(g,n.u_texsize),u_texture:new u.aH(g,n.u_texture),u_gamma_scale:new u.aI(g,n.u_gamma_scale),u_device_pixel_ratio:new u.aI(g,n.u_device_pixel_ratio),u_is_halo:new u.aH(g,n.u_is_halo),u_translation:new u.aO(g,n.u_translation),u_pitched_scale:new u.aI(g,n.u_pitched_scale)}),symbolTextAndIcon:(g,n)=>({u_is_size_zoom_constant:new u.aH(g,n.u_is_size_zoom_constant),u_is_size_feature_constant:new u.aH(g,n.u_is_size_feature_constant),u_size_t:new u.aI(g,n.u_size_t),u_size:new u.aI(g,n.u_size),u_camera_to_center_distance:new u.aI(g,n.u_camera_to_center_distance),u_pitch:new u.aI(g,n.u_pitch),u_rotate_symbol:new u.aH(g,n.u_rotate_symbol),u_aspect_ratio:new u.aI(g,n.u_aspect_ratio),u_fade_change:new u.aI(g,n.u_fade_change),u_matrix:new u.aJ(g,n.u_matrix),u_label_plane_matrix:new u.aJ(g,n.u_label_plane_matrix),u_coord_matrix:new u.aJ(g,n.u_coord_matrix),u_is_text:new u.aH(g,n.u_is_text),u_pitch_with_map:new u.aH(g,n.u_pitch_with_map),u_is_along_line:new u.aH(g,n.u_is_along_line),u_is_variable_anchor:new u.aH(g,n.u_is_variable_anchor),u_texsize:new u.aO(g,n.u_texsize),u_texsize_icon:new u.aO(g,n.u_texsize_icon),u_texture:new u.aH(g,n.u_texture),u_texture_icon:new u.aH(g,n.u_texture_icon),u_gamma_scale:new u.aI(g,n.u_gamma_scale),u_device_pixel_ratio:new u.aI(g,n.u_device_pixel_ratio),u_is_halo:new u.aH(g,n.u_is_halo),u_translation:new u.aO(g,n.u_translation),u_pitched_scale:new u.aI(g,n.u_pitched_scale)}),background:(g,n)=>({u_matrix:new u.aJ(g,n.u_matrix),u_opacity:new u.aI(g,n.u_opacity),u_color:new u.aL(g,n.u_color)}),backgroundPattern:(g,n)=>({u_matrix:new u.aJ(g,n.u_matrix),u_opacity:new u.aI(g,n.u_opacity),u_image:new u.aH(g,n.u_image),u_pattern_tl_a:new u.aO(g,n.u_pattern_tl_a),u_pattern_br_a:new u.aO(g,n.u_pattern_br_a),u_pattern_tl_b:new u.aO(g,n.u_pattern_tl_b),u_pattern_br_b:new u.aO(g,n.u_pattern_br_b),u_texsize:new u.aO(g,n.u_texsize),u_mix:new u.aI(g,n.u_mix),u_pattern_size_a:new u.aO(g,n.u_pattern_size_a),u_pattern_size_b:new u.aO(g,n.u_pattern_size_b),u_scale_a:new u.aI(g,n.u_scale_a),u_scale_b:new u.aI(g,n.u_scale_b),u_pixel_coord_upper:new u.aO(g,n.u_pixel_coord_upper),u_pixel_coord_lower:new u.aO(g,n.u_pixel_coord_lower),u_tile_units_to_pixels:new u.aI(g,n.u_tile_units_to_pixels)}),terrain:(g,n)=>({u_matrix:new u.aJ(g,n.u_matrix),u_texture:new u.aH(g,n.u_texture),u_ele_delta:new u.aI(g,n.u_ele_delta),u_fog_matrix:new u.aJ(g,n.u_fog_matrix),u_fog_color:new u.aL(g,n.u_fog_color),u_fog_ground_blend:new u.aI(g,n.u_fog_ground_blend),u_fog_ground_blend_opacity:new u.aI(g,n.u_fog_ground_blend_opacity),u_horizon_color:new u.aL(g,n.u_horizon_color),u_horizon_fog_blend:new u.aI(g,n.u_horizon_fog_blend)}),terrainDepth:(g,n)=>({u_matrix:new u.aJ(g,n.u_matrix),u_ele_delta:new u.aI(g,n.u_ele_delta)}),terrainCoords:(g,n)=>({u_matrix:new u.aJ(g,n.u_matrix),u_texture:new u.aH(g,n.u_texture),u_terrain_coords_id:new u.aI(g,n.u_terrain_coords_id),u_ele_delta:new u.aI(g,n.u_ele_delta)}),sky:(g,n)=>({u_sky_color:new u.aL(g,n.u_sky_color),u_horizon_color:new u.aL(g,n.u_horizon_color),u_horizon:new u.aI(g,n.u_horizon),u_sky_horizon_blend:new u.aI(g,n.u_sky_horizon_blend)})};class mo{constructor(n,a,h){this.context=n;const d=n.gl;this.buffer=d.createBuffer(),this.dynamicDraw=!!h,this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),d.bufferData(d.ELEMENT_ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(n){const a=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const qg={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Ju{constructor(n,a,h,d){this.length=a.length,this.attributes=h,this.itemSize=a.bytesPerElement,this.dynamicDraw=d,this.context=n;const m=n.gl;this.buffer=m.createBuffer(),n.bindVertexBuffer.set(this.buffer),m.bufferData(m.ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(n){if(n.length!==this.length)throw new Error(`Length of new data is ${n.length}, which doesn't match current length of ${this.length}`);const a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,n.arrayBuffer)}enableAttributes(n,a){for(let h=0;h<this.attributes.length;h++){const d=a.attributes[this.attributes[h].name];d!==void 0&&n.enableVertexAttribArray(d)}}setVertexAttribPointers(n,a,h){for(let d=0;d<this.attributes.length;d++){const m=this.attributes[d],w=a.attributes[m.name];w!==void 0&&n.vertexAttribPointer(w,m.components,n[qg[m.type]],!1,this.itemSize,m.offset+this.itemSize*(h||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Is=new WeakMap;function is(g){var n;if(Is.has(g))return Is.get(g);{const a=(n=g.getParameter(g.VERSION))===null||n===void 0?void 0:n.startsWith("WebGL 2.0");return Is.set(g,a),a}}class Kt{constructor(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(n){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class oc extends Kt{getDefault(){return u.aM.transparent}set(n){const a=this.current;(n.r!==a.r||n.g!==a.g||n.b!==a.b||n.a!==a.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class Hg extends Kt{getDefault(){return 1}set(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)}}class sa extends Kt{getDefault(){return 0}set(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)}}class Zg extends Kt{getDefault(){return[!0,!0,!0,!0]}set(n){const a=this.current;(n[0]!==a[0]||n[1]!==a[1]||n[2]!==a[2]||n[3]!==a[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class fp extends Kt{getDefault(){return!0}set(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)}}class Wg extends Kt{getDefault(){return 255}set(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)}}class mp extends Kt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(n){const a=this.current;(n.func!==a.func||n.ref!==a.ref||n.mask!==a.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)}}class Qu extends Kt{getDefault(){const n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]}set(n){const a=this.current;(n[0]!==a[0]||n[1]!==a[1]||n[2]!==a[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)}}class gp extends Kt{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;n?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST),this.current=n,this.dirty=!1}}class yp extends Kt{getDefault(){return[0,1]}set(n){const a=this.current;(n[0]!==a[0]||n[1]!==a[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)}}class _p extends Kt{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;n?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST),this.current=n,this.dirty=!1}}class vp extends Kt{getDefault(){return this.gl.LESS}set(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)}}class Ps extends Kt{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;n?a.enable(a.BLEND):a.disable(a.BLEND),this.current=n,this.dirty=!1}}class xp extends Kt{getDefault(){const n=this.gl;return[n.ONE,n.ZERO]}set(n){const a=this.current;(n[0]!==a[0]||n[1]!==a[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)}}class Kg extends Kt{getDefault(){return u.aM.transparent}set(n){const a=this.current;(n.r!==a.r||n.g!==a.g||n.b!==a.b||n.a!==a.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class bp extends Kt{getDefault(){return this.gl.FUNC_ADD}set(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)}}class sl extends Kt{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;n?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE),this.current=n,this.dirty=!1}}class Xg extends Kt{getDefault(){return this.gl.BACK}set(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)}}class sc extends Kt{getDefault(){return this.gl.CCW}set(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)}}class Yg extends Kt{getDefault(){return null}set(n){(n!==this.current||this.dirty)&&(this.gl.useProgram(n),this.current=n,this.dirty=!1)}}class Jg extends Kt{getDefault(){return this.gl.TEXTURE0}set(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)}}class wp extends Kt{getDefault(){const n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}set(n){const a=this.current;(n[0]!==a[0]||n[1]!==a[1]||n[2]!==a[2]||n[3]!==a[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class Sp extends Kt{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,n),this.current=n,this.dirty=!1}}class Tp extends Kt{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;a.bindRenderbuffer(a.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class eh extends Kt{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;a.bindTexture(a.TEXTURE_2D,n),this.current=n,this.dirty=!1}}class Cp extends Kt{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;a.bindBuffer(a.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class ac extends Kt{getDefault(){return null}set(n){const a=this.gl;a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class jo extends Kt{getDefault(){return null}set(n){var a;if(n===this.current&&!this.dirty)return;const h=this.gl;is(h)?h.bindVertexArray(n):(a=h.getExtension("OES_vertex_array_object"))===null||a===void 0||a.bindVertexArrayOES(n),this.current=n,this.dirty=!1}}class th extends Kt{getDefault(){return 4}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}}class nh extends Kt{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}}class rh extends Kt{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}}class lc extends Kt{constructor(n,a){super(n),this.context=n,this.parent=a}getDefault(){return null}}class ih extends lc{setDirty(){this.dirty=!0}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class As extends lc{set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class oh extends lc{set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class Qg{constructor(n,a,h,d,m){this.context=n,this.width=a,this.height=h;const w=n.gl,T=this.framebuffer=w.createFramebuffer();if(this.colorAttachment=new ih(n,T),d)this.depthAttachment=m?new oh(n,T):new As(n,T);else if(m)throw new Error("Stencil cannot be set without depth");if(w.checkFramebufferStatus(w.FRAMEBUFFER)!==w.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const n=this.context.gl,a=this.colorAttachment.get();if(a&&n.deleteTexture(a),this.depthAttachment){const h=this.depthAttachment.get();h&&n.deleteRenderbuffer(h)}n.deleteFramebuffer(this.framebuffer)}}class Dn{constructor(n,a,h){this.blendFunction=n,this.blendColor=a,this.mask=h}}Dn.Replace=[1,0],Dn.disabled=new Dn(Dn.Replace,u.aM.transparent,[!1,!1,!1,!1]),Dn.unblended=new Dn(Dn.Replace,u.aM.transparent,[!0,!0,!0,!0]),Dn.alphaBlended=new Dn([1,771],u.aM.transparent,[!0,!0,!0,!0]);class ey{constructor(n){var a,h;if(this.gl=n,this.clearColor=new oc(this),this.clearDepth=new Hg(this),this.clearStencil=new sa(this),this.colorMask=new Zg(this),this.depthMask=new fp(this),this.stencilMask=new Wg(this),this.stencilFunc=new mp(this),this.stencilOp=new Qu(this),this.stencilTest=new gp(this),this.depthRange=new yp(this),this.depthTest=new _p(this),this.depthFunc=new vp(this),this.blend=new Ps(this),this.blendFunc=new xp(this),this.blendColor=new Kg(this),this.blendEquation=new bp(this),this.cullFace=new sl(this),this.cullFaceSide=new Xg(this),this.frontFace=new sc(this),this.program=new Yg(this),this.activeTexture=new Jg(this),this.viewport=new wp(this),this.bindFramebuffer=new Sp(this),this.bindRenderbuffer=new Tp(this),this.bindTexture=new eh(this),this.bindVertexBuffer=new Cp(this),this.bindElementBuffer=new ac(this),this.bindVertexArray=new jo(this),this.pixelStoreUnpack=new th(this),this.pixelStoreUnpackPremultiplyAlpha=new nh(this),this.pixelStoreUnpackFlipY=new rh(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),is(n)){this.HALF_FLOAT=n.HALF_FLOAT;const d=n.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(a=n.RGBA16F)!==null&&a!==void 0?a:d==null?void 0:d.RGBA16F_EXT,this.RGB16F=(h=n.RGB16F)!==null&&h!==void 0?h:d==null?void 0:d.RGB16F_EXT,n.getExtension("EXT_color_buffer_float")}else{n.getExtension("EXT_color_buffer_half_float"),n.getExtension("OES_texture_half_float_linear");const d=n.getExtension("OES_texture_half_float");this.HALF_FLOAT=d==null?void 0:d.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(n,a){return new mo(this,n,a)}createVertexBuffer(n,a,h){return new Ju(this,n,a,h)}createRenderbuffer(n,a,h){const d=this.gl,m=d.createRenderbuffer();return this.bindRenderbuffer.set(m),d.renderbufferStorage(d.RENDERBUFFER,n,a,h),this.bindRenderbuffer.set(null),m}createFramebuffer(n,a,h,d){return new Qg(this,n,a,h,d)}clear({color:n,depth:a,stencil:h}){const d=this.gl;let m=0;n&&(m|=d.COLOR_BUFFER_BIT,this.clearColor.set(n),this.colorMask.set([!0,!0,!0,!0])),a!==void 0&&(m|=d.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(a),this.depthMask.set(!0)),h!==void 0&&(m|=d.STENCIL_BUFFER_BIT,this.clearStencil.set(h),this.stencilMask.set(255)),d.clear(m)}setCullFace(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))}setDepthMode(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)}setStencilMode(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)}setColorMode(n){u.aE(n.blendFunction,Dn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)}createVertexArray(){var n;return is(this.gl)?this.gl.createVertexArray():(n=this.gl.getExtension("OES_vertex_array_object"))===null||n===void 0?void 0:n.createVertexArrayOES()}deleteVertexArray(n){var a;return is(this.gl)?this.gl.deleteVertexArray(n):(a=this.gl.getExtension("OES_vertex_array_object"))===null||a===void 0?void 0:a.deleteVertexArrayOES(n)}unbindVAO(){this.bindVertexArray.set(null)}}class Rt{constructor(n,a,h){this.func=n,this.mask=a,this.range=h}}Rt.ReadOnly=!1,Rt.ReadWrite=!0,Rt.disabled=new Rt(519,Rt.ReadOnly,[0,1]);const cc=7680;class pn{constructor(n,a,h,d,m,w){this.test=n,this.ref=a,this.mask=h,this.fail=d,this.depthFail=m,this.pass=w}}pn.disabled=new pn({func:519,mask:0},0,0,cc,cc,cc);class nn{constructor(n,a,h){this.enable=n,this.mode=a,this.frontFace=h}}let Ms;function al(g,n,a,h,d){const m=g.context,w=m.gl,T=g.useProgram("collisionBox"),C=[];let I=0,M=0;for(let oe=0;oe<h.length;oe++){const le=h[oe],K=n.getTile(le).getBucket(a);if(!K)continue;const he=d?K.textCollisionBox:K.iconCollisionBox,fe=K.collisionCircleArray;if(fe.length>0){const ve=u.H();u.aQ(ve,K.placementInvProjMatrix,g.transform.glCoordMatrix),u.aQ(ve,ve,K.placementViewportMatrix),C.push({circleArray:fe,circleOffset:M,transform:le.posMatrix,invTransform:ve,coord:le}),I+=fe.length/4,M=I}he&&T.draw(m,w.LINES,Rt.disabled,pn.disabled,g.colorModeForRenderPass(),nn.disabled,{u_matrix:le.posMatrix,u_pixel_extrude_scale:[1/(z=g.transform).width,1/z.height]},g.style.map.terrain&&g.style.map.terrain.getTerrainData(le),a.id,he.layoutVertexBuffer,he.indexBuffer,he.segments,null,g.transform.zoom,null,null,he.collisionVertexBuffer)}var z;if(!d||!C.length)return;const $=g.useProgram("collisionCircle"),G=new u.aR;G.resize(4*I),G._trim();let H=0;for(const oe of C)for(let le=0;le<oe.circleArray.length/4;le++){const K=4*le,he=oe.circleArray[K+0],fe=oe.circleArray[K+1],ve=oe.circleArray[K+2],Me=oe.circleArray[K+3];G.emplace(H++,he,fe,ve,Me,0),G.emplace(H++,he,fe,ve,Me,1),G.emplace(H++,he,fe,ve,Me,2),G.emplace(H++,he,fe,ve,Me,3)}(!Ms||Ms.length<2*I)&&(Ms=function(oe){const le=2*oe,K=new u.aT;K.resize(le),K._trim();for(let he=0;he<le;he++){const fe=6*he;K.uint16[fe+0]=4*he+0,K.uint16[fe+1]=4*he+1,K.uint16[fe+2]=4*he+2,K.uint16[fe+3]=4*he+2,K.uint16[fe+4]=4*he+3,K.uint16[fe+5]=4*he+0}return K}(I));const Q=m.createIndexBuffer(Ms,!0),ie=m.createVertexBuffer(G,u.aS.members,!0);for(const oe of C){const le=Es(oe.transform,oe.invTransform,g.transform);$.draw(m,w.TRIANGLES,Rt.disabled,pn.disabled,g.colorModeForRenderPass(),nn.disabled,le,g.style.map.terrain&&g.style.map.terrain.getTerrainData(oe.coord),a.id,ie,Q,u.a0.simpleSegment(0,2*oe.circleOffset,oe.circleArray.length,oe.circleArray.length/2),null,g.transform.zoom,null,null,null)}ie.destroy(),Q.destroy()}nn.disabled=new nn(!1,1029,2305),nn.backCCW=new nn(!0,1029,2305);const ll=u.an(new Float32Array(16));function sh(g,n,a,h,d,m){const{horizontalAlign:w,verticalAlign:T}=u.au(g);return new u.P((-(w-.5)*n/d+h[0])*m,(-(T-.5)*a/d+h[1])*m)}function zs(g,n,a,h,d,m){const w=n.tileAnchorPoint.add(new u.P(n.translation[0],n.translation[1]));if(n.pitchWithMap){let T=h.mult(m);a||(T=T.rotate(-d));const C=w.add(T);return te(C.x,C.y,n.labelPlaneMatrix,n.getElevation).point}if(a){const T=Ee(n.tileAnchorPoint.x+1,n.tileAnchorPoint.y,n).point.sub(g),C=Math.atan(T.y/T.x)+(T.x<0?Math.PI:0);return g.add(h.rotate(C))}return g.add(h)}function aa(g,n,a,h,d,m,w,T,C,I,M,z,$,G){const H=g.text.placedSymbolArray,Q=g.text.dynamicLayoutVertexArray,ie=g.icon.dynamicLayoutVertexArray,oe={};Q.clear();for(let le=0;le<H.length;le++){const K=H.get(le),he=K.hidden||!K.crossTileID||g.allowVerticalPlacement&&!K.placedOrientation?null:h[K.crossTileID];if(he){const fe=new u.P(K.anchorX,K.anchorY),ve={getElevation:G,width:d.width,height:d.height,labelPlaneMatrix:m,lineVertexArray:null,pitchWithMap:a,projection:M,projectionCache:null,tileAnchorPoint:fe,translation:z,unwrappedTileID:$},Me=a?te(fe.x,fe.y,w,G):Ee(fe.x,fe.y,ve),De=B(d.cameraToCenterDistance,Me.signedDistanceFromCamera);let Ze=u.ai(g.textSizeData,C,K)*De/u.ap;a&&(Ze*=g.tilePixelRatio/T);const{width:Ye,height:Ue,anchor:je,textOffset:it,textBoxScale:St}=he,Ge=sh(je,Ye,Ue,it,St,Ze),Ke=M.getPitchedTextCorrection(d,fe.add(new u.P(z[0],z[1])),$),xt=zs(Me.point,ve,n,Ge,d.angle,Ke),xn=g.allowVerticalPlacement&&K.placedOrientation===u.ah.vertical?Math.PI/2:0;for(let Pt=0;Pt<K.numGlyphs;Pt++)u.aj(Q,xt,xn);I&&K.associatedIconIndex>=0&&(oe[K.associatedIconIndex]={shiftedAnchor:xt,angle:xn})}else pt(K.numGlyphs,Q)}if(I){ie.clear();const le=g.icon.placedSymbolArray;for(let K=0;K<le.length;K++){const he=le.get(K);if(he.hidden)pt(he.numGlyphs,ie);else{const fe=oe[K];if(fe)for(let ve=0;ve<he.numGlyphs;ve++)u.aj(ie,fe.shiftedAnchor,fe.angle);else pt(he.numGlyphs,ie)}}g.icon.dynamicLayoutVertexBuffer.updateData(ie)}g.text.dynamicLayoutVertexBuffer.updateData(Q)}function Ti(g,n,a){return a.iconsInText&&n?"symbolTextAndIcon":g?"symbolSDF":"symbolIcon"}function ah(g,n,a,h,d,m,w,T,C,I,M,z){const $=g.context,G=$.gl,H=g.transform,Q=Cs(),ie=T==="map",oe=C==="map",le=T!=="viewport"&&a.layout.get("symbol-placement")!=="point",K=ie&&!oe&&!le,he=!oe&&le,fe=!a.layout.get("symbol-sort-key").isConstant();let ve=!1;const Me=g.depthModeForSublayer(0,Rt.ReadOnly),De=a._unevaluatedLayout.hasValue("text-variable-anchor")||a._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ze=[],Ye=Q.getCircleRadiusCorrection(H);for(const Ue of h){const je=n.getTile(Ue),it=je.getBucket(a);if(!it)continue;const St=d?it.text:it.icon;if(!St||!St.segments.get().length||!St.hasVisibleVertices)continue;const Ge=St.programConfigurations.get(a.id),Ke=d||it.sdfIcons,xt=d?it.textSizeData:it.iconSizeData,xn=oe||H.pitch!==0,Pt=g.useProgram(Ti(Ke,d,it),Ge),Ft=u.ag(xt,H.zoom),bn=g.style.map.terrain&&g.style.map.terrain.getTerrainData(Ue);let vr,Zi,wn,Zr,Rr=[0,0],xr=null;if(d)Zi=je.glyphAtlasTexture,wn=G.LINEAR,vr=je.glyphAtlasTexture.size,it.iconsInText&&(Rr=je.imageAtlasTexture.size,xr=je.imageAtlasTexture,Zr=xn||g.options.rotating||g.options.zooming||xt.kind==="composite"||xt.kind==="camera"?G.LINEAR:G.NEAREST);else{const Ot=a.layout.get("icon-size").constantOr(0)!==1||it.iconsNeedLinear;Zi=je.imageAtlasTexture,wn=Ke||g.options.rotating||g.options.zooming||Ot||xn?G.LINEAR:G.NEAREST,vr=je.imageAtlasTexture.size}const Dr=Dt(je,1,g.transform.zoom),_o=he?Ue.posMatrix:ll,Sa=ns(_o,oe,ie,g.transform,Dr),Ic=fo(_o,oe,ie,g.transform,Dr),Ta=fo(Ue.posMatrix,oe,ie,g.transform,Dr),Ei=Q.translatePosition(g.transform,je,m,w),Pc=De&&it.hasTextData(),zh=a.layout.get("icon-text-fit")!=="none"&&Pc&&it.hasIconData();if(le){const Ot=g.style.map.terrain?(Ca,ka)=>g.style.map.terrain.getElevation(Ue,Ca,ka):null,Bs=a.layout.get("text-rotation-alignment")==="map";q(it,Ue.posMatrix,g,d,Sa,Ta,oe,I,Bs,Q,Ue.toUnwrapped(),H.width,H.height,Ei,Ot)}const Ii=Ue.posMatrix,Pi=d&&De||zh,os=le||Pi?ll:Sa,Wi=Ic,dr=Ke&&a.paint.get(d?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let br;br=Ke?it.iconsInText?Ku(xt.kind,Ft,K,oe,le,Pi,g,Ii,os,Wi,Ei,vr,Rr,Ye):ol(xt.kind,Ft,K,oe,le,Pi,g,Ii,os,Wi,Ei,d,vr,!0,Ye):pp(xt.kind,Ft,K,oe,le,Pi,g,Ii,os,Wi,Ei,d,vr,Ye);const pi={program:Pt,buffers:St,uniformValues:br,atlasTexture:Zi,atlasTextureIcon:xr,atlasInterpolation:wn,atlasInterpolationIcon:Zr,isSDF:Ke,hasHalo:dr};if(fe&&it.canOverlap){ve=!0;const Ot=St.segments.get();for(const Bs of Ot)Ze.push({segments:new u.a0([Bs]),sortKey:Bs.sortKey,state:pi,terrainData:bn})}else Ze.push({segments:St.segments,sortKey:0,state:pi,terrainData:bn})}ve&&Ze.sort((Ue,je)=>Ue.sortKey-je.sortKey);for(const Ue of Ze){const je=Ue.state;if($.activeTexture.set(G.TEXTURE0),je.atlasTexture.bind(je.atlasInterpolation,G.CLAMP_TO_EDGE),je.atlasTextureIcon&&($.activeTexture.set(G.TEXTURE1),je.atlasTextureIcon&&je.atlasTextureIcon.bind(je.atlasInterpolationIcon,G.CLAMP_TO_EDGE)),je.isSDF){const it=je.uniformValues;je.hasHalo&&(it.u_is_halo=1,lh(je.buffers,Ue.segments,a,g,je.program,Me,M,z,it,Ue.terrainData)),it.u_is_halo=0}lh(je.buffers,Ue.segments,a,g,je.program,Me,M,z,je.uniformValues,Ue.terrainData)}}function lh(g,n,a,h,d,m,w,T,C,I){const M=h.context;d.draw(M,M.gl.TRIANGLES,m,w,T,nn.disabled,C,I,a.id,g.layoutVertexBuffer,g.indexBuffer,n,a.paint,h.transform.zoom,g.programConfigurations.get(a.id),g.dynamicLayoutVertexBuffer,g.opacityVertexBuffer)}function ch(g,n,a,h){const d=g.context,m=d.gl,w=pn.disabled,T=new Dn([m.ONE,m.ONE],u.aM.transparent,[!0,!0,!0,!0]),C=n.getBucket(a);if(!C)return;const I=h.key;let M=a.heatmapFbos.get(I);M||(M=cl(d,n.tileSize,n.tileSize),a.heatmapFbos.set(I,M)),d.bindFramebuffer.set(M.framebuffer),d.viewport.set([0,0,n.tileSize,n.tileSize]),d.clear({color:u.aM.transparent});const z=C.programConfigurations.get(a.id),$=g.useProgram("heatmap",z),G=g.style.map.terrain.getTerrainData(h);$.draw(d,m.TRIANGLES,Rt.disabled,w,T,nn.disabled,Hr(h.posMatrix,n,g.transform.zoom,a.paint.get("heatmap-intensity")),G,a.id,C.layoutVertexBuffer,C.indexBuffer,C.segments,a.paint,g.transform.zoom,z)}function Ls(g,n,a){const h=g.context,d=h.gl;h.setColorMode(g.colorModeForRenderPass());const m=ul(h,n),w=a.key,T=n.heatmapFbos.get(w);T&&(h.activeTexture.set(d.TEXTURE0),d.bindTexture(d.TEXTURE_2D,T.colorAttachment.get()),h.activeTexture.set(d.TEXTURE1),m.bind(d.LINEAR,d.CLAMP_TO_EDGE),g.useProgram("heatmapTexture").draw(h,d.TRIANGLES,Rt.disabled,pn.disabled,g.colorModeForRenderPass(),nn.disabled,tc(g,n,0,1),null,n.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments,n.paint,g.transform.zoom),T.destroy(),n.heatmapFbos.delete(w))}function cl(g,n,a){var h,d;const m=g.gl,w=m.createTexture();m.bindTexture(m.TEXTURE_2D,w),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.LINEAR),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.LINEAR);const T=(h=g.HALF_FLOAT)!==null&&h!==void 0?h:m.UNSIGNED_BYTE,C=(d=g.RGBA16F)!==null&&d!==void 0?d:m.RGBA;m.texImage2D(m.TEXTURE_2D,0,C,n,a,0,m.RGBA,T,null);const I=g.createFramebuffer(n,a,!1,!1);return I.colorAttachment.set(w),I}function ul(g,n){return n.colorRampTexture||(n.colorRampTexture=new He(g,n.colorRamp,g.gl.RGBA)),n.colorRampTexture}function la(g,n,a,h,d){if(!a||!h||!h.imageAtlas)return;const m=h.imageAtlas.patternPositions;let w=m[a.to.toString()],T=m[a.from.toString()];if(!w&&T&&(w=T),!T&&w&&(T=w),!w||!T){const C=d.getPaintProperty(n);w=m[C],T=m[C]}w&&T&&g.setConstantPatternPositions(w,T)}function hl(g,n,a,h,d,m,w){const T=g.context.gl,C="fill-pattern",I=a.paint.get(C),M=I&&I.constantOr(1),z=a.getCrossfadeParameters();let $,G,H,Q,ie;w?(G=M&&!a.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",$=T.LINES):(G=M?"fillPattern":"fill",$=T.TRIANGLES);const oe=I.constantOr(null);for(const le of h){const K=n.getTile(le);if(M&&!K.patternsLoaded())continue;const he=K.getBucket(a);if(!he)continue;const fe=he.programConfigurations.get(a.id),ve=g.useProgram(G,fe),Me=g.style.map.terrain&&g.style.map.terrain.getTerrainData(le);M&&(g.context.activeTexture.set(T.TEXTURE0),K.imageAtlasTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),fe.updatePaintBuffers(z)),la(fe,C,oe,K,a);const De=Me?le:null,Ze=g.translatePosMatrix(De?De.posMatrix:le.posMatrix,K,a.paint.get("fill-translate"),a.paint.get("fill-translate-anchor"));if(w){Q=he.indexBuffer2,ie=he.segments2;const Ye=[T.drawingBufferWidth,T.drawingBufferHeight];H=G==="fillOutlinePattern"&&M?cp(Ze,g,z,K,Ye):$g(Ze,Ye)}else Q=he.indexBuffer,ie=he.segments,H=M?lp(Ze,g,z,K):ia(Ze);ve.draw(g.context,$,d,g.stencilModeForClipping(le),m,nn.disabled,H,Me,a.id,he.layoutVertexBuffer,Q,ie,a.paint,g.transform.zoom,fe)}}function uc(g,n,a,h,d,m,w){const T=g.context,C=T.gl,I="fill-extrusion-pattern",M=a.paint.get(I),z=M.constantOr(1),$=a.getCrossfadeParameters(),G=a.paint.get("fill-extrusion-opacity"),H=M.constantOr(null);for(const Q of h){const ie=n.getTile(Q),oe=ie.getBucket(a);if(!oe)continue;const le=g.style.map.terrain&&g.style.map.terrain.getTerrainData(Q),K=oe.programConfigurations.get(a.id),he=g.useProgram(z?"fillExtrusionPattern":"fillExtrusion",K);z&&(g.context.activeTexture.set(C.TEXTURE0),ie.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),K.updatePaintBuffers($)),la(K,I,H,ie,a);const fe=g.translatePosMatrix(Q.posMatrix,ie,a.paint.get("fill-extrusion-translate"),a.paint.get("fill-extrusion-translate-anchor")),ve=a.paint.get("fill-extrusion-vertical-gradient"),Me=z?ec(fe,g,ve,G,Q,$,ie):rl(fe,g,ve,G);he.draw(T,T.gl.TRIANGLES,d,m,w,nn.backCCW,Me,le,a.id,oe.layoutVertexBuffer,oe.indexBuffer,oe.segments,a.paint,g.transform.zoom,K,g.style.map.terrain&&oe.centroidVertexBuffer)}}function ca(g,n,a,h,d,m,w){const T=g.context,C=T.gl,I=a.fbo;if(!I)return;const M=g.useProgram("hillshade"),z=g.style.map.terrain&&g.style.map.terrain.getTerrainData(n);T.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,I.colorAttachment.get()),M.draw(T,C.TRIANGLES,d,m,w,nn.disabled,(($,G,H,Q)=>{const ie=H.paint.get("hillshade-shadow-color"),oe=H.paint.get("hillshade-highlight-color"),le=H.paint.get("hillshade-accent-color");let K=H.paint.get("hillshade-illumination-direction")*(Math.PI/180);H.paint.get("hillshade-illumination-anchor")==="viewport"&&(K-=$.transform.angle);const he=!$.options.moving;return{u_matrix:Q?Q.posMatrix:$.transform.calculatePosMatrix(G.tileID.toUnwrapped(),he),u_image:0,u_latrange:nc(0,G.tileID),u_light:[H.paint.get("hillshade-exaggeration"),K],u_shadow:ie,u_highlight:oe,u_accent:le}})(g,a,h,z?n:null),z,h.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments)}function ua(g,n,a,h,d,m){const w=g.context,T=w.gl,C=n.dem;if(C&&C.data){const I=C.dim,M=C.stride,z=C.getPixels();if(w.activeTexture.set(T.TEXTURE1),w.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||g.getTileTexture(M),n.demTexture){const G=n.demTexture;G.update(z,{premultiply:!1}),G.bind(T.NEAREST,T.CLAMP_TO_EDGE)}else n.demTexture=new He(w,z,T.RGBA,{premultiply:!1}),n.demTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE);w.activeTexture.set(T.TEXTURE0);let $=n.fbo;if(!$){const G=new He(w,{width:I,height:I,data:null},T.RGBA);G.bind(T.LINEAR,T.CLAMP_TO_EDGE),$=n.fbo=w.createFramebuffer(I,I,!0,!1),$.colorAttachment.set(G.texture)}w.bindFramebuffer.set($.framebuffer),w.viewport.set([0,0,I,I]),g.useProgram("hillshadePrepare").draw(w,T.TRIANGLES,h,d,m,nn.disabled,((G,H)=>{const Q=H.stride,ie=u.H();return u.aP(ie,0,u.X,-u.X,0,0,1),u.J(ie,ie,[0,-u.X,0]),{u_matrix:ie,u_image:1,u_dimension:[Q,Q],u_zoom:G.overscaledZ,u_unpack:H.getUnpackVector()}})(n.tileID,C),null,a.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments),n.needsHillshadePrepare=!1}}function kp(g,n,a,h,d,m){const w=h.paint.get("raster-fade-duration");if(!m&&w>0){const T=N.now(),C=(T-g.timeAdded)/w,I=n?(T-n.timeAdded)/w:-1,M=a.getSource(),z=d.coveringZoomLevel({tileSize:M.tileSize,roundZoom:M.roundZoom}),$=!n||Math.abs(n.tileID.overscaledZ-z)>Math.abs(g.tileID.overscaledZ-z),G=$&&g.refreshedUponExpiration?1:u.ac($?C:1-I,0,1);return g.refreshedUponExpiration&&C>=1&&(g.refreshedUponExpiration=!1),n?{opacity:1,mix:1-G}:{opacity:G,mix:0}}return{opacity:1,mix:0}}const uh=new u.aM(1,0,0,1),Gt=new u.aM(0,1,0,1),hc=new u.aM(0,0,1,1),ty=new u.aM(1,0,1,1),Ep=new u.aM(0,1,1,1);function ha(g,n,a,h){dc(g,0,n+a/2,g.transform.width,a,h)}function Ip(g,n,a,h){dc(g,n-a/2,0,a,g.transform.height,h)}function dc(g,n,a,h,d,m){const w=g.context,T=w.gl;T.enable(T.SCISSOR_TEST),T.scissor(n*g.pixelRatio,a*g.pixelRatio,h*g.pixelRatio,d*g.pixelRatio),w.clear({color:m}),T.disable(T.SCISSOR_TEST)}function Pp(g,n,a){const h=g.context,d=h.gl,m=a.posMatrix,w=g.useProgram("debug"),T=Rt.disabled,C=pn.disabled,I=g.colorModeForRenderPass(),M="$debug",z=g.style.map.terrain&&g.style.map.terrain.getTerrainData(a);h.activeTexture.set(d.TEXTURE0);const $=n.getTileByID(a.key).latestRawTileData,G=Math.floor(($&&$.byteLength||0)/1024),H=n.getTile(a).tileSize,Q=512/Math.min(H,512)*(a.overscaledZ/g.transform.zoom)*.5;let ie=a.canonical.toString();a.overscaledZ!==a.canonical.z&&(ie+=` => ${a.overscaledZ}`),function(oe,le){oe.initDebugOverlayCanvas();const K=oe.debugOverlayCanvas,he=oe.context.gl,fe=oe.debugOverlayCanvas.getContext("2d");fe.clearRect(0,0,K.width,K.height),fe.shadowColor="white",fe.shadowBlur=2,fe.lineWidth=1.5,fe.strokeStyle="white",fe.textBaseline="top",fe.font="bold 36px Open Sans, sans-serif",fe.fillText(le,5,5),fe.strokeText(le,5,5),oe.debugOverlayTexture.update(K),oe.debugOverlayTexture.bind(he.LINEAR,he.CLAMP_TO_EDGE)}(g,`${ie} ${G}kB`),w.draw(h,d.TRIANGLES,T,C,Dn.alphaBlended,nn.disabled,il(m,u.aM.transparent,Q),null,M,g.debugBuffer,g.quadTriangleIndexBuffer,g.debugSegments),w.draw(h,d.LINE_STRIP,T,C,I,nn.disabled,il(m,u.aM.red),z,M,g.debugBuffer,g.tileBorderIndexBuffer,g.debugSegments)}function Ap(g,n,a){const h=g.context,d=h.gl,m=g.colorModeForRenderPass(),w=new Rt(d.LEQUAL,Rt.ReadWrite,g.depthRangeFor3D),T=g.useProgram("terrain"),C=n.getTerrainMesh();h.bindFramebuffer.set(null),h.viewport.set([0,0,g.width,g.height]);for(const I of a){const M=g.renderToTexture.getTexture(I),z=n.getTerrainData(I.tileID);h.activeTexture.set(d.TEXTURE0),d.bindTexture(d.TEXTURE_2D,M.texture);const $=g.transform.calculatePosMatrix(I.tileID.toUnwrapped()),G=n.getMeshFrameDelta(g.transform.zoom),H=g.transform.calculateFogMatrix(I.tileID.toUnwrapped()),Q=Zu($,G,H,g.style.sky,g.transform.pitch);T.draw(h,d.TRIANGLES,w,pn.disabled,m,nn.backCCW,Q,z,"terrain",C.vertexBuffer,C.indexBuffer,C.segments)}}class pc{constructor(n,a,h){this.vertexBuffer=n,this.indexBuffer=a,this.segments=h}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}class fc{constructor(n,a){this.context=new ey(n),this.transform=a,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:u.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=_t.maxUnderzooming+_t.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new qu}resize(n,a,h){if(this.width=Math.floor(n*h),this.height=Math.floor(a*h),this.pixelRatio=h,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const d of this.style._order)this.style._layers[d].resize()}setup(){const n=this.context,a=new u.aX;a.emplaceBack(0,0),a.emplaceBack(u.X,0),a.emplaceBack(0,u.X),a.emplaceBack(u.X,u.X),this.tileExtentBuffer=n.createVertexBuffer(a,ks.members),this.tileExtentSegments=u.a0.simpleSegment(0,0,4,2);const h=new u.aX;h.emplaceBack(0,0),h.emplaceBack(u.X,0),h.emplaceBack(0,u.X),h.emplaceBack(u.X,u.X),this.debugBuffer=n.createVertexBuffer(h,ks.members),this.debugSegments=u.a0.simpleSegment(0,0,4,5);const d=new u.$;d.emplaceBack(0,0,0,0),d.emplaceBack(u.X,0,u.X,0),d.emplaceBack(0,u.X,0,u.X),d.emplaceBack(u.X,u.X,u.X,u.X),this.rasterBoundsBuffer=n.createVertexBuffer(d,ho.members),this.rasterBoundsSegments=u.a0.simpleSegment(0,0,4,2);const m=new u.aX;m.emplaceBack(0,0),m.emplaceBack(1,0),m.emplaceBack(0,1),m.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(m,ks.members),this.viewportSegments=u.a0.simpleSegment(0,0,4,2);const w=new u.aZ;w.emplaceBack(0),w.emplaceBack(1),w.emplaceBack(3),w.emplaceBack(2),w.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(w);const T=new u.aY;T.emplaceBack(0,1,2),T.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(T);const C=this.context.gl;this.stencilClearMode=new pn({func:C.ALWAYS,mask:0},0,255,C.ZERO,C.ZERO,C.ZERO)}clearStencil(){const n=this.context,a=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const h=u.H();u.aP(h,0,this.width,this.height,0,0,1),u.K(h,h,[a.drawingBufferWidth,a.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(n,a.TRIANGLES,Rt.disabled,this.stencilClearMode,Dn.disabled,nn.disabled,qr(h),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(n,a){if(this.currentStencilSource===n.source||!n.isTileClipped()||!a||!a.length)return;this.currentStencilSource=n.source;const h=this.context,d=h.gl;this.nextStencilID+a.length>256&&this.clearStencil(),h.setColorMode(Dn.disabled),h.setDepthMode(Rt.disabled);const m=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const w of a){const T=this._tileClippingMaskIDs[w.key]=this.nextStencilID++,C=this.style.map.terrain&&this.style.map.terrain.getTerrainData(w);m.draw(h,d.TRIANGLES,Rt.disabled,new pn({func:d.ALWAYS,mask:0},T,255,d.KEEP,d.KEEP,d.REPLACE),Dn.disabled,nn.disabled,qr(w.posMatrix),C,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const n=this.nextStencilID++,a=this.context.gl;return new pn({func:a.NOTEQUAL,mask:255},n,255,a.KEEP,a.KEEP,a.REPLACE)}stencilModeForClipping(n){const a=this.context.gl;return new pn({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,a.KEEP,a.KEEP,a.REPLACE)}stencilConfigForOverlap(n){const a=this.context.gl,h=n.sort((w,T)=>T.overscaledZ-w.overscaledZ),d=h[h.length-1].overscaledZ,m=h[0].overscaledZ-d+1;if(m>1){this.currentStencilSource=void 0,this.nextStencilID+m>256&&this.clearStencil();const w={};for(let T=0;T<m;T++)w[T+d]=new pn({func:a.GEQUAL,mask:255},T+this.nextStencilID,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID+=m,[w,h]}return[{[d]:pn.disabled},h]}colorModeForRenderPass(){const n=this.context.gl;return this._showOverdrawInspector?new Dn([n.CONSTANT_COLOR,n.ONE],new u.aM(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Dn.unblended:Dn.alphaBlended}depthModeForSublayer(n,a,h){if(!this.opaquePassEnabledForLayer())return Rt.disabled;const d=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new Rt(h||this.context.gl.LEQUAL,a,[d,d])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(n,a){this.style=n,this.options=a,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(N.now()),this.imageManager.beginFrame();const h=this.style._order,d=this.style.sourceCaches,m={},w={},T={};for(const C in d){const I=d[C];I.used&&I.prepare(this.context),m[C]=I.getVisibleCoordinates(),w[C]=m[C].slice().reverse(),T[C]=I.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let C=0;C<h.length;C++)if(this.style._layers[h[C]].is3D()){this.opaquePassCutoff=C;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const C of h){const I=this.style._layers[C];if(!I.hasOffscreenPass()||I.isHidden(this.transform.zoom))continue;const M=w[I.source];(I.type==="custom"||M.length)&&this.renderLayer(this,d[I.source],I,M)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?u.aM.black:u.aM.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(C,I){const M=C.context,z=M.gl,$=((oe,le,K)=>({u_sky_color:oe.properties.get("sky-color"),u_horizon_color:oe.properties.get("horizon-color"),u_horizon:(le.height/2+le.getHorizon())*K,u_sky_horizon_blend:oe.properties.get("sky-horizon-blend")*le.height/2*K}))(I,C.style.map.transform,C.pixelRatio),G=new Rt(z.LEQUAL,Rt.ReadWrite,[0,1]),H=pn.disabled,Q=C.colorModeForRenderPass(),ie=C.useProgram("sky");if(!I.mesh){const oe=new u.aX;oe.emplaceBack(-1,-1),oe.emplaceBack(1,-1),oe.emplaceBack(1,1),oe.emplaceBack(-1,1);const le=new u.aY;le.emplaceBack(0,1,2),le.emplaceBack(0,2,3),I.mesh=new pc(M.createVertexBuffer(oe,ks.members),M.createIndexBuffer(le),u.a0.simpleSegment(0,0,oe.length,le.length))}ie.draw(M,z.TRIANGLES,G,H,Q,nn.disabled,$,void 0,"sky",I.mesh.vertexBuffer,I.mesh.indexBuffer,I.mesh.segments)}(this,this.style.sky),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=h.length-1;this.currentLayer>=0;this.currentLayer--){const C=this.style._layers[h[this.currentLayer]],I=d[C.source],M=m[C.source];this._renderTileClippingMasks(C,M),this.renderLayer(this,I,C,M)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<h.length;this.currentLayer++){const C=this.style._layers[h[this.currentLayer]],I=d[C.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(C))continue;const M=(C.type==="symbol"?T:w)[C.source];this._renderTileClippingMasks(C,m[C.source]),this.renderLayer(this,I,C,M)}if(this.options.showTileBoundaries){const C=function(I,M){let z=null;const $=Object.values(I._layers).flatMap(ie=>ie.source&&!ie.isHidden(M)?[I.sourceCaches[ie.source]]:[]),G=$.filter(ie=>ie.getSource().type==="vector"),H=$.filter(ie=>ie.getSource().type!=="vector"),Q=ie=>{(!z||z.getSource().maxzoom<ie.getSource().maxzoom)&&(z=ie)};return G.forEach(ie=>Q(ie)),z||H.forEach(ie=>Q(ie)),z}(this.style,this.transform.zoom);C&&function(I,M,z){for(let $=0;$<z.length;$++)Pp(I,M,z[$])}(this,C,C.getVisibleCoordinates())}this.options.showPadding&&function(C){const I=C.transform.padding;ha(C,C.transform.height-(I.top||0),3,uh),ha(C,I.bottom||0,3,Gt),Ip(C,I.left||0,3,hc),Ip(C,C.transform.width-(I.right||0),3,ty);const M=C.transform.centerPoint;(function(z,$,G,H){dc(z,$-1,G-10,2,20,H),dc(z,$-10,G-1,20,2,H)})(C,M.x,C.transform.height-M.y,Ep)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(n){if(!this.style||!this.style.map||!this.style.map.terrain)return;const a=this.terrainFacilitator.matrix,h=this.transform.modelViewProjectionMatrix;let d=this.terrainFacilitator.dirty;d||(d=n?!u.a_(a,h):!u.a$(a,h)),d||(d=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),d&&(u.b0(a,h),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(m,w){const T=m.context,C=T.gl,I=Dn.unblended,M=new Rt(C.LEQUAL,Rt.ReadWrite,[0,1]),z=w.getTerrainMesh(),$=w.sourceCache.getRenderableTiles(),G=m.useProgram("terrainDepth");T.bindFramebuffer.set(w.getFramebuffer("depth").framebuffer),T.viewport.set([0,0,m.width/devicePixelRatio,m.height/devicePixelRatio]),T.clear({color:u.aM.transparent,depth:1});for(const H of $){const Q=w.getTerrainData(H.tileID),ie={u_matrix:m.transform.calculatePosMatrix(H.tileID.toUnwrapped()),u_ele_delta:w.getMeshFrameDelta(m.transform.zoom)};G.draw(T,C.TRIANGLES,M,pn.disabled,I,nn.backCCW,ie,Q,"terrain",z.vertexBuffer,z.indexBuffer,z.segments)}T.bindFramebuffer.set(null),T.viewport.set([0,0,m.width,m.height])}(this,this.style.map.terrain),function(m,w){const T=m.context,C=T.gl,I=Dn.unblended,M=new Rt(C.LEQUAL,Rt.ReadWrite,[0,1]),z=w.getTerrainMesh(),$=w.getCoordsTexture(),G=w.sourceCache.getRenderableTiles(),H=m.useProgram("terrainCoords");T.bindFramebuffer.set(w.getFramebuffer("coords").framebuffer),T.viewport.set([0,0,m.width/devicePixelRatio,m.height/devicePixelRatio]),T.clear({color:u.aM.transparent,depth:1}),w.coordsIndex=[];for(const Q of G){const ie=w.getTerrainData(Q.tileID);T.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,$.texture);const oe={u_matrix:m.transform.calculatePosMatrix(Q.tileID.toUnwrapped()),u_terrain_coords_id:(255-w.coordsIndex.length)/255,u_texture:0,u_ele_delta:w.getMeshFrameDelta(m.transform.zoom)};H.draw(T,C.TRIANGLES,M,pn.disabled,I,nn.backCCW,oe,ie,"terrain",z.vertexBuffer,z.indexBuffer,z.segments),w.coordsIndex.push(Q.tileID.key)}T.bindFramebuffer.set(null),T.viewport.set([0,0,m.width,m.height])}(this,this.style.map.terrain))}renderLayer(n,a,h,d){if(!h.isHidden(this.transform.zoom)&&(h.type==="background"||h.type==="custom"||(d||[]).length))switch(this.id=h.id,h.type){case"symbol":(function(m,w,T,C,I){if(m.renderPass!=="translucent")return;const M=pn.disabled,z=m.colorModeForRenderPass();(T._unevaluatedLayout.hasValue("text-variable-anchor")||T._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function($,G,H,Q,ie,oe,le,K,he){const fe=G.transform,ve=Cs(),Me=ie==="map",De=oe==="map";for(const Ze of $){const Ye=Q.getTile(Ze),Ue=Ye.getBucket(H);if(!Ue||!Ue.text||!Ue.text.segments.get().length)continue;const je=u.ag(Ue.textSizeData,fe.zoom),it=Dt(Ye,1,G.transform.zoom),St=ns(Ze.posMatrix,De,Me,G.transform,it),Ge=H.layout.get("icon-text-fit")!=="none"&&Ue.hasIconData();if(je){const Ke=Math.pow(2,fe.zoom-Ye.tileID.overscaledZ),xt=G.style.map.terrain?(Pt,Ft)=>G.style.map.terrain.getElevation(Ze,Pt,Ft):null,xn=ve.translatePosition(fe,Ye,le,K);aa(Ue,Me,De,he,fe,St,Ze.posMatrix,Ke,je,Ge,ve,xn,Ze.toUnwrapped(),xt)}}}(C,m,T,w,T.layout.get("text-rotation-alignment"),T.layout.get("text-pitch-alignment"),T.paint.get("text-translate"),T.paint.get("text-translate-anchor"),I),T.paint.get("icon-opacity").constantOr(1)!==0&&ah(m,w,T,C,!1,T.paint.get("icon-translate"),T.paint.get("icon-translate-anchor"),T.layout.get("icon-rotation-alignment"),T.layout.get("icon-pitch-alignment"),T.layout.get("icon-keep-upright"),M,z),T.paint.get("text-opacity").constantOr(1)!==0&&ah(m,w,T,C,!0,T.paint.get("text-translate"),T.paint.get("text-translate-anchor"),T.layout.get("text-rotation-alignment"),T.layout.get("text-pitch-alignment"),T.layout.get("text-keep-upright"),M,z),w.map.showCollisionBoxes&&(al(m,w,T,C,!0),al(m,w,T,C,!1))})(n,a,h,d,this.style.placement.variableOffsets);break;case"circle":(function(m,w,T,C){if(m.renderPass!=="translucent")return;const I=T.paint.get("circle-opacity"),M=T.paint.get("circle-stroke-width"),z=T.paint.get("circle-stroke-opacity"),$=!T.layout.get("circle-sort-key").isConstant();if(I.constantOr(1)===0&&(M.constantOr(1)===0||z.constantOr(1)===0))return;const G=m.context,H=G.gl,Q=m.depthModeForSublayer(0,Rt.ReadOnly),ie=pn.disabled,oe=m.colorModeForRenderPass(),le=[];for(let K=0;K<C.length;K++){const he=C[K],fe=w.getTile(he),ve=fe.getBucket(T);if(!ve)continue;const Me=ve.programConfigurations.get(T.id),De=m.useProgram("circle",Me),Ze=ve.layoutVertexBuffer,Ye=ve.indexBuffer,Ue=m.style.map.terrain&&m.style.map.terrain.getTerrainData(he),je={programConfiguration:Me,program:De,layoutVertexBuffer:Ze,indexBuffer:Ye,uniformValues:jg(m,he,fe,T),terrainData:Ue};if($){const it=ve.segments.get();for(const St of it)le.push({segments:new u.a0([St]),sortKey:St.sortKey,state:je})}else le.push({segments:ve.segments,sortKey:0,state:je})}$&&le.sort((K,he)=>K.sortKey-he.sortKey);for(const K of le){const{programConfiguration:he,program:fe,layoutVertexBuffer:ve,indexBuffer:Me,uniformValues:De,terrainData:Ze}=K.state;fe.draw(G,H.TRIANGLES,Q,ie,oe,nn.disabled,De,Ze,T.id,ve,Me,K.segments,T.paint,m.transform.zoom,he)}})(n,a,h,d);break;case"heatmap":(function(m,w,T,C){if(T.paint.get("heatmap-opacity")===0)return;const I=m.context;if(m.style.map.terrain){for(const M of C){const z=w.getTile(M);w.hasRenderableParent(M)||(m.renderPass==="offscreen"?ch(m,z,T,M):m.renderPass==="translucent"&&Ls(m,T,M))}I.viewport.set([0,0,m.width,m.height])}else m.renderPass==="offscreen"?function(M,z,$,G){const H=M.context,Q=H.gl,ie=pn.disabled,oe=new Dn([Q.ONE,Q.ONE],u.aM.transparent,[!0,!0,!0,!0]);(function(le,K,he){const fe=le.gl;le.activeTexture.set(fe.TEXTURE1),le.viewport.set([0,0,K.width/4,K.height/4]);let ve=he.heatmapFbos.get(u.aU);ve?(fe.bindTexture(fe.TEXTURE_2D,ve.colorAttachment.get()),le.bindFramebuffer.set(ve.framebuffer)):(ve=cl(le,K.width/4,K.height/4),he.heatmapFbos.set(u.aU,ve))})(H,M,$),H.clear({color:u.aM.transparent});for(let le=0;le<G.length;le++){const K=G[le];if(z.hasRenderableParent(K))continue;const he=z.getTile(K),fe=he.getBucket($);if(!fe)continue;const ve=fe.programConfigurations.get($.id),Me=M.useProgram("heatmap",ve),{zoom:De}=M.transform;Me.draw(H,Q.TRIANGLES,Rt.disabled,ie,oe,nn.disabled,Hr(K.posMatrix,he,De,$.paint.get("heatmap-intensity")),null,$.id,fe.layoutVertexBuffer,fe.indexBuffer,fe.segments,$.paint,M.transform.zoom,ve)}H.viewport.set([0,0,M.width,M.height])}(m,w,T,C):m.renderPass==="translucent"&&function(M,z){const $=M.context,G=$.gl;$.setColorMode(M.colorModeForRenderPass());const H=z.heatmapFbos.get(u.aU);H&&($.activeTexture.set(G.TEXTURE0),G.bindTexture(G.TEXTURE_2D,H.colorAttachment.get()),$.activeTexture.set(G.TEXTURE1),ul($,z).bind(G.LINEAR,G.CLAMP_TO_EDGE),M.useProgram("heatmapTexture").draw($,G.TRIANGLES,Rt.disabled,pn.disabled,M.colorModeForRenderPass(),nn.disabled,tc(M,z,0,1),null,z.id,M.viewportBuffer,M.quadTriangleIndexBuffer,M.viewportSegments,z.paint,M.transform.zoom))}(m,T)})(n,a,h,d);break;case"line":(function(m,w,T,C){if(m.renderPass!=="translucent")return;const I=T.paint.get("line-opacity"),M=T.paint.get("line-width");if(I.constantOr(1)===0||M.constantOr(1)===0)return;const z=m.depthModeForSublayer(0,Rt.ReadOnly),$=m.colorModeForRenderPass(),G=T.paint.get("line-dasharray"),H=T.paint.get("line-pattern"),Q=H.constantOr(1),ie=T.paint.get("line-gradient"),oe=T.getCrossfadeParameters(),le=Q?"linePattern":G?"lineSDF":ie?"lineGradient":"line",K=m.context,he=K.gl;let fe=!0;for(const ve of C){const Me=w.getTile(ve);if(Q&&!Me.patternsLoaded())continue;const De=Me.getBucket(T);if(!De)continue;const Ze=De.programConfigurations.get(T.id),Ye=m.context.program.get(),Ue=m.useProgram(le,Ze),je=fe||Ue.program!==Ye,it=m.style.map.terrain&&m.style.map.terrain.getTerrainData(ve),St=H.constantOr(null);if(St&&Me.imageAtlas){const xt=Me.imageAtlas,xn=xt.patternPositions[St.to.toString()],Pt=xt.patternPositions[St.from.toString()];xn&&Pt&&Ze.setConstantPatternPositions(xn,Pt)}const Ge=it?ve:null,Ke=Q?oa(m,Me,T,oe,Ge):G?Ug(m,Me,T,G,oe,Ge):ie?up(m,Me,T,De.lineClipsArray.length,Ge):rc(m,Me,T,Ge);if(Q)K.activeTexture.set(he.TEXTURE0),Me.imageAtlasTexture.bind(he.LINEAR,he.CLAMP_TO_EDGE),Ze.updatePaintBuffers(oe);else if(G&&(je||m.lineAtlas.dirty))K.activeTexture.set(he.TEXTURE0),m.lineAtlas.bind(K);else if(ie){const xt=De.gradients[T.id];let xn=xt.texture;if(T.gradientVersion!==xt.version){let Pt=256;if(T.stepInterpolant){const Ft=w.getSource().maxzoom,bn=ve.canonical.z===Ft?Math.ceil(1<<m.transform.maxZoom-ve.canonical.z):1;Pt=u.ac(u.aV(De.maxLineLength/u.X*1024*bn),256,K.maxTextureSize)}xt.gradient=u.aW({expression:T.gradientExpression(),evaluationKey:"lineProgress",resolution:Pt,image:xt.gradient||void 0,clips:De.lineClipsArray}),xt.texture?xt.texture.update(xt.gradient):xt.texture=new He(K,xt.gradient,he.RGBA),xt.version=T.gradientVersion,xn=xt.texture}K.activeTexture.set(he.TEXTURE0),xn.bind(T.stepInterpolant?he.NEAREST:he.LINEAR,he.CLAMP_TO_EDGE)}Ue.draw(K,he.TRIANGLES,z,m.stencilModeForClipping(ve),$,nn.disabled,Ke,it,T.id,De.layoutVertexBuffer,De.indexBuffer,De.segments,T.paint,m.transform.zoom,Ze,De.layoutVertexBuffer2),fe=!1}})(n,a,h,d);break;case"fill":(function(m,w,T,C){const I=T.paint.get("fill-color"),M=T.paint.get("fill-opacity");if(M.constantOr(1)===0)return;const z=m.colorModeForRenderPass(),$=T.paint.get("fill-pattern"),G=m.opaquePassEnabledForLayer()&&!$.constantOr(1)&&I.constantOr(u.aM.transparent).a===1&&M.constantOr(0)===1?"opaque":"translucent";if(m.renderPass===G){const H=m.depthModeForSublayer(1,m.renderPass==="opaque"?Rt.ReadWrite:Rt.ReadOnly);hl(m,w,T,C,H,z,!1)}if(m.renderPass==="translucent"&&T.paint.get("fill-antialias")){const H=m.depthModeForSublayer(T.getPaintProperty("fill-outline-color")?2:0,Rt.ReadOnly);hl(m,w,T,C,H,z,!0)}})(n,a,h,d);break;case"fill-extrusion":(function(m,w,T,C){const I=T.paint.get("fill-extrusion-opacity");if(I!==0&&m.renderPass==="translucent"){const M=new Rt(m.context.gl.LEQUAL,Rt.ReadWrite,m.depthRangeFor3D);if(I!==1||T.paint.get("fill-extrusion-pattern").constantOr(1))uc(m,w,T,C,M,pn.disabled,Dn.disabled),uc(m,w,T,C,M,m.stencilModeFor3D(),m.colorModeForRenderPass());else{const z=m.colorModeForRenderPass();uc(m,w,T,C,M,pn.disabled,z)}}})(n,a,h,d);break;case"hillshade":(function(m,w,T,C){if(m.renderPass!=="offscreen"&&m.renderPass!=="translucent")return;const I=m.context,M=m.depthModeForSublayer(0,Rt.ReadOnly),z=m.colorModeForRenderPass(),[$,G]=m.renderPass==="translucent"?m.stencilConfigForOverlap(C):[{},C];for(const H of G){const Q=w.getTile(H);Q.needsHillshadePrepare!==void 0&&Q.needsHillshadePrepare&&m.renderPass==="offscreen"?ua(m,Q,T,M,pn.disabled,z):m.renderPass==="translucent"&&ca(m,H,Q,T,M,$[H.overscaledZ],z)}I.viewport.set([0,0,m.width,m.height])})(n,a,h,d);break;case"raster":(function(m,w,T,C){if(m.renderPass!=="translucent"||T.paint.get("raster-opacity")===0||!C.length)return;const I=m.context,M=I.gl,z=w.getSource(),$=m.useProgram("raster"),G=m.colorModeForRenderPass(),[H,Q]=z instanceof Oi?[{},C]:m.stencilConfigForOverlap(C),ie=Q[Q.length-1].overscaledZ,oe=!m.options.moving;for(const le of Q){const K=m.depthModeForSublayer(le.overscaledZ-ie,T.paint.get("raster-opacity")===1?Rt.ReadWrite:Rt.ReadOnly,M.LESS),he=w.getTile(le);he.registerFadeDuration(T.paint.get("raster-fade-duration"));const fe=w.findLoadedParent(le,0),ve=w.findLoadedSibling(le),Me=kp(he,fe||ve||null,w,T,m.transform,m.style.map.terrain);let De,Ze;const Ye=T.paint.get("raster-resampling")==="nearest"?M.NEAREST:M.LINEAR;I.activeTexture.set(M.TEXTURE0),he.texture.bind(Ye,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST),I.activeTexture.set(M.TEXTURE1),fe?(fe.texture.bind(Ye,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST),De=Math.pow(2,fe.tileID.overscaledZ-he.tileID.overscaledZ),Ze=[he.tileID.canonical.x*De%1,he.tileID.canonical.y*De%1]):he.texture.bind(Ye,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST),he.texture.useMipmap&&I.extTextureFilterAnisotropic&&m.transform.pitch>20&&M.texParameterf(M.TEXTURE_2D,I.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,I.extTextureFilterAnisotropicMax);const Ue=m.style.map.terrain&&m.style.map.terrain.getTerrainData(le),je=Ue?le:null,it=je?je.posMatrix:m.transform.calculatePosMatrix(le.toUnwrapped(),oe),St=Vg(it,Ze||[0,0],De||1,Me,T);z instanceof Oi?$.draw(I,M.TRIANGLES,K,pn.disabled,G,nn.disabled,St,Ue,T.id,z.boundsBuffer,m.quadTriangleIndexBuffer,z.boundsSegments):$.draw(I,M.TRIANGLES,K,H[le.overscaledZ],G,nn.disabled,St,Ue,T.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments)}})(n,a,h,d);break;case"background":(function(m,w,T,C){const I=T.paint.get("background-color"),M=T.paint.get("background-opacity");if(M===0)return;const z=m.context,$=z.gl,G=m.transform,H=G.tileSize,Q=T.paint.get("background-pattern");if(m.isPatternMissing(Q))return;const ie=!Q&&I.a===1&&M===1&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==ie)return;const oe=pn.disabled,le=m.depthModeForSublayer(0,ie==="opaque"?Rt.ReadWrite:Rt.ReadOnly),K=m.colorModeForRenderPass(),he=m.useProgram(Q?"backgroundPattern":"background"),fe=C||G.coveringTiles({tileSize:H,terrain:m.style.map.terrain});Q&&(z.activeTexture.set($.TEXTURE0),m.imageManager.bind(m.context));const ve=T.getCrossfadeParameters();for(const Me of fe){const De=C?Me.posMatrix:m.transform.calculatePosMatrix(Me.toUnwrapped()),Ze=Q?Xu(De,M,m,Q,{tileID:Me,tileSize:H},ve):ic(De,M,I),Ye=m.style.map.terrain&&m.style.map.terrain.getTerrainData(Me);he.draw(z,$.TRIANGLES,le,oe,K,nn.disabled,Ze,Ye,T.id,m.tileExtentBuffer,m.quadTriangleIndexBuffer,m.tileExtentSegments)}})(n,0,h,d);break;case"custom":(function(m,w,T){const C=m.context,I=T.implementation;if(m.renderPass==="offscreen"){const M=I.prerender;M&&(m.setCustomLayerDefaults(),C.setColorMode(m.colorModeForRenderPass()),M.call(I,C.gl,m.transform.customLayerMatrix()),C.setDirty(),m.setBaseState())}else if(m.renderPass==="translucent"){m.setCustomLayerDefaults(),C.setColorMode(m.colorModeForRenderPass()),C.setStencilMode(pn.disabled);const M=I.renderingMode==="3d"?new Rt(m.context.gl.LEQUAL,Rt.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,Rt.ReadOnly);C.setDepthMode(M),I.render(C.gl,m.transform.customLayerMatrix(),{farZ:m.transform.farZ,nearZ:m.transform.nearZ,fov:m.transform._fov,modelViewProjectionMatrix:m.transform.modelViewProjectionMatrix,projectionMatrix:m.transform.projectionMatrix}),C.setDirty(),m.setBaseState(),C.bindFramebuffer.set(null)}})(n,0,h)}}translatePosMatrix(n,a,h,d,m){if(!h[0]&&!h[1])return n;const w=m?d==="map"?this.transform.angle:0:d==="viewport"?-this.transform.angle:0;if(w){const I=Math.sin(w),M=Math.cos(w);h=[h[0]*M-h[1]*I,h[0]*I+h[1]*M]}const T=[m?h[0]:Dt(a,h[0],this.transform.zoom),m?h[1]:Dt(a,h[1],this.transform.zoom),0],C=new Float32Array(16);return u.J(C,n,T),C}saveTileTexture(n){const a=this._tileTextures[n.size[0]];a?a.push(n):this._tileTextures[n.size[0]]=[n]}getTileTexture(n){const a=this._tileTextures[n];return a&&a.length>0?a.pop():null}isPatternMissing(n){if(!n)return!1;if(!n.from||!n.to)return!0;const a=this.imageManager.getPattern(n.from.toString()),h=this.imageManager.getPattern(n.to.toString());return!a||!h}useProgram(n,a){this.cache=this.cache||{};const h=n+(a?a.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[h]||(this.cache[h]=new Wu(this.context,rs[n],a,Yu[n],this._showOverdrawInspector,this.style.map.terrain)),this.cache[h]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new He(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:n,drawingBufferHeight:a}=this.context.gl;return this.width!==n||this.height!==a}}class da{constructor(n,a){this.points=n,this.planes=a}static fromInvProjectionMatrix(n,a,h){const d=Math.pow(2,h),m=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(T=>{const C=1/(T=u.af([],T,n))[3]/a*d;return u.b1(T,T,[C,C,1/T[3],C])}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(T=>{const C=function($,G){var H=G[0],Q=G[1],ie=G[2],oe=H*H+Q*Q+ie*ie;return oe>0&&(oe=1/Math.sqrt(oe)),$[0]=G[0]*oe,$[1]=G[1]*oe,$[2]=G[2]*oe,$}([],function($,G,H){var Q=G[0],ie=G[1],oe=G[2],le=H[0],K=H[1],he=H[2];return $[0]=ie*he-oe*K,$[1]=oe*le-Q*he,$[2]=Q*K-ie*le,$}([],xe([],m[T[0]],m[T[1]]),xe([],m[T[2]],m[T[1]]))),I=-((M=C)[0]*(z=m[T[1]])[0]+M[1]*z[1]+M[2]*z[2]);var M,z;return C.concat(I)});return new da(m,w)}}class pa{constructor(n,a){this.min=n,this.max=a,this.center=function(h,d,m){return h[0]=.5*d[0],h[1]=.5*d[1],h[2]=.5*d[2],h}([],function(h,d,m){return h[0]=d[0]+m[0],h[1]=d[1]+m[1],h[2]=d[2]+m[2],h}([],this.min,this.max))}quadrant(n){const a=[n%2==0,n<2],h=_e(this.min),d=_e(this.max);for(let m=0;m<a.length;m++)h[m]=a[m]?this.min[m]:this.center[m],d[m]=a[m]?this.center[m]:this.max[m];return d[2]=this.max[2],new pa(h,d)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}intersects(n){const a=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let h=!0;for(let d=0;d<n.planes.length;d++){const m=n.planes[d];let w=0;for(let T=0;T<a.length;T++)u.b2(m,a[T])>=0&&w++;if(w===0)return 0;w!==a.length&&(h=!1)}if(h)return 2;for(let d=0;d<3;d++){let m=Number.MAX_VALUE,w=-Number.MAX_VALUE;for(let T=0;T<n.points.length;T++){const C=n.points[T][d]-this.min[d];m=Math.min(m,C),w=Math.max(w,C)}if(w<0||m>this.max[d]-this.min[d])return 0}return 1}}class fa{constructor(n=0,a=0,h=0,d=0){if(isNaN(n)||n<0||isNaN(a)||a<0||isNaN(h)||h<0||isNaN(d)||d<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=a,this.left=h,this.right=d}interpolate(n,a,h){return a.top!=null&&n.top!=null&&(this.top=u.y.number(n.top,a.top,h)),a.bottom!=null&&n.bottom!=null&&(this.bottom=u.y.number(n.bottom,a.bottom,h)),a.left!=null&&n.left!=null&&(this.left=u.y.number(n.left,a.left,h)),a.right!=null&&n.right!=null&&(this.right=u.y.number(n.right,a.right,h)),this}getCenter(n,a){const h=u.ac((this.left+n-this.right)/2,0,n),d=u.ac((this.top+a-this.bottom)/2,0,a);return new u.P(h,d)}equals(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right}clone(){return new fa(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const hh=85.051129;class ma{constructor(n,a,h,d,m){this.tileSize=512,this._renderWorldCopies=m===void 0||!!m,this._minZoom=n||0,this._maxZoom=a||22,this._minPitch=h??0,this._maxPitch=d??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new u.N(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new fa,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={},this.minElevationForCurrentTile=0}clone(){const n=new ma(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return n.apply(this),n}apply(n){this.tileSize=n.tileSize,this.latRange=n.latRange,this.lngRange=n.lngRange,this.width=n.width,this.height=n.height,this._center=n._center,this._elevation=n._elevation,this.minElevationForCurrentTile=n.minElevationForCurrentTile,this.zoom=n.zoom,this.angle=n.angle,this._fov=n._fov,this._pitch=n._pitch,this._unmodified=n._unmodified,this._edgeInsets=n._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))}get maxZoom(){return this._maxZoom}set maxZoom(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))}get minPitch(){return this._minPitch}set minPitch(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))}get maxPitch(){return this._maxPitch}set maxPitch(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new u.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(n){const a=-u.b3(n,-180,180)*Math.PI/180;this.angle!==a&&(this._unmodified=!1,this.angle=a,this._calcMatrices(),this.rotationMatrix=function(){var h=new u.A(4);return u.A!=Float32Array&&(h[1]=0,h[2]=0),h[0]=1,h[3]=1,h}(),function(h,d,m){var w=d[0],T=d[1],C=d[2],I=d[3],M=Math.sin(m),z=Math.cos(m);h[0]=w*z+C*M,h[1]=T*z+I*M,h[2]=w*-M+C*z,h[3]=T*-M+I*z}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(n){const a=u.ac(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==a&&(this._unmodified=!1,this._pitch=a,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=n/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(n){const a=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this.tileZoom=Math.max(0,Math.floor(a)),this.scale=this.zoomScale(a),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(n){n!==this._elevation&&(this._elevation=n,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(n){return this._edgeInsets.equals(n)}interpolatePadding(n,a,h){this._unmodified=!1,this._edgeInsets.interpolate(n,a,h),this._constrain(),this._calcMatrices()}coveringZoomLevel(n){const a=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,a)}getVisibleUnwrappedCoordinates(n){const a=[new u.b4(0,n)];if(this._renderWorldCopies){const h=this.pointCoordinate(new u.P(0,0)),d=this.pointCoordinate(new u.P(this.width,0)),m=this.pointCoordinate(new u.P(this.width,this.height)),w=this.pointCoordinate(new u.P(0,this.height)),T=Math.floor(Math.min(h.x,d.x,m.x,w.x)),C=Math.floor(Math.max(h.x,d.x,m.x,w.x)),I=1;for(let M=T-I;M<=C+I;M++)M!==0&&a.push(new u.b4(M,n))}return a}coveringTiles(n){var a,h;let d=this.coveringZoomLevel(n);const m=d;if(n.minzoom!==void 0&&d<n.minzoom)return[];n.maxzoom!==void 0&&d>n.maxzoom&&(d=n.maxzoom);const w=this.pointCoordinate(this.getCameraPoint()),T=u.Z.fromLngLat(this.center),C=Math.pow(2,d),I=[C*w.x,C*w.y,0],M=[C*T.x,C*T.y,0],z=da.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,d);let $=n.minzoom||0;!n.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&($=d);const G=n.terrain?2/Math.min(this.tileSize,n.tileSize)*this.tileSize:3,H=K=>({aabb:new pa([K*C,0,0],[(K+1)*C,C,0]),zoom:0,x:0,y:0,wrap:K,fullyVisible:!1}),Q=[],ie=[],oe=d,le=n.reparseOverscaled?m:d;if(this._renderWorldCopies)for(let K=1;K<=3;K++)Q.push(H(-K)),Q.push(H(K));for(Q.push(H(0));Q.length>0;){const K=Q.pop(),he=K.x,fe=K.y;let ve=K.fullyVisible;if(!ve){const Ue=K.aabb.intersects(z);if(Ue===0)continue;ve=Ue===2}const Me=n.terrain?I:M,De=K.aabb.distanceX(Me),Ze=K.aabb.distanceY(Me),Ye=Math.max(Math.abs(De),Math.abs(Ze));if(K.zoom===oe||Ye>G+(1<<oe-K.zoom)-2&&K.zoom>=$){const Ue=oe-K.zoom,je=I[0]-.5-(he<<Ue),it=I[1]-.5-(fe<<Ue);ie.push({tileID:new u.S(K.zoom===oe?le:K.zoom,K.wrap,K.zoom,he,fe),distanceSq:Re([M[0]-.5-he,M[1]-.5-fe]),tileDistanceToCamera:Math.sqrt(je*je+it*it)})}else for(let Ue=0;Ue<4;Ue++){const je=(he<<1)+Ue%2,it=(fe<<1)+(Ue>>1),St=K.zoom+1;let Ge=K.aabb.quadrant(Ue);if(n.terrain){const Ke=new u.S(St,K.wrap,St,je,it),xt=n.terrain.getMinMaxElevation(Ke),xn=(a=xt.minElevation)!==null&&a!==void 0?a:this.elevation,Pt=(h=xt.maxElevation)!==null&&h!==void 0?h:this.elevation;Ge=new pa([Ge.min[0],Ge.min[1],xn],[Ge.max[0],Ge.max[1],Pt])}Q.push({aabb:Ge,zoom:St,x:je,y:it,wrap:K.wrap,fullyVisible:ve})}}return ie.sort((K,he)=>K.distanceSq-he.distanceSq).map(K=>K.tileID)}resize(n,a){this.width=n,this.height=a,this.pixelsToGLUnits=[2/n,-2/a],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(n){return Math.pow(2,n)}scaleZoom(n){return Math.log(n)/Math.LN2}project(n){const a=u.ac(n.lat,-85.051129,hh);return new u.P(u.O(n.lng)*this.worldSize,u.Q(a)*this.worldSize)}unproject(n){return new u.Z(n.x/this.worldSize,n.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(n){const a=this.elevation,h=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,d=this.pointLocation(this.centerPoint,n),m=n.getElevationForLngLatZoom(d,this.tileZoom);if(!(this.elevation-m))return;const w=h+a-m,T=Math.cos(this._pitch)*this.cameraToCenterDistance/w/u.b5(1,d.lat),C=this.scaleZoom(T/this.tileSize);this._elevation=m,this._center=d,this.zoom=C}setLocationAtPoint(n,a){const h=this.pointCoordinate(a),d=this.pointCoordinate(this.centerPoint),m=this.locationCoordinate(n),w=new u.Z(m.x-(h.x-d.x),m.y-(h.y-d.y));this.center=this.coordinateLocation(w),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(n,a){return a?this.coordinatePoint(this.locationCoordinate(n),a.getElevationForLngLatZoom(n,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(n))}pointLocation(n,a){return this.coordinateLocation(this.pointCoordinate(n,a))}locationCoordinate(n){return u.Z.fromLngLat(n)}coordinateLocation(n){return n&&n.toLngLat()}pointCoordinate(n,a){if(a){const $=a.pointCoordinate(n);if($!=null)return $}const h=[n.x,n.y,0,1],d=[n.x,n.y,1,1];u.af(h,h,this.pixelMatrixInverse),u.af(d,d,this.pixelMatrixInverse);const m=h[3],w=d[3],T=h[1]/m,C=d[1]/w,I=h[2]/m,M=d[2]/w,z=I===M?0:(0-I)/(M-I);return new u.Z(u.y.number(h[0]/m,d[0]/w,z)/this.worldSize,u.y.number(T,C,z)/this.worldSize)}coordinatePoint(n,a=0,h=this.pixelMatrix){const d=[n.x*this.worldSize,n.y*this.worldSize,a,1];return u.af(d,d,h),new u.P(d[0]/d[3],d[1]/d[3])}getBounds(){const n=Math.max(0,this.height/2-this.getHorizon());return new Se().extend(this.pointLocation(new u.P(0,n))).extend(this.pointLocation(new u.P(this.width,n))).extend(this.pointLocation(new u.P(this.width,this.height))).extend(this.pointLocation(new u.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new Se([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(n){n?(this.lngRange=[n.getWest(),n.getEast()],this.latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,hh])}calculateTileMatrix(n){const a=n.canonical,h=this.worldSize/this.zoomScale(a.z),d=a.x+Math.pow(2,a.z)*n.wrap,m=u.an(new Float64Array(16));return u.J(m,m,[d*h,a.y*h,0]),u.K(m,m,[h/u.X,h/u.X,1]),m}calculatePosMatrix(n,a=!1){const h=n.key,d=a?this._alignedPosMatrixCache:this._posMatrixCache;if(d[h])return d[h];const m=this.calculateTileMatrix(n);return u.L(m,a?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,m),d[h]=new Float32Array(m),d[h]}calculateFogMatrix(n){const a=n.key,h=this._fogMatrixCache;if(h[a])return h[a];const d=this.calculateTileMatrix(n);return u.L(d,this.fogMatrix,d),h[a]=new Float32Array(d),h[a]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(n,a){a=u.ac(+a,this.minZoom,this.maxZoom);const h={center:new u.N(n.lng,n.lat),zoom:a};let d=this.lngRange;if(!this._renderWorldCopies&&d===null){const K=179.9999999999;d=[-K,K]}const m=this.tileSize*this.zoomScale(h.zoom);let w=0,T=m,C=0,I=m,M=0,z=0;const{x:$,y:G}=this.size;if(this.latRange){const K=this.latRange;w=u.Q(K[1])*m,T=u.Q(K[0])*m,T-w<G&&(M=G/(T-w))}d&&(C=u.b3(u.O(d[0])*m,0,m),I=u.b3(u.O(d[1])*m,0,m),I<C&&(I+=m),I-C<$&&(z=$/(I-C)));const{x:H,y:Q}=this.project.call({worldSize:m},n);let ie,oe;const le=Math.max(z||0,M||0);if(le){const K=new u.P(z?(I+C)/2:H,M?(T+w)/2:Q);return h.center=this.unproject.call({worldSize:m},K).wrap(),h.zoom+=this.scaleZoom(le),h}if(this.latRange){const K=G/2;Q-K<w&&(oe=w+K),Q+K>T&&(oe=T-K)}if(d){const K=(C+I)/2;let he=H;this._renderWorldCopies&&(he=u.b3(H,K-m/2,K+m/2));const fe=$/2;he-fe<C&&(ie=C+fe),he+fe>I&&(ie=I-fe)}if(ie!==void 0||oe!==void 0){const K=new u.P(ie??H,oe??Q);h.center=this.unproject.call({worldSize:m},K).wrap()}return h}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const n=this._unmodified,{center:a,zoom:h}=this.getConstrained(this.center,this.zoom);this.center=a,this.zoom=h,this._unmodified=n,this._constraining=!1}_calcMatrices(){if(!this.height)return;const n=this.centerOffset,a=this.point.x,h=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=u.b5(1,this.center.lat)*this.worldSize;let d=u.an(new Float64Array(16));u.K(d,d,[this.width/2,-this.height/2,1]),u.J(d,d,[1,-1,0]),this.labelPlaneMatrix=d,d=u.an(new Float64Array(16)),u.K(d,d,[1,-1,1]),u.J(d,d,[-1,-1,0]),u.K(d,d,[2/this.width,2/this.height,1]),this.glCoordMatrix=d;const m=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),w=Math.min(this.elevation,this.minElevationForCurrentTile),T=m-w*this._pixelPerMeter/Math.cos(this._pitch),C=w<0?T:m,I=Math.PI/2+this._pitch,M=this._fov*(.5+n.y/this.height),z=Math.sin(M)*C/Math.sin(u.ac(Math.PI-I-M,.01,Math.PI-.01)),$=this.getHorizon(),G=2*Math.atan($/this.cameraToCenterDistance)*(.5+n.y/(2*$)),H=Math.sin(G)*C/Math.sin(u.ac(Math.PI-I-G,.01,Math.PI-.01)),Q=Math.min(z,H);this.farZ=1.01*(Math.cos(Math.PI/2-this._pitch)*Q+C),this.nearZ=this.height/50,d=new Float64Array(16),u.b6(d,this._fov,this.width/this.height,this.nearZ,this.farZ),d[8]=2*-n.x/this.width,d[9]=2*n.y/this.height,this.projectionMatrix=u.ae(d),u.K(d,d,[1,-1,1]),u.J(d,d,[0,0,-this.cameraToCenterDistance]),u.b7(d,d,this._pitch),u.ad(d,d,this.angle),u.J(d,d,[-a,-h,0]),this.mercatorMatrix=u.K([],d,[this.worldSize,this.worldSize,this.worldSize]),u.K(d,d,[1,1,this._pixelPerMeter]),this.pixelMatrix=u.L(new Float64Array(16),this.labelPlaneMatrix,d),u.J(d,d,[0,0,-this.elevation]),this.modelViewProjectionMatrix=d,this.invModelViewProjectionMatrix=u.as([],d),this.fogMatrix=new Float64Array(16),u.b6(this.fogMatrix,this._fov,this.width/this.height,m,this.farZ),this.fogMatrix[8]=2*-n.x/this.width,this.fogMatrix[9]=2*n.y/this.height,u.K(this.fogMatrix,this.fogMatrix,[1,-1,1]),u.J(this.fogMatrix,this.fogMatrix,[0,0,-this.cameraToCenterDistance]),u.b7(this.fogMatrix,this.fogMatrix,this._pitch),u.ad(this.fogMatrix,this.fogMatrix,this.angle),u.J(this.fogMatrix,this.fogMatrix,[-a,-h,0]),u.K(this.fogMatrix,this.fogMatrix,[1,1,this._pixelPerMeter]),u.J(this.fogMatrix,this.fogMatrix,[0,0,-this.elevation]),this.pixelMatrix3D=u.L(new Float64Array(16),this.labelPlaneMatrix,d);const ie=this.width%2/2,oe=this.height%2/2,le=Math.cos(this.angle),K=Math.sin(this.angle),he=a-Math.round(a)+le*ie+K*oe,fe=h-Math.round(h)+le*oe+K*ie,ve=new Float64Array(d);if(u.J(ve,ve,[he>.5?he-1:he,fe>.5?fe-1:fe,0]),this.alignedModelViewProjectionMatrix=ve,d=u.as(new Float64Array(16),this.pixelMatrix),!d)throw new Error("failed to invert matrix");this.pixelMatrixInverse=d,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const n=this.pointCoordinate(new u.P(0,0)),a=[n.x*this.worldSize,n.y*this.worldSize,0,1];return u.af(a,a,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new u.P(0,n))}getCameraQueryGeometry(n){const a=this.getCameraPoint();if(n.length===1)return[n[0],a];{let h=a.x,d=a.y,m=a.x,w=a.y;for(const T of n)h=Math.min(h,T.x),d=Math.min(d,T.y),m=Math.max(m,T.x),w=Math.max(w,T.y);return[new u.P(h,d),new u.P(m,d),new u.P(m,w),new u.P(h,w),new u.P(h,d)]}}lngLatToCameraDepth(n,a){const h=this.locationCoordinate(n),d=[h.x*this.worldSize,h.y*this.worldSize,a,1];return u.af(d,d,this.modelViewProjectionMatrix),d[2]/d[3]}}function dl(g,n){let a,h=!1,d=null,m=null;const w=()=>{d=null,h&&(g.apply(m,a),d=setTimeout(w,n),h=!1)};return(...T)=>(h=!0,m=this,a=T,d||w(),d)}class mc{constructor(n){this._getCurrentHash=()=>{const a=window.location.hash.replace("#","");if(this._hashName){let h;return a.split("&").map(d=>d.split("=")).forEach(d=>{d[0]===this._hashName&&(h=d)}),(h&&h[1]||"").split("/")}return a.split("/")},this._onHashChange=()=>{const a=this._getCurrentHash();if(a.length>=3&&!a.some(h=>isNaN(h))){const h=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(a[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:h,pitch:+(a[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const a=window.location.href.replace(/(#.+)?$/,this.getHashString());window.history.replaceState(window.history.state,null,a)},this._removeHash=()=>{const a=this._getCurrentHash();if(a.length===0)return;const h=a.join("/");let d=h;d.split("&").length>0&&(d=d.split("&")[0]),this._hashName&&(d=`${this._hashName}=${h}`);let m=window.location.hash.replace(d,"");m.startsWith("#&")?m=m.slice(0,1)+m.slice(2):m==="#"&&(m="");let w=window.location.href.replace(/(#.+)?$/,m);w=w.replace("&&","&"),window.history.replaceState(window.history.state,null,w)},this._updateHash=dl(this._updateHashUnthrottled,300),this._hashName=n&&encodeURIComponent(n)}addTo(n){return this._map=n,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(n){const a=this._map.getCenter(),h=Math.round(100*this._map.getZoom())/100,d=Math.ceil((h*Math.LN2+Math.log(512/360/.5))/Math.LN10),m=Math.pow(10,d),w=Math.round(a.lng*m)/m,T=Math.round(a.lat*m)/m,C=this._map.getBearing(),I=this._map.getPitch();let M="";if(M+=n?`/${w}/${T}/${h}`:`${h}/${T}/${w}`,(C||I)&&(M+="/"+Math.round(10*C)/10),I&&(M+=`/${Math.round(I)}`),this._hashName){const z=this._hashName;let $=!1;const G=window.location.hash.slice(1).split("&").map(H=>{const Q=H.split("=")[0];return Q===z?($=!0,`${Q}=${M}`):H}).filter(H=>H);return $||G.push(`${z}=${M}`),`#${G.join("&")}`}return`#${M}`}}const gc={linearity:.3,easing:u.b8(0,0,.3,1)},dh=u.e({deceleration:2500,maxSpeed:1400},gc),ny=u.e({deceleration:20,maxSpeed:1400},gc),Mp=u.e({deceleration:1e3,maxSpeed:360},gc),yc=u.e({deceleration:1e3,maxSpeed:90},gc);class ph{constructor(n){this._map=n,this.clear()}clear(){this._inertiaBuffer=[]}record(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:N.now(),settings:n})}_drainInertiaBuffer(){const n=this._inertiaBuffer,a=N.now();for(;n.length>0&&a-n[0].time>160;)n.shift()}_onMoveEnd(n){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const a={zoom:0,bearing:0,pitch:0,pan:new u.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:m}of this._inertiaBuffer)a.zoom+=m.zoomDelta||0,a.bearing+=m.bearingDelta||0,a.pitch+=m.pitchDelta||0,m.panDelta&&a.pan._add(m.panDelta),m.around&&(a.around=m.around),m.pinchAround&&(a.pinchAround=m.pinchAround);const h=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,d={};if(a.pan.mag()){const m=fl(a.pan.mag(),h,u.e({},dh,n||{}));d.offset=a.pan.mult(m.amount/a.pan.mag()),d.center=this._map.transform.center,pl(d,m)}if(a.zoom){const m=fl(a.zoom,h,ny);d.zoom=this._map.transform.zoom+m.amount,pl(d,m)}if(a.bearing){const m=fl(a.bearing,h,Mp);d.bearing=this._map.transform.bearing+u.ac(m.amount,-179,179),pl(d,m)}if(a.pitch){const m=fl(a.pitch,h,yc);d.pitch=this._map.transform.pitch+m.amount,pl(d,m)}if(d.zoom||d.bearing){const m=a.pinchAround===void 0?a.around:a.pinchAround;d.around=m?this._map.unproject(m):this._map.getCenter()}return this.clear(),u.e(d,{noMoveStart:!0})}}function pl(g,n){(!g.duration||g.duration<n.duration)&&(g.duration=n.duration,g.easing=n.easing)}function fl(g,n,a){const{maxSpeed:h,linearity:d,deceleration:m}=a,w=u.ac(g*d/(n/1e3),-h,h),T=Math.abs(w)/(m*d);return{easing:a.easing,duration:1e3*T,amount:w*(T/2)}}class _r extends u.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,a,h,d={}){const m=D.mousePos(a.getCanvas(),h),w=a.unproject(m);super(n,u.e({point:m,lngLat:w,originalEvent:h},d)),this._defaultPrevented=!1,this.target=a}}class Rs extends u.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,a,h){const d=n==="touchend"?h.changedTouches:h.touches,m=D.touchPos(a.getCanvasContainer(),d),w=m.map(C=>a.unproject(C)),T=m.reduce((C,I,M,z)=>C.add(I.div(z.length)),new u.P(0,0));super(n,{points:m,point:T,lngLats:w,lngLat:a.unproject(T),originalEvent:h}),this._defaultPrevented=!1}}class zp extends u.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,a,h){super(n,{originalEvent:h}),this._defaultPrevented=!1}}class Lp{constructor(n,a){this._map=n,this._clickTolerance=a.clickTolerance}reset(){delete this._mousedownPos}wheel(n){return this._firePreventable(new zp(n.type,this._map,n))}mousedown(n,a){return this._mousedownPos=a,this._firePreventable(new _r(n.type,this._map,n))}mouseup(n){this._map.fire(new _r(n.type,this._map,n))}click(n,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new _r(n.type,this._map,n))}dblclick(n){return this._firePreventable(new _r(n.type,this._map,n))}mouseover(n){this._map.fire(new _r(n.type,this._map,n))}mouseout(n){this._map.fire(new _r(n.type,this._map,n))}touchstart(n){return this._firePreventable(new Rs(n.type,this._map,n))}touchmove(n){this._map.fire(new Rs(n.type,this._map,n))}touchend(n){this._map.fire(new Rs(n.type,this._map,n))}touchcancel(n){this._map.fire(new Rs(n.type,this._map,n))}_firePreventable(n){if(this._map.fire(n),n.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Fn{constructor(n){this._map=n}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(n){this._map.fire(new _r(n.type,this._map,n))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new _r("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(n){this._delayContextMenu?this._contextMenuEvent=n:this._ignoreContextMenu||this._map.fire(new _r(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class qi{constructor(n){this._map=n}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(n){return this.transform.pointLocation(u.P.convert(n),this._map.terrain)}}class hi{constructor(n,a){this._map=n,this._tr=new qi(n),this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=a.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(n,a){this.isEnabled()&&n.shiftKey&&n.button===0&&(D.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)}mousemoveWindow(n,a){if(!this._active)return;const h=a;if(this._lastPos.equals(h)||!this._box&&h.dist(this._startPos)<this._clickTolerance)return;const d=this._startPos;this._lastPos=h,this._box||(this._box=D.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",n));const m=Math.min(d.x,h.x),w=Math.max(d.x,h.x),T=Math.min(d.y,h.y),C=Math.max(d.y,h.y);D.setTransform(this._box,`translate(${m}px,${T}px)`),this._box.style.width=w-m+"px",this._box.style.height=C-T+"px"}mouseupWindow(n,a){if(!this._active||n.button!==0)return;const h=this._startPos,d=a;if(this.reset(),D.suppressClick(),h.x!==d.x||h.y!==d.y)return this._map.fire(new u.k("boxzoomend",{originalEvent:n})),{cameraAnimation:m=>m.fitScreenCoordinates(h,d,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",n)}keydown(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(D.remove(this._box),this._box=null),D.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(n,a){return this._map.fire(new u.k(n,{originalEvent:a}))}}function ml(g,n){if(g.length!==n.length)throw new Error(`The number of touches and points are not equal - touches ${g.length}, points ${n.length}`);const a={};for(let h=0;h<g.length;h++)a[g[h].identifier]=n[h];return a}class fh{constructor(n){this.reset(),this.numTouches=n.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(n,a,h){(this.centroid||h.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),h.length===this.numTouches&&(this.centroid=function(d){const m=new u.P(0,0);for(const w of d)m._add(w);return m.div(d.length)}(a),this.touches=ml(h,a)))}touchmove(n,a,h){if(this.aborted||!this.centroid)return;const d=ml(h,a);for(const m in this.touches){const w=d[m];(!w||w.dist(this.touches[m])>30)&&(this.aborted=!0)}}touchend(n,a,h){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),h.length===0){const d=!this.aborted&&this.centroid;if(this.reset(),d)return d}}}class _c{constructor(n){this.singleTap=new fh(n),this.numTaps=n.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(n,a,h){this.singleTap.touchstart(n,a,h)}touchmove(n,a,h){this.singleTap.touchmove(n,a,h)}touchend(n,a,h){const d=this.singleTap.touchend(n,a,h);if(d){const m=n.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(d)<30;if(m&&w||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=d,this.count===this.numTaps)return this.reset(),d}}}class ga{constructor(n){this._tr=new qi(n),this._zoomIn=new _c({numTouches:1,numTaps:2}),this._zoomOut=new _c({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(n,a,h){this._zoomIn.touchstart(n,a,h),this._zoomOut.touchstart(n,a,h)}touchmove(n,a,h){this._zoomIn.touchmove(n,a,h),this._zoomOut.touchmove(n,a,h)}touchend(n,a,h){const d=this._zoomIn.touchend(n,a,h),m=this._zoomOut.touchend(n,a,h),w=this._tr;return d?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:w.zoom+1,around:w.unproject(d)},{originalEvent:n})}):m?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:w.zoom-1,around:w.unproject(m)},{originalEvent:n})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Uo{constructor(n){this._enabled=!!n.enable,this._moveStateManager=n.moveStateManager,this._clickTolerance=n.clickTolerance||1,this._moveFunction=n.move,this._activateOnStart=!!n.activateOnStart,n.assignEvents(this),this.reset()}reset(n){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(n)}_move(...n){const a=this._moveFunction(...n);if(a.bearingDelta||a.pitchDelta||a.around||a.panDelta)return this._active=!0,a}dragStart(n,a){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(n)&&(this._moveStateManager.startMove(n),this._lastPoint=a.length?a[0]:a,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(n,a){if(!this.isEnabled())return;const h=this._lastPoint;if(!h)return;if(n.preventDefault(),!this._moveStateManager.isValidMoveEvent(n))return void this.reset(n);const d=a.length?a[0]:a;return!this._moved&&d.dist(h)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=d,this._move(h,d))}dragEnd(n){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(n)&&(this._moved&&D.suppressClick(),this.reset(n))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const mh={0:1,2:2};class vc{constructor(n){this._correctEvent=n.checkCorrectEvent}startMove(n){const a=D.mouseButton(n);this._eventButton=a}endMove(n){delete this._eventButton}isValidStartEvent(n){return this._correctEvent(n)}isValidMoveEvent(n){return!function(a,h){const d=mh[h];return a.buttons===void 0||(a.buttons&d)!==d}(n,this._eventButton)}isValidEndEvent(n){return D.mouseButton(n)===this._eventButton}}class gh{constructor(){this._firstTouch=void 0}_isOneFingerTouch(n){return n.targetTouches.length===1}_isSameTouchEvent(n){return n.targetTouches[0].identifier===this._firstTouch}startMove(n){this._firstTouch=n.targetTouches[0].identifier}endMove(n){delete this._firstTouch}isValidStartEvent(n){return this._isOneFingerTouch(n)}isValidMoveEvent(n){return this._isOneFingerTouch(n)&&this._isSameTouchEvent(n)}isValidEndEvent(n){return this._isOneFingerTouch(n)&&this._isSameTouchEvent(n)}}const xc=g=>{g.mousedown=g.dragStart,g.mousemoveWindow=g.dragMove,g.mouseup=g.dragEnd,g.contextmenu=n=>{n.preventDefault()}},yh=({enable:g,clickTolerance:n,bearingDegreesPerPixelMoved:a=.8})=>{const h=new vc({checkCorrectEvent:d=>D.mouseButton(d)===0&&d.ctrlKey||D.mouseButton(d)===2});return new Uo({clickTolerance:n,move:(d,m)=>({bearingDelta:(m.x-d.x)*a}),moveStateManager:h,enable:g,assignEvents:xc})},_h=({enable:g,clickTolerance:n,pitchDegreesPerPixelMoved:a=-.5})=>{const h=new vc({checkCorrectEvent:d=>D.mouseButton(d)===0&&d.ctrlKey||D.mouseButton(d)===2});return new Uo({clickTolerance:n,move:(d,m)=>({pitchDelta:(m.y-d.y)*a}),moveStateManager:h,enable:g,assignEvents:xc})};class Ds{constructor(n,a){this._clickTolerance=n.clickTolerance||1,this._map=a,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new u.P(0,0)}_shouldBePrevented(n){return n<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(n,a,h){return this._calculateTransform(n,a,h)}touchmove(n,a,h){if(this._active){if(!this._shouldBePrevented(h.length))return n.preventDefault(),this._calculateTransform(n,a,h);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",n)}}touchend(n,a,h){this._calculateTransform(n,a,h),this._active&&this._shouldBePrevented(h.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(n,a,h){h.length>0&&(this._active=!0);const d=ml(h,a),m=new u.P(0,0),w=new u.P(0,0);let T=0;for(const I in d){const M=d[I],z=this._touches[I];z&&(m._add(M),w._add(M.sub(z)),T++,d[I]=M)}if(this._touches=d,this._shouldBePrevented(T)||!w.mag())return;const C=w.div(T);return this._sum._add(C),this._sum.mag()<this._clickTolerance?void 0:{around:m.div(T),panDelta:C}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class bc{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(n,a,h){this._firstTwoTouches||h.length<2||(this._firstTwoTouches=[h[0].identifier,h[1].identifier],this._start([a[0],a[1]]))}touchmove(n,a,h){if(!this._firstTwoTouches)return;n.preventDefault();const[d,m]=this._firstTwoTouches,w=gl(h,a,d),T=gl(h,a,m);if(!w||!T)return;const C=this._aroundCenter?null:w.add(T).div(2);return this._move([w,T],C,n)}touchend(n,a,h){if(!this._firstTwoTouches)return;const[d,m]=this._firstTwoTouches,w=gl(h,a,d),T=gl(h,a,m);w&&T||(this._active&&D.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function gl(g,n,a){for(let h=0;h<g.length;h++)if(g[h].identifier===a)return n[h]}function vh(g,n){return Math.log(g/n)/Math.LN2}class xh extends bc{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(n){this._startDistance=this._distance=n[0].dist(n[1])}_move(n,a){const h=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(vh(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:vh(this._distance,h),pinchAround:a}}}function bh(g,n){return 180*g.angleWith(n)/Math.PI}class wh extends bc{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])}_move(n,a,h){const d=this._vector;if(this._vector=n[0].sub(n[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:bh(this._vector,d),pinchAround:a}}_isBelowThreshold(n){this._minDiameter=Math.min(this._minDiameter,n.mag());const a=25/(Math.PI*this._minDiameter)*360,h=bh(n,this._startVector);return Math.abs(h)<a}}function wc(g){return Math.abs(g.y)>Math.abs(g.x)}class ya extends bc{constructor(n){super(),this._currentTouchCount=0,this._map=n}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(n,a,h){super.touchstart(n,a,h),this._currentTouchCount=h.length}_start(n){this._lastPoints=n,wc(n[0].sub(n[1]))&&(this._valid=!1)}_move(n,a,h){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const d=n[0].sub(this._lastPoints[0]),m=n[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(d,m,h.timeStamp),this._valid?(this._lastPoints=n,this._active=!0,{pitchDelta:(d.y+m.y)/2*-.5}):void 0}gestureBeginsVertically(n,a,h){if(this._valid!==void 0)return this._valid;const d=n.mag()>=2,m=a.mag()>=2;if(!d&&!m)return;if(!d||!m)return this._firstMove===void 0&&(this._firstMove=h),h-this._firstMove<100&&void 0;const w=n.y>0==a.y>0;return wc(n)&&wc(a)&&w}}const Rp={panStep:100,bearingStep:15,pitchStep:10};class Ci{constructor(n){this._tr=new qi(n);const a=Rp;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(n){if(n.altKey||n.ctrlKey||n.metaKey)return;let a=0,h=0,d=0,m=0,w=0;switch(n.keyCode){case 61:case 107:case 171:case 187:a=1;break;case 189:case 109:case 173:a=-1;break;case 37:n.shiftKey?h=-1:(n.preventDefault(),m=-1);break;case 39:n.shiftKey?h=1:(n.preventDefault(),m=1);break;case 38:n.shiftKey?d=1:(n.preventDefault(),w=-1);break;case 40:n.shiftKey?d=-1:(n.preventDefault(),w=1);break;default:return}return this._rotationDisabled&&(h=0,d=0),{cameraAnimation:T=>{const C=this._tr;T.easeTo({duration:300,easeId:"keyboardHandler",easing:go,zoom:a?Math.round(C.zoom)+a*(n.shiftKey?2:1):C.zoom,bearing:C.bearing+h*this._bearingStep,pitch:C.pitch+d*this._pitchStep,offset:[-m*this._panStep,-w*this._panStep],center:C.center},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function go(g){return g*(2-g)}const Sh=4.000244140625;class Hi{constructor(n,a){this._onTimeout=h=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(h)},this._map=n,this._tr=new qi(n),this._triggerRenderFrame=a,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(n){this._defaultZoomRate=n}setWheelZoomRate(n){this._wheelZoomRate=n}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!n&&n.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(n){return!!this._map.cooperativeGestures.isEnabled()&&!(n.ctrlKey||this._map.cooperativeGestures.isBypassed(n))}wheel(n){if(!this.isEnabled())return;if(this._shouldBePrevented(n))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",n);let a=n.deltaMode===WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY;const h=N.now(),d=h-(this._lastWheelEventTime||0);this._lastWheelEventTime=h,a!==0&&a%Sh==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":d>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(d*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),n.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=n,this._delta-=a,this._active||this._start(n)),n.preventDefault()}_start(n){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const a=D.mousePos(this._map.getCanvas(),n),h=this._tr;this._around=a.y>h.transform.height/2-h.transform.getHorizon()?u.N.convert(this._aroundCenter?h.center:h.unproject(a)):u.N.convert(h.center),this._aroundPoint=h.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const n=this._tr.transform;if(this._delta!==0){const C=this._type==="wheel"&&Math.abs(this._delta)>Sh?this._wheelZoomRate:this._defaultZoomRate;let I=2/(1+Math.exp(-Math.abs(this._delta*C)));this._delta<0&&I!==0&&(I=1/I);const M=typeof this._targetZoom=="number"?n.zoomScale(this._targetZoom):n.scale;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom(M*I))),this._type==="wheel"&&(this._startZoom=n.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const a=typeof this._targetZoom=="number"?this._targetZoom:n.zoom,h=this._startZoom,d=this._easing;let m,w=!1;const T=N.now()-this._lastWheelEventTime;if(this._type==="wheel"&&h&&d&&T){const C=Math.min(T/200,1),I=d(C);m=u.y.number(h,a,I),C<1?this._frameId||(this._frameId=!0):w=!0}else m=a,w=!0;return this._active=!0,w&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!w,zoomDelta:m-n.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(n){let a=u.b9;if(this._prevEase){const h=this._prevEase,d=(N.now()-h.start)/h.duration,m=h.easing(d+.01)-h.easing(d),w=.27/Math.sqrt(m*m+1e-4)*.01,T=Math.sqrt(.0729-w*w);a=u.b8(w,T,.25,1)}return this._prevEase={start:N.now(),duration:n,easing:a},a}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Fs{constructor(n,a){this._clickZoom=n,this._tapZoom=a}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ry{constructor(n){this._tr=new qi(n),this.reset()}reset(){this._active=!1}dblclick(n,a){return n.preventDefault(),{cameraAnimation:h=>{h.easeTo({duration:300,zoom:this._tr.zoom+(n.shiftKey?-1:1),around:this._tr.unproject(a)},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class iy{constructor(){this._tap=new _c({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(n,a,h){if(!this._swipePoint)if(this._tapTime){const d=a[0],m=n.timeStamp-this._tapTime<500,w=this._tapPoint.dist(d)<30;m&&w?h.length>0&&(this._swipePoint=d,this._swipeTouch=h[0].identifier):this.reset()}else this._tap.touchstart(n,a,h)}touchmove(n,a,h){if(this._tapTime){if(this._swipePoint){if(h[0].identifier!==this._swipeTouch)return;const d=a[0],m=d.y-this._swipePoint.y;return this._swipePoint=d,n.preventDefault(),this._active=!0,{zoomDelta:m/128}}}else this._tap.touchmove(n,a,h)}touchend(n,a,h){if(this._tapTime)this._swipePoint&&h.length===0&&this.reset();else{const d=this._tap.touchend(n,a,h);d&&(this._tapTime=n.timeStamp,this._tapPoint=d)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Dp{constructor(n,a,h){this._el=n,this._mousePan=a,this._touchPan=h}enable(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Fp{constructor(n,a,h){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=a,this._mousePitch=h}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Th{constructor(n,a,h,d){this._el=n,this._touchZoom=a,this._touchRotate=h,this._tapDragZoom=d,this._rotationDisabled=!1,this._enabled=!0}enable(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class _a{constructor(n,a){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=n,this._options=a,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const n=this._map.getCanvasContainer();n.classList.add("maplibregl-cooperative-gestures"),this._container=D.create("div","maplibregl-cooperative-gesture-screen",n);let a=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(a=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const h=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),d=document.createElement("div");d.className="maplibregl-desktop-message",d.textContent=a,this._container.appendChild(d);const m=document.createElement("div");m.className="maplibregl-mobile-message",m.textContent=h,this._container.appendChild(m),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(D.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(n){return n[this._bypassKey]}notifyGestureBlocked(n,a){this._enabled&&(this._map.fire(new u.k("cooperativegestureprevented",{gestureType:n,originalEvent:a})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const ki=g=>g.zoom||g.drag||g.pitch||g.rotate;class Qe extends u.k{}function Sc(g){return g.panDelta&&g.panDelta.mag()||g.zoomDelta||g.bearingDelta||g.pitchDelta}class Ch{constructor(n,a){this.handleWindowEvent=d=>{this.handleEvent(d,`${d.type}Window`)},this.handleEvent=(d,m)=>{if(d.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const w=d.type==="renderFrame"?void 0:d,T={needsRenderFrame:!1},C={},I={},M=d.touches,z=M?this._getMapTouches(M):void 0,$=z?D.touchPos(this._map.getCanvas(),z):D.mousePos(this._map.getCanvas(),d);for(const{handlerName:Q,handler:ie,allowed:oe}of this._handlers){if(!ie.isEnabled())continue;let le;this._blockedByActive(I,oe,Q)?ie.reset():ie[m||d.type]&&(le=ie[m||d.type](d,$,z),this.mergeHandlerResult(T,C,le,Q,w),le&&le.needsRenderFrame&&this._triggerRenderFrame()),(le||ie.isActive())&&(I[Q]=ie)}const G={};for(const Q in this._previousActiveHandlers)I[Q]||(G[Q]=w);this._previousActiveHandlers=I,(Object.keys(G).length||Sc(T))&&(this._changes.push([T,C,G]),this._triggerRenderFrame()),(Object.keys(I).length||Sc(T))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:H}=T;H&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],H(this._map))},this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ph(n),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(a);const h=this._el;this._listeners=[[h,"touchstart",{passive:!0}],[h,"touchmove",{passive:!1}],[h,"touchend",void 0],[h,"touchcancel",void 0],[h,"mousedown",void 0],[h,"mousemove",void 0],[h,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[h,"mouseover",void 0],[h,"mouseout",void 0],[h,"dblclick",void 0],[h,"click",void 0],[h,"keydown",{capture:!1}],[h,"keyup",void 0],[h,"wheel",{passive:!1}],[h,"contextmenu",void 0],[window,"blur",void 0]];for(const[d,m,w]of this._listeners)D.addEventListener(d,m,d===document?this.handleWindowEvent:this.handleEvent,w)}destroy(){for(const[n,a,h]of this._listeners)D.removeEventListener(n,a,n===document?this.handleWindowEvent:this.handleEvent,h)}_addDefaultHandlers(n){const a=this._map,h=a.getCanvasContainer();this._add("mapEvent",new Lp(a,n));const d=a.boxZoom=new hi(a,n);this._add("boxZoom",d),n.interactive&&n.boxZoom&&d.enable();const m=a.cooperativeGestures=new _a(a,n.cooperativeGestures);this._add("cooperativeGestures",m),n.cooperativeGestures&&m.enable();const w=new ga(a),T=new ry(a);a.doubleClickZoom=new Fs(T,w),this._add("tapZoom",w),this._add("clickZoom",T),n.interactive&&n.doubleClickZoom&&a.doubleClickZoom.enable();const C=new iy;this._add("tapDragZoom",C);const I=a.touchPitch=new ya(a);this._add("touchPitch",I),n.interactive&&n.touchPitch&&a.touchPitch.enable(n.touchPitch);const M=yh(n),z=_h(n);a.dragRotate=new Fp(n,M,z),this._add("mouseRotate",M,["mousePitch"]),this._add("mousePitch",z,["mouseRotate"]),n.interactive&&n.dragRotate&&a.dragRotate.enable();const $=(({enable:le,clickTolerance:K})=>{const he=new vc({checkCorrectEvent:fe=>D.mouseButton(fe)===0&&!fe.ctrlKey});return new Uo({clickTolerance:K,move:(fe,ve)=>({around:ve,panDelta:ve.sub(fe)}),activateOnStart:!0,moveStateManager:he,enable:le,assignEvents:xc})})(n),G=new Ds(n,a);a.dragPan=new Dp(h,$,G),this._add("mousePan",$),this._add("touchPan",G,["touchZoom","touchRotate"]),n.interactive&&n.dragPan&&a.dragPan.enable(n.dragPan);const H=new wh,Q=new xh;a.touchZoomRotate=new Th(h,Q,H,C),this._add("touchRotate",H,["touchPan","touchZoom"]),this._add("touchZoom",Q,["touchPan","touchRotate"]),n.interactive&&n.touchZoomRotate&&a.touchZoomRotate.enable(n.touchZoomRotate);const ie=a.scrollZoom=new Hi(a,()=>this._triggerRenderFrame());this._add("scrollZoom",ie,["mousePan"]),n.interactive&&n.scrollZoom&&a.scrollZoom.enable(n.scrollZoom);const oe=a.keyboard=new Ci(a);this._add("keyboard",oe),n.interactive&&n.keyboard&&a.keyboard.enable(),this._add("blockableMapEvent",new Fn(a))}_add(n,a,h){this._handlers.push({handlerName:n,handler:a,allowed:h}),this._handlersById[n]=a}stop(n){if(!this._updatingCamera){for(const{handler:a}of this._handlers)a.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}}isActive(){for(const{handler:n}of this._handlers)if(n.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ki(this._eventsInProgress)||this.isZooming()}_blockedByActive(n,a,h){for(const d in n)if(d!==h&&(!a||a.indexOf(d)<0))return!0;return!1}_getMapTouches(n){const a=[];for(const h of n)this._el.contains(h.target)&&a.push(h);return a}mergeHandlerResult(n,a,h,d,m){if(!h)return;u.e(n,h);const w={handlerName:d,originalEvent:h.originalEvent||m};h.zoomDelta!==void 0&&(a.zoom=w),h.panDelta!==void 0&&(a.drag=w),h.pitchDelta!==void 0&&(a.pitch=w),h.bearingDelta!==void 0&&(a.rotate=w)}_applyChanges(){const n={},a={},h={};for(const[d,m,w]of this._changes)d.panDelta&&(n.panDelta=(n.panDelta||new u.P(0,0))._add(d.panDelta)),d.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+d.zoomDelta),d.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+d.bearingDelta),d.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+d.pitchDelta),d.around!==void 0&&(n.around=d.around),d.pinchAround!==void 0&&(n.pinchAround=d.pinchAround),d.noInertia&&(n.noInertia=d.noInertia),u.e(a,m),u.e(h,w);this._updateMapTransform(n,a,h),this._changes=[]}_updateMapTransform(n,a,h){const d=this._map,m=d._getTransformForUpdate(),w=d.terrain;if(!(Sc(n)||w&&this._terrainMovement))return this._fireEvents(a,h,!0);let{panDelta:T,zoomDelta:C,bearingDelta:I,pitchDelta:M,around:z,pinchAround:$}=n;$!==void 0&&(z=$),d._stop(!0),z=z||d.transform.centerPoint;const G=m.pointLocation(T?z.sub(T):z);I&&(m.bearing+=I),M&&(m.pitch+=M),C&&(m.zoom+=C),w?this._terrainMovement||!a.drag&&!a.zoom?a.drag&&this._terrainMovement?m.center=m.pointLocation(m.centerPoint.sub(T)):m.setLocationAtPoint(G,z):(this._terrainMovement=!0,this._map._elevationFreeze=!0,m.setLocationAtPoint(G,z)):m.setLocationAtPoint(G,z),d._applyUpdatedTransform(m),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(a,h,!0)}_fireEvents(n,a,h){const d=ki(this._eventsInProgress),m=ki(n),w={};for(const z in n){const{originalEvent:$}=n[z];this._eventsInProgress[z]||(w[`${z}start`]=$),this._eventsInProgress[z]=n[z]}!d&&m&&this._fireEvent("movestart",m.originalEvent);for(const z in w)this._fireEvent(z,w[z]);m&&this._fireEvent("move",m.originalEvent);for(const z in n){const{originalEvent:$}=n[z];this._fireEvent(z,$)}const T={};let C;for(const z in this._eventsInProgress){const{handlerName:$,originalEvent:G}=this._eventsInProgress[z];this._handlersById[$].isActive()||(delete this._eventsInProgress[z],C=a[$]||G,T[`${z}end`]=C)}for(const z in T)this._fireEvent(z,T[z]);const I=ki(this._eventsInProgress),M=(d||m)&&!I;if(M&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const z=this._map._getTransformForUpdate();z.recalculateZoom(this._map.terrain),this._map._applyUpdatedTransform(z)}if(h&&M){this._updatingCamera=!0;const z=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),$=G=>G!==0&&-this._bearingSnap<G&&G<this._bearingSnap;!z||!z.essential&&N.prefersReducedMotion?(this._map.fire(new u.k("moveend",{originalEvent:C})),$(this._map.getBearing())&&this._map.resetNorth()):($(z.bearing||this._map.getBearing())&&(z.bearing=0),z.freezeElevation=!0,this._map.easeTo(z,{originalEvent:C})),this._updatingCamera=!1}}_fireEvent(n,a){this._map.fire(new u.k(n,a?{originalEvent:a}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(n=>{delete this._frameId,this.handleEvent(new Qe("renderFrame",{timeStamp:n})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Bp extends u.E{constructor(n,a){super(),this._renderFrameCallback=()=>{const h=Math.min((N.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(h)),h<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=a.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new u.N(this.transform.center.lng,this.transform.center.lat)}setCenter(n,a){return this.jumpTo({center:n},a)}panBy(n,a,h){return n=u.P.convert(n).mult(-1),this.panTo(this.transform.center,u.e({offset:n},a),h)}panTo(n,a,h){return this.easeTo(u.e({center:n},a),h)}getZoom(){return this.transform.zoom}setZoom(n,a){return this.jumpTo({zoom:n},a),this}zoomTo(n,a,h){return this.easeTo(u.e({zoom:n},a),h)}zoomIn(n,a){return this.zoomTo(this.getZoom()+1,n,a),this}zoomOut(n,a){return this.zoomTo(this.getZoom()-1,n,a),this}getBearing(){return this.transform.bearing}setBearing(n,a){return this.jumpTo({bearing:n},a),this}getPadding(){return this.transform.padding}setPadding(n,a){return this.jumpTo({padding:n},a),this}rotateTo(n,a,h){return this.easeTo(u.e({bearing:n},a),h)}resetNorth(n,a){return this.rotateTo(0,u.e({duration:1e3},n),a),this}resetNorthPitch(n,a){return this.easeTo(u.e({bearing:0,pitch:0,duration:1e3},n),a),this}snapToNorth(n,a){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,a):this}getPitch(){return this.transform.pitch}setPitch(n,a){return this.jumpTo({pitch:n},a),this}cameraForBounds(n,a){n=Se.convert(n).adjustAntiMeridian();const h=a&&a.bearing||0;return this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),h,a)}_cameraForBoxAndBearing(n,a,h,d){const m={top:0,bottom:0,right:0,left:0};if(typeof(d=u.e({padding:m,offset:[0,0],maxZoom:this.transform.maxZoom},d)).padding=="number"){const Ue=d.padding;d.padding={top:Ue,bottom:Ue,right:Ue,left:Ue}}d.padding=u.e(m,d.padding);const w=this.transform,T=w.padding,C=new Se(n,a),I=w.project(C.getNorthWest()),M=w.project(C.getNorthEast()),z=w.project(C.getSouthEast()),$=w.project(C.getSouthWest()),G=u.ba(-h),H=I.rotate(G),Q=M.rotate(G),ie=z.rotate(G),oe=$.rotate(G),le=new u.P(Math.max(H.x,Q.x,oe.x,ie.x),Math.max(H.y,Q.y,oe.y,ie.y)),K=new u.P(Math.min(H.x,Q.x,oe.x,ie.x),Math.min(H.y,Q.y,oe.y,ie.y)),he=le.sub(K),fe=(w.width-(T.left+T.right+d.padding.left+d.padding.right))/he.x,ve=(w.height-(T.top+T.bottom+d.padding.top+d.padding.bottom))/he.y;if(ve<0||fe<0)return void u.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Me=Math.min(w.scaleZoom(w.scale*Math.min(fe,ve)),d.maxZoom),De=u.P.convert(d.offset),Ze=new u.P((d.padding.left-d.padding.right)/2,(d.padding.top-d.padding.bottom)/2).rotate(u.ba(h)),Ye=De.add(Ze).mult(w.scale/w.zoomScale(Me));return{center:w.unproject(I.add(z).div(2).sub(Ye)),zoom:Me,bearing:h}}fitBounds(n,a,h){return this._fitInternal(this.cameraForBounds(n,a),a,h)}fitScreenCoordinates(n,a,h,d,m){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(u.P.convert(n)),this.transform.pointLocation(u.P.convert(a)),h,d),d,m)}_fitInternal(n,a,h){return n?(delete(a=u.e(n,a)).padding,a.linear?this.easeTo(a,h):this.flyTo(a,h)):this}jumpTo(n,a){this.stop();const h=this._getTransformForUpdate();let d=!1,m=!1,w=!1;return"zoom"in n&&h.zoom!==+n.zoom&&(d=!0,h.zoom=+n.zoom),n.center!==void 0&&(h.center=u.N.convert(n.center)),"bearing"in n&&h.bearing!==+n.bearing&&(m=!0,h.bearing=+n.bearing),"pitch"in n&&h.pitch!==+n.pitch&&(w=!0,h.pitch=+n.pitch),n.padding==null||h.isPaddingEqual(n.padding)||(h.padding=n.padding),this._applyUpdatedTransform(h),this.fire(new u.k("movestart",a)).fire(new u.k("move",a)),d&&this.fire(new u.k("zoomstart",a)).fire(new u.k("zoom",a)).fire(new u.k("zoomend",a)),m&&this.fire(new u.k("rotatestart",a)).fire(new u.k("rotate",a)).fire(new u.k("rotateend",a)),w&&this.fire(new u.k("pitchstart",a)).fire(new u.k("pitch",a)).fire(new u.k("pitchend",a)),this.fire(new u.k("moveend",a))}calculateCameraOptionsFromTo(n,a,h,d=0){const m=u.Z.fromLngLat(n,a),w=u.Z.fromLngLat(h,d),T=w.x-m.x,C=w.y-m.y,I=w.z-m.z,M=Math.hypot(T,C,I);if(M===0)throw new Error("Can't calculate camera options with same From and To");const z=Math.hypot(T,C),$=this.transform.scaleZoom(this.transform.cameraToCenterDistance/M/this.transform.tileSize),G=180*Math.atan2(T,-C)/Math.PI;let H=180*Math.acos(z/M)/Math.PI;return H=I<0?90-H:90+H,{center:w.toLngLat(),zoom:$,pitch:H,bearing:G}}easeTo(n,a){var h;this._stop(!1,n.easeId),((n=u.e({offset:[0,0],duration:500,easing:u.b9},n)).animate===!1||!n.essential&&N.prefersReducedMotion)&&(n.duration=0);const d=this._getTransformForUpdate(),m=d.zoom,w=d.bearing,T=d.pitch,C=d.padding,I="bearing"in n?this._normalizeBearing(n.bearing,w):w,M="pitch"in n?+n.pitch:T,z="padding"in n?n.padding:d.padding,$=u.P.convert(n.offset);let G=d.centerPoint.add($);const H=d.pointLocation(G),{center:Q,zoom:ie}=d.getConstrained(u.N.convert(n.center||H),(h=n.zoom)!==null&&h!==void 0?h:m);this._normalizeCenter(Q,d);const oe=d.project(H),le=d.project(Q).sub(oe),K=d.zoomScale(ie-m);let he,fe;n.around&&(he=u.N.convert(n.around),fe=d.locationPoint(he));const ve={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||ie!==m,this._rotating=this._rotating||w!==I,this._pitching=this._pitching||M!==T,this._padding=!d.isPaddingEqual(z),this._easeId=n.easeId,this._prepareEase(a,n.noMoveStart,ve),this.terrain&&this._prepareElevation(Q),this._ease(Me=>{if(this._zooming&&(d.zoom=u.y.number(m,ie,Me)),this._rotating&&(d.bearing=u.y.number(w,I,Me)),this._pitching&&(d.pitch=u.y.number(T,M,Me)),this._padding&&(d.interpolatePadding(C,z,Me),G=d.centerPoint.add($)),this.terrain&&!n.freezeElevation&&this._updateElevation(Me),he)d.setLocationAtPoint(he,fe);else{const De=d.zoomScale(d.zoom-m),Ze=ie>m?Math.min(2,K):Math.max(.5,K),Ye=Math.pow(Ze,1-Me),Ue=d.unproject(oe.add(le.mult(Me*Ye)).mult(De));d.setLocationAtPoint(d.renderWorldCopies?Ue.wrap():Ue,G)}this._applyUpdatedTransform(d),this._fireMoveEvents(a)},Me=>{this.terrain&&n.freezeElevation&&this._finalizeElevation(),this._afterEase(a,Me)},n),this}_prepareEase(n,a,h={}){this._moving=!0,a||h.moving||this.fire(new u.k("movestart",n)),this._zooming&&!h.zooming&&this.fire(new u.k("zoomstart",n)),this._rotating&&!h.rotating&&this.fire(new u.k("rotatestart",n)),this._pitching&&!h.pitching&&this.fire(new u.k("pitchstart",n))}_prepareElevation(n){this._elevationCenter=n,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(n,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(n){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const a=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(n<1&&a!==this._elevationTarget){const h=this._elevationTarget-this._elevationStart;this._elevationStart+=n*(h-(a-(h*n+this._elevationStart))/(1-n)),this._elevationTarget=a}this.transform.elevation=u.y.number(this._elevationStart,this._elevationTarget,n)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(n){const a=n.getCameraPosition(),h=this.terrain.getElevationForLngLatZoom(a.lngLat,n.zoom);if(a.altitude<h){const d=this.calculateCameraOptionsFromTo(a.lngLat,h,n.center,n.elevation);return{pitch:d.pitch,zoom:d.zoom}}return{}}_applyUpdatedTransform(n){const a=[];if(this.terrain&&a.push(d=>this._elevateCameraIfInsideTerrain(d)),this.transformCameraUpdate&&a.push(d=>this.transformCameraUpdate(d)),!a.length)return;const h=n.clone();for(const d of a){const m=h.clone(),{center:w,zoom:T,pitch:C,bearing:I,elevation:M}=d(m);w&&(m.center=w),T!==void 0&&(m.zoom=T),C!==void 0&&(m.pitch=C),I!==void 0&&(m.bearing=I),M!==void 0&&(m.elevation=M),h.apply(m)}this.transform.apply(h)}_fireMoveEvents(n){this.fire(new u.k("move",n)),this._zooming&&this.fire(new u.k("zoom",n)),this._rotating&&this.fire(new u.k("rotate",n)),this._pitching&&this.fire(new u.k("pitch",n))}_afterEase(n,a){if(this._easeId&&a&&this._easeId===a)return;delete this._easeId;const h=this._zooming,d=this._rotating,m=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,h&&this.fire(new u.k("zoomend",n)),d&&this.fire(new u.k("rotateend",n)),m&&this.fire(new u.k("pitchend",n)),this.fire(new u.k("moveend",n))}flyTo(n,a){var h;if(!n.essential&&N.prefersReducedMotion){const Ke=u.M(n,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Ke,a)}this.stop(),n=u.e({offset:[0,0],speed:1.2,curve:1.42,easing:u.b9},n);const d=this._getTransformForUpdate(),m=d.zoom,w=d.bearing,T=d.pitch,C=d.padding,I="bearing"in n?this._normalizeBearing(n.bearing,w):w,M="pitch"in n?+n.pitch:T,z="padding"in n?n.padding:d.padding,$=u.P.convert(n.offset);let G=d.centerPoint.add($);const H=d.pointLocation(G),{center:Q,zoom:ie}=d.getConstrained(u.N.convert(n.center||H),(h=n.zoom)!==null&&h!==void 0?h:m);this._normalizeCenter(Q,d);const oe=d.zoomScale(ie-m),le=d.project(H),K=d.project(Q).sub(le);let he=n.curve;const fe=Math.max(d.width,d.height),ve=fe/oe,Me=K.mag();if("minZoom"in n){const Ke=u.ac(Math.min(n.minZoom,m,ie),d.minZoom,d.maxZoom),xt=fe/d.zoomScale(Ke-m);he=Math.sqrt(xt/Me*2)}const De=he*he;function Ze(Ke){const xt=(ve*ve-fe*fe+(Ke?-1:1)*De*De*Me*Me)/(2*(Ke?ve:fe)*De*Me);return Math.log(Math.sqrt(xt*xt+1)-xt)}function Ye(Ke){return(Math.exp(Ke)-Math.exp(-Ke))/2}function Ue(Ke){return(Math.exp(Ke)+Math.exp(-Ke))/2}const je=Ze(!1);let it=function(Ke){return Ue(je)/Ue(je+he*Ke)},St=function(Ke){return fe*((Ue(je)*(Ye(xt=je+he*Ke)/Ue(xt))-Ye(je))/De)/Me;var xt},Ge=(Ze(!0)-je)/he;if(Math.abs(Me)<1e-6||!isFinite(Ge)){if(Math.abs(fe-ve)<1e-6)return this.easeTo(n,a);const Ke=ve<fe?-1:1;Ge=Math.abs(Math.log(ve/fe))/he,St=()=>0,it=xt=>Math.exp(Ke*he*xt)}return n.duration="duration"in n?+n.duration:1e3*Ge/("screenSpeed"in n?+n.screenSpeed/he:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0),this._zooming=!0,this._rotating=w!==I,this._pitching=M!==T,this._padding=!d.isPaddingEqual(z),this._prepareEase(a,!1),this.terrain&&this._prepareElevation(Q),this._ease(Ke=>{const xt=Ke*Ge,xn=1/it(xt);d.zoom=Ke===1?ie:m+d.scaleZoom(xn),this._rotating&&(d.bearing=u.y.number(w,I,Ke)),this._pitching&&(d.pitch=u.y.number(T,M,Ke)),this._padding&&(d.interpolatePadding(C,z,Ke),G=d.centerPoint.add($)),this.terrain&&!n.freezeElevation&&this._updateElevation(Ke);const Pt=Ke===1?Q:d.unproject(le.add(K.mult(St(xt))).mult(xn));d.setLocationAtPoint(d.renderWorldCopies?Pt.wrap():Pt,G),this._applyUpdatedTransform(d),this._fireMoveEvents(a)},()=>{this.terrain&&n.freezeElevation&&this._finalizeElevation(),this._afterEase(a)},n),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(n,a){var h;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const d=this._onEaseEnd;delete this._onEaseEnd,d.call(this,a)}return n||(h=this.handlers)===null||h===void 0||h.stop(!1),this}_ease(n,a,h){h.animate===!1||h.duration===0?(n(1),a()):(this._easeStart=N.now(),this._easeOptions=h,this._onEaseFrame=n,this._onEaseEnd=a,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(n,a){n=u.b3(n,-180,180);const h=Math.abs(n-a);return Math.abs(n-360-a)<h&&(n-=360),Math.abs(n+360-a)<h&&(n+=360),n}_normalizeCenter(n,a){if(!a.renderWorldCopies||a.lngRange)return;const h=n.lng-a.center.lng;n.lng+=h>180?-360:h<-180?360:0}queryTerrainElevation(n){return this.terrain?this.terrain.getElevationForLngLatZoom(u.N.convert(n),this.transform.tileZoom)-this.transform.elevation:null}}const va={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class xa{constructor(n=va){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=a=>{!a||a.sourceDataType!=="metadata"&&a.sourceDataType!=="visibility"&&a.dataType!=="style"&&a.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=n}getDefaultPosition(){return"bottom-right"}onAdd(n){return this._map=n,this._compact=this.options.compact,this._container=D.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=D.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=D.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){D.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(n,a){const h=this._map._getUIString(`AttributionControl.${a}`);n.title=h,n.setAttribute("aria-label",h)}_updateAttributions(){if(!this._map.style)return;let n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(d=>typeof d!="string"?"":d)):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){const d=this._map.style.stylesheet;this.styleOwner=d.owner,this.styleId=d.id}const a=this._map.style.sourceCaches;for(const d in a){const m=a[d];if(m.used||m.usedForTerrain){const w=m.getSource();w.attribution&&n.indexOf(w.attribution)<0&&n.push(w.attribution)}}n=n.filter(d=>String(d).trim()),n.sort((d,m)=>d.length-m.length),n=n.filter((d,m)=>{for(let w=m+1;w<n.length;w++)if(n[w].indexOf(d)>=0)return!1;return!0});const h=n.join(" | ");h!==this._attribHTML&&(this._attribHTML=h,n.length?(this._innerContainer.innerHTML=h,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class kh{constructor(n={}){this._updateCompact=()=>{const a=this._container.children;if(a.length){const h=a[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&h.classList.add("maplibregl-compact"):h.classList.remove("maplibregl-compact")}},this.options=n}getDefaultPosition(){return"bottom-left"}onAdd(n){this._map=n,this._compact=this.options&&this.options.compact,this._container=D.create("div","maplibregl-ctrl");const a=D.create("a","maplibregl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://maplibre.org/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){D.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Bt{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(n){const a=++this._id;return this._queue.push({callback:n,id:a,cancelled:!1}),a}remove(n){const a=this._currentlyRunning,h=a?this._queue.concat(a):this._queue;for(const d of h)if(d.id===n)return void(d.cancelled=!0)}run(n=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const a=this._currentlyRunning=this._queue;this._queue=[];for(const h of a)if(!h.cancelled&&(h.callback(n),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Eh=u.Y([{name:"a_pos3d",type:"Int16",components:3}]);class oy extends u.E{constructor(n){super(),this.sourceCache=n,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,n.usedForTerrain=!0,n.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(n,a){this.sourceCache.update(n,a),this._renderableTilesKeys=[];const h={};for(const d of n.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:a}))h[d.key]=!0,this._renderableTilesKeys.push(d.key),this._tiles[d.key]||(d.posMatrix=new Float64Array(16),u.aP(d.posMatrix,0,u.X,0,u.X,0,1),this._tiles[d.key]=new $i(d,this.tileSize));for(const d in this._tiles)h[d]||delete this._tiles[d]}freeRtt(n){for(const a in this._tiles){const h=this._tiles[a];(!n||h.tileID.equals(n)||h.tileID.isChildOf(n)||n.isChildOf(h.tileID))&&(h.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(n=>this.getTileByID(n))}getTileByID(n){return this._tiles[n]}getTerrainCoords(n){const a={};for(const h of this._renderableTilesKeys){const d=this._tiles[h].tileID;if(d.canonical.equals(n.canonical)){const m=n.clone();m.posMatrix=new Float64Array(16),u.aP(m.posMatrix,0,u.X,0,u.X,0,1),a[h]=m}else if(d.canonical.isChildOf(n.canonical)){const m=n.clone();m.posMatrix=new Float64Array(16);const w=d.canonical.z-n.canonical.z,T=d.canonical.x-(d.canonical.x>>w<<w),C=d.canonical.y-(d.canonical.y>>w<<w),I=u.X>>w;u.aP(m.posMatrix,0,I,0,I,0,1),u.J(m.posMatrix,m.posMatrix,[-T*I,-C*I,0]),a[h]=m}else if(n.canonical.isChildOf(d.canonical)){const m=n.clone();m.posMatrix=new Float64Array(16);const w=n.canonical.z-d.canonical.z,T=n.canonical.x-(n.canonical.x>>w<<w),C=n.canonical.y-(n.canonical.y>>w<<w),I=u.X>>w;u.aP(m.posMatrix,0,u.X,0,u.X,0,1),u.J(m.posMatrix,m.posMatrix,[T*I,C*I,0]),u.K(m.posMatrix,m.posMatrix,[1/2**w,1/2**w,0]),a[h]=m}}return a}getSourceTile(n,a){const h=this.sourceCache._source;let d=n.overscaledZ-this.deltaZoom;if(d>h.maxzoom&&(d=h.maxzoom),d<h.minzoom)return null;this._sourceTileCache[n.key]||(this._sourceTileCache[n.key]=n.scaledTo(d).key);let m=this.sourceCache.getTileByID(this._sourceTileCache[n.key]);if((!m||!m.dem)&&a)for(;d>=h.minzoom&&(!m||!m.dem);)m=this.sourceCache.getTileByID(n.scaledTo(d--).key);return m}tilesAfterTime(n=Date.now()){return Object.values(this._tiles).filter(a=>a.timeAdded>=n)}}class Ih{constructor(n,a,h){this.painter=n,this.sourceCache=new oy(a),this.options=h,this.exaggeration=typeof h.exaggeration=="number"?h.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(n,a,h,d=u.X){var m;if(!(a>=0&&a<d&&h>=0&&h<d))return 0;const w=this.getTerrainData(n),T=(m=w.tile)===null||m===void 0?void 0:m.dem;if(!T)return 0;const C=function(H,Q,ie){var oe=Q[0],le=Q[1];return H[0]=ie[0]*oe+ie[4]*le+ie[12],H[1]=ie[1]*oe+ie[5]*le+ie[13],H}([],[a/d*u.X,h/d*u.X],w.u_terrain_matrix),I=[C[0]*T.dim,C[1]*T.dim],M=Math.floor(I[0]),z=Math.floor(I[1]),$=I[0]-M,G=I[1]-z;return T.get(M,z)*(1-$)*(1-G)+T.get(M+1,z)*$*(1-G)+T.get(M,z+1)*(1-$)*G+T.get(M+1,z+1)*$*G}getElevationForLngLatZoom(n,a){if(!u.bb(a,n.wrap()))return 0;const{tileID:h,mercatorX:d,mercatorY:m}=this._getOverscaledTileIDFromLngLatZoom(n,a);return this.getElevation(h,d%u.X,m%u.X,u.X)}getElevation(n,a,h,d=u.X){return this.getDEMElevation(n,a,h,d)*this.exaggeration}getTerrainData(n){if(!this._emptyDemTexture){const d=this.painter.context,m=new u.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new He(d,m,d.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new He(d,new u.R({width:1,height:1}),d.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(d.gl.NEAREST,d.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=u.an([])}const a=this.sourceCache.getSourceTile(n,!0);if(a&&a.dem&&(!a.demTexture||a.needsTerrainPrepare)){const d=this.painter.context;a.demTexture=this.painter.getTileTexture(a.dem.stride),a.demTexture?a.demTexture.update(a.dem.getPixels(),{premultiply:!1}):a.demTexture=new He(d,a.dem.getPixels(),d.gl.RGBA,{premultiply:!1}),a.demTexture.bind(d.gl.NEAREST,d.gl.CLAMP_TO_EDGE),a.needsTerrainPrepare=!1}const h=a&&a+a.tileID.key+n.key;if(h&&!this._demMatrixCache[h]){const d=this.sourceCache.sourceCache._source.maxzoom;let m=n.canonical.z-a.tileID.canonical.z;n.overscaledZ>n.canonical.z&&(n.canonical.z>=d?m=n.canonical.z-d:u.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const w=n.canonical.x-(n.canonical.x>>m<<m),T=n.canonical.y-(n.canonical.y>>m<<m),C=u.bc(new Float64Array(16),[1/(u.X<<m),1/(u.X<<m),0]);u.J(C,C,[w*u.X,T*u.X,0]),this._demMatrixCache[n.key]={matrix:C,coord:n}}return{u_depth:2,u_terrain:3,u_terrain_dim:a&&a.dem&&a.dem.dim||1,u_terrain_matrix:h?this._demMatrixCache[n.key].matrix:this._emptyDemMatrix,u_terrain_unpack:a&&a.dem&&a.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(a&&a.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:a}}getFramebuffer(n){const a=this.painter,h=a.width/devicePixelRatio,d=a.height/devicePixelRatio;return!this._fbo||this._fbo.width===h&&this._fbo.height===d||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new He(a.context,{width:h,height:d,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new He(a.context,{width:h,height:d,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=a.context.createFramebuffer(h,d,!0,!1),this._fbo.depthAttachment.set(a.context.createRenderbuffer(a.context.gl.DEPTH_COMPONENT16,h,d))),this._fbo.colorAttachment.set(n==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const n=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const a=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let m=0,w=0;m<this._coordsTextureSize;m++)for(let T=0;T<this._coordsTextureSize;T++,w+=4)a[w+0]=255&T,a[w+1]=255&m,a[w+2]=T>>8<<4|m>>8,a[w+3]=0;const h=new u.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(a.buffer)),d=new He(n,h,n.gl.RGBA,{premultiply:!1});return d.bind(n.gl.NEAREST,n.gl.CLAMP_TO_EDGE),this._coordsTexture=d,d}pointCoordinate(n){this.painter.maybeDrawDepthAndCoords(!0);const a=new Uint8Array(4),h=this.painter.context,d=h.gl,m=Math.round(n.x*this.painter.pixelRatio/devicePixelRatio),w=Math.round(n.y*this.painter.pixelRatio/devicePixelRatio),T=Math.round(this.painter.height/devicePixelRatio);h.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),d.readPixels(m,T-w-1,1,1,d.RGBA,d.UNSIGNED_BYTE,a),h.bindFramebuffer.set(null);const C=a[0]+(a[2]>>4<<8),I=a[1]+((15&a[2])<<8),M=this.coordsIndex[255-a[3]],z=M&&this.sourceCache.getTileByID(M);if(!z)return null;const $=this._coordsTextureSize,G=(1<<z.tileID.canonical.z)*$;return new u.Z((z.tileID.canonical.x*$+C)/G+z.tileID.wrap,(z.tileID.canonical.y*$+I)/G,this.getElevation(z.tileID,C,I,$))}depthAtPoint(n){const a=new Uint8Array(4),h=this.painter.context,d=h.gl;return h.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),d.readPixels(n.x,this.painter.height/devicePixelRatio-n.y-1,1,1,d.RGBA,d.UNSIGNED_BYTE,a),h.bindFramebuffer.set(null),(a[0]/16777216+a[1]/65536+a[2]/256+a[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const n=this.painter.context,a=new u.bd,h=new u.aY,d=this.meshSize,m=u.X/d,w=d*d;for(let z=0;z<=d;z++)for(let $=0;$<=d;$++)a.emplaceBack($*m,z*m,0);for(let z=0;z<w;z+=d+1)for(let $=0;$<d;$++)h.emplaceBack($+z,d+$+z+1,d+$+z+2),h.emplaceBack($+z,d+$+z+2,$+z+1);const T=a.length,C=T+2*(d+1);for(const z of[0,1])for(let $=0;$<=d;$++)for(const G of[0,1])a.emplaceBack($*m,z*u.X,G);for(let z=0;z<2*d;z+=2)h.emplaceBack(C+z,C+z+1,C+z+3),h.emplaceBack(C+z,C+z+3,C+z+2),h.emplaceBack(T+z,T+z+3,T+z+1),h.emplaceBack(T+z,T+z+2,T+z+3);const I=a.length,M=I+2*(d+1);for(const z of[0,1])for(let $=0;$<=d;$++)for(const G of[0,1])a.emplaceBack(z*u.X,$*m,G);for(let z=0;z<2*d;z+=2)h.emplaceBack(I+z,I+z+1,I+z+3),h.emplaceBack(I+z,I+z+3,I+z+2),h.emplaceBack(M+z,M+z+3,M+z+1),h.emplaceBack(M+z,M+z+2,M+z+3);return this._mesh=new pc(n.createVertexBuffer(a,Eh.members),n.createIndexBuffer(h),u.a0.simpleSegment(0,0,a.length,h.length)),this._mesh}getMeshFrameDelta(n){return 2*Math.PI*u.be/Math.pow(2,n)/5}getMinTileElevationForLngLatZoom(n,a){var h;const{tileID:d}=this._getOverscaledTileIDFromLngLatZoom(n,a);return(h=this.getMinMaxElevation(d).minElevation)!==null&&h!==void 0?h:0}getMinMaxElevation(n){const a=this.getTerrainData(n).tile,h={minElevation:null,maxElevation:null};return a&&a.dem&&(h.minElevation=a.dem.min*this.exaggeration,h.maxElevation=a.dem.max*this.exaggeration),h}_getOverscaledTileIDFromLngLatZoom(n,a){const h=u.Z.fromLngLat(n.wrap()),d=(1<<a)*u.X,m=h.x*d,w=h.y*d,T=Math.floor(m/u.X),C=Math.floor(w/u.X);return{tileID:new u.S(a,0,a,T,C),mercatorX:m,mercatorY:w}}}class sy{constructor(n,a,h){this._context=n,this._size=a,this._tileSize=h,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const n of this._objects)n.texture.destroy(),n.fbo.destroy()}_createObject(n){const a=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),h=new He(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return h.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),a.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),a.colorAttachment.set(h.texture),{id:n,fbo:a,texture:h,stamp:-1,inUse:!1}}getObjectForId(n){return this._objects[n]}useObject(n){n.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(a=>n.id!==a),this._recentlyUsed.push(n.id)}stampObject(n){n.stamp=++this._stamp}getOrCreateFreeObject(){for(const a of this._recentlyUsed)if(!this._objects[a].inUse)return this._objects[a];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const n=this._createObject(this._objects.length);return this._objects.push(n),n}freeObject(n){n.inUse=!1}freeAllObjects(){for(const n of this._objects)this.freeObject(n)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(n=>!n.inUse)===!1}}const ba={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Op{constructor(n,a){this.painter=n,this.terrain=a,this.pool=new sy(n.context,30,a.sourceCache.tileSize*a.qualityFactor)}destruct(){this.pool.destruct()}getTexture(n){return this.pool.getObjectForId(n.rtt[this._stacks.length-1].id).texture}prepareForRender(n,a){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=n._order.filter(h=>!n._layers[h].isHidden(a)),this._coordsDescendingInv={};for(const h in n.sourceCaches){this._coordsDescendingInv[h]={};const d=n.sourceCaches[h].getVisibleCoordinates();for(const m of d){const w=this.terrain.sourceCache.getTerrainCoords(m);for(const T in w)this._coordsDescendingInv[h][T]||(this._coordsDescendingInv[h][T]=[]),this._coordsDescendingInv[h][T].push(w[T])}}this._coordsDescendingInvStr={};for(const h of n._order){const d=n._layers[h],m=d.source;if(ba[d.type]&&!this._coordsDescendingInvStr[m]){this._coordsDescendingInvStr[m]={};for(const w in this._coordsDescendingInv[m])this._coordsDescendingInvStr[m][w]=this._coordsDescendingInv[m][w].map(T=>T.key).sort().join()}}for(const h of this._renderableTiles)for(const d in this._coordsDescendingInvStr){const m=this._coordsDescendingInvStr[d][h.tileID.key];m&&m!==h.rttCoords[d]&&(h.rtt=[])}}renderLayer(n){if(n.isHidden(this.painter.transform.zoom))return!1;const a=n.type,h=this.painter,d=this._renderableLayerIds[this._renderableLayerIds.length-1]===n.id;if(ba[a]&&(this._prevType&&ba[this._prevType]||this._stacks.push([]),this._prevType=a,this._stacks[this._stacks.length-1].push(n.id),!d))return!0;if(ba[this._prevType]||ba[a]&&d){this._prevType=a;const m=this._stacks.length-1,w=this._stacks[m]||[];for(const T of this._renderableTiles){if(this.pool.isFull()&&(Ap(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(T),T.rtt[m]){const I=this.pool.getObjectForId(T.rtt[m].id);if(I.stamp===T.rtt[m].stamp){this.pool.useObject(I);continue}}const C=this.pool.getOrCreateFreeObject();this.pool.useObject(C),this.pool.stampObject(C),T.rtt[m]={id:C.id,stamp:C.stamp},h.context.bindFramebuffer.set(C.fbo.framebuffer),h.context.clear({color:u.aM.transparent,stencil:0}),h.currentStencilSource=void 0;for(let I=0;I<w.length;I++){const M=h.style._layers[w[I]],z=M.source?this._coordsDescendingInv[M.source][T.tileID.key]:[T.tileID];h.context.viewport.set([0,0,C.fbo.width,C.fbo.height]),h._renderTileClippingMasks(M,z),h.renderLayer(h,h.style.sourceCaches[M.source],M,z),M.source&&(T.rttCoords[M.source]=this._coordsDescendingInvStr[M.source][T.tileID.key])}}return Ap(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),ba[a]}return!1}}const Ph={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Np=P,ay={hash:!1,interactive:!0,bearingSnap:7,attributionControl:va,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:u.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},Ah=g=>{g.touchstart=g.dragStart,g.touchmoveWindow=g.dragMove,g.touchend=g.dragEnd},ly={showCompass:!0,showZoom:!0,visualizePitch:!1};class cy{constructor(n,a,h=!1){this.mousedown=w=>{this.startMouse(u.e({},w,{ctrlKey:!0,preventDefault:()=>w.preventDefault()}),D.mousePos(this.element,w)),D.addEventListener(window,"mousemove",this.mousemove),D.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=w=>{this.moveMouse(w,D.mousePos(this.element,w))},this.mouseup=w=>{this.mouseRotate.dragEnd(w),this.mousePitch&&this.mousePitch.dragEnd(w),this.offTemp()},this.touchstart=w=>{w.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=D.touchPos(this.element,w.targetTouches)[0],this.startTouch(w,this._startPos),D.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),D.addEventListener(window,"touchend",this.touchend))},this.touchmove=w=>{w.targetTouches.length!==1?this.reset():(this._lastPos=D.touchPos(this.element,w.targetTouches)[0],this.moveTouch(w,this._lastPos))},this.touchend=w=>{w.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const d=n.dragRotate._mouseRotate.getClickTolerance(),m=n.dragRotate._mousePitch.getClickTolerance();this.element=a,this.mouseRotate=yh({clickTolerance:d,enable:!0}),this.touchRotate=(({enable:w,clickTolerance:T,bearingDegreesPerPixelMoved:C=.8})=>{const I=new gh;return new Uo({clickTolerance:T,move:(M,z)=>({bearingDelta:(z.x-M.x)*C}),moveStateManager:I,enable:w,assignEvents:Ah})})({clickTolerance:d,enable:!0}),this.map=n,h&&(this.mousePitch=_h({clickTolerance:m,enable:!0}),this.touchPitch=(({enable:w,clickTolerance:T,pitchDegreesPerPixelMoved:C=-.5})=>{const I=new gh;return new Uo({clickTolerance:T,move:(M,z)=>({pitchDelta:(z.y-M.y)*C}),moveStateManager:I,enable:w,assignEvents:Ah})})({clickTolerance:m,enable:!0})),D.addEventListener(a,"mousedown",this.mousedown),D.addEventListener(a,"touchstart",this.touchstart,{passive:!1}),D.addEventListener(a,"touchcancel",this.reset)}startMouse(n,a){this.mouseRotate.dragStart(n,a),this.mousePitch&&this.mousePitch.dragStart(n,a),D.disableDrag()}startTouch(n,a){this.touchRotate.dragStart(n,a),this.touchPitch&&this.touchPitch.dragStart(n,a),D.disableDrag()}moveMouse(n,a){const h=this.map,{bearingDelta:d}=this.mouseRotate.dragMove(n,a)||{};if(d&&h.setBearing(h.getBearing()+d),this.mousePitch){const{pitchDelta:m}=this.mousePitch.dragMove(n,a)||{};m&&h.setPitch(h.getPitch()+m)}}moveTouch(n,a){const h=this.map,{bearingDelta:d}=this.touchRotate.dragMove(n,a)||{};if(d&&h.setBearing(h.getBearing()+d),this.touchPitch){const{pitchDelta:m}=this.touchPitch.dragMove(n,a)||{};m&&h.setPitch(h.getPitch()+m)}}off(){const n=this.element;D.removeEventListener(n,"mousedown",this.mousedown),D.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),D.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),D.removeEventListener(window,"touchend",this.touchend),D.removeEventListener(n,"touchcancel",this.reset),this.offTemp()}offTemp(){D.enableDrag(),D.removeEventListener(window,"mousemove",this.mousemove),D.removeEventListener(window,"mouseup",this.mouseup),D.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),D.removeEventListener(window,"touchend",this.touchend)}}let di;function vn(g,n,a){const h=new u.N(g.lng,g.lat);if(g=new u.N(g.lng,g.lat),n){const d=new u.N(g.lng-360,g.lat),m=new u.N(g.lng+360,g.lat),w=a.locationPoint(g).distSqr(n);a.locationPoint(d).distSqr(n)<w?g=d:a.locationPoint(m).distSqr(n)<w&&(g=m)}for(;Math.abs(g.lng-a.center.lng)>180;){const d=a.locationPoint(g);if(d.x>=0&&d.y>=0&&d.x<=a.width&&d.y<=a.height)break;g.lng>a.center.lng?g.lng-=360:g.lng+=360}return g.lng!==h.lng&&a.locationPoint(g).y>a.height/2-a.getHorizon()?g:h}const wa={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Tc(g,n,a){const h=g.classList;for(const d in wa)h.remove(`maplibregl-${a}-anchor-${d}`);h.add(`maplibregl-${a}-anchor-${n}`)}class Cc extends u.E{constructor(n){if(super(),this._onKeyPress=a=>{const h=a.code,d=a.charCode||a.keyCode;h!=="Space"&&h!=="Enter"&&d!==32&&d!==13||this.togglePopup()},this._onMapClick=a=>{const h=a.originalEvent.target,d=this._element;this._popup&&(h===d||d.contains(h))&&this.togglePopup()},this._update=a=>{var h;if(!this._map)return;const d=this._map.loaded()&&!this._map.isMoving();((a==null?void 0:a.type)==="terrain"||(a==null?void 0:a.type)==="render"&&!d)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?vn(this._lngLat,this._flatPos,this._map.transform):(h=this._lngLat)===null||h===void 0?void 0:h.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let m="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?m=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(m=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let w="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?w="rotateX(0deg)":this._pitchAlignment==="map"&&(w=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||a&&a.type!=="moveend"||(this._pos=this._pos.round()),D.setTransform(this._element,`${wa[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${w} ${m}`),N.frameAsync(new AbortController).then(()=>{this._updateOpacity(a&&a.type==="moveend")}).catch(()=>{})},this._onMove=a=>{if(!this._isDragging){const h=this._clickTolerance||this._map._clickTolerance;this._isDragging=a.point.dist(this._pointerdownPos)>=h}this._isDragging&&(this._pos=a.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new u.k("dragstart"))),this.fire(new u.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new u.k("dragend")),this._state="inactive"},this._addDragHandler=a=>{this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(this._pos).add(this._offset),this._pointerdownPos=a.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._subpixelPositioning=n&&n.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment!=="auto"?n.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(n==null?void 0:n.opacity,n==null?void 0:n.opacityWhenCovered),n&&n.element)this._element=n.element,this._offset=u.P.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=D.create("div");const a=D.createNS("http://www.w3.org/2000/svg","svg"),h=41,d=27;a.setAttributeNS(null,"display","block"),a.setAttributeNS(null,"height",`${h}px`),a.setAttributeNS(null,"width",`${d}px`),a.setAttributeNS(null,"viewBox",`0 0 ${d} ${h}`);const m=D.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"stroke","none"),m.setAttributeNS(null,"stroke-width","1"),m.setAttributeNS(null,"fill","none"),m.setAttributeNS(null,"fill-rule","evenodd");const w=D.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"fill-rule","nonzero");const T=D.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"transform","translate(3.0, 29.0)"),T.setAttributeNS(null,"fill","#000000");const C=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const oe of C){const le=D.createNS("http://www.w3.org/2000/svg","ellipse");le.setAttributeNS(null,"opacity","0.04"),le.setAttributeNS(null,"cx","10.5"),le.setAttributeNS(null,"cy","5.80029008"),le.setAttributeNS(null,"rx",oe.rx),le.setAttributeNS(null,"ry",oe.ry),T.appendChild(le)}const I=D.createNS("http://www.w3.org/2000/svg","g");I.setAttributeNS(null,"fill",this._color);const M=D.createNS("http://www.w3.org/2000/svg","path");M.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),I.appendChild(M);const z=D.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"opacity","0.25"),z.setAttributeNS(null,"fill","#000000");const $=D.createNS("http://www.w3.org/2000/svg","path");$.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),z.appendChild($);const G=D.createNS("http://www.w3.org/2000/svg","g");G.setAttributeNS(null,"transform","translate(6.0, 7.0)"),G.setAttributeNS(null,"fill","#FFFFFF");const H=D.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Q=D.createNS("http://www.w3.org/2000/svg","circle");Q.setAttributeNS(null,"fill","#000000"),Q.setAttributeNS(null,"opacity","0.25"),Q.setAttributeNS(null,"cx","5.5"),Q.setAttributeNS(null,"cy","5.5"),Q.setAttributeNS(null,"r","5.4999962");const ie=D.createNS("http://www.w3.org/2000/svg","circle");ie.setAttributeNS(null,"fill","#FFFFFF"),ie.setAttributeNS(null,"cx","5.5"),ie.setAttributeNS(null,"cy","5.5"),ie.setAttributeNS(null,"r","5.4999962"),H.appendChild(Q),H.appendChild(ie),w.appendChild(T),w.appendChild(I),w.appendChild(z),w.appendChild(G),w.appendChild(H),a.appendChild(w),a.setAttributeNS(null,"height",h*this._scale+"px"),a.setAttributeNS(null,"width",d*this._scale+"px"),this._element.appendChild(a),this._offset=u.P.convert(n&&n.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",a=>{a.preventDefault()}),this._element.addEventListener("mousedown",a=>{a.preventDefault()}),Tc(this._element,this._anchor,"marker"),n&&n.className)for(const a of n.className.split(" "))this._element.classList.add(a);this._popup=null}addTo(n){return this.remove(),this._map=n,this._element.setAttribute("aria-label",n._getUIString("Marker.Title")),n.getCanvasContainer().appendChild(this._element),n.on("move",this._update),n.on("moveend",this._update),n.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),D.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(n){return this._lngLat=u.N.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){const d=Math.abs(13.5)/Math.SQRT2;n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[d,-1*(38.1-13.5+d)],"bottom-right":[-d,-1*(38.1-13.5+d)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=n,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(n){return this._subpixelPositioning=n,this}getPopup(){return this._popup}togglePopup(){const n=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:n?(n.isOpen()?n.remove():(n.setLngLat(this._lngLat),n.addTo(this._map)),this):this}_updateOpacity(n=!1){var a,h;if(!(!((a=this._map)===null||a===void 0)&&a.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(n)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const d=this._map,m=d.terrain.depthAtPoint(this._pos),w=d.terrain.getElevationForLngLatZoom(this._lngLat,d.transform.tileZoom);if(d.transform.lngLatToCameraDepth(this._lngLat,w)-m<.006)return void(this._element.style.opacity=this._opacity);const T=-this._offset.y/d.transform._pixelPerMeter,C=Math.sin(d.getPitch()*Math.PI/180)*T,I=d.terrain.depthAtPoint(new u.P(this._pos.x,this._pos.y-this._offset.y)),M=d.transform.lngLatToCameraDepth(this._lngLat,w+C)-I>.006;!((h=this._popup)===null||h===void 0)&&h.isOpen()&&M&&this._popup.remove(),this._element.style.opacity=M?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(n){return this._offset=u.P.convert(n),this._update(),this}addClassName(n){this._element.classList.add(n)}removeClassName(n){this._element.classList.remove(n)}toggleClassName(n){return this._element.classList.toggle(n)}setDraggable(n){return this._draggable=!!n,this._map&&(n?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(n){return this._rotation=n||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(n){return this._rotationAlignment=n||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(n){return this._pitchAlignment=n&&n!=="auto"?n:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(n,a){return n===void 0&&a===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),n!==void 0&&(this._opacity=n),a!==void 0&&(this._opacityWhenCovered=a),this._map&&this._updateOpacity(!0),this}}const $p={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let yl=0,_l=!1;const yo={maxWidth:100,unit:"metric"};function vl(g,n,a){const h=a&&a.maxWidth||100,d=g._container.clientHeight/2,m=g.unproject([0,d]),w=g.unproject([h,d]),T=m.distanceTo(w);if(a&&a.unit==="imperial"){const C=3.2808*T;C>5280?rt(n,h,C/5280,g._getUIString("ScaleControl.Miles")):rt(n,h,C,g._getUIString("ScaleControl.Feet"))}else a&&a.unit==="nautical"?rt(n,h,T/1852,g._getUIString("ScaleControl.NauticalMiles")):T>=1e3?rt(n,h,T/1e3,g._getUIString("ScaleControl.Kilometers")):rt(n,h,T,g._getUIString("ScaleControl.Meters"))}function rt(g,n,a,h){const d=function(m){const w=Math.pow(10,`${Math.floor(m)}`.length-1);let T=m/w;return T=T>=10?10:T>=5?5:T>=3?3:T>=2?2:T>=1?1:function(C){const I=Math.pow(10,Math.ceil(-Math.log(C)/Math.LN10));return Math.round(C*I)/I}(T),w*T}(a);g.style.width=n*(d/a)+"px",g.innerHTML=`${d}&nbsp;${h}`}const gt={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},kc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ec(g){if(g){if(typeof g=="number"){const n=Math.round(Math.abs(g)/Math.SQRT2);return{center:new u.P(0,0),top:new u.P(0,g),"top-left":new u.P(n,n),"top-right":new u.P(-n,n),bottom:new u.P(0,-g),"bottom-left":new u.P(n,-n),"bottom-right":new u.P(-n,-n),left:new u.P(g,0),right:new u.P(-g,0)}}if(g instanceof u.P||Array.isArray(g)){const n=u.P.convert(g);return{center:n,top:n,"top-left":n,"top-right":n,bottom:n,"bottom-left":n,"bottom-right":n,left:n,right:n}}return{center:u.P.convert(g.center||[0,0]),top:u.P.convert(g.top||[0,0]),"top-left":u.P.convert(g["top-left"]||[0,0]),"top-right":u.P.convert(g["top-right"]||[0,0]),bottom:u.P.convert(g.bottom||[0,0]),"bottom-left":u.P.convert(g["bottom-left"]||[0,0]),"bottom-right":u.P.convert(g["bottom-right"]||[0,0]),left:u.P.convert(g.left||[0,0]),right:u.P.convert(g.right||[0,0])}}return Ec(new u.P(0,0))}const Mh=P;x.AJAXError=u.bh,x.Evented=u.E,x.LngLat=u.N,x.MercatorCoordinate=u.Z,x.Point=u.P,x.addProtocol=u.bi,x.config=u.a,x.removeProtocol=u.bj,x.AttributionControl=xa,x.BoxZoomHandler=hi,x.CanvasSource=nr,x.CooperativeGesturesHandler=_a,x.DoubleClickZoomHandler=Fs,x.DragPanHandler=Dp,x.DragRotateHandler=Fp,x.EdgeInsets=fa,x.FullscreenControl=class extends u.E{constructor(g={}){super(),this._onFullscreenChange=()=>{var n;let a=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((n=a==null?void 0:a.shadowRoot)===null||n===void 0)&&n.fullscreenElement;)a=a.shadowRoot.fullscreenElement;a===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,g&&g.container&&(g.container instanceof HTMLElement?this._container=g.container:u.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(g){return this._map=g,this._container||(this._container=this._map.getContainer()),this._controlContainer=D.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){D.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const g=this._fullscreenButton=D.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);D.create("span","maplibregl-ctrl-icon",g).setAttribute("aria-hidden","true"),g.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const g=this._getTitle();this._fullscreenButton.setAttribute("aria-label",g),this._fullscreenButton.title=g}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new u.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new u.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},x.GeoJSONSource=No,x.GeolocateControl=class extends u.E{constructor(g){super(),this._onSuccess=n=>{if(this._map){if(this._isOutOfMapMaxBounds(n))return this._setErrorState(),this.fire(new u.k("outofmaxbounds",n)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=n,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(n),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(n),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new u.k("geolocate",n)),this._finish()}},this._updateCamera=n=>{const a=new u.N(n.coords.longitude,n.coords.latitude),h=n.coords.accuracy,d=this._map.getBearing(),m=u.e({bearing:d},this.options.fitBoundsOptions),w=Se.fromLngLat(a,h);this._map.fitBounds(w,m,{geolocateSource:!0})},this._updateMarker=n=>{if(n){const a=new u.N(n.coords.longitude,n.coords.latitude);this._accuracyCircleMarker.setLngLat(a).addTo(this._map),this._userLocationDotMarker.setLngLat(a).addTo(this._map),this._accuracy=n.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=n=>{if(this._map){if(this.options.trackUserLocation)if(n.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(n.code===3&&_l)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new u.k("error",n)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",n=>n.preventDefault()),this._geolocateButton=D.create("button","maplibregl-ctrl-geolocate",this._container),D.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=n=>{if(this._map){if(n===!1){u.w("Geolocation support is not available so the GeolocateControl will be disabled.");const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}else{const a=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=D.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Cc({element:this._dotElement}),this._circleElement=D.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Cc({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",a=>{a.geolocateSource||this._watchState!=="ACTIVE_LOCK"||a.originalEvent&&a.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new u.k("trackuserlocationend")),this.fire(new u.k("userlocationlostfocus")))})}},this.options=u.e({},$p,g)}onAdd(g){return this._map=g,this._container=D.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return u._(this,arguments,void 0,function*(n=!1){if(di!==void 0&&!n)return di;if(window.navigator.permissions===void 0)return di=!!window.navigator.geolocation,di;try{di=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{di=!!window.navigator.geolocation}return di})}().then(n=>this._finishSetupUI(n)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),D.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,yl=0,_l=!1}_isOutOfMapMaxBounds(g){const n=this._map.getMaxBounds(),a=g.coords;return n&&(a.longitude<n.getWest()||a.longitude>n.getEast()||a.latitude<n.getSouth()||a.latitude>n.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const g=this._map.getBounds(),n=g.getSouthEast(),a=g.getNorthEast(),h=n.distanceTo(a),d=Math.ceil(this._accuracy/(h/this._map._container.clientHeight)*2);this._circleElement.style.width=`${d}px`,this._circleElement.style.height=`${d}px`}trigger(){if(!this._setup)return u.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new u.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":yl--,_l=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new u.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new u.k("trackuserlocationstart")),this.fire(new u.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let g;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),yl++,yl>1?(g={maximumAge:6e5,timeout:0},_l=!0):(g=this.options.positionOptions,_l=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,g)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},x.Hash=mc,x.ImageSource=Oi,x.KeyboardHandler=Ci,x.LngLatBounds=Se,x.LogoControl=kh,x.Map=class extends Bp{constructor(g){u.bf.mark(u.bg.create);const n=Object.assign(Object.assign({},ay),g);if(n.minZoom!=null&&n.maxZoom!=null&&n.minZoom>n.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(n.minPitch!=null&&n.maxPitch!=null&&n.minPitch>n.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(n.minPitch!=null&&n.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(n.maxPitch!=null&&n.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new ma(n.minZoom,n.maxZoom,n.minPitch,n.maxPitch,n.renderWorldCopies),{bearingSnap:n.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Bt,this._controls=[],this._mapId=u.a4(),this._contextLost=a=>{a.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new u.k("webglcontextlost",{originalEvent:a}))},this._contextRestored=a=>{this._setupPainter(),this.resize(),this._update(),this.fire(new u.k("webglcontextrestored",{originalEvent:a}))},this._onMapScroll=a=>{if(a.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=n.interactive,this._maxTileCacheSize=n.maxTileCacheSize,this._maxTileCacheZoomLevels=n.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=n.failIfMajorPerformanceCaveat===!0,this._preserveDrawingBuffer=n.preserveDrawingBuffer===!0,this._antialias=n.antialias===!0,this._trackResize=n.trackResize===!0,this._bearingSnap=n.bearingSnap,this._refreshExpiredTiles=n.refreshExpiredTiles===!0,this._fadeDuration=n.fadeDuration,this._crossSourceCollisions=n.crossSourceCollisions===!0,this._collectResourceTiming=n.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Ph),n.locale),this._clickTolerance=n.clickTolerance,this._overridePixelRatio=n.pixelRatio,this._maxCanvasSize=n.maxCanvasSize,this.transformCameraUpdate=n.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=n.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=W.addThrottleControl(()=>this.isMoving()),this._requestManager=new pe(n.transformRequest),typeof n.container=="string"){if(this._container=document.getElementById(n.container),!this._container)throw new Error(`Container '${n.container}' not found.`)}else{if(!(n.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=n.container}if(n.maxBounds&&this.setMaxBounds(n.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)).on("moveend",()=>this._update(!1)).on("zoom",()=>this._update(!0)).on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}).once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let a=!1;const h=dl(d=>{this._trackResize&&!this._removed&&(this.resize(d),this.redraw())},50);this._resizeObserver=new ResizeObserver(d=>{a?h(d):a=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Ch(this,n),this._hash=n.hash&&new mc(typeof n.hash=="string"&&n.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:n.center,zoom:n.zoom,bearing:n.bearing,pitch:n.pitch}),n.bounds&&(this.resize(),this.fitBounds(n.bounds,u.e({},n.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=n.localIdeographFontFamily,this._validateStyle=n.validateStyle,n.style&&this.setStyle(n.style,{localIdeographFontFamily:n.localIdeographFontFamily}),n.attributionControl&&this.addControl(new xa(typeof n.attributionControl=="boolean"?void 0:n.attributionControl)),n.maplibreLogo&&this.addControl(new kh,n.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",a=>{this._update(a.dataType==="style"),this.fire(new u.k(`${a.dataType}data`,a))}),this.on("dataloading",a=>{this.fire(new u.k(`${a.dataType}dataloading`,a))}),this.on("dataabort",a=>{this.fire(new u.k("sourcedataabort",a))})}_getMapId(){return this._mapId}addControl(g,n){if(n===void 0&&(n=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new u.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const a=g.onAdd(this);this._controls.push(g);const h=this._controlPositions[n];return n.indexOf("bottom")!==-1?h.insertBefore(a,h.firstChild):h.appendChild(a),this}removeControl(g){if(!g||!g.onRemove)return this.fire(new u.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(g);return n>-1&&this._controls.splice(n,1),g.onRemove(this),this}hasControl(g){return this._controls.indexOf(g)>-1}calculateCameraOptionsFromTo(g,n,a,h){return h==null&&this.terrain&&(h=this.terrain.getElevationForLngLatZoom(a,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(g,n,a,h)}resize(g){var n;const a=this._containerDimensions(),h=a[0],d=a[1],m=this._getClampedPixelRatio(h,d);if(this._resizeCanvas(h,d,m),this.painter.resize(h,d,m),this.painter.overLimit()){const T=this.painter.context.gl;this._maxCanvasSize=[T.drawingBufferWidth,T.drawingBufferHeight];const C=this._getClampedPixelRatio(h,d);this._resizeCanvas(h,d,C),this.painter.resize(h,d,C)}this.transform.resize(h,d),(n=this._requestedCameraState)===null||n===void 0||n.resize(h,d);const w=!this._moving;return w&&(this.stop(),this.fire(new u.k("movestart",g)).fire(new u.k("move",g))),this.fire(new u.k("resize",g)),w&&this.fire(new u.k("moveend",g)),this}_getClampedPixelRatio(g,n){const{0:a,1:h}=this._maxCanvasSize,d=this.getPixelRatio(),m=g*d,w=n*d;return Math.min(m>a?a/m:1,w>h?h/w:1)*d}getPixelRatio(){var g;return(g=this._overridePixelRatio)!==null&&g!==void 0?g:devicePixelRatio}setPixelRatio(g){this._overridePixelRatio=g,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(g){return this.transform.setMaxBounds(Se.convert(g)),this._update()}setMinZoom(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.minZoom=g,this._update(),this.getZoom()<g&&this.setZoom(g),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(g){if((g=g??22)>=this.transform.minZoom)return this.transform.maxZoom=g,this._update(),this.getZoom()>g&&this.setZoom(g),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.minPitch=g,this._update(),this.getPitch()<g&&this.setPitch(g),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(g){if((g=g??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(g>=this.transform.minPitch)return this.transform.maxPitch=g,this._update(),this.getPitch()>g&&this.setPitch(g),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(g){return this.transform.renderWorldCopies=g,this._update()}project(g){return this.transform.locationPoint(u.N.convert(g),this.style&&this.terrain)}unproject(g){return this.transform.pointLocation(u.P.convert(g),this.terrain)}isMoving(){var g;return this._moving||((g=this.handlers)===null||g===void 0?void 0:g.isMoving())}isZooming(){var g;return this._zooming||((g=this.handlers)===null||g===void 0?void 0:g.isZooming())}isRotating(){var g;return this._rotating||((g=this.handlers)===null||g===void 0?void 0:g.isRotating())}_createDelegatedListener(g,n,a){if(g==="mouseenter"||g==="mouseover"){let h=!1;return{layers:n,listener:a,delegates:{mousemove:m=>{const w=n.filter(C=>this.getLayer(C)),T=w.length!==0?this.queryRenderedFeatures(m.point,{layers:w}):[];T.length?h||(h=!0,a.call(this,new _r(g,this,m.originalEvent,{features:T}))):h=!1},mouseout:()=>{h=!1}}}}if(g==="mouseleave"||g==="mouseout"){let h=!1;return{layers:n,listener:a,delegates:{mousemove:w=>{const T=n.filter(C=>this.getLayer(C));(T.length!==0?this.queryRenderedFeatures(w.point,{layers:T}):[]).length?h=!0:h&&(h=!1,a.call(this,new _r(g,this,w.originalEvent)))},mouseout:w=>{h&&(h=!1,a.call(this,new _r(g,this,w.originalEvent)))}}}}{const h=d=>{const m=n.filter(T=>this.getLayer(T)),w=m.length!==0?this.queryRenderedFeatures(d.point,{layers:m}):[];w.length&&(d.features=w,a.call(this,d),delete d.features)};return{layers:n,listener:a,delegates:{[g]:h}}}}_saveDelegatedListener(g,n){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(n)}_removeDelegatedListener(g,n,a){if(!this._delegatedListeners||!this._delegatedListeners[g])return;const h=this._delegatedListeners[g];for(let d=0;d<h.length;d++){const m=h[d];if(m.listener===a&&m.layers.length===n.length&&m.layers.every(w=>n.includes(w))){for(const w in m.delegates)this.off(w,m.delegates[w]);return void h.splice(d,1)}}}on(g,n,a){if(a===void 0)return super.on(g,n);const h=this._createDelegatedListener(g,typeof n=="string"?[n]:n,a);this._saveDelegatedListener(g,h);for(const d in h.delegates)this.on(d,h.delegates[d]);return this}once(g,n,a){if(a===void 0)return super.once(g,n);const h=typeof n=="string"?[n]:n,d=this._createDelegatedListener(g,h,a);for(const m in d.delegates){const w=d.delegates[m];d.delegates[m]=(...T)=>{this._removeDelegatedListener(g,h,a),w(...T)}}this._saveDelegatedListener(g,d);for(const m in d.delegates)this.once(m,d.delegates[m]);return this}off(g,n,a){return a===void 0?super.off(g,n):(this._removeDelegatedListener(g,typeof n=="string"?[n]:n,a),this)}queryRenderedFeatures(g,n){if(!this.style)return[];let a;const h=g instanceof u.P||Array.isArray(g),d=h?g:[[0,0],[this.transform.width,this.transform.height]];if(n=n||(h?{}:g)||{},d instanceof u.P||typeof d[0]=="number")a=[u.P.convert(d)];else{const m=u.P.convert(d[0]),w=u.P.convert(d[1]);a=[m,new u.P(w.x,m.y),w,new u.P(m.x,w.y),m]}return this.style.queryRenderedFeatures(a,n,this.transform)}querySourceFeatures(g,n){return this.style.querySourceFeatures(g,n)}setStyle(g,n){return(n=u.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},n)).diff!==!1&&n.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&g?(this._diffStyle(g,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._updateStyle(g,n))}setTransformRequest(g){return this._requestManager.setTransformRequest(g),this}_getUIString(g){const n=this._locale[g];if(n==null)throw new Error(`Missing UI string '${g}'`);return n}_updateStyle(g,n){if(n.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(g,n));const a=this.style&&n.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!g)),g?(this.style=new Jl(this,n||{}),this.style.setEventedParent(this,{style:this.style}),typeof g=="string"?this.style.loadURL(g,n,a):this.style.loadJSON(g,n,a),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Jl(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(g,n){if(typeof g=="string"){const a=this._requestManager.transformRequest(g,"Style");u.h(a,new AbortController).then(h=>{this._updateDiff(h.data,n)}).catch(h=>{h&&this.fire(new u.j(h))})}else typeof g=="object"&&this._updateDiff(g,n)}_updateDiff(g,n){try{this.style.setState(g,n)&&this._update(!0)}catch(a){u.w(`Unable to perform style diff: ${a.message||a.error||a}.  Rebuilding the style from scratch.`),this._updateStyle(g,n)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():u.w("There is no style added to the map.")}addSource(g,n){return this._lazyInitEmptyStyle(),this.style.addSource(g,n),this._update(!0)}isSourceLoaded(g){const n=this.style&&this.style.sourceCaches[g];if(n!==void 0)return n.loaded();this.fire(new u.j(new Error(`There is no source with ID '${g}'`)))}setTerrain(g){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),g){const n=this.style.sourceCaches[g.source];if(!n)throw new Error(`cannot load terrain, because there exists no source with ID: ${g.source}`);this.terrain===null&&n.reload();for(const a in this.style._layers){const h=this.style._layers[a];h.type==="hillshade"&&h.source===g.source&&u.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Ih(this.painter,n,g),this.painter.renderToTexture=new Op(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=a=>{a.dataType==="style"?this.terrain.sourceCache.freeRtt():a.dataType==="source"&&a.tile&&(a.sourceId!==g.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(a.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new u.k("terrain",{terrain:g})),this}getTerrain(){var g,n;return(n=(g=this.terrain)===null||g===void 0?void 0:g.options)!==null&&n!==void 0?n:null}areTilesLoaded(){const g=this.style&&this.style.sourceCaches;for(const n in g){const a=g[n]._tiles;for(const h in a){const d=a[h];if(d.state!=="loaded"&&d.state!=="errored")return!1}}return!0}removeSource(g){return this.style.removeSource(g),this._update(!0)}getSource(g){return this.style.getSource(g)}addImage(g,n,a={}){const{pixelRatio:h=1,sdf:d=!1,stretchX:m,stretchY:w,content:T,textFitWidth:C,textFitHeight:I}=a;if(this._lazyInitEmptyStyle(),!(n instanceof HTMLImageElement||u.b(n))){if(n.width===void 0||n.height===void 0)return this.fire(new u.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:M,height:z,data:$}=n,G=n;return this.style.addImage(g,{data:new u.R({width:M,height:z},new Uint8Array($)),pixelRatio:h,stretchX:m,stretchY:w,content:T,textFitWidth:C,textFitHeight:I,sdf:d,version:0,userImage:G}),G.onAdd&&G.onAdd(this,g),this}}{const{width:M,height:z,data:$}=N.getImageData(n);this.style.addImage(g,{data:new u.R({width:M,height:z},$),pixelRatio:h,stretchX:m,stretchY:w,content:T,textFitWidth:C,textFitHeight:I,sdf:d,version:0})}}updateImage(g,n){const a=this.style.getImage(g);if(!a)return this.fire(new u.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const h=n instanceof HTMLImageElement||u.b(n)?N.getImageData(n):n,{width:d,height:m,data:w}=h;if(d===void 0||m===void 0)return this.fire(new u.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(d!==a.data.width||m!==a.data.height)return this.fire(new u.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const T=!(n instanceof HTMLImageElement||u.b(n));return a.data.replace(w,T),this.style.updateImage(g,a),this}getImage(g){return this.style.getImage(g)}hasImage(g){return g?!!this.style.getImage(g):(this.fire(new u.j(new Error("Missing required image id"))),!1)}removeImage(g){this.style.removeImage(g)}loadImage(g){return W.getImage(this._requestManager.transformRequest(g,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(g,n){return this._lazyInitEmptyStyle(),this.style.addLayer(g,n),this._update(!0)}moveLayer(g,n){return this.style.moveLayer(g,n),this._update(!0)}removeLayer(g){return this.style.removeLayer(g),this._update(!0)}getLayer(g){return this.style.getLayer(g)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(g,n,a){return this.style.setLayerZoomRange(g,n,a),this._update(!0)}setFilter(g,n,a={}){return this.style.setFilter(g,n,a),this._update(!0)}getFilter(g){return this.style.getFilter(g)}setPaintProperty(g,n,a,h={}){return this.style.setPaintProperty(g,n,a,h),this._update(!0)}getPaintProperty(g,n){return this.style.getPaintProperty(g,n)}setLayoutProperty(g,n,a,h={}){return this.style.setLayoutProperty(g,n,a,h),this._update(!0)}getLayoutProperty(g,n){return this.style.getLayoutProperty(g,n)}setGlyphs(g,n={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(g,n),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(g,n,a={}){return this._lazyInitEmptyStyle(),this.style.addSprite(g,n,a,h=>{h||this._update(!0)}),this}removeSprite(g){return this._lazyInitEmptyStyle(),this.style.removeSprite(g),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(g,n={}){return this._lazyInitEmptyStyle(),this.style.setSprite(g,n,a=>{a||this._update(!0)}),this}setLight(g,n={}){return this._lazyInitEmptyStyle(),this.style.setLight(g,n),this._update(!0)}getLight(){return this.style.getLight()}setSky(g){return this._lazyInitEmptyStyle(),this.style.setSky(g),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(g,n){return this.style.setFeatureState(g,n),this._update()}removeFeatureState(g,n){return this.style.removeFeatureState(g,n),this._update()}getFeatureState(g){return this.style.getFeatureState(g)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let g=0,n=0;return this._container&&(g=this._container.clientWidth||400,n=this._container.clientHeight||300),[g,n]}_setupContainer(){const g=this._container;g.classList.add("maplibregl-map");const n=this._canvasContainer=D.create("div","maplibregl-canvas-container",g);this._interactive&&n.classList.add("maplibregl-interactive"),this._canvas=D.create("canvas","maplibregl-canvas",n),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const a=this._containerDimensions(),h=this._getClampedPixelRatio(a[0],a[1]);this._resizeCanvas(a[0],a[1],h);const d=this._controlContainer=D.create("div","maplibregl-control-container",g),m=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(w=>{m[w]=D.create("div",`maplibregl-ctrl-${w} `,d)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(g,n,a){this._canvas.width=Math.floor(a*g),this._canvas.height=Math.floor(a*n),this._canvas.style.width=`${g}px`,this._canvas.style.height=`${n}px`}_setupPainter(){const g={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let n=null;this._canvas.addEventListener("webglcontextcreationerror",h=>{n={requestedAttributes:g},h&&(n.statusMessage=h.statusMessage,n.type=h.type)},{once:!0});const a=this._canvas.getContext("webgl2",g)||this._canvas.getContext("webgl",g);if(!a){const h="Failed to initialize WebGL";throw n?(n.message=h,new Error(JSON.stringify(n))):new Error(h)}this.painter=new fc(a,this.transform),se.testSupport(a)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(g){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(g){return this._update(),this._renderTaskQueue.add(g)}_cancelRenderFrame(g){this._renderTaskQueue.remove(g)}_render(g){const n=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(g),this._removed)return;let a=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const d=this.transform.zoom,m=N.now();this.style.zoomHistory.update(d,m);const w=new u.z(d,{now:m,fadeDuration:n,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),T=w.crossFadingFactor();T===1&&T===this._crossFadingFactor||(a=!0,this._crossFadingFactor=T),this.style.update(w)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,n,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:n,showPadding:this.showPadding}),this.fire(new u.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,u.bf.mark(u.bg.load),this.fire(new u.k("load"))),this.style&&(this.style.hasTransitions()||a)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const h=this._sourcesDirty||this._styleDirty||this._placementDirty;return h||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new u.k("idle")),!this._loaded||this._fullyLoaded||h||(this._fullyLoaded=!0,u.bf.mark(u.bg.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var g;this._hash&&this._hash.remove();for(const a of this._controls)a.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),W.removeThrottleControl(this._imageQueueHandle),(g=this._resizeObserver)===null||g===void 0||g.disconnect();const n=this.painter.context.gl.getExtension("WEBGL_lose_context");n!=null&&n.loseContext&&n.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),D.remove(this._canvasContainer),D.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),u.bf.clearMetrics(),this._removed=!0,this.fire(new u.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,N.frameAsync(this._frameRequest).then(g=>{u.bf.frame(g),this._frameRequest=null,this._render(g)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._update())}get showPadding(){return!!this._showPadding}set showPadding(g){this._showPadding!==g&&(this._showPadding=g,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,g?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._update())}get repaint(){return!!this._repaint}set repaint(g){this._repaint!==g&&(this._repaint=g,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(g){this._vertices=g,this._update()}get version(){return Np}getCameraTargetElevation(){return this.transform.elevation}},x.MapMouseEvent=_r,x.MapTouchEvent=Rs,x.MapWheelEvent=zp,x.Marker=Cc,x.NavigationControl=class{constructor(g){this._updateZoomButtons=()=>{const n=this._map.getZoom(),a=n===this._map.getMaxZoom(),h=n===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=h,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",h.toString())},this._rotateCompassArrow=()=>{const n=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=n},this._setButtonTitle=(n,a)=>{const h=this._map._getUIString(`NavigationControl.${a}`);n.title=h,n.setAttribute("aria-label",h)},this.options=u.e({},ly,g),this._container=D.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",n=>n.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",n=>this._map.zoomIn({},{originalEvent:n})),D.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",n=>this._map.zoomOut({},{originalEvent:n})),D.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",n=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:n}):this._map.resetNorth({},{originalEvent:n})}),this._compassIcon=D.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(g){return this._map=g,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new cy(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){D.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(g,n){const a=D.create("button",g,this._container);return a.type="button",a.addEventListener("click",n),a}},x.Popup=class extends u.E{constructor(g){super(),this.remove=()=>(this._content&&D.remove(this._content),this._container&&(D.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new u.k("close"))),this),this._onMouseUp=n=>{this._update(n.point)},this._onMouseMove=n=>{this._update(n.point)},this._onDrag=n=>{this._update(n.point)},this._update=n=>{var a;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=D.create("div","maplibregl-popup",this._map.getContainer()),this._tip=D.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const T of this.options.className.split(" "))this._container.classList.add(T);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?vn(this._lngLat,this._flatPos,this._map.transform):(a=this._lngLat)===null||a===void 0?void 0:a.wrap(),this._trackPointer&&!n)return;const h=this._flatPos=this._pos=this._trackPointer&&n?n:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&n?n:this._map.transform.locationPoint(this._lngLat));let d=this.options.anchor;const m=Ec(this.options.offset);if(!d){const T=this._container.offsetWidth,C=this._container.offsetHeight;let I;I=h.y+m.bottom.y<C?["top"]:h.y>this._map.transform.height-C?["bottom"]:[],h.x<T/2?I.push("left"):h.x>this._map.transform.width-T/2&&I.push("right"),d=I.length===0?"bottom":I.join("-")}let w=h.add(m[d]);this.options.subpixelPositioning||(w=w.round()),D.setTransform(this._container,`${wa[d]} translate(${w.x}px,${w.y}px)`),Tc(this._container,d,"popup")},this._onClose=()=>{this.remove()},this.options=u.e(Object.create(gt),g)}addTo(g){return this._map&&this.remove(),this._map=g,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new u.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(g){return this._lngLat=u.N.convert(g),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(g){return this.setDOMContent(document.createTextNode(g))}setHTML(g){const n=document.createDocumentFragment(),a=document.createElement("body");let h;for(a.innerHTML=g;h=a.firstChild,h;)n.appendChild(h);return this.setDOMContent(n)}getMaxWidth(){var g;return(g=this._container)===null||g===void 0?void 0:g.style.maxWidth}setMaxWidth(g){return this.options.maxWidth=g,this._update(),this}setDOMContent(g){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=D.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(g),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(g){return this._container&&this._container.classList.add(g),this}removeClassName(g){return this._container&&this._container.classList.remove(g),this}setOffset(g){return this.options.offset=g,this._update(),this}toggleClassName(g){if(this._container)return this._container.classList.toggle(g)}setSubpixelPositioning(g){this.options.subpixelPositioning=g}_createCloseButton(){this.options.closeButton&&(this._closeButton=D.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const g=this._container.querySelector(kc);g&&g.focus()}},x.RasterDEMTileSource=dn,x.RasterTileSource=$t,x.ScaleControl=class{constructor(g){this._onMove=()=>{vl(this._map,this._container,this.options)},this.setUnit=n=>{this.options.unit=n,vl(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},yo),g)}getDefaultPosition(){return"bottom-left"}onAdd(g){return this._map=g,this._container=D.create("div","maplibregl-ctrl maplibregl-ctrl-scale",g.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){D.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},x.ScrollZoomHandler=Hi,x.Style=Jl,x.TerrainControl=class{constructor(g){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=g}onAdd(g){return this._map=g,this._container=D.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=D.create("button","maplibregl-ctrl-terrain",this._container),D.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){D.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},x.TwoFingersTouchPitchHandler=ya,x.TwoFingersTouchRotateHandler=wh,x.TwoFingersTouchZoomHandler=xh,x.TwoFingersTouchZoomRotateHandler=Th,x.VectorTileSource=Ss,x.VideoSource=Ni,x.addSourceType=(g,n)=>u._(void 0,void 0,void 0,function*(){if(ts(g))throw new Error(`A source type called "${g}" already exists.`);((a,h)=>{Ts[a]=h})(g,n)}),x.clearPrewarmedResources=function(){const g=An;g&&(g.isPreloaded()&&g.numActive()===1?(g.release(Qt),An=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},x.getMaxParallelImageRequests=function(){return u.a.MAX_PARALLEL_IMAGE_REQUESTS},x.getRTLTextPluginStatus=function(){return wi().getRTLTextPluginStatus()},x.getVersion=function(){return Mh},x.getWorkerCount=function(){return _n.workerCount},x.getWorkerUrl=function(){return u.a.WORKER_URL},x.importScriptInWorkers=function(g){return Bo().broadcast("IS",g)},x.prewarm=function(){$n().acquire(Qt)},x.setMaxParallelImageRequests=function(g){u.a.MAX_PARALLEL_IMAGE_REQUESTS=g},x.setRTLTextPlugin=function(g,n){return wi().setRTLTextPlugin(g,n)},x.setWorkerCount=function(g){_n.workerCount=g},x.setWorkerUrl=function(g){u.a.WORKER_URL=g}});var y=s;return y})})(ZT);var lM=ZT.exports;const mt=Fm(lM);function cM(){return typeof self<"u"?fetch.bind(self):typeof global<"u"&&global.fetch?global.fetch:null}class uM{constructor(){this._apiKey="",this._fetch=cM(),this.tileCacheSize=200}set apiKey(t){this._apiKey=t}get apiKey(){return this._apiKey}set fetch(t){this._fetch=t}get fetch(){return this._fetch}}const xu=new uM,ep={AUTO:{code:null,flag:"auto",name:"Auto",latin:!1,isMode:!0,geocoding:!0},LATIN:{code:"latin",flag:"name:latin",name:"Latin",latin:!0,isMode:!1,geocoding:!1},NON_LATIN:{code:"nonlatin",flag:"name:nonlatin",name:"Non Latin",latin:!1,isMode:!1,geocoding:!1},LOCAL:{code:null,flag:"name",name:"Local",latin:!0,isMode:!1,geocoding:!1},AMHARIC:{code:"am",flag:"name:am",name:"Amharic",latin:!1,isMode:!1,geocoding:!1},ARABIC:{code:"ar",flag:"name:ar",name:"Arabic",latin:!1,isMode:!1,geocoding:!0},AZERBAIJANI:{code:"az",flag:"name:az",name:"Azerbaijani",latin:!0,isMode:!1,geocoding:!0},BELARUSIAN:{code:"be",flag:"name:be",name:"Belarusian",latin:!1,isMode:!1,geocoding:!0},BULGARIAN:{code:"bg",flag:"bg",name:"Bulgarian",latin:!1,isMode:!1,geocoding:!0},BENGALI:{code:"bn",flag:"name:bn",name:"Bengali",latin:!0,isMode:!1,geocoding:!1},BRETON:{code:"br",flag:"name:br",name:"Breton",latin:!0,isMode:!1,geocoding:!0},BOSNIAN:{code:"bs",flag:"name:bs",name:"Bosnian",latin:!0,isMode:!1,geocoding:!0},CATALAN:{code:"ca",flag:"name:ca",name:"Catalan",latin:!0,isMode:!1,geocoding:!0},CHINESE:{code:"zh",flag:"name:zh",name:"Chinese",latin:!1,isMode:!1,geocoding:!0},TRADITIONAL_CHINESE:{code:"zh-Hant",flag:"name:zh-Hant",name:"Chinese (traditional)",latin:!1,isMode:!1,geocoding:!1},SIMPLIFIED_CHINESE:{code:"zh-Hans",flag:"name:zh-Hans",name:"Chinese (simplified)",latin:!1,isMode:!1,geocoding:!1},CORSICAN:{code:"co",flag:"name:co",name:"Corsican",latin:!0,isMode:!1,geocoding:!1},CZECH:{code:"cs",flag:"name:cs",name:"Czech",latin:!0,isMode:!1,geocoding:!1},WELSH:{code:"cy",flag:"name:cy",name:"WELSH",latin:!0,isMode:!1,geocoding:!0},DANISH:{code:"da",flag:"name:da",name:"Danish",latin:!0,isMode:!1,geocoding:!0},GERMAN:{code:"de",flag:"name:de",name:"German",latin:!0,isMode:!1,geocoding:!0},GREEK:{code:"el",flag:"name:el",name:"Greek",latin:!1,isMode:!1,geocoding:!0},ENGLISH:{code:"en",flag:"name:en",name:"English",latin:!0,isMode:!1,geocoding:!0},ESPERANTO:{code:"eo",flag:"name:eo",name:"Esperanto",latin:!0,isMode:!1,geocoding:!0},SPANISH:{code:"es",flag:"name:es",name:"Spanish",latin:!0,isMode:!1,geocoding:!0},ESTONIAN:{code:"et",flag:"name:et",name:"Estonian",latin:!0,isMode:!1,geocoding:!0},BASQUE:{code:"eu",flag:"name:eu",name:"Basque",latin:!0,isMode:!1,geocoding:!1},FINNISH:{code:"fi",flag:"name:fi",name:"Finnish",latin:!0,isMode:!1,geocoding:!0},FRENCH:{code:"fr",flag:"name:fr",name:"French",latin:!0,isMode:!1,geocoding:!0},FRISIAN:{code:"fy",flag:"name:fy",name:"Frisian (West)",latin:!0,isMode:!1,geocoding:!0},IRISH:{code:"ga",flag:"name:ga",name:"Irish",latin:!0,isMode:!1,geocoding:!0},SCOTTISH_GAELIC:{code:"gd",flag:"name:gd",name:"Scottish Gaelic",latin:!0,isMode:!1,geocoding:!0},HEBREW:{code:"he",flag:"name:he",name:"Hebrew",latin:!1,isMode:!1,geocoding:!0},HINDI:{code:"hi",flag:"name:hi",name:"Hindi",latin:!1,isMode:!1,geocoding:!1},CROATIAN:{code:"hr",flag:"name:hr",name:"Croatian",latin:!0,isMode:!1,geocoding:!0},HUNGARIAN:{code:"hu",flag:"name:hu",name:"Hungarian",latin:!0,isMode:!1,geocoding:!0},ARMENIAN:{code:"hy",flag:"name:hy",name:"Armenian",latin:!1,isMode:!1,geocoding:!0},INDONESIAN:{code:"id",flag:"name:id",name:"Indonesian",latin:!0,isMode:!1,geocoding:!1},ICELANDIC:{code:"is",flag:"name:is",name:"Icelandic",latin:!0,isMode:!1,geocoding:!0},ITALIAN:{code:"it",flag:"name:it",name:"Italian",latin:!0,isMode:!1,geocoding:!0},JAPANESE:{code:"ja",flag:"name:ja",name:"Japanese",latin:!1,isMode:!1,geocoding:!0},JAPANESE_HIRAGANA:{code:"ja-Hira",flag:"name:ja-Hira",name:"Japanese Hiragana form",latin:!1,isMode:!1,geocoding:!1},JAPANESE_2018:{code:"ja-Latn",flag:"name:ja-Latn",name:"Japanese (Latin 2018)",latin:!0,isMode:!1,geocoding:!1},JAPANESE_KANA:{code:"ja_kana",flag:"name:ja_kana",name:"Japanese (Kana)",latin:!1,isMode:!1,geocoding:!1},JAPANESE_LATIN:{code:"ja_rm",flag:"name:ja_rm",name:"Japanese (Latin script)",latin:!0,isMode:!1,geocoding:!1},GEORGIAN:{code:"ka",flag:"name:ka",name:"Georgian",latin:!1,isMode:!1,geocoding:!0},KAZAKH:{code:"kk",flag:"name:kk",name:"Kazakh",latin:!1,isMode:!1,geocoding:!0},KANNADA:{code:"kn",flag:"name:kn",name:"Kannada",latin:!0,isMode:!1,geocoding:!0},KOREAN:{code:"ko",flag:"name:ko",name:"Korean",latin:!1,isMode:!1,geocoding:!0},KOREAN_LATIN:{code:"ko-Latn",flag:"name:ko-Latn",name:"Korean (Latin script)",latin:!0,isMode:!1,geocoding:!1},KURDISH:{code:"ku",flag:"name:ku",name:"Kurdish",latin:!0,isMode:!1,geocoding:!1},CLASSICAL_LATIN:{code:"la",flag:"name:la",name:"Latin",latin:!0,isMode:!1,geocoding:!0},LUXEMBOURGISH:{code:"lb",flag:"name:lb",name:"Luxembourgish",latin:!0,isMode:!1,geocoding:!0},LITHUANIAN:{code:"lt",flag:"name:lt",name:"Lithuanian",latin:!0,isMode:!1,geocoding:!0},LATVIAN:{code:"lv",flag:"name:lv",name:"Latvian",latin:!0,isMode:!1,geocoding:!0},MACEDONIAN:{code:"mk",flag:"name:mk",name:"Macedonian",latin:!1,isMode:!1,geocoding:!0},MALAYALAM:{code:"ml",flag:"name:ml",name:"Malayalam",latin:!1,isMode:!1,geocoding:!1},MALTESE:{code:"mt",flag:"name:mt",name:"Maltese",latin:!0,isMode:!1,geocoding:!0},DUTCH:{code:"nl",flag:"name:nl",name:"Dutch",latin:!0,isMode:!1,geocoding:!0},NORWEGIAN:{code:"no",flag:"name:no",name:"Norwegian",latin:!0,isMode:!1,geocoding:!0},OCCITAN:{code:"oc",flag:"name:oc",name:"Occitan",latin:!0,isMode:!1,geocoding:!1},POLISH:{code:"pl",flag:"name:pl",name:"Polish",latin:!0,isMode:!1,geocoding:!0},PERSIAN:{code:"fa",flag:"name:fa",name:"Persian",latin:!1,isMode:!1,geocoding:!1},PUNJABI:{code:"pa",flag:"name:pa",name:"Punjabi",latin:!1,isMode:!1,geocoding:!1},WESTERN_PUNJABI:{code:"pnb",flag:"name:pnb",name:"Western Punjabi",latin:!1,isMode:!1,geocoding:!1},PORTUGUESE:{code:"pt",flag:"name:pt",name:"Portuguese",latin:!0,isMode:!1,geocoding:!0},ROMANSH:{code:"rm",flag:"name:rm",name:"Romansh",latin:!0,isMode:!1,geocoding:!0},ROMANIAN:{code:"ro",flag:"name:ro",name:"Romanian",latin:!0,isMode:!1,geocoding:!0},RUSSIAN:{code:"ru",flag:"name:ru",name:"Russian",latin:!1,isMode:!1,geocoding:!0},SLOVAK:{code:"sk",flag:"name:sk",name:"Slovak",latin:!0,isMode:!1,geocoding:!0},SLOVENE:{code:"sl",flag:"name:sl",name:"Slovene",latin:!0,isMode:!1,geocoding:!0},ALBANIAN:{code:"sq",flag:"name:sq",name:"Albanian",latin:!0,isMode:!1,geocoding:!0},SERBIAN_CYRILLIC:{code:"sr",flag:"name:sr",name:"Serbian (Cyrillic script)",latin:!1,isMode:!1,geocoding:!0},SERBIAN_LATIN:{code:"sr-Latn",flag:"name:sr-Latn",name:"Serbian (Latin script)",latin:!0,isMode:!1,geocoding:!1},SWEDISH:{code:"sv",flag:"name:sv",name:"Swedish",latin:!0,isMode:!1,geocoding:!0},TAMIL:{code:"ta",flag:"name:ta",name:"Tamil",latin:!1,isMode:!1,geocoding:!1},TELUGU:{code:"te",flag:"name:te",name:"Telugu",latin:!1,isMode:!1,geocoding:!1},THAI:{code:"th",flag:"name:th",name:"Thai",latin:!1,isMode:!1,geocoding:!0},TURKISH:{code:"tr",flag:"name:tr",name:"Turkish",latin:!0,isMode:!1,geocoding:!0},UKRAINIAN:{code:"uk",flag:"name:uk",name:"Ukrainian",latin:!1,isMode:!1,geocoding:!0},VIETNAMESE:{code:"vi",flag:"name:vi",name:"Vietnamese (Latin script)",latin:!0,isMode:!1,geocoding:!1}};function hM(e,t=ep){return e in t?e[e]:null}function I0(e,t=ep){for(const s of Object.values(t))if(s.code===e)return s;return null}function P0(e,t=ep){for(const s of Object.values(t))if(s.flag===e)return s;return null}function dM(e){return e!==null&&typeof e=="object"&&"code"in e&&"flag"in e&&"name"in e&&"latin"in e&&"isMode"in e&&"geocoding"in e&&(typeof e.code=="string"||e.code===null)&&typeof e.flag=="string"&&typeof e.name=="string"&&typeof e.latin=="boolean"&&typeof e.isMode=="boolean"&&typeof e.geocoding=="boolean"}function pM(e,t=ep){return dM(e)?P0(e.flag,t):typeof e!="string"?null:hM(e,t)||I0(e,t)||P0(e,t)||null}async function fM(e,t={}){if(xu.fetch===null)throw new Error("The fetch function was not found. If on NodeJS < 18 please specify the fetch function with config.fetch");if(new URL(e).searchParams.get("key").trim()==="")throw new Error("The MapTiler Cloud API key is missing. Set it in `config.apiKey` or get one for free at https://maptiler.com");return xu.fetch(e,t)}const KT={maptilerApiURL:"https://api.maptiler.com/",mapStyle:"streets-v2"};Object.freeze(KT);class mM extends Error{constructor(t,s=""){super(`Call to enpoint ${t.url} failed with the status code ${t.status}. ${s}`),this.res=t}}const yw={403:"Key is missing, invalid or restricted"};async function gM(e={}){const t=new URL("geolocation/ip.json",KT.maptilerApiURL);t.searchParams.set("key",e.apiKey??xu.apiKey);const s=t.toString(),l=await fM(s);if(!l.ok)throw new mM(l,l.status in yw?yw[l.status]:"");return await l.json()}const _w={info:gM};function XT(e){const t=/^maptiler:\/\/(.*)/;let s;const l=e.trim();let f;return l.startsWith("http://")||l.startsWith("https://")?f=l:(s=t.exec(l))!==null?f=`https://api.maptiler.com/maps/${s[1]}/style.json`:f=`https://api.maptiler.com/maps/${l}/style.json`,f}class YT{constructor(t,s,l,f,y,x){this.name=t,this.variantType=s,this.id=l,this.referenceStyle=f,this.description=y,this.imageURL=x}getName(){return this.name}getFullName(){return`${this.referenceStyle.getName()} ${this.name}`}getType(){return this.variantType}getId(){return this.id}getDescription(){return this.description}getReferenceStyle(){return this.referenceStyle}hasVariant(t){return this.referenceStyle.hasVariant(t)}getVariant(t){return this.referenceStyle.getVariant(t)}getVariants(){return this.referenceStyle.getVariants().filter(t=>t!==this)}getImageURL(){return this.imageURL}getExpandedStyleURL(){return XT(this.getId())}}class JT{constructor(t,s){this.name=t,this.id=s,this.variants={},this.orderedVariants=[]}getName(){return this.name}getId(){return this.id}addVariant(t){this.variants[t.getType()]=t,this.orderedVariants.push(t)}hasVariant(t){return t in this.variants}getVariant(t){return t in this.variants?this.variants[t]:this.orderedVariants[0]}getVariants(){return Object.values(this.variants)}getDefaultVariant(){return this.orderedVariants[0]}}const A0=[{referenceStyleID:"STREETS",name:"Streets",description:"",variants:[{id:"streets-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"streets-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"streets-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"streets-v2-night",name:"Night",variantType:"NIGHT",description:"",imageURL:""},{id:"streets-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OUTDOOR",name:"Outdoor",description:"",variants:[{id:"outdoor-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"outdoor-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"WINTER",name:"Winter",description:"",variants:[{id:"winter-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"winter-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"SATELLITE",name:"Satellite",description:"",variants:[{id:"satellite",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"HYBRID",name:"Hybrid",description:"",variants:[{id:"hybrid",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"BASIC",name:"Basic",description:"",variants:[{id:"basic-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"basic-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"basic-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BRIGHT",name:"Bright",description:"",variants:[{id:"bright-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"bright-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"bright-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"bright-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OPENSTREETMAP",name:"OpenStreetMap",description:"",variants:[{id:"openstreetmap",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"TOPO",name:"Topo",description:"",variants:[{id:"topo-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"topo-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"topo-v2-shiny",name:"Shiny",variantType:"SHINY",description:"",imageURL:""},{id:"topo-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""},{id:"topo-v2-topographique",name:"Topographique",variantType:"TOPOGRAPHIQUE",description:"",imageURL:""}]},{referenceStyleID:"VOYAGER",name:"Voyager",description:"",variants:[{id:"voyager-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"voyager-v2-darkmatter",name:"Darkmatter",variantType:"DARK",description:"",imageURL:""},{id:"voyager-v2-positron",name:"Positron",variantType:"LIGHT",description:"",imageURL:""},{id:"voyager-v2-vintage",name:"Vintage",variantType:"VINTAGE",description:"",imageURL:""}]},{referenceStyleID:"TONER",name:"Toner",description:"",variants:[{id:"toner-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"toner-v2-background",name:"Background",variantType:"BACKGROUND",description:"",imageURL:""},{id:"toner-v2-lite",name:"Lite",variantType:"LITE",description:"",imageURL:""},{id:"toner-v2-lines",name:"Lines",variantType:"LINES",description:"",imageURL:""}]},{referenceStyleID:"DATAVIZ",name:"Dataviz",description:"",variants:[{id:"dataviz",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"dataviz-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"dataviz-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BACKDROP",name:"Backdrop",description:"",variants:[{id:"backdrop",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"backdrop-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"backdrop-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"OCEAN",name:"Ocean",description:"",variants:[{id:"ocean",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]}];function yM(e){return new Proxy(e,{get(t,s,l){return t.hasVariant(s)?t.getVariant(s):s.toString().toUpperCase()===s?e.getDefaultVariant():Reflect.get(t,s,l)}})}function _M(){const e={};for(let t=0;t<A0.length;t+=1){const s=A0[t],l=yM(new JT(s.name,s.referenceStyleID));for(let f=0;f<s.variants.length;f+=1){const y=s.variants[f],x=new YT(y.name,y.variantType,y.id,l,y.description,y.imageURL);l.addVariant(x)}e[s.referenceStyleID]=l}return e}const QT=_M();var Gv={exports:{}},bu=typeof Reflect=="object"?Reflect:null,vw=bu&&typeof bu.apply=="function"?bu.apply:function(t,s,l){return Function.prototype.apply.call(t,s,l)},Kf;bu&&typeof bu.ownKeys=="function"?Kf=bu.ownKeys:Object.getOwnPropertySymbols?Kf=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Kf=function(t){return Object.getOwnPropertyNames(t)};function vM(e){console&&console.warn&&console.warn(e)}var eC=Number.isNaN||function(t){return t!==t};function Cn(){Cn.init.call(this)}Gv.exports=Cn;Gv.exports.once=SM;Cn.EventEmitter=Cn;Cn.prototype._events=void 0;Cn.prototype._eventsCount=0;Cn.prototype._maxListeners=void 0;var xw=10;function Qm(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(Cn,"defaultMaxListeners",{enumerable:!0,get:function(){return xw},set:function(e){if(typeof e!="number"||e<0||eC(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");xw=e}});Cn.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Cn.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||eC(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function tC(e){return e._maxListeners===void 0?Cn.defaultMaxListeners:e._maxListeners}Cn.prototype.getMaxListeners=function(){return tC(this)};Cn.prototype.emit=function(t){for(var s=[],l=1;l<arguments.length;l++)s.push(arguments[l]);var f=t==="error",y=this._events;if(y!==void 0)f=f&&y.error===void 0;else if(!f)return!1;if(f){var x;if(s.length>0&&(x=s[0]),x instanceof Error)throw x;var u=new Error("Unhandled error."+(x?" ("+x.message+")":""));throw u.context=x,u}var P=y[t];if(P===void 0)return!1;if(typeof P=="function")vw(P,this,s);else for(var L=P.length,U=sC(P,L),l=0;l<L;++l)vw(U[l],this,s);return!0};function nC(e,t,s,l){var f,y,x;if(Qm(s),y=e._events,y===void 0?(y=e._events=Object.create(null),e._eventsCount=0):(y.newListener!==void 0&&(e.emit("newListener",t,s.listener?s.listener:s),y=e._events),x=y[t]),x===void 0)x=y[t]=s,++e._eventsCount;else if(typeof x=="function"?x=y[t]=l?[s,x]:[x,s]:l?x.unshift(s):x.push(s),f=tC(e),f>0&&x.length>f&&!x.warned){x.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+x.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=x.length,vM(u)}return e}Cn.prototype.addListener=function(t,s){return nC(this,t,s,!1)};Cn.prototype.on=Cn.prototype.addListener;Cn.prototype.prependListener=function(t,s){return nC(this,t,s,!0)};function xM(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function rC(e,t,s){var l={fired:!1,wrapFn:void 0,target:e,type:t,listener:s},f=xM.bind(l);return f.listener=s,l.wrapFn=f,f}Cn.prototype.once=function(t,s){return Qm(s),this.on(t,rC(this,t,s)),this};Cn.prototype.prependOnceListener=function(t,s){return Qm(s),this.prependListener(t,rC(this,t,s)),this};Cn.prototype.removeListener=function(t,s){var l,f,y,x,u;if(Qm(s),f=this._events,f===void 0)return this;if(l=f[t],l===void 0)return this;if(l===s||l.listener===s)--this._eventsCount===0?this._events=Object.create(null):(delete f[t],f.removeListener&&this.emit("removeListener",t,l.listener||s));else if(typeof l!="function"){for(y=-1,x=l.length-1;x>=0;x--)if(l[x]===s||l[x].listener===s){u=l[x].listener,y=x;break}if(y<0)return this;y===0?l.shift():bM(l,y),l.length===1&&(f[t]=l[0]),f.removeListener!==void 0&&this.emit("removeListener",t,u||s)}return this};Cn.prototype.off=Cn.prototype.removeListener;Cn.prototype.removeAllListeners=function(t){var s,l,f;if(l=this._events,l===void 0)return this;if(l.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):l[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete l[t]),this;if(arguments.length===0){var y=Object.keys(l),x;for(f=0;f<y.length;++f)x=y[f],x!=="removeListener"&&this.removeAllListeners(x);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(s=l[t],typeof s=="function")this.removeListener(t,s);else if(s!==void 0)for(f=s.length-1;f>=0;f--)this.removeListener(t,s[f]);return this};function iC(e,t,s){var l=e._events;if(l===void 0)return[];var f=l[t];return f===void 0?[]:typeof f=="function"?s?[f.listener||f]:[f]:s?wM(f):sC(f,f.length)}Cn.prototype.listeners=function(t){return iC(this,t,!0)};Cn.prototype.rawListeners=function(t){return iC(this,t,!1)};Cn.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):oC.call(e,t)};Cn.prototype.listenerCount=oC;function oC(e){var t=this._events;if(t!==void 0){var s=t[e];if(typeof s=="function")return 1;if(s!==void 0)return s.length}return 0}Cn.prototype.eventNames=function(){return this._eventsCount>0?Kf(this._events):[]};function sC(e,t){for(var s=new Array(t),l=0;l<t;++l)s[l]=e[l];return s}function bM(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function wM(e){for(var t=new Array(e.length),s=0;s<t.length;++s)t[s]=e[s].listener||e[s];return t}function SM(e,t){return new Promise(function(s,l){function f(x){e.removeListener(t,y),l(x)}function y(){typeof e.removeListener=="function"&&e.removeListener("error",f),s([].slice.call(arguments))}aC(e,t,y,{once:!0}),t!=="error"&&TM(e,f,{once:!0})})}function TM(e,t,s){typeof e.on=="function"&&aC(e,"error",t,s)}function aC(e,t,s,l){if(typeof e.on=="function")l.once?e.once(t,s):e.on(t,s);else if(typeof e.addEventListener=="function")e.addEventListener(t,function f(y){l.once&&e.removeEventListener(t,f),s(y)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}var CM=Gv.exports;const kM=Fm(CM);let Pf;const EM=new Uint8Array(16);function IM(){if(!Pf&&(Pf=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Pf))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Pf(EM)}const Or=[];for(let e=0;e<256;++e)Or.push((e+256).toString(16).slice(1));function PM(e,t=0){return Or[e[t+0]]+Or[e[t+1]]+Or[e[t+2]]+Or[e[t+3]]+"-"+Or[e[t+4]]+Or[e[t+5]]+"-"+Or[e[t+6]]+Or[e[t+7]]+"-"+Or[e[t+8]]+Or[e[t+9]]+"-"+Or[e[t+10]]+Or[e[t+11]]+Or[e[t+12]]+Or[e[t+13]]+Or[e[t+14]]+Or[e[t+15]]}const AM=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),bw={randomUUID:AM};function MM(e,t,s){if(bw.randomUUID&&!t&&!e)return bw.randomUUID();e=e||{};const l=e.random||(e.rng||IM)();return l[6]=l[6]&15|64,l[8]=l[8]&63|128,PM(l)}const lC="3.7.7",zM=lC,Ou=typeof Buffer=="function",ww=typeof TextDecoder=="function"?new TextDecoder:void 0,Sw=typeof TextEncoder=="function"?new TextEncoder:void 0,LM="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",pd=Array.prototype.slice.call(LM),Af=(e=>{let t={};return e.forEach((s,l)=>t[s]=l),t})(pd),RM=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,$r=String.fromCharCode.bind(String),Tw=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):e=>new Uint8Array(Array.prototype.slice.call(e,0)),cC=e=>e.replace(/=/g,"").replace(/[+\/]/g,t=>t=="+"?"-":"_"),uC=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),hC=e=>{let t,s,l,f,y="";const x=e.length%3;for(let u=0;u<e.length;){if((s=e.charCodeAt(u++))>255||(l=e.charCodeAt(u++))>255||(f=e.charCodeAt(u++))>255)throw new TypeError("invalid character found");t=s<<16|l<<8|f,y+=pd[t>>18&63]+pd[t>>12&63]+pd[t>>6&63]+pd[t&63]}return x?y.slice(0,x-3)+"===".substring(x):y},qv=typeof btoa=="function"?e=>btoa(e):Ou?e=>Buffer.from(e,"binary").toString("base64"):hC,M0=Ou?e=>Buffer.from(e).toString("base64"):e=>{let s=[];for(let l=0,f=e.length;l<f;l+=4096)s.push($r.apply(null,e.subarray(l,l+4096)));return qv(s.join(""))},Xf=(e,t=!1)=>t?cC(M0(e)):M0(e),DM=e=>{if(e.length<2){var t=e.charCodeAt(0);return t<128?e:t<2048?$r(192|t>>>6)+$r(128|t&63):$r(224|t>>>12&15)+$r(128|t>>>6&63)+$r(128|t&63)}else{var t=65536+(e.charCodeAt(0)-55296)*1024+(e.charCodeAt(1)-56320);return $r(240|t>>>18&7)+$r(128|t>>>12&63)+$r(128|t>>>6&63)+$r(128|t&63)}},FM=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,dC=e=>e.replace(FM,DM),Cw=Ou?e=>Buffer.from(e,"utf8").toString("base64"):Sw?e=>M0(Sw.encode(e)):e=>qv(dC(e)),wu=(e,t=!1)=>t?cC(Cw(e)):Cw(e),kw=e=>wu(e,!0),BM=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,OM=e=>{switch(e.length){case 4:var t=(7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3),s=t-65536;return $r((s>>>10)+55296)+$r((s&1023)+56320);case 3:return $r((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return $r((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},pC=e=>e.replace(BM,OM),fC=e=>{if(e=e.replace(/\s+/g,""),!RM.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(e.length&3));let t,s="",l,f;for(let y=0;y<e.length;)t=Af[e.charAt(y++)]<<18|Af[e.charAt(y++)]<<12|(l=Af[e.charAt(y++)])<<6|(f=Af[e.charAt(y++)]),s+=l===64?$r(t>>16&255):f===64?$r(t>>16&255,t>>8&255):$r(t>>16&255,t>>8&255,t&255);return s},Hv=typeof atob=="function"?e=>atob(uC(e)):Ou?e=>Buffer.from(e,"base64").toString("binary"):fC,mC=Ou?e=>Tw(Buffer.from(e,"base64")):e=>Tw(Hv(e).split("").map(t=>t.charCodeAt(0))),gC=e=>mC(yC(e)),NM=Ou?e=>Buffer.from(e,"base64").toString("utf8"):ww?e=>ww.decode(mC(e)):e=>pC(Hv(e)),yC=e=>uC(e.replace(/[-_]/g,t=>t=="-"?"+":"/")),z0=e=>NM(yC(e)),$M=e=>{if(typeof e!="string")return!1;const t=e.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(t)||!/[^\s0-9a-zA-Z\-_]/.test(t)},_C=e=>({value:e,enumerable:!1,writable:!0,configurable:!0}),vC=function(){const e=(t,s)=>Object.defineProperty(String.prototype,t,_C(s));e("fromBase64",function(){return z0(this)}),e("toBase64",function(t){return wu(this,t)}),e("toBase64URI",function(){return wu(this,!0)}),e("toBase64URL",function(){return wu(this,!0)}),e("toUint8Array",function(){return gC(this)})},xC=function(){const e=(t,s)=>Object.defineProperty(Uint8Array.prototype,t,_C(s));e("toBase64",function(t){return Xf(this,t)}),e("toBase64URI",function(){return Xf(this,!0)}),e("toBase64URL",function(){return Xf(this,!0)})},jM=()=>{vC(),xC()},UM={version:lC,VERSION:zM,atob:Hv,atobPolyfill:fC,btoa:qv,btoaPolyfill:hC,fromBase64:z0,toBase64:wu,encode:wu,encodeURI:kw,encodeURL:kw,utob:dC,btou:pC,decode:z0,isValid:$M,fromUint8Array:Xf,toUint8Array:gC,extendString:vC,extendUint8Array:xC,extendBuiltins:jM};var VM=Object.defineProperty,bC=e=>{throw TypeError(e)},GM=(e,t,s)=>t in e?VM(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,Tn=(e,t,s)=>GM(e,typeof t!="symbol"?t+"":t,s),Zv=(e,t,s)=>t.has(e)||bC("Cannot "+s),Zt=(e,t,s)=>(Zv(e,t,"read from private field"),s?s.call(e):t.get(e)),Il=(e,t,s)=>t.has(e)?bC("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,s),Jc=(e,t,s,l)=>(Zv(e,t,"write to private field"),t.set(e,s),s),eo=(e,t,s)=>(Zv(e,t,"access private method"),s);const Yt={VISITOR:{code:null,flag:"visitor",name:"Visitor",latin:!0,isMode:!0,geocoding:!1},VISITOR_ENGLISH:{code:null,flag:"visitor_en",name:"Visitor English",latin:!0,isMode:!0,geocoding:!1},STYLE:{code:null,flag:"style",name:"Style",latin:!1,isMode:!0,geocoding:!1},STYLE_LOCK:{code:null,flag:"style_lock",name:"Style Lock",latin:!1,isMode:!0,geocoding:!1},...ep};function Ew(){if(typeof navigator>"u"){const e=Intl.DateTimeFormat().resolvedOptions().locale.split("-")[0];return I0(e)||Yt.ENGLISH}return Array.from(new Set(navigator.languages.map(e=>e.split("-")[0]))).map(e=>I0(e)).filter(e=>e)[0]??Yt.LOCAL}const Mi={maptilerLogoURL:"https://api.maptiler.com/resources/logo.svg",maptilerURL:"https://www.maptiler.com/",maptilerApiHost:"api.maptiler.com",rtlPluginURL:"https://cdn.maptiler.com/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.min.js",primaryLanguage:Yt.STYLE,secondaryLanguage:Yt.LOCAL,terrainSourceURL:"https://api.maptiler.com/tiles/terrain-rgb-v2/tiles.json",terrainSourceId:"maptiler-terrain"};Object.freeze(Mi);const wC=MM();class qM extends kM{constructor(){super(...arguments),Tn(this,"primaryLanguage",Mi.primaryLanguage),Tn(this,"secondaryLanguage"),Tn(this,"session",!0),Tn(this,"caching",!0),Tn(this,"_unit","metric"),Tn(this,"_apiKey","")}set unit(t){this._unit=t,this.emit("unit",t)}get unit(){return this._unit}set apiKey(t){this._apiKey=t,xu.apiKey=t,this.emit("apiKey",t)}get apiKey(){return this._apiKey}set fetch(t){xu.fetch=t}get fetch(){return xu.fetch}}const kr=new qM,{addProtocol:Iw}=mt,L0="localcache_source",R0="localcache",HM="maptiler_sdk",ZM=1e3,WM=100,D0=typeof caches<"u";function KM(e,t){if(D0&&kr.caching&&kr.session&&e.host===Mi.maptilerApiHost){if(t==="Source"&&e.href.includes("tiles.json"))return e.href.replace("https://",`${L0}://`);if(t==="Tile"||t==="Glyphs")return e.href.replace("https://",`${R0}://`)}return e.href}let C_;async function SC(){return C_||(C_=await caches.open(HM)),C_}let Pw=0;async function XM(){const e=await SC(),t=await e.keys(),s=t.slice(0,Math.max(t.length-ZM,0));for(const l of s)e.delete(l)}function YM(){Iw(L0,async(e,t)=>{if(!e.url)throw new Error("");e.url=e.url.replace(`${L0}://`,"https://");const s=e;s.signal=t.signal;const l=await fetch(e.url,s),f=await l.json();return f.tiles&&f.tiles.length>0&&(f.tiles[0]+=`&last-modified=${l.headers.get("Last-Modified")}`),{data:f,cacheControl:l.headers.get("Cache-Control"),expires:l.headers.get("Expires")}}),Iw(R0,async(e,t)=>{if(!e.url)throw new Error("");e.url=e.url.replace(`${R0}://`,"https://");const s=new URL(e.url),l=new URL(s);l.searchParams.delete("mtsid"),l.searchParams.delete("key");const f=l.toString(),y=new URL(s);y.searchParams.delete("last-modified");const x=y.toString(),u=async D=>({data:await D.arrayBuffer(),cacheControl:D.headers.get("Cache-Control"),expires:D.headers.get("Expires")}),P=await SC(),L=await P.match(f);if(L)return u(L);const U=e;U.signal=t.signal;const N=await fetch(x,U);return N.status>=200&&N.status<300&&(P.put(f,N.clone()).catch(()=>{}),++Pw>WM&&(XM(),Pw=0)),u(N)})}function JM(){if(typeof window>"u")return;const e=mt.getRTLTextPluginStatus();if(e==="unavailable"||e==="requested")try{mt.setRTLTextPlugin(Mi.rtlPluginURL,!0)}catch{}}function QM(e,t){for(const s of e)typeof t[s]=="function"&&(t[s]=t[s].bind(t))}function Su(e,t,s){const l=window.document.createElement(e);return t!==void 0&&(l.className=t),s&&s.appendChild(l),l}function TC(e){e.parentNode&&e.parentNode.removeChild(e)}function Aw(e,t){let s=null;try{s=new URL(e)}catch{return{url:e}}return s.host===Mi.maptilerApiHost&&(s.searchParams.has("key")||s.searchParams.append("key",kr.apiKey),kr.session&&s.searchParams.append("mtsid",wC)),{url:KM(s,t)}}function Mw(e){return(t,s)=>{if(e!=null){const l=e(t,s),f=Aw((l==null?void 0:l.url)??"",s);return{...l,...f}}return Aw(t,s)}}function CC(){return Math.random().toString(36).substring(2)}function eg(e){return/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/gi.test(e)}function e5(e){try{return JSON.parse(e)}catch{}return null}function t5(){return document.createElement("canvas").getContext("webgl2")?null:typeof WebGL2RenderingContext<"u"?"Graphic rendering with WebGL2 has been disabled or is not supported by your graphic card. The map cannot be displayed.":"Your browser does not support graphic rendering with WebGL2. The map cannot be displayed."}function n5(e){const t=t5();if(!t)return;let s=null;if(typeof e=="string"?s=document.getElementById(e):e instanceof HTMLElement&&(s=e),!s)throw new Error("The Map container must be provided.");const l=document.createElement("div");throw l.innerHTML=t,l.classList.add("no-webgl-support-div"),s.appendChild(l),new Error(t)}(class extends mt.Marker{addTo(e){return super.addTo(e)}});class r5 extends mt.Popup{addTo(t){return super.addTo(t)}}class _F extends mt.Style{constructor(t,s={}){super(t,s)}}class vF extends mt.CanvasSource{onAdd(t){super.onAdd(t)}}class xF extends mt.GeoJSONSource{onAdd(t){super.onAdd(t)}}class bF extends mt.ImageSource{onAdd(t){super.onAdd(t)}}class wF extends mt.RasterTileSource{onAdd(t){super.onAdd(t)}}class SF extends mt.RasterDEMTileSource{onAdd(t){super.onAdd(t)}}class TF extends mt.VectorTileSource{onAdd(t){super.onAdd(t)}}class CF extends mt.VideoSource{onAdd(t){super.onAdd(t)}}class i5 extends mt.NavigationControl{onAdd(t){return super.onAdd(t)}}class o5 extends mt.GeolocateControl{onAdd(t){return super.onAdd(t)}}class kF extends mt.AttributionControl{onAdd(t){return super.onAdd(t)}}class s5 extends mt.LogoControl{onAdd(t){return super.onAdd(t)}}class a5 extends mt.ScaleControl{onAdd(t){return super.onAdd(t)}}class l5 extends mt.FullscreenControl{onAdd(t){return super.onAdd(t)}}class EF extends mt.TerrainControl{onAdd(t){return super.onAdd(t)}}class IF extends mt.BoxZoomHandler{constructor(t,s){super(t,s)}}class PF extends mt.ScrollZoomHandler{constructor(t,s){super(t,s)}}class AF extends mt.CooperativeGesturesHandler{constructor(t,s){super(t,s)}}class MF extends mt.KeyboardHandler{constructor(t){super(t)}}class zF extends mt.TwoFingersTouchPitchHandler{constructor(t){super(t)}}class LF extends mt.MapWheelEvent{constructor(t,s,l){super(t,s,l)}}class RF extends mt.MapTouchEvent{constructor(t,s,l){super(t,s,l)}}class DF extends mt.MapMouseEvent{constructor(t,s,l,f={}){super(t,s,l,f)}}class zw extends s5{constructor(t={}){super(t),Tn(this,"logoURL",""),Tn(this,"linkURL",""),this.logoURL=t.logoURL??Mi.maptilerLogoURL,this.linkURL=t.linkURL??Mi.maptilerURL}onAdd(t){this._map=t,this._compact=this.options.compact??!1,this._container=window.document.createElement("div"),this._container.className="maplibregl-ctrl";const s=window.document.createElement("a");return s.style.backgroundRepeat="no-repeat",s.style.cursor="pointer",s.style.display="block",s.style.height="23px",s.style.margin="0 0 -4px -4px",s.style.overflow="hidden",s.style.width="88px",s.style.backgroundImage=`url(${this.logoURL})`,s.style.backgroundSize="100px 30px",s.style.width="100px",s.style.height="30px",s.target="_blank",s.rel="noopener",s.href=this.linkURL,s.setAttribute("aria-label","MapTiler logo"),s.setAttribute("rel","noopener"),this._container.appendChild(s),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}}function Lw(e){return e?typeof e=="string"||e instanceof String?!e.startsWith("http")&&e.toLowerCase().includes(".json")?e:XT(e):e instanceof YT?e.getExpandedStyleURL():e instanceof JT?e.getDefaultVariant().getExpandedStyleURL():e:QT[A0[0].referenceStyleID].getDefaultVariant().getExpandedStyleURL()}class c5{constructor(){Tn(this,"_map"),Tn(this,"_container"),Tn(this,"_terrainButton"),QM(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(t){return this._map=t,this._container=Su("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=Su("button","maplibregl-ctrl-terrain",this._container),Su("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){TC(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.hasTerrain()?this._map.disableTerrain():this._map.enableTerrain(),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.hasTerrain()?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))}}class u5 extends i5{constructor(t={}){super({showCompass:t.showCompass??!0,showZoom:t.showZoom??!0,visualizePitch:t.visualizePitch??!0}),Tn(this,"_rotateCompassArrow",()=>{const s=this.options.visualizePitch?`scale(${Math.min(1.5,1/Math.cos(this._map.transform.pitch*(Math.PI/180))**.5)}) rotateX(${Math.min(70,this._map.transform.pitch)}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=s}),this._compass&&(this._compass.removeEventListener("click",this._compass.clickFunction),this._compass.addEventListener("click",s=>{this._map.getPitch()===0?this._map.easeTo({pitch:Math.min(this._map.getMaxPitch(),80)}):this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:s}):this._map.resetNorth({},{originalEvent:s})}))}_createButton(t,s){const l=super._createButton(t,s);return l.clickFunction=s,l}}const Rw=mt.Marker,Dw=mt.LngLat,h5=mt.LngLatBounds;class d5 extends o5{constructor(){super(...arguments),Tn(this,"lastUpdatedCenter",new Dw(0,0)),Tn(this,"_updateCamera",t=>{var s,l;const f=new Dw(t.coords.longitude,t.coords.latitude),y=t.coords.accuracy,x={bearing:this._map.getBearing(),...this.options.fitBoundsOptions,linear:!0},u=this._map.getZoom();u>(((l=(s=this.options)==null?void 0:s.fitBoundsOptions)==null?void 0:l.maxZoom)??30)&&(x.zoom=u),this._map.fitBounds(h5.fromLngLat(f,y),x,{geolocateSource:!0});let P=!1;const L=()=>{P=!0};this._map.once("click",L),this._map.once("dblclick",L),this._map.once("dragstart",L),this._map.once("mousedown",L),this._map.once("touchstart",L),this._map.once("wheel",L),this._map.once("moveend",()=>{this._map.off("click",L),this._map.off("dblclick",L),this._map.off("dragstart",L),this._map.off("mousedown",L),this._map.off("touchstart",L),this._map.off("wheel",L),!P&&(this.lastUpdatedCenter=this._map.getCenter())})}),Tn(this,"_finishSetupUI",t=>{if(this._map){if(t===!1){const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s)}else{const s=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Su("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Rw({element:this._dotElement}),this._circleElement=Su("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Rw({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("move",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("moveend",s=>{const l=s.originalEvent&&s.originalEvent.type==="resize",f=this.lastUpdatedCenter.distanceTo(this._map.getCenter());!s.geolocateSource&&this._watchState==="ACTIVE_LOCK"&&!l&&f>1&&(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new Event("trackuserlocationend")))})}}),Tn(this,"_onZoom",()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()})}_updateCircleRadius(){if(this._watchState!=="BACKGROUND"&&this._watchState!=="ACTIVE_LOCK")return;const t=[this._lastKnownPosition.coords.longitude,this._lastKnownPosition.coords.latitude],s=this._map.project(t),l=this._map.unproject([s.x,s.y]),f=this._map.unproject([s.x+20,s.y]),y=l.distanceTo(f)/20,x=Math.ceil(2*this._accuracy/y);this._circleElement.style.width=`${x}px`,this._circleElement.style.height=`${x}px`}}var to,ps,Ml,zl,bo,Yf,gi,kC,wo,EC;class k_{constructor(t,s){Il(this,gi),Il(this,to),Tn(this,"map"),Il(this,ps),Il(this,Ml),Il(this,zl),Il(this,bo,!1),Il(this,Yf),t.style!==void 0&&Jc(this,bo,!0),Jc(this,to,{zoomAdjust:-4,position:"top-right",...s,forceNoAttributionControl:!0,attributionControl:!1,navigationControl:!1,geolocateControl:!1,maptilerLogo:!1,minimap:!1,hash:!1,pitchAdjust:!1,...t,containerStyle:{border:"1px solid #000",width:"400px",height:"300px",...t.containerStyle??{}}}),t.lockZoom!==void 0&&(Zt(this,to).minZoom=t.lockZoom,Zt(this,to).maxZoom=t.lockZoom)}setStyle(t,s){Zt(this,bo)||this.map.setStyle(t,s),eo(this,gi,wo).call(this)}addLayer(t,s){return Zt(this,bo)||this.map.addLayer(t,s),eo(this,gi,wo).call(this),this.map}moveLayer(t,s){return Zt(this,bo)||this.map.moveLayer(t,s),eo(this,gi,wo).call(this),this.map}removeLayer(t){return Zt(this,bo)||this.map.removeLayer(t),eo(this,gi,wo).call(this),this}setLayerZoomRange(t,s,l){return Zt(this,bo)||this.map.setLayerZoomRange(t,s,l),eo(this,gi,wo).call(this),this}setFilter(t,s,l){return Zt(this,bo)||this.map.setFilter(t,s,l),eo(this,gi,wo).call(this),this}setPaintProperty(t,s,l,f){return Zt(this,bo)||this.map.setPaintProperty(t,s,l,f),eo(this,gi,wo).call(this),this}setLayoutProperty(t,s,l,f){return Zt(this,bo)||this.map.setLayoutProperty(t,s,l,f),eo(this,gi,wo).call(this),this}setGlyphs(t,s){return Zt(this,bo)||this.map.setGlyphs(t,s),eo(this,gi,wo).call(this),this}onAdd(t){Jc(this,ps,t),Jc(this,Ml,Su("div","maplibregl-ctrl maplibregl-ctrl-group"));for(const[s,l]of Object.entries(Zt(this,to).containerStyle))Zt(this,Ml).style.setProperty(s,l);return Zt(this,to).container=Zt(this,Ml),Zt(this,to).zoom=t.getZoom()+Zt(this,to).zoomAdjust,this.map=new IC(Zt(this,to)),this.map.once("style.load",()=>{this.map.resize()}),this.map.once("load",()=>{eo(this,gi,kC).call(this,Zt(this,to).parentRect),Jc(this,Yf,eo(this,gi,EC).call(this))}),Zt(this,Ml)}onRemove(){var t;(t=Zt(this,Yf))==null||t.call(this),TC(Zt(this,Ml))}}to=new WeakMap,ps=new WeakMap,Ml=new WeakMap,zl=new WeakMap,bo=new WeakMap,Yf=new WeakMap,gi=new WeakSet,kC=function(e){e===void 0||e.linePaint===void 0&&e.fillPaint===void 0||(Jc(this,zl,{type:"Feature",properties:{name:"parentRect"},geometry:{type:"Polygon",coordinates:[[[],[],[],[],[]]]}}),this.map.addSource("parentRect",{type:"geojson",data:Zt(this,zl)}),(e.lineLayout!==void 0||e.linePaint!==void 0)&&this.map.addLayer({id:"parentRectOutline",type:"line",source:"parentRect",layout:{...e.lineLayout},paint:{"line-color":"#FFF","line-width":1,"line-opacity":.85,...e.linePaint}}),e.fillPaint!==void 0&&this.map.addLayer({id:"parentRectFill",type:"fill",source:"parentRect",layout:{},paint:{"fill-color":"#08F","fill-opacity":.135,...e.fillPaint}}),eo(this,gi,wo).call(this))},wo=function(){if(Zt(this,zl)===void 0)return;const{devicePixelRatio:e}=window,t=Zt(this,ps).getCanvas(),s=t.width/e,l=t.height/e,f=Zt(this,ps).unproject.bind(Zt(this,ps)),y=f([0,0]),x=f([s,0]),u=f([0,l]),P=f([s,l]);Zt(this,zl).geometry.coordinates=[[u.toArray(),P.toArray(),x.toArray(),y.toArray(),u.toArray()]],this.map.getSource("parentRect").setData(Zt(this,zl))},EC=function(){const{pitchAdjust:e}=Zt(this,to),t=()=>{y("parent")},s=()=>{y("minimap")},l=()=>{Zt(this,ps).on("move",t),this.map.on("move",s)},f=()=>{Zt(this,ps).off("move",t),this.map.off("move",s)},y=x=>{f();const u=x==="parent"?Zt(this,ps):this.map,P=x==="parent"?this.map:Zt(this,ps),L=u.getCenter(),U=u.getZoom()+Zt(this,to).zoomAdjust*(x==="parent"?1:-1),N=u.getBearing(),D=u.getPitch();P.jumpTo({center:L,zoom:U,bearing:N,pitch:e?D:0}),eo(this,gi,wo).call(this),l()};return l(),()=>{f()}};const p5={POINT:"POINT",COUNTRY:"COUNTRY"};class IC extends mt.Map{constructor(t){n5(t.container),t.apiKey&&(kr.apiKey=t.apiKey);const s=Lw(t.style),l=location.hash;kr.apiKey||console.warn("MapTiler Cloud API key is not set. Visit https://maptiler.com and try Cloud for free!");let f={compact:!1};t.customAttribution?f.customAttribution=t.customAttribution:t.attributionControl&&typeof t.attributionControl=="object"&&(f={...f,...t.attributionControl}),super({...t,style:s,maplibreLogo:!1,transformRequest:Mw(t.transformRequest),attributionControl:t.forceNoAttributionControl===!0?!1:f}),Tn(this,"isTerrainEnabled",!1),Tn(this,"terrainExaggeration",1),Tn(this,"primaryLanguage"),Tn(this,"terrainGrowing",!1),Tn(this,"terrainFlattening",!1),Tn(this,"minimap"),Tn(this,"forceLanguageUpdate"),Tn(this,"languageAlwaysBeenStyle"),Tn(this,"isReady",!1),kr.caching&&!D0&&console.warn("The cache API is only available in secure contexts. More info at https://developer.mozilla.org/en-US/docs/Web/API/Cache"),kr.caching&&D0&&YM(),this.primaryLanguage=t.language??kr.primaryLanguage,this.forceLanguageUpdate=!(this.primaryLanguage===Yt.STYLE||this.primaryLanguage===Yt.STYLE_LOCK),this.languageAlwaysBeenStyle=this.primaryLanguage===Yt.STYLE,this.terrainExaggeration=t.terrainExaggeration??this.terrainExaggeration,this.once("styledata",async()=>{if(!t.geolocate||t.center||t.hash&&l)return;try{if(t.geolocate===p5.COUNTRY){await this.fitToIpBounds();return}}catch(U){console.warn(U.message)}let L;try{await this.centerOnIpPoint(t.zoom),L=this.getCameraHash()}catch(U){console.warn(U.message)}(await navigator.permissions.query({name:"geolocation"})).state==="granted"&&navigator.geolocation.getCurrentPosition(U=>{L===this.getCameraHash()&&(this.terrain?this.easeTo({center:[U.coords.longitude,U.coords.latitude],zoom:t.zoom||12,duration:2e3}):this.once("terrain",()=>{this.easeTo({center:[U.coords.longitude,U.coords.latitude],zoom:t.zoom||12,duration:2e3})}))},null,{maximumAge:24*3600*1e3,timeout:5e3,enableHighAccuracy:!1})}),this.on("styledata",()=>{this.setPrimaryLanguage(this.primaryLanguage)}),this.on("styledata",()=>{this.getTerrain()===null&&this.isTerrainEnabled&&this.enableTerrain(this.terrainExaggeration)}),this.once("load",async()=>{let L={logo:null};try{const U=Object.keys(this.style.sourceCaches).map(D=>this.getSource(D)).filter(D=>D&&"url"in D&&typeof D.url=="string"&&(D==null?void 0:D.url.includes("tiles.json"))),N=new URL(U[0].url);N.searchParams.has("key")||N.searchParams.append("key",kr.apiKey),L=await(await fetch(N.href)).json()}catch{}if(t.forceNoAttributionControl!==!0)if("logo"in L&&L.logo){const U=L.logo;this.addControl(new zw({logoURL:U}),t.logoPosition)}else t.maptilerLogo&&this.addControl(new zw,t.logoPosition);if(t.scaleControl){const U=t.scaleControl===!0||t.scaleControl===void 0?"bottom-right":t.scaleControl,N=new a5({unit:kr.unit});this.addControl(N,U),kr.on("unit",D=>{N.setUnit(D)})}if(t.navigationControl!==!1){const U=t.navigationControl===!0||t.navigationControl===void 0?"top-right":t.navigationControl;this.addControl(new u5,U)}if(t.geolocateControl!==!1){const U=t.geolocateControl===!0||t.geolocateControl===void 0?"top-right":t.geolocateControl;this.addControl(new d5({positionOptions:{enableHighAccuracy:!0,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!0,showAccuracyCircle:!0,showUserLocation:!0}),U)}if(t.terrainControl){const U=t.terrainControl===!0||t.terrainControl===void 0?"top-right":t.terrainControl;this.addControl(new c5,U)}if(t.fullscreenControl){const U=t.fullscreenControl===!0||t.fullscreenControl===void 0?"top-right":t.fullscreenControl;this.addControl(new l5({}),U)}this.isReady=!0,this.fire("ready",{target:this})});let y=!1,x=!1,u;this.once("ready",()=>{y=!0,x&&this.fire("loadWithTerrain",u)}),this.once("style.load",()=>{const{minimap:L}=t;if(typeof L=="object"){const{zoom:U,center:N,style:D,language:se,apiKey:ne,maptilerLogo:ee,antialias:ke,refreshExpiredTiles:X,maxBounds:Z,scrollZoom:W,minZoom:pe,maxZoom:_e,boxZoom:be,locale:xe,fadeDuration:Re,crossSourceCollisions:tt,clickTolerance:Oe,bounds:He,fitBoundsOptions:vt,pixelRatio:dt,validateStyle:ht}=t;this.minimap=new k_(L,{zoom:U,center:N,style:D,language:se,apiKey:ne,container:"null",maptilerLogo:ee,antialias:ke,refreshExpiredTiles:X,maxBounds:Z,scrollZoom:W,minZoom:pe,maxZoom:_e,boxZoom:be,locale:xe,fadeDuration:Re,crossSourceCollisions:tt,clickTolerance:Oe,bounds:He,fitBoundsOptions:vt,pixelRatio:dt,validateStyle:ht}),this.addControl(this.minimap,L.position??"bottom-left")}else L===!0?(this.minimap=new k_({},t),this.addControl(this.minimap,"bottom-left")):L!==void 0&&L!==!1&&(this.minimap=new k_({},t),this.addControl(this.minimap,L))});const P=L=>{L.terrain&&(x=!0,u={type:"loadWithTerrain",target:this,terrain:L.terrain},this.off("terrain",P),y&&this.fire("loadWithTerrain",u))};this.on("terrain",P),t.terrain&&this.enableTerrain(t.terrainExaggeration??this.terrainExaggeration)}async onLoadAsync(){return new Promise(t=>{if(this.loaded())return t(this);this.once("load",()=>{t(this)})})}async onReadyAsync(){return new Promise(t=>{if(this.isReady)return t(this);this.once("ready",()=>{t(this)})})}async onLoadWithTerrainAsync(){return new Promise(t=>{if(this.isReady&&this.terrain)return t(this);this.once("loadWithTerrain",()=>{t(this)})})}setStyle(t,s){var l;return(l=this.minimap)==null||l.setStyle(t),this.forceLanguageUpdate=!0,this.once("idle",()=>{this.forceLanguageUpdate=!1}),super.setStyle(Lw(t),s)}addLayer(t,s){var l;return(l=this.minimap)==null||l.addLayer(t,s),super.addLayer(t,s)}moveLayer(t,s){var l;return(l=this.minimap)==null||l.moveLayer(t,s),super.moveLayer(t,s)}removeLayer(t){var s;return(s=this.minimap)==null||s.removeLayer(t),super.removeLayer(t)}setLayerZoomRange(t,s,l){var f;return(f=this.minimap)==null||f.setLayerZoomRange(t,s,l),super.setLayerZoomRange(t,s,l)}setFilter(t,s,l){var f;return(f=this.minimap)==null||f.setFilter(t,s,l),super.setFilter(t,s,l)}setPaintProperty(t,s,l,f){var y;return(y=this.minimap)==null||y.setPaintProperty(t,s,l,f),super.setPaintProperty(t,s,l,f)}setLayoutProperty(t,s,l,f){var y;return(y=this.minimap)==null||y.setLayoutProperty(t,s,l,f),super.setLayoutProperty(t,s,l,f)}setGlyphs(t,s){var l;return(l=this.minimap)==null||l.setGlyphs(t,s),super.setGlyphs(t,s)}getStyleLanguage(){return!this.style.stylesheet.metadata||typeof this.style.stylesheet.metadata!="object"?null:"maptiler:language"in this.style.stylesheet.metadata&&typeof this.style.stylesheet.metadata["maptiler:language"]=="string"?P0(this.style.stylesheet.metadata["maptiler:language"]):null}setLanguage(t){var s,l;(l=(s=this.minimap)==null?void 0:s.map)==null||l.setLanguage(t),this.onStyleReady(()=>{this.setPrimaryLanguage(t)})}setPrimaryLanguage(t){const s=this.getStyleLanguage(),l=pM(t,Yt);if(!l){console.warn(`The language "${l}" is not supported.`);return}if(!(l.flag===Yt.STYLE.flag&&s&&(s.flag===Yt.AUTO.flag||s.flag===Yt.VISITOR.flag))&&(l.flag!==Yt.STYLE.flag&&(this.languageAlwaysBeenStyle=!1),this.languageAlwaysBeenStyle||this.primaryLanguage===l&&!this.forceLanguageUpdate))return;if(this.primaryLanguage.flag===Yt.STYLE_LOCK.flag){console.warn("The language cannot be changed because this map has been instantiated with the STYLE_LOCK language flag.");return}this.primaryLanguage=l;let f=l;if(l.flag===Yt.STYLE.flag){if(!s){console.warn("The style has no default languages or has an invalid one.");return}f=s}let y=Yt.LOCAL.flag,x=`{${y}}`;f.flag===Yt.VISITOR.flag?(y=Ew().flag,x=["case",["all",["has",y],["has",Yt.LOCAL.flag]],["case",["==",["get",y],["get",Yt.LOCAL.flag]],["get",Yt.LOCAL.flag],["format",["get",y],{"font-scale":.8},`
`,["get",Yt.LOCAL.flag],{"font-scale":1.1}]],["get",Yt.LOCAL.flag]]):f.flag===Yt.VISITOR_ENGLISH.flag?(y=Yt.ENGLISH.flag,x=["case",["all",["has",y],["has",Yt.LOCAL.flag]],["case",["==",["get",y],["get",Yt.LOCAL.flag]],["get",Yt.LOCAL.flag],["format",["get",y],{"font-scale":.8},`
`,["get",Yt.LOCAL.flag],{"font-scale":1.1}]],["get",Yt.LOCAL.flag]]):f.flag===Yt.AUTO.flag?(y=Ew().flag,x=["case",["has",y],["get",y],["get",Yt.LOCAL.flag]]):f===Yt.LOCAL?(y=Yt.LOCAL.flag,x=`{${y}}`):(y=f.flag,x=["case",["has",y],["get",y],["get",Yt.LOCAL.flag]]);const{layers:u}=this.getStyle();for(const P of u){if(P.type!=="symbol")continue;const L=P,U=this.getSource(L.source);if(!U||!("url"in U&&typeof U.url=="string")||new URL(U.url).host!==Mi.maptilerApiHost)continue;const{id:N,layout:D}=L;if(!D||!("text-field"in D))continue;const se=this.getLayoutProperty(N,"text-field");typeof se=="string"&&(se.toLowerCase().includes("ref")||se.toLowerCase().includes("housenumber"))||this.setLayoutProperty(N,"text-field",x)}}getPrimaryLanguage(){return this.primaryLanguage}getTerrainExaggeration(){return this.terrainExaggeration}hasTerrain(){return this.isTerrainEnabled}growTerrain(t,s=1e3){if(!this.terrain)return;const l=performance.now(),f=this.terrain.exaggeration,y=t-f,x=()=>{if(!this.terrain||this.terrainFlattening)return;const u=(performance.now()-l)/s;if(u<.99){const P=1-(1-u)**4,L=f+P*y;this.terrain.exaggeration=L,requestAnimationFrame(x)}else this.terrainGrowing=!1,this.terrainFlattening=!1,this.terrain.exaggeration=t;this._elevationFreeze=!1,this.triggerRepaint()};this.terrainGrowing=!0,this.terrainFlattening=!1,requestAnimationFrame(x)}enableTerrain(t=this.terrainExaggeration){if(t<0){console.warn("Terrain exaggeration cannot be negative.");return}const s=async f=>{!this.terrain||f.type!=="data"||f.dataType!=="source"||!("source"in f)||f.sourceId!=="maptiler-terrain"||f.source.type!=="raster-dem"||f.isSourceLoaded&&(this.off("data",s),this.growTerrain(t))},l=()=>{this.isTerrainEnabled=!0,this.terrainExaggeration=t,this.on("data",s),this.addSource(Mi.terrainSourceId,{type:"raster-dem",url:Mi.terrainSourceURL}),this.setTerrain({source:Mi.terrainSourceId,exaggeration:0})};if(this.getTerrain()){this.isTerrainEnabled=!0,this.growTerrain(t);return}this.loaded()||this.isTerrainEnabled?l():this.once("load",()=>{this.getTerrain()&&this.getSource(Mi.terrainSourceId)||l()})}disableTerrain(){if(!this.terrain)return;this.isTerrainEnabled=!1;const t=1*1e3,s=performance.now(),l=this.terrain.exaggeration,f=()=>{if(!this.terrain||this.terrainGrowing)return;const y=(performance.now()-s)/t;if(this._elevationFreeze=!1,y<.99){const x=(1-y)**4,u=l*x;this.terrain.exaggeration=u,requestAnimationFrame(f)}else this.terrain.exaggeration=0,this.terrainGrowing=!1,this.terrainFlattening=!1,this.setTerrain(),this.getSource(Mi.terrainSourceId)&&this.removeSource(Mi.terrainSourceId);this.triggerRepaint()};this.terrainGrowing=!1,this.terrainFlattening=!0,requestAnimationFrame(f)}setTerrainExaggeration(t,s=!0){!s&&this.terrain?(this.terrainExaggeration=t,this.terrain.exaggeration=t,this.triggerRepaint()):this.enableTerrain(t)}onStyleReady(t){this.isStyleLoaded()?t():this.once("styledata",()=>{t()})}async fitToIpBounds(){const t=await _w.info();this.fitBounds(t.country_bounds,{duration:0,padding:100})}async centerOnIpPoint(t){const s=await _w.info();this.jumpTo({center:[(s==null?void 0:s.longitude)??0,(s==null?void 0:s.latitude)??0],zoom:t||11})}getCameraHash(){const t=new Float32Array(5),s=this.getCenter();return t[0]=s.lng,t[1]=s.lat,t[2]=this.getZoom(),t[3]=this.getPitch(),t[4]=this.getBearing(),UM.fromUint8Array(new Uint8Array(t.buffer))}getSdkConfig(){return kr}getMaptilerSessionId(){return wC}setTransformRequest(t){return super.setTransformRequest(Mw(t)),this}}function Wv(e){if(typeof DOMParser<"u"){const t=new DOMParser().parseFromString(e,"application/xml");if(t.querySelector("parsererror"))throw new Error("The provided string is not valid XML");return t}throw new Error("No XML parser found")}function PC(e,t){if(!e.hasChildNodes())return!1;for(const s of Array.from(e.childNodes)){const l=s.nodeName;if(typeof l=="string"&&l.trim().toLowerCase()===t.toLowerCase())return!0}return!1}function Fw(e){if(typeof XMLSerializer<"u")return new XMLSerializer().serializeToString(e);throw new Error("No XML serializer found")}function AC(e){const t=typeof e=="string"?Wv(e):e;if(!PC(t,"gpx"))throw new Error("The XML document is not valid GPX");const s=Ir(t,"trk"),l=Ir(t,"rte"),f=Ir(t,"wpt"),y={type:"FeatureCollection",features:[]};for(const x of Array.from(s)){const u=y5(x);u&&y.features.push(u)}for(const x of Array.from(l)){const u=_5(x);u&&y.features.push(u)}for(const x of Array.from(f))y.features.push(v5(x));return y}function MC(e,t){let s=e;if(typeof s=="string"&&(s=Wv(s)),!PC(s,"kml"))throw new Error("The XML document is not valid KML");const l={type:"FeatureCollection",features:[]},f={},y={},x={},u=Ir(s,"Placemark"),P=Ir(s,"Style"),L=Ir(s,"StyleMap");for(const U of Array.from(P)){const N=Ow(Fw(U)).toString(16);f[`#${Ul(U,"id")}`]=N,y[N]=U}for(const U of Array.from(L)){f[`#${Ul(U,"id")}`]=Ow(Fw(U)).toString(16);const N=Ir(U,"Pair"),D={};for(const se of Array.from(N))D[un(At(se,"key"))??""]=un(At(se,"styleUrl"));x[`#${Ul(U,"id")}`]=D}for(const U of Array.from(u))l.features=l.features.concat(g5(U,f,y,x));return l}function Bw(e){if(e===null)return["#000000",1];let t="",s=1,l=e;return l.substring(0,1)==="#"&&(l=l.substring(1)),(l.length===6||l.length===3)&&(t=l),l.length===8&&(s=Number.parseInt(l.substring(0,2),16)/255,t=`#${l.substring(6,8)}${l.substring(4,6)}${l.substring(2,4)}`),[t??"#000000",s??1]}function f5(e){return RC(e.split(" "))}function m5(e){let t=Ir(e,"coord");const s=[],l=[];t.length===0&&(t=Ir(e,"gx:coord"));for(const y of Array.from(t))s.push(f5(un(y)??""));const f=Ir(e,"when");for(const y of Array.from(f))l.push(un(y));return{coords:s,times:l}}function Jf(e){const t=["Polygon","LineString","Point","Track","gx:Track"];let s,l,f,y,x;const u=[],P=[];if(At(e,"MultiGeometry")!==null)return Jf(At(e,"MultiGeometry"));if(At(e,"MultiTrack")!==null)return Jf(At(e,"MultiTrack"));if(At(e,"gx:MultiTrack")!==null)return Jf(At(e,"gx:MultiTrack"));for(f=0;f<t.length;f++)if(l=Ir(e,t[f]),l){for(y=0;y<l.length;y++)if(s=l[y],t[f]==="Point")u.push({type:"Point",coordinates:DC(un(At(s,"coordinates"))??"")});else if(t[f]==="LineString")u.push({type:"LineString",coordinates:$w(un(At(s,"coordinates"))??"")});else if(t[f]==="Polygon"){const L=Ir(s,"LinearRing"),U=[];for(x=0;x<L.length;x++)U.push($w(un(At(L[x],"coordinates"))??""));u.push({type:"Polygon",coordinates:U})}else if(t[f]==="Track"||t[f]==="gx:Track"){const L=m5(s);u.push({type:"LineString",coordinates:L.coords}),L.times.length&&P.push(L.times)}}return{geoms:u,coordTimes:P}}function g5(e,t,s,l){const f=Jf(e),y={},x=un(At(e,"name")),u=un(At(e,"address")),P=un(At(e,"description")),L=At(e,"TimeSpan"),U=At(e,"TimeStamp"),N=At(e,"ExtendedData"),D=At(e,"visibility");let se,ne=un(At(e,"styleUrl")),ee=At(e,"LineStyle"),ke=At(e,"PolyStyle");if(!f.geoms.length)return[];if(x&&(y.name=x),u&&(y.address=u),ne){ne[0]!=="#"&&(ne=`#${ne}`),y.styleUrl=ne,t[ne]&&(y.styleHash=t[ne]),l[ne]&&(y.styleMapHash=l[ne],y.styleHash=t[l[ne].normal??""]);const Z=s[y.styleHash??""];if(Z){ee||(ee=At(Z,"LineStyle")),ke||(ke=At(Z,"PolyStyle"));const W=At(Z,"IconStyle");if(W){const pe=At(W,"Icon");if(pe){const _e=un(At(pe,"href"));_e&&(y.icon=_e)}}}}if(P&&(y.description=P),L){const Z=un(At(L,"begin")),W=un(At(L,"end"));Z&&W&&(y.timespan={begin:Z,end:W})}if(U!==null&&(y.timestamp=un(At(U,"when"))??new Date().toISOString()),ee!==null){const Z=Bw(un(At(ee,"color"))),W=Z[0],pe=Z[1],_e=Number.parseFloat(un(At(ee,"width"))??"");W&&(y.stroke=W),Number.isNaN(pe)||(y["stroke-opacity"]=pe),Number.isNaN(_e)||(y["stroke-width"]=_e)}if(ke){const Z=Bw(un(At(ke,"color"))),W=Z[0],pe=Z[1],_e=un(At(ke,"fill")),be=un(At(ke,"outline"));W&&(y.fill=W),Number.isNaN(pe)||(y["fill-opacity"]=pe),_e&&(y["fill-opacity"]=_e==="1"?y["fill-opacity"]||1:0),be&&(y["stroke-opacity"]=be==="1"?y["stroke-opacity"]||1:0)}if(N){const Z=Ir(N,"Data"),W=Ir(N,"SimpleData");for(se=0;se<Z.length;se++)y[Z[se].getAttribute("name")??""]=un(At(Z[se],"value"))??"";for(se=0;se<W.length;se++)y[W[se].getAttribute("name")??""]=un(W[se])??""}D!==null&&(y.visibility=un(D)??""),f.coordTimes.length!==0&&(y.coordTimes=f.coordTimes.length===1?f.coordTimes[0]:f.coordTimes);const X={type:"Feature",geometry:f.geoms.length===1?f.geoms[0]:{type:"GeometryCollection",geometries:f.geoms},properties:y};return Ul(e,"id")&&(X.id=Ul(e,"id")??void 0),[X]}function zC(e,t){const s=Ir(e,t),l=[],f=[];let y=[];const x=s.length;if(!(x<2)){for(let u=0;u<x;u++){const P=FC(s[u]);l.push(P.coordinates),P.time&&f.push(P.time),(P.heartRate||y.length)&&(y.length===0&&(y=new Array(u).fill(null)),y.push(P.heartRate))}return{line:l,times:f,heartRates:y}}}function y5(e){const t=Ir(e,"trkseg"),s=[],l=[],f=[];let y;for(let u=0;u<t.length;u++)if(y=zC(t[u],"trkpt"),y!==void 0&&(y.line&&s.push(y.line),y.times&&y.times.length&&l.push(y.times),f.length||y.heartRates&&y.heartRates.length)){if(!f.length)for(let P=0;P<u;P++)f.push(new Array(s[P].length).fill(null));y.heartRates&&y.heartRates.length?f.push(y.heartRates):f.push(new Array(y.line.length).fill(null))}if(s.length===0)return;const x={...Kv(e),...LC(At(e,"extensions"))};return l.length!==0&&(x.coordTimes=s.length===1?l[0]:l),f.length!==0&&(x.heartRates=s.length===1?f[0]:f),s.length===1?{type:"Feature",properties:x,geometry:{type:"LineString",coordinates:s[0]}}:{type:"Feature",properties:x,geometry:{type:"MultiLineString",coordinates:s}}}function _5(e){const t=zC(e,"rtept");return t===void 0?void 0:{type:"Feature",properties:{...Kv(e),...LC(At(e,"extensions"))},geometry:{type:"LineString",coordinates:t.line}}}function v5(e){return{type:"Feature",properties:{...Kv(e),...F0(e,["sym"])},geometry:{type:"Point",coordinates:FC(e).coordinates}}}function LC(e){const t={};if(e){const s=At(e,"line");if(s){const l=un(At(s,"color")),f=Number.parseFloat(un(At(s,"opacity"))??"0"),y=Number.parseFloat(un(At(s,"width"))??"0");l&&(t.stroke=l),Number.isNaN(f)||(t["stroke-opacity"]=f),Number.isNaN(y)||(t["stroke-width"]=y*96/25.4)}}return t}function Kv(e){const t=F0(e,["name","cmt","desc","type","time","keywords"]),s=Ir(e,"link");if(s.length!==0){t.links=[];for(const l of Array.from(s)){const f={href:Ul(l,"href"),...F0(l,["text","type"])};t.links.push(f)}}return t}function Ow(e){let t=0;if(!e||!e.length)return t;for(let s=0;s<e.length;s++)t=(t<<5)-t+e.charCodeAt(s)|0;return t}function Ir(e,t){return e.getElementsByTagName(t)}function Ul(e,t){return e.getAttribute(t)}function Nw(e,t){return Number.parseFloat(Ul(e,t)??"0")}function At(e,t){const s=Ir(e,t);return s.length?s[0]:null}function x5(e){return e.normalize&&e.normalize(),e}function RC(e){return e.map(Number.parseFloat).map(t=>Number.isNaN(t)?null:t)}function un(e){return e&&x5(e),e&&e.textContent}function F0(e,t){const s={};let l,f;for(f=0;f<t.length;f++)l=At(e,t[f]),l&&(s[t[f]]=un(l)??"");return s}function DC(e){return RC(e.replace(/\s*/g,"").split(","))}function $w(e){const t=e.replace(/^\s*|\s*$/g,"").split(/\s+/),s=[];for(const l of t)s.push(DC(l));return s}function FC(e){const t=[Nw(e,"lon"),Nw(e,"lat")],s=At(e,"ele"),l=At(e,"gpxtpx:hr")||At(e,"hr"),f=At(e,"time");let y;return s&&(y=Number.parseFloat(un(s)??"0"),Number.isNaN(y)||t.push(y)),{coordinates:t,time:f?un(f):null,heartRate:l!==null?Number.parseFloat(un(l)??"0"):null}}function b5(e){let t=e;try{typeof t=="string"&&(t=Wv(t))}catch{return null}try{return AC(t)}catch{}try{return MC(t)}catch{}return null}function Mf(e){const t=e.toString(16);return t.length===1?`0${t}`:t}function w5(e){return`#${Mf(e[0])}${Mf(e[1])}${Mf(e[2])}${e.length===4?Mf(e[3]):""}`}let It=class Qc extends Array{constructor(t={}){super(),Tn(this,"min",0),Tn(this,"max",1),"min"in t&&(this.min=t.min),"max"in t&&(this.max=t.max),"stops"in t&&this.setStops(t.stops,{clone:!1})}static fromArrayDefinition(t){return new Qc({stops:t.map(s=>({value:s[0],color:s[1]}))})}setStops(t,s={clone:!0}){const l=s.clone?this.clone():this;l.length=0;let f=Number.POSITIVE_INFINITY,y=Number.NEGATIVE_INFINITY;for(let x=0;x<t.length;x+=1)f=Math.min(f,t[x].value),y=Math.max(y,t[x].value),l.push({value:t[x].value,color:t[x].color.slice()});return l.sort((x,u)=>x.value<u.value?-1:1),this.min=f,this.max=y,l}scale(t,s,l={clone:!0}){const f=l.clone,y=this[0].value,x=this.at(-1).value-y,u=s-t,P=[];for(let L=0;L<this.length;L+=1){const U=(this[L].value-y)/x*u+t;f?P.push({value:U,color:this[L].color.slice()}):this[L].value=U}return f?new Qc({stops:P}):this}at(t){return t<0?this[this.length+t]:this[t]}clone(){return new Qc({stops:this.getRawColorStops()})}getRawColorStops(){const t=[];for(let s=0;s<this.length;s+=1)t.push({value:this[s].value,color:this[s].color});return t}reverse(t={clone:!0}){const s=t.clone?this.clone():this;for(let l=0;l<~~(s.length/2);l+=1){const f=s[l].color;s[l].color=s.at(-(l+1)).color,s.at(-(l+1)).color=f}return s}getBounds(){return{min:this.min,max:this.max}}getColor(t,s={smooth:!0}){if(t<=this[0].value)return this[0].color;if(t>=this.at(-1).value)return this.at(-1).color;for(let l=0;l<this.length-1;l+=1){if(t>this[l+1].value)continue;const f=this[l].color;if(!s.smooth)return f.slice();const y=this[l].value,x=this[l+1].value,u=this[l+1].color,P=(x-t)/(x-y);return f.map((L,U)=>Math.round(L*P+u[U]*(1-P)))}return[0,0,0]}getColorHex(t,s={smooth:!0,withAlpha:!1}){return w5(this.getColor(t,s))}getColorRelative(t,s={smooth:!0}){const l=this.getBounds();return this.getColor(l.min+t*(l.max-l.min),s)}getCanvasStrip(t={horizontal:!0,size:512,smooth:!0}){const s=document.createElement("canvas");s.width=t.horizontal?t.size:1,s.height=t.horizontal?1:t.size;const l=s.getContext("2d");if(!l)throw new Error("Canvs context is missing");const f=l.getImageData(0,0,s.width,s.height),y=f.data,x=t.size,u=this[0].value,P=(this.at(-1).value-u)/x;for(let L=0;L<x;L+=1){const U=this.getColor(u+L*P,{smooth:t.smooth});y[L*4]=U[0],y[L*4+1]=U[1],y[L*4+2]=U[2],y[L*4+3]=U.length>3?U[3]:255}return l.putImageData(f,0,0),s}resample(t,s=15){const l=this.getBounds(),f=this.scale(0,1),y=1/(s-1);let x;if(t==="ease-in-square")x=Array.from({length:s},(u,P)=>{const L=P*y,U=L**2,N=f.getColor(U);return{value:L,color:N}});else if(t==="ease-out-square")x=Array.from({length:s},(u,P)=>{const L=P*y,U=1-(1-L)**2,N=f.getColor(U);return{value:L,color:N}});else if(t==="ease-out-sqrt")x=Array.from({length:s},(u,P)=>{const L=P*y,U=L**.5,N=f.getColor(U);return{value:L,color:N}});else if(t==="ease-in-sqrt")x=Array.from({length:s},(u,P)=>{const L=P*y,U=1-(1-L)**.5,N=f.getColor(U);return{value:L,color:N}});else if(t==="ease-out-exp")x=Array.from({length:s},(u,P)=>{const L=P*y,U=1-2**(-10*L),N=f.getColor(U);return{value:L,color:N}});else if(t==="ease-in-exp")x=Array.from({length:s},(u,P)=>{const L=P*y,U=2**(10*L-10),N=f.getColor(U);return{value:L,color:N}});else throw new Error("Invalid ressampling method.");return new Qc({stops:x}).scale(l.min,l.max)}transparentStart(){const t=this.getRawColorStops();t.unshift({value:t[0].value,color:t[0].color.slice()}),t[1].value+=.001;for(const s of t)s.color.length===3&&s.color.push(255);return t[0].color[3]=0,new Qc({stops:t})}hasTransparentStart(){return this[0].color.length===4&&this[0].color[3]===0}};const Im={NULL:new It({stops:[{value:0,color:[0,0,0,0]},{value:1,color:[0,0,0,0]}]}),GRAY:new It({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),JET:new It({stops:[{value:0,color:[0,0,131]},{value:.125,color:[0,60,170]},{value:.375,color:[5,255,255]},{value:.625,color:[255,255,0]},{value:.875,color:[250,0,0]},{value:1,color:[128,0,0]}]}),HSV:new It({stops:[{value:0,color:[255,0,0]},{value:.169,color:[253,255,2]},{value:.173,color:[247,255,2]},{value:.337,color:[0,252,4]},{value:.341,color:[0,252,10]},{value:.506,color:[1,249,255]},{value:.671,color:[2,0,253]},{value:.675,color:[8,0,253]},{value:.839,color:[255,0,251]},{value:.843,color:[255,0,245]},{value:1,color:[255,0,6]}]}),HOT:new It({stops:[{value:0,color:[0,0,0]},{value:.3,color:[230,0,0]},{value:.6,color:[255,210,0]},{value:1,color:[255,255,255]}]}),SPRING:new It({stops:[{value:0,color:[255,0,255]},{value:1,color:[255,255,0]}]}),SUMMER:new It({stops:[{value:0,color:[0,128,102]},{value:1,color:[255,255,102]}]}),AUTOMN:new It({stops:[{value:0,color:[255,0,0]},{value:1,color:[255,255,0]}]}),WINTER:new It({stops:[{value:0,color:[0,0,255]},{value:1,color:[0,255,128]}]}),BONE:new It({stops:[{value:0,color:[0,0,0]},{value:.376,color:[84,84,116]},{value:.753,color:[169,200,200]},{value:1,color:[255,255,255]}]}),COPPER:new It({stops:[{value:0,color:[0,0,0]},{value:.804,color:[255,160,102]},{value:1,color:[255,199,127]}]}),GREYS:new It({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),YIGNBU:new It({stops:[{value:0,color:[8,29,88]},{value:.125,color:[37,52,148]},{value:.25,color:[34,94,168]},{value:.375,color:[29,145,192]},{value:.5,color:[65,182,196]},{value:.625,color:[127,205,187]},{value:.75,color:[199,233,180]},{value:.875,color:[237,248,217]},{value:1,color:[255,255,217]}]}),GREENS:new It({stops:[{value:0,color:[0,68,27]},{value:.125,color:[0,109,44]},{value:.25,color:[35,139,69]},{value:.375,color:[65,171,93]},{value:.5,color:[116,196,118]},{value:.625,color:[161,217,155]},{value:.75,color:[199,233,192]},{value:.875,color:[229,245,224]},{value:1,color:[247,252,245]}]}),YIORRD:new It({stops:[{value:0,color:[128,0,38]},{value:.125,color:[189,0,38]},{value:.25,color:[227,26,28]},{value:.375,color:[252,78,42]},{value:.5,color:[253,141,60]},{value:.625,color:[254,178,76]},{value:.75,color:[254,217,118]},{value:.875,color:[255,237,160]},{value:1,color:[255,255,204]}]}),BLUERED:new It({stops:[{value:0,color:[0,0,255]},{value:1,color:[255,0,0]}]}),RDBU:new It({stops:[{value:0,color:[5,10,172]},{value:.35,color:[106,137,247]},{value:.5,color:[190,190,190]},{value:.6,color:[220,170,132]},{value:.7,color:[230,145,90]},{value:1,color:[178,10,28]}]}),PICNIC:new It({stops:[{value:0,color:[0,0,255]},{value:.1,color:[51,153,255]},{value:.2,color:[102,204,255]},{value:.3,color:[153,204,255]},{value:.4,color:[204,204,255]},{value:.5,color:[255,255,255]},{value:.6,color:[255,204,255]},{value:.7,color:[255,153,255]},{value:.8,color:[255,102,204]},{value:.9,color:[255,102,102]},{value:1,color:[255,0,0]}]}),RAINBOW:new It({stops:[{value:0,color:[150,0,90]},{value:.125,color:[0,0,200]},{value:.25,color:[0,25,255]},{value:.375,color:[0,152,255]},{value:.5,color:[44,255,150]},{value:.625,color:[151,255,0]},{value:.75,color:[255,234,0]},{value:.875,color:[255,111,0]},{value:1,color:[255,0,0]}]}),PORTLAND:new It({stops:[{value:0,color:[12,51,131]},{value:.25,color:[10,136,186]},{value:.5,color:[242,211,56]},{value:.75,color:[242,143,56]},{value:1,color:[217,30,30]}]}),BLACKBODY:new It({stops:[{value:0,color:[0,0,0]},{value:.2,color:[230,0,0]},{value:.4,color:[230,210,0]},{value:.7,color:[255,255,255]},{value:1,color:[160,200,255]}]}),EARTH:new It({stops:[{value:0,color:[0,0,130]},{value:.1,color:[0,180,180]},{value:.2,color:[40,210,40]},{value:.4,color:[230,230,50]},{value:.6,color:[120,70,20]},{value:1,color:[255,255,255]}]}),ELECTRIC:new It({stops:[{value:0,color:[0,0,0]},{value:.15,color:[30,0,100]},{value:.4,color:[120,0,100]},{value:.6,color:[160,90,0]},{value:.8,color:[230,200,0]},{value:1,color:[255,250,220]}]}),VIRIDIS:new It({stops:[{value:0,color:[68,1,84]},{value:.13,color:[71,44,122]},{value:.25,color:[59,81,139]},{value:.38,color:[44,113,142]},{value:.5,color:[33,144,141]},{value:.63,color:[39,173,129]},{value:.75,color:[92,200,99]},{value:.88,color:[170,220,50]},{value:1,color:[253,231,37]}]}),INFERNO:new It({stops:[{value:0,color:[0,0,4]},{value:.13,color:[31,12,72]},{value:.25,color:[85,15,109]},{value:.38,color:[136,34,106]},{value:.5,color:[186,54,85]},{value:.63,color:[227,89,51]},{value:.75,color:[249,140,10]},{value:.88,color:[249,201,50]},{value:1,color:[252,255,164]}]}),MAGMA:new It({stops:[{value:0,color:[0,0,4]},{value:.13,color:[28,16,68]},{value:.25,color:[79,18,123]},{value:.38,color:[129,37,129]},{value:.5,color:[181,54,122]},{value:.63,color:[229,80,100]},{value:.75,color:[251,135,97]},{value:.88,color:[254,194,135]},{value:1,color:[252,253,191]}]}),PLASMA:new It({stops:[{value:0,color:[13,8,135]},{value:.13,color:[75,3,161]},{value:.25,color:[125,3,168]},{value:.38,color:[168,34,150]},{value:.5,color:[203,70,121]},{value:.63,color:[229,107,93]},{value:.75,color:[248,148,65]},{value:.88,color:[253,195,40]},{value:1,color:[240,249,33]}]}),WARM:new It({stops:[{value:0,color:[125,0,179]},{value:.13,color:[172,0,187]},{value:.25,color:[219,0,170]},{value:.38,color:[255,0,130]},{value:.5,color:[255,63,74]},{value:.63,color:[255,123,0]},{value:.75,color:[234,176,0]},{value:.88,color:[190,228,0]},{value:1,color:[147,255,0]}]}),COOL:new It({stops:[{value:0,color:[125,0,179]},{value:.13,color:[116,0,218]},{value:.25,color:[98,74,237]},{value:.38,color:[68,146,231]},{value:.5,color:[0,204,197]},{value:.63,color:[0,247,146]},{value:.75,color:[0,255,88]},{value:.88,color:[40,255,8]},{value:1,color:[147,255,0]}]}),RAINBOW_SOFT:new It({stops:[{value:0,color:[125,0,179]},{value:.1,color:[199,0,180]},{value:.2,color:[255,0,121]},{value:.3,color:[255,108,0]},{value:.4,color:[222,194,0]},{value:.5,color:[150,255,0]},{value:.6,color:[0,255,55]},{value:.7,color:[0,246,150]},{value:.8,color:[50,167,222]},{value:.9,color:[103,51,235]},{value:1,color:[124,0,186]}]}),BATHYMETRY:new It({stops:[{value:0,color:[40,26,44]},{value:.13,color:[59,49,90]},{value:.25,color:[64,76,139]},{value:.38,color:[63,110,151]},{value:.5,color:[72,142,158]},{value:.63,color:[85,174,163]},{value:.75,color:[120,206,163]},{value:.88,color:[187,230,172]},{value:1,color:[253,254,204]}]}),CDOM:new It({stops:[{value:0,color:[47,15,62]},{value:.13,color:[87,23,86]},{value:.25,color:[130,28,99]},{value:.38,color:[171,41,96]},{value:.5,color:[206,67,86]},{value:.63,color:[230,106,84]},{value:.75,color:[242,149,103]},{value:.88,color:[249,193,135]},{value:1,color:[254,237,176]}]}),CHLOROPHYLL:new It({stops:[{value:0,color:[18,36,20]},{value:.13,color:[25,63,41]},{value:.25,color:[24,91,59]},{value:.38,color:[13,119,72]},{value:.5,color:[18,148,80]},{value:.63,color:[80,173,89]},{value:.75,color:[132,196,122]},{value:.88,color:[175,221,162]},{value:1,color:[215,249,208]}]}),DENSITY:new It({stops:[{value:0,color:[54,14,36]},{value:.13,color:[89,23,80]},{value:.25,color:[110,45,132]},{value:.38,color:[120,77,178]},{value:.5,color:[120,113,213]},{value:.63,color:[115,151,228]},{value:.75,color:[134,185,227]},{value:.88,color:[177,214,227]},{value:1,color:[230,241,241]}]}),FREESURFACE_BLUE:new It({stops:[{value:0,color:[30,4,110]},{value:.13,color:[47,14,176]},{value:.25,color:[41,45,236]},{value:.38,color:[25,99,212]},{value:.5,color:[68,131,200]},{value:.63,color:[114,156,197]},{value:.75,color:[157,181,203]},{value:.88,color:[200,208,216]},{value:1,color:[241,237,236]}]}),FREESURFACE_RED:new It({stops:[{value:0,color:[60,9,18]},{value:.13,color:[100,17,27]},{value:.25,color:[142,20,29]},{value:.38,color:[177,43,27]},{value:.5,color:[192,87,63]},{value:.63,color:[205,125,105]},{value:.75,color:[216,162,148]},{value:.88,color:[227,199,193]},{value:1,color:[241,237,236]}]}),OXYGEN:new It({stops:[{value:0,color:[64,5,5]},{value:.13,color:[106,6,15]},{value:.25,color:[144,26,7]},{value:.38,color:[168,64,3]},{value:.5,color:[188,100,4]},{value:.63,color:[206,136,11]},{value:.75,color:[220,174,25]},{value:.88,color:[231,215,44]},{value:1,color:[248,254,105]}]}),PAR:new It({stops:[{value:0,color:[51,20,24]},{value:.13,color:[90,32,35]},{value:.25,color:[129,44,34]},{value:.38,color:[159,68,25]},{value:.5,color:[182,99,19]},{value:.63,color:[199,134,22]},{value:.75,color:[212,171,35]},{value:.88,color:[221,210,54]},{value:1,color:[225,253,75]}]}),PHASE:new It({stops:[{value:0,color:[145,105,18]},{value:.13,color:[184,71,38]},{value:.25,color:[186,58,115]},{value:.38,color:[160,71,185]},{value:.5,color:[110,97,218]},{value:.63,color:[50,123,164]},{value:.75,color:[31,131,110]},{value:.88,color:[77,129,34]},{value:1,color:[145,105,18]}]}),SALINITY:new It({stops:[{value:0,color:[42,24,108]},{value:.13,color:[33,50,162]},{value:.25,color:[15,90,145]},{value:.38,color:[40,118,137]},{value:.5,color:[59,146,135]},{value:.63,color:[79,175,126]},{value:.75,color:[120,203,104]},{value:.88,color:[193,221,100]},{value:1,color:[253,239,154]}]}),TEMPERATURE:new It({stops:[{value:0,color:[4,35,51]},{value:.13,color:[23,51,122]},{value:.25,color:[85,59,157]},{value:.38,color:[129,79,143]},{value:.5,color:[175,95,130]},{value:.63,color:[222,112,101]},{value:.75,color:[249,146,66]},{value:.88,color:[249,196,65]},{value:1,color:[232,250,91]}]}),TURBIDITY:new It({stops:[{value:0,color:[34,31,27]},{value:.13,color:[65,50,41]},{value:.25,color:[98,69,52]},{value:.38,color:[131,89,57]},{value:.5,color:[161,112,59]},{value:.63,color:[185,140,66]},{value:.75,color:[202,174,88]},{value:.88,color:[216,209,126]},{value:1,color:[233,246,171]}]}),VELOCITY_BLUE:new It({stops:[{value:0,color:[17,32,64]},{value:.13,color:[35,52,116]},{value:.25,color:[29,81,156]},{value:.38,color:[31,113,162]},{value:.5,color:[50,144,169]},{value:.63,color:[87,173,176]},{value:.75,color:[149,196,189]},{value:.88,color:[203,221,211]},{value:1,color:[254,251,230]}]}),VELOCITY_GREEN:new It({stops:[{value:0,color:[23,35,19]},{value:.13,color:[24,64,38]},{value:.25,color:[11,95,45]},{value:.38,color:[39,123,35]},{value:.5,color:[95,146,12]},{value:.63,color:[152,165,18]},{value:.75,color:[201,186,69]},{value:.88,color:[233,216,137]},{value:1,color:[255,253,205]}]}),CUBEHELIX:new It({stops:[{value:0,color:[0,0,0]},{value:.07,color:[22,5,59]},{value:.13,color:[60,4,105]},{value:.2,color:[109,1,135]},{value:.27,color:[161,0,147]},{value:.33,color:[210,2,142]},{value:.4,color:[251,11,123]},{value:.47,color:[255,29,97]},{value:.53,color:[255,54,69]},{value:.6,color:[255,85,46]},{value:.67,color:[255,120,34]},{value:.73,color:[255,157,37]},{value:.8,color:[241,191,57]},{value:.87,color:[224,220,93]},{value:.93,color:[218,241,142]},{value:1,color:[227,253,198]}]}),CIVIDIS:new It({stops:[{value:0,color:[0,32,77,255]},{value:.125,color:[5,54,110,255]},{value:.25,color:[65,77,108,255]},{value:.375,color:[97,100,111,255]},{value:.5,color:[125,124,121,255]},{value:.625,color:[156,149,120,255]},{value:.75,color:[190,175,111,255]},{value:.875,color:[225,204,94,255]},{value:1,color:[255,235,70,255]}]}),TURBO:new It({stops:[{value:0,color:[48,18,59,255]},{value:.125,color:[70,107,227,255]},{value:.25,color:[40,187,236,255]},{value:.375,color:[49,242,153,255]},{value:.5,color:[162,252,60,255]},{value:.625,color:[237,208,58,255]},{value:.75,color:[251,128,34,255]},{value:.875,color:[210,49,5,255]},{value:1,color:[122,4,3,255]}]}),ROCKET:new It({stops:[{value:0,color:[250,235,221,0]},{value:.133,color:[250,235,221,255]},{value:.266,color:[246,170,130,255]},{value:.4,color:[240,96,67,255]},{value:.533,color:[203,27,79,255]},{value:.666,color:[132,30,90,255]},{value:.8,color:[63,27,68,255]},{value:1,color:[3,5,26,255]}]}),MAKO:new It({stops:[{value:0,color:[11,4,5,255]},{value:.125,color:[43,28,53,255]},{value:.25,color:[62,53,107,255]},{value:.375,color:[59,86,152,255]},{value:.5,color:[53,123,162,255]},{value:.625,color:[53,158,170,255]},{value:.75,color:[73,193,173,255]},{value:.875,color:[150,221,181,255]},{value:1,color:[222,245,229,255]}]})};async function S5(e,t={}){const s=t.download??!1,l=await T5(e);if(s){const f=t.filename??"maptiler_screenshot.png",y=document.createElement("a");y.style.display="none",document.body.appendChild(y),y.href=URL.createObjectURL(l),y.download=f,y.click(),setTimeout(()=>{document.body.removeChild(y),URL.revokeObjectURL(y.href)},0)}return l}function T5(e){return new Promise((t,s)=>{e.redraw(),e.once("idle",()=>{e.getCanvas().toBlob(l=>{if(!l)return s(Error("Screenshot could not be created."));t(l)},"image/png")})})}const jw=[["#1D5B79","#468B97","#EF6262","#F3AA60"],["#614BC3","#33BBC5","#85E6C5","#C8FFE0"],["#461959","#7A316F","#CD6688","#AED8CC"],["#0079FF","#00DFA2","#F6FA70","#FF0060"],["#39B5E0","#A31ACB","#FF78F0","#F5EA5A"],["#37E2D5","#590696","#C70A80","#FBCB0A"],["#FFD36E","#FFF56D","#99FFCD","#9FB4FF"],["#00EAD3","#FFF5B7","#FF449F","#005F99"],["#10A19D","#540375","#FF7000","#FFBF00"]];function Xv(){return jw[~~(Math.random()*jw.length)][~~(Math.random()*4)]}function tg(){return`maptiler_source_${CC()}`}function ng(){return`maptiler_layer_${CC()}`}function Uw(e,t){if(t<=e[0].zoom)return e[0].value;if(t>=e[e.length-1].zoom)return e[e.length-1].value;for(let s=0;s<e.length-1;s+=1)if(t>=e[s].zoom&&t<e[s+1].zoom){const l=e[s+1].zoom-e[s].zoom,f=(t-e[s].zoom)/l;return f*e[s+1].value+(1-f)*e[s].value}return 0}function Vl(e){return["interpolate",["linear"],["zoom"],...e.flatMap(t=>[t.zoom,t.value])]}function hn(e){return["interpolate",["linear"],["zoom"],...e.flatMap(t=>[t.zoom,t.value])]}function C5(e,t){if(typeof t=="number"&&typeof e=="number")return 2*t+e;if(typeof t=="number"&&Array.isArray(e))return["interpolate",["linear"],["zoom"],...e.flatMap(s=>[s.zoom,2*t+s.value])];if(typeof e=="number"&&Array.isArray(t))return["interpolate",["linear"],["zoom"],...t.flatMap(s=>[s.zoom,2*s.value+e])];if(Array.isArray(e)&&Array.isArray(t)){const s=Array.from(new Set([...e.map(l=>l.zoom),...t.map(l=>l.zoom)])).sort((l,f)=>l<f?-1:1);return["interpolate",["linear"],["zoom"],...s.flatMap(l=>[l,2*Uw(t,l)+Uw(e,l)])]}return 0}function k5(e,t){return["interpolate",["linear"],["get",t],...e.flatMap(s=>[s.propertyValue,s.value])]}function BC(e){const t=e.trimStart(),s=`${t}${" ".repeat(e.length-t.length)}`,l=Array.from(s);if(!l.every(y=>y===" "||y==="_"))throw new Error("A dash pattern must be composed only of whitespace and underscore characters.");if(!(l.some(y=>y==="_")&&l.some(y=>y===" ")))throw new Error("A dash pattern must contain at least one underscore and one whitespace character");const f=[1];for(let y=1;y<l.length;y+=1){const x=l[y-1],u=l[y];x===u?f[f.length-1]+=1:f.push(1)}return f}function Vw(e,t){return["interpolate",["linear"],["get",t],...e.flatMap(s=>[s.value,s.color])]}function Gw(e,t,s=!0){return s?["interpolate",["linear"],["zoom"],0,["interpolate",["linear"],["get",t],...e.flatMap(l=>[l.value,l.pointRadius*.025])],2,["interpolate",["linear"],["get",t],...e.flatMap(l=>[l.value,l.pointRadius*.05])],4,["interpolate",["linear"],["get",t],...e.flatMap(l=>[l.value,l.pointRadius*.1])],8,["interpolate",["linear"],["get",t],...e.flatMap(l=>[l.value,l.pointRadius*.25])],16,["interpolate",["linear"],["get",t],...e.flatMap(l=>[l.value,l.pointRadius])]]:["interpolate",["linear"],["get",t],...e.flatMap(l=>[l.value,l.pointRadius])]}function E5(e,t,s=!0){return s?["interpolate",["linear"],["zoom"],0,["interpolate",["linear"],["get",t],...e.flatMap(l=>[l.propertyValue,l.value*.025])],2,["interpolate",["linear"],["get",t],...e.flatMap(l=>[l.propertyValue,l.value*.05])],4,["interpolate",["linear"],["get",t],...e.flatMap(l=>[l.propertyValue,l.value*.1])],8,["interpolate",["linear"],["get",t],...e.flatMap(l=>[l.propertyValue,l.value*.25])],16,["interpolate",["linear"],["get",t],...e.flatMap(l=>[l.propertyValue,l.value])]]:["interpolate",["linear"],["get",t],...e.flatMap(l=>[l.propertyValue,l.value])]}function qw(e,t){return e.every(s=>s.color[3]===e[0].color[3])?e[0].color[3]?e[0].color[3]/255:1:["interpolate",["linear"],["get",t],...e.getRawColorStops().flatMap(s=>{const l=s.value,f=s.color;return[l,f.length===4?f[3]/255:1]})]}function I5(e,t=10){return["interpolate",["linear"],["heatmap-density"],...Array.from({length:t+1},(s,l)=>{const f=l/t;return[f,e.getColorHex(f)]}).flat()]}async function P5(e,t,s={}){var l,f;if(!t.sourceId&&!t.data)throw new Error("Creating a polyline layer requires an existing .sourceId or a valid .data property");let y=t.data;if(typeof y=="string"){if(eg(y))y=`https://api.maptiler.com/data/${t.data}/features.json?key=${kr.apiKey}`;else if(((l=y.split(".").pop())==null?void 0:l.toLowerCase().trim())==="gpx"){const x=await(await fetch(y,s)).text();y=AC(x)}else if(((f=y.split(".").pop())==null?void 0:f.toLowerCase().trim())==="kml"){const x=await(await fetch(y,s)).text();y=MC(x)}else{const x=e5(y)??b5(y);x&&(y=x)}if(!y)throw new Error("Polyline data was provided as string but is incompatible with valid formats.")}return A5(e,{...t,data:y})}function A5(e,t){if(t.layerId&&e.getLayer(t.layerId))throw new Error(`A layer already exists with the layer id: ${t.layerId}`);const s=t.sourceId??tg(),l=t.layerId??ng(),f={polylineLayerId:l,polylineOutlineLayerId:"",polylineSourceId:s};t.data&&!e.getSource(s)&&e.addSource(s,{type:"geojson",data:t.data});const y=t.lineWidth??3,x=t.lineColor??Xv(),u=t.lineOpacity??1,P=t.lineBlur??0,L=t.lineGapWidth??0;let U=t.lineDashArray??null;const N=t.outlineWidth??1,D=t.outlineColor??"#FFFFFF",se=t.outlineOpacity??1,ne=t.outlineBlur??0;if(typeof U=="string"&&(U=BC(U)),t.outline===!0){const ee=`${l}_outline`;f.polylineOutlineLayerId=ee,e.addLayer({id:ee,type:"line",source:s,layout:{"line-join":t.lineJoin??"round","line-cap":t.lineCap??"round"},minzoom:t.minzoom??0,maxzoom:t.maxzoom??23,paint:{"line-opacity":typeof se=="number"?se:hn(se),"line-color":typeof D=="string"?D:Vl(D),"line-width":C5(y,N),"line-blur":typeof ne=="number"?ne:hn(ne)}},t.beforeId)}return e.addLayer({id:l,type:"line",source:s,layout:{"line-join":t.lineJoin??"round","line-cap":t.lineCap??"round"},minzoom:t.minzoom??0,maxzoom:t.maxzoom??23,paint:{"line-opacity":typeof u=="number"?u:hn(u),"line-color":typeof x=="string"?x:Vl(x),"line-width":typeof y=="number"?y:hn(y),"line-blur":typeof P=="number"?P:hn(P),"line-gap-width":typeof L=="number"?L:hn(L),...U&&{"line-dasharray":U}}},t.beforeId),f}function M5(e,t){if(t.layerId&&e.getLayer(t.layerId))throw new Error(`A layer already exists with the layer id: ${t.layerId}`);const s=t.sourceId??tg(),l=t.layerId??ng(),f={polygonLayerId:l,polygonOutlineLayerId:t.outline?`${l}_outline`:"",polygonSourceId:s};if(t.data&&!e.getSource(s)){let ee=t.data;typeof ee=="string"&&eg(ee)&&(ee=`https://api.maptiler.com/data/${ee}/features.json?key=${kr.apiKey}`),e.addSource(s,{type:"geojson",data:ee})}let y=t.outlineDashArray??null;const x=t.outlineWidth??1,u=t.outlineColor??"#FFFFFF",P=t.outlineOpacity??1,L=t.outlineBlur??0,U=t.fillColor??Xv(),N=t.fillOpacity??1,D=t.outlinePosition??"center",se=t.pattern??null;typeof y=="string"&&(y=BC(y));const ne=(ee=null)=>{if(e.addLayer({id:l,type:"fill",source:s,minzoom:t.minzoom??0,maxzoom:t.maxzoom??23,paint:{"fill-color":typeof U=="string"?U:Vl(U),"fill-opacity":typeof N=="number"?N:hn(N),...ee&&{"fill-pattern":ee}}},t.beforeId),t.outline===!0){let ke;D==="inside"?typeof x=="number"?ke=.5*x:ke=hn(x.map(({zoom:X,value:Z})=>({zoom:X,value:.5*Z}))):D==="outside"?typeof x=="number"?ke=-.5*x:ke=hn(x.map(X=>({zoom:X.zoom,value:-.5*X.value}))):ke=0,e.addLayer({id:f.polygonOutlineLayerId,type:"line",source:s,layout:{"line-join":t.outlineJoin??"round","line-cap":t.outlineCap??"butt"},minzoom:t.minzoom??0,maxzoom:t.maxzoom??23,paint:{"line-opacity":typeof P=="number"?P:hn(P),"line-color":typeof u=="string"?u:Vl(u),"line-width":typeof x=="number"?x:hn(x),"line-blur":typeof L=="number"?L:hn(L),"line-offset":ke,...y&&{"line-dasharray":y}}},t.beforeId)}};return se?e.hasImage(se)?ne(se):e.loadImage(se).then(ee=>{e.addImage(se,ee.data),ne(se)}).catch(ee=>(console.error("Could not load the pattern image.",ee.message),ne())):ne(),f}function z5(e,t){if(t.layerId&&e.getLayer(t.layerId))throw new Error(`A layer already exists with the layer id: ${t.layerId}`);const s=t.minPointRadius??10,l=t.maxPointRadius??50,f=t.cluster??!1,y=20,x=Array.isArray(t.pointColor)?t.pointColor:Im.TURBO.scale(10,t.cluster?1e4:1e3).resample("ease-out-square"),u=x.getBounds(),P=t.sourceId??tg(),L=t.layerId??ng(),U=t.showLabel??f,N=t.alignOnViewport??!0,D=t.outline??!1,se=t.outlineOpacity??1,ne=t.outlineWidth??1,ee=t.outlineColor??"#FFFFFF";let ke;const X=t.zoomCompensation??!0,Z=t.minzoom??0,W=t.maxzoom??23;typeof t.pointOpacity=="number"?ke=t.pointOpacity:Array.isArray(t.pointOpacity)?ke=hn(t.pointOpacity):t.cluster?ke=qw(x,"point_count"):t.property?ke=qw(x,t.property):ke=hn([{zoom:Z,value:0},{zoom:Z+.25,value:1},{zoom:W-.25,value:1},{zoom:W,value:0}]);const pe={pointLayerId:L,clusterLayerId:"",labelLayerId:"",pointSourceId:P};if(t.data&&!e.getSource(P)){let _e=t.data;typeof _e=="string"&&eg(_e)&&(_e=`https://api.maptiler.com/data/${_e}/features.json?key=${kr.apiKey}`),e.addSource(P,{type:"geojson",data:_e,cluster:f})}if(f){pe.clusterLayerId=`${L}_cluster`;const _e=Array.from({length:y},(be,xe)=>{const Re=u.min+xe*(u.max-u.min)/(y-1);return{value:Re,pointRadius:s+(l-s)*(xe/(y-1))**.5,color:x.getColorHex(Re)}});e.addLayer({id:pe.clusterLayerId,type:"circle",source:P,filter:["has","point_count"],paint:{"circle-color":typeof t.pointColor=="string"?t.pointColor:Vw(_e,"point_count"),"circle-radius":typeof t.pointRadius=="number"?t.pointRadius:Array.isArray(t.pointRadius)?hn(t.pointRadius):Gw(_e,"point_count",!1),"circle-pitch-alignment":N?"viewport":"map","circle-pitch-scale":"map","circle-opacity":ke,...D&&{"circle-stroke-opacity":typeof se=="number"?se:hn(se),"circle-stroke-width":typeof ne=="number"?ne:hn(ne),"circle-stroke-color":typeof ee=="string"?ee:Vl(ee)}},minzoom:Z,maxzoom:W},t.beforeId),e.addLayer({id:pe.pointLayerId,type:"circle",source:P,filter:["!",["has","point_count"]],paint:{"circle-pitch-alignment":N?"viewport":"map","circle-pitch-scale":"map","circle-color":typeof t.pointColor=="string"?t.pointColor:x.getColorHex(x.getBounds().min),"circle-radius":typeof t.pointRadius=="number"?t.pointRadius:Array.isArray(t.pointRadius)?hn(t.pointRadius):_e[0].pointRadius*.75,"circle-opacity":ke,...D&&{"circle-stroke-opacity":typeof se=="number"?se:hn(se),"circle-stroke-width":typeof ne=="number"?ne:hn(ne),"circle-stroke-color":typeof ee=="string"?ee:Vl(ee)}},minzoom:Z,maxzoom:W},t.beforeId)}else{let _e=typeof t.pointColor=="string"?t.pointColor:Array.isArray(t.pointColor)?t.pointColor.getColorHex(t.pointColor.getBounds().min):Xv(),be=typeof t.pointRadius=="number"?X?hn([{zoom:0,value:t.pointRadius*.025},{zoom:2,value:t.pointRadius*.05},{zoom:4,value:t.pointRadius*.1},{zoom:8,value:t.pointRadius*.25},{zoom:16,value:t.pointRadius*1}]):t.pointRadius:Array.isArray(t.pointRadius)?hn(t.pointRadius):X?hn([{zoom:0,value:s*.05},{zoom:2,value:s*.1},{zoom:4,value:s*.2},{zoom:8,value:s*.5},{zoom:16,value:s*1}]):s;if(t.property&&Array.isArray(t.pointColor)){const xe=Array.from({length:y},(Re,tt)=>{const Oe=u.min+tt*(u.max-u.min)/(y-1);return{value:Oe,pointRadius:typeof t.pointRadius=="number"?t.pointRadius:s+(l-s)*(tt/(y-1))**.5,color:typeof t.pointColor=="string"?t.pointColor:x.getColorHex(Oe)}});_e=Vw(xe,t.property),be=Gw(xe,t.property,X)}e.addLayer({id:pe.pointLayerId,type:"circle",source:P,layout:{"circle-sort-key":t.property?["/",1,["get",t.property]]:0},paint:{"circle-pitch-alignment":N?"viewport":"map","circle-pitch-scale":"map","circle-color":_e,"circle-opacity":ke,"circle-radius":be,...D&&{"circle-stroke-opacity":typeof se=="number"?se:hn(se),"circle-stroke-width":typeof ne=="number"?ne:hn(ne),"circle-stroke-color":typeof ee=="string"?ee:Vl(ee)}},minzoom:Z,maxzoom:W},t.beforeId)}if(U!==!1&&(t.cluster||t.property)){pe.labelLayerId=`${L}_label`;const _e=t.labelColor??"#fff",be=t.labelSize??12;e.addLayer({id:pe.labelLayerId,type:"symbol",source:P,filter:["has",t.cluster?"point_count":t.property],layout:{"text-field":t.cluster?"{point_count_abbreviated}":`{${t.property}}`,"text-font":["Noto Sans Regular"],"text-size":be,"text-pitch-alignment":N?"viewport":"map","symbol-sort-key":["/",1,["get",t.cluster?"point_count":t.property]]},paint:{"text-color":_e,"text-opacity":ke},minzoom:Z,maxzoom:W},t.beforeId)}return pe}function L5(e,t){if(t.layerId&&e.getLayer(t.layerId))throw new Error(`A layer already exists with the layer id: ${t.layerId}`);const s=t.sourceId??tg(),l=t.layerId??ng(),f=t.minzoom??0,y=t.maxzoom??23,x=t.zoomCompensation??!0,u=t.opacity??[{zoom:f,value:0},{zoom:f+.25,value:1},{zoom:y-.25,value:1},{zoom:y,value:0}];let P=Array.isArray(t.colorRamp)?t.colorRamp:Im.TURBO.transparentStart();const L=P.getBounds();(L.min!==0||L.max!==1)&&(P=P.scale(0,1)),P.hasTransparentStart()||(P=P.transparentStart());const U=t.intensity??[{zoom:0,value:.01},{zoom:4,value:.2},{zoom:16,value:1}],N=t.property??null,D=t.weight??1;let se=1;N?typeof D=="number"?(se=D,typeof t.weight=="number"&&console.warn("The option `.property` is ignored when `.propertyValueWeights` is not of type `PropertyValueWeights`")):Array.isArray(D)?se=k5(D,N):console.warn("The option `.property` is ignored when `.propertyValueWeights` is not of type `PropertyValueWeights`"):typeof D=="number"?se=D:Array.isArray(D)&&console.warn("The options `.propertyValueWeights` can only be used when `.property` is provided.");const ne=[{zoom:0,value:50*.025},{zoom:2,value:50*.05},{zoom:4,value:50*.1},{zoom:8,value:50*.25},{zoom:16,value:50}],ee=t.radius??(x?ne:10);let ke=1;typeof ee=="number"?ke=ee:Array.isArray(ee)&&"zoom"in ee[0]?ke=hn(ee):N&&Array.isArray(ee)&&"propertyValue"in ee[0]?ke=E5(ee,N,x):!N&&Array.isArray(ee)&&"propertyValue"in ee[0]?(ke=hn(ne),console.warn("The option `.radius` can only be property-driven if the option `.property` is provided.")):ke=hn(ne);const X={heatmapLayerId:l,heatmapSourceId:s};if(t.data&&!e.getSource(s)){let Z=t.data;typeof Z=="string"&&eg(Z)&&(Z=`https://api.maptiler.com/data/${Z}/features.json?key=${kr.apiKey}`),e.addSource(s,{type:"geojson",data:Z})}return e.addLayer({id:l,type:"heatmap",source:s,minzoom:f,maxzoom:y,paint:{"heatmap-weight":se,"heatmap-intensity":typeof U=="number"?U:hn(U),"heatmap-color":I5(P),"heatmap-radius":ke,"heatmap-opacity":typeof u=="number"?u:hn(u)}},t.beforeId),X}const Hw={addPolyline:P5,addPolygon:M5,addPoint:z5,addHeatmap:L5,takeScreenshot:S5};JM();mt.Map;mt.Marker;mt.Popup;mt.Style;mt.CanvasSource;mt.GeoJSONSource;mt.ImageSource;mt.RasterTileSource;mt.RasterDEMTileSource;mt.VectorTileSource;mt.VideoSource;mt.NavigationControl;mt.GeolocateControl;mt.AttributionControl;mt.LogoControl;mt.ScaleControl;mt.FullscreenControl;mt.TerrainControl;mt.BoxZoomHandler;mt.ScrollZoomHandler;mt.CooperativeGesturesHandler;mt.KeyboardHandler;mt.TwoFingersTouchPitchHandler;mt.MapWheelEvent;mt.MapTouchEvent;mt.MapMouseEvent;mt.config;mt.getVersion;const Vd={black:"#000",white:"#fff"},Hc={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},Zc={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},Wc={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},Kc={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},Xc={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},od={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},R5={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"};function Gd(e){let t="https://mui.com/production-error/?code="+e;for(let s=1;s<arguments.length;s+=1)t+="&args[]="+encodeURIComponent(arguments[s]);return"Minified MUI error #"+e+"; visit "+t+" for the full message."}const D5=Object.freeze(Object.defineProperty({__proto__:null,default:Gd},Symbol.toStringTag,{value:"Module"})),Yv="$$material";function Ae(){return Ae=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var l in s)({}).hasOwnProperty.call(s,l)&&(e[l]=s[l])}return e},Ae.apply(null,arguments)}function ln(e,t){if(e==null)return{};var s={};for(var l in e)if({}.hasOwnProperty.call(e,l)){if(t.indexOf(l)>=0)continue;s[l]=e[l]}return s}function OC(e){var t=Object.create(null);return function(s){return t[s]===void 0&&(t[s]=e(s)),t[s]}}var F5=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,B5=OC(function(e){return F5.test(e)||e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)<91}),O5=!1;function N5(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}function $5(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),e.nonce!==void 0&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}var j5=function(){function e(s){var l=this;this._insertTag=function(f){var y;l.tags.length===0?l.insertionPoint?y=l.insertionPoint.nextSibling:l.prepend?y=l.container.firstChild:y=l.before:y=l.tags[l.tags.length-1].nextSibling,l.container.insertBefore(f,y),l.tags.push(f)},this.isSpeedy=s.speedy===void 0?!O5:s.speedy,this.tags=[],this.ctr=0,this.nonce=s.nonce,this.key=s.key,this.container=s.container,this.prepend=s.prepend,this.insertionPoint=s.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(l){l.forEach(this._insertTag)},t.insert=function(l){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag($5(this));var f=this.tags[this.tags.length-1];if(this.isSpeedy){var y=N5(f);try{y.insertRule(l,y.cssRules.length)}catch{}}else f.appendChild(document.createTextNode(l));this.ctr++},t.flush=function(){this.tags.forEach(function(l){var f;return(f=l.parentNode)==null?void 0:f.removeChild(l)}),this.tags=[],this.ctr=0},e}(),ti="-ms-",Pm="-moz-",sn="-webkit-",NC="comm",Jv="rule",Qv="decl",U5="@import",$C="@keyframes",V5="@layer",G5=Math.abs,rg=String.fromCharCode,q5=Object.assign;function H5(e,t){return jr(e,0)^45?(((t<<2^jr(e,0))<<2^jr(e,1))<<2^jr(e,2))<<2^jr(e,3):0}function jC(e){return e.trim()}function Z5(e,t){return(e=t.exec(e))?e[0]:e}function an(e,t,s){return e.replace(t,s)}function B0(e,t){return e.indexOf(t)}function jr(e,t){return e.charCodeAt(t)|0}function qd(e,t,s){return e.slice(t,s)}function fs(e){return e.length}function ex(e){return e.length}function zf(e,t){return t.push(e),e}function W5(e,t){return e.map(t).join("")}var ig=1,Ru=1,UC=0,Bi=0,lr=0,Nu="";function og(e,t,s,l,f,y,x){return{value:e,root:t,parent:s,type:l,props:f,children:y,line:ig,column:Ru,length:x,return:""}}function sd(e,t){return q5(og("",null,null,"",null,null,0),e,{length:-e.length},t)}function K5(){return lr}function X5(){return lr=Bi>0?jr(Nu,--Bi):0,Ru--,lr===10&&(Ru=1,ig--),lr}function so(){return lr=Bi<UC?jr(Nu,Bi++):0,Ru++,lr===10&&(Ru=1,ig++),lr}function vs(){return jr(Nu,Bi)}function Qf(){return Bi}function tp(e,t){return qd(Nu,e,t)}function Hd(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function VC(e){return ig=Ru=1,UC=fs(Nu=e),Bi=0,[]}function GC(e){return Nu="",e}function em(e){return jC(tp(Bi-1,O0(e===91?e+2:e===40?e+1:e)))}function Y5(e){for(;(lr=vs())&&lr<33;)so();return Hd(e)>2||Hd(lr)>3?"":" "}function J5(e,t){for(;--t&&so()&&!(lr<48||lr>102||lr>57&&lr<65||lr>70&&lr<97););return tp(e,Qf()+(t<6&&vs()==32&&so()==32))}function O0(e){for(;so();)switch(lr){case e:return Bi;case 34:case 39:e!==34&&e!==39&&O0(lr);break;case 40:e===41&&O0(e);break;case 92:so();break}return Bi}function Q5(e,t){for(;so()&&e+lr!==57;)if(e+lr===84&&vs()===47)break;return"/*"+tp(t,Bi-1)+"*"+rg(e===47?e:so())}function ez(e){for(;!Hd(vs());)so();return tp(e,Bi)}function tz(e){return GC(tm("",null,null,null,[""],e=VC(e),0,[0],e))}function tm(e,t,s,l,f,y,x,u,P){for(var L=0,U=0,N=x,D=0,se=0,ne=0,ee=1,ke=1,X=1,Z=0,W="",pe=f,_e=y,be=l,xe=W;ke;)switch(ne=Z,Z=so()){case 40:if(ne!=108&&jr(xe,N-1)==58){B0(xe+=an(em(Z),"&","&\f"),"&\f")!=-1&&(X=-1);break}case 34:case 39:case 91:xe+=em(Z);break;case 9:case 10:case 13:case 32:xe+=Y5(ne);break;case 92:xe+=J5(Qf()-1,7);continue;case 47:switch(vs()){case 42:case 47:zf(nz(Q5(so(),Qf()),t,s),P);break;default:xe+="/"}break;case 123*ee:u[L++]=fs(xe)*X;case 125*ee:case 59:case 0:switch(Z){case 0:case 125:ke=0;case 59+U:X==-1&&(xe=an(xe,/\f/g,"")),se>0&&fs(xe)-N&&zf(se>32?Ww(xe+";",l,s,N-1):Ww(an(xe," ","")+";",l,s,N-2),P);break;case 59:xe+=";";default:if(zf(be=Zw(xe,t,s,L,U,f,u,W,pe=[],_e=[],N),y),Z===123)if(U===0)tm(xe,t,be,be,pe,y,N,u,_e);else switch(D===99&&jr(xe,3)===110?100:D){case 100:case 108:case 109:case 115:tm(e,be,be,l&&zf(Zw(e,be,be,0,0,f,u,W,f,pe=[],N),_e),f,_e,N,u,l?pe:_e);break;default:tm(xe,be,be,be,[""],_e,0,u,_e)}}L=U=se=0,ee=X=1,W=xe="",N=x;break;case 58:N=1+fs(xe),se=ne;default:if(ee<1){if(Z==123)--ee;else if(Z==125&&ee++==0&&X5()==125)continue}switch(xe+=rg(Z),Z*ee){case 38:X=U>0?1:(xe+="\f",-1);break;case 44:u[L++]=(fs(xe)-1)*X,X=1;break;case 64:vs()===45&&(xe+=em(so())),D=vs(),U=N=fs(W=xe+=ez(Qf())),Z++;break;case 45:ne===45&&fs(xe)==2&&(ee=0)}}return y}function Zw(e,t,s,l,f,y,x,u,P,L,U){for(var N=f-1,D=f===0?y:[""],se=ex(D),ne=0,ee=0,ke=0;ne<l;++ne)for(var X=0,Z=qd(e,N+1,N=G5(ee=x[ne])),W=e;X<se;++X)(W=jC(ee>0?D[X]+" "+Z:an(Z,/&\f/g,D[X])))&&(P[ke++]=W);return og(e,t,s,f===0?Jv:u,P,L,U)}function nz(e,t,s){return og(e,t,s,NC,rg(K5()),qd(e,2,-2),0)}function Ww(e,t,s,l){return og(e,t,s,Qv,qd(e,0,l),qd(e,l+1,-1),l)}function Tu(e,t){for(var s="",l=ex(e),f=0;f<l;f++)s+=t(e[f],f,e,t)||"";return s}function rz(e,t,s,l){switch(e.type){case V5:if(e.children.length)break;case U5:case Qv:return e.return=e.return||e.value;case NC:return"";case $C:return e.return=e.value+"{"+Tu(e.children,l)+"}";case Jv:e.value=e.props.join(",")}return fs(s=Tu(e.children,l))?e.return=e.value+"{"+s+"}":""}function iz(e){var t=ex(e);return function(s,l,f,y){for(var x="",u=0;u<t;u++)x+=e[u](s,l,f,y)||"";return x}}function oz(e){return function(t){t.root||(t=t.return)&&e(t)}}var sz=function(t,s,l){for(var f=0,y=0;f=y,y=vs(),f===38&&y===12&&(s[l]=1),!Hd(y);)so();return tp(t,Bi)},az=function(t,s){var l=-1,f=44;do switch(Hd(f)){case 0:f===38&&vs()===12&&(s[l]=1),t[l]+=sz(Bi-1,s,l);break;case 2:t[l]+=em(f);break;case 4:if(f===44){t[++l]=vs()===58?"&\f":"",s[l]=t[l].length;break}default:t[l]+=rg(f)}while(f=so());return t},lz=function(t,s){return GC(az(VC(t),s))},Kw=new WeakMap,cz=function(t){if(!(t.type!=="rule"||!t.parent||t.length<1)){for(var s=t.value,l=t.parent,f=t.column===l.column&&t.line===l.line;l.type!=="rule";)if(l=l.parent,!l)return;if(!(t.props.length===1&&s.charCodeAt(0)!==58&&!Kw.get(l))&&!f){Kw.set(t,!0);for(var y=[],x=lz(s,y),u=l.props,P=0,L=0;P<x.length;P++)for(var U=0;U<u.length;U++,L++)t.props[L]=y[P]?x[P].replace(/&\f/g,u[U]):u[U]+" "+x[P]}}},uz=function(t){if(t.type==="decl"){var s=t.value;s.charCodeAt(0)===108&&s.charCodeAt(2)===98&&(t.return="",t.value="")}};function qC(e,t){switch(H5(e,t)){case 5103:return sn+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return sn+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return sn+e+Pm+e+ti+e+e;case 6828:case 4268:return sn+e+ti+e+e;case 6165:return sn+e+ti+"flex-"+e+e;case 5187:return sn+e+an(e,/(\w+).+(:[^]+)/,sn+"box-$1$2"+ti+"flex-$1$2")+e;case 5443:return sn+e+ti+"flex-item-"+an(e,/flex-|-self/,"")+e;case 4675:return sn+e+ti+"flex-line-pack"+an(e,/align-content|flex-|-self/,"")+e;case 5548:return sn+e+ti+an(e,"shrink","negative")+e;case 5292:return sn+e+ti+an(e,"basis","preferred-size")+e;case 6060:return sn+"box-"+an(e,"-grow","")+sn+e+ti+an(e,"grow","positive")+e;case 4554:return sn+an(e,/([^-])(transform)/g,"$1"+sn+"$2")+e;case 6187:return an(an(an(e,/(zoom-|grab)/,sn+"$1"),/(image-set)/,sn+"$1"),e,"")+e;case 5495:case 3959:return an(e,/(image-set\([^]*)/,sn+"$1$`$1");case 4968:return an(an(e,/(.+:)(flex-)?(.*)/,sn+"box-pack:$3"+ti+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+sn+e+e;case 4095:case 3583:case 4068:case 2532:return an(e,/(.+)-inline(.+)/,sn+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(fs(e)-1-t>6)switch(jr(e,t+1)){case 109:if(jr(e,t+4)!==45)break;case 102:return an(e,/(.+:)(.+)-([^]+)/,"$1"+sn+"$2-$3$1"+Pm+(jr(e,t+3)==108?"$3":"$2-$3"))+e;case 115:return~B0(e,"stretch")?qC(an(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(jr(e,t+1)!==115)break;case 6444:switch(jr(e,fs(e)-3-(~B0(e,"!important")&&10))){case 107:return an(e,":",":"+sn)+e;case 101:return an(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+sn+(jr(e,14)===45?"inline-":"")+"box$3$1"+sn+"$2$3$1"+ti+"$2box$3")+e}break;case 5936:switch(jr(e,t+11)){case 114:return sn+e+ti+an(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return sn+e+ti+an(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return sn+e+ti+an(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return sn+e+ti+e+e}return e}var hz=function(t,s,l,f){if(t.length>-1&&!t.return)switch(t.type){case Qv:t.return=qC(t.value,t.length);break;case $C:return Tu([sd(t,{value:an(t.value,"@","@"+sn)})],f);case Jv:if(t.length)return W5(t.props,function(y){switch(Z5(y,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Tu([sd(t,{props:[an(y,/:(read-\w+)/,":"+Pm+"$1")]})],f);case"::placeholder":return Tu([sd(t,{props:[an(y,/:(plac\w+)/,":"+sn+"input-$1")]}),sd(t,{props:[an(y,/:(plac\w+)/,":"+Pm+"$1")]}),sd(t,{props:[an(y,/:(plac\w+)/,ti+"input-$1")]})],f)}return""})}},dz=[hz],HC=function(t){var s=t.key;if(s==="css"){var l=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(l,function(ee){var ke=ee.getAttribute("data-emotion");ke.indexOf(" ")!==-1&&(document.head.appendChild(ee),ee.setAttribute("data-s",""))})}var f=t.stylisPlugins||dz,y={},x,u=[];x=t.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+s+' "]'),function(ee){for(var ke=ee.getAttribute("data-emotion").split(" "),X=1;X<ke.length;X++)y[ke[X]]=!0;u.push(ee)});var P,L=[cz,uz];{var U,N=[rz,oz(function(ee){U.insert(ee)})],D=iz(L.concat(f,N)),se=function(ke){return Tu(tz(ke),D)};P=function(ke,X,Z,W){U=Z,se(ke?ke+"{"+X.styles+"}":X.styles),W&&(ne.inserted[X.name]=!0)}}var ne={key:s,sheet:new j5({key:s,container:x,nonce:t.nonce,speedy:t.speedy,prepend:t.prepend,insertionPoint:t.insertionPoint}),nonce:t.nonce,inserted:y,registered:{},insert:P};return ne.sheet.hydrate(u),ne},ZC={exports:{}},gn={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ar=typeof Symbol=="function"&&Symbol.for,tx=Ar?Symbol.for("react.element"):60103,nx=Ar?Symbol.for("react.portal"):60106,sg=Ar?Symbol.for("react.fragment"):60107,ag=Ar?Symbol.for("react.strict_mode"):60108,lg=Ar?Symbol.for("react.profiler"):60114,cg=Ar?Symbol.for("react.provider"):60109,ug=Ar?Symbol.for("react.context"):60110,rx=Ar?Symbol.for("react.async_mode"):60111,hg=Ar?Symbol.for("react.concurrent_mode"):60111,dg=Ar?Symbol.for("react.forward_ref"):60112,pg=Ar?Symbol.for("react.suspense"):60113,pz=Ar?Symbol.for("react.suspense_list"):60120,fg=Ar?Symbol.for("react.memo"):60115,mg=Ar?Symbol.for("react.lazy"):60116,fz=Ar?Symbol.for("react.block"):60121,mz=Ar?Symbol.for("react.fundamental"):60117,gz=Ar?Symbol.for("react.responder"):60118,yz=Ar?Symbol.for("react.scope"):60119;function uo(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case tx:switch(e=e.type,e){case rx:case hg:case sg:case lg:case ag:case pg:return e;default:switch(e=e&&e.$$typeof,e){case ug:case dg:case mg:case fg:case cg:return e;default:return t}}case nx:return t}}}function WC(e){return uo(e)===hg}gn.AsyncMode=rx;gn.ConcurrentMode=hg;gn.ContextConsumer=ug;gn.ContextProvider=cg;gn.Element=tx;gn.ForwardRef=dg;gn.Fragment=sg;gn.Lazy=mg;gn.Memo=fg;gn.Portal=nx;gn.Profiler=lg;gn.StrictMode=ag;gn.Suspense=pg;gn.isAsyncMode=function(e){return WC(e)||uo(e)===rx};gn.isConcurrentMode=WC;gn.isContextConsumer=function(e){return uo(e)===ug};gn.isContextProvider=function(e){return uo(e)===cg};gn.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===tx};gn.isForwardRef=function(e){return uo(e)===dg};gn.isFragment=function(e){return uo(e)===sg};gn.isLazy=function(e){return uo(e)===mg};gn.isMemo=function(e){return uo(e)===fg};gn.isPortal=function(e){return uo(e)===nx};gn.isProfiler=function(e){return uo(e)===lg};gn.isStrictMode=function(e){return uo(e)===ag};gn.isSuspense=function(e){return uo(e)===pg};gn.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===sg||e===hg||e===lg||e===ag||e===pg||e===pz||typeof e=="object"&&e!==null&&(e.$$typeof===mg||e.$$typeof===fg||e.$$typeof===cg||e.$$typeof===ug||e.$$typeof===dg||e.$$typeof===mz||e.$$typeof===gz||e.$$typeof===yz||e.$$typeof===fz)};gn.typeOf=uo;ZC.exports=gn;var _z=ZC.exports,KC=_z,vz={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},xz={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},XC={};XC[KC.ForwardRef]=vz;XC[KC.Memo]=xz;var bz=!0;function wz(e,t,s){var l="";return s.split(" ").forEach(function(f){e[f]!==void 0?t.push(e[f]+";"):l+=f+" "}),l}var YC=function(t,s,l){var f=t.key+"-"+s.name;(l===!1||bz===!1)&&t.registered[f]===void 0&&(t.registered[f]=s.styles)},JC=function(t,s,l){YC(t,s,l);var f=t.key+"-"+s.name;if(t.inserted[s.name]===void 0){var y=s;do t.insert(s===y?"."+f:"",y,t.sheet,!0),y=y.next;while(y!==void 0)}};function Sz(e){for(var t=0,s,l=0,f=e.length;f>=4;++l,f-=4)s=e.charCodeAt(l)&255|(e.charCodeAt(++l)&255)<<8|(e.charCodeAt(++l)&255)<<16|(e.charCodeAt(++l)&255)<<24,s=(s&65535)*1540483477+((s>>>16)*59797<<16),s^=s>>>24,t=(s&65535)*1540483477+((s>>>16)*59797<<16)^(t&65535)*1540483477+((t>>>16)*59797<<16);switch(f){case 3:t^=(e.charCodeAt(l+2)&255)<<16;case 2:t^=(e.charCodeAt(l+1)&255)<<8;case 1:t^=e.charCodeAt(l)&255,t=(t&65535)*1540483477+((t>>>16)*59797<<16)}return t^=t>>>13,t=(t&65535)*1540483477+((t>>>16)*59797<<16),((t^t>>>15)>>>0).toString(36)}var Tz={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Cz=!1,kz=/[A-Z]|^ms/g,Ez=/_EMO_([^_]+?)_([^]*?)_EMO_/g,QC=function(t){return t.charCodeAt(1)===45},Xw=function(t){return t!=null&&typeof t!="boolean"},E_=OC(function(e){return QC(e)?e:e.replace(kz,"-$&").toLowerCase()}),Yw=function(t,s){switch(t){case"animation":case"animationName":if(typeof s=="string")return s.replace(Ez,function(l,f,y){return ms={name:f,styles:y,next:ms},f})}return Tz[t]!==1&&!QC(t)&&typeof s=="number"&&s!==0?s+"px":s},Iz="Component selectors can only be used in conjunction with @emotion/babel-plugin, the swc Emotion plugin, or another Emotion-aware compiler transform.";function Zd(e,t,s){if(s==null)return"";var l=s;if(l.__emotion_styles!==void 0)return l;switch(typeof s){case"boolean":return"";case"object":{var f=s;if(f.anim===1)return ms={name:f.name,styles:f.styles,next:ms},f.name;var y=s;if(y.styles!==void 0){var x=y.next;if(x!==void 0)for(;x!==void 0;)ms={name:x.name,styles:x.styles,next:ms},x=x.next;var u=y.styles+";";return u}return Pz(e,t,s)}case"function":{if(e!==void 0){var P=ms,L=s(e);return ms=P,Zd(e,t,L)}break}}var U=s;if(t==null)return U;var N=t[U];return N!==void 0?N:U}function Pz(e,t,s){var l="";if(Array.isArray(s))for(var f=0;f<s.length;f++)l+=Zd(e,t,s[f])+";";else for(var y in s){var x=s[y];if(typeof x!="object"){var u=x;t!=null&&t[u]!==void 0?l+=y+"{"+t[u]+"}":Xw(u)&&(l+=E_(y)+":"+Yw(y,u)+";")}else{if(y==="NO_COMPONENT_SELECTOR"&&Cz)throw new Error(Iz);if(Array.isArray(x)&&typeof x[0]=="string"&&(t==null||t[x[0]]===void 0))for(var P=0;P<x.length;P++)Xw(x[P])&&(l+=E_(y)+":"+Yw(y,x[P])+";");else{var L=Zd(e,t,x);switch(y){case"animation":case"animationName":{l+=E_(y)+":"+L+";";break}default:l+=y+"{"+L+"}"}}}}return l}var Jw=/label:\s*([^\s;\n{]+)\s*(;|$)/g,ms;function ix(e,t,s){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var l=!0,f="";ms=void 0;var y=e[0];if(y==null||y.raw===void 0)l=!1,f+=Zd(s,t,y);else{var x=y;f+=x[0]}for(var u=1;u<e.length;u++)if(f+=Zd(s,t,e[u]),l){var P=y;f+=P[u]}Jw.lastIndex=0;for(var L="",U;(U=Jw.exec(f))!==null;)L+="-"+U[1];var N=Sz(f)+L;return{name:N,styles:f,next:ms}}var Az=function(t){return t()},ek=R_.useInsertionEffect?R_.useInsertionEffect:!1,Mz=ek||Az,Qw=ek||Te.useLayoutEffect,tk=Te.createContext(typeof HTMLElement<"u"?HC({key:"css"}):null),zz=tk.Provider,nk=function(t){return Te.forwardRef(function(s,l){var f=Te.useContext(tk);return t(s,f,l)})},gg=Te.createContext({}),I_={exports:{}},e2;function rk(){return e2||(e2=1,function(e){function t(){return e.exports=t=Object.assign?Object.assign.bind():function(s){for(var l=1;l<arguments.length;l++){var f=arguments[l];for(var y in f)({}).hasOwnProperty.call(f,y)&&(s[y]=f[y])}return s},e.exports.__esModule=!0,e.exports.default=e.exports,t.apply(null,arguments)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(I_)),I_.exports}rk();var Lz=nk(function(e,t){var s=e.styles,l=ix([s],void 0,Te.useContext(gg)),f=Te.useRef();return Qw(function(){var y=t.key+"-global",x=new t.sheet.constructor({key:y,nonce:t.sheet.nonce,container:t.sheet.container,speedy:t.sheet.isSpeedy}),u=!1,P=document.querySelector('style[data-emotion="'+y+" "+l.name+'"]');return t.sheet.tags.length&&(x.before=t.sheet.tags[0]),P!==null&&(u=!0,P.setAttribute("data-emotion",y),x.hydrate([P])),f.current=[x,u],function(){x.flush()}},[t]),Qw(function(){var y=f.current,x=y[0],u=y[1];if(u){y[1]=!1;return}if(l.next!==void 0&&JC(t,l.next,!0),x.tags.length){var P=x.tags[x.tags.length-1].nextElementSibling;x.before=P,x.flush()}t.insert("",l,x,!1)},[t,l.name]),null});function ik(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return ix(t)}var yg=function(){var t=ik.apply(void 0,arguments),s="animation-"+t.name;return{name:s,styles:"@keyframes "+s+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},Rz=B5,Dz=function(t){return t!=="theme"},t2=function(t){return typeof t=="string"&&t.charCodeAt(0)>96?Rz:Dz},n2=function(t,s,l){var f;if(s){var y=s.shouldForwardProp;f=t.__emotion_forwardProp&&y?function(x){return t.__emotion_forwardProp(x)&&y(x)}:y}return typeof f!="function"&&l&&(f=t.__emotion_forwardProp),f},Fz=!1,Bz=function(t){var s=t.cache,l=t.serialized,f=t.isStringTag;return YC(s,l,f),Mz(function(){return JC(s,l,f)}),null},Oz=function e(t,s){var l=t.__emotion_real===t,f=l&&t.__emotion_base||t,y,x;s!==void 0&&(y=s.label,x=s.target);var u=n2(t,s,l),P=u||t2(f),L=!P("as");return function(){var U=arguments,N=l&&t.__emotion_styles!==void 0?t.__emotion_styles.slice(0):[];if(y!==void 0&&N.push("label:"+y+";"),U[0]==null||U[0].raw===void 0)N.push.apply(N,U);else{N.push(U[0][0]);for(var D=U.length,se=1;se<D;se++)N.push(U[se],U[0][se])}var ne=nk(function(ee,ke,X){var Z=L&&ee.as||f,W="",pe=[],_e=ee;if(ee.theme==null){_e={};for(var be in ee)_e[be]=ee[be];_e.theme=Te.useContext(gg)}typeof ee.className=="string"?W=wz(ke.registered,pe,ee.className):ee.className!=null&&(W=ee.className+" ");var xe=ix(N.concat(pe),ke.registered,_e);W+=ke.key+"-"+xe.name,x!==void 0&&(W+=" "+x);var Re=L&&u===void 0?t2(Z):P,tt={};for(var Oe in ee)L&&Oe==="as"||Re(Oe)&&(tt[Oe]=ee[Oe]);return tt.className=W,X&&(tt.ref=X),Te.createElement(Te.Fragment,null,Te.createElement(Bz,{cache:ke,serialized:xe,isStringTag:typeof Z=="string"}),Te.createElement(Z,tt))});return ne.displayName=y!==void 0?y:"Styled("+(typeof f=="string"?f:f.displayName||f.name||"Component")+")",ne.defaultProps=t.defaultProps,ne.__emotion_real=ne,ne.__emotion_base=f,ne.__emotion_styles=N,ne.__emotion_forwardProp=u,Object.defineProperty(ne,"toString",{value:function(){return x===void 0&&Fz?"NO_COMPONENT_SELECTOR":"."+x}}),ne.withComponent=function(ee,ke){return e(ee,Ae({},s,ke,{shouldForwardProp:n2(ne,ke,!0)})).apply(void 0,N)},ne}},Nz=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],N0=Oz.bind();Nz.forEach(function(e){N0[e]=N0(e)});let $0;typeof document=="object"&&($0=HC({key:"css",prepend:!0}));function $z(e){const{injectFirst:t,children:s}=e;return t&&$0?Be.jsx(zz,{value:$0,children:s}):s}function jz(e){return e==null||Object.keys(e).length===0}function Uz(e){const{styles:t,defaultTheme:s={}}=e,l=typeof t=="function"?f=>t(jz(f)?s:f):t;return Be.jsx(Lz,{styles:l})}function ok(e,t){return N0(e,t)}const Vz=(e,t)=>{Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=t(e.__emotion_styles))},Gz=Object.freeze(Object.defineProperty({__proto__:null,GlobalStyles:Uz,StyledEngineProvider:$z,ThemeContext:gg,css:ik,default:ok,internal_processStyles:Vz,keyframes:yg},Symbol.toStringTag,{value:"Module"}));function $a(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function sk(e){if(!$a(e))return e;const t={};return Object.keys(e).forEach(s=>{t[s]=sk(e[s])}),t}function xs(e,t,s={clone:!0}){const l=s.clone?Ae({},e):e;return $a(e)&&$a(t)&&Object.keys(t).forEach(f=>{$a(t[f])&&Object.prototype.hasOwnProperty.call(e,f)&&$a(e[f])?l[f]=xs(e[f],t[f],s):s.clone?l[f]=$a(t[f])?sk(t[f]):t[f]:l[f]=t[f]}),l}const qz=Object.freeze(Object.defineProperty({__proto__:null,default:xs,isPlainObject:$a},Symbol.toStringTag,{value:"Module"})),Hz=["values","unit","step"],Zz=e=>{const t=Object.keys(e).map(s=>({key:s,val:e[s]}))||[];return t.sort((s,l)=>s.val-l.val),t.reduce((s,l)=>Ae({},s,{[l.key]:l.val}),{})};function ak(e){const{values:t={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:s="px",step:l=5}=e,f=ln(e,Hz),y=Zz(t),x=Object.keys(y);function u(D){return`@media (min-width:${typeof t[D]=="number"?t[D]:D}${s})`}function P(D){return`@media (max-width:${(typeof t[D]=="number"?t[D]:D)-l/100}${s})`}function L(D,se){const ne=x.indexOf(se);return`@media (min-width:${typeof t[D]=="number"?t[D]:D}${s}) and (max-width:${(ne!==-1&&typeof t[x[ne]]=="number"?t[x[ne]]:se)-l/100}${s})`}function U(D){return x.indexOf(D)+1<x.length?L(D,x[x.indexOf(D)+1]):u(D)}function N(D){const se=x.indexOf(D);return se===0?u(x[1]):se===x.length-1?P(x[se]):L(D,x[x.indexOf(D)+1]).replace("@media","@media not all and")}return Ae({keys:x,values:y,up:u,down:P,between:L,only:U,not:N,unit:s},f)}const Wz={borderRadius:4};function Td(e,t){return t?xs(e,t,{clone:!1}):e}const ox={xs:0,sm:600,md:900,lg:1200,xl:1536},r2={keys:["xs","sm","md","lg","xl"],up:e=>`@media (min-width:${ox[e]}px)`};function Js(e,t,s){const l=e.theme||{};if(Array.isArray(t)){const y=l.breakpoints||r2;return t.reduce((x,u,P)=>(x[y.up(y.keys[P])]=s(t[P]),x),{})}if(typeof t=="object"){const y=l.breakpoints||r2;return Object.keys(t).reduce((x,u)=>{if(Object.keys(y.values||ox).indexOf(u)!==-1){const P=y.up(u);x[P]=s(t[u],u)}else{const P=u;x[P]=t[P]}return x},{})}return s(t)}function Kz(e={}){var t;return((t=e.keys)==null?void 0:t.reduce((l,f)=>{const y=e.up(f);return l[y]={},l},{}))||{}}function Xz(e,t){return e.reduce((s,l)=>{const f=s[l];return(!f||Object.keys(f).length===0)&&delete s[l],s},t)}function Wt(e){if(typeof e!="string")throw new Error(Gd(7));return e.charAt(0).toUpperCase()+e.slice(1)}const Yz=Object.freeze(Object.defineProperty({__proto__:null,default:Wt},Symbol.toStringTag,{value:"Module"}));function _g(e,t,s=!0){if(!t||typeof t!="string")return null;if(e&&e.vars&&s){const l=`vars.${t}`.split(".").reduce((f,y)=>f&&f[y]?f[y]:null,e);if(l!=null)return l}return t.split(".").reduce((l,f)=>l&&l[f]!=null?l[f]:null,e)}function Am(e,t,s,l=s){let f;return typeof e=="function"?f=e(s):Array.isArray(e)?f=e[s]||l:f=_g(e,s)||l,t&&(f=t(f,l,e)),f}function er(e){const{prop:t,cssProperty:s=e.prop,themeKey:l,transform:f}=e,y=x=>{if(x[t]==null)return null;const u=x[t],P=x.theme,L=_g(P,l)||{};return Js(x,u,N=>{let D=Am(L,f,N);return N===D&&typeof N=="string"&&(D=Am(L,f,`${t}${N==="default"?"":Wt(N)}`,N)),s===!1?D:{[s]:D}})};return y.propTypes={},y.filterProps=[t],y}function Jz(e){const t={};return s=>(t[s]===void 0&&(t[s]=e(s)),t[s])}const Qz={m:"margin",p:"padding"},eL={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},i2={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},tL=Jz(e=>{if(e.length>2)if(i2[e])e=i2[e];else return[e];const[t,s]=e.split(""),l=Qz[t],f=eL[s]||"";return Array.isArray(f)?f.map(y=>l+y):[l+f]}),sx=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],ax=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...sx,...ax];function np(e,t,s,l){var f;const y=(f=_g(e,t,!1))!=null?f:s;return typeof y=="number"?x=>typeof x=="string"?x:y*x:Array.isArray(y)?x=>typeof x=="string"?x:y[x]:typeof y=="function"?y:()=>{}}function lk(e){return np(e,"spacing",8)}function rp(e,t){if(typeof t=="string"||t==null)return t;const s=Math.abs(t),l=e(s);return t>=0?l:typeof l=="number"?-l:`-${l}`}function nL(e,t){return s=>e.reduce((l,f)=>(l[f]=rp(t,s),l),{})}function rL(e,t,s,l){if(t.indexOf(s)===-1)return null;const f=tL(s),y=nL(f,l),x=e[s];return Js(e,x,y)}function ck(e,t){const s=lk(e.theme);return Object.keys(e).map(l=>rL(e,t,l,s)).reduce(Td,{})}function Kn(e){return ck(e,sx)}Kn.propTypes={};Kn.filterProps=sx;function Xn(e){return ck(e,ax)}Xn.propTypes={};Xn.filterProps=ax;function iL(e=8){if(e.mui)return e;const t=lk({spacing:e}),s=(...l)=>(l.length===0?[1]:l).map(y=>{const x=t(y);return typeof x=="number"?`${x}px`:x}).join(" ");return s.mui=!0,s}function vg(...e){const t=e.reduce((l,f)=>(f.filterProps.forEach(y=>{l[y]=f}),l),{}),s=l=>Object.keys(l).reduce((f,y)=>t[y]?Td(f,t[y](l)):f,{});return s.propTypes={},s.filterProps=e.reduce((l,f)=>l.concat(f.filterProps),[]),s}function Io(e){return typeof e!="number"?e:`${e}px solid`}function Do(e,t){return er({prop:e,themeKey:"borders",transform:t})}const oL=Do("border",Io),sL=Do("borderTop",Io),aL=Do("borderRight",Io),lL=Do("borderBottom",Io),cL=Do("borderLeft",Io),uL=Do("borderColor"),hL=Do("borderTopColor"),dL=Do("borderRightColor"),pL=Do("borderBottomColor"),fL=Do("borderLeftColor"),mL=Do("outline",Io),gL=Do("outlineColor"),xg=e=>{if(e.borderRadius!==void 0&&e.borderRadius!==null){const t=np(e.theme,"shape.borderRadius",4),s=l=>({borderRadius:rp(t,l)});return Js(e,e.borderRadius,s)}return null};xg.propTypes={};xg.filterProps=["borderRadius"];vg(oL,sL,aL,lL,cL,uL,hL,dL,pL,fL,xg,mL,gL);const bg=e=>{if(e.gap!==void 0&&e.gap!==null){const t=np(e.theme,"spacing",8),s=l=>({gap:rp(t,l)});return Js(e,e.gap,s)}return null};bg.propTypes={};bg.filterProps=["gap"];const wg=e=>{if(e.columnGap!==void 0&&e.columnGap!==null){const t=np(e.theme,"spacing",8),s=l=>({columnGap:rp(t,l)});return Js(e,e.columnGap,s)}return null};wg.propTypes={};wg.filterProps=["columnGap"];const Sg=e=>{if(e.rowGap!==void 0&&e.rowGap!==null){const t=np(e.theme,"spacing",8),s=l=>({rowGap:rp(t,l)});return Js(e,e.rowGap,s)}return null};Sg.propTypes={};Sg.filterProps=["rowGap"];const yL=er({prop:"gridColumn"}),_L=er({prop:"gridRow"}),vL=er({prop:"gridAutoFlow"}),xL=er({prop:"gridAutoColumns"}),bL=er({prop:"gridAutoRows"}),wL=er({prop:"gridTemplateColumns"}),SL=er({prop:"gridTemplateRows"}),TL=er({prop:"gridTemplateAreas"}),CL=er({prop:"gridArea"});vg(bg,wg,Sg,yL,_L,vL,xL,bL,wL,SL,TL,CL);function Cu(e,t){return t==="grey"?t:e}const kL=er({prop:"color",themeKey:"palette",transform:Cu}),EL=er({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:Cu}),IL=er({prop:"backgroundColor",themeKey:"palette",transform:Cu});vg(kL,EL,IL);function ro(e){return e<=1&&e!==0?`${e*100}%`:e}const PL=er({prop:"width",transform:ro}),lx=e=>{if(e.maxWidth!==void 0&&e.maxWidth!==null){const t=s=>{var l,f;const y=((l=e.theme)==null||(l=l.breakpoints)==null||(l=l.values)==null?void 0:l[s])||ox[s];return y?((f=e.theme)==null||(f=f.breakpoints)==null?void 0:f.unit)!=="px"?{maxWidth:`${y}${e.theme.breakpoints.unit}`}:{maxWidth:y}:{maxWidth:ro(s)}};return Js(e,e.maxWidth,t)}return null};lx.filterProps=["maxWidth"];const AL=er({prop:"minWidth",transform:ro}),ML=er({prop:"height",transform:ro}),zL=er({prop:"maxHeight",transform:ro}),LL=er({prop:"minHeight",transform:ro});er({prop:"size",cssProperty:"width",transform:ro});er({prop:"size",cssProperty:"height",transform:ro});const RL=er({prop:"boxSizing"});vg(PL,lx,AL,ML,zL,LL,RL);const ip={border:{themeKey:"borders",transform:Io},borderTop:{themeKey:"borders",transform:Io},borderRight:{themeKey:"borders",transform:Io},borderBottom:{themeKey:"borders",transform:Io},borderLeft:{themeKey:"borders",transform:Io},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:Io},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:xg},color:{themeKey:"palette",transform:Cu},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:Cu},backgroundColor:{themeKey:"palette",transform:Cu},p:{style:Xn},pt:{style:Xn},pr:{style:Xn},pb:{style:Xn},pl:{style:Xn},px:{style:Xn},py:{style:Xn},padding:{style:Xn},paddingTop:{style:Xn},paddingRight:{style:Xn},paddingBottom:{style:Xn},paddingLeft:{style:Xn},paddingX:{style:Xn},paddingY:{style:Xn},paddingInline:{style:Xn},paddingInlineStart:{style:Xn},paddingInlineEnd:{style:Xn},paddingBlock:{style:Xn},paddingBlockStart:{style:Xn},paddingBlockEnd:{style:Xn},m:{style:Kn},mt:{style:Kn},mr:{style:Kn},mb:{style:Kn},ml:{style:Kn},mx:{style:Kn},my:{style:Kn},margin:{style:Kn},marginTop:{style:Kn},marginRight:{style:Kn},marginBottom:{style:Kn},marginLeft:{style:Kn},marginX:{style:Kn},marginY:{style:Kn},marginInline:{style:Kn},marginInlineStart:{style:Kn},marginInlineEnd:{style:Kn},marginBlock:{style:Kn},marginBlockStart:{style:Kn},marginBlockEnd:{style:Kn},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:bg},rowGap:{style:Sg},columnGap:{style:wg},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:ro},maxWidth:{style:lx},minWidth:{transform:ro},height:{transform:ro},maxHeight:{transform:ro},minHeight:{transform:ro},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function DL(...e){const t=e.reduce((l,f)=>l.concat(Object.keys(f)),[]),s=new Set(t);return e.every(l=>s.size===Object.keys(l).length)}function FL(e,t){return typeof e=="function"?e(t):e}function uk(){function e(s,l,f,y){const x={[s]:l,theme:f},u=y[s];if(!u)return{[s]:l};const{cssProperty:P=s,themeKey:L,transform:U,style:N}=u;if(l==null)return null;if(L==="typography"&&l==="inherit")return{[s]:l};const D=_g(f,L)||{};return N?N(x):Js(x,l,ne=>{let ee=Am(D,U,ne);return ne===ee&&typeof ne=="string"&&(ee=Am(D,U,`${s}${ne==="default"?"":Wt(ne)}`,ne)),P===!1?ee:{[P]:ee}})}function t(s){var l;const{sx:f,theme:y={}}=s||{};if(!f)return null;const x=(l=y.unstable_sxConfig)!=null?l:ip;function u(P){let L=P;if(typeof P=="function")L=P(y);else if(typeof P!="object")return P;if(!L)return null;const U=Kz(y.breakpoints),N=Object.keys(U);let D=U;return Object.keys(L).forEach(se=>{const ne=FL(L[se],y);if(ne!=null)if(typeof ne=="object")if(x[se])D=Td(D,e(se,ne,y,x));else{const ee=Js({theme:y},ne,ke=>({[se]:ke}));DL(ee,ne)?D[se]=t({sx:ne,theme:y}):D=Td(D,ee)}else D=Td(D,e(se,ne,y,x))}),Xz(N,D)}return Array.isArray(f)?f.map(u):u(f)}return t}const op=uk();op.filterProps=["sx"];function hk(e,t){const s=this;return s.vars&&typeof s.getColorSchemeSelector=="function"?{[s.getColorSchemeSelector(e).replace(/(\[[^\]]+\])/,"*:where($1)")]:t}:s.palette.mode===e?t:{}}const BL=["breakpoints","palette","spacing","shape"];function cx(e={},...t){const{breakpoints:s={},palette:l={},spacing:f,shape:y={}}=e,x=ln(e,BL),u=ak(s),P=iL(f);let L=xs({breakpoints:u,direction:"ltr",components:{},palette:Ae({mode:"light"},l),spacing:P,shape:Ae({},Wz,y)},x);return L.applyStyles=hk,L=t.reduce((U,N)=>xs(U,N),L),L.unstable_sxConfig=Ae({},ip,x==null?void 0:x.unstable_sxConfig),L.unstable_sx=function(N){return op({sx:N,theme:this})},L}const OL=Object.freeze(Object.defineProperty({__proto__:null,default:cx,private_createBreakpoints:ak,unstable_applyStyles:hk},Symbol.toStringTag,{value:"Module"}));function NL(e){return Object.keys(e).length===0}function $L(e=null){const t=Te.useContext(gg);return!t||NL(t)?e:t}const jL=cx();function dk(e=jL){return $L(e)}const UL=["sx"],VL=e=>{var t,s;const l={systemProps:{},otherProps:{}},f=(t=e==null||(s=e.theme)==null?void 0:s.unstable_sxConfig)!=null?t:ip;return Object.keys(e).forEach(y=>{f[y]?l.systemProps[y]=e[y]:l.otherProps[y]=e[y]}),l};function ux(e){const{sx:t}=e,s=ln(e,UL),{systemProps:l,otherProps:f}=VL(s);let y;return Array.isArray(t)?y=[l,...t]:typeof t=="function"?y=(...x)=>{const u=t(...x);return $a(u)?Ae({},l,u):l}:y=Ae({},l,t),Ae({},f,{sx:y})}const GL=Object.freeze(Object.defineProperty({__proto__:null,default:op,extendSxProp:ux,unstable_createStyleFunctionSx:uk,unstable_defaultSxConfig:ip},Symbol.toStringTag,{value:"Module"})),o2=e=>e,qL=()=>{let e=o2;return{configure(t){e=t},generate(t){return e(t)},reset(){e=o2}}},hx=qL();function pk(e){var t,s,l="";if(typeof e=="string"||typeof e=="number")l+=e;else if(typeof e=="object")if(Array.isArray(e)){var f=e.length;for(t=0;t<f;t++)e[t]&&(s=pk(e[t]))&&(l&&(l+=" "),l+=s)}else for(s in e)e[s]&&(l&&(l+=" "),l+=s);return l}function Xt(){for(var e,t,s=0,l="",f=arguments.length;s<f;s++)(e=arguments[s])&&(t=pk(e))&&(l&&(l+=" "),l+=t);return l}const HL=["className","component"];function ZL(e={}){const{themeId:t,defaultTheme:s,defaultClassName:l="MuiBox-root",generateClassName:f}=e,y=ok("div",{shouldForwardProp:u=>u!=="theme"&&u!=="sx"&&u!=="as"})(op);return Te.forwardRef(function(P,L){const U=dk(s),N=ux(P),{className:D,component:se="div"}=N,ne=ln(N,HL);return Be.jsx(y,Ae({as:se,ref:L,className:Xt(D,f?f(l):l),theme:t&&U[t]||U},ne))})}const WL={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function ii(e,t,s="Mui"){const l=WL[t];return l?`${s}-${l}`:`${hx.generate(e)}-${t}`}function Mr(e,t,s="Mui"){const l={};return t.forEach(f=>{l[f]=ii(e,f,s)}),l}var fk={exports:{}},yn={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dx=Symbol.for("react.element"),px=Symbol.for("react.portal"),Tg=Symbol.for("react.fragment"),Cg=Symbol.for("react.strict_mode"),kg=Symbol.for("react.profiler"),Eg=Symbol.for("react.provider"),Ig=Symbol.for("react.context"),KL=Symbol.for("react.server_context"),Pg=Symbol.for("react.forward_ref"),Ag=Symbol.for("react.suspense"),Mg=Symbol.for("react.suspense_list"),zg=Symbol.for("react.memo"),Lg=Symbol.for("react.lazy"),XL=Symbol.for("react.offscreen"),mk;mk=Symbol.for("react.module.reference");function Fo(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case dx:switch(e=e.type,e){case Tg:case kg:case Cg:case Ag:case Mg:return e;default:switch(e=e&&e.$$typeof,e){case KL:case Ig:case Pg:case Lg:case zg:case Eg:return e;default:return t}}case px:return t}}}yn.ContextConsumer=Ig;yn.ContextProvider=Eg;yn.Element=dx;yn.ForwardRef=Pg;yn.Fragment=Tg;yn.Lazy=Lg;yn.Memo=zg;yn.Portal=px;yn.Profiler=kg;yn.StrictMode=Cg;yn.Suspense=Ag;yn.SuspenseList=Mg;yn.isAsyncMode=function(){return!1};yn.isConcurrentMode=function(){return!1};yn.isContextConsumer=function(e){return Fo(e)===Ig};yn.isContextProvider=function(e){return Fo(e)===Eg};yn.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===dx};yn.isForwardRef=function(e){return Fo(e)===Pg};yn.isFragment=function(e){return Fo(e)===Tg};yn.isLazy=function(e){return Fo(e)===Lg};yn.isMemo=function(e){return Fo(e)===zg};yn.isPortal=function(e){return Fo(e)===px};yn.isProfiler=function(e){return Fo(e)===kg};yn.isStrictMode=function(e){return Fo(e)===Cg};yn.isSuspense=function(e){return Fo(e)===Ag};yn.isSuspenseList=function(e){return Fo(e)===Mg};yn.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Tg||e===kg||e===Cg||e===Ag||e===Mg||e===XL||typeof e=="object"&&e!==null&&(e.$$typeof===Lg||e.$$typeof===zg||e.$$typeof===Eg||e.$$typeof===Ig||e.$$typeof===Pg||e.$$typeof===mk||e.getModuleId!==void 0)};yn.typeOf=Fo;fk.exports=yn;var s2=fk.exports;const YL=/^\s*function(?:\s|\s*\/\*.*\*\/\s*)+([^(\s/]*)\s*/;function gk(e){const t=`${e}`.match(YL);return t&&t[1]||""}function yk(e,t=""){return e.displayName||e.name||gk(e)||t}function a2(e,t,s){const l=yk(t);return e.displayName||(l!==""?`${s}(${l})`:s)}function JL(e){if(e!=null){if(typeof e=="string")return e;if(typeof e=="function")return yk(e,"Component");if(typeof e=="object")switch(e.$$typeof){case s2.ForwardRef:return a2(e,e.render,"ForwardRef");case s2.Memo:return a2(e,e.type,"memo");default:return}}}const QL=Object.freeze(Object.defineProperty({__proto__:null,default:JL,getFunctionName:gk},Symbol.toStringTag,{value:"Module"}));function Mm(e,t){const s=Ae({},t);return Object.keys(e).forEach(l=>{if(l.toString().match(/^(components|slots)$/))s[l]=Ae({},e[l],s[l]);else if(l.toString().match(/^(componentsProps|slotProps)$/)){const f=e[l]||{},y=t[l];s[l]={},!y||!Object.keys(y)?s[l]=f:!f||!Object.keys(f)?s[l]=y:(s[l]=Ae({},y),Object.keys(f).forEach(x=>{s[l][x]=Mm(f[x],y[x])}))}else s[l]===void 0&&(s[l]=e[l])}),s}const Wd=typeof window<"u"?Te.useLayoutEffect:Te.useEffect;function eR(e,t=Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER){return Math.max(t,Math.min(e,s))}const tR=Object.freeze(Object.defineProperty({__proto__:null,default:eR},Symbol.toStringTag,{value:"Module"}));function j0(...e){return e.reduce((t,s)=>s==null?t:function(...f){t.apply(this,f),s.apply(this,f)},()=>{})}function _k(e,t=166){let s;function l(...f){const y=()=>{e.apply(this,f)};clearTimeout(s),s=setTimeout(y,t)}return l.clear=()=>{clearTimeout(s)},l}function nR(e,t){return()=>null}function vk(e,t){var s,l;return Te.isValidElement(e)&&t.indexOf((s=e.type.muiName)!=null?s:(l=e.type)==null||(l=l._payload)==null||(l=l.value)==null?void 0:l.muiName)!==-1}function Zs(e){return e&&e.ownerDocument||document}function $u(e){return Zs(e).defaultView||window}function rR(e,t){return()=>null}function zm(e,t){typeof e=="function"?e(t):e&&(e.current=t)}let l2=0;function iR(e){const[t,s]=Te.useState(e),l=e||t;return Te.useEffect(()=>{t==null&&(l2+=1,s(`mui-${l2}`))},[t]),l}const c2=R_.useId;function oR(e){if(c2!==void 0){const t=c2();return e??t}return iR(e)}function sR(e,t,s,l,f){return null}function aR({controlled:e,default:t,name:s,state:l="value"}){const{current:f}=Te.useRef(e!==void 0),[y,x]=Te.useState(t),u=f?e:y,P=Te.useCallback(L=>{f||x(L)},[]);return[u,P]}function Ol(e){const t=Te.useRef(e);return Wd(()=>{t.current=e}),Te.useRef((...s)=>(0,t.current)(...s)).current}function bs(...e){return Te.useMemo(()=>e.every(t=>t==null)?null:t=>{e.forEach(s=>{zm(s,t)})},e)}const u2={};function lR(e,t){const s=Te.useRef(u2);return s.current===u2&&(s.current=e(t)),s}const cR=[];function uR(e){Te.useEffect(e,cR)}class Rg{constructor(){this.currentId=null,this.clear=()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)},this.disposeEffect=()=>this.clear}static create(){return new Rg}start(t,s){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,s()},t)}}function hR(){const e=lR(Rg.create).current;return uR(e.disposeEffect),e}let Dg=!0,U0=!1;const dR=new Rg,pR={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function fR(e){const{type:t,tagName:s}=e;return!!(s==="INPUT"&&pR[t]&&!e.readOnly||s==="TEXTAREA"&&!e.readOnly||e.isContentEditable)}function mR(e){e.metaKey||e.altKey||e.ctrlKey||(Dg=!0)}function P_(){Dg=!1}function gR(){this.visibilityState==="hidden"&&U0&&(Dg=!0)}function yR(e){e.addEventListener("keydown",mR,!0),e.addEventListener("mousedown",P_,!0),e.addEventListener("pointerdown",P_,!0),e.addEventListener("touchstart",P_,!0),e.addEventListener("visibilitychange",gR,!0)}function _R(e){const{target:t}=e;try{return t.matches(":focus-visible")}catch{}return Dg||fR(t)}function xk(){const e=Te.useCallback(f=>{f!=null&&yR(f.ownerDocument)},[]),t=Te.useRef(!1);function s(){return t.current?(U0=!0,dR.start(100,()=>{U0=!1}),t.current=!1,!0):!1}function l(f){return _R(f)?(t.current=!0,!0):!1}return{isFocusVisibleRef:t,onFocus:l,onBlur:s,ref:e}}function vR(e){const t=e.documentElement.clientWidth;return Math.abs(window.innerWidth-t)}function bi(e,t,s=void 0){const l={};return Object.keys(e).forEach(f=>{l[f]=e[f].reduce((y,x)=>{if(x){const u=t(x);u!==""&&y.push(u),s&&s[x]&&y.push(s[x])}return y},[]).join(" ")}),l}function V0(e){return typeof e=="string"}function xR(e,t,s){return e===void 0||V0(e)?t:Ae({},t,{ownerState:Ae({},t.ownerState,s)})}function bk(e,t=[]){if(e===void 0)return{};const s={};return Object.keys(e).filter(l=>l.match(/^on[A-Z]/)&&typeof e[l]=="function"&&!t.includes(l)).forEach(l=>{s[l]=e[l]}),s}function h2(e){if(e===void 0)return{};const t={};return Object.keys(e).filter(s=>!(s.match(/^on[A-Z]/)&&typeof e[s]=="function")).forEach(s=>{t[s]=e[s]}),t}function bR(e){const{getSlotProps:t,additionalProps:s,externalSlotProps:l,externalForwardedProps:f,className:y}=e;if(!t){const se=Xt(s==null?void 0:s.className,y,f==null?void 0:f.className,l==null?void 0:l.className),ne=Ae({},s==null?void 0:s.style,f==null?void 0:f.style,l==null?void 0:l.style),ee=Ae({},s,f,l);return se.length>0&&(ee.className=se),Object.keys(ne).length>0&&(ee.style=ne),{props:ee,internalRef:void 0}}const x=bk(Ae({},f,l)),u=h2(l),P=h2(f),L=t(x),U=Xt(L==null?void 0:L.className,s==null?void 0:s.className,y,f==null?void 0:f.className,l==null?void 0:l.className),N=Ae({},L==null?void 0:L.style,s==null?void 0:s.style,f==null?void 0:f.style,l==null?void 0:l.style),D=Ae({},L,s,P,u);return U.length>0&&(D.className=U),Object.keys(N).length>0&&(D.style=N),{props:D,internalRef:L.ref}}function wR(e,t,s){return typeof e=="function"?e(t,s):e}const SR=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];function d2(e){var t;const{elementType:s,externalSlotProps:l,ownerState:f,skipResolvingSlotProps:y=!1}=e,x=ln(e,SR),u=y?{}:wR(l,f),{props:P,internalRef:L}=bR(Ae({},x,{externalSlotProps:u})),U=bs(L,u==null?void 0:u.ref,(t=e.additionalProps)==null?void 0:t.ref);return xR(s,Ae({},P,{ref:U}),f)}const TR=Te.createContext(),CR=()=>{const e=Te.useContext(TR);return e??!1},kR=Te.createContext(void 0);function ER(e){const{theme:t,name:s,props:l}=e;if(!t||!t.components||!t.components[s])return l;const f=t.components[s];return f.defaultProps?Mm(f.defaultProps,l):!f.styleOverrides&&!f.variants?Mm(f,l):l}function IR({props:e,name:t}){const s=Te.useContext(kR);return ER({props:e,name:t,theme:{components:s}})}function PR(e,t){return Ae({toolbar:{minHeight:56,[e.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[e.up("sm")]:{minHeight:64}}},t)}var tr={},wk={exports:{}};(function(e){function t(s){return s&&s.__esModule?s:{default:s}}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(wk);var sp=wk.exports;const AR=Qs(D5),MR=Qs(tR);var Sk=sp;Object.defineProperty(tr,"__esModule",{value:!0});var Ao=tr.alpha=Ek;tr.blend=GR;tr.colorChannel=void 0;var zR=tr.darken=mx;tr.decomposeColor=Ro;tr.emphasize=Ik;var LR=tr.getContrastRatio=NR;tr.getLuminance=Lm;tr.hexToRgb=Tk;tr.hslToRgb=kk;var RR=tr.lighten=gx;tr.private_safeAlpha=$R;tr.private_safeColorChannel=void 0;tr.private_safeDarken=jR;tr.private_safeEmphasize=VR;tr.private_safeLighten=UR;tr.recomposeColor=ju;tr.rgbToHex=OR;var p2=Sk(AR),DR=Sk(MR);function fx(e,t=0,s=1){return(0,DR.default)(e,t,s)}function Tk(e){e=e.slice(1);const t=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let s=e.match(t);return s&&s[0].length===1&&(s=s.map(l=>l+l)),s?`rgb${s.length===4?"a":""}(${s.map((l,f)=>f<3?parseInt(l,16):Math.round(parseInt(l,16)/255*1e3)/1e3).join(", ")})`:""}function FR(e){const t=e.toString(16);return t.length===1?`0${t}`:t}function Ro(e){if(e.type)return e;if(e.charAt(0)==="#")return Ro(Tk(e));const t=e.indexOf("("),s=e.substring(0,t);if(["rgb","rgba","hsl","hsla","color"].indexOf(s)===-1)throw new Error((0,p2.default)(9,e));let l=e.substring(t+1,e.length-1),f;if(s==="color"){if(l=l.split(" "),f=l.shift(),l.length===4&&l[3].charAt(0)==="/"&&(l[3]=l[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(f)===-1)throw new Error((0,p2.default)(10,f))}else l=l.split(",");return l=l.map(y=>parseFloat(y)),{type:s,values:l,colorSpace:f}}const Ck=e=>{const t=Ro(e);return t.values.slice(0,3).map((s,l)=>t.type.indexOf("hsl")!==-1&&l!==0?`${s}%`:s).join(" ")};tr.colorChannel=Ck;const BR=(e,t)=>{try{return Ck(e)}catch{return e}};tr.private_safeColorChannel=BR;function ju(e){const{type:t,colorSpace:s}=e;let{values:l}=e;return t.indexOf("rgb")!==-1?l=l.map((f,y)=>y<3?parseInt(f,10):f):t.indexOf("hsl")!==-1&&(l[1]=`${l[1]}%`,l[2]=`${l[2]}%`),t.indexOf("color")!==-1?l=`${s} ${l.join(" ")}`:l=`${l.join(", ")}`,`${t}(${l})`}function OR(e){if(e.indexOf("#")===0)return e;const{values:t}=Ro(e);return`#${t.map((s,l)=>FR(l===3?Math.round(255*s):s)).join("")}`}function kk(e){e=Ro(e);const{values:t}=e,s=t[0],l=t[1]/100,f=t[2]/100,y=l*Math.min(f,1-f),x=(L,U=(L+s/30)%12)=>f-y*Math.max(Math.min(U-3,9-U,1),-1);let u="rgb";const P=[Math.round(x(0)*255),Math.round(x(8)*255),Math.round(x(4)*255)];return e.type==="hsla"&&(u+="a",P.push(t[3])),ju({type:u,values:P})}function Lm(e){e=Ro(e);let t=e.type==="hsl"||e.type==="hsla"?Ro(kk(e)).values:e.values;return t=t.map(s=>(e.type!=="color"&&(s/=255),s<=.03928?s/12.92:((s+.055)/1.055)**2.4)),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function NR(e,t){const s=Lm(e),l=Lm(t);return(Math.max(s,l)+.05)/(Math.min(s,l)+.05)}function Ek(e,t){return e=Ro(e),t=fx(t),(e.type==="rgb"||e.type==="hsl")&&(e.type+="a"),e.type==="color"?e.values[3]=`/${t}`:e.values[3]=t,ju(e)}function $R(e,t,s){try{return Ek(e,t)}catch{return e}}function mx(e,t){if(e=Ro(e),t=fx(t),e.type.indexOf("hsl")!==-1)e.values[2]*=1-t;else if(e.type.indexOf("rgb")!==-1||e.type.indexOf("color")!==-1)for(let s=0;s<3;s+=1)e.values[s]*=1-t;return ju(e)}function jR(e,t,s){try{return mx(e,t)}catch{return e}}function gx(e,t){if(e=Ro(e),t=fx(t),e.type.indexOf("hsl")!==-1)e.values[2]+=(100-e.values[2])*t;else if(e.type.indexOf("rgb")!==-1)for(let s=0;s<3;s+=1)e.values[s]+=(255-e.values[s])*t;else if(e.type.indexOf("color")!==-1)for(let s=0;s<3;s+=1)e.values[s]+=(1-e.values[s])*t;return ju(e)}function UR(e,t,s){try{return gx(e,t)}catch{return e}}function Ik(e,t=.15){return Lm(e)>.5?mx(e,t):gx(e,t)}function VR(e,t,s){try{return Ik(e,t)}catch{return e}}function GR(e,t,s,l=1){const f=(P,L)=>Math.round((P**(1/l)*(1-s)+L**(1/l)*s)**l),y=Ro(e),x=Ro(t),u=[f(y.values[0],x.values[0]),f(y.values[1],x.values[1]),f(y.values[2],x.values[2])];return ju({type:"rgb",values:u})}const qR=["mode","contrastThreshold","tonalOffset"],f2={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:Vd.white,default:Vd.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},A_={text:{primary:Vd.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:Vd.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function m2(e,t,s,l){const f=l.light||l,y=l.dark||l*1.5;e[t]||(e.hasOwnProperty(s)?e[t]=e[s]:t==="light"?e.light=RR(e.main,f):t==="dark"&&(e.dark=zR(e.main,y)))}function HR(e="light"){return e==="dark"?{main:Wc[200],light:Wc[50],dark:Wc[400]}:{main:Wc[700],light:Wc[400],dark:Wc[800]}}function ZR(e="light"){return e==="dark"?{main:Zc[200],light:Zc[50],dark:Zc[400]}:{main:Zc[500],light:Zc[300],dark:Zc[700]}}function WR(e="light"){return e==="dark"?{main:Hc[500],light:Hc[300],dark:Hc[700]}:{main:Hc[700],light:Hc[400],dark:Hc[800]}}function KR(e="light"){return e==="dark"?{main:Kc[400],light:Kc[300],dark:Kc[700]}:{main:Kc[700],light:Kc[500],dark:Kc[900]}}function XR(e="light"){return e==="dark"?{main:Xc[400],light:Xc[300],dark:Xc[700]}:{main:Xc[800],light:Xc[500],dark:Xc[900]}}function YR(e="light"){return e==="dark"?{main:od[400],light:od[300],dark:od[700]}:{main:"#ed6c02",light:od[500],dark:od[900]}}function JR(e){const{mode:t="light",contrastThreshold:s=3,tonalOffset:l=.2}=e,f=ln(e,qR),y=e.primary||HR(t),x=e.secondary||ZR(t),u=e.error||WR(t),P=e.info||KR(t),L=e.success||XR(t),U=e.warning||YR(t);function N(ee){return LR(ee,A_.text.primary)>=s?A_.text.primary:f2.text.primary}const D=({color:ee,name:ke,mainShade:X=500,lightShade:Z=300,darkShade:W=700})=>{if(ee=Ae({},ee),!ee.main&&ee[X]&&(ee.main=ee[X]),!ee.hasOwnProperty("main"))throw new Error(Gd(11,ke?` (${ke})`:"",X));if(typeof ee.main!="string")throw new Error(Gd(12,ke?` (${ke})`:"",JSON.stringify(ee.main)));return m2(ee,"light",Z,l),m2(ee,"dark",W,l),ee.contrastText||(ee.contrastText=N(ee.main)),ee},se={dark:A_,light:f2};return xs(Ae({common:Ae({},Vd),mode:t,primary:D({color:y,name:"primary"}),secondary:D({color:x,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:D({color:u,name:"error"}),warning:D({color:U,name:"warning"}),info:D({color:P,name:"info"}),success:D({color:L,name:"success"}),grey:R5,contrastThreshold:s,getContrastText:N,augmentColor:D,tonalOffset:l},se[t]),f)}const QR=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function e3(e){return Math.round(e*1e5)/1e5}const g2={textTransform:"uppercase"},y2='"Roboto", "Helvetica", "Arial", sans-serif';function t3(e,t){const s=typeof t=="function"?t(e):t,{fontFamily:l=y2,fontSize:f=14,fontWeightLight:y=300,fontWeightRegular:x=400,fontWeightMedium:u=500,fontWeightBold:P=700,htmlFontSize:L=16,allVariants:U,pxToRem:N}=s,D=ln(s,QR),se=f/14,ne=N||(X=>`${X/L*se}rem`),ee=(X,Z,W,pe,_e)=>Ae({fontFamily:l,fontWeight:X,fontSize:ne(Z),lineHeight:W},l===y2?{letterSpacing:`${e3(pe/Z)}em`}:{},_e,U),ke={h1:ee(y,96,1.167,-1.5),h2:ee(y,60,1.2,-.5),h3:ee(x,48,1.167,0),h4:ee(x,34,1.235,.25),h5:ee(x,24,1.334,0),h6:ee(u,20,1.6,.15),subtitle1:ee(x,16,1.75,.15),subtitle2:ee(u,14,1.57,.1),body1:ee(x,16,1.5,.15),body2:ee(x,14,1.43,.15),button:ee(u,14,1.75,.4,g2),caption:ee(x,12,1.66,.4),overline:ee(x,12,2.66,1,g2),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return xs(Ae({htmlFontSize:L,pxToRem:ne,fontFamily:l,fontSize:f,fontWeightLight:y,fontWeightRegular:x,fontWeightMedium:u,fontWeightBold:P},ke),D,{clone:!1})}const n3=.2,r3=.14,i3=.12;function On(...e){return[`${e[0]}px ${e[1]}px ${e[2]}px ${e[3]}px rgba(0,0,0,${n3})`,`${e[4]}px ${e[5]}px ${e[6]}px ${e[7]}px rgba(0,0,0,${r3})`,`${e[8]}px ${e[9]}px ${e[10]}px ${e[11]}px rgba(0,0,0,${i3})`].join(",")}const o3=["none",On(0,2,1,-1,0,1,1,0,0,1,3,0),On(0,3,1,-2,0,2,2,0,0,1,5,0),On(0,3,3,-2,0,3,4,0,0,1,8,0),On(0,2,4,-1,0,4,5,0,0,1,10,0),On(0,3,5,-1,0,5,8,0,0,1,14,0),On(0,3,5,-1,0,6,10,0,0,1,18,0),On(0,4,5,-2,0,7,10,1,0,2,16,1),On(0,5,5,-3,0,8,10,1,0,3,14,2),On(0,5,6,-3,0,9,12,1,0,3,16,2),On(0,6,6,-3,0,10,14,1,0,4,18,3),On(0,6,7,-4,0,11,15,1,0,4,20,3),On(0,7,8,-4,0,12,17,2,0,5,22,4),On(0,7,8,-4,0,13,19,2,0,5,24,4),On(0,7,9,-4,0,14,21,2,0,5,26,4),On(0,8,9,-5,0,15,22,2,0,6,28,5),On(0,8,10,-5,0,16,24,2,0,6,30,5),On(0,8,11,-5,0,17,26,2,0,6,32,5),On(0,9,11,-5,0,18,28,2,0,7,34,6),On(0,9,12,-6,0,19,29,2,0,7,36,6),On(0,10,13,-6,0,20,31,3,0,8,38,7),On(0,10,13,-6,0,21,33,3,0,8,40,7),On(0,10,14,-6,0,22,35,3,0,8,42,7),On(0,11,14,-7,0,23,36,3,0,9,44,8),On(0,11,15,-7,0,24,38,3,0,9,46,8)],s3=["duration","easing","delay"],a3={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},l3={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function _2(e){return`${Math.round(e)}ms`}function c3(e){if(!e)return 0;const t=e/36;return Math.round((4+15*t**.25+t/5)*10)}function u3(e){const t=Ae({},a3,e.easing),s=Ae({},l3,e.duration);return Ae({getAutoHeightDuration:c3,create:(f=["all"],y={})=>{const{duration:x=s.standard,easing:u=t.easeInOut,delay:P=0}=y;return ln(y,s3),(Array.isArray(f)?f:[f]).map(L=>`${L} ${typeof x=="string"?x:_2(x)} ${u} ${typeof P=="string"?P:_2(P)}`).join(",")}},e,{easing:t,duration:s})}const h3={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},d3=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function Pk(e={},...t){const{mixins:s={},palette:l={},transitions:f={},typography:y={}}=e,x=ln(e,d3);if(e.vars)throw new Error(Gd(18));const u=JR(l),P=cx(e);let L=xs(P,{mixins:PR(P.breakpoints,s),palette:u,shadows:o3.slice(),typography:t3(u,y),transitions:u3(f),zIndex:Ae({},h3)});return L=xs(L,x),L=t.reduce((U,N)=>xs(U,N),L),L.unstable_sxConfig=Ae({},ip,x==null?void 0:x.unstable_sxConfig),L.unstable_sx=function(N){return op({sx:N,theme:this})},L}const Ak=Pk();function Fg(){const e=dk(Ak);return e[Yv]||e}var ap={},M_={exports:{}},v2;function p3(){return v2||(v2=1,function(e){function t(s,l){if(s==null)return{};var f={};for(var y in s)if({}.hasOwnProperty.call(s,y)){if(l.indexOf(y)>=0)continue;f[y]=s[y]}return f}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(M_)),M_.exports}const f3=Qs(Gz),m3=Qs(qz),g3=Qs(Yz),y3=Qs(QL),_3=Qs(OL),v3=Qs(GL);var Uu=sp;Object.defineProperty(ap,"__esModule",{value:!0});var x3=ap.default=L3;ap.shouldForwardProp=nm;ap.systemDefaultTheme=void 0;var So=Uu(rk()),G0=Uu(p3()),x2=E3(f3),b3=m3;Uu(g3);Uu(y3);var w3=Uu(_3),S3=Uu(v3);const T3=["ownerState"],C3=["variants"],k3=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function Mk(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,s=new WeakMap;return(Mk=function(l){return l?s:t})(e)}function E3(e,t){if(e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var s=Mk(t);if(s&&s.has(e))return s.get(e);var l={__proto__:null},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var y in e)if(y!=="default"&&Object.prototype.hasOwnProperty.call(e,y)){var x=f?Object.getOwnPropertyDescriptor(e,y):null;x&&(x.get||x.set)?Object.defineProperty(l,y,x):l[y]=e[y]}return l.default=e,s&&s.set(e,l),l}function I3(e){return Object.keys(e).length===0}function P3(e){return typeof e=="string"&&e.charCodeAt(0)>96}function nm(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}const A3=ap.systemDefaultTheme=(0,w3.default)(),M3=e=>e&&e.charAt(0).toLowerCase()+e.slice(1);function Lf({defaultTheme:e,theme:t,themeId:s}){return I3(t)?e:t[s]||t}function z3(e){return e?(t,s)=>s[e]:null}function rm(e,t){let{ownerState:s}=t,l=(0,G0.default)(t,T3);const f=typeof e=="function"?e((0,So.default)({ownerState:s},l)):e;if(Array.isArray(f))return f.flatMap(y=>rm(y,(0,So.default)({ownerState:s},l)));if(f&&typeof f=="object"&&Array.isArray(f.variants)){const{variants:y=[]}=f;let u=(0,G0.default)(f,C3);return y.forEach(P=>{let L=!0;typeof P.props=="function"?L=P.props((0,So.default)({ownerState:s},l,s)):Object.keys(P.props).forEach(U=>{(s==null?void 0:s[U])!==P.props[U]&&l[U]!==P.props[U]&&(L=!1)}),L&&(Array.isArray(u)||(u=[u]),u.push(typeof P.style=="function"?P.style((0,So.default)({ownerState:s},l,s)):P.style))}),u}return f}function L3(e={}){const{themeId:t,defaultTheme:s=A3,rootShouldForwardProp:l=nm,slotShouldForwardProp:f=nm}=e,y=x=>(0,S3.default)((0,So.default)({},x,{theme:Lf((0,So.default)({},x,{defaultTheme:s,themeId:t}))}));return y.__mui_systemSx=!0,(x,u={})=>{(0,x2.internal_processStyles)(x,_e=>_e.filter(be=>!(be!=null&&be.__mui_systemSx)));const{name:P,slot:L,skipVariantsResolver:U,skipSx:N,overridesResolver:D=z3(M3(L))}=u,se=(0,G0.default)(u,k3),ne=U!==void 0?U:L&&L!=="Root"&&L!=="root"||!1,ee=N||!1;let ke,X=nm;L==="Root"||L==="root"?X=l:L?X=f:P3(x)&&(X=void 0);const Z=(0,x2.default)(x,(0,So.default)({shouldForwardProp:X,label:ke},se)),W=_e=>typeof _e=="function"&&_e.__emotion_real!==_e||(0,b3.isPlainObject)(_e)?be=>rm(_e,(0,So.default)({},be,{theme:Lf({theme:be.theme,defaultTheme:s,themeId:t})})):_e,pe=(_e,...be)=>{let xe=W(_e);const Re=be?be.map(W):[];P&&D&&Re.push(He=>{const vt=Lf((0,So.default)({},He,{defaultTheme:s,themeId:t}));if(!vt.components||!vt.components[P]||!vt.components[P].styleOverrides)return null;const dt=vt.components[P].styleOverrides,ht={};return Object.entries(dt).forEach(([Lt,yt])=>{ht[Lt]=rm(yt,(0,So.default)({},He,{theme:vt}))}),D(He,ht)}),P&&!ne&&Re.push(He=>{var vt;const dt=Lf((0,So.default)({},He,{defaultTheme:s,themeId:t})),ht=dt==null||(vt=dt.components)==null||(vt=vt[P])==null?void 0:vt.variants;return rm({variants:ht},(0,So.default)({},He,{theme:dt}))}),ee||Re.push(y);const tt=Re.length-be.length;if(Array.isArray(_e)&&tt>0){const He=new Array(tt).fill("");xe=[..._e,...He],xe.raw=[..._e.raw,...He]}const Oe=Z(xe,...Re);return x.muiName&&(Oe.muiName=x.muiName),Oe};return Z.withConfig&&(pe.withConfig=Z.withConfig),pe}}function R3(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}const yx=e=>R3(e)&&e!=="classes",In=x3({themeId:Yv,defaultTheme:Ak,rootShouldForwardProp:yx}),b2=e=>{let t;return e<1?t=5.11916*e**2:t=4.5*Math.log(e+1)+2,(t/100).toFixed(2)};function oi(e){return IR(e)}function D3(e){return ii("MuiSvgIcon",e)}Mr("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const F3=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],B3=e=>{const{color:t,fontSize:s,classes:l}=e,f={root:["root",t!=="inherit"&&`color${Wt(t)}`,`fontSize${Wt(s)}`]};return bi(f,D3,l)},O3=In("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.root,s.color!=="inherit"&&t[`color${Wt(s.color)}`],t[`fontSize${Wt(s.fontSize)}`]]}})(({theme:e,ownerState:t})=>{var s,l,f,y,x,u,P,L,U,N,D,se,ne;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:t.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:(s=e.transitions)==null||(l=s.create)==null?void 0:l.call(s,"fill",{duration:(f=e.transitions)==null||(f=f.duration)==null?void 0:f.shorter}),fontSize:{inherit:"inherit",small:((y=e.typography)==null||(x=y.pxToRem)==null?void 0:x.call(y,20))||"1.25rem",medium:((u=e.typography)==null||(P=u.pxToRem)==null?void 0:P.call(u,24))||"1.5rem",large:((L=e.typography)==null||(U=L.pxToRem)==null?void 0:U.call(L,35))||"2.1875rem"}[t.fontSize],color:(N=(D=(e.vars||e).palette)==null||(D=D[t.color])==null?void 0:D.main)!=null?N:{action:(se=(e.vars||e).palette)==null||(se=se.action)==null?void 0:se.active,disabled:(ne=(e.vars||e).palette)==null||(ne=ne.action)==null?void 0:ne.disabled,inherit:void 0}[t.color]}}),q0=Te.forwardRef(function(t,s){const l=oi({props:t,name:"MuiSvgIcon"}),{children:f,className:y,color:x="inherit",component:u="svg",fontSize:P="medium",htmlColor:L,inheritViewBox:U=!1,titleAccess:N,viewBox:D="0 0 24 24"}=l,se=ln(l,F3),ne=Te.isValidElement(f)&&f.type==="svg",ee=Ae({},l,{color:x,component:u,fontSize:P,instanceFontSize:t.fontSize,inheritViewBox:U,viewBox:D,hasSvgAsChild:ne}),ke={};U||(ke.viewBox=D);const X=B3(ee);return Be.jsxs(O3,Ae({as:u,className:Xt(X.root,y),focusable:"false",color:L,"aria-hidden":N?void 0:!0,role:N?"img":void 0,ref:s},ke,se,ne&&f.props,{ownerState:ee,children:[ne?f.props.children:f,N?Be.jsx("title",{children:N}):null]}))});q0.muiName="SvgIcon";function N3(e,t){function s(l,f){return Be.jsx(q0,Ae({"data-testid":`${t}Icon`,ref:f},l,{children:e}))}return s.muiName=q0.muiName,Te.memo(Te.forwardRef(s))}const $3={configure:e=>{hx.configure(e)}},j3=Object.freeze(Object.defineProperty({__proto__:null,capitalize:Wt,createChainedFunction:j0,createSvgIcon:N3,debounce:_k,deprecatedPropType:nR,isMuiElement:vk,ownerDocument:Zs,ownerWindow:$u,requirePropFactory:rR,setRef:zm,unstable_ClassNameGenerator:$3,unstable_useEnhancedEffect:Wd,unstable_useId:oR,unsupportedProp:sR,useControlled:aR,useEventCallback:Ol,useForkRef:bs,useIsFocusVisible:xk},Symbol.toStringTag,{value:"Module"}));function H0(e,t){return H0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,l){return s.__proto__=l,s},H0(e,t)}function zk(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,H0(e,t)}const w2={disabled:!1},Rm=Xo.createContext(null);var U3=function(t){return t.scrollTop},fd="unmounted",Ll="exited",Rl="entering",eu="entered",Z0="exiting",ws=function(e){zk(t,e);function t(l,f){var y;y=e.call(this,l,f)||this;var x=f,u=x&&!x.isMounting?l.enter:l.appear,P;return y.appearStatus=null,l.in?u?(P=Ll,y.appearStatus=Rl):P=eu:l.unmountOnExit||l.mountOnEnter?P=fd:P=Ll,y.state={status:P},y.nextCallback=null,y}t.getDerivedStateFromProps=function(f,y){var x=f.in;return x&&y.status===fd?{status:Ll}:null};var s=t.prototype;return s.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},s.componentDidUpdate=function(f){var y=null;if(f!==this.props){var x=this.state.status;this.props.in?x!==Rl&&x!==eu&&(y=Rl):(x===Rl||x===eu)&&(y=Z0)}this.updateStatus(!1,y)},s.componentWillUnmount=function(){this.cancelNextCallback()},s.getTimeouts=function(){var f=this.props.timeout,y,x,u;return y=x=u=f,f!=null&&typeof f!="number"&&(y=f.exit,x=f.enter,u=f.appear!==void 0?f.appear:x),{exit:y,enter:x,appear:u}},s.updateStatus=function(f,y){if(f===void 0&&(f=!1),y!==null)if(this.cancelNextCallback(),y===Rl){if(this.props.unmountOnExit||this.props.mountOnEnter){var x=this.props.nodeRef?this.props.nodeRef.current:If.findDOMNode(this);x&&U3(x)}this.performEnter(f)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Ll&&this.setState({status:fd})},s.performEnter=function(f){var y=this,x=this.props.enter,u=this.context?this.context.isMounting:f,P=this.props.nodeRef?[u]:[If.findDOMNode(this),u],L=P[0],U=P[1],N=this.getTimeouts(),D=u?N.appear:N.enter;if(!f&&!x||w2.disabled){this.safeSetState({status:eu},function(){y.props.onEntered(L)});return}this.props.onEnter(L,U),this.safeSetState({status:Rl},function(){y.props.onEntering(L,U),y.onTransitionEnd(D,function(){y.safeSetState({status:eu},function(){y.props.onEntered(L,U)})})})},s.performExit=function(){var f=this,y=this.props.exit,x=this.getTimeouts(),u=this.props.nodeRef?void 0:If.findDOMNode(this);if(!y||w2.disabled){this.safeSetState({status:Ll},function(){f.props.onExited(u)});return}this.props.onExit(u),this.safeSetState({status:Z0},function(){f.props.onExiting(u),f.onTransitionEnd(x.exit,function(){f.safeSetState({status:Ll},function(){f.props.onExited(u)})})})},s.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},s.safeSetState=function(f,y){y=this.setNextCallback(y),this.setState(f,y)},s.setNextCallback=function(f){var y=this,x=!0;return this.nextCallback=function(u){x&&(x=!1,y.nextCallback=null,f(u))},this.nextCallback.cancel=function(){x=!1},this.nextCallback},s.onTransitionEnd=function(f,y){this.setNextCallback(y);var x=this.props.nodeRef?this.props.nodeRef.current:If.findDOMNode(this),u=f==null&&!this.props.addEndListener;if(!x||u){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var P=this.props.nodeRef?[this.nextCallback]:[x,this.nextCallback],L=P[0],U=P[1];this.props.addEndListener(L,U)}f!=null&&setTimeout(this.nextCallback,f)},s.render=function(){var f=this.state.status;if(f===fd)return null;var y=this.props,x=y.children;y.in,y.mountOnEnter,y.unmountOnExit,y.appear,y.enter,y.exit,y.timeout,y.addEndListener,y.onEnter,y.onEntering,y.onEntered,y.onExit,y.onExiting,y.onExited,y.nodeRef;var u=ln(y,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return Xo.createElement(Rm.Provider,{value:null},typeof x=="function"?x(f,u):Xo.cloneElement(Xo.Children.only(x),u))},t}(Xo.Component);ws.contextType=Rm;ws.propTypes={};function Yc(){}ws.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Yc,onEntering:Yc,onEntered:Yc,onExit:Yc,onExiting:Yc,onExited:Yc};ws.UNMOUNTED=fd;ws.EXITED=Ll;ws.ENTERING=Rl;ws.ENTERED=eu;ws.EXITING=Z0;function V3(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _x(e,t){var s=function(y){return t&&Te.isValidElement(y)?t(y):y},l=Object.create(null);return e&&Te.Children.map(e,function(f){return f}).forEach(function(f){l[f.key]=s(f)}),l}function G3(e,t){e=e||{},t=t||{};function s(U){return U in t?t[U]:e[U]}var l=Object.create(null),f=[];for(var y in e)y in t?f.length&&(l[y]=f,f=[]):f.push(y);var x,u={};for(var P in t){if(l[P])for(x=0;x<l[P].length;x++){var L=l[P][x];u[l[P][x]]=s(L)}u[P]=s(P)}for(x=0;x<f.length;x++)u[f[x]]=s(f[x]);return u}function Nl(e,t,s){return s[t]!=null?s[t]:e.props[t]}function q3(e,t){return _x(e.children,function(s){return Te.cloneElement(s,{onExited:t.bind(null,s),in:!0,appear:Nl(s,"appear",e),enter:Nl(s,"enter",e),exit:Nl(s,"exit",e)})})}function H3(e,t,s){var l=_x(e.children),f=G3(t,l);return Object.keys(f).forEach(function(y){var x=f[y];if(Te.isValidElement(x)){var u=y in t,P=y in l,L=t[y],U=Te.isValidElement(L)&&!L.props.in;P&&(!u||U)?f[y]=Te.cloneElement(x,{onExited:s.bind(null,x),in:!0,exit:Nl(x,"exit",e),enter:Nl(x,"enter",e)}):!P&&u&&!U?f[y]=Te.cloneElement(x,{in:!1}):P&&u&&Te.isValidElement(L)&&(f[y]=Te.cloneElement(x,{onExited:s.bind(null,x),in:L.props.in,exit:Nl(x,"exit",e),enter:Nl(x,"enter",e)}))}}),f}var Z3=Object.values||function(e){return Object.keys(e).map(function(t){return e[t]})},W3={component:"div",childFactory:function(t){return t}},vx=function(e){zk(t,e);function t(l,f){var y;y=e.call(this,l,f)||this;var x=y.handleExited.bind(V3(y));return y.state={contextValue:{isMounting:!0},handleExited:x,firstRender:!0},y}var s=t.prototype;return s.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},s.componentWillUnmount=function(){this.mounted=!1},t.getDerivedStateFromProps=function(f,y){var x=y.children,u=y.handleExited,P=y.firstRender;return{children:P?q3(f,u):H3(f,x,u),firstRender:!1}},s.handleExited=function(f,y){var x=_x(this.props.children);f.key in x||(f.props.onExited&&f.props.onExited(y),this.mounted&&this.setState(function(u){var P=Ae({},u.children);return delete P[f.key],{children:P}}))},s.render=function(){var f=this.props,y=f.component,x=f.childFactory,u=ln(f,["component","childFactory"]),P=this.state.contextValue,L=Z3(this.state.children).map(x);return delete u.appear,delete u.enter,delete u.exit,y===null?Xo.createElement(Rm.Provider,{value:P},L):Xo.createElement(Rm.Provider,{value:P},Xo.createElement(y,u,L))},t}(Xo.Component);vx.propTypes={};vx.defaultProps=W3;const Lk=e=>e.scrollTop;function Dm(e,t){var s,l;const{timeout:f,easing:y,style:x={}}=e;return{duration:(s=x.transitionDuration)!=null?s:typeof f=="number"?f:f[t.mode]||0,easing:(l=x.transitionTimingFunction)!=null?l:typeof y=="object"?y[t.mode]:y,delay:x.transitionDelay}}function K3(e){return ii("MuiPaper",e)}Mr("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const X3=["className","component","elevation","square","variant"],Y3=e=>{const{square:t,elevation:s,variant:l,classes:f}=e,y={root:["root",l,!t&&"rounded",l==="elevation"&&`elevation${s}`]};return bi(y,K3,f)},J3=In("div",{name:"MuiPaper",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.root,t[s.variant],!s.square&&t.rounded,s.variant==="elevation"&&t[`elevation${s.elevation}`]]}})(({theme:e,ownerState:t})=>{var s;return Ae({backgroundColor:(e.vars||e).palette.background.paper,color:(e.vars||e).palette.text.primary,transition:e.transitions.create("box-shadow")},!t.square&&{borderRadius:e.shape.borderRadius},t.variant==="outlined"&&{border:`1px solid ${(e.vars||e).palette.divider}`},t.variant==="elevation"&&Ae({boxShadow:(e.vars||e).shadows[t.elevation]},!e.vars&&e.palette.mode==="dark"&&{backgroundImage:`linear-gradient(${Ao("#fff",b2(t.elevation))}, ${Ao("#fff",b2(t.elevation))})`},e.vars&&{backgroundImage:(s=e.vars.overlays)==null?void 0:s[t.elevation]}))}),Rk=Te.forwardRef(function(t,s){const l=oi({props:t,name:"MuiPaper"}),{className:f,component:y="div",elevation:x=1,square:u=!1,variant:P="elevation"}=l,L=ln(l,X3),U=Ae({},l,{component:y,elevation:x,square:u,variant:P}),N=Y3(U);return Be.jsx(J3,Ae({as:y,ownerState:U,className:Xt(N.root,f),ref:s},L))});function Q3(e){const{className:t,classes:s,pulsate:l=!1,rippleX:f,rippleY:y,rippleSize:x,in:u,onExited:P,timeout:L}=e,[U,N]=Te.useState(!1),D=Xt(t,s.ripple,s.rippleVisible,l&&s.ripplePulsate),se={width:x,height:x,top:-(x/2)+y,left:-(x/2)+f},ne=Xt(s.child,U&&s.childLeaving,l&&s.childPulsate);return!u&&!U&&N(!0),Te.useEffect(()=>{if(!u&&P!=null){const ee=setTimeout(P,L);return()=>{clearTimeout(ee)}}},[P,u,L]),Be.jsx("span",{className:D,style:se,children:Be.jsx("span",{className:ne})})}const To=Mr("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),eD=["center","classes","className"];let Bg=e=>e,S2,T2,C2,k2;const W0=550,tD=80,nD=yg(S2||(S2=Bg`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),rD=yg(T2||(T2=Bg`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),iD=yg(C2||(C2=Bg`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),oD=In("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),sD=In(Q3,{name:"MuiTouchRipple",slot:"Ripple"})(k2||(k2=Bg`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),To.rippleVisible,nD,W0,({theme:e})=>e.transitions.easing.easeInOut,To.ripplePulsate,({theme:e})=>e.transitions.duration.shorter,To.child,To.childLeaving,rD,W0,({theme:e})=>e.transitions.easing.easeInOut,To.childPulsate,iD,({theme:e})=>e.transitions.easing.easeInOut),aD=Te.forwardRef(function(t,s){const l=oi({props:t,name:"MuiTouchRipple"}),{center:f=!1,classes:y={},className:x}=l,u=ln(l,eD),[P,L]=Te.useState([]),U=Te.useRef(0),N=Te.useRef(null);Te.useEffect(()=>{N.current&&(N.current(),N.current=null)},[P]);const D=Te.useRef(!1),se=hR(),ne=Te.useRef(null),ee=Te.useRef(null),ke=Te.useCallback(pe=>{const{pulsate:_e,rippleX:be,rippleY:xe,rippleSize:Re,cb:tt}=pe;L(Oe=>[...Oe,Be.jsx(sD,{classes:{ripple:Xt(y.ripple,To.ripple),rippleVisible:Xt(y.rippleVisible,To.rippleVisible),ripplePulsate:Xt(y.ripplePulsate,To.ripplePulsate),child:Xt(y.child,To.child),childLeaving:Xt(y.childLeaving,To.childLeaving),childPulsate:Xt(y.childPulsate,To.childPulsate)},timeout:W0,pulsate:_e,rippleX:be,rippleY:xe,rippleSize:Re},U.current)]),U.current+=1,N.current=tt},[y]),X=Te.useCallback((pe={},_e={},be=()=>{})=>{const{pulsate:xe=!1,center:Re=f||_e.pulsate,fakeElement:tt=!1}=_e;if((pe==null?void 0:pe.type)==="mousedown"&&D.current){D.current=!1;return}(pe==null?void 0:pe.type)==="touchstart"&&(D.current=!0);const Oe=tt?null:ee.current,He=Oe?Oe.getBoundingClientRect():{width:0,height:0,left:0,top:0};let vt,dt,ht;if(Re||pe===void 0||pe.clientX===0&&pe.clientY===0||!pe.clientX&&!pe.touches)vt=Math.round(He.width/2),dt=Math.round(He.height/2);else{const{clientX:Lt,clientY:yt}=pe.touches&&pe.touches.length>0?pe.touches[0]:pe;vt=Math.round(Lt-He.left),dt=Math.round(yt-He.top)}if(Re)ht=Math.sqrt((2*He.width**2+He.height**2)/3),ht%2===0&&(ht+=1);else{const Lt=Math.max(Math.abs((Oe?Oe.clientWidth:0)-vt),vt)*2+2,yt=Math.max(Math.abs((Oe?Oe.clientHeight:0)-dt),dt)*2+2;ht=Math.sqrt(Lt**2+yt**2)}pe!=null&&pe.touches?ne.current===null&&(ne.current=()=>{ke({pulsate:xe,rippleX:vt,rippleY:dt,rippleSize:ht,cb:be})},se.start(tD,()=>{ne.current&&(ne.current(),ne.current=null)})):ke({pulsate:xe,rippleX:vt,rippleY:dt,rippleSize:ht,cb:be})},[f,ke,se]),Z=Te.useCallback(()=>{X({},{pulsate:!0})},[X]),W=Te.useCallback((pe,_e)=>{if(se.clear(),(pe==null?void 0:pe.type)==="touchend"&&ne.current){ne.current(),ne.current=null,se.start(0,()=>{W(pe,_e)});return}ne.current=null,L(be=>be.length>0?be.slice(1):be),N.current=_e},[se]);return Te.useImperativeHandle(s,()=>({pulsate:Z,start:X,stop:W}),[Z,X,W]),Be.jsx(oD,Ae({className:Xt(To.root,y.root,x),ref:ee},u,{children:Be.jsx(vx,{component:null,exit:!0,children:P})}))});function lD(e){return ii("MuiButtonBase",e)}const cD=Mr("MuiButtonBase",["root","disabled","focusVisible"]),uD=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],hD=e=>{const{disabled:t,focusVisible:s,focusVisibleClassName:l,classes:f}=e,x=bi({root:["root",t&&"disabled",s&&"focusVisible"]},lD,f);return s&&l&&(x.root+=` ${l}`),x},dD=In("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(e,t)=>t.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${cD.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),xx=Te.forwardRef(function(t,s){const l=oi({props:t,name:"MuiButtonBase"}),{action:f,centerRipple:y=!1,children:x,className:u,component:P="button",disabled:L=!1,disableRipple:U=!1,disableTouchRipple:N=!1,focusRipple:D=!1,LinkComponent:se="a",onBlur:ne,onClick:ee,onContextMenu:ke,onDragLeave:X,onFocus:Z,onFocusVisible:W,onKeyDown:pe,onKeyUp:_e,onMouseDown:be,onMouseLeave:xe,onMouseUp:Re,onTouchEnd:tt,onTouchMove:Oe,onTouchStart:He,tabIndex:vt=0,TouchRippleProps:dt,touchRippleRef:ht,type:Lt}=l,yt=ln(l,uD),Tt=Te.useRef(null),Pe=Te.useRef(null),et=bs(Pe,ht),{isFocusVisibleRef:lt,onFocus:Ct,onBlur:Nt,ref:gr}=xk(),[Qt,_n]=Te.useState(!1);L&&Qt&&_n(!1),Te.useImperativeHandle(f,()=>({focusVisible:()=>{_n(!0),Tt.current.focus()}}),[]);const[Pn,An]=Te.useState(!1);Te.useEffect(()=>{An(!0)},[]);const yr=Pn&&!U&&!L;Te.useEffect(()=>{Qt&&D&&!U&&Pn&&Pe.current.pulsate()},[U,D,Qt,Pn]);function $n(wt,rr,wi=N){return Ol($i=>(rr&&rr($i),!wi&&Pe.current&&Pe.current[wt]($i),!0))}const si=$n("start",be),Bo=$n("stop",ke),ai=$n("stop",X),ur=$n("stop",Re),zr=$n("stop",wt=>{Qt&&wt.preventDefault(),xe&&xe(wt)}),es=$n("start",He),Se=$n("stop",tt),Oo=$n("stop",Oe),Ss=$n("stop",wt=>{Nt(wt),lt.current===!1&&_n(!1),ne&&ne(wt)},!1),$t=Ol(wt=>{Tt.current||(Tt.current=wt.currentTarget),Ct(wt),lt.current===!0&&(_n(!0),W&&W(wt)),Z&&Z(wt)}),dn=()=>{const wt=Tt.current;return P&&P!=="button"&&!(wt.tagName==="A"&&wt.href)},No=Te.useRef(!1),ho=Ol(wt=>{D&&!No.current&&Qt&&Pe.current&&wt.key===" "&&(No.current=!0,Pe.current.stop(wt,()=>{Pe.current.start(wt)})),wt.target===wt.currentTarget&&dn()&&wt.key===" "&&wt.preventDefault(),pe&&pe(wt),wt.target===wt.currentTarget&&dn()&&wt.key==="Enter"&&!L&&(wt.preventDefault(),ee&&ee(wt))}),Oi=Ol(wt=>{D&&wt.key===" "&&Pe.current&&Qt&&!wt.defaultPrevented&&(No.current=!1,Pe.current.stop(wt,()=>{Pe.current.pulsate(wt)})),_e&&_e(wt),ee&&wt.target===wt.currentTarget&&dn()&&wt.key===" "&&!wt.defaultPrevented&&ee(wt)});let Ni=P;Ni==="button"&&(yt.href||yt.to)&&(Ni=se);const nr={};Ni==="button"?(nr.type=Lt===void 0?"button":Lt,nr.disabled=L):(!yt.href&&!yt.to&&(nr.role="button"),L&&(nr["aria-disabled"]=L));const Ts=bs(s,gr,Tt),ts=Ae({},l,{centerRipple:y,component:P,disabled:L,disableRipple:U,disableTouchRipple:N,focusRipple:D,tabIndex:vt,focusVisible:Qt}),Fe=hD(ts);return Be.jsxs(dD,Ae({as:Ni,className:Xt(Fe.root,u),ownerState:ts,onBlur:Ss,onClick:ee,onContextMenu:Bo,onFocus:$t,onKeyDown:ho,onKeyUp:Oi,onMouseDown:si,onMouseLeave:zr,onMouseUp:ur,onDragLeave:ai,onTouchEnd:Se,onTouchMove:Oo,onTouchStart:es,ref:Ts,tabIndex:L?-1:vt,type:Lt},nr,yt,{children:[x,yr?Be.jsx(aD,Ae({ref:et,center:y},dt)):null]}))});function pD(e){return ii("MuiIconButton",e)}const fD=Mr("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge"]),mD=["edge","children","className","color","disabled","disableFocusRipple","size"],gD=e=>{const{classes:t,disabled:s,color:l,edge:f,size:y}=e,x={root:["root",s&&"disabled",l!=="default"&&`color${Wt(l)}`,f&&`edge${Wt(f)}`,`size${Wt(y)}`]};return bi(x,pD,t)},yD=In(xx,{name:"MuiIconButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.root,s.color!=="default"&&t[`color${Wt(s.color)}`],s.edge&&t[`edge${Wt(s.edge)}`],t[`size${Wt(s.size)}`]]}})(({theme:e,ownerState:t})=>Ae({textAlign:"center",flex:"0 0 auto",fontSize:e.typography.pxToRem(24),padding:8,borderRadius:"50%",overflow:"visible",color:(e.vars||e).palette.action.active,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest})},!t.disableRipple&&{"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:Ao(e.palette.action.active,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},t.edge==="start"&&{marginLeft:t.size==="small"?-3:-12},t.edge==="end"&&{marginRight:t.size==="small"?-3:-12}),({theme:e,ownerState:t})=>{var s;const l=(s=(e.vars||e).palette)==null?void 0:s[t.color];return Ae({},t.color==="inherit"&&{color:"inherit"},t.color!=="inherit"&&t.color!=="default"&&Ae({color:l==null?void 0:l.main},!t.disableRipple&&{"&:hover":Ae({},l&&{backgroundColor:e.vars?`rgba(${l.mainChannel} / ${e.vars.palette.action.hoverOpacity})`:Ao(l.main,e.palette.action.hoverOpacity)},{"@media (hover: none)":{backgroundColor:"transparent"}})}),t.size==="small"&&{padding:5,fontSize:e.typography.pxToRem(18)},t.size==="large"&&{padding:12,fontSize:e.typography.pxToRem(28)},{[`&.${fD.disabled}`]:{backgroundColor:"transparent",color:(e.vars||e).palette.action.disabled}})}),Dk=Te.forwardRef(function(t,s){const l=oi({props:t,name:"MuiIconButton"}),{edge:f=!1,children:y,className:x,color:u="default",disabled:P=!1,disableFocusRipple:L=!1,size:U="medium"}=l,N=ln(l,mD),D=Ae({},l,{edge:f,color:u,disabled:P,disableFocusRipple:L,size:U}),se=gD(D);return Be.jsx(yD,Ae({className:Xt(se.root,x),centerRipple:!0,focusRipple:!L,disabled:P,ref:s},N,{ownerState:D,children:y}))});function _D(e){return ii("MuiTypography",e)}Mr("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const vD=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],xD=e=>{const{align:t,gutterBottom:s,noWrap:l,paragraph:f,variant:y,classes:x}=e,u={root:["root",y,e.align!=="inherit"&&`align${Wt(t)}`,s&&"gutterBottom",l&&"noWrap",f&&"paragraph"]};return bi(u,_D,x)},bD=In("span",{name:"MuiTypography",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.root,s.variant&&t[s.variant],s.align!=="inherit"&&t[`align${Wt(s.align)}`],s.noWrap&&t.noWrap,s.gutterBottom&&t.gutterBottom,s.paragraph&&t.paragraph]}})(({theme:e,ownerState:t})=>Ae({margin:0},t.variant==="inherit"&&{font:"inherit"},t.variant!=="inherit"&&e.typography[t.variant],t.align!=="inherit"&&{textAlign:t.align},t.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},t.gutterBottom&&{marginBottom:"0.35em"},t.paragraph&&{marginBottom:16})),E2={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},wD={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},SD=e=>wD[e]||e,Co=Te.forwardRef(function(t,s){const l=oi({props:t,name:"MuiTypography"}),f=SD(l.color),y=ux(Ae({},l,{color:f})),{align:x="inherit",className:u,component:P,gutterBottom:L=!1,noWrap:U=!1,paragraph:N=!1,variant:D="body1",variantMapping:se=E2}=y,ne=ln(y,vD),ee=Ae({},y,{align:x,color:f,className:u,component:P,gutterBottom:L,noWrap:U,paragraph:N,variant:D,variantMapping:se}),ke=P||(N?"p":se[D]||E2[D])||"span",X=xD(ee);return Be.jsx(bD,Ae({as:ke,ref:s,ownerState:ee,className:Xt(X.root,u)},ne))});function TD(e){return ii("MuiAppBar",e)}Mr("MuiAppBar",["root","positionFixed","positionAbsolute","positionSticky","positionStatic","positionRelative","colorDefault","colorPrimary","colorSecondary","colorInherit","colorTransparent","colorError","colorInfo","colorSuccess","colorWarning"]);const CD=["className","color","enableColorOnDark","position"],kD=e=>{const{color:t,position:s,classes:l}=e,f={root:["root",`color${Wt(t)}`,`position${Wt(s)}`]};return bi(f,TD,l)},Rf=(e,t)=>e?`${e==null?void 0:e.replace(")","")}, ${t})`:t,ED=In(Rk,{name:"MuiAppBar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.root,t[`position${Wt(s.position)}`],t[`color${Wt(s.color)}`]]}})(({theme:e,ownerState:t})=>{const s=e.palette.mode==="light"?e.palette.grey[100]:e.palette.grey[900];return Ae({display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",flexShrink:0},t.position==="fixed"&&{position:"fixed",zIndex:(e.vars||e).zIndex.appBar,top:0,left:"auto",right:0,"@media print":{position:"absolute"}},t.position==="absolute"&&{position:"absolute",zIndex:(e.vars||e).zIndex.appBar,top:0,left:"auto",right:0},t.position==="sticky"&&{position:"sticky",zIndex:(e.vars||e).zIndex.appBar,top:0,left:"auto",right:0},t.position==="static"&&{position:"static"},t.position==="relative"&&{position:"relative"},!e.vars&&Ae({},t.color==="default"&&{backgroundColor:s,color:e.palette.getContrastText(s)},t.color&&t.color!=="default"&&t.color!=="inherit"&&t.color!=="transparent"&&{backgroundColor:e.palette[t.color].main,color:e.palette[t.color].contrastText},t.color==="inherit"&&{color:"inherit"},e.palette.mode==="dark"&&!t.enableColorOnDark&&{backgroundColor:null,color:null},t.color==="transparent"&&Ae({backgroundColor:"transparent",color:"inherit"},e.palette.mode==="dark"&&{backgroundImage:"none"})),e.vars&&Ae({},t.color==="default"&&{"--AppBar-background":t.enableColorOnDark?e.vars.palette.AppBar.defaultBg:Rf(e.vars.palette.AppBar.darkBg,e.vars.palette.AppBar.defaultBg),"--AppBar-color":t.enableColorOnDark?e.vars.palette.text.primary:Rf(e.vars.palette.AppBar.darkColor,e.vars.palette.text.primary)},t.color&&!t.color.match(/^(default|inherit|transparent)$/)&&{"--AppBar-background":t.enableColorOnDark?e.vars.palette[t.color].main:Rf(e.vars.palette.AppBar.darkBg,e.vars.palette[t.color].main),"--AppBar-color":t.enableColorOnDark?e.vars.palette[t.color].contrastText:Rf(e.vars.palette.AppBar.darkColor,e.vars.palette[t.color].contrastText)},!["inherit","transparent"].includes(t.color)&&{backgroundColor:"var(--AppBar-background)"},{color:t.color==="inherit"?"inherit":"var(--AppBar-color)"},t.color==="transparent"&&{backgroundImage:"none",backgroundColor:"transparent",color:"inherit"}))}),ID=Te.forwardRef(function(t,s){const l=oi({props:t,name:"MuiAppBar"}),{className:f,color:y="primary",enableColorOnDark:x=!1,position:u="fixed"}=l,P=ln(l,CD),L=Ae({},l,{color:y,position:u,enableColorOnDark:x}),U=kD(L);return Be.jsx(ED,Ae({square:!0,component:"header",ownerState:L,elevation:4,className:Xt(U.root,f,u==="fixed"&&"mui-fixed"),ref:s},P))});function PD(e){return typeof e=="function"?e():e}const AD=Te.forwardRef(function(t,s){const{children:l,container:f,disablePortal:y=!1}=t,[x,u]=Te.useState(null),P=bs(Te.isValidElement(l)?l.ref:null,s);if(Wd(()=>{y||u(PD(f)||document.body)},[f,y]),Wd(()=>{if(x&&!y)return zm(s,x),()=>{zm(s,null)}},[s,x,y]),y){if(Te.isValidElement(l)){const L={ref:P};return Te.cloneElement(l,L)}return Be.jsx(Te.Fragment,{children:l})}return Be.jsx(Te.Fragment,{children:x&&Vv.createPortal(l,x)})}),MD=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],zD={entering:{opacity:1},entered:{opacity:1}},LD=Te.forwardRef(function(t,s){const l=Fg(),f={enter:l.transitions.duration.enteringScreen,exit:l.transitions.duration.leavingScreen},{addEndListener:y,appear:x=!0,children:u,easing:P,in:L,onEnter:U,onEntered:N,onEntering:D,onExit:se,onExited:ne,onExiting:ee,style:ke,timeout:X=f,TransitionComponent:Z=ws}=t,W=ln(t,MD),pe=Te.useRef(null),_e=bs(pe,u.ref,s),be=ht=>Lt=>{if(ht){const yt=pe.current;Lt===void 0?ht(yt):ht(yt,Lt)}},xe=be(D),Re=be((ht,Lt)=>{Lk(ht);const yt=Dm({style:ke,timeout:X,easing:P},{mode:"enter"});ht.style.webkitTransition=l.transitions.create("opacity",yt),ht.style.transition=l.transitions.create("opacity",yt),U&&U(ht,Lt)}),tt=be(N),Oe=be(ee),He=be(ht=>{const Lt=Dm({style:ke,timeout:X,easing:P},{mode:"exit"});ht.style.webkitTransition=l.transitions.create("opacity",Lt),ht.style.transition=l.transitions.create("opacity",Lt),se&&se(ht)}),vt=be(ne),dt=ht=>{y&&y(pe.current,ht)};return Be.jsx(Z,Ae({appear:x,in:L,nodeRef:pe,onEnter:Re,onEntered:tt,onEntering:xe,onExit:He,onExited:vt,onExiting:Oe,addEndListener:dt,timeout:X},W,{children:(ht,Lt)=>Te.cloneElement(u,Ae({style:Ae({opacity:0,visibility:ht==="exited"&&!L?"hidden":void 0},zD[ht],ke,u.props.style),ref:_e},Lt))}))});function RD(e){return ii("MuiBackdrop",e)}Mr("MuiBackdrop",["root","invisible"]);const DD=["children","className","component","components","componentsProps","invisible","open","slotProps","slots","TransitionComponent","transitionDuration"],FD=e=>{const{classes:t,invisible:s}=e;return bi({root:["root",s&&"invisible"]},RD,t)},BD=In("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.root,s.invisible&&t.invisible]}})(({ownerState:e})=>Ae({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},e.invisible&&{backgroundColor:"transparent"})),OD=Te.forwardRef(function(t,s){var l,f,y;const x=oi({props:t,name:"MuiBackdrop"}),{children:u,className:P,component:L="div",components:U={},componentsProps:N={},invisible:D=!1,open:se,slotProps:ne={},slots:ee={},TransitionComponent:ke=LD,transitionDuration:X}=x,Z=ln(x,DD),W=Ae({},x,{component:L,invisible:D}),pe=FD(W),_e=(l=ne.root)!=null?l:N.root;return Be.jsx(ke,Ae({in:se,timeout:X},Z,{children:Be.jsx(BD,Ae({"aria-hidden":!0},_e,{as:(f=(y=ee.root)!=null?y:U.Root)!=null?f:L,className:Xt(pe.root,P,_e==null?void 0:_e.className),ownerState:Ae({},W,_e==null?void 0:_e.ownerState),classes:pe,ref:s,children:u}))}))}),ND=Mr("MuiBox",["root"]),$D=Pk(),jD=ZL({themeId:Yv,defaultTheme:$D,defaultClassName:ND.root,generateClassName:hx.generate});function UD(e){return ii("MuiButton",e)}const Df=Mr("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]),VD=Te.createContext({}),GD=Te.createContext(void 0),qD=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],HD=e=>{const{color:t,disableElevation:s,fullWidth:l,size:f,variant:y,classes:x}=e,u={root:["root",y,`${y}${Wt(t)}`,`size${Wt(f)}`,`${y}Size${Wt(f)}`,`color${Wt(t)}`,s&&"disableElevation",l&&"fullWidth"],label:["label"],startIcon:["icon","startIcon",`iconSize${Wt(f)}`],endIcon:["icon","endIcon",`iconSize${Wt(f)}`]},P=bi(u,UD,x);return Ae({},x,P)},Fk=e=>Ae({},e.size==="small"&&{"& > *:nth-of-type(1)":{fontSize:18}},e.size==="medium"&&{"& > *:nth-of-type(1)":{fontSize:20}},e.size==="large"&&{"& > *:nth-of-type(1)":{fontSize:22}}),ZD=In(xx,{shouldForwardProp:e=>yx(e)||e==="classes",name:"MuiButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.root,t[s.variant],t[`${s.variant}${Wt(s.color)}`],t[`size${Wt(s.size)}`],t[`${s.variant}Size${Wt(s.size)}`],s.color==="inherit"&&t.colorInherit,s.disableElevation&&t.disableElevation,s.fullWidth&&t.fullWidth]}})(({theme:e,ownerState:t})=>{var s,l;const f=e.palette.mode==="light"?e.palette.grey[300]:e.palette.grey[800],y=e.palette.mode==="light"?e.palette.grey.A100:e.palette.grey[700];return Ae({},e.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(e.vars||e).shape.borderRadius,transition:e.transitions.create(["background-color","box-shadow","border-color","color"],{duration:e.transitions.duration.short}),"&:hover":Ae({textDecoration:"none",backgroundColor:e.vars?`rgba(${e.vars.palette.text.primaryChannel} / ${e.vars.palette.action.hoverOpacity})`:Ao(e.palette.text.primary,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},t.variant==="text"&&t.color!=="inherit"&&{backgroundColor:e.vars?`rgba(${e.vars.palette[t.color].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:Ao(e.palette[t.color].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},t.variant==="outlined"&&t.color!=="inherit"&&{border:`1px solid ${(e.vars||e).palette[t.color].main}`,backgroundColor:e.vars?`rgba(${e.vars.palette[t.color].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:Ao(e.palette[t.color].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},t.variant==="contained"&&{backgroundColor:e.vars?e.vars.palette.Button.inheritContainedHoverBg:y,boxShadow:(e.vars||e).shadows[4],"@media (hover: none)":{boxShadow:(e.vars||e).shadows[2],backgroundColor:(e.vars||e).palette.grey[300]}},t.variant==="contained"&&t.color!=="inherit"&&{backgroundColor:(e.vars||e).palette[t.color].dark,"@media (hover: none)":{backgroundColor:(e.vars||e).palette[t.color].main}}),"&:active":Ae({},t.variant==="contained"&&{boxShadow:(e.vars||e).shadows[8]}),[`&.${Df.focusVisible}`]:Ae({},t.variant==="contained"&&{boxShadow:(e.vars||e).shadows[6]}),[`&.${Df.disabled}`]:Ae({color:(e.vars||e).palette.action.disabled},t.variant==="outlined"&&{border:`1px solid ${(e.vars||e).palette.action.disabledBackground}`},t.variant==="contained"&&{color:(e.vars||e).palette.action.disabled,boxShadow:(e.vars||e).shadows[0],backgroundColor:(e.vars||e).palette.action.disabledBackground})},t.variant==="text"&&{padding:"6px 8px"},t.variant==="text"&&t.color!=="inherit"&&{color:(e.vars||e).palette[t.color].main},t.variant==="outlined"&&{padding:"5px 15px",border:"1px solid currentColor"},t.variant==="outlined"&&t.color!=="inherit"&&{color:(e.vars||e).palette[t.color].main,border:e.vars?`1px solid rgba(${e.vars.palette[t.color].mainChannel} / 0.5)`:`1px solid ${Ao(e.palette[t.color].main,.5)}`},t.variant==="contained"&&{color:e.vars?e.vars.palette.text.primary:(s=(l=e.palette).getContrastText)==null?void 0:s.call(l,e.palette.grey[300]),backgroundColor:e.vars?e.vars.palette.Button.inheritContainedBg:f,boxShadow:(e.vars||e).shadows[2]},t.variant==="contained"&&t.color!=="inherit"&&{color:(e.vars||e).palette[t.color].contrastText,backgroundColor:(e.vars||e).palette[t.color].main},t.color==="inherit"&&{color:"inherit",borderColor:"currentColor"},t.size==="small"&&t.variant==="text"&&{padding:"4px 5px",fontSize:e.typography.pxToRem(13)},t.size==="large"&&t.variant==="text"&&{padding:"8px 11px",fontSize:e.typography.pxToRem(15)},t.size==="small"&&t.variant==="outlined"&&{padding:"3px 9px",fontSize:e.typography.pxToRem(13)},t.size==="large"&&t.variant==="outlined"&&{padding:"7px 21px",fontSize:e.typography.pxToRem(15)},t.size==="small"&&t.variant==="contained"&&{padding:"4px 10px",fontSize:e.typography.pxToRem(13)},t.size==="large"&&t.variant==="contained"&&{padding:"8px 22px",fontSize:e.typography.pxToRem(15)},t.fullWidth&&{width:"100%"})},({ownerState:e})=>e.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${Df.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${Df.disabled}`]:{boxShadow:"none"}}),WD=In("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.startIcon,t[`iconSize${Wt(s.size)}`]]}})(({ownerState:e})=>Ae({display:"inherit",marginRight:8,marginLeft:-4},e.size==="small"&&{marginLeft:-2},Fk(e))),KD=In("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.endIcon,t[`iconSize${Wt(s.size)}`]]}})(({ownerState:e})=>Ae({display:"inherit",marginRight:-4,marginLeft:8},e.size==="small"&&{marginRight:-2},Fk(e))),XD=Te.forwardRef(function(t,s){const l=Te.useContext(VD),f=Te.useContext(GD),y=Mm(l,t),x=oi({props:y,name:"MuiButton"}),{children:u,color:P="primary",component:L="button",className:U,disabled:N=!1,disableElevation:D=!1,disableFocusRipple:se=!1,endIcon:ne,focusVisibleClassName:ee,fullWidth:ke=!1,size:X="medium",startIcon:Z,type:W,variant:pe="text"}=x,_e=ln(x,qD),be=Ae({},x,{color:P,component:L,disabled:N,disableElevation:D,disableFocusRipple:se,fullWidth:ke,size:X,type:W,variant:pe}),xe=HD(be),Re=Z&&Be.jsx(WD,{className:xe.startIcon,ownerState:be,children:Z}),tt=ne&&Be.jsx(KD,{className:xe.endIcon,ownerState:be,children:ne}),Oe=f||"";return Be.jsxs(ZD,Ae({ownerState:be,className:Xt(l.className,xe.root,U,Oe),component:L,disabled:N,focusRipple:!se,focusVisibleClassName:Xt(xe.focusVisible,ee),ref:s,type:W},_e,{classes:xe,children:[Re,u,tt]}))});function YD(e){const t=Zs(e);return t.body===e?$u(e).innerWidth>t.documentElement.clientWidth:e.scrollHeight>e.clientHeight}function Cd(e,t){t?e.setAttribute("aria-hidden","true"):e.removeAttribute("aria-hidden")}function I2(e){return parseInt($u(e).getComputedStyle(e).paddingRight,10)||0}function JD(e){const s=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(e.tagName)!==-1,l=e.tagName==="INPUT"&&e.getAttribute("type")==="hidden";return s||l}function P2(e,t,s,l,f){const y=[t,s,...l];[].forEach.call(e.children,x=>{const u=y.indexOf(x)===-1,P=!JD(x);u&&P&&Cd(x,f)})}function z_(e,t){let s=-1;return e.some((l,f)=>t(l)?(s=f,!0):!1),s}function QD(e,t){const s=[],l=e.container;if(!t.disableScrollLock){if(YD(l)){const x=vR(Zs(l));s.push({value:l.style.paddingRight,property:"padding-right",el:l}),l.style.paddingRight=`${I2(l)+x}px`;const u=Zs(l).querySelectorAll(".mui-fixed");[].forEach.call(u,P=>{s.push({value:P.style.paddingRight,property:"padding-right",el:P}),P.style.paddingRight=`${I2(P)+x}px`})}let y;if(l.parentNode instanceof DocumentFragment)y=Zs(l).body;else{const x=l.parentElement,u=$u(l);y=(x==null?void 0:x.nodeName)==="HTML"&&u.getComputedStyle(x).overflowY==="scroll"?x:l}s.push({value:y.style.overflow,property:"overflow",el:y},{value:y.style.overflowX,property:"overflow-x",el:y},{value:y.style.overflowY,property:"overflow-y",el:y}),y.style.overflow="hidden"}return()=>{s.forEach(({value:y,el:x,property:u})=>{y?x.style.setProperty(u,y):x.style.removeProperty(u)})}}function e4(e){const t=[];return[].forEach.call(e.children,s=>{s.getAttribute("aria-hidden")==="true"&&t.push(s)}),t}class t4{constructor(){this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}add(t,s){let l=this.modals.indexOf(t);if(l!==-1)return l;l=this.modals.length,this.modals.push(t),t.modalRef&&Cd(t.modalRef,!1);const f=e4(s);P2(s,t.mount,t.modalRef,f,!0);const y=z_(this.containers,x=>x.container===s);return y!==-1?(this.containers[y].modals.push(t),l):(this.containers.push({modals:[t],container:s,restore:null,hiddenSiblings:f}),l)}mount(t,s){const l=z_(this.containers,y=>y.modals.indexOf(t)!==-1),f=this.containers[l];f.restore||(f.restore=QD(f,s))}remove(t,s=!0){const l=this.modals.indexOf(t);if(l===-1)return l;const f=z_(this.containers,x=>x.modals.indexOf(t)!==-1),y=this.containers[f];if(y.modals.splice(y.modals.indexOf(t),1),this.modals.splice(l,1),y.modals.length===0)y.restore&&y.restore(),t.modalRef&&Cd(t.modalRef,s),P2(y.container,t.mount,t.modalRef,y.hiddenSiblings,!1),this.containers.splice(f,1);else{const x=y.modals[y.modals.length-1];x.modalRef&&Cd(x.modalRef,!1)}return l}isTopModal(t){return this.modals.length>0&&this.modals[this.modals.length-1]===t}}const n4=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function r4(e){const t=parseInt(e.getAttribute("tabindex")||"",10);return Number.isNaN(t)?e.contentEditable==="true"||(e.nodeName==="AUDIO"||e.nodeName==="VIDEO"||e.nodeName==="DETAILS")&&e.getAttribute("tabindex")===null?0:e.tabIndex:t}function i4(e){if(e.tagName!=="INPUT"||e.type!=="radio"||!e.name)return!1;const t=l=>e.ownerDocument.querySelector(`input[type="radio"]${l}`);let s=t(`[name="${e.name}"]:checked`);return s||(s=t(`[name="${e.name}"]`)),s!==e}function o4(e){return!(e.disabled||e.tagName==="INPUT"&&e.type==="hidden"||i4(e))}function s4(e){const t=[],s=[];return Array.from(e.querySelectorAll(n4)).forEach((l,f)=>{const y=r4(l);y===-1||!o4(l)||(y===0?t.push(l):s.push({documentOrder:f,tabIndex:y,node:l}))}),s.sort((l,f)=>l.tabIndex===f.tabIndex?l.documentOrder-f.documentOrder:l.tabIndex-f.tabIndex).map(l=>l.node).concat(t)}function a4(){return!0}function l4(e){const{children:t,disableAutoFocus:s=!1,disableEnforceFocus:l=!1,disableRestoreFocus:f=!1,getTabbable:y=s4,isEnabled:x=a4,open:u}=e,P=Te.useRef(!1),L=Te.useRef(null),U=Te.useRef(null),N=Te.useRef(null),D=Te.useRef(null),se=Te.useRef(!1),ne=Te.useRef(null),ee=bs(t.ref,ne),ke=Te.useRef(null);Te.useEffect(()=>{!u||!ne.current||(se.current=!s)},[s,u]),Te.useEffect(()=>{if(!u||!ne.current)return;const W=Zs(ne.current);return ne.current.contains(W.activeElement)||(ne.current.hasAttribute("tabIndex")||ne.current.setAttribute("tabIndex","-1"),se.current&&ne.current.focus()),()=>{f||(N.current&&N.current.focus&&(P.current=!0,N.current.focus()),N.current=null)}},[u]),Te.useEffect(()=>{if(!u||!ne.current)return;const W=Zs(ne.current),pe=xe=>{ke.current=xe,!(l||!x()||xe.key!=="Tab")&&W.activeElement===ne.current&&xe.shiftKey&&(P.current=!0,U.current&&U.current.focus())},_e=()=>{const xe=ne.current;if(xe===null)return;if(!W.hasFocus()||!x()||P.current){P.current=!1;return}if(xe.contains(W.activeElement)||l&&W.activeElement!==L.current&&W.activeElement!==U.current)return;if(W.activeElement!==D.current)D.current=null;else if(D.current!==null)return;if(!se.current)return;let Re=[];if((W.activeElement===L.current||W.activeElement===U.current)&&(Re=y(ne.current)),Re.length>0){var tt,Oe;const He=!!((tt=ke.current)!=null&&tt.shiftKey&&((Oe=ke.current)==null?void 0:Oe.key)==="Tab"),vt=Re[0],dt=Re[Re.length-1];typeof vt!="string"&&typeof dt!="string"&&(He?dt.focus():vt.focus())}else xe.focus()};W.addEventListener("focusin",_e),W.addEventListener("keydown",pe,!0);const be=setInterval(()=>{W.activeElement&&W.activeElement.tagName==="BODY"&&_e()},50);return()=>{clearInterval(be),W.removeEventListener("focusin",_e),W.removeEventListener("keydown",pe,!0)}},[s,l,f,x,u,y]);const X=W=>{N.current===null&&(N.current=W.relatedTarget),se.current=!0,D.current=W.target;const pe=t.props.onFocus;pe&&pe(W)},Z=W=>{N.current===null&&(N.current=W.relatedTarget),se.current=!0};return Be.jsxs(Te.Fragment,{children:[Be.jsx("div",{tabIndex:u?0:-1,onFocus:Z,ref:L,"data-testid":"sentinelStart"}),Te.cloneElement(t,{ref:ee,onFocus:X}),Be.jsx("div",{tabIndex:u?0:-1,onFocus:Z,ref:U,"data-testid":"sentinelEnd"})]})}function c4(e){return typeof e=="function"?e():e}function u4(e){return e?e.props.hasOwnProperty("in"):!1}const h4=new t4;function d4(e){const{container:t,disableEscapeKeyDown:s=!1,disableScrollLock:l=!1,manager:f=h4,closeAfterTransition:y=!1,onTransitionEnter:x,onTransitionExited:u,children:P,onClose:L,open:U,rootRef:N}=e,D=Te.useRef({}),se=Te.useRef(null),ne=Te.useRef(null),ee=bs(ne,N),[ke,X]=Te.useState(!U),Z=u4(P);let W=!0;(e["aria-hidden"]==="false"||e["aria-hidden"]===!1)&&(W=!1);const pe=()=>Zs(se.current),_e=()=>(D.current.modalRef=ne.current,D.current.mount=se.current,D.current),be=()=>{f.mount(_e(),{disableScrollLock:l}),ne.current&&(ne.current.scrollTop=0)},xe=Ol(()=>{const yt=c4(t)||pe().body;f.add(_e(),yt),ne.current&&be()}),Re=Te.useCallback(()=>f.isTopModal(_e()),[f]),tt=Ol(yt=>{se.current=yt,yt&&(U&&Re()?be():ne.current&&Cd(ne.current,W))}),Oe=Te.useCallback(()=>{f.remove(_e(),W)},[W,f]);Te.useEffect(()=>()=>{Oe()},[Oe]),Te.useEffect(()=>{U?xe():(!Z||!y)&&Oe()},[U,Oe,Z,y,xe]);const He=yt=>Tt=>{var Pe;(Pe=yt.onKeyDown)==null||Pe.call(yt,Tt),!(Tt.key!=="Escape"||Tt.which===229||!Re())&&(s||(Tt.stopPropagation(),L&&L(Tt,"escapeKeyDown")))},vt=yt=>Tt=>{var Pe;(Pe=yt.onClick)==null||Pe.call(yt,Tt),Tt.target===Tt.currentTarget&&L&&L(Tt,"backdropClick")};return{getRootProps:(yt={})=>{const Tt=bk(e);delete Tt.onTransitionEnter,delete Tt.onTransitionExited;const Pe=Ae({},Tt,yt);return Ae({role:"presentation"},Pe,{onKeyDown:He(Pe),ref:ee})},getBackdropProps:(yt={})=>{const Tt=yt;return Ae({"aria-hidden":!0},Tt,{onClick:vt(Tt),open:U})},getTransitionProps:()=>{const yt=()=>{X(!1),x&&x()},Tt=()=>{X(!0),u&&u(),y&&Oe()};return{onEnter:j0(yt,P==null?void 0:P.props.onEnter),onExited:j0(Tt,P==null?void 0:P.props.onExited)}},rootRef:ee,portalRef:tt,isTopModal:Re,exited:ke,hasTransition:Z}}function p4(e){return ii("MuiModal",e)}Mr("MuiModal",["root","hidden","backdrop"]);const f4=["BackdropComponent","BackdropProps","classes","className","closeAfterTransition","children","container","component","components","componentsProps","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","onBackdropClick","onClose","onTransitionEnter","onTransitionExited","open","slotProps","slots","theme"],m4=e=>{const{open:t,exited:s,classes:l}=e;return bi({root:["root",!t&&s&&"hidden"],backdrop:["backdrop"]},p4,l)},g4=In("div",{name:"MuiModal",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.root,!s.open&&s.exited&&t.hidden]}})(({theme:e,ownerState:t})=>Ae({position:"fixed",zIndex:(e.vars||e).zIndex.modal,right:0,bottom:0,top:0,left:0},!t.open&&t.exited&&{visibility:"hidden"})),y4=In(OD,{name:"MuiModal",slot:"Backdrop",overridesResolver:(e,t)=>t.backdrop})({zIndex:-1}),_4=Te.forwardRef(function(t,s){var l,f,y,x,u,P;const L=oi({name:"MuiModal",props:t}),{BackdropComponent:U=y4,BackdropProps:N,className:D,closeAfterTransition:se=!1,children:ne,container:ee,component:ke,components:X={},componentsProps:Z={},disableAutoFocus:W=!1,disableEnforceFocus:pe=!1,disableEscapeKeyDown:_e=!1,disablePortal:be=!1,disableRestoreFocus:xe=!1,disableScrollLock:Re=!1,hideBackdrop:tt=!1,keepMounted:Oe=!1,onBackdropClick:He,open:vt,slotProps:dt,slots:ht}=L,Lt=ln(L,f4),yt=Ae({},L,{closeAfterTransition:se,disableAutoFocus:W,disableEnforceFocus:pe,disableEscapeKeyDown:_e,disablePortal:be,disableRestoreFocus:xe,disableScrollLock:Re,hideBackdrop:tt,keepMounted:Oe}),{getRootProps:Tt,getBackdropProps:Pe,getTransitionProps:et,portalRef:lt,isTopModal:Ct,exited:Nt,hasTransition:gr}=d4(Ae({},yt,{rootRef:s})),Qt=Ae({},yt,{exited:Nt}),_n=m4(Qt),Pn={};if(ne.props.tabIndex===void 0&&(Pn.tabIndex="-1"),gr){const{onEnter:ur,onExited:zr}=et();Pn.onEnter=ur,Pn.onExited=zr}const An=(l=(f=ht==null?void 0:ht.root)!=null?f:X.Root)!=null?l:g4,yr=(y=(x=ht==null?void 0:ht.backdrop)!=null?x:X.Backdrop)!=null?y:U,$n=(u=dt==null?void 0:dt.root)!=null?u:Z.root,si=(P=dt==null?void 0:dt.backdrop)!=null?P:Z.backdrop,Bo=d2({elementType:An,externalSlotProps:$n,externalForwardedProps:Lt,getSlotProps:Tt,additionalProps:{ref:s,as:ke},ownerState:Qt,className:Xt(D,$n==null?void 0:$n.className,_n==null?void 0:_n.root,!Qt.open&&Qt.exited&&(_n==null?void 0:_n.hidden))}),ai=d2({elementType:yr,externalSlotProps:si,additionalProps:N,getSlotProps:ur=>Pe(Ae({},ur,{onClick:zr=>{He&&He(zr),ur!=null&&ur.onClick&&ur.onClick(zr)}})),className:Xt(si==null?void 0:si.className,N==null?void 0:N.className,_n==null?void 0:_n.backdrop),ownerState:Qt});return!Oe&&!vt&&(!gr||Nt)?null:Be.jsx(AD,{ref:lt,container:ee,disablePortal:be,children:Be.jsxs(An,Ae({},Bo,{children:[!tt&&U?Be.jsx(yr,Ae({},ai)):null,Be.jsx(l4,{disableEnforceFocus:pe,disableAutoFocus:W,disableRestoreFocus:xe,isEnabled:Ct,open:vt,children:Te.cloneElement(ne,Pn)})]}))})}),v4=["addEndListener","appear","children","container","direction","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function x4(e,t,s){const l=t.getBoundingClientRect(),f=s&&s.getBoundingClientRect(),y=$u(t);let x;if(t.fakeTransform)x=t.fakeTransform;else{const L=y.getComputedStyle(t);x=L.getPropertyValue("-webkit-transform")||L.getPropertyValue("transform")}let u=0,P=0;if(x&&x!=="none"&&typeof x=="string"){const L=x.split("(")[1].split(")")[0].split(",");u=parseInt(L[4],10),P=parseInt(L[5],10)}return e==="left"?f?`translateX(${f.right+u-l.left}px)`:`translateX(${y.innerWidth+u-l.left}px)`:e==="right"?f?`translateX(-${l.right-f.left-u}px)`:`translateX(-${l.left+l.width-u}px)`:e==="up"?f?`translateY(${f.bottom+P-l.top}px)`:`translateY(${y.innerHeight+P-l.top}px)`:f?`translateY(-${l.top-f.top+l.height-P}px)`:`translateY(-${l.top+l.height-P}px)`}function b4(e){return typeof e=="function"?e():e}function Ff(e,t,s){const l=b4(s),f=x4(e,t,l);f&&(t.style.webkitTransform=f,t.style.transform=f)}const w4=Te.forwardRef(function(t,s){const l=Fg(),f={enter:l.transitions.easing.easeOut,exit:l.transitions.easing.sharp},y={enter:l.transitions.duration.enteringScreen,exit:l.transitions.duration.leavingScreen},{addEndListener:x,appear:u=!0,children:P,container:L,direction:U="down",easing:N=f,in:D,onEnter:se,onEntered:ne,onEntering:ee,onExit:ke,onExited:X,onExiting:Z,style:W,timeout:pe=y,TransitionComponent:_e=ws}=t,be=ln(t,v4),xe=Te.useRef(null),Re=bs(P.ref,xe,s),tt=Pe=>et=>{Pe&&(et===void 0?Pe(xe.current):Pe(xe.current,et))},Oe=tt((Pe,et)=>{Ff(U,Pe,L),Lk(Pe),se&&se(Pe,et)}),He=tt((Pe,et)=>{const lt=Dm({timeout:pe,style:W,easing:N},{mode:"enter"});Pe.style.webkitTransition=l.transitions.create("-webkit-transform",Ae({},lt)),Pe.style.transition=l.transitions.create("transform",Ae({},lt)),Pe.style.webkitTransform="none",Pe.style.transform="none",ee&&ee(Pe,et)}),vt=tt(ne),dt=tt(Z),ht=tt(Pe=>{const et=Dm({timeout:pe,style:W,easing:N},{mode:"exit"});Pe.style.webkitTransition=l.transitions.create("-webkit-transform",et),Pe.style.transition=l.transitions.create("transform",et),Ff(U,Pe,L),ke&&ke(Pe)}),Lt=tt(Pe=>{Pe.style.webkitTransition="",Pe.style.transition="",X&&X(Pe)}),yt=Pe=>{x&&x(xe.current,Pe)},Tt=Te.useCallback(()=>{xe.current&&Ff(U,xe.current,L)},[U,L]);return Te.useEffect(()=>{if(D||U==="down"||U==="right")return;const Pe=_k(()=>{xe.current&&Ff(U,xe.current,L)}),et=$u(xe.current);return et.addEventListener("resize",Pe),()=>{Pe.clear(),et.removeEventListener("resize",Pe)}},[U,D,L]),Te.useEffect(()=>{D||Tt()},[D,Tt]),Be.jsx(_e,Ae({nodeRef:xe,onEnter:Oe,onEntered:vt,onEntering:He,onExit:ht,onExited:Lt,onExiting:dt,addEndListener:yt,appear:u,in:D,timeout:pe},be,{children:(Pe,et)=>Te.cloneElement(P,Ae({ref:Re,style:Ae({visibility:Pe==="exited"&&!D?"hidden":void 0},W,P.props.style)},et))}))});function S4(e){return ii("MuiDrawer",e)}Mr("MuiDrawer",["root","docked","paper","paperAnchorLeft","paperAnchorRight","paperAnchorTop","paperAnchorBottom","paperAnchorDockedLeft","paperAnchorDockedRight","paperAnchorDockedTop","paperAnchorDockedBottom","modal"]);const T4=["BackdropProps"],C4=["anchor","BackdropProps","children","className","elevation","hideBackdrop","ModalProps","onClose","open","PaperProps","SlideProps","TransitionComponent","transitionDuration","variant"],Bk=(e,t)=>{const{ownerState:s}=e;return[t.root,(s.variant==="permanent"||s.variant==="persistent")&&t.docked,t.modal]},k4=e=>{const{classes:t,anchor:s,variant:l}=e,f={root:["root"],docked:[(l==="permanent"||l==="persistent")&&"docked"],modal:["modal"],paper:["paper",`paperAnchor${Wt(s)}`,l!=="temporary"&&`paperAnchorDocked${Wt(s)}`]};return bi(f,S4,t)},E4=In(_4,{name:"MuiDrawer",slot:"Root",overridesResolver:Bk})(({theme:e})=>({zIndex:(e.vars||e).zIndex.drawer})),A2=In("div",{shouldForwardProp:yx,name:"MuiDrawer",slot:"Docked",skipVariantsResolver:!1,overridesResolver:Bk})({flex:"0 0 auto"}),I4=In(Rk,{name:"MuiDrawer",slot:"Paper",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.paper,t[`paperAnchor${Wt(s.anchor)}`],s.variant!=="temporary"&&t[`paperAnchorDocked${Wt(s.anchor)}`]]}})(({theme:e,ownerState:t})=>Ae({overflowY:"auto",display:"flex",flexDirection:"column",height:"100%",flex:"1 0 auto",zIndex:(e.vars||e).zIndex.drawer,WebkitOverflowScrolling:"touch",position:"fixed",top:0,outline:0},t.anchor==="left"&&{left:0},t.anchor==="top"&&{top:0,left:0,right:0,height:"auto",maxHeight:"100%"},t.anchor==="right"&&{right:0},t.anchor==="bottom"&&{top:"auto",left:0,bottom:0,right:0,height:"auto",maxHeight:"100%"},t.anchor==="left"&&t.variant!=="temporary"&&{borderRight:`1px solid ${(e.vars||e).palette.divider}`},t.anchor==="top"&&t.variant!=="temporary"&&{borderBottom:`1px solid ${(e.vars||e).palette.divider}`},t.anchor==="right"&&t.variant!=="temporary"&&{borderLeft:`1px solid ${(e.vars||e).palette.divider}`},t.anchor==="bottom"&&t.variant!=="temporary"&&{borderTop:`1px solid ${(e.vars||e).palette.divider}`})),Ok={left:"right",right:"left",top:"down",bottom:"up"};function P4(e){return["left","right"].indexOf(e)!==-1}function A4({direction:e},t){return e==="rtl"&&P4(t)?Ok[t]:t}const M4=Te.forwardRef(function(t,s){const l=oi({props:t,name:"MuiDrawer"}),f=Fg(),y=CR(),x={enter:f.transitions.duration.enteringScreen,exit:f.transitions.duration.leavingScreen},{anchor:u="left",BackdropProps:P,children:L,className:U,elevation:N=16,hideBackdrop:D=!1,ModalProps:{BackdropProps:se}={},onClose:ne,open:ee=!1,PaperProps:ke={},SlideProps:X,TransitionComponent:Z=w4,transitionDuration:W=x,variant:pe="temporary"}=l,_e=ln(l.ModalProps,T4),be=ln(l,C4),xe=Te.useRef(!1);Te.useEffect(()=>{xe.current=!0},[]);const Re=A4({direction:y?"rtl":"ltr"},u),Oe=Ae({},l,{anchor:u,elevation:N,open:ee,variant:pe},be),He=k4(Oe),vt=Be.jsx(I4,Ae({elevation:pe==="temporary"?N:0,square:!0},ke,{className:Xt(He.paper,ke.className),ownerState:Oe,children:L}));if(pe==="permanent")return Be.jsx(A2,Ae({className:Xt(He.root,He.docked,U),ownerState:Oe,ref:s},be,{children:vt}));const dt=Be.jsx(Z,Ae({in:ee,direction:Ok[Re],timeout:W,appear:xe.current},X,{children:vt}));return pe==="persistent"?Be.jsx(A2,Ae({className:Xt(He.root,He.docked,U),ownerState:Oe,ref:s},be,{children:dt})):Be.jsx(E4,Ae({BackdropProps:Ae({},P,se,{transitionDuration:W}),className:Xt(He.root,He.modal,U),open:ee,ownerState:Oe,onClose:ne,hideBackdrop:D,ref:s},be,_e,{children:dt}))}),ku=Te.createContext({});function z4(e){return ii("MuiList",e)}Mr("MuiList",["root","padding","dense","subheader"]);const L4=["children","className","component","dense","disablePadding","subheader"],R4=e=>{const{classes:t,disablePadding:s,dense:l,subheader:f}=e;return bi({root:["root",!s&&"padding",l&&"dense",f&&"subheader"]},z4,t)},D4=In("ul",{name:"MuiList",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.root,!s.disablePadding&&t.padding,s.dense&&t.dense,s.subheader&&t.subheader]}})(({ownerState:e})=>Ae({listStyle:"none",margin:0,padding:0,position:"relative"},!e.disablePadding&&{paddingTop:8,paddingBottom:8},e.subheader&&{paddingTop:0})),M2=Te.forwardRef(function(t,s){const l=oi({props:t,name:"MuiList"}),{children:f,className:y,component:x="ul",dense:u=!1,disablePadding:P=!1,subheader:L}=l,U=ln(l,L4),N=Te.useMemo(()=>({dense:u}),[u]),D=Ae({},l,{component:x,dense:u,disablePadding:P}),se=R4(D);return Be.jsx(ku.Provider,{value:N,children:Be.jsxs(D4,Ae({as:x,className:Xt(se.root,y),ref:s,ownerState:D},U,{children:[L,f]}))})});function F4(e){return ii("MuiListItem",e)}const tu=Mr("MuiListItem",["root","container","focusVisible","dense","alignItemsFlexStart","disabled","divider","gutters","padding","button","secondaryAction","selected"]),B4=Mr("MuiListItemButton",["root","focusVisible","dense","alignItemsFlexStart","disabled","divider","gutters","selected"]);function O4(e){return ii("MuiListItemSecondaryAction",e)}Mr("MuiListItemSecondaryAction",["root","disableGutters"]);const N4=["className"],$4=e=>{const{disableGutters:t,classes:s}=e;return bi({root:["root",t&&"disableGutters"]},O4,s)},j4=In("div",{name:"MuiListItemSecondaryAction",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.root,s.disableGutters&&t.disableGutters]}})(({ownerState:e})=>Ae({position:"absolute",right:16,top:"50%",transform:"translateY(-50%)"},e.disableGutters&&{right:0})),Nk=Te.forwardRef(function(t,s){const l=oi({props:t,name:"MuiListItemSecondaryAction"}),{className:f}=l,y=ln(l,N4),x=Te.useContext(ku),u=Ae({},l,{disableGutters:x.disableGutters}),P=$4(u);return Be.jsx(j4,Ae({className:Xt(P.root,f),ownerState:u,ref:s},y))});Nk.muiName="ListItemSecondaryAction";const U4=["className"],V4=["alignItems","autoFocus","button","children","className","component","components","componentsProps","ContainerComponent","ContainerProps","dense","disabled","disableGutters","disablePadding","divider","focusVisibleClassName","secondaryAction","selected","slotProps","slots"],G4=(e,t)=>{const{ownerState:s}=e;return[t.root,s.dense&&t.dense,s.alignItems==="flex-start"&&t.alignItemsFlexStart,s.divider&&t.divider,!s.disableGutters&&t.gutters,!s.disablePadding&&t.padding,s.button&&t.button,s.hasSecondaryAction&&t.secondaryAction]},q4=e=>{const{alignItems:t,button:s,classes:l,dense:f,disabled:y,disableGutters:x,disablePadding:u,divider:P,hasSecondaryAction:L,selected:U}=e;return bi({root:["root",f&&"dense",!x&&"gutters",!u&&"padding",P&&"divider",y&&"disabled",s&&"button",t==="flex-start"&&"alignItemsFlexStart",L&&"secondaryAction",U&&"selected"],container:["container"]},F4,l)},H4=In("div",{name:"MuiListItem",slot:"Root",overridesResolver:G4})(({theme:e,ownerState:t})=>Ae({display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",width:"100%",boxSizing:"border-box",textAlign:"left"},!t.disablePadding&&Ae({paddingTop:8,paddingBottom:8},t.dense&&{paddingTop:4,paddingBottom:4},!t.disableGutters&&{paddingLeft:16,paddingRight:16},!!t.secondaryAction&&{paddingRight:48}),!!t.secondaryAction&&{[`& > .${B4.root}`]:{paddingRight:48}},{[`&.${tu.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${tu.selected}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:Ao(e.palette.primary.main,e.palette.action.selectedOpacity),[`&.${tu.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:Ao(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}},[`&.${tu.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity}},t.alignItems==="flex-start"&&{alignItems:"flex-start"},t.divider&&{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:"padding-box"},t.button&&{transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${tu.selected}:hover`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:Ao(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:Ao(e.palette.primary.main,e.palette.action.selectedOpacity)}}},t.hasSecondaryAction&&{paddingRight:48})),Z4=In("li",{name:"MuiListItem",slot:"Container",overridesResolver:(e,t)=>t.container})({position:"relative"}),ad=Te.forwardRef(function(t,s){const l=oi({props:t,name:"MuiListItem"}),{alignItems:f="center",autoFocus:y=!1,button:x=!1,children:u,className:P,component:L,components:U={},componentsProps:N={},ContainerComponent:D="li",ContainerProps:{className:se}={},dense:ne=!1,disabled:ee=!1,disableGutters:ke=!1,disablePadding:X=!1,divider:Z=!1,focusVisibleClassName:W,secondaryAction:pe,selected:_e=!1,slotProps:be={},slots:xe={}}=l,Re=ln(l.ContainerProps,U4),tt=ln(l,V4),Oe=Te.useContext(ku),He=Te.useMemo(()=>({dense:ne||Oe.dense||!1,alignItems:f,disableGutters:ke}),[f,Oe.dense,ne,ke]),vt=Te.useRef(null);Wd(()=>{y&&vt.current&&vt.current.focus()},[y]);const dt=Te.Children.toArray(u),ht=dt.length&&vk(dt[dt.length-1],["ListItemSecondaryAction"]),Lt=Ae({},l,{alignItems:f,autoFocus:y,button:x,dense:He.dense,disabled:ee,disableGutters:ke,disablePadding:X,divider:Z,hasSecondaryAction:ht,selected:_e}),yt=q4(Lt),Tt=bs(vt,s),Pe=xe.root||U.Root||H4,et=be.root||N.root||{},lt=Ae({className:Xt(yt.root,et.className,P),disabled:ee},tt);let Ct=L||"li";return x&&(lt.component=L||"div",lt.focusVisibleClassName=Xt(tu.focusVisible,W),Ct=xx),ht?(Ct=!lt.component&&!L?"div":Ct,D==="li"&&(Ct==="li"?Ct="div":lt.component==="li"&&(lt.component="div")),Be.jsx(ku.Provider,{value:He,children:Be.jsxs(Z4,Ae({as:D,className:Xt(yt.container,se),ref:Tt,ownerState:Lt},Re,{children:[Be.jsx(Pe,Ae({},et,!V0(Pe)&&{as:Ct,ownerState:Ae({},Lt,et.ownerState)},lt,{children:dt})),dt.pop()]}))})):Be.jsx(ku.Provider,{value:He,children:Be.jsxs(Pe,Ae({},et,{as:Ct,ref:Tt},!V0(Pe)&&{ownerState:Ae({},Lt,et.ownerState)},lt,{children:[dt,pe&&Be.jsx(Nk,{children:pe})]}))})});function W4(e){return ii("MuiListItemText",e)}const z2=Mr("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]),K4=["children","className","disableTypography","inset","primary","primaryTypographyProps","secondary","secondaryTypographyProps"],X4=e=>{const{classes:t,inset:s,primary:l,secondary:f,dense:y}=e;return bi({root:["root",s&&"inset",y&&"dense",l&&f&&"multiline"],primary:["primary"],secondary:["secondary"]},W4,t)},Y4=In("div",{name:"MuiListItemText",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[{[`& .${z2.primary}`]:t.primary},{[`& .${z2.secondary}`]:t.secondary},t.root,s.inset&&t.inset,s.primary&&s.secondary&&t.multiline,s.dense&&t.dense]}})(({ownerState:e})=>Ae({flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4},e.primary&&e.secondary&&{marginTop:6,marginBottom:6},e.inset&&{paddingLeft:56})),ld=Te.forwardRef(function(t,s){const l=oi({props:t,name:"MuiListItemText"}),{children:f,className:y,disableTypography:x=!1,inset:u=!1,primary:P,primaryTypographyProps:L,secondary:U,secondaryTypographyProps:N}=l,D=ln(l,K4),{dense:se}=Te.useContext(ku);let ne=P??f,ee=U;const ke=Ae({},l,{disableTypography:x,inset:u,primary:!!ne,secondary:!!ee,dense:se}),X=X4(ke);return ne!=null&&ne.type!==Co&&!x&&(ne=Be.jsx(Co,Ae({variant:se?"body2":"body1",className:X.primary,component:L!=null&&L.variant?void 0:"span",display:"block"},L,{children:ne}))),ee!=null&&ee.type!==Co&&!x&&(ee=Be.jsx(Co,Ae({variant:"body2",className:X.secondary,color:"text.secondary",display:"block"},N,{children:ee}))),Be.jsxs(Y4,Ae({className:Xt(X.root,y),ownerState:ke,ref:s},D,{children:[ne,ee]}))});function J4(e){return ii("MuiToolbar",e)}Mr("MuiToolbar",["root","gutters","regular","dense"]);const Q4=["className","component","disableGutters","variant"],eF=e=>{const{classes:t,disableGutters:s,variant:l}=e;return bi({root:["root",!s&&"gutters",l]},J4,t)},tF=In("div",{name:"MuiToolbar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.root,!s.disableGutters&&t.gutters,t[s.variant]]}})(({theme:e,ownerState:t})=>Ae({position:"relative",display:"flex",alignItems:"center"},!t.disableGutters&&{paddingLeft:e.spacing(2),paddingRight:e.spacing(2),[e.breakpoints.up("sm")]:{paddingLeft:e.spacing(3),paddingRight:e.spacing(3)}},t.variant==="dense"&&{minHeight:48}),({theme:e,ownerState:t})=>t.variant==="regular"&&e.mixins.toolbar),nF=Te.forwardRef(function(t,s){const l=oi({props:t,name:"MuiToolbar"}),{className:f,component:y="div",disableGutters:x=!1,variant:u="regular"}=l,P=ln(l,Q4),L=Ae({},l,{component:y,disableGutters:x,variant:u}),U=eF(L);return Be.jsx(tF,Ae({as:y,className:Xt(U.root,f),ref:s,ownerState:L},P))}),L2={MAPTILER_API_KEY:"qC6zBtR7VUaKtyyiLcJq",MAPTILER_DATSET_ID:"57ce7daa-ea5b-4cd6-8975-32c41f5c5d90"};var bx={},L_={};const rF=Qs(j3);var R2;function wx(){return R2||(R2=1,function(e){"use client";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"default",{enumerable:!0,get:function(){return t.createSvgIcon}});var t=rF}(L_)),L_}var iF=sp;Object.defineProperty(bx,"__esModule",{value:!0});var $k=bx.default=void 0,oF=iF(wx()),sF=Be;$k=bx.default=(0,oF.default)((0,sF.jsx)("path",{d:"M3 18h18v-2H3zm0-5h18v-2H3zm0-7v2h18V6z"}),"Menu");function aF({handleDrawerOpen:e,open:t}){const l=In(ID,{shouldForwardProp:f=>f!=="open"})(({theme:f,open:y})=>({transition:f.transitions.create("margin",{easing:f.transitions.easing.sharp,duration:f.transitions.duration.leavingScreen}),...y&&{width:"calc(100% - 250px)",marginLeft:"-250px",transition:f.transitions.create("margin",{easing:f.transitions.easing.easeOut,duration:f.transitions.duration.enteringScreen})}}));return Be.jsx(l,{position:"fixed",open:t,sx:{p:0},children:Be.jsxs(nF,{children:[Be.jsx(Dk,{edge:"start",color:"inherit","aria-label":"open drawer",onClick:e,sx:{mr:2,...t&&{display:"none"}},children:Be.jsx($k,{})}),Be.jsx(Co,{variant:"h6",color:"inherit",component:"div",children:"Honolulu Accommodation"})]})})}var Sx={},lF=sp;Object.defineProperty(Sx,"__esModule",{value:!0});var jk=Sx.default=void 0,cF=lF(wx()),uF=Be;jk=Sx.default=(0,cF.default)((0,uF.jsx)("path",{d:"M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"}),"ChevronLeft");var Tx={},hF=sp;Object.defineProperty(Tx,"__esModule",{value:!0});var Uk=Tx.default=void 0,dF=hF(wx()),pF=Be;Uk=Tx.default=(0,dF.default)((0,pF.jsx)("path",{d:"M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"ChevronRight");function fF({open:e,handleDrawerClose:t,item:s}){const l="250px",f=Fg(),y=In("div")(({theme:x})=>({display:"flex",alignItems:"center",padding:x.spacing(0,1),...x.mixins.toolbar,justifyContent:"flex-end"}));return Be.jsxs(M4,{sx:{width:l,flexShrink:0,"& .MuiDrawer-paper":{width:l,boxSizing:"border-box"}},variant:"persistent",anchor:"left",open:e,children:[Be.jsx(y,{children:Be.jsx(Dk,{onClick:t,children:f.direction==="ltr"?Be.jsx(jk,{}):Be.jsx(Uk,{})})}),s?Be.jsxs(M2,{children:[Be.jsx(ad,{children:Be.jsx(ld,{primary:Be.jsx(Co,{variant:"h4",children:s.name})})}),Be.jsx(ad,{children:Be.jsx(ld,{primary:Be.jsxs(Co,{variant:"h5",children:["Host: ",s.host_name]}),secondary:Be.jsxs(Co,{variant:"body",children:["id: ",s.host_id]})})}),Be.jsx(ad,{children:Be.jsx(ld,{primary:Be.jsxs(Co,{variant:"p",children:[Be.jsx("b",{children:"Room type:"})," ",s.room_type]})})}),Be.jsx(ad,{children:Be.jsx(ld,{primary:Be.jsxs(Co,{variant:"p",children:[Be.jsx("b",{children:"Minimum night:"})," ",s.minimum_nights]})})}),Be.jsx(ad,{children:Be.jsx(ld,{primary:Be.jsxs(Co,{variant:"p",children:[Be.jsx("b",{children:"Neighbourhood: "}),s.neighbourhood,", ",s.neighbourhood_group]})})},s.id)]}):Be.jsx(M2,{children:Be.jsx(Co,{variant:"body-1",component:"p",sx:{padding:2},children:"Click to point to see more details"})})]})}const mF=In("main",{shouldForwardProp:e=>e!=="open"})(({theme:e,open:t})=>({flexGrow:1,transition:e.transitions.create("margin",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),marginLeft:"-250px",...t&&{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginLeft:0}}));function gF(){const e=Te.useRef(null),t=Te.useRef(null),s=L2.MAPTILER_DATSET_ID,l={lng:-157.9253,lat:21.4732},f=9.79;kr.apiKey=L2.MAPTILER_API_KEY;const[y,x]=Te.useState(""),[u,P]=Te.useState(""),[L,U]=Te.useState(""),[N,D]=Te.useState("point"),[se,ne]=Te.useState(!1),[ee,ke]=Te.useState(!1),[X,Z]=Te.useState();Te.useEffect(()=>{t.current||(t.current=new IC({container:e.current,style:QT.DATAVIZ.LIGHT,center:[l.lng,l.lat],zoom:f,hash:!0}),t.current.on("load",()=>{const{heatmapLayerId:be}=Hw.addHeatmap(t.current,{data:s,property:"minimum_nights",weight:[{propertyValue:1,value:1},{propertyValue:30,value:0}],radius:[{propertyValue:1,value:60},{propertyValue:30,value:0}],colorRamp:Im.COOL});x(be),ne(!0)}),t.current.on("load",()=>{const{pointLayerId:be,labelLayerId:xe}=Hw.addPoint(t.current,{data:s,pointColor:Im.COOL.scale(0,30),property:"minimum_nights",pointOpacity:.5,showLabel:!0,labelColor:"black"});U(xe),P(be),ne(!0)}))},[l.lng,l.lat,f]),Te.useEffect(()=>{se&&t.current.on("click",u,be=>{let xe=be.features[0].geometry.coordinates.slice(),Re=be.features[0].properties.name;new r5().setLngLat(xe).setHTML(Re).addTo(t.current),Z(be.features[0].properties),ke(!0)})},[se]),Te.useEffect(()=>{y&&se&&t.current.setLayoutProperty(y,"visibility",N==="heatmap"?"visible":"none")},[y,N,se]),Te.useEffect(()=>{u&&se&&(t.current.setLayoutProperty(u,"visibility",N==="point"?"visible":"none"),t.current.setLayoutProperty(L,"visibility",N==="point"?"visible":"none"))},[u,N,se]);const W=()=>{D(be=>be==="point"?"heatmap":"point")},pe=()=>{ke(!0)},_e=()=>{ke(!1)};return Be.jsxs(jD,{sx:{display:"flex"},children:[Be.jsx(aF,{handleDrawerOpen:pe,open:ee}),Be.jsx(fF,{handleDrawerClose:_e,open:ee,item:X}),Be.jsx(mF,{open:ee,children:Be.jsxs(XD,{variant:"contained",className:"btn",sx:{top:84,left:10,zIndex:10},onClick:W,children:["Change to ",N==="point"?"heatmap":"point"]})}),Be.jsx("div",{className:"container",children:Be.jsx("div",{ref:e,id:"map",className:"map"})})]})}function yF(){return Be.jsx("div",{className:"App",children:Be.jsx(gF,{})})}D_.createRoot(document.getElementById("root")).render(Be.jsx(Xo.StrictMode,{children:Be.jsx(yF,{})}));
