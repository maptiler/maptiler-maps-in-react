function KI(e,n){for(var s=0;s<n.length;s++){const c=n[s];if(typeof c!="string"&&!Array.isArray(c)){for(const f in c)if(f!=="default"&&!(f in e)){const x=Object.getOwnPropertyDescriptor(c,f);x&&Object.defineProperty(e,f,x.get?x:{enumerable:!0,get:()=>c[f]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))c(f);new MutationObserver(f=>{for(const x of f)if(x.type==="childList")for(const v of x.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&c(v)}).observe(document,{childList:!0,subtree:!0});function s(f){const x={};return f.integrity&&(x.integrity=f.integrity),f.referrerPolicy&&(x.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?x.credentials="include":f.crossOrigin==="anonymous"?x.credentials="omit":x.credentials="same-origin",x}function c(f){if(f.ep)return;f.ep=!0;const x=s(f);fetch(f.href,x)}})();var XI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function e0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Fs(e){if(e.__esModule)return e;var n=e.default;if(typeof n=="function"){var s=function c(){return this instanceof c?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};s.prototype=n.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(e).forEach(function(c){var f=Object.getOwnPropertyDescriptor(e,c);Object.defineProperty(s,c,f.get?f:{enumerable:!0,get:function(){return e[c]}})}),s}var fw={exports:{}},em={},mw={exports:{}},Mt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yd=Symbol.for("react.element"),YI=Symbol.for("react.portal"),JI=Symbol.for("react.fragment"),QI=Symbol.for("react.strict_mode"),eE=Symbol.for("react.profiler"),tE=Symbol.for("react.provider"),rE=Symbol.for("react.context"),nE=Symbol.for("react.forward_ref"),iE=Symbol.for("react.suspense"),oE=Symbol.for("react.memo"),sE=Symbol.for("react.lazy"),sx=Symbol.iterator;function aE(e){return e===null||typeof e!="object"?null:(e=sx&&e[sx]||e["@@iterator"],typeof e=="function"?e:null)}var gw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},yw=Object.assign,_w={};function au(e,n,s){this.props=e,this.context=n,this.refs=_w,this.updater=s||gw}au.prototype.isReactComponent={};au.prototype.setState=function(e,n){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,n,"setState")};au.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function vw(){}vw.prototype=au.prototype;function t0(e,n,s){this.props=e,this.context=n,this.refs=_w,this.updater=s||gw}var r0=t0.prototype=new vw;r0.constructor=t0;yw(r0,au.prototype);r0.isPureReactComponent=!0;var ax=Array.isArray,xw=Object.prototype.hasOwnProperty,n0={current:null},bw={key:!0,ref:!0,__self:!0,__source:!0};function ww(e,n,s){var c,f={},x=null,v=null;if(n!=null)for(c in n.ref!==void 0&&(v=n.ref),n.key!==void 0&&(x=""+n.key),n)xw.call(n,c)&&!bw.hasOwnProperty(c)&&(f[c]=n[c]);var d=arguments.length-2;if(d===1)f.children=s;else if(1<d){for(var L=Array(d),U=0;U<d;U++)L[U]=arguments[U+2];f.children=L}if(e&&e.defaultProps)for(c in d=e.defaultProps,d)f[c]===void 0&&(f[c]=d[c]);return{$$typeof:yd,type:e,key:x,ref:v,props:f,_owner:n0.current}}function lE(e,n){return{$$typeof:yd,type:e.type,key:n,ref:e.ref,props:e.props,_owner:e._owner}}function i0(e){return typeof e=="object"&&e!==null&&e.$$typeof===yd}function cE(e){var n={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(s){return n[s]})}var lx=/\/+/g;function ly(e,n){return typeof e=="object"&&e!==null&&e.key!=null?cE(""+e.key):n.toString(36)}function sf(e,n,s,c,f){var x=typeof e;(x==="undefined"||x==="boolean")&&(e=null);var v=!1;if(e===null)v=!0;else switch(x){case"string":case"number":v=!0;break;case"object":switch(e.$$typeof){case yd:case YI:v=!0}}if(v)return v=e,f=f(v),e=c===""?"."+ly(v,0):c,ax(f)?(s="",e!=null&&(s=e.replace(lx,"$&/")+"/"),sf(f,n,s,"",function(U){return U})):f!=null&&(i0(f)&&(f=lE(f,s+(!f.key||v&&v.key===f.key?"":(""+f.key).replace(lx,"$&/")+"/")+e)),n.push(f)),1;if(v=0,c=c===""?".":c+":",ax(e))for(var d=0;d<e.length;d++){x=e[d];var L=c+ly(x,d);v+=sf(x,n,s,L,f)}else if(L=aE(e),typeof L=="function")for(e=L.call(e),d=0;!(x=e.next()).done;)x=x.value,L=c+ly(x,d++),v+=sf(x,n,s,L,f);else if(x==="object")throw n=String(e),Error("Objects are not valid as a React child (found: "+(n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n)+"). If you meant to render a collection of children, use an array instead.");return v}function Bp(e,n,s){if(e==null)return e;var c=[],f=0;return sf(e,c,"","",function(x){return n.call(s,x,f++)}),c}function uE(e){if(e._status===-1){var n=e._result;n=n(),n.then(function(s){(e._status===0||e._status===-1)&&(e._status=1,e._result=s)},function(s){(e._status===0||e._status===-1)&&(e._status=2,e._result=s)}),e._status===-1&&(e._status=0,e._result=n)}if(e._status===1)return e._result.default;throw e._result}var di={current:null},af={transition:null},hE={ReactCurrentDispatcher:di,ReactCurrentBatchConfig:af,ReactCurrentOwner:n0};function Sw(){throw Error("act(...) is not supported in production builds of React.")}Mt.Children={map:Bp,forEach:function(e,n,s){Bp(e,function(){n.apply(this,arguments)},s)},count:function(e){var n=0;return Bp(e,function(){n++}),n},toArray:function(e){return Bp(e,function(n){return n})||[]},only:function(e){if(!i0(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Mt.Component=au;Mt.Fragment=JI;Mt.Profiler=eE;Mt.PureComponent=t0;Mt.StrictMode=QI;Mt.Suspense=iE;Mt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=hE;Mt.act=Sw;Mt.cloneElement=function(e,n,s){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var c=yw({},e.props),f=e.key,x=e.ref,v=e._owner;if(n!=null){if(n.ref!==void 0&&(x=n.ref,v=n0.current),n.key!==void 0&&(f=""+n.key),e.type&&e.type.defaultProps)var d=e.type.defaultProps;for(L in n)xw.call(n,L)&&!bw.hasOwnProperty(L)&&(c[L]=n[L]===void 0&&d!==void 0?d[L]:n[L])}var L=arguments.length-2;if(L===1)c.children=s;else if(1<L){d=Array(L);for(var U=0;U<L;U++)d[U]=arguments[U+2];c.children=d}return{$$typeof:yd,type:e.type,key:f,ref:x,props:c,_owner:v}};Mt.createContext=function(e){return e={$$typeof:rE,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:tE,_context:e},e.Consumer=e};Mt.createElement=ww;Mt.createFactory=function(e){var n=ww.bind(null,e);return n.type=e,n};Mt.createRef=function(){return{current:null}};Mt.forwardRef=function(e){return{$$typeof:nE,render:e}};Mt.isValidElement=i0;Mt.lazy=function(e){return{$$typeof:sE,_payload:{_status:-1,_result:e},_init:uE}};Mt.memo=function(e,n){return{$$typeof:oE,type:e,compare:n===void 0?null:n}};Mt.startTransition=function(e){var n=af.transition;af.transition={};try{e()}finally{af.transition=n}};Mt.unstable_act=Sw;Mt.useCallback=function(e,n){return di.current.useCallback(e,n)};Mt.useContext=function(e){return di.current.useContext(e)};Mt.useDebugValue=function(){};Mt.useDeferredValue=function(e){return di.current.useDeferredValue(e)};Mt.useEffect=function(e,n){return di.current.useEffect(e,n)};Mt.useId=function(){return di.current.useId()};Mt.useImperativeHandle=function(e,n,s){return di.current.useImperativeHandle(e,n,s)};Mt.useInsertionEffect=function(e,n){return di.current.useInsertionEffect(e,n)};Mt.useLayoutEffect=function(e,n){return di.current.useLayoutEffect(e,n)};Mt.useMemo=function(e,n){return di.current.useMemo(e,n)};Mt.useReducer=function(e,n,s){return di.current.useReducer(e,n,s)};Mt.useRef=function(e){return di.current.useRef(e)};Mt.useState=function(e){return di.current.useState(e)};Mt.useSyncExternalStore=function(e,n,s){return di.current.useSyncExternalStore(e,n,s)};Mt.useTransition=function(){return di.current.useTransition()};Mt.version="18.3.1";mw.exports=Mt;var Ge=mw.exports;const dl=e0(Ge),jy=KI({__proto__:null,default:dl},[Ge]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dE=Ge,pE=Symbol.for("react.element"),fE=Symbol.for("react.fragment"),mE=Object.prototype.hasOwnProperty,gE=dE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,yE={key:!0,ref:!0,__self:!0,__source:!0};function Tw(e,n,s){var c,f={},x=null,v=null;s!==void 0&&(x=""+s),n.key!==void 0&&(x=""+n.key),n.ref!==void 0&&(v=n.ref);for(c in n)mE.call(n,c)&&!yE.hasOwnProperty(c)&&(f[c]=n[c]);if(e&&e.defaultProps)for(c in n=e.defaultProps,n)f[c]===void 0&&(f[c]=n[c]);return{$$typeof:pE,type:e,key:x,ref:v,props:f,_owner:gE.current}}em.Fragment=fE;em.jsx=Tw;em.jsxs=Tw;fw.exports=em;var qt=fw.exports,Vy={},Cw={exports:{}},Wi={},Iw={exports:{}},Ew={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function n(qe,mt){var gt=qe.length;qe.push(mt);e:for(;0<gt;){var At=gt-1>>>1,Lt=qe[At];if(0<f(Lt,mt))qe[At]=mt,qe[gt]=Lt,gt=At;else break e}}function s(qe){return qe.length===0?null:qe[0]}function c(qe){if(qe.length===0)return null;var mt=qe[0],gt=qe.pop();if(gt!==mt){qe[0]=gt;e:for(var At=0,Lt=qe.length,Zr=Lt>>>1;At<Zr;){var xr=2*(At+1)-1,Kr=qe[xr],Ar=xr+1,Xr=qe[Ar];if(0>f(Kr,gt))Ar<Lt&&0>f(Xr,Kr)?(qe[At]=Xr,qe[Ar]=gt,At=Ar):(qe[At]=Kr,qe[xr]=gt,At=xr);else if(Ar<Lt&&0>f(Xr,gt))qe[At]=Xr,qe[Ar]=gt,At=Ar;else break e}}return mt}function f(qe,mt){var gt=qe.sortIndex-mt.sortIndex;return gt!==0?gt:qe.id-mt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var x=performance;e.unstable_now=function(){return x.now()}}else{var v=Date,d=v.now();e.unstable_now=function(){return v.now()-d}}var L=[],U=[],Z=1,j=null,F=3,me=!1,ye=!1,pe=!1,je=typeof setTimeout=="function"?setTimeout:null,re=typeof clearTimeout=="function"?clearTimeout:null,ee=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ae(qe){for(var mt=s(U);mt!==null;){if(mt.callback===null)c(U);else if(mt.startTime<=qe)c(U),mt.sortIndex=mt.expirationTime,n(L,mt);else break;mt=s(U)}}function xe(qe){if(pe=!1,ae(qe),!ye)if(s(L)!==null)ye=!0,vr(Ee);else{var mt=s(U);mt!==null&&Rr(xe,mt.startTime-qe)}}function Ee(qe,mt){ye=!1,pe&&(pe=!1,re(Ke),Ke=-1),me=!0;var gt=F;try{for(ae(mt),j=s(L);j!==null&&(!(j.expirationTime>mt)||qe&&!st());){var At=j.callback;if(typeof At=="function"){j.callback=null,F=j.priorityLevel;var Lt=At(j.expirationTime<=mt);mt=e.unstable_now(),typeof Lt=="function"?j.callback=Lt:j===s(L)&&c(L),ae(mt)}else c(L);j=s(L)}if(j!==null)var Zr=!0;else{var xr=s(U);xr!==null&&Rr(xe,xr.startTime-mt),Zr=!1}return Zr}finally{j=null,F=gt,me=!1}}var Pe=!1,Ae=null,Ke=-1,vt=5,ot=-1;function st(){return!(e.unstable_now()-ot<vt)}function Ft(){if(Ae!==null){var qe=e.unstable_now();ot=qe;var mt=!0;try{mt=Ae(!0,qe)}finally{mt?Et():(Pe=!1,Ae=null)}}else Pe=!1}var Et;if(typeof ee=="function")Et=function(){ee(Ft)};else if(typeof MessageChannel<"u"){var zt=new MessageChannel,kr=zt.port2;zt.port1.onmessage=Ft,Et=function(){kr.postMessage(null)}}else Et=function(){je(Ft,0)};function vr(qe){Ae=qe,Pe||(Pe=!0,Et())}function Rr(qe,mt){Ke=je(function(){qe(e.unstable_now())},mt)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(qe){qe.callback=null},e.unstable_continueExecution=function(){ye||me||(ye=!0,vr(Ee))},e.unstable_forceFrameRate=function(qe){0>qe||125<qe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):vt=0<qe?Math.floor(1e3/qe):5},e.unstable_getCurrentPriorityLevel=function(){return F},e.unstable_getFirstCallbackNode=function(){return s(L)},e.unstable_next=function(qe){switch(F){case 1:case 2:case 3:var mt=3;break;default:mt=F}var gt=F;F=mt;try{return qe()}finally{F=gt}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(qe,mt){switch(qe){case 1:case 2:case 3:case 4:case 5:break;default:qe=3}var gt=F;F=qe;try{return mt()}finally{F=gt}},e.unstable_scheduleCallback=function(qe,mt,gt){var At=e.unstable_now();switch(typeof gt=="object"&&gt!==null?(gt=gt.delay,gt=typeof gt=="number"&&0<gt?At+gt:At):gt=At,qe){case 1:var Lt=-1;break;case 2:Lt=250;break;case 5:Lt=1073741823;break;case 4:Lt=1e4;break;default:Lt=5e3}return Lt=gt+Lt,qe={id:Z++,callback:mt,priorityLevel:qe,startTime:gt,expirationTime:Lt,sortIndex:-1},gt>At?(qe.sortIndex=gt,n(U,qe),s(L)===null&&qe===s(U)&&(pe?(re(Ke),Ke=-1):pe=!0,Rr(xe,gt-At))):(qe.sortIndex=Lt,n(L,qe),ye||me||(ye=!0,vr(Ee))),qe},e.unstable_shouldYield=st,e.unstable_wrapCallback=function(qe){var mt=F;return function(){var gt=F;F=mt;try{return qe.apply(this,arguments)}finally{F=gt}}}})(Ew);Iw.exports=Ew;var _E=Iw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vE=Ge,Hi=_E;function Be(e){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)n+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var kw=new Set,Kh={};function Cl(e,n){Qc(e,n),Qc(e+"Capture",n)}function Qc(e,n){for(Kh[e]=n,e=0;e<n.length;e++)kw.add(n[e])}var zs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),qy=Object.prototype.hasOwnProperty,xE=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,cx={},ux={};function bE(e){return qy.call(ux,e)?!0:qy.call(cx,e)?!1:xE.test(e)?ux[e]=!0:(cx[e]=!0,!1)}function wE(e,n,s,c){if(s!==null&&s.type===0)return!1;switch(typeof n){case"function":case"symbol":return!0;case"boolean":return c?!1:s!==null?!s.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function SE(e,n,s,c){if(n===null||typeof n>"u"||wE(e,n,s,c))return!0;if(c)return!1;if(s!==null)switch(s.type){case 3:return!n;case 4:return n===!1;case 5:return isNaN(n);case 6:return isNaN(n)||1>n}return!1}function pi(e,n,s,c,f,x,v){this.acceptsBooleans=n===2||n===3||n===4,this.attributeName=c,this.attributeNamespace=f,this.mustUseProperty=s,this.propertyName=e,this.type=n,this.sanitizeURL=x,this.removeEmptyString=v}var Fn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Fn[e]=new pi(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var n=e[0];Fn[n]=new pi(n,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Fn[e]=new pi(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Fn[e]=new pi(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Fn[e]=new pi(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Fn[e]=new pi(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Fn[e]=new pi(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Fn[e]=new pi(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Fn[e]=new pi(e,5,!1,e.toLowerCase(),null,!1,!1)});var o0=/[\-:]([a-z])/g;function s0(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var n=e.replace(o0,s0);Fn[n]=new pi(n,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var n=e.replace(o0,s0);Fn[n]=new pi(n,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var n=e.replace(o0,s0);Fn[n]=new pi(n,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Fn[e]=new pi(e,1,!1,e.toLowerCase(),null,!1,!1)});Fn.xlinkHref=new pi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Fn[e]=new pi(e,1,!1,e.toLowerCase(),null,!0,!0)});function a0(e,n,s,c){var f=Fn.hasOwnProperty(n)?Fn[n]:null;(f!==null?f.type!==0:c||!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(SE(n,s,f,c)&&(s=null),c||f===null?bE(n)&&(s===null?e.removeAttribute(n):e.setAttribute(n,""+s)):f.mustUseProperty?e[f.propertyName]=s===null?f.type===3?!1:"":s:(n=f.attributeName,c=f.attributeNamespace,s===null?e.removeAttribute(n):(f=f.type,s=f===3||f===4&&s===!0?"":""+s,c?e.setAttributeNS(c,n,s):e.setAttribute(n,s))))}var Os=vE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Fp=Symbol.for("react.element"),Pc=Symbol.for("react.portal"),Mc=Symbol.for("react.fragment"),l0=Symbol.for("react.strict_mode"),Hy=Symbol.for("react.profiler"),Aw=Symbol.for("react.provider"),Pw=Symbol.for("react.context"),c0=Symbol.for("react.forward_ref"),Wy=Symbol.for("react.suspense"),Gy=Symbol.for("react.suspense_list"),u0=Symbol.for("react.memo"),pa=Symbol.for("react.lazy"),Mw=Symbol.for("react.offscreen"),hx=Symbol.iterator;function Sh(e){return e===null||typeof e!="object"?null:(e=hx&&e[hx]||e["@@iterator"],typeof e=="function"?e:null)}var Lr=Object.assign,cy;function Lh(e){if(cy===void 0)try{throw Error()}catch(s){var n=s.stack.trim().match(/\n( *(at )?)/);cy=n&&n[1]||""}return`
`+cy+e}var uy=!1;function hy(e,n){if(!e||uy)return"";uy=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(n)if(n=function(){throw Error()},Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(n,[])}catch(U){var c=U}Reflect.construct(e,[],n)}else{try{n.call()}catch(U){c=U}e.call(n.prototype)}else{try{throw Error()}catch(U){c=U}e()}}catch(U){if(U&&c&&typeof U.stack=="string"){for(var f=U.stack.split(`
`),x=c.stack.split(`
`),v=f.length-1,d=x.length-1;1<=v&&0<=d&&f[v]!==x[d];)d--;for(;1<=v&&0<=d;v--,d--)if(f[v]!==x[d]){if(v!==1||d!==1)do if(v--,d--,0>d||f[v]!==x[d]){var L=`
`+f[v].replace(" at new "," at ");return e.displayName&&L.includes("<anonymous>")&&(L=L.replace("<anonymous>",e.displayName)),L}while(1<=v&&0<=d);break}}}finally{uy=!1,Error.prepareStackTrace=s}return(e=e?e.displayName||e.name:"")?Lh(e):""}function TE(e){switch(e.tag){case 5:return Lh(e.type);case 16:return Lh("Lazy");case 13:return Lh("Suspense");case 19:return Lh("SuspenseList");case 0:case 2:case 15:return e=hy(e.type,!1),e;case 11:return e=hy(e.type.render,!1),e;case 1:return e=hy(e.type,!0),e;default:return""}}function Zy(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Mc:return"Fragment";case Pc:return"Portal";case Hy:return"Profiler";case l0:return"StrictMode";case Wy:return"Suspense";case Gy:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Pw:return(e.displayName||"Context")+".Consumer";case Aw:return(e._context.displayName||"Context")+".Provider";case c0:var n=e.render;return e=e.displayName,e||(e=n.displayName||n.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case u0:return n=e.displayName||null,n!==null?n:Zy(e.type)||"Memo";case pa:n=e._payload,e=e._init;try{return Zy(e(n))}catch{}}return null}function CE(e){var n=e.type;switch(e.tag){case 24:return"Cache";case 9:return(n.displayName||"Context")+".Consumer";case 10:return(n._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=n.render,e=e.displayName||e.name||"",n.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return n;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Zy(n);case 8:return n===l0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n}return null}function Aa(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function zw(e){var n=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function IE(e){var n=zw(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,n),c=""+e[n];if(!e.hasOwnProperty(n)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var f=s.get,x=s.set;return Object.defineProperty(e,n,{configurable:!0,get:function(){return f.call(this)},set:function(v){c=""+v,x.call(this,v)}}),Object.defineProperty(e,n,{enumerable:s.enumerable}),{getValue:function(){return c},setValue:function(v){c=""+v},stopTracking:function(){e._valueTracker=null,delete e[n]}}}}function Op(e){e._valueTracker||(e._valueTracker=IE(e))}function Lw(e){if(!e)return!1;var n=e._valueTracker;if(!n)return!0;var s=n.getValue(),c="";return e&&(c=zw(e)?e.checked?"true":"false":e.value),e=c,e!==s?(n.setValue(e),!0):!1}function If(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ky(e,n){var s=n.checked;return Lr({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??e._wrapperState.initialChecked})}function dx(e,n){var s=n.defaultValue==null?"":n.defaultValue,c=n.checked!=null?n.checked:n.defaultChecked;s=Aa(n.value!=null?n.value:s),e._wrapperState={initialChecked:c,initialValue:s,controlled:n.type==="checkbox"||n.type==="radio"?n.checked!=null:n.value!=null}}function Rw(e,n){n=n.checked,n!=null&&a0(e,"checked",n,!1)}function Xy(e,n){Rw(e,n);var s=Aa(n.value),c=n.type;if(s!=null)c==="number"?(s===0&&e.value===""||e.value!=s)&&(e.value=""+s):e.value!==""+s&&(e.value=""+s);else if(c==="submit"||c==="reset"){e.removeAttribute("value");return}n.hasOwnProperty("value")?Yy(e,n.type,s):n.hasOwnProperty("defaultValue")&&Yy(e,n.type,Aa(n.defaultValue)),n.checked==null&&n.defaultChecked!=null&&(e.defaultChecked=!!n.defaultChecked)}function px(e,n,s){if(n.hasOwnProperty("value")||n.hasOwnProperty("defaultValue")){var c=n.type;if(!(c!=="submit"&&c!=="reset"||n.value!==void 0&&n.value!==null))return;n=""+e._wrapperState.initialValue,s||n===e.value||(e.value=n),e.defaultValue=n}s=e.name,s!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,s!==""&&(e.name=s)}function Yy(e,n,s){(n!=="number"||If(e.ownerDocument)!==e)&&(s==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+s&&(e.defaultValue=""+s))}var Rh=Array.isArray;function jc(e,n,s,c){if(e=e.options,n){n={};for(var f=0;f<s.length;f++)n["$"+s[f]]=!0;for(s=0;s<e.length;s++)f=n.hasOwnProperty("$"+e[s].value),e[s].selected!==f&&(e[s].selected=f),f&&c&&(e[s].defaultSelected=!0)}else{for(s=""+Aa(s),n=null,f=0;f<e.length;f++){if(e[f].value===s){e[f].selected=!0,c&&(e[f].defaultSelected=!0);return}n!==null||e[f].disabled||(n=e[f])}n!==null&&(n.selected=!0)}}function Jy(e,n){if(n.dangerouslySetInnerHTML!=null)throw Error(Be(91));return Lr({},n,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function fx(e,n){var s=n.value;if(s==null){if(s=n.children,n=n.defaultValue,s!=null){if(n!=null)throw Error(Be(92));if(Rh(s)){if(1<s.length)throw Error(Be(93));s=s[0]}n=s}n==null&&(n=""),s=n}e._wrapperState={initialValue:Aa(s)}}function Dw(e,n){var s=Aa(n.value),c=Aa(n.defaultValue);s!=null&&(s=""+s,s!==e.value&&(e.value=s),n.defaultValue==null&&e.defaultValue!==s&&(e.defaultValue=s)),c!=null&&(e.defaultValue=""+c)}function mx(e){var n=e.textContent;n===e._wrapperState.initialValue&&n!==""&&n!==null&&(e.value=n)}function Bw(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Qy(e,n){return e==null||e==="http://www.w3.org/1999/xhtml"?Bw(n):e==="http://www.w3.org/2000/svg"&&n==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Np,Fw=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(n,s,c,f){MSApp.execUnsafeLocalFunction(function(){return e(n,s,c,f)})}:e}(function(e,n){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=n;else{for(Np=Np||document.createElement("div"),Np.innerHTML="<svg>"+n.valueOf().toString()+"</svg>",n=Np.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;n.firstChild;)e.appendChild(n.firstChild)}});function Xh(e,n){if(n){var s=e.firstChild;if(s&&s===e.lastChild&&s.nodeType===3){s.nodeValue=n;return}}e.textContent=n}var Nh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},EE=["Webkit","ms","Moz","O"];Object.keys(Nh).forEach(function(e){EE.forEach(function(n){n=n+e.charAt(0).toUpperCase()+e.substring(1),Nh[n]=Nh[e]})});function Ow(e,n,s){return n==null||typeof n=="boolean"||n===""?"":s||typeof n!="number"||n===0||Nh.hasOwnProperty(e)&&Nh[e]?(""+n).trim():n+"px"}function Nw(e,n){e=e.style;for(var s in n)if(n.hasOwnProperty(s)){var c=s.indexOf("--")===0,f=Ow(s,n[s],c);s==="float"&&(s="cssFloat"),c?e.setProperty(s,f):e[s]=f}}var kE=Lr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function e_(e,n){if(n){if(kE[e]&&(n.children!=null||n.dangerouslySetInnerHTML!=null))throw Error(Be(137,e));if(n.dangerouslySetInnerHTML!=null){if(n.children!=null)throw Error(Be(60));if(typeof n.dangerouslySetInnerHTML!="object"||!("__html"in n.dangerouslySetInnerHTML))throw Error(Be(61))}if(n.style!=null&&typeof n.style!="object")throw Error(Be(62))}}function t_(e,n){if(e.indexOf("-")===-1)return typeof n.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var r_=null;function h0(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var n_=null,Vc=null,qc=null;function gx(e){if(e=xd(e)){if(typeof n_!="function")throw Error(Be(280));var n=e.stateNode;n&&(n=om(n),n_(e.stateNode,e.type,n))}}function $w(e){Vc?qc?qc.push(e):qc=[e]:Vc=e}function Uw(){if(Vc){var e=Vc,n=qc;if(qc=Vc=null,gx(e),n)for(e=0;e<n.length;e++)gx(n[e])}}function jw(e,n){return e(n)}function Vw(){}var dy=!1;function qw(e,n,s){if(dy)return e(n,s);dy=!0;try{return jw(e,n,s)}finally{dy=!1,(Vc!==null||qc!==null)&&(Vw(),Uw())}}function Yh(e,n){var s=e.stateNode;if(s===null)return null;var c=om(s);if(c===null)return null;s=c[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(e=e.type,c=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!c;break e;default:e=!1}if(e)return null;if(s&&typeof s!="function")throw Error(Be(231,n,typeof s));return s}var i_=!1;if(zs)try{var Th={};Object.defineProperty(Th,"passive",{get:function(){i_=!0}}),window.addEventListener("test",Th,Th),window.removeEventListener("test",Th,Th)}catch{i_=!1}function AE(e,n,s,c,f,x,v,d,L){var U=Array.prototype.slice.call(arguments,3);try{n.apply(s,U)}catch(Z){this.onError(Z)}}var $h=!1,Ef=null,kf=!1,o_=null,PE={onError:function(e){$h=!0,Ef=e}};function ME(e,n,s,c,f,x,v,d,L){$h=!1,Ef=null,AE.apply(PE,arguments)}function zE(e,n,s,c,f,x,v,d,L){if(ME.apply(this,arguments),$h){if($h){var U=Ef;$h=!1,Ef=null}else throw Error(Be(198));kf||(kf=!0,o_=U)}}function Il(e){var n=e,s=e;if(e.alternate)for(;n.return;)n=n.return;else{e=n;do n=e,n.flags&4098&&(s=n.return),e=n.return;while(e)}return n.tag===3?s:null}function Hw(e){if(e.tag===13){var n=e.memoizedState;if(n===null&&(e=e.alternate,e!==null&&(n=e.memoizedState)),n!==null)return n.dehydrated}return null}function yx(e){if(Il(e)!==e)throw Error(Be(188))}function LE(e){var n=e.alternate;if(!n){if(n=Il(e),n===null)throw Error(Be(188));return n!==e?null:e}for(var s=e,c=n;;){var f=s.return;if(f===null)break;var x=f.alternate;if(x===null){if(c=f.return,c!==null){s=c;continue}break}if(f.child===x.child){for(x=f.child;x;){if(x===s)return yx(f),e;if(x===c)return yx(f),n;x=x.sibling}throw Error(Be(188))}if(s.return!==c.return)s=f,c=x;else{for(var v=!1,d=f.child;d;){if(d===s){v=!0,s=f,c=x;break}if(d===c){v=!0,c=f,s=x;break}d=d.sibling}if(!v){for(d=x.child;d;){if(d===s){v=!0,s=x,c=f;break}if(d===c){v=!0,c=x,s=f;break}d=d.sibling}if(!v)throw Error(Be(189))}}if(s.alternate!==c)throw Error(Be(190))}if(s.tag!==3)throw Error(Be(188));return s.stateNode.current===s?e:n}function Ww(e){return e=LE(e),e!==null?Gw(e):null}function Gw(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var n=Gw(e);if(n!==null)return n;e=e.sibling}return null}var Zw=Hi.unstable_scheduleCallback,_x=Hi.unstable_cancelCallback,RE=Hi.unstable_shouldYield,DE=Hi.unstable_requestPaint,Hr=Hi.unstable_now,BE=Hi.unstable_getCurrentPriorityLevel,d0=Hi.unstable_ImmediatePriority,Kw=Hi.unstable_UserBlockingPriority,Af=Hi.unstable_NormalPriority,FE=Hi.unstable_LowPriority,Xw=Hi.unstable_IdlePriority,tm=null,ns=null;function OE(e){if(ns&&typeof ns.onCommitFiberRoot=="function")try{ns.onCommitFiberRoot(tm,e,void 0,(e.current.flags&128)===128)}catch{}}var zo=Math.clz32?Math.clz32:UE,NE=Math.log,$E=Math.LN2;function UE(e){return e>>>=0,e===0?32:31-(NE(e)/$E|0)|0}var $p=64,Up=4194304;function Dh(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Pf(e,n){var s=e.pendingLanes;if(s===0)return 0;var c=0,f=e.suspendedLanes,x=e.pingedLanes,v=s&268435455;if(v!==0){var d=v&~f;d!==0?c=Dh(d):(x&=v,x!==0&&(c=Dh(x)))}else v=s&~f,v!==0?c=Dh(v):x!==0&&(c=Dh(x));if(c===0)return 0;if(n!==0&&n!==c&&!(n&f)&&(f=c&-c,x=n&-n,f>=x||f===16&&(x&4194240)!==0))return n;if(c&4&&(c|=s&16),n=e.entangledLanes,n!==0)for(e=e.entanglements,n&=c;0<n;)s=31-zo(n),f=1<<s,c|=e[s],n&=~f;return c}function jE(e,n){switch(e){case 1:case 2:case 4:return n+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function VE(e,n){for(var s=e.suspendedLanes,c=e.pingedLanes,f=e.expirationTimes,x=e.pendingLanes;0<x;){var v=31-zo(x),d=1<<v,L=f[v];L===-1?(!(d&s)||d&c)&&(f[v]=jE(d,n)):L<=n&&(e.expiredLanes|=d),x&=~d}}function s_(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Yw(){var e=$p;return $p<<=1,!($p&4194240)&&($p=64),e}function py(e){for(var n=[],s=0;31>s;s++)n.push(e);return n}function _d(e,n,s){e.pendingLanes|=n,n!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,n=31-zo(n),e[n]=s}function qE(e,n){var s=e.pendingLanes&~n;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=n,e.mutableReadLanes&=n,e.entangledLanes&=n,n=e.entanglements;var c=e.eventTimes;for(e=e.expirationTimes;0<s;){var f=31-zo(s),x=1<<f;n[f]=0,c[f]=-1,e[f]=-1,s&=~x}}function p0(e,n){var s=e.entangledLanes|=n;for(e=e.entanglements;s;){var c=31-zo(s),f=1<<c;f&n|e[c]&n&&(e[c]|=n),s&=~f}}var tr=0;function Jw(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Qw,f0,e2,t2,r2,a_=!1,jp=[],ba=null,wa=null,Sa=null,Jh=new Map,Qh=new Map,ma=[],HE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function vx(e,n){switch(e){case"focusin":case"focusout":ba=null;break;case"dragenter":case"dragleave":wa=null;break;case"mouseover":case"mouseout":Sa=null;break;case"pointerover":case"pointerout":Jh.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":Qh.delete(n.pointerId)}}function Ch(e,n,s,c,f,x){return e===null||e.nativeEvent!==x?(e={blockedOn:n,domEventName:s,eventSystemFlags:c,nativeEvent:x,targetContainers:[f]},n!==null&&(n=xd(n),n!==null&&f0(n)),e):(e.eventSystemFlags|=c,n=e.targetContainers,f!==null&&n.indexOf(f)===-1&&n.push(f),e)}function WE(e,n,s,c,f){switch(n){case"focusin":return ba=Ch(ba,e,n,s,c,f),!0;case"dragenter":return wa=Ch(wa,e,n,s,c,f),!0;case"mouseover":return Sa=Ch(Sa,e,n,s,c,f),!0;case"pointerover":var x=f.pointerId;return Jh.set(x,Ch(Jh.get(x)||null,e,n,s,c,f)),!0;case"gotpointercapture":return x=f.pointerId,Qh.set(x,Ch(Qh.get(x)||null,e,n,s,c,f)),!0}return!1}function n2(e){var n=pl(e.target);if(n!==null){var s=Il(n);if(s!==null){if(n=s.tag,n===13){if(n=Hw(s),n!==null){e.blockedOn=n,r2(e.priority,function(){e2(s)});return}}else if(n===3&&s.stateNode.current.memoizedState.isDehydrated){e.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}e.blockedOn=null}function lf(e){if(e.blockedOn!==null)return!1;for(var n=e.targetContainers;0<n.length;){var s=l_(e.domEventName,e.eventSystemFlags,n[0],e.nativeEvent);if(s===null){s=e.nativeEvent;var c=new s.constructor(s.type,s);r_=c,s.target.dispatchEvent(c),r_=null}else return n=xd(s),n!==null&&f0(n),e.blockedOn=s,!1;n.shift()}return!0}function xx(e,n,s){lf(e)&&s.delete(n)}function GE(){a_=!1,ba!==null&&lf(ba)&&(ba=null),wa!==null&&lf(wa)&&(wa=null),Sa!==null&&lf(Sa)&&(Sa=null),Jh.forEach(xx),Qh.forEach(xx)}function Ih(e,n){e.blockedOn===n&&(e.blockedOn=null,a_||(a_=!0,Hi.unstable_scheduleCallback(Hi.unstable_NormalPriority,GE)))}function ed(e){function n(f){return Ih(f,e)}if(0<jp.length){Ih(jp[0],e);for(var s=1;s<jp.length;s++){var c=jp[s];c.blockedOn===e&&(c.blockedOn=null)}}for(ba!==null&&Ih(ba,e),wa!==null&&Ih(wa,e),Sa!==null&&Ih(Sa,e),Jh.forEach(n),Qh.forEach(n),s=0;s<ma.length;s++)c=ma[s],c.blockedOn===e&&(c.blockedOn=null);for(;0<ma.length&&(s=ma[0],s.blockedOn===null);)n2(s),s.blockedOn===null&&ma.shift()}var Hc=Os.ReactCurrentBatchConfig,Mf=!0;function ZE(e,n,s,c){var f=tr,x=Hc.transition;Hc.transition=null;try{tr=1,m0(e,n,s,c)}finally{tr=f,Hc.transition=x}}function KE(e,n,s,c){var f=tr,x=Hc.transition;Hc.transition=null;try{tr=4,m0(e,n,s,c)}finally{tr=f,Hc.transition=x}}function m0(e,n,s,c){if(Mf){var f=l_(e,n,s,c);if(f===null)Sy(e,n,c,zf,s),vx(e,c);else if(WE(f,e,n,s,c))c.stopPropagation();else if(vx(e,c),n&4&&-1<HE.indexOf(e)){for(;f!==null;){var x=xd(f);if(x!==null&&Qw(x),x=l_(e,n,s,c),x===null&&Sy(e,n,c,zf,s),x===f)break;f=x}f!==null&&c.stopPropagation()}else Sy(e,n,c,null,s)}}var zf=null;function l_(e,n,s,c){if(zf=null,e=h0(c),e=pl(e),e!==null)if(n=Il(e),n===null)e=null;else if(s=n.tag,s===13){if(e=Hw(n),e!==null)return e;e=null}else if(s===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;e=null}else n!==e&&(e=null);return zf=e,null}function i2(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(BE()){case d0:return 1;case Kw:return 4;case Af:case FE:return 16;case Xw:return 536870912;default:return 16}default:return 16}}var _a=null,g0=null,cf=null;function o2(){if(cf)return cf;var e,n=g0,s=n.length,c,f="value"in _a?_a.value:_a.textContent,x=f.length;for(e=0;e<s&&n[e]===f[e];e++);var v=s-e;for(c=1;c<=v&&n[s-c]===f[x-c];c++);return cf=f.slice(e,1<c?1-c:void 0)}function uf(e){var n=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&n===13&&(e=13)):e=n,e===10&&(e=13),32<=e||e===13?e:0}function Vp(){return!0}function bx(){return!1}function Gi(e){function n(s,c,f,x,v){this._reactName=s,this._targetInst=f,this.type=c,this.nativeEvent=x,this.target=v,this.currentTarget=null;for(var d in e)e.hasOwnProperty(d)&&(s=e[d],this[d]=s?s(x):x[d]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?Vp:bx,this.isPropagationStopped=bx,this}return Lr(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=Vp)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=Vp)},persist:function(){},isPersistent:Vp}),n}var lu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},y0=Gi(lu),vd=Lr({},lu,{view:0,detail:0}),XE=Gi(vd),fy,my,Eh,rm=Lr({},vd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_0,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Eh&&(Eh&&e.type==="mousemove"?(fy=e.screenX-Eh.screenX,my=e.screenY-Eh.screenY):my=fy=0,Eh=e),fy)},movementY:function(e){return"movementY"in e?e.movementY:my}}),wx=Gi(rm),YE=Lr({},rm,{dataTransfer:0}),JE=Gi(YE),QE=Lr({},vd,{relatedTarget:0}),gy=Gi(QE),ek=Lr({},lu,{animationName:0,elapsedTime:0,pseudoElement:0}),tk=Gi(ek),rk=Lr({},lu,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),nk=Gi(rk),ik=Lr({},lu,{data:0}),Sx=Gi(ik),ok={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},sk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ak={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function lk(e){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(e):(e=ak[e])?!!n[e]:!1}function _0(){return lk}var ck=Lr({},vd,{key:function(e){if(e.key){var n=ok[e.key]||e.key;if(n!=="Unidentified")return n}return e.type==="keypress"?(e=uf(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?sk[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_0,charCode:function(e){return e.type==="keypress"?uf(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?uf(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),uk=Gi(ck),hk=Lr({},rm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Tx=Gi(hk),dk=Lr({},vd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_0}),pk=Gi(dk),fk=Lr({},lu,{propertyName:0,elapsedTime:0,pseudoElement:0}),mk=Gi(fk),gk=Lr({},rm,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),yk=Gi(gk),_k=[9,13,27,32],v0=zs&&"CompositionEvent"in window,Uh=null;zs&&"documentMode"in document&&(Uh=document.documentMode);var vk=zs&&"TextEvent"in window&&!Uh,s2=zs&&(!v0||Uh&&8<Uh&&11>=Uh),Cx=" ",Ix=!1;function a2(e,n){switch(e){case"keyup":return _k.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function l2(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var zc=!1;function xk(e,n){switch(e){case"compositionend":return l2(n);case"keypress":return n.which!==32?null:(Ix=!0,Cx);case"textInput":return e=n.data,e===Cx&&Ix?null:e;default:return null}}function bk(e,n){if(zc)return e==="compositionend"||!v0&&a2(e,n)?(e=o2(),cf=g0=_a=null,zc=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return s2&&n.locale!=="ko"?null:n.data;default:return null}}var wk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ex(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n==="input"?!!wk[e.type]:n==="textarea"}function c2(e,n,s,c){$w(c),n=Lf(n,"onChange"),0<n.length&&(s=new y0("onChange","change",null,s,c),e.push({event:s,listeners:n}))}var jh=null,td=null;function Sk(e){x2(e,0)}function nm(e){var n=Dc(e);if(Lw(n))return e}function Tk(e,n){if(e==="change")return n}var u2=!1;if(zs){var yy;if(zs){var _y="oninput"in document;if(!_y){var kx=document.createElement("div");kx.setAttribute("oninput","return;"),_y=typeof kx.oninput=="function"}yy=_y}else yy=!1;u2=yy&&(!document.documentMode||9<document.documentMode)}function Ax(){jh&&(jh.detachEvent("onpropertychange",h2),td=jh=null)}function h2(e){if(e.propertyName==="value"&&nm(td)){var n=[];c2(n,td,e,h0(e)),qw(Sk,n)}}function Ck(e,n,s){e==="focusin"?(Ax(),jh=n,td=s,jh.attachEvent("onpropertychange",h2)):e==="focusout"&&Ax()}function Ik(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return nm(td)}function Ek(e,n){if(e==="click")return nm(n)}function kk(e,n){if(e==="input"||e==="change")return nm(n)}function Ak(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var Ro=typeof Object.is=="function"?Object.is:Ak;function rd(e,n){if(Ro(e,n))return!0;if(typeof e!="object"||e===null||typeof n!="object"||n===null)return!1;var s=Object.keys(e),c=Object.keys(n);if(s.length!==c.length)return!1;for(c=0;c<s.length;c++){var f=s[c];if(!qy.call(n,f)||!Ro(e[f],n[f]))return!1}return!0}function Px(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Mx(e,n){var s=Px(e);e=0;for(var c;s;){if(s.nodeType===3){if(c=e+s.textContent.length,e<=n&&c>=n)return{node:s,offset:n-e};e=c}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=Px(s)}}function d2(e,n){return e&&n?e===n?!0:e&&e.nodeType===3?!1:n&&n.nodeType===3?d2(e,n.parentNode):"contains"in e?e.contains(n):e.compareDocumentPosition?!!(e.compareDocumentPosition(n)&16):!1:!1}function p2(){for(var e=window,n=If();n instanceof e.HTMLIFrameElement;){try{var s=typeof n.contentWindow.location.href=="string"}catch{s=!1}if(s)e=n.contentWindow;else break;n=If(e.document)}return n}function x0(e){var n=e&&e.nodeName&&e.nodeName.toLowerCase();return n&&(n==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||n==="textarea"||e.contentEditable==="true")}function Pk(e){var n=p2(),s=e.focusedElem,c=e.selectionRange;if(n!==s&&s&&s.ownerDocument&&d2(s.ownerDocument.documentElement,s)){if(c!==null&&x0(s)){if(n=c.start,e=c.end,e===void 0&&(e=n),"selectionStart"in s)s.selectionStart=n,s.selectionEnd=Math.min(e,s.value.length);else if(e=(n=s.ownerDocument||document)&&n.defaultView||window,e.getSelection){e=e.getSelection();var f=s.textContent.length,x=Math.min(c.start,f);c=c.end===void 0?x:Math.min(c.end,f),!e.extend&&x>c&&(f=c,c=x,x=f),f=Mx(s,x);var v=Mx(s,c);f&&v&&(e.rangeCount!==1||e.anchorNode!==f.node||e.anchorOffset!==f.offset||e.focusNode!==v.node||e.focusOffset!==v.offset)&&(n=n.createRange(),n.setStart(f.node,f.offset),e.removeAllRanges(),x>c?(e.addRange(n),e.extend(v.node,v.offset)):(n.setEnd(v.node,v.offset),e.addRange(n)))}}for(n=[],e=s;e=e.parentNode;)e.nodeType===1&&n.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<n.length;s++)e=n[s],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Mk=zs&&"documentMode"in document&&11>=document.documentMode,Lc=null,c_=null,Vh=null,u_=!1;function zx(e,n,s){var c=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;u_||Lc==null||Lc!==If(c)||(c=Lc,"selectionStart"in c&&x0(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Vh&&rd(Vh,c)||(Vh=c,c=Lf(c_,"onSelect"),0<c.length&&(n=new y0("onSelect","select",null,n,s),e.push({event:n,listeners:c}),n.target=Lc)))}function qp(e,n){var s={};return s[e.toLowerCase()]=n.toLowerCase(),s["Webkit"+e]="webkit"+n,s["Moz"+e]="moz"+n,s}var Rc={animationend:qp("Animation","AnimationEnd"),animationiteration:qp("Animation","AnimationIteration"),animationstart:qp("Animation","AnimationStart"),transitionend:qp("Transition","TransitionEnd")},vy={},f2={};zs&&(f2=document.createElement("div").style,"AnimationEvent"in window||(delete Rc.animationend.animation,delete Rc.animationiteration.animation,delete Rc.animationstart.animation),"TransitionEvent"in window||delete Rc.transitionend.transition);function im(e){if(vy[e])return vy[e];if(!Rc[e])return e;var n=Rc[e],s;for(s in n)if(n.hasOwnProperty(s)&&s in f2)return vy[e]=n[s];return e}var m2=im("animationend"),g2=im("animationiteration"),y2=im("animationstart"),_2=im("transitionend"),v2=new Map,Lx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ma(e,n){v2.set(e,n),Cl(n,[e])}for(var xy=0;xy<Lx.length;xy++){var by=Lx[xy],zk=by.toLowerCase(),Lk=by[0].toUpperCase()+by.slice(1);Ma(zk,"on"+Lk)}Ma(m2,"onAnimationEnd");Ma(g2,"onAnimationIteration");Ma(y2,"onAnimationStart");Ma("dblclick","onDoubleClick");Ma("focusin","onFocus");Ma("focusout","onBlur");Ma(_2,"onTransitionEnd");Qc("onMouseEnter",["mouseout","mouseover"]);Qc("onMouseLeave",["mouseout","mouseover"]);Qc("onPointerEnter",["pointerout","pointerover"]);Qc("onPointerLeave",["pointerout","pointerover"]);Cl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Cl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Cl("onBeforeInput",["compositionend","keypress","textInput","paste"]);Cl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Cl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Cl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Rk=new Set("cancel close invalid load scroll toggle".split(" ").concat(Bh));function Rx(e,n,s){var c=e.type||"unknown-event";e.currentTarget=s,zE(c,n,void 0,e),e.currentTarget=null}function x2(e,n){n=(n&4)!==0;for(var s=0;s<e.length;s++){var c=e[s],f=c.event;c=c.listeners;e:{var x=void 0;if(n)for(var v=c.length-1;0<=v;v--){var d=c[v],L=d.instance,U=d.currentTarget;if(d=d.listener,L!==x&&f.isPropagationStopped())break e;Rx(f,d,U),x=L}else for(v=0;v<c.length;v++){if(d=c[v],L=d.instance,U=d.currentTarget,d=d.listener,L!==x&&f.isPropagationStopped())break e;Rx(f,d,U),x=L}}}if(kf)throw e=o_,kf=!1,o_=null,e}function yr(e,n){var s=n[m_];s===void 0&&(s=n[m_]=new Set);var c=e+"__bubble";s.has(c)||(b2(n,e,2,!1),s.add(c))}function wy(e,n,s){var c=0;n&&(c|=4),b2(s,e,c,n)}var Hp="_reactListening"+Math.random().toString(36).slice(2);function nd(e){if(!e[Hp]){e[Hp]=!0,kw.forEach(function(s){s!=="selectionchange"&&(Rk.has(s)||wy(s,!1,e),wy(s,!0,e))});var n=e.nodeType===9?e:e.ownerDocument;n===null||n[Hp]||(n[Hp]=!0,wy("selectionchange",!1,n))}}function b2(e,n,s,c){switch(i2(n)){case 1:var f=ZE;break;case 4:f=KE;break;default:f=m0}s=f.bind(null,n,s,e),f=void 0,!i_||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(f=!0),c?f!==void 0?e.addEventListener(n,s,{capture:!0,passive:f}):e.addEventListener(n,s,!0):f!==void 0?e.addEventListener(n,s,{passive:f}):e.addEventListener(n,s,!1)}function Sy(e,n,s,c,f){var x=c;if(!(n&1)&&!(n&2)&&c!==null)e:for(;;){if(c===null)return;var v=c.tag;if(v===3||v===4){var d=c.stateNode.containerInfo;if(d===f||d.nodeType===8&&d.parentNode===f)break;if(v===4)for(v=c.return;v!==null;){var L=v.tag;if((L===3||L===4)&&(L=v.stateNode.containerInfo,L===f||L.nodeType===8&&L.parentNode===f))return;v=v.return}for(;d!==null;){if(v=pl(d),v===null)return;if(L=v.tag,L===5||L===6){c=x=v;continue e}d=d.parentNode}}c=c.return}qw(function(){var U=x,Z=h0(s),j=[];e:{var F=v2.get(e);if(F!==void 0){var me=y0,ye=e;switch(e){case"keypress":if(uf(s)===0)break e;case"keydown":case"keyup":me=uk;break;case"focusin":ye="focus",me=gy;break;case"focusout":ye="blur",me=gy;break;case"beforeblur":case"afterblur":me=gy;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":me=wx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":me=JE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":me=pk;break;case m2:case g2:case y2:me=tk;break;case _2:me=mk;break;case"scroll":me=XE;break;case"wheel":me=yk;break;case"copy":case"cut":case"paste":me=nk;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":me=Tx}var pe=(n&4)!==0,je=!pe&&e==="scroll",re=pe?F!==null?F+"Capture":null:F;pe=[];for(var ee=U,ae;ee!==null;){ae=ee;var xe=ae.stateNode;if(ae.tag===5&&xe!==null&&(ae=xe,re!==null&&(xe=Yh(ee,re),xe!=null&&pe.push(id(ee,xe,ae)))),je)break;ee=ee.return}0<pe.length&&(F=new me(F,ye,null,s,Z),j.push({event:F,listeners:pe}))}}if(!(n&7)){e:{if(F=e==="mouseover"||e==="pointerover",me=e==="mouseout"||e==="pointerout",F&&s!==r_&&(ye=s.relatedTarget||s.fromElement)&&(pl(ye)||ye[Ls]))break e;if((me||F)&&(F=Z.window===Z?Z:(F=Z.ownerDocument)?F.defaultView||F.parentWindow:window,me?(ye=s.relatedTarget||s.toElement,me=U,ye=ye?pl(ye):null,ye!==null&&(je=Il(ye),ye!==je||ye.tag!==5&&ye.tag!==6)&&(ye=null)):(me=null,ye=U),me!==ye)){if(pe=wx,xe="onMouseLeave",re="onMouseEnter",ee="mouse",(e==="pointerout"||e==="pointerover")&&(pe=Tx,xe="onPointerLeave",re="onPointerEnter",ee="pointer"),je=me==null?F:Dc(me),ae=ye==null?F:Dc(ye),F=new pe(xe,ee+"leave",me,s,Z),F.target=je,F.relatedTarget=ae,xe=null,pl(Z)===U&&(pe=new pe(re,ee+"enter",ye,s,Z),pe.target=ae,pe.relatedTarget=je,xe=pe),je=xe,me&&ye)t:{for(pe=me,re=ye,ee=0,ae=pe;ae;ae=Sc(ae))ee++;for(ae=0,xe=re;xe;xe=Sc(xe))ae++;for(;0<ee-ae;)pe=Sc(pe),ee--;for(;0<ae-ee;)re=Sc(re),ae--;for(;ee--;){if(pe===re||re!==null&&pe===re.alternate)break t;pe=Sc(pe),re=Sc(re)}pe=null}else pe=null;me!==null&&Dx(j,F,me,pe,!1),ye!==null&&je!==null&&Dx(j,je,ye,pe,!0)}}e:{if(F=U?Dc(U):window,me=F.nodeName&&F.nodeName.toLowerCase(),me==="select"||me==="input"&&F.type==="file")var Ee=Tk;else if(Ex(F))if(u2)Ee=kk;else{Ee=Ik;var Pe=Ck}else(me=F.nodeName)&&me.toLowerCase()==="input"&&(F.type==="checkbox"||F.type==="radio")&&(Ee=Ek);if(Ee&&(Ee=Ee(e,U))){c2(j,Ee,s,Z);break e}Pe&&Pe(e,F,U),e==="focusout"&&(Pe=F._wrapperState)&&Pe.controlled&&F.type==="number"&&Yy(F,"number",F.value)}switch(Pe=U?Dc(U):window,e){case"focusin":(Ex(Pe)||Pe.contentEditable==="true")&&(Lc=Pe,c_=U,Vh=null);break;case"focusout":Vh=c_=Lc=null;break;case"mousedown":u_=!0;break;case"contextmenu":case"mouseup":case"dragend":u_=!1,zx(j,s,Z);break;case"selectionchange":if(Mk)break;case"keydown":case"keyup":zx(j,s,Z)}var Ae;if(v0)e:{switch(e){case"compositionstart":var Ke="onCompositionStart";break e;case"compositionend":Ke="onCompositionEnd";break e;case"compositionupdate":Ke="onCompositionUpdate";break e}Ke=void 0}else zc?a2(e,s)&&(Ke="onCompositionEnd"):e==="keydown"&&s.keyCode===229&&(Ke="onCompositionStart");Ke&&(s2&&s.locale!=="ko"&&(zc||Ke!=="onCompositionStart"?Ke==="onCompositionEnd"&&zc&&(Ae=o2()):(_a=Z,g0="value"in _a?_a.value:_a.textContent,zc=!0)),Pe=Lf(U,Ke),0<Pe.length&&(Ke=new Sx(Ke,e,null,s,Z),j.push({event:Ke,listeners:Pe}),Ae?Ke.data=Ae:(Ae=l2(s),Ae!==null&&(Ke.data=Ae)))),(Ae=vk?xk(e,s):bk(e,s))&&(U=Lf(U,"onBeforeInput"),0<U.length&&(Z=new Sx("onBeforeInput","beforeinput",null,s,Z),j.push({event:Z,listeners:U}),Z.data=Ae))}x2(j,n)})}function id(e,n,s){return{instance:e,listener:n,currentTarget:s}}function Lf(e,n){for(var s=n+"Capture",c=[];e!==null;){var f=e,x=f.stateNode;f.tag===5&&x!==null&&(f=x,x=Yh(e,s),x!=null&&c.unshift(id(e,x,f)),x=Yh(e,n),x!=null&&c.push(id(e,x,f))),e=e.return}return c}function Sc(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Dx(e,n,s,c,f){for(var x=n._reactName,v=[];s!==null&&s!==c;){var d=s,L=d.alternate,U=d.stateNode;if(L!==null&&L===c)break;d.tag===5&&U!==null&&(d=U,f?(L=Yh(s,x),L!=null&&v.unshift(id(s,L,d))):f||(L=Yh(s,x),L!=null&&v.push(id(s,L,d)))),s=s.return}v.length!==0&&e.push({event:n,listeners:v})}var Dk=/\r\n?/g,Bk=/\u0000|\uFFFD/g;function Bx(e){return(typeof e=="string"?e:""+e).replace(Dk,`
`).replace(Bk,"")}function Wp(e,n,s){if(n=Bx(n),Bx(e)!==n&&s)throw Error(Be(425))}function Rf(){}var h_=null,d_=null;function p_(e,n){return e==="textarea"||e==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var f_=typeof setTimeout=="function"?setTimeout:void 0,Fk=typeof clearTimeout=="function"?clearTimeout:void 0,Fx=typeof Promise=="function"?Promise:void 0,Ok=typeof queueMicrotask=="function"?queueMicrotask:typeof Fx<"u"?function(e){return Fx.resolve(null).then(e).catch(Nk)}:f_;function Nk(e){setTimeout(function(){throw e})}function Ty(e,n){var s=n,c=0;do{var f=s.nextSibling;if(e.removeChild(s),f&&f.nodeType===8)if(s=f.data,s==="/$"){if(c===0){e.removeChild(f),ed(n);return}c--}else s!=="$"&&s!=="$?"&&s!=="$!"||c++;s=f}while(s);ed(n)}function Ta(e){for(;e!=null;e=e.nextSibling){var n=e.nodeType;if(n===1||n===3)break;if(n===8){if(n=e.data,n==="$"||n==="$!"||n==="$?")break;if(n==="/$")return null}}return e}function Ox(e){e=e.previousSibling;for(var n=0;e;){if(e.nodeType===8){var s=e.data;if(s==="$"||s==="$!"||s==="$?"){if(n===0)return e;n--}else s==="/$"&&n++}e=e.previousSibling}return null}var cu=Math.random().toString(36).slice(2),ts="__reactFiber$"+cu,od="__reactProps$"+cu,Ls="__reactContainer$"+cu,m_="__reactEvents$"+cu,$k="__reactListeners$"+cu,Uk="__reactHandles$"+cu;function pl(e){var n=e[ts];if(n)return n;for(var s=e.parentNode;s;){if(n=s[Ls]||s[ts]){if(s=n.alternate,n.child!==null||s!==null&&s.child!==null)for(e=Ox(e);e!==null;){if(s=e[ts])return s;e=Ox(e)}return n}e=s,s=e.parentNode}return null}function xd(e){return e=e[ts]||e[Ls],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Dc(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Be(33))}function om(e){return e[od]||null}var g_=[],Bc=-1;function za(e){return{current:e}}function _r(e){0>Bc||(e.current=g_[Bc],g_[Bc]=null,Bc--)}function fr(e,n){Bc++,g_[Bc]=e.current,e.current=n}var Pa={},Qn=za(Pa),Si=za(!1),xl=Pa;function eu(e,n){var s=e.type.contextTypes;if(!s)return Pa;var c=e.stateNode;if(c&&c.__reactInternalMemoizedUnmaskedChildContext===n)return c.__reactInternalMemoizedMaskedChildContext;var f={},x;for(x in s)f[x]=n[x];return c&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=f),f}function Ti(e){return e=e.childContextTypes,e!=null}function Df(){_r(Si),_r(Qn)}function Nx(e,n,s){if(Qn.current!==Pa)throw Error(Be(168));fr(Qn,n),fr(Si,s)}function w2(e,n,s){var c=e.stateNode;if(n=n.childContextTypes,typeof c.getChildContext!="function")return s;c=c.getChildContext();for(var f in c)if(!(f in n))throw Error(Be(108,CE(e)||"Unknown",f));return Lr({},s,c)}function Bf(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Pa,xl=Qn.current,fr(Qn,e),fr(Si,Si.current),!0}function $x(e,n,s){var c=e.stateNode;if(!c)throw Error(Be(169));s?(e=w2(e,n,xl),c.__reactInternalMemoizedMergedChildContext=e,_r(Si),_r(Qn),fr(Qn,e)):_r(Si),fr(Si,s)}var ks=null,sm=!1,Cy=!1;function S2(e){ks===null?ks=[e]:ks.push(e)}function jk(e){sm=!0,S2(e)}function La(){if(!Cy&&ks!==null){Cy=!0;var e=0,n=tr;try{var s=ks;for(tr=1;e<s.length;e++){var c=s[e];do c=c(!0);while(c!==null)}ks=null,sm=!1}catch(f){throw ks!==null&&(ks=ks.slice(e+1)),Zw(d0,La),f}finally{tr=n,Cy=!1}}return null}var Fc=[],Oc=0,Ff=null,Of=0,ao=[],lo=0,bl=null,As=1,Ps="";function cl(e,n){Fc[Oc++]=Of,Fc[Oc++]=Ff,Ff=e,Of=n}function T2(e,n,s){ao[lo++]=As,ao[lo++]=Ps,ao[lo++]=bl,bl=e;var c=As;e=Ps;var f=32-zo(c)-1;c&=~(1<<f),s+=1;var x=32-zo(n)+f;if(30<x){var v=f-f%5;x=(c&(1<<v)-1).toString(32),c>>=v,f-=v,As=1<<32-zo(n)+f|s<<f|c,Ps=x+e}else As=1<<x|s<<f|c,Ps=e}function b0(e){e.return!==null&&(cl(e,1),T2(e,1,0))}function w0(e){for(;e===Ff;)Ff=Fc[--Oc],Fc[Oc]=null,Of=Fc[--Oc],Fc[Oc]=null;for(;e===bl;)bl=ao[--lo],ao[lo]=null,Ps=ao[--lo],ao[lo]=null,As=ao[--lo],ao[lo]=null}var Vi=null,ji=null,Er=!1,Mo=null;function C2(e,n){var s=uo(5,null,null,0);s.elementType="DELETED",s.stateNode=n,s.return=e,n=e.deletions,n===null?(e.deletions=[s],e.flags|=16):n.push(s)}function Ux(e,n){switch(e.tag){case 5:var s=e.type;return n=n.nodeType!==1||s.toLowerCase()!==n.nodeName.toLowerCase()?null:n,n!==null?(e.stateNode=n,Vi=e,ji=Ta(n.firstChild),!0):!1;case 6:return n=e.pendingProps===""||n.nodeType!==3?null:n,n!==null?(e.stateNode=n,Vi=e,ji=null,!0):!1;case 13:return n=n.nodeType!==8?null:n,n!==null?(s=bl!==null?{id:As,overflow:Ps}:null,e.memoizedState={dehydrated:n,treeContext:s,retryLane:1073741824},s=uo(18,null,null,0),s.stateNode=n,s.return=e,e.child=s,Vi=e,ji=null,!0):!1;default:return!1}}function y_(e){return(e.mode&1)!==0&&(e.flags&128)===0}function __(e){if(Er){var n=ji;if(n){var s=n;if(!Ux(e,n)){if(y_(e))throw Error(Be(418));n=Ta(s.nextSibling);var c=Vi;n&&Ux(e,n)?C2(c,s):(e.flags=e.flags&-4097|2,Er=!1,Vi=e)}}else{if(y_(e))throw Error(Be(418));e.flags=e.flags&-4097|2,Er=!1,Vi=e}}}function jx(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Vi=e}function Gp(e){if(e!==Vi)return!1;if(!Er)return jx(e),Er=!0,!1;var n;if((n=e.tag!==3)&&!(n=e.tag!==5)&&(n=e.type,n=n!=="head"&&n!=="body"&&!p_(e.type,e.memoizedProps)),n&&(n=ji)){if(y_(e))throw I2(),Error(Be(418));for(;n;)C2(e,n),n=Ta(n.nextSibling)}if(jx(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Be(317));e:{for(e=e.nextSibling,n=0;e;){if(e.nodeType===8){var s=e.data;if(s==="/$"){if(n===0){ji=Ta(e.nextSibling);break e}n--}else s!=="$"&&s!=="$!"&&s!=="$?"||n++}e=e.nextSibling}ji=null}}else ji=Vi?Ta(e.stateNode.nextSibling):null;return!0}function I2(){for(var e=ji;e;)e=Ta(e.nextSibling)}function tu(){ji=Vi=null,Er=!1}function S0(e){Mo===null?Mo=[e]:Mo.push(e)}var Vk=Os.ReactCurrentBatchConfig;function kh(e,n,s){if(e=s.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(Be(309));var c=s.stateNode}if(!c)throw Error(Be(147,e));var f=c,x=""+e;return n!==null&&n.ref!==null&&typeof n.ref=="function"&&n.ref._stringRef===x?n.ref:(n=function(v){var d=f.refs;v===null?delete d[x]:d[x]=v},n._stringRef=x,n)}if(typeof e!="string")throw Error(Be(284));if(!s._owner)throw Error(Be(290,e))}return e}function Zp(e,n){throw e=Object.prototype.toString.call(n),Error(Be(31,e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e))}function Vx(e){var n=e._init;return n(e._payload)}function E2(e){function n(re,ee){if(e){var ae=re.deletions;ae===null?(re.deletions=[ee],re.flags|=16):ae.push(ee)}}function s(re,ee){if(!e)return null;for(;ee!==null;)n(re,ee),ee=ee.sibling;return null}function c(re,ee){for(re=new Map;ee!==null;)ee.key!==null?re.set(ee.key,ee):re.set(ee.index,ee),ee=ee.sibling;return re}function f(re,ee){return re=ka(re,ee),re.index=0,re.sibling=null,re}function x(re,ee,ae){return re.index=ae,e?(ae=re.alternate,ae!==null?(ae=ae.index,ae<ee?(re.flags|=2,ee):ae):(re.flags|=2,ee)):(re.flags|=1048576,ee)}function v(re){return e&&re.alternate===null&&(re.flags|=2),re}function d(re,ee,ae,xe){return ee===null||ee.tag!==6?(ee=zy(ae,re.mode,xe),ee.return=re,ee):(ee=f(ee,ae),ee.return=re,ee)}function L(re,ee,ae,xe){var Ee=ae.type;return Ee===Mc?Z(re,ee,ae.props.children,xe,ae.key):ee!==null&&(ee.elementType===Ee||typeof Ee=="object"&&Ee!==null&&Ee.$$typeof===pa&&Vx(Ee)===ee.type)?(xe=f(ee,ae.props),xe.ref=kh(re,ee,ae),xe.return=re,xe):(xe=yf(ae.type,ae.key,ae.props,null,re.mode,xe),xe.ref=kh(re,ee,ae),xe.return=re,xe)}function U(re,ee,ae,xe){return ee===null||ee.tag!==4||ee.stateNode.containerInfo!==ae.containerInfo||ee.stateNode.implementation!==ae.implementation?(ee=Ly(ae,re.mode,xe),ee.return=re,ee):(ee=f(ee,ae.children||[]),ee.return=re,ee)}function Z(re,ee,ae,xe,Ee){return ee===null||ee.tag!==7?(ee=_l(ae,re.mode,xe,Ee),ee.return=re,ee):(ee=f(ee,ae),ee.return=re,ee)}function j(re,ee,ae){if(typeof ee=="string"&&ee!==""||typeof ee=="number")return ee=zy(""+ee,re.mode,ae),ee.return=re,ee;if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case Fp:return ae=yf(ee.type,ee.key,ee.props,null,re.mode,ae),ae.ref=kh(re,null,ee),ae.return=re,ae;case Pc:return ee=Ly(ee,re.mode,ae),ee.return=re,ee;case pa:var xe=ee._init;return j(re,xe(ee._payload),ae)}if(Rh(ee)||Sh(ee))return ee=_l(ee,re.mode,ae,null),ee.return=re,ee;Zp(re,ee)}return null}function F(re,ee,ae,xe){var Ee=ee!==null?ee.key:null;if(typeof ae=="string"&&ae!==""||typeof ae=="number")return Ee!==null?null:d(re,ee,""+ae,xe);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case Fp:return ae.key===Ee?L(re,ee,ae,xe):null;case Pc:return ae.key===Ee?U(re,ee,ae,xe):null;case pa:return Ee=ae._init,F(re,ee,Ee(ae._payload),xe)}if(Rh(ae)||Sh(ae))return Ee!==null?null:Z(re,ee,ae,xe,null);Zp(re,ae)}return null}function me(re,ee,ae,xe,Ee){if(typeof xe=="string"&&xe!==""||typeof xe=="number")return re=re.get(ae)||null,d(ee,re,""+xe,Ee);if(typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case Fp:return re=re.get(xe.key===null?ae:xe.key)||null,L(ee,re,xe,Ee);case Pc:return re=re.get(xe.key===null?ae:xe.key)||null,U(ee,re,xe,Ee);case pa:var Pe=xe._init;return me(re,ee,ae,Pe(xe._payload),Ee)}if(Rh(xe)||Sh(xe))return re=re.get(ae)||null,Z(ee,re,xe,Ee,null);Zp(ee,xe)}return null}function ye(re,ee,ae,xe){for(var Ee=null,Pe=null,Ae=ee,Ke=ee=0,vt=null;Ae!==null&&Ke<ae.length;Ke++){Ae.index>Ke?(vt=Ae,Ae=null):vt=Ae.sibling;var ot=F(re,Ae,ae[Ke],xe);if(ot===null){Ae===null&&(Ae=vt);break}e&&Ae&&ot.alternate===null&&n(re,Ae),ee=x(ot,ee,Ke),Pe===null?Ee=ot:Pe.sibling=ot,Pe=ot,Ae=vt}if(Ke===ae.length)return s(re,Ae),Er&&cl(re,Ke),Ee;if(Ae===null){for(;Ke<ae.length;Ke++)Ae=j(re,ae[Ke],xe),Ae!==null&&(ee=x(Ae,ee,Ke),Pe===null?Ee=Ae:Pe.sibling=Ae,Pe=Ae);return Er&&cl(re,Ke),Ee}for(Ae=c(re,Ae);Ke<ae.length;Ke++)vt=me(Ae,re,Ke,ae[Ke],xe),vt!==null&&(e&&vt.alternate!==null&&Ae.delete(vt.key===null?Ke:vt.key),ee=x(vt,ee,Ke),Pe===null?Ee=vt:Pe.sibling=vt,Pe=vt);return e&&Ae.forEach(function(st){return n(re,st)}),Er&&cl(re,Ke),Ee}function pe(re,ee,ae,xe){var Ee=Sh(ae);if(typeof Ee!="function")throw Error(Be(150));if(ae=Ee.call(ae),ae==null)throw Error(Be(151));for(var Pe=Ee=null,Ae=ee,Ke=ee=0,vt=null,ot=ae.next();Ae!==null&&!ot.done;Ke++,ot=ae.next()){Ae.index>Ke?(vt=Ae,Ae=null):vt=Ae.sibling;var st=F(re,Ae,ot.value,xe);if(st===null){Ae===null&&(Ae=vt);break}e&&Ae&&st.alternate===null&&n(re,Ae),ee=x(st,ee,Ke),Pe===null?Ee=st:Pe.sibling=st,Pe=st,Ae=vt}if(ot.done)return s(re,Ae),Er&&cl(re,Ke),Ee;if(Ae===null){for(;!ot.done;Ke++,ot=ae.next())ot=j(re,ot.value,xe),ot!==null&&(ee=x(ot,ee,Ke),Pe===null?Ee=ot:Pe.sibling=ot,Pe=ot);return Er&&cl(re,Ke),Ee}for(Ae=c(re,Ae);!ot.done;Ke++,ot=ae.next())ot=me(Ae,re,Ke,ot.value,xe),ot!==null&&(e&&ot.alternate!==null&&Ae.delete(ot.key===null?Ke:ot.key),ee=x(ot,ee,Ke),Pe===null?Ee=ot:Pe.sibling=ot,Pe=ot);return e&&Ae.forEach(function(Ft){return n(re,Ft)}),Er&&cl(re,Ke),Ee}function je(re,ee,ae,xe){if(typeof ae=="object"&&ae!==null&&ae.type===Mc&&ae.key===null&&(ae=ae.props.children),typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case Fp:e:{for(var Ee=ae.key,Pe=ee;Pe!==null;){if(Pe.key===Ee){if(Ee=ae.type,Ee===Mc){if(Pe.tag===7){s(re,Pe.sibling),ee=f(Pe,ae.props.children),ee.return=re,re=ee;break e}}else if(Pe.elementType===Ee||typeof Ee=="object"&&Ee!==null&&Ee.$$typeof===pa&&Vx(Ee)===Pe.type){s(re,Pe.sibling),ee=f(Pe,ae.props),ee.ref=kh(re,Pe,ae),ee.return=re,re=ee;break e}s(re,Pe);break}else n(re,Pe);Pe=Pe.sibling}ae.type===Mc?(ee=_l(ae.props.children,re.mode,xe,ae.key),ee.return=re,re=ee):(xe=yf(ae.type,ae.key,ae.props,null,re.mode,xe),xe.ref=kh(re,ee,ae),xe.return=re,re=xe)}return v(re);case Pc:e:{for(Pe=ae.key;ee!==null;){if(ee.key===Pe)if(ee.tag===4&&ee.stateNode.containerInfo===ae.containerInfo&&ee.stateNode.implementation===ae.implementation){s(re,ee.sibling),ee=f(ee,ae.children||[]),ee.return=re,re=ee;break e}else{s(re,ee);break}else n(re,ee);ee=ee.sibling}ee=Ly(ae,re.mode,xe),ee.return=re,re=ee}return v(re);case pa:return Pe=ae._init,je(re,ee,Pe(ae._payload),xe)}if(Rh(ae))return ye(re,ee,ae,xe);if(Sh(ae))return pe(re,ee,ae,xe);Zp(re,ae)}return typeof ae=="string"&&ae!==""||typeof ae=="number"?(ae=""+ae,ee!==null&&ee.tag===6?(s(re,ee.sibling),ee=f(ee,ae),ee.return=re,re=ee):(s(re,ee),ee=zy(ae,re.mode,xe),ee.return=re,re=ee),v(re)):s(re,ee)}return je}var ru=E2(!0),k2=E2(!1),Nf=za(null),$f=null,Nc=null,T0=null;function C0(){T0=Nc=$f=null}function I0(e){var n=Nf.current;_r(Nf),e._currentValue=n}function v_(e,n,s){for(;e!==null;){var c=e.alternate;if((e.childLanes&n)!==n?(e.childLanes|=n,c!==null&&(c.childLanes|=n)):c!==null&&(c.childLanes&n)!==n&&(c.childLanes|=n),e===s)break;e=e.return}}function Wc(e,n){$f=e,T0=Nc=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&n&&(wi=!0),e.firstContext=null)}function po(e){var n=e._currentValue;if(T0!==e)if(e={context:e,memoizedValue:n,next:null},Nc===null){if($f===null)throw Error(Be(308));Nc=e,$f.dependencies={lanes:0,firstContext:e}}else Nc=Nc.next=e;return n}var fl=null;function E0(e){fl===null?fl=[e]:fl.push(e)}function A2(e,n,s,c){var f=n.interleaved;return f===null?(s.next=s,E0(n)):(s.next=f.next,f.next=s),n.interleaved=s,Rs(e,c)}function Rs(e,n){e.lanes|=n;var s=e.alternate;for(s!==null&&(s.lanes|=n),s=e,e=e.return;e!==null;)e.childLanes|=n,s=e.alternate,s!==null&&(s.childLanes|=n),s=e,e=e.return;return s.tag===3?s.stateNode:null}var fa=!1;function k0(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function P2(e,n){e=e.updateQueue,n.updateQueue===e&&(n.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ms(e,n){return{eventTime:e,lane:n,tag:0,payload:null,callback:null,next:null}}function Ca(e,n,s){var c=e.updateQueue;if(c===null)return null;if(c=c.shared,jt&2){var f=c.pending;return f===null?n.next=n:(n.next=f.next,f.next=n),c.pending=n,Rs(e,s)}return f=c.interleaved,f===null?(n.next=n,E0(c)):(n.next=f.next,f.next=n),c.interleaved=n,Rs(e,s)}function hf(e,n,s){if(n=n.updateQueue,n!==null&&(n=n.shared,(s&4194240)!==0)){var c=n.lanes;c&=e.pendingLanes,s|=c,n.lanes=s,p0(e,s)}}function qx(e,n){var s=e.updateQueue,c=e.alternate;if(c!==null&&(c=c.updateQueue,s===c)){var f=null,x=null;if(s=s.firstBaseUpdate,s!==null){do{var v={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};x===null?f=x=v:x=x.next=v,s=s.next}while(s!==null);x===null?f=x=n:x=x.next=n}else f=x=n;s={baseState:c.baseState,firstBaseUpdate:f,lastBaseUpdate:x,shared:c.shared,effects:c.effects},e.updateQueue=s;return}e=s.lastBaseUpdate,e===null?s.firstBaseUpdate=n:e.next=n,s.lastBaseUpdate=n}function Uf(e,n,s,c){var f=e.updateQueue;fa=!1;var x=f.firstBaseUpdate,v=f.lastBaseUpdate,d=f.shared.pending;if(d!==null){f.shared.pending=null;var L=d,U=L.next;L.next=null,v===null?x=U:v.next=U,v=L;var Z=e.alternate;Z!==null&&(Z=Z.updateQueue,d=Z.lastBaseUpdate,d!==v&&(d===null?Z.firstBaseUpdate=U:d.next=U,Z.lastBaseUpdate=L))}if(x!==null){var j=f.baseState;v=0,Z=U=L=null,d=x;do{var F=d.lane,me=d.eventTime;if((c&F)===F){Z!==null&&(Z=Z.next={eventTime:me,lane:0,tag:d.tag,payload:d.payload,callback:d.callback,next:null});e:{var ye=e,pe=d;switch(F=n,me=s,pe.tag){case 1:if(ye=pe.payload,typeof ye=="function"){j=ye.call(me,j,F);break e}j=ye;break e;case 3:ye.flags=ye.flags&-65537|128;case 0:if(ye=pe.payload,F=typeof ye=="function"?ye.call(me,j,F):ye,F==null)break e;j=Lr({},j,F);break e;case 2:fa=!0}}d.callback!==null&&d.lane!==0&&(e.flags|=64,F=f.effects,F===null?f.effects=[d]:F.push(d))}else me={eventTime:me,lane:F,tag:d.tag,payload:d.payload,callback:d.callback,next:null},Z===null?(U=Z=me,L=j):Z=Z.next=me,v|=F;if(d=d.next,d===null){if(d=f.shared.pending,d===null)break;F=d,d=F.next,F.next=null,f.lastBaseUpdate=F,f.shared.pending=null}}while(!0);if(Z===null&&(L=j),f.baseState=L,f.firstBaseUpdate=U,f.lastBaseUpdate=Z,n=f.shared.interleaved,n!==null){f=n;do v|=f.lane,f=f.next;while(f!==n)}else x===null&&(f.shared.lanes=0);Sl|=v,e.lanes=v,e.memoizedState=j}}function Hx(e,n,s){if(e=n.effects,n.effects=null,e!==null)for(n=0;n<e.length;n++){var c=e[n],f=c.callback;if(f!==null){if(c.callback=null,c=s,typeof f!="function")throw Error(Be(191,f));f.call(c)}}}var bd={},is=za(bd),sd=za(bd),ad=za(bd);function ml(e){if(e===bd)throw Error(Be(174));return e}function A0(e,n){switch(fr(ad,n),fr(sd,e),fr(is,bd),e=n.nodeType,e){case 9:case 11:n=(n=n.documentElement)?n.namespaceURI:Qy(null,"");break;default:e=e===8?n.parentNode:n,n=e.namespaceURI||null,e=e.tagName,n=Qy(n,e)}_r(is),fr(is,n)}function nu(){_r(is),_r(sd),_r(ad)}function M2(e){ml(ad.current);var n=ml(is.current),s=Qy(n,e.type);n!==s&&(fr(sd,e),fr(is,s))}function P0(e){sd.current===e&&(_r(is),_r(sd))}var Mr=za(0);function jf(e){for(var n=e;n!==null;){if(n.tag===13){var s=n.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if(n.flags&128)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var Iy=[];function M0(){for(var e=0;e<Iy.length;e++)Iy[e]._workInProgressVersionPrimary=null;Iy.length=0}var df=Os.ReactCurrentDispatcher,Ey=Os.ReactCurrentBatchConfig,wl=0,zr=null,ln=null,bn=null,Vf=!1,qh=!1,ld=0,qk=0;function Kn(){throw Error(Be(321))}function z0(e,n){if(n===null)return!1;for(var s=0;s<n.length&&s<e.length;s++)if(!Ro(e[s],n[s]))return!1;return!0}function L0(e,n,s,c,f,x){if(wl=x,zr=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,df.current=e===null||e.memoizedState===null?Zk:Kk,e=s(c,f),qh){x=0;do{if(qh=!1,ld=0,25<=x)throw Error(Be(301));x+=1,bn=ln=null,n.updateQueue=null,df.current=Xk,e=s(c,f)}while(qh)}if(df.current=qf,n=ln!==null&&ln.next!==null,wl=0,bn=ln=zr=null,Vf=!1,n)throw Error(Be(300));return e}function R0(){var e=ld!==0;return ld=0,e}function Jo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return bn===null?zr.memoizedState=bn=e:bn=bn.next=e,bn}function fo(){if(ln===null){var e=zr.alternate;e=e!==null?e.memoizedState:null}else e=ln.next;var n=bn===null?zr.memoizedState:bn.next;if(n!==null)bn=n,ln=e;else{if(e===null)throw Error(Be(310));ln=e,e={memoizedState:ln.memoizedState,baseState:ln.baseState,baseQueue:ln.baseQueue,queue:ln.queue,next:null},bn===null?zr.memoizedState=bn=e:bn=bn.next=e}return bn}function cd(e,n){return typeof n=="function"?n(e):n}function ky(e){var n=fo(),s=n.queue;if(s===null)throw Error(Be(311));s.lastRenderedReducer=e;var c=ln,f=c.baseQueue,x=s.pending;if(x!==null){if(f!==null){var v=f.next;f.next=x.next,x.next=v}c.baseQueue=f=x,s.pending=null}if(f!==null){x=f.next,c=c.baseState;var d=v=null,L=null,U=x;do{var Z=U.lane;if((wl&Z)===Z)L!==null&&(L=L.next={lane:0,action:U.action,hasEagerState:U.hasEagerState,eagerState:U.eagerState,next:null}),c=U.hasEagerState?U.eagerState:e(c,U.action);else{var j={lane:Z,action:U.action,hasEagerState:U.hasEagerState,eagerState:U.eagerState,next:null};L===null?(d=L=j,v=c):L=L.next=j,zr.lanes|=Z,Sl|=Z}U=U.next}while(U!==null&&U!==x);L===null?v=c:L.next=d,Ro(c,n.memoizedState)||(wi=!0),n.memoizedState=c,n.baseState=v,n.baseQueue=L,s.lastRenderedState=c}if(e=s.interleaved,e!==null){f=e;do x=f.lane,zr.lanes|=x,Sl|=x,f=f.next;while(f!==e)}else f===null&&(s.lanes=0);return[n.memoizedState,s.dispatch]}function Ay(e){var n=fo(),s=n.queue;if(s===null)throw Error(Be(311));s.lastRenderedReducer=e;var c=s.dispatch,f=s.pending,x=n.memoizedState;if(f!==null){s.pending=null;var v=f=f.next;do x=e(x,v.action),v=v.next;while(v!==f);Ro(x,n.memoizedState)||(wi=!0),n.memoizedState=x,n.baseQueue===null&&(n.baseState=x),s.lastRenderedState=x}return[x,c]}function z2(){}function L2(e,n){var s=zr,c=fo(),f=n(),x=!Ro(c.memoizedState,f);if(x&&(c.memoizedState=f,wi=!0),c=c.queue,D0(B2.bind(null,s,c,e),[e]),c.getSnapshot!==n||x||bn!==null&&bn.memoizedState.tag&1){if(s.flags|=2048,ud(9,D2.bind(null,s,c,f,n),void 0,null),wn===null)throw Error(Be(349));wl&30||R2(s,n,f)}return f}function R2(e,n,s){e.flags|=16384,e={getSnapshot:n,value:s},n=zr.updateQueue,n===null?(n={lastEffect:null,stores:null},zr.updateQueue=n,n.stores=[e]):(s=n.stores,s===null?n.stores=[e]:s.push(e))}function D2(e,n,s,c){n.value=s,n.getSnapshot=c,F2(n)&&O2(e)}function B2(e,n,s){return s(function(){F2(n)&&O2(e)})}function F2(e){var n=e.getSnapshot;e=e.value;try{var s=n();return!Ro(e,s)}catch{return!0}}function O2(e){var n=Rs(e,1);n!==null&&Lo(n,e,1,-1)}function Wx(e){var n=Jo();return typeof e=="function"&&(e=e()),n.memoizedState=n.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:cd,lastRenderedState:e},n.queue=e,e=e.dispatch=Gk.bind(null,zr,e),[n.memoizedState,e]}function ud(e,n,s,c){return e={tag:e,create:n,destroy:s,deps:c,next:null},n=zr.updateQueue,n===null?(n={lastEffect:null,stores:null},zr.updateQueue=n,n.lastEffect=e.next=e):(s=n.lastEffect,s===null?n.lastEffect=e.next=e:(c=s.next,s.next=e,e.next=c,n.lastEffect=e)),e}function N2(){return fo().memoizedState}function pf(e,n,s,c){var f=Jo();zr.flags|=e,f.memoizedState=ud(1|n,s,void 0,c===void 0?null:c)}function am(e,n,s,c){var f=fo();c=c===void 0?null:c;var x=void 0;if(ln!==null){var v=ln.memoizedState;if(x=v.destroy,c!==null&&z0(c,v.deps)){f.memoizedState=ud(n,s,x,c);return}}zr.flags|=e,f.memoizedState=ud(1|n,s,x,c)}function Gx(e,n){return pf(8390656,8,e,n)}function D0(e,n){return am(2048,8,e,n)}function $2(e,n){return am(4,2,e,n)}function U2(e,n){return am(4,4,e,n)}function j2(e,n){if(typeof n=="function")return e=e(),n(e),function(){n(null)};if(n!=null)return e=e(),n.current=e,function(){n.current=null}}function V2(e,n,s){return s=s!=null?s.concat([e]):null,am(4,4,j2.bind(null,n,e),s)}function B0(){}function q2(e,n){var s=fo();n=n===void 0?null:n;var c=s.memoizedState;return c!==null&&n!==null&&z0(n,c[1])?c[0]:(s.memoizedState=[e,n],e)}function H2(e,n){var s=fo();n=n===void 0?null:n;var c=s.memoizedState;return c!==null&&n!==null&&z0(n,c[1])?c[0]:(e=e(),s.memoizedState=[e,n],e)}function W2(e,n,s){return wl&21?(Ro(s,n)||(s=Yw(),zr.lanes|=s,Sl|=s,e.baseState=!0),n):(e.baseState&&(e.baseState=!1,wi=!0),e.memoizedState=s)}function Hk(e,n){var s=tr;tr=s!==0&&4>s?s:4,e(!0);var c=Ey.transition;Ey.transition={};try{e(!1),n()}finally{tr=s,Ey.transition=c}}function G2(){return fo().memoizedState}function Wk(e,n,s){var c=Ea(e);if(s={lane:c,action:s,hasEagerState:!1,eagerState:null,next:null},Z2(e))K2(n,s);else if(s=A2(e,n,s,c),s!==null){var f=hi();Lo(s,e,c,f),X2(s,n,c)}}function Gk(e,n,s){var c=Ea(e),f={lane:c,action:s,hasEagerState:!1,eagerState:null,next:null};if(Z2(e))K2(n,f);else{var x=e.alternate;if(e.lanes===0&&(x===null||x.lanes===0)&&(x=n.lastRenderedReducer,x!==null))try{var v=n.lastRenderedState,d=x(v,s);if(f.hasEagerState=!0,f.eagerState=d,Ro(d,v)){var L=n.interleaved;L===null?(f.next=f,E0(n)):(f.next=L.next,L.next=f),n.interleaved=f;return}}catch{}finally{}s=A2(e,n,f,c),s!==null&&(f=hi(),Lo(s,e,c,f),X2(s,n,c))}}function Z2(e){var n=e.alternate;return e===zr||n!==null&&n===zr}function K2(e,n){qh=Vf=!0;var s=e.pending;s===null?n.next=n:(n.next=s.next,s.next=n),e.pending=n}function X2(e,n,s){if(s&4194240){var c=n.lanes;c&=e.pendingLanes,s|=c,n.lanes=s,p0(e,s)}}var qf={readContext:po,useCallback:Kn,useContext:Kn,useEffect:Kn,useImperativeHandle:Kn,useInsertionEffect:Kn,useLayoutEffect:Kn,useMemo:Kn,useReducer:Kn,useRef:Kn,useState:Kn,useDebugValue:Kn,useDeferredValue:Kn,useTransition:Kn,useMutableSource:Kn,useSyncExternalStore:Kn,useId:Kn,unstable_isNewReconciler:!1},Zk={readContext:po,useCallback:function(e,n){return Jo().memoizedState=[e,n===void 0?null:n],e},useContext:po,useEffect:Gx,useImperativeHandle:function(e,n,s){return s=s!=null?s.concat([e]):null,pf(4194308,4,j2.bind(null,n,e),s)},useLayoutEffect:function(e,n){return pf(4194308,4,e,n)},useInsertionEffect:function(e,n){return pf(4,2,e,n)},useMemo:function(e,n){var s=Jo();return n=n===void 0?null:n,e=e(),s.memoizedState=[e,n],e},useReducer:function(e,n,s){var c=Jo();return n=s!==void 0?s(n):n,c.memoizedState=c.baseState=n,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:n},c.queue=e,e=e.dispatch=Wk.bind(null,zr,e),[c.memoizedState,e]},useRef:function(e){var n=Jo();return e={current:e},n.memoizedState=e},useState:Wx,useDebugValue:B0,useDeferredValue:function(e){return Jo().memoizedState=e},useTransition:function(){var e=Wx(!1),n=e[0];return e=Hk.bind(null,e[1]),Jo().memoizedState=e,[n,e]},useMutableSource:function(){},useSyncExternalStore:function(e,n,s){var c=zr,f=Jo();if(Er){if(s===void 0)throw Error(Be(407));s=s()}else{if(s=n(),wn===null)throw Error(Be(349));wl&30||R2(c,n,s)}f.memoizedState=s;var x={value:s,getSnapshot:n};return f.queue=x,Gx(B2.bind(null,c,x,e),[e]),c.flags|=2048,ud(9,D2.bind(null,c,x,s,n),void 0,null),s},useId:function(){var e=Jo(),n=wn.identifierPrefix;if(Er){var s=Ps,c=As;s=(c&~(1<<32-zo(c)-1)).toString(32)+s,n=":"+n+"R"+s,s=ld++,0<s&&(n+="H"+s.toString(32)),n+=":"}else s=qk++,n=":"+n+"r"+s.toString(32)+":";return e.memoizedState=n},unstable_isNewReconciler:!1},Kk={readContext:po,useCallback:q2,useContext:po,useEffect:D0,useImperativeHandle:V2,useInsertionEffect:$2,useLayoutEffect:U2,useMemo:H2,useReducer:ky,useRef:N2,useState:function(){return ky(cd)},useDebugValue:B0,useDeferredValue:function(e){var n=fo();return W2(n,ln.memoizedState,e)},useTransition:function(){var e=ky(cd)[0],n=fo().memoizedState;return[e,n]},useMutableSource:z2,useSyncExternalStore:L2,useId:G2,unstable_isNewReconciler:!1},Xk={readContext:po,useCallback:q2,useContext:po,useEffect:D0,useImperativeHandle:V2,useInsertionEffect:$2,useLayoutEffect:U2,useMemo:H2,useReducer:Ay,useRef:N2,useState:function(){return Ay(cd)},useDebugValue:B0,useDeferredValue:function(e){var n=fo();return ln===null?n.memoizedState=e:W2(n,ln.memoizedState,e)},useTransition:function(){var e=Ay(cd)[0],n=fo().memoizedState;return[e,n]},useMutableSource:z2,useSyncExternalStore:L2,useId:G2,unstable_isNewReconciler:!1};function Ao(e,n){if(e&&e.defaultProps){n=Lr({},n),e=e.defaultProps;for(var s in e)n[s]===void 0&&(n[s]=e[s]);return n}return n}function x_(e,n,s,c){n=e.memoizedState,s=s(c,n),s=s==null?n:Lr({},n,s),e.memoizedState=s,e.lanes===0&&(e.updateQueue.baseState=s)}var lm={isMounted:function(e){return(e=e._reactInternals)?Il(e)===e:!1},enqueueSetState:function(e,n,s){e=e._reactInternals;var c=hi(),f=Ea(e),x=Ms(c,f);x.payload=n,s!=null&&(x.callback=s),n=Ca(e,x,f),n!==null&&(Lo(n,e,f,c),hf(n,e,f))},enqueueReplaceState:function(e,n,s){e=e._reactInternals;var c=hi(),f=Ea(e),x=Ms(c,f);x.tag=1,x.payload=n,s!=null&&(x.callback=s),n=Ca(e,x,f),n!==null&&(Lo(n,e,f,c),hf(n,e,f))},enqueueForceUpdate:function(e,n){e=e._reactInternals;var s=hi(),c=Ea(e),f=Ms(s,c);f.tag=2,n!=null&&(f.callback=n),n=Ca(e,f,c),n!==null&&(Lo(n,e,c,s),hf(n,e,c))}};function Zx(e,n,s,c,f,x,v){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(c,x,v):n.prototype&&n.prototype.isPureReactComponent?!rd(s,c)||!rd(f,x):!0}function Y2(e,n,s){var c=!1,f=Pa,x=n.contextType;return typeof x=="object"&&x!==null?x=po(x):(f=Ti(n)?xl:Qn.current,c=n.contextTypes,x=(c=c!=null)?eu(e,f):Pa),n=new n(s,x),e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,n.updater=lm,e.stateNode=n,n._reactInternals=e,c&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=f,e.__reactInternalMemoizedMaskedChildContext=x),n}function Kx(e,n,s,c){e=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(s,c),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(s,c),n.state!==e&&lm.enqueueReplaceState(n,n.state,null)}function b_(e,n,s,c){var f=e.stateNode;f.props=s,f.state=e.memoizedState,f.refs={},k0(e);var x=n.contextType;typeof x=="object"&&x!==null?f.context=po(x):(x=Ti(n)?xl:Qn.current,f.context=eu(e,x)),f.state=e.memoizedState,x=n.getDerivedStateFromProps,typeof x=="function"&&(x_(e,n,x,s),f.state=e.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(n=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),n!==f.state&&lm.enqueueReplaceState(f,f.state,null),Uf(e,s,f,c),f.state=e.memoizedState),typeof f.componentDidMount=="function"&&(e.flags|=4194308)}function iu(e,n){try{var s="",c=n;do s+=TE(c),c=c.return;while(c);var f=s}catch(x){f=`
Error generating stack: `+x.message+`
`+x.stack}return{value:e,source:n,stack:f,digest:null}}function Py(e,n,s){return{value:e,source:null,stack:s??null,digest:n??null}}function w_(e,n){try{console.error(n.value)}catch(s){setTimeout(function(){throw s})}}var Yk=typeof WeakMap=="function"?WeakMap:Map;function J2(e,n,s){s=Ms(-1,s),s.tag=3,s.payload={element:null};var c=n.value;return s.callback=function(){Wf||(Wf=!0,z_=c),w_(e,n)},s}function Q2(e,n,s){s=Ms(-1,s),s.tag=3;var c=e.type.getDerivedStateFromError;if(typeof c=="function"){var f=n.value;s.payload=function(){return c(f)},s.callback=function(){w_(e,n)}}var x=e.stateNode;return x!==null&&typeof x.componentDidCatch=="function"&&(s.callback=function(){w_(e,n),typeof c!="function"&&(Ia===null?Ia=new Set([this]):Ia.add(this));var v=n.stack;this.componentDidCatch(n.value,{componentStack:v!==null?v:""})}),s}function Xx(e,n,s){var c=e.pingCache;if(c===null){c=e.pingCache=new Yk;var f=new Set;c.set(n,f)}else f=c.get(n),f===void 0&&(f=new Set,c.set(n,f));f.has(s)||(f.add(s),e=hA.bind(null,e,n,s),n.then(e,e))}function Yx(e){do{var n;if((n=e.tag===13)&&(n=e.memoizedState,n=n!==null?n.dehydrated!==null:!0),n)return e;e=e.return}while(e!==null);return null}function Jx(e,n,s,c,f){return e.mode&1?(e.flags|=65536,e.lanes=f,e):(e===n?e.flags|=65536:(e.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(n=Ms(-1,1),n.tag=2,Ca(s,n,1))),s.lanes|=1),e)}var Jk=Os.ReactCurrentOwner,wi=!1;function ui(e,n,s,c){n.child=e===null?k2(n,null,s,c):ru(n,e.child,s,c)}function Qx(e,n,s,c,f){s=s.render;var x=n.ref;return Wc(n,f),c=L0(e,n,s,c,x,f),s=R0(),e!==null&&!wi?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~f,Ds(e,n,f)):(Er&&s&&b0(n),n.flags|=1,ui(e,n,c,f),n.child)}function eb(e,n,s,c,f){if(e===null){var x=s.type;return typeof x=="function"&&!q0(x)&&x.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(n.tag=15,n.type=x,eS(e,n,x,c,f)):(e=yf(s.type,null,c,n,n.mode,f),e.ref=n.ref,e.return=n,n.child=e)}if(x=e.child,!(e.lanes&f)){var v=x.memoizedProps;if(s=s.compare,s=s!==null?s:rd,s(v,c)&&e.ref===n.ref)return Ds(e,n,f)}return n.flags|=1,e=ka(x,c),e.ref=n.ref,e.return=n,n.child=e}function eS(e,n,s,c,f){if(e!==null){var x=e.memoizedProps;if(rd(x,c)&&e.ref===n.ref)if(wi=!1,n.pendingProps=c=x,(e.lanes&f)!==0)e.flags&131072&&(wi=!0);else return n.lanes=e.lanes,Ds(e,n,f)}return S_(e,n,s,c,f)}function tS(e,n,s){var c=n.pendingProps,f=c.children,x=e!==null?e.memoizedState:null;if(c.mode==="hidden")if(!(n.mode&1))n.memoizedState={baseLanes:0,cachePool:null,transitions:null},fr(Uc,$i),$i|=s;else{if(!(s&1073741824))return e=x!==null?x.baseLanes|s:s,n.lanes=n.childLanes=1073741824,n.memoizedState={baseLanes:e,cachePool:null,transitions:null},n.updateQueue=null,fr(Uc,$i),$i|=e,null;n.memoizedState={baseLanes:0,cachePool:null,transitions:null},c=x!==null?x.baseLanes:s,fr(Uc,$i),$i|=c}else x!==null?(c=x.baseLanes|s,n.memoizedState=null):c=s,fr(Uc,$i),$i|=c;return ui(e,n,f,s),n.child}function rS(e,n){var s=n.ref;(e===null&&s!==null||e!==null&&e.ref!==s)&&(n.flags|=512,n.flags|=2097152)}function S_(e,n,s,c,f){var x=Ti(s)?xl:Qn.current;return x=eu(n,x),Wc(n,f),s=L0(e,n,s,c,x,f),c=R0(),e!==null&&!wi?(n.updateQueue=e.updateQueue,n.flags&=-2053,e.lanes&=~f,Ds(e,n,f)):(Er&&c&&b0(n),n.flags|=1,ui(e,n,s,f),n.child)}function tb(e,n,s,c,f){if(Ti(s)){var x=!0;Bf(n)}else x=!1;if(Wc(n,f),n.stateNode===null)ff(e,n),Y2(n,s,c),b_(n,s,c,f),c=!0;else if(e===null){var v=n.stateNode,d=n.memoizedProps;v.props=d;var L=v.context,U=s.contextType;typeof U=="object"&&U!==null?U=po(U):(U=Ti(s)?xl:Qn.current,U=eu(n,U));var Z=s.getDerivedStateFromProps,j=typeof Z=="function"||typeof v.getSnapshotBeforeUpdate=="function";j||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(d!==c||L!==U)&&Kx(n,v,c,U),fa=!1;var F=n.memoizedState;v.state=F,Uf(n,c,v,f),L=n.memoizedState,d!==c||F!==L||Si.current||fa?(typeof Z=="function"&&(x_(n,s,Z,c),L=n.memoizedState),(d=fa||Zx(n,s,d,c,F,L,U))?(j||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(n.flags|=4194308)):(typeof v.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=c,n.memoizedState=L),v.props=c,v.state=L,v.context=U,c=d):(typeof v.componentDidMount=="function"&&(n.flags|=4194308),c=!1)}else{v=n.stateNode,P2(e,n),d=n.memoizedProps,U=n.type===n.elementType?d:Ao(n.type,d),v.props=U,j=n.pendingProps,F=v.context,L=s.contextType,typeof L=="object"&&L!==null?L=po(L):(L=Ti(s)?xl:Qn.current,L=eu(n,L));var me=s.getDerivedStateFromProps;(Z=typeof me=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(d!==j||F!==L)&&Kx(n,v,c,L),fa=!1,F=n.memoizedState,v.state=F,Uf(n,c,v,f);var ye=n.memoizedState;d!==j||F!==ye||Si.current||fa?(typeof me=="function"&&(x_(n,s,me,c),ye=n.memoizedState),(U=fa||Zx(n,s,U,c,F,ye,L)||!1)?(Z||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(c,ye,L),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(c,ye,L)),typeof v.componentDidUpdate=="function"&&(n.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof v.componentDidUpdate!="function"||d===e.memoizedProps&&F===e.memoizedState||(n.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||d===e.memoizedProps&&F===e.memoizedState||(n.flags|=1024),n.memoizedProps=c,n.memoizedState=ye),v.props=c,v.state=ye,v.context=L,c=U):(typeof v.componentDidUpdate!="function"||d===e.memoizedProps&&F===e.memoizedState||(n.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||d===e.memoizedProps&&F===e.memoizedState||(n.flags|=1024),c=!1)}return T_(e,n,s,c,x,f)}function T_(e,n,s,c,f,x){rS(e,n);var v=(n.flags&128)!==0;if(!c&&!v)return f&&$x(n,s,!1),Ds(e,n,x);c=n.stateNode,Jk.current=n;var d=v&&typeof s.getDerivedStateFromError!="function"?null:c.render();return n.flags|=1,e!==null&&v?(n.child=ru(n,e.child,null,x),n.child=ru(n,null,d,x)):ui(e,n,d,x),n.memoizedState=c.state,f&&$x(n,s,!0),n.child}function nS(e){var n=e.stateNode;n.pendingContext?Nx(e,n.pendingContext,n.pendingContext!==n.context):n.context&&Nx(e,n.context,!1),A0(e,n.containerInfo)}function rb(e,n,s,c,f){return tu(),S0(f),n.flags|=256,ui(e,n,s,c),n.child}var C_={dehydrated:null,treeContext:null,retryLane:0};function I_(e){return{baseLanes:e,cachePool:null,transitions:null}}function iS(e,n,s){var c=n.pendingProps,f=Mr.current,x=!1,v=(n.flags&128)!==0,d;if((d=v)||(d=e!==null&&e.memoizedState===null?!1:(f&2)!==0),d?(x=!0,n.flags&=-129):(e===null||e.memoizedState!==null)&&(f|=1),fr(Mr,f&1),e===null)return __(n),e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(n.mode&1?e.data==="$!"?n.lanes=8:n.lanes=1073741824:n.lanes=1,null):(v=c.children,e=c.fallback,x?(c=n.mode,x=n.child,v={mode:"hidden",children:v},!(c&1)&&x!==null?(x.childLanes=0,x.pendingProps=v):x=hm(v,c,0,null),e=_l(e,c,s,null),x.return=n,e.return=n,x.sibling=e,n.child=x,n.child.memoizedState=I_(s),n.memoizedState=C_,e):F0(n,v));if(f=e.memoizedState,f!==null&&(d=f.dehydrated,d!==null))return Qk(e,n,v,c,d,f,s);if(x){x=c.fallback,v=n.mode,f=e.child,d=f.sibling;var L={mode:"hidden",children:c.children};return!(v&1)&&n.child!==f?(c=n.child,c.childLanes=0,c.pendingProps=L,n.deletions=null):(c=ka(f,L),c.subtreeFlags=f.subtreeFlags&14680064),d!==null?x=ka(d,x):(x=_l(x,v,s,null),x.flags|=2),x.return=n,c.return=n,c.sibling=x,n.child=c,c=x,x=n.child,v=e.child.memoizedState,v=v===null?I_(s):{baseLanes:v.baseLanes|s,cachePool:null,transitions:v.transitions},x.memoizedState=v,x.childLanes=e.childLanes&~s,n.memoizedState=C_,c}return x=e.child,e=x.sibling,c=ka(x,{mode:"visible",children:c.children}),!(n.mode&1)&&(c.lanes=s),c.return=n,c.sibling=null,e!==null&&(s=n.deletions,s===null?(n.deletions=[e],n.flags|=16):s.push(e)),n.child=c,n.memoizedState=null,c}function F0(e,n){return n=hm({mode:"visible",children:n},e.mode,0,null),n.return=e,e.child=n}function Kp(e,n,s,c){return c!==null&&S0(c),ru(n,e.child,null,s),e=F0(n,n.pendingProps.children),e.flags|=2,n.memoizedState=null,e}function Qk(e,n,s,c,f,x,v){if(s)return n.flags&256?(n.flags&=-257,c=Py(Error(Be(422))),Kp(e,n,v,c)):n.memoizedState!==null?(n.child=e.child,n.flags|=128,null):(x=c.fallback,f=n.mode,c=hm({mode:"visible",children:c.children},f,0,null),x=_l(x,f,v,null),x.flags|=2,c.return=n,x.return=n,c.sibling=x,n.child=c,n.mode&1&&ru(n,e.child,null,v),n.child.memoizedState=I_(v),n.memoizedState=C_,x);if(!(n.mode&1))return Kp(e,n,v,null);if(f.data==="$!"){if(c=f.nextSibling&&f.nextSibling.dataset,c)var d=c.dgst;return c=d,x=Error(Be(419)),c=Py(x,c,void 0),Kp(e,n,v,c)}if(d=(v&e.childLanes)!==0,wi||d){if(c=wn,c!==null){switch(v&-v){case 4:f=2;break;case 16:f=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:f=32;break;case 536870912:f=268435456;break;default:f=0}f=f&(c.suspendedLanes|v)?0:f,f!==0&&f!==x.retryLane&&(x.retryLane=f,Rs(e,f),Lo(c,e,f,-1))}return V0(),c=Py(Error(Be(421))),Kp(e,n,v,c)}return f.data==="$?"?(n.flags|=128,n.child=e.child,n=dA.bind(null,e),f._reactRetry=n,null):(e=x.treeContext,ji=Ta(f.nextSibling),Vi=n,Er=!0,Mo=null,e!==null&&(ao[lo++]=As,ao[lo++]=Ps,ao[lo++]=bl,As=e.id,Ps=e.overflow,bl=n),n=F0(n,c.children),n.flags|=4096,n)}function nb(e,n,s){e.lanes|=n;var c=e.alternate;c!==null&&(c.lanes|=n),v_(e.return,n,s)}function My(e,n,s,c,f){var x=e.memoizedState;x===null?e.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:c,tail:s,tailMode:f}:(x.isBackwards=n,x.rendering=null,x.renderingStartTime=0,x.last=c,x.tail=s,x.tailMode=f)}function oS(e,n,s){var c=n.pendingProps,f=c.revealOrder,x=c.tail;if(ui(e,n,c.children,s),c=Mr.current,c&2)c=c&1|2,n.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=n.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&nb(e,s,n);else if(e.tag===19)nb(e,s,n);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break e;for(;e.sibling===null;){if(e.return===null||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}c&=1}if(fr(Mr,c),!(n.mode&1))n.memoizedState=null;else switch(f){case"forwards":for(s=n.child,f=null;s!==null;)e=s.alternate,e!==null&&jf(e)===null&&(f=s),s=s.sibling;s=f,s===null?(f=n.child,n.child=null):(f=s.sibling,s.sibling=null),My(n,!1,f,s,x);break;case"backwards":for(s=null,f=n.child,n.child=null;f!==null;){if(e=f.alternate,e!==null&&jf(e)===null){n.child=f;break}e=f.sibling,f.sibling=s,s=f,f=e}My(n,!0,s,null,x);break;case"together":My(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function ff(e,n){!(n.mode&1)&&e!==null&&(e.alternate=null,n.alternate=null,n.flags|=2)}function Ds(e,n,s){if(e!==null&&(n.dependencies=e.dependencies),Sl|=n.lanes,!(s&n.childLanes))return null;if(e!==null&&n.child!==e.child)throw Error(Be(153));if(n.child!==null){for(e=n.child,s=ka(e,e.pendingProps),n.child=s,s.return=n;e.sibling!==null;)e=e.sibling,s=s.sibling=ka(e,e.pendingProps),s.return=n;s.sibling=null}return n.child}function eA(e,n,s){switch(n.tag){case 3:nS(n),tu();break;case 5:M2(n);break;case 1:Ti(n.type)&&Bf(n);break;case 4:A0(n,n.stateNode.containerInfo);break;case 10:var c=n.type._context,f=n.memoizedProps.value;fr(Nf,c._currentValue),c._currentValue=f;break;case 13:if(c=n.memoizedState,c!==null)return c.dehydrated!==null?(fr(Mr,Mr.current&1),n.flags|=128,null):s&n.child.childLanes?iS(e,n,s):(fr(Mr,Mr.current&1),e=Ds(e,n,s),e!==null?e.sibling:null);fr(Mr,Mr.current&1);break;case 19:if(c=(s&n.childLanes)!==0,e.flags&128){if(c)return oS(e,n,s);n.flags|=128}if(f=n.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),fr(Mr,Mr.current),c)break;return null;case 22:case 23:return n.lanes=0,tS(e,n,s)}return Ds(e,n,s)}var sS,E_,aS,lS;sS=function(e,n){for(var s=n.child;s!==null;){if(s.tag===5||s.tag===6)e.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===n)break;for(;s.sibling===null;){if(s.return===null||s.return===n)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};E_=function(){};aS=function(e,n,s,c){var f=e.memoizedProps;if(f!==c){e=n.stateNode,ml(is.current);var x=null;switch(s){case"input":f=Ky(e,f),c=Ky(e,c),x=[];break;case"select":f=Lr({},f,{value:void 0}),c=Lr({},c,{value:void 0}),x=[];break;case"textarea":f=Jy(e,f),c=Jy(e,c),x=[];break;default:typeof f.onClick!="function"&&typeof c.onClick=="function"&&(e.onclick=Rf)}e_(s,c);var v;s=null;for(U in f)if(!c.hasOwnProperty(U)&&f.hasOwnProperty(U)&&f[U]!=null)if(U==="style"){var d=f[U];for(v in d)d.hasOwnProperty(v)&&(s||(s={}),s[v]="")}else U!=="dangerouslySetInnerHTML"&&U!=="children"&&U!=="suppressContentEditableWarning"&&U!=="suppressHydrationWarning"&&U!=="autoFocus"&&(Kh.hasOwnProperty(U)?x||(x=[]):(x=x||[]).push(U,null));for(U in c){var L=c[U];if(d=f!=null?f[U]:void 0,c.hasOwnProperty(U)&&L!==d&&(L!=null||d!=null))if(U==="style")if(d){for(v in d)!d.hasOwnProperty(v)||L&&L.hasOwnProperty(v)||(s||(s={}),s[v]="");for(v in L)L.hasOwnProperty(v)&&d[v]!==L[v]&&(s||(s={}),s[v]=L[v])}else s||(x||(x=[]),x.push(U,s)),s=L;else U==="dangerouslySetInnerHTML"?(L=L?L.__html:void 0,d=d?d.__html:void 0,L!=null&&d!==L&&(x=x||[]).push(U,L)):U==="children"?typeof L!="string"&&typeof L!="number"||(x=x||[]).push(U,""+L):U!=="suppressContentEditableWarning"&&U!=="suppressHydrationWarning"&&(Kh.hasOwnProperty(U)?(L!=null&&U==="onScroll"&&yr("scroll",e),x||d===L||(x=[])):(x=x||[]).push(U,L))}s&&(x=x||[]).push("style",s);var U=x;(n.updateQueue=U)&&(n.flags|=4)}};lS=function(e,n,s,c){s!==c&&(n.flags|=4)};function Ah(e,n){if(!Er)switch(e.tailMode){case"hidden":n=e.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var c=null;s!==null;)s.alternate!==null&&(c=s),s=s.sibling;c===null?n||e.tail===null?e.tail=null:e.tail.sibling=null:c.sibling=null}}function Xn(e){var n=e.alternate!==null&&e.alternate.child===e.child,s=0,c=0;if(n)for(var f=e.child;f!==null;)s|=f.lanes|f.childLanes,c|=f.subtreeFlags&14680064,c|=f.flags&14680064,f.return=e,f=f.sibling;else for(f=e.child;f!==null;)s|=f.lanes|f.childLanes,c|=f.subtreeFlags,c|=f.flags,f.return=e,f=f.sibling;return e.subtreeFlags|=c,e.childLanes=s,n}function tA(e,n,s){var c=n.pendingProps;switch(w0(n),n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xn(n),null;case 1:return Ti(n.type)&&Df(),Xn(n),null;case 3:return c=n.stateNode,nu(),_r(Si),_r(Qn),M0(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(e===null||e.child===null)&&(Gp(n)?n.flags|=4:e===null||e.memoizedState.isDehydrated&&!(n.flags&256)||(n.flags|=1024,Mo!==null&&(D_(Mo),Mo=null))),E_(e,n),Xn(n),null;case 5:P0(n);var f=ml(ad.current);if(s=n.type,e!==null&&n.stateNode!=null)aS(e,n,s,c,f),e.ref!==n.ref&&(n.flags|=512,n.flags|=2097152);else{if(!c){if(n.stateNode===null)throw Error(Be(166));return Xn(n),null}if(e=ml(is.current),Gp(n)){c=n.stateNode,s=n.type;var x=n.memoizedProps;switch(c[ts]=n,c[od]=x,e=(n.mode&1)!==0,s){case"dialog":yr("cancel",c),yr("close",c);break;case"iframe":case"object":case"embed":yr("load",c);break;case"video":case"audio":for(f=0;f<Bh.length;f++)yr(Bh[f],c);break;case"source":yr("error",c);break;case"img":case"image":case"link":yr("error",c),yr("load",c);break;case"details":yr("toggle",c);break;case"input":dx(c,x),yr("invalid",c);break;case"select":c._wrapperState={wasMultiple:!!x.multiple},yr("invalid",c);break;case"textarea":fx(c,x),yr("invalid",c)}e_(s,x),f=null;for(var v in x)if(x.hasOwnProperty(v)){var d=x[v];v==="children"?typeof d=="string"?c.textContent!==d&&(x.suppressHydrationWarning!==!0&&Wp(c.textContent,d,e),f=["children",d]):typeof d=="number"&&c.textContent!==""+d&&(x.suppressHydrationWarning!==!0&&Wp(c.textContent,d,e),f=["children",""+d]):Kh.hasOwnProperty(v)&&d!=null&&v==="onScroll"&&yr("scroll",c)}switch(s){case"input":Op(c),px(c,x,!0);break;case"textarea":Op(c),mx(c);break;case"select":case"option":break;default:typeof x.onClick=="function"&&(c.onclick=Rf)}c=f,n.updateQueue=c,c!==null&&(n.flags|=4)}else{v=f.nodeType===9?f:f.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Bw(s)),e==="http://www.w3.org/1999/xhtml"?s==="script"?(e=v.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof c.is=="string"?e=v.createElement(s,{is:c.is}):(e=v.createElement(s),s==="select"&&(v=e,c.multiple?v.multiple=!0:c.size&&(v.size=c.size))):e=v.createElementNS(e,s),e[ts]=n,e[od]=c,sS(e,n,!1,!1),n.stateNode=e;e:{switch(v=t_(s,c),s){case"dialog":yr("cancel",e),yr("close",e),f=c;break;case"iframe":case"object":case"embed":yr("load",e),f=c;break;case"video":case"audio":for(f=0;f<Bh.length;f++)yr(Bh[f],e);f=c;break;case"source":yr("error",e),f=c;break;case"img":case"image":case"link":yr("error",e),yr("load",e),f=c;break;case"details":yr("toggle",e),f=c;break;case"input":dx(e,c),f=Ky(e,c),yr("invalid",e);break;case"option":f=c;break;case"select":e._wrapperState={wasMultiple:!!c.multiple},f=Lr({},c,{value:void 0}),yr("invalid",e);break;case"textarea":fx(e,c),f=Jy(e,c),yr("invalid",e);break;default:f=c}e_(s,f),d=f;for(x in d)if(d.hasOwnProperty(x)){var L=d[x];x==="style"?Nw(e,L):x==="dangerouslySetInnerHTML"?(L=L?L.__html:void 0,L!=null&&Fw(e,L)):x==="children"?typeof L=="string"?(s!=="textarea"||L!=="")&&Xh(e,L):typeof L=="number"&&Xh(e,""+L):x!=="suppressContentEditableWarning"&&x!=="suppressHydrationWarning"&&x!=="autoFocus"&&(Kh.hasOwnProperty(x)?L!=null&&x==="onScroll"&&yr("scroll",e):L!=null&&a0(e,x,L,v))}switch(s){case"input":Op(e),px(e,c,!1);break;case"textarea":Op(e),mx(e);break;case"option":c.value!=null&&e.setAttribute("value",""+Aa(c.value));break;case"select":e.multiple=!!c.multiple,x=c.value,x!=null?jc(e,!!c.multiple,x,!1):c.defaultValue!=null&&jc(e,!!c.multiple,c.defaultValue,!0);break;default:typeof f.onClick=="function"&&(e.onclick=Rf)}switch(s){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}}c&&(n.flags|=4)}n.ref!==null&&(n.flags|=512,n.flags|=2097152)}return Xn(n),null;case 6:if(e&&n.stateNode!=null)lS(e,n,e.memoizedProps,c);else{if(typeof c!="string"&&n.stateNode===null)throw Error(Be(166));if(s=ml(ad.current),ml(is.current),Gp(n)){if(c=n.stateNode,s=n.memoizedProps,c[ts]=n,(x=c.nodeValue!==s)&&(e=Vi,e!==null))switch(e.tag){case 3:Wp(c.nodeValue,s,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Wp(c.nodeValue,s,(e.mode&1)!==0)}x&&(n.flags|=4)}else c=(s.nodeType===9?s:s.ownerDocument).createTextNode(c),c[ts]=n,n.stateNode=c}return Xn(n),null;case 13:if(_r(Mr),c=n.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Er&&ji!==null&&n.mode&1&&!(n.flags&128))I2(),tu(),n.flags|=98560,x=!1;else if(x=Gp(n),c!==null&&c.dehydrated!==null){if(e===null){if(!x)throw Error(Be(318));if(x=n.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(Be(317));x[ts]=n}else tu(),!(n.flags&128)&&(n.memoizedState=null),n.flags|=4;Xn(n),x=!1}else Mo!==null&&(D_(Mo),Mo=null),x=!0;if(!x)return n.flags&65536?n:null}return n.flags&128?(n.lanes=s,n):(c=c!==null,c!==(e!==null&&e.memoizedState!==null)&&c&&(n.child.flags|=8192,n.mode&1&&(e===null||Mr.current&1?cn===0&&(cn=3):V0())),n.updateQueue!==null&&(n.flags|=4),Xn(n),null);case 4:return nu(),E_(e,n),e===null&&nd(n.stateNode.containerInfo),Xn(n),null;case 10:return I0(n.type._context),Xn(n),null;case 17:return Ti(n.type)&&Df(),Xn(n),null;case 19:if(_r(Mr),x=n.memoizedState,x===null)return Xn(n),null;if(c=(n.flags&128)!==0,v=x.rendering,v===null)if(c)Ah(x,!1);else{if(cn!==0||e!==null&&e.flags&128)for(e=n.child;e!==null;){if(v=jf(e),v!==null){for(n.flags|=128,Ah(x,!1),c=v.updateQueue,c!==null&&(n.updateQueue=c,n.flags|=4),n.subtreeFlags=0,c=s,s=n.child;s!==null;)x=s,e=c,x.flags&=14680066,v=x.alternate,v===null?(x.childLanes=0,x.lanes=e,x.child=null,x.subtreeFlags=0,x.memoizedProps=null,x.memoizedState=null,x.updateQueue=null,x.dependencies=null,x.stateNode=null):(x.childLanes=v.childLanes,x.lanes=v.lanes,x.child=v.child,x.subtreeFlags=0,x.deletions=null,x.memoizedProps=v.memoizedProps,x.memoizedState=v.memoizedState,x.updateQueue=v.updateQueue,x.type=v.type,e=v.dependencies,x.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),s=s.sibling;return fr(Mr,Mr.current&1|2),n.child}e=e.sibling}x.tail!==null&&Hr()>ou&&(n.flags|=128,c=!0,Ah(x,!1),n.lanes=4194304)}else{if(!c)if(e=jf(v),e!==null){if(n.flags|=128,c=!0,s=e.updateQueue,s!==null&&(n.updateQueue=s,n.flags|=4),Ah(x,!0),x.tail===null&&x.tailMode==="hidden"&&!v.alternate&&!Er)return Xn(n),null}else 2*Hr()-x.renderingStartTime>ou&&s!==1073741824&&(n.flags|=128,c=!0,Ah(x,!1),n.lanes=4194304);x.isBackwards?(v.sibling=n.child,n.child=v):(s=x.last,s!==null?s.sibling=v:n.child=v,x.last=v)}return x.tail!==null?(n=x.tail,x.rendering=n,x.tail=n.sibling,x.renderingStartTime=Hr(),n.sibling=null,s=Mr.current,fr(Mr,c?s&1|2:s&1),n):(Xn(n),null);case 22:case 23:return j0(),c=n.memoizedState!==null,e!==null&&e.memoizedState!==null!==c&&(n.flags|=8192),c&&n.mode&1?$i&1073741824&&(Xn(n),n.subtreeFlags&6&&(n.flags|=8192)):Xn(n),null;case 24:return null;case 25:return null}throw Error(Be(156,n.tag))}function rA(e,n){switch(w0(n),n.tag){case 1:return Ti(n.type)&&Df(),e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 3:return nu(),_r(Si),_r(Qn),M0(),e=n.flags,e&65536&&!(e&128)?(n.flags=e&-65537|128,n):null;case 5:return P0(n),null;case 13:if(_r(Mr),e=n.memoizedState,e!==null&&e.dehydrated!==null){if(n.alternate===null)throw Error(Be(340));tu()}return e=n.flags,e&65536?(n.flags=e&-65537|128,n):null;case 19:return _r(Mr),null;case 4:return nu(),null;case 10:return I0(n.type._context),null;case 22:case 23:return j0(),null;case 24:return null;default:return null}}var Xp=!1,Jn=!1,nA=typeof WeakSet=="function"?WeakSet:Set,nt=null;function $c(e,n){var s=e.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(c){$r(e,n,c)}else s.current=null}function k_(e,n,s){try{s()}catch(c){$r(e,n,c)}}var ib=!1;function iA(e,n){if(h_=Mf,e=p2(),x0(e)){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else e:{s=(s=e.ownerDocument)&&s.defaultView||window;var c=s.getSelection&&s.getSelection();if(c&&c.rangeCount!==0){s=c.anchorNode;var f=c.anchorOffset,x=c.focusNode;c=c.focusOffset;try{s.nodeType,x.nodeType}catch{s=null;break e}var v=0,d=-1,L=-1,U=0,Z=0,j=e,F=null;t:for(;;){for(var me;j!==s||f!==0&&j.nodeType!==3||(d=v+f),j!==x||c!==0&&j.nodeType!==3||(L=v+c),j.nodeType===3&&(v+=j.nodeValue.length),(me=j.firstChild)!==null;)F=j,j=me;for(;;){if(j===e)break t;if(F===s&&++U===f&&(d=v),F===x&&++Z===c&&(L=v),(me=j.nextSibling)!==null)break;j=F,F=j.parentNode}j=me}s=d===-1||L===-1?null:{start:d,end:L}}else s=null}s=s||{start:0,end:0}}else s=null;for(d_={focusedElem:e,selectionRange:s},Mf=!1,nt=n;nt!==null;)if(n=nt,e=n.child,(n.subtreeFlags&1028)!==0&&e!==null)e.return=n,nt=e;else for(;nt!==null;){n=nt;try{var ye=n.alternate;if(n.flags&1024)switch(n.tag){case 0:case 11:case 15:break;case 1:if(ye!==null){var pe=ye.memoizedProps,je=ye.memoizedState,re=n.stateNode,ee=re.getSnapshotBeforeUpdate(n.elementType===n.type?pe:Ao(n.type,pe),je);re.__reactInternalSnapshotBeforeUpdate=ee}break;case 3:var ae=n.stateNode.containerInfo;ae.nodeType===1?ae.textContent="":ae.nodeType===9&&ae.documentElement&&ae.removeChild(ae.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Be(163))}}catch(xe){$r(n,n.return,xe)}if(e=n.sibling,e!==null){e.return=n.return,nt=e;break}nt=n.return}return ye=ib,ib=!1,ye}function Hh(e,n,s){var c=n.updateQueue;if(c=c!==null?c.lastEffect:null,c!==null){var f=c=c.next;do{if((f.tag&e)===e){var x=f.destroy;f.destroy=void 0,x!==void 0&&k_(n,s,x)}f=f.next}while(f!==c)}}function cm(e,n){if(n=n.updateQueue,n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var c=s.create;s.destroy=c()}s=s.next}while(s!==n)}}function A_(e){var n=e.ref;if(n!==null){var s=e.stateNode;switch(e.tag){case 5:e=s;break;default:e=s}typeof n=="function"?n(e):n.current=e}}function cS(e){var n=e.alternate;n!==null&&(e.alternate=null,cS(n)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(n=e.stateNode,n!==null&&(delete n[ts],delete n[od],delete n[m_],delete n[$k],delete n[Uk])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function uS(e){return e.tag===5||e.tag===3||e.tag===4}function ob(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||uS(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function P_(e,n,s){var c=e.tag;if(c===5||c===6)e=e.stateNode,n?s.nodeType===8?s.parentNode.insertBefore(e,n):s.insertBefore(e,n):(s.nodeType===8?(n=s.parentNode,n.insertBefore(e,s)):(n=s,n.appendChild(e)),s=s._reactRootContainer,s!=null||n.onclick!==null||(n.onclick=Rf));else if(c!==4&&(e=e.child,e!==null))for(P_(e,n,s),e=e.sibling;e!==null;)P_(e,n,s),e=e.sibling}function M_(e,n,s){var c=e.tag;if(c===5||c===6)e=e.stateNode,n?s.insertBefore(e,n):s.appendChild(e);else if(c!==4&&(e=e.child,e!==null))for(M_(e,n,s),e=e.sibling;e!==null;)M_(e,n,s),e=e.sibling}var zn=null,Po=!1;function ha(e,n,s){for(s=s.child;s!==null;)hS(e,n,s),s=s.sibling}function hS(e,n,s){if(ns&&typeof ns.onCommitFiberUnmount=="function")try{ns.onCommitFiberUnmount(tm,s)}catch{}switch(s.tag){case 5:Jn||$c(s,n);case 6:var c=zn,f=Po;zn=null,ha(e,n,s),zn=c,Po=f,zn!==null&&(Po?(e=zn,s=s.stateNode,e.nodeType===8?e.parentNode.removeChild(s):e.removeChild(s)):zn.removeChild(s.stateNode));break;case 18:zn!==null&&(Po?(e=zn,s=s.stateNode,e.nodeType===8?Ty(e.parentNode,s):e.nodeType===1&&Ty(e,s),ed(e)):Ty(zn,s.stateNode));break;case 4:c=zn,f=Po,zn=s.stateNode.containerInfo,Po=!0,ha(e,n,s),zn=c,Po=f;break;case 0:case 11:case 14:case 15:if(!Jn&&(c=s.updateQueue,c!==null&&(c=c.lastEffect,c!==null))){f=c=c.next;do{var x=f,v=x.destroy;x=x.tag,v!==void 0&&(x&2||x&4)&&k_(s,n,v),f=f.next}while(f!==c)}ha(e,n,s);break;case 1:if(!Jn&&($c(s,n),c=s.stateNode,typeof c.componentWillUnmount=="function"))try{c.props=s.memoizedProps,c.state=s.memoizedState,c.componentWillUnmount()}catch(d){$r(s,n,d)}ha(e,n,s);break;case 21:ha(e,n,s);break;case 22:s.mode&1?(Jn=(c=Jn)||s.memoizedState!==null,ha(e,n,s),Jn=c):ha(e,n,s);break;default:ha(e,n,s)}}function sb(e){var n=e.updateQueue;if(n!==null){e.updateQueue=null;var s=e.stateNode;s===null&&(s=e.stateNode=new nA),n.forEach(function(c){var f=pA.bind(null,e,c);s.has(c)||(s.add(c),c.then(f,f))})}}function ko(e,n){var s=n.deletions;if(s!==null)for(var c=0;c<s.length;c++){var f=s[c];try{var x=e,v=n,d=v;e:for(;d!==null;){switch(d.tag){case 5:zn=d.stateNode,Po=!1;break e;case 3:zn=d.stateNode.containerInfo,Po=!0;break e;case 4:zn=d.stateNode.containerInfo,Po=!0;break e}d=d.return}if(zn===null)throw Error(Be(160));hS(x,v,f),zn=null,Po=!1;var L=f.alternate;L!==null&&(L.return=null),f.return=null}catch(U){$r(f,n,U)}}if(n.subtreeFlags&12854)for(n=n.child;n!==null;)dS(n,e),n=n.sibling}function dS(e,n){var s=e.alternate,c=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ko(n,e),Yo(e),c&4){try{Hh(3,e,e.return),cm(3,e)}catch(pe){$r(e,e.return,pe)}try{Hh(5,e,e.return)}catch(pe){$r(e,e.return,pe)}}break;case 1:ko(n,e),Yo(e),c&512&&s!==null&&$c(s,s.return);break;case 5:if(ko(n,e),Yo(e),c&512&&s!==null&&$c(s,s.return),e.flags&32){var f=e.stateNode;try{Xh(f,"")}catch(pe){$r(e,e.return,pe)}}if(c&4&&(f=e.stateNode,f!=null)){var x=e.memoizedProps,v=s!==null?s.memoizedProps:x,d=e.type,L=e.updateQueue;if(e.updateQueue=null,L!==null)try{d==="input"&&x.type==="radio"&&x.name!=null&&Rw(f,x),t_(d,v);var U=t_(d,x);for(v=0;v<L.length;v+=2){var Z=L[v],j=L[v+1];Z==="style"?Nw(f,j):Z==="dangerouslySetInnerHTML"?Fw(f,j):Z==="children"?Xh(f,j):a0(f,Z,j,U)}switch(d){case"input":Xy(f,x);break;case"textarea":Dw(f,x);break;case"select":var F=f._wrapperState.wasMultiple;f._wrapperState.wasMultiple=!!x.multiple;var me=x.value;me!=null?jc(f,!!x.multiple,me,!1):F!==!!x.multiple&&(x.defaultValue!=null?jc(f,!!x.multiple,x.defaultValue,!0):jc(f,!!x.multiple,x.multiple?[]:"",!1))}f[od]=x}catch(pe){$r(e,e.return,pe)}}break;case 6:if(ko(n,e),Yo(e),c&4){if(e.stateNode===null)throw Error(Be(162));f=e.stateNode,x=e.memoizedProps;try{f.nodeValue=x}catch(pe){$r(e,e.return,pe)}}break;case 3:if(ko(n,e),Yo(e),c&4&&s!==null&&s.memoizedState.isDehydrated)try{ed(n.containerInfo)}catch(pe){$r(e,e.return,pe)}break;case 4:ko(n,e),Yo(e);break;case 13:ko(n,e),Yo(e),f=e.child,f.flags&8192&&(x=f.memoizedState!==null,f.stateNode.isHidden=x,!x||f.alternate!==null&&f.alternate.memoizedState!==null||($0=Hr())),c&4&&sb(e);break;case 22:if(Z=s!==null&&s.memoizedState!==null,e.mode&1?(Jn=(U=Jn)||Z,ko(n,e),Jn=U):ko(n,e),Yo(e),c&8192){if(U=e.memoizedState!==null,(e.stateNode.isHidden=U)&&!Z&&e.mode&1)for(nt=e,Z=e.child;Z!==null;){for(j=nt=Z;nt!==null;){switch(F=nt,me=F.child,F.tag){case 0:case 11:case 14:case 15:Hh(4,F,F.return);break;case 1:$c(F,F.return);var ye=F.stateNode;if(typeof ye.componentWillUnmount=="function"){c=F,s=F.return;try{n=c,ye.props=n.memoizedProps,ye.state=n.memoizedState,ye.componentWillUnmount()}catch(pe){$r(c,s,pe)}}break;case 5:$c(F,F.return);break;case 22:if(F.memoizedState!==null){lb(j);continue}}me!==null?(me.return=F,nt=me):lb(j)}Z=Z.sibling}e:for(Z=null,j=e;;){if(j.tag===5){if(Z===null){Z=j;try{f=j.stateNode,U?(x=f.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none"):(d=j.stateNode,L=j.memoizedProps.style,v=L!=null&&L.hasOwnProperty("display")?L.display:null,d.style.display=Ow("display",v))}catch(pe){$r(e,e.return,pe)}}}else if(j.tag===6){if(Z===null)try{j.stateNode.nodeValue=U?"":j.memoizedProps}catch(pe){$r(e,e.return,pe)}}else if((j.tag!==22&&j.tag!==23||j.memoizedState===null||j===e)&&j.child!==null){j.child.return=j,j=j.child;continue}if(j===e)break e;for(;j.sibling===null;){if(j.return===null||j.return===e)break e;Z===j&&(Z=null),j=j.return}Z===j&&(Z=null),j.sibling.return=j.return,j=j.sibling}}break;case 19:ko(n,e),Yo(e),c&4&&sb(e);break;case 21:break;default:ko(n,e),Yo(e)}}function Yo(e){var n=e.flags;if(n&2){try{e:{for(var s=e.return;s!==null;){if(uS(s)){var c=s;break e}s=s.return}throw Error(Be(160))}switch(c.tag){case 5:var f=c.stateNode;c.flags&32&&(Xh(f,""),c.flags&=-33);var x=ob(e);M_(e,x,f);break;case 3:case 4:var v=c.stateNode.containerInfo,d=ob(e);P_(e,d,v);break;default:throw Error(Be(161))}}catch(L){$r(e,e.return,L)}e.flags&=-3}n&4096&&(e.flags&=-4097)}function oA(e,n,s){nt=e,pS(e)}function pS(e,n,s){for(var c=(e.mode&1)!==0;nt!==null;){var f=nt,x=f.child;if(f.tag===22&&c){var v=f.memoizedState!==null||Xp;if(!v){var d=f.alternate,L=d!==null&&d.memoizedState!==null||Jn;d=Xp;var U=Jn;if(Xp=v,(Jn=L)&&!U)for(nt=f;nt!==null;)v=nt,L=v.child,v.tag===22&&v.memoizedState!==null?cb(f):L!==null?(L.return=v,nt=L):cb(f);for(;x!==null;)nt=x,pS(x),x=x.sibling;nt=f,Xp=d,Jn=U}ab(e)}else f.subtreeFlags&8772&&x!==null?(x.return=f,nt=x):ab(e)}}function ab(e){for(;nt!==null;){var n=nt;if(n.flags&8772){var s=n.alternate;try{if(n.flags&8772)switch(n.tag){case 0:case 11:case 15:Jn||cm(5,n);break;case 1:var c=n.stateNode;if(n.flags&4&&!Jn)if(s===null)c.componentDidMount();else{var f=n.elementType===n.type?s.memoizedProps:Ao(n.type,s.memoizedProps);c.componentDidUpdate(f,s.memoizedState,c.__reactInternalSnapshotBeforeUpdate)}var x=n.updateQueue;x!==null&&Hx(n,x,c);break;case 3:var v=n.updateQueue;if(v!==null){if(s=null,n.child!==null)switch(n.child.tag){case 5:s=n.child.stateNode;break;case 1:s=n.child.stateNode}Hx(n,v,s)}break;case 5:var d=n.stateNode;if(s===null&&n.flags&4){s=d;var L=n.memoizedProps;switch(n.type){case"button":case"input":case"select":case"textarea":L.autoFocus&&s.focus();break;case"img":L.src&&(s.src=L.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(n.memoizedState===null){var U=n.alternate;if(U!==null){var Z=U.memoizedState;if(Z!==null){var j=Z.dehydrated;j!==null&&ed(j)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Be(163))}Jn||n.flags&512&&A_(n)}catch(F){$r(n,n.return,F)}}if(n===e){nt=null;break}if(s=n.sibling,s!==null){s.return=n.return,nt=s;break}nt=n.return}}function lb(e){for(;nt!==null;){var n=nt;if(n===e){nt=null;break}var s=n.sibling;if(s!==null){s.return=n.return,nt=s;break}nt=n.return}}function cb(e){for(;nt!==null;){var n=nt;try{switch(n.tag){case 0:case 11:case 15:var s=n.return;try{cm(4,n)}catch(L){$r(n,s,L)}break;case 1:var c=n.stateNode;if(typeof c.componentDidMount=="function"){var f=n.return;try{c.componentDidMount()}catch(L){$r(n,f,L)}}var x=n.return;try{A_(n)}catch(L){$r(n,x,L)}break;case 5:var v=n.return;try{A_(n)}catch(L){$r(n,v,L)}}}catch(L){$r(n,n.return,L)}if(n===e){nt=null;break}var d=n.sibling;if(d!==null){d.return=n.return,nt=d;break}nt=n.return}}var sA=Math.ceil,Hf=Os.ReactCurrentDispatcher,O0=Os.ReactCurrentOwner,ho=Os.ReactCurrentBatchConfig,jt=0,wn=null,rn=null,Bn=0,$i=0,Uc=za(0),cn=0,hd=null,Sl=0,um=0,N0=0,Wh=null,bi=null,$0=0,ou=1/0,Es=null,Wf=!1,z_=null,Ia=null,Yp=!1,va=null,Gf=0,Gh=0,L_=null,mf=-1,gf=0;function hi(){return jt&6?Hr():mf!==-1?mf:mf=Hr()}function Ea(e){return e.mode&1?jt&2&&Bn!==0?Bn&-Bn:Vk.transition!==null?(gf===0&&(gf=Yw()),gf):(e=tr,e!==0||(e=window.event,e=e===void 0?16:i2(e.type)),e):1}function Lo(e,n,s,c){if(50<Gh)throw Gh=0,L_=null,Error(Be(185));_d(e,s,c),(!(jt&2)||e!==wn)&&(e===wn&&(!(jt&2)&&(um|=s),cn===4&&ga(e,Bn)),Ci(e,c),s===1&&jt===0&&!(n.mode&1)&&(ou=Hr()+500,sm&&La()))}function Ci(e,n){var s=e.callbackNode;VE(e,n);var c=Pf(e,e===wn?Bn:0);if(c===0)s!==null&&_x(s),e.callbackNode=null,e.callbackPriority=0;else if(n=c&-c,e.callbackPriority!==n){if(s!=null&&_x(s),n===1)e.tag===0?jk(ub.bind(null,e)):S2(ub.bind(null,e)),Ok(function(){!(jt&6)&&La()}),s=null;else{switch(Jw(c)){case 1:s=d0;break;case 4:s=Kw;break;case 16:s=Af;break;case 536870912:s=Xw;break;default:s=Af}s=bS(s,fS.bind(null,e))}e.callbackPriority=n,e.callbackNode=s}}function fS(e,n){if(mf=-1,gf=0,jt&6)throw Error(Be(327));var s=e.callbackNode;if(Gc()&&e.callbackNode!==s)return null;var c=Pf(e,e===wn?Bn:0);if(c===0)return null;if(c&30||c&e.expiredLanes||n)n=Zf(e,c);else{n=c;var f=jt;jt|=2;var x=gS();(wn!==e||Bn!==n)&&(Es=null,ou=Hr()+500,yl(e,n));do try{cA();break}catch(d){mS(e,d)}while(!0);C0(),Hf.current=x,jt=f,rn!==null?n=0:(wn=null,Bn=0,n=cn)}if(n!==0){if(n===2&&(f=s_(e),f!==0&&(c=f,n=R_(e,f))),n===1)throw s=hd,yl(e,0),ga(e,c),Ci(e,Hr()),s;if(n===6)ga(e,c);else{if(f=e.current.alternate,!(c&30)&&!aA(f)&&(n=Zf(e,c),n===2&&(x=s_(e),x!==0&&(c=x,n=R_(e,x))),n===1))throw s=hd,yl(e,0),ga(e,c),Ci(e,Hr()),s;switch(e.finishedWork=f,e.finishedLanes=c,n){case 0:case 1:throw Error(Be(345));case 2:ul(e,bi,Es);break;case 3:if(ga(e,c),(c&130023424)===c&&(n=$0+500-Hr(),10<n)){if(Pf(e,0)!==0)break;if(f=e.suspendedLanes,(f&c)!==c){hi(),e.pingedLanes|=e.suspendedLanes&f;break}e.timeoutHandle=f_(ul.bind(null,e,bi,Es),n);break}ul(e,bi,Es);break;case 4:if(ga(e,c),(c&4194240)===c)break;for(n=e.eventTimes,f=-1;0<c;){var v=31-zo(c);x=1<<v,v=n[v],v>f&&(f=v),c&=~x}if(c=f,c=Hr()-c,c=(120>c?120:480>c?480:1080>c?1080:1920>c?1920:3e3>c?3e3:4320>c?4320:1960*sA(c/1960))-c,10<c){e.timeoutHandle=f_(ul.bind(null,e,bi,Es),c);break}ul(e,bi,Es);break;case 5:ul(e,bi,Es);break;default:throw Error(Be(329))}}}return Ci(e,Hr()),e.callbackNode===s?fS.bind(null,e):null}function R_(e,n){var s=Wh;return e.current.memoizedState.isDehydrated&&(yl(e,n).flags|=256),e=Zf(e,n),e!==2&&(n=bi,bi=s,n!==null&&D_(n)),e}function D_(e){bi===null?bi=e:bi.push.apply(bi,e)}function aA(e){for(var n=e;;){if(n.flags&16384){var s=n.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var c=0;c<s.length;c++){var f=s[c],x=f.getSnapshot;f=f.value;try{if(!Ro(x(),f))return!1}catch{return!1}}}if(s=n.child,n.subtreeFlags&16384&&s!==null)s.return=n,n=s;else{if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function ga(e,n){for(n&=~N0,n&=~um,e.suspendedLanes|=n,e.pingedLanes&=~n,e=e.expirationTimes;0<n;){var s=31-zo(n),c=1<<s;e[s]=-1,n&=~c}}function ub(e){if(jt&6)throw Error(Be(327));Gc();var n=Pf(e,0);if(!(n&1))return Ci(e,Hr()),null;var s=Zf(e,n);if(e.tag!==0&&s===2){var c=s_(e);c!==0&&(n=c,s=R_(e,c))}if(s===1)throw s=hd,yl(e,0),ga(e,n),Ci(e,Hr()),s;if(s===6)throw Error(Be(345));return e.finishedWork=e.current.alternate,e.finishedLanes=n,ul(e,bi,Es),Ci(e,Hr()),null}function U0(e,n){var s=jt;jt|=1;try{return e(n)}finally{jt=s,jt===0&&(ou=Hr()+500,sm&&La())}}function Tl(e){va!==null&&va.tag===0&&!(jt&6)&&Gc();var n=jt;jt|=1;var s=ho.transition,c=tr;try{if(ho.transition=null,tr=1,e)return e()}finally{tr=c,ho.transition=s,jt=n,!(jt&6)&&La()}}function j0(){$i=Uc.current,_r(Uc)}function yl(e,n){e.finishedWork=null,e.finishedLanes=0;var s=e.timeoutHandle;if(s!==-1&&(e.timeoutHandle=-1,Fk(s)),rn!==null)for(s=rn.return;s!==null;){var c=s;switch(w0(c),c.tag){case 1:c=c.type.childContextTypes,c!=null&&Df();break;case 3:nu(),_r(Si),_r(Qn),M0();break;case 5:P0(c);break;case 4:nu();break;case 13:_r(Mr);break;case 19:_r(Mr);break;case 10:I0(c.type._context);break;case 22:case 23:j0()}s=s.return}if(wn=e,rn=e=ka(e.current,null),Bn=$i=n,cn=0,hd=null,N0=um=Sl=0,bi=Wh=null,fl!==null){for(n=0;n<fl.length;n++)if(s=fl[n],c=s.interleaved,c!==null){s.interleaved=null;var f=c.next,x=s.pending;if(x!==null){var v=x.next;x.next=f,c.next=v}s.pending=c}fl=null}return e}function mS(e,n){do{var s=rn;try{if(C0(),df.current=qf,Vf){for(var c=zr.memoizedState;c!==null;){var f=c.queue;f!==null&&(f.pending=null),c=c.next}Vf=!1}if(wl=0,bn=ln=zr=null,qh=!1,ld=0,O0.current=null,s===null||s.return===null){cn=1,hd=n,rn=null;break}e:{var x=e,v=s.return,d=s,L=n;if(n=Bn,d.flags|=32768,L!==null&&typeof L=="object"&&typeof L.then=="function"){var U=L,Z=d,j=Z.tag;if(!(Z.mode&1)&&(j===0||j===11||j===15)){var F=Z.alternate;F?(Z.updateQueue=F.updateQueue,Z.memoizedState=F.memoizedState,Z.lanes=F.lanes):(Z.updateQueue=null,Z.memoizedState=null)}var me=Yx(v);if(me!==null){me.flags&=-257,Jx(me,v,d,x,n),me.mode&1&&Xx(x,U,n),n=me,L=U;var ye=n.updateQueue;if(ye===null){var pe=new Set;pe.add(L),n.updateQueue=pe}else ye.add(L);break e}else{if(!(n&1)){Xx(x,U,n),V0();break e}L=Error(Be(426))}}else if(Er&&d.mode&1){var je=Yx(v);if(je!==null){!(je.flags&65536)&&(je.flags|=256),Jx(je,v,d,x,n),S0(iu(L,d));break e}}x=L=iu(L,d),cn!==4&&(cn=2),Wh===null?Wh=[x]:Wh.push(x),x=v;do{switch(x.tag){case 3:x.flags|=65536,n&=-n,x.lanes|=n;var re=J2(x,L,n);qx(x,re);break e;case 1:d=L;var ee=x.type,ae=x.stateNode;if(!(x.flags&128)&&(typeof ee.getDerivedStateFromError=="function"||ae!==null&&typeof ae.componentDidCatch=="function"&&(Ia===null||!Ia.has(ae)))){x.flags|=65536,n&=-n,x.lanes|=n;var xe=Q2(x,d,n);qx(x,xe);break e}}x=x.return}while(x!==null)}_S(s)}catch(Ee){n=Ee,rn===s&&s!==null&&(rn=s=s.return);continue}break}while(!0)}function gS(){var e=Hf.current;return Hf.current=qf,e===null?qf:e}function V0(){(cn===0||cn===3||cn===2)&&(cn=4),wn===null||!(Sl&268435455)&&!(um&268435455)||ga(wn,Bn)}function Zf(e,n){var s=jt;jt|=2;var c=gS();(wn!==e||Bn!==n)&&(Es=null,yl(e,n));do try{lA();break}catch(f){mS(e,f)}while(!0);if(C0(),jt=s,Hf.current=c,rn!==null)throw Error(Be(261));return wn=null,Bn=0,cn}function lA(){for(;rn!==null;)yS(rn)}function cA(){for(;rn!==null&&!RE();)yS(rn)}function yS(e){var n=xS(e.alternate,e,$i);e.memoizedProps=e.pendingProps,n===null?_S(e):rn=n,O0.current=null}function _S(e){var n=e;do{var s=n.alternate;if(e=n.return,n.flags&32768){if(s=rA(s,n),s!==null){s.flags&=32767,rn=s;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{cn=6,rn=null;return}}else if(s=tA(s,n,$i),s!==null){rn=s;return}if(n=n.sibling,n!==null){rn=n;return}rn=n=e}while(n!==null);cn===0&&(cn=5)}function ul(e,n,s){var c=tr,f=ho.transition;try{ho.transition=null,tr=1,uA(e,n,s,c)}finally{ho.transition=f,tr=c}return null}function uA(e,n,s,c){do Gc();while(va!==null);if(jt&6)throw Error(Be(327));s=e.finishedWork;var f=e.finishedLanes;if(s===null)return null;if(e.finishedWork=null,e.finishedLanes=0,s===e.current)throw Error(Be(177));e.callbackNode=null,e.callbackPriority=0;var x=s.lanes|s.childLanes;if(qE(e,x),e===wn&&(rn=wn=null,Bn=0),!(s.subtreeFlags&2064)&&!(s.flags&2064)||Yp||(Yp=!0,bS(Af,function(){return Gc(),null})),x=(s.flags&15990)!==0,s.subtreeFlags&15990||x){x=ho.transition,ho.transition=null;var v=tr;tr=1;var d=jt;jt|=4,O0.current=null,iA(e,s),dS(s,e),Pk(d_),Mf=!!h_,d_=h_=null,e.current=s,oA(s),DE(),jt=d,tr=v,ho.transition=x}else e.current=s;if(Yp&&(Yp=!1,va=e,Gf=f),x=e.pendingLanes,x===0&&(Ia=null),OE(s.stateNode),Ci(e,Hr()),n!==null)for(c=e.onRecoverableError,s=0;s<n.length;s++)f=n[s],c(f.value,{componentStack:f.stack,digest:f.digest});if(Wf)throw Wf=!1,e=z_,z_=null,e;return Gf&1&&e.tag!==0&&Gc(),x=e.pendingLanes,x&1?e===L_?Gh++:(Gh=0,L_=e):Gh=0,La(),null}function Gc(){if(va!==null){var e=Jw(Gf),n=ho.transition,s=tr;try{if(ho.transition=null,tr=16>e?16:e,va===null)var c=!1;else{if(e=va,va=null,Gf=0,jt&6)throw Error(Be(331));var f=jt;for(jt|=4,nt=e.current;nt!==null;){var x=nt,v=x.child;if(nt.flags&16){var d=x.deletions;if(d!==null){for(var L=0;L<d.length;L++){var U=d[L];for(nt=U;nt!==null;){var Z=nt;switch(Z.tag){case 0:case 11:case 15:Hh(8,Z,x)}var j=Z.child;if(j!==null)j.return=Z,nt=j;else for(;nt!==null;){Z=nt;var F=Z.sibling,me=Z.return;if(cS(Z),Z===U){nt=null;break}if(F!==null){F.return=me,nt=F;break}nt=me}}}var ye=x.alternate;if(ye!==null){var pe=ye.child;if(pe!==null){ye.child=null;do{var je=pe.sibling;pe.sibling=null,pe=je}while(pe!==null)}}nt=x}}if(x.subtreeFlags&2064&&v!==null)v.return=x,nt=v;else e:for(;nt!==null;){if(x=nt,x.flags&2048)switch(x.tag){case 0:case 11:case 15:Hh(9,x,x.return)}var re=x.sibling;if(re!==null){re.return=x.return,nt=re;break e}nt=x.return}}var ee=e.current;for(nt=ee;nt!==null;){v=nt;var ae=v.child;if(v.subtreeFlags&2064&&ae!==null)ae.return=v,nt=ae;else e:for(v=ee;nt!==null;){if(d=nt,d.flags&2048)try{switch(d.tag){case 0:case 11:case 15:cm(9,d)}}catch(Ee){$r(d,d.return,Ee)}if(d===v){nt=null;break e}var xe=d.sibling;if(xe!==null){xe.return=d.return,nt=xe;break e}nt=d.return}}if(jt=f,La(),ns&&typeof ns.onPostCommitFiberRoot=="function")try{ns.onPostCommitFiberRoot(tm,e)}catch{}c=!0}return c}finally{tr=s,ho.transition=n}}return!1}function hb(e,n,s){n=iu(s,n),n=J2(e,n,1),e=Ca(e,n,1),n=hi(),e!==null&&(_d(e,1,n),Ci(e,n))}function $r(e,n,s){if(e.tag===3)hb(e,e,s);else for(;n!==null;){if(n.tag===3){hb(n,e,s);break}else if(n.tag===1){var c=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Ia===null||!Ia.has(c))){e=iu(s,e),e=Q2(n,e,1),n=Ca(n,e,1),e=hi(),n!==null&&(_d(n,1,e),Ci(n,e));break}}n=n.return}}function hA(e,n,s){var c=e.pingCache;c!==null&&c.delete(n),n=hi(),e.pingedLanes|=e.suspendedLanes&s,wn===e&&(Bn&s)===s&&(cn===4||cn===3&&(Bn&130023424)===Bn&&500>Hr()-$0?yl(e,0):N0|=s),Ci(e,n)}function vS(e,n){n===0&&(e.mode&1?(n=Up,Up<<=1,!(Up&130023424)&&(Up=4194304)):n=1);var s=hi();e=Rs(e,n),e!==null&&(_d(e,n,s),Ci(e,s))}function dA(e){var n=e.memoizedState,s=0;n!==null&&(s=n.retryLane),vS(e,s)}function pA(e,n){var s=0;switch(e.tag){case 13:var c=e.stateNode,f=e.memoizedState;f!==null&&(s=f.retryLane);break;case 19:c=e.stateNode;break;default:throw Error(Be(314))}c!==null&&c.delete(n),vS(e,s)}var xS;xS=function(e,n,s){if(e!==null)if(e.memoizedProps!==n.pendingProps||Si.current)wi=!0;else{if(!(e.lanes&s)&&!(n.flags&128))return wi=!1,eA(e,n,s);wi=!!(e.flags&131072)}else wi=!1,Er&&n.flags&1048576&&T2(n,Of,n.index);switch(n.lanes=0,n.tag){case 2:var c=n.type;ff(e,n),e=n.pendingProps;var f=eu(n,Qn.current);Wc(n,s),f=L0(null,n,c,e,f,s);var x=R0();return n.flags|=1,typeof f=="object"&&f!==null&&typeof f.render=="function"&&f.$$typeof===void 0?(n.tag=1,n.memoizedState=null,n.updateQueue=null,Ti(c)?(x=!0,Bf(n)):x=!1,n.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,k0(n),f.updater=lm,n.stateNode=f,f._reactInternals=n,b_(n,c,e,s),n=T_(null,n,c,!0,x,s)):(n.tag=0,Er&&x&&b0(n),ui(null,n,f,s),n=n.child),n;case 16:c=n.elementType;e:{switch(ff(e,n),e=n.pendingProps,f=c._init,c=f(c._payload),n.type=c,f=n.tag=mA(c),e=Ao(c,e),f){case 0:n=S_(null,n,c,e,s);break e;case 1:n=tb(null,n,c,e,s);break e;case 11:n=Qx(null,n,c,e,s);break e;case 14:n=eb(null,n,c,Ao(c.type,e),s);break e}throw Error(Be(306,c,""))}return n;case 0:return c=n.type,f=n.pendingProps,f=n.elementType===c?f:Ao(c,f),S_(e,n,c,f,s);case 1:return c=n.type,f=n.pendingProps,f=n.elementType===c?f:Ao(c,f),tb(e,n,c,f,s);case 3:e:{if(nS(n),e===null)throw Error(Be(387));c=n.pendingProps,x=n.memoizedState,f=x.element,P2(e,n),Uf(n,c,null,s);var v=n.memoizedState;if(c=v.element,x.isDehydrated)if(x={element:c,isDehydrated:!1,cache:v.cache,pendingSuspenseBoundaries:v.pendingSuspenseBoundaries,transitions:v.transitions},n.updateQueue.baseState=x,n.memoizedState=x,n.flags&256){f=iu(Error(Be(423)),n),n=rb(e,n,c,s,f);break e}else if(c!==f){f=iu(Error(Be(424)),n),n=rb(e,n,c,s,f);break e}else for(ji=Ta(n.stateNode.containerInfo.firstChild),Vi=n,Er=!0,Mo=null,s=k2(n,null,c,s),n.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(tu(),c===f){n=Ds(e,n,s);break e}ui(e,n,c,s)}n=n.child}return n;case 5:return M2(n),e===null&&__(n),c=n.type,f=n.pendingProps,x=e!==null?e.memoizedProps:null,v=f.children,p_(c,f)?v=null:x!==null&&p_(c,x)&&(n.flags|=32),rS(e,n),ui(e,n,v,s),n.child;case 6:return e===null&&__(n),null;case 13:return iS(e,n,s);case 4:return A0(n,n.stateNode.containerInfo),c=n.pendingProps,e===null?n.child=ru(n,null,c,s):ui(e,n,c,s),n.child;case 11:return c=n.type,f=n.pendingProps,f=n.elementType===c?f:Ao(c,f),Qx(e,n,c,f,s);case 7:return ui(e,n,n.pendingProps,s),n.child;case 8:return ui(e,n,n.pendingProps.children,s),n.child;case 12:return ui(e,n,n.pendingProps.children,s),n.child;case 10:e:{if(c=n.type._context,f=n.pendingProps,x=n.memoizedProps,v=f.value,fr(Nf,c._currentValue),c._currentValue=v,x!==null)if(Ro(x.value,v)){if(x.children===f.children&&!Si.current){n=Ds(e,n,s);break e}}else for(x=n.child,x!==null&&(x.return=n);x!==null;){var d=x.dependencies;if(d!==null){v=x.child;for(var L=d.firstContext;L!==null;){if(L.context===c){if(x.tag===1){L=Ms(-1,s&-s),L.tag=2;var U=x.updateQueue;if(U!==null){U=U.shared;var Z=U.pending;Z===null?L.next=L:(L.next=Z.next,Z.next=L),U.pending=L}}x.lanes|=s,L=x.alternate,L!==null&&(L.lanes|=s),v_(x.return,s,n),d.lanes|=s;break}L=L.next}}else if(x.tag===10)v=x.type===n.type?null:x.child;else if(x.tag===18){if(v=x.return,v===null)throw Error(Be(341));v.lanes|=s,d=v.alternate,d!==null&&(d.lanes|=s),v_(v,s,n),v=x.sibling}else v=x.child;if(v!==null)v.return=x;else for(v=x;v!==null;){if(v===n){v=null;break}if(x=v.sibling,x!==null){x.return=v.return,v=x;break}v=v.return}x=v}ui(e,n,f.children,s),n=n.child}return n;case 9:return f=n.type,c=n.pendingProps.children,Wc(n,s),f=po(f),c=c(f),n.flags|=1,ui(e,n,c,s),n.child;case 14:return c=n.type,f=Ao(c,n.pendingProps),f=Ao(c.type,f),eb(e,n,c,f,s);case 15:return eS(e,n,n.type,n.pendingProps,s);case 17:return c=n.type,f=n.pendingProps,f=n.elementType===c?f:Ao(c,f),ff(e,n),n.tag=1,Ti(c)?(e=!0,Bf(n)):e=!1,Wc(n,s),Y2(n,c,f),b_(n,c,f,s),T_(null,n,c,!0,e,s);case 19:return oS(e,n,s);case 22:return tS(e,n,s)}throw Error(Be(156,n.tag))};function bS(e,n){return Zw(e,n)}function fA(e,n,s,c){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function uo(e,n,s,c){return new fA(e,n,s,c)}function q0(e){return e=e.prototype,!(!e||!e.isReactComponent)}function mA(e){if(typeof e=="function")return q0(e)?1:0;if(e!=null){if(e=e.$$typeof,e===c0)return 11;if(e===u0)return 14}return 2}function ka(e,n){var s=e.alternate;return s===null?(s=uo(e.tag,n,e.key,e.mode),s.elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=n,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=e.flags&14680064,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,n=e.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s}function yf(e,n,s,c,f,x){var v=2;if(c=e,typeof e=="function")q0(e)&&(v=1);else if(typeof e=="string")v=5;else e:switch(e){case Mc:return _l(s.children,f,x,n);case l0:v=8,f|=8;break;case Hy:return e=uo(12,s,n,f|2),e.elementType=Hy,e.lanes=x,e;case Wy:return e=uo(13,s,n,f),e.elementType=Wy,e.lanes=x,e;case Gy:return e=uo(19,s,n,f),e.elementType=Gy,e.lanes=x,e;case Mw:return hm(s,f,x,n);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Aw:v=10;break e;case Pw:v=9;break e;case c0:v=11;break e;case u0:v=14;break e;case pa:v=16,c=null;break e}throw Error(Be(130,e==null?e:typeof e,""))}return n=uo(v,s,n,f),n.elementType=e,n.type=c,n.lanes=x,n}function _l(e,n,s,c){return e=uo(7,e,c,n),e.lanes=s,e}function hm(e,n,s,c){return e=uo(22,e,c,n),e.elementType=Mw,e.lanes=s,e.stateNode={isHidden:!1},e}function zy(e,n,s){return e=uo(6,e,null,n),e.lanes=s,e}function Ly(e,n,s){return n=uo(4,e.children!==null?e.children:[],e.key,n),n.lanes=s,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}function gA(e,n,s,c,f){this.tag=n,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=py(0),this.expirationTimes=py(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=py(0),this.identifierPrefix=c,this.onRecoverableError=f,this.mutableSourceEagerHydrationData=null}function H0(e,n,s,c,f,x,v,d,L){return e=new gA(e,n,s,d,L),n===1?(n=1,x===!0&&(n|=8)):n=0,x=uo(3,null,null,n),e.current=x,x.stateNode=e,x.memoizedState={element:c,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},k0(x),e}function yA(e,n,s){var c=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Pc,key:c==null?null:""+c,children:e,containerInfo:n,implementation:s}}function wS(e){if(!e)return Pa;e=e._reactInternals;e:{if(Il(e)!==e||e.tag!==1)throw Error(Be(170));var n=e;do{switch(n.tag){case 3:n=n.stateNode.context;break e;case 1:if(Ti(n.type)){n=n.stateNode.__reactInternalMemoizedMergedChildContext;break e}}n=n.return}while(n!==null);throw Error(Be(171))}if(e.tag===1){var s=e.type;if(Ti(s))return w2(e,s,n)}return n}function SS(e,n,s,c,f,x,v,d,L){return e=H0(s,c,!0,e,f,x,v,d,L),e.context=wS(null),s=e.current,c=hi(),f=Ea(s),x=Ms(c,f),x.callback=n??null,Ca(s,x,f),e.current.lanes=f,_d(e,f,c),Ci(e,c),e}function dm(e,n,s,c){var f=n.current,x=hi(),v=Ea(f);return s=wS(s),n.context===null?n.context=s:n.pendingContext=s,n=Ms(x,v),n.payload={element:e},c=c===void 0?null:c,c!==null&&(n.callback=c),e=Ca(f,n,v),e!==null&&(Lo(e,f,v,x),hf(e,f,v)),v}function Kf(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function db(e,n){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var s=e.retryLane;e.retryLane=s!==0&&s<n?s:n}}function W0(e,n){db(e,n),(e=e.alternate)&&db(e,n)}function _A(){return null}var TS=typeof reportError=="function"?reportError:function(e){console.error(e)};function G0(e){this._internalRoot=e}pm.prototype.render=G0.prototype.render=function(e){var n=this._internalRoot;if(n===null)throw Error(Be(409));dm(e,n,null,null)};pm.prototype.unmount=G0.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var n=e.containerInfo;Tl(function(){dm(null,e,null,null)}),n[Ls]=null}};function pm(e){this._internalRoot=e}pm.prototype.unstable_scheduleHydration=function(e){if(e){var n=t2();e={blockedOn:null,target:e,priority:n};for(var s=0;s<ma.length&&n!==0&&n<ma[s].priority;s++);ma.splice(s,0,e),s===0&&n2(e)}};function Z0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function fm(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function pb(){}function vA(e,n,s,c,f){if(f){if(typeof c=="function"){var x=c;c=function(){var U=Kf(v);x.call(U)}}var v=SS(n,c,e,0,null,!1,!1,"",pb);return e._reactRootContainer=v,e[Ls]=v.current,nd(e.nodeType===8?e.parentNode:e),Tl(),v}for(;f=e.lastChild;)e.removeChild(f);if(typeof c=="function"){var d=c;c=function(){var U=Kf(L);d.call(U)}}var L=H0(e,0,!1,null,null,!1,!1,"",pb);return e._reactRootContainer=L,e[Ls]=L.current,nd(e.nodeType===8?e.parentNode:e),Tl(function(){dm(n,L,s,c)}),L}function mm(e,n,s,c,f){var x=s._reactRootContainer;if(x){var v=x;if(typeof f=="function"){var d=f;f=function(){var L=Kf(v);d.call(L)}}dm(n,v,e,f)}else v=vA(s,n,e,f,c);return Kf(v)}Qw=function(e){switch(e.tag){case 3:var n=e.stateNode;if(n.current.memoizedState.isDehydrated){var s=Dh(n.pendingLanes);s!==0&&(p0(n,s|1),Ci(n,Hr()),!(jt&6)&&(ou=Hr()+500,La()))}break;case 13:Tl(function(){var c=Rs(e,1);if(c!==null){var f=hi();Lo(c,e,1,f)}}),W0(e,1)}};f0=function(e){if(e.tag===13){var n=Rs(e,134217728);if(n!==null){var s=hi();Lo(n,e,134217728,s)}W0(e,134217728)}};e2=function(e){if(e.tag===13){var n=Ea(e),s=Rs(e,n);if(s!==null){var c=hi();Lo(s,e,n,c)}W0(e,n)}};t2=function(){return tr};r2=function(e,n){var s=tr;try{return tr=e,n()}finally{tr=s}};n_=function(e,n,s){switch(n){case"input":if(Xy(e,s),n=s.name,s.type==="radio"&&n!=null){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),n=0;n<s.length;n++){var c=s[n];if(c!==e&&c.form===e.form){var f=om(c);if(!f)throw Error(Be(90));Lw(c),Xy(c,f)}}}break;case"textarea":Dw(e,s);break;case"select":n=s.value,n!=null&&jc(e,!!s.multiple,n,!1)}};jw=U0;Vw=Tl;var xA={usingClientEntryPoint:!1,Events:[xd,Dc,om,$w,Uw,U0]},Ph={findFiberByHostInstance:pl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},bA={bundleType:Ph.bundleType,version:Ph.version,rendererPackageName:Ph.rendererPackageName,rendererConfig:Ph.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Os.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Ww(e),e===null?null:e.stateNode},findFiberByHostInstance:Ph.findFiberByHostInstance||_A,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Jp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Jp.isDisabled&&Jp.supportsFiber)try{tm=Jp.inject(bA),ns=Jp}catch{}}Wi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xA;Wi.createPortal=function(e,n){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Z0(n))throw Error(Be(200));return yA(e,n,null,s)};Wi.createRoot=function(e,n){if(!Z0(e))throw Error(Be(299));var s=!1,c="",f=TS;return n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(c=n.identifierPrefix),n.onRecoverableError!==void 0&&(f=n.onRecoverableError)),n=H0(e,1,!1,null,null,s,!1,c,f),e[Ls]=n.current,nd(e.nodeType===8?e.parentNode:e),new G0(n)};Wi.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var n=e._reactInternals;if(n===void 0)throw typeof e.render=="function"?Error(Be(188)):(e=Object.keys(e).join(","),Error(Be(268,e)));return e=Ww(n),e=e===null?null:e.stateNode,e};Wi.flushSync=function(e){return Tl(e)};Wi.hydrate=function(e,n,s){if(!fm(n))throw Error(Be(200));return mm(null,e,n,!0,s)};Wi.hydrateRoot=function(e,n,s){if(!Z0(e))throw Error(Be(405));var c=s!=null&&s.hydratedSources||null,f=!1,x="",v=TS;if(s!=null&&(s.unstable_strictMode===!0&&(f=!0),s.identifierPrefix!==void 0&&(x=s.identifierPrefix),s.onRecoverableError!==void 0&&(v=s.onRecoverableError)),n=SS(n,null,e,1,s??null,f,!1,x,v),e[Ls]=n.current,nd(e),c)for(e=0;e<c.length;e++)s=c[e],f=s._getVersion,f=f(s._source),n.mutableSourceEagerHydrationData==null?n.mutableSourceEagerHydrationData=[s,f]:n.mutableSourceEagerHydrationData.push(s,f);return new pm(n)};Wi.render=function(e,n,s){if(!fm(n))throw Error(Be(200));return mm(null,e,n,!1,s)};Wi.unmountComponentAtNode=function(e){if(!fm(e))throw Error(Be(40));return e._reactRootContainer?(Tl(function(){mm(null,null,e,!1,function(){e._reactRootContainer=null,e[Ls]=null})}),!0):!1};Wi.unstable_batchedUpdates=U0;Wi.unstable_renderSubtreeIntoContainer=function(e,n,s,c){if(!fm(s))throw Error(Be(200));if(e==null||e._reactInternals===void 0)throw Error(Be(38));return mm(e,n,s,!1,c)};Wi.version="18.3.1-next-f1338f8080-20240426";function CS(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(CS)}catch(e){console.error(e)}}CS(),Cw.exports=Wi;var wA=Cw.exports,fb=wA;Vy.createRoot=fb.createRoot,Vy.hydrateRoot=fb.hydrateRoot;function On(e,n){if(e==null)return{};var s={};for(var c in e)if({}.hasOwnProperty.call(e,c)){if(n.indexOf(c)>=0)continue;s[c]=e[c]}return s}function ut(){return ut=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var c in s)({}).hasOwnProperty.call(s,c)&&(e[c]=s[c])}return e},ut.apply(null,arguments)}function IS(e){var n,s,c="";if(typeof e=="string"||typeof e=="number")c+=e;else if(typeof e=="object")if(Array.isArray(e)){var f=e.length;for(n=0;n<f;n++)e[n]&&(s=IS(e[n]))&&(c&&(c+=" "),c+=s)}else for(s in e)e[s]&&(c&&(c+=" "),c+=s);return c}function Rn(){for(var e,n,s=0,c="",f=arguments.length;s<f;s++)(e=arguments[s])&&(n=IS(e))&&(c&&(c+=" "),c+=n);return c}function El(e,n,s=void 0){const c={};return Object.keys(e).forEach(f=>{c[f]=e[f].reduce((x,v)=>{if(v){const d=n(v);d!==""&&x.push(d),s&&s[v]&&x.push(s[v])}return x},[]).join(" ")}),c}function B_(e,n){const s=ut({},n);return Object.keys(e).forEach(c=>{if(c.toString().match(/^(components|slots)$/))s[c]=ut({},e[c],s[c]);else if(c.toString().match(/^(componentsProps|slotProps)$/)){const f=e[c]||{},x=n[c];s[c]={},!x||!Object.keys(x)?s[c]=f:!f||!Object.keys(f)?s[c]=x:(s[c]=ut({},x),Object.keys(f).forEach(v=>{s[c][v]=B_(f[v],x[v])}))}else s[c]===void 0&&(s[c]=e[c])}),s}const SA=Ge.createContext(void 0);function TA(e){const{theme:n,name:s,props:c}=e;if(!n||!n.components||!n.components[s])return c;const f=n.components[s];return f.defaultProps?B_(f.defaultProps,c):!f.styleOverrides&&!f.variants?B_(f,c):c}function CA({props:e,name:n}){const s=Ge.useContext(SA);return TA({props:e,name:n,theme:{components:s}})}function Ra(e){return CA(e)}var wd={},ES={exports:{}};(function(e){function n(s){return s&&s.__esModule?s:{default:s}}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports})(ES);var K0=ES.exports,Ry={exports:{}},mb;function kS(){return mb||(mb=1,function(e){function n(){return e.exports=n=Object.assign?Object.assign.bind():function(s){for(var c=1;c<arguments.length;c++){var f=arguments[c];for(var x in f)({}).hasOwnProperty.call(f,x)&&(s[x]=f[x])}return s},e.exports.__esModule=!0,e.exports.default=e.exports,n.apply(null,arguments)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports}(Ry)),Ry.exports}var Dy={exports:{}},gb;function IA(){return gb||(gb=1,function(e){function n(s,c){if(s==null)return{};var f={};for(var x in s)if({}.hasOwnProperty.call(s,x)){if(c.indexOf(x)>=0)continue;f[x]=s[x]}return f}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports}(Dy)),Dy.exports}function AS(e){var n=Object.create(null);return function(s){return n[s]===void 0&&(n[s]=e(s)),n[s]}}var EA=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,kA=AS(function(e){return EA.test(e)||e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)<91}),AA=!1;function PA(e){if(e.sheet)return e.sheet;for(var n=0;n<document.styleSheets.length;n++)if(document.styleSheets[n].ownerNode===e)return document.styleSheets[n]}function MA(e){var n=document.createElement("style");return n.setAttribute("data-emotion",e.key),e.nonce!==void 0&&n.setAttribute("nonce",e.nonce),n.appendChild(document.createTextNode("")),n.setAttribute("data-s",""),n}var zA=function(){function e(s){var c=this;this._insertTag=function(f){var x;c.tags.length===0?c.insertionPoint?x=c.insertionPoint.nextSibling:c.prepend?x=c.container.firstChild:x=c.before:x=c.tags[c.tags.length-1].nextSibling,c.container.insertBefore(f,x),c.tags.push(f)},this.isSpeedy=s.speedy===void 0?!AA:s.speedy,this.tags=[],this.ctr=0,this.nonce=s.nonce,this.key=s.key,this.container=s.container,this.prepend=s.prepend,this.insertionPoint=s.insertionPoint,this.before=null}var n=e.prototype;return n.hydrate=function(c){c.forEach(this._insertTag)},n.insert=function(c){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(MA(this));var f=this.tags[this.tags.length-1];if(this.isSpeedy){var x=PA(f);try{x.insertRule(c,x.cssRules.length)}catch{}}else f.appendChild(document.createTextNode(c));this.ctr++},n.flush=function(){this.tags.forEach(function(c){var f;return(f=c.parentNode)==null?void 0:f.removeChild(c)}),this.tags=[],this.ctr=0},e}(),Yn="-ms-",Xf="-moz-",Kt="-webkit-",PS="comm",X0="rule",Y0="decl",LA="@import",MS="@keyframes",RA="@layer",DA=Math.abs,gm=String.fromCharCode,BA=Object.assign;function FA(e,n){return Dn(e,0)^45?(((n<<2^Dn(e,0))<<2^Dn(e,1))<<2^Dn(e,2))<<2^Dn(e,3):0}function zS(e){return e.trim()}function OA(e,n){return(e=n.exec(e))?e[0]:e}function Xt(e,n,s){return e.replace(n,s)}function F_(e,n){return e.indexOf(n)}function Dn(e,n){return e.charCodeAt(n)|0}function dd(e,n,s){return e.slice(n,s)}function Qo(e){return e.length}function J0(e){return e.length}function Qp(e,n){return n.push(e),e}function NA(e,n){return e.map(n).join("")}var ym=1,su=1,LS=0,Ii=0,tn=0,uu="";function _m(e,n,s,c,f,x,v){return{value:e,root:n,parent:s,type:c,props:f,children:x,line:ym,column:su,length:v,return:""}}function Mh(e,n){return BA(_m("",null,null,"",null,null,0),e,{length:-e.length},n)}function $A(){return tn}function UA(){return tn=Ii>0?Dn(uu,--Ii):0,su--,tn===10&&(su=1,ym--),tn}function qi(){return tn=Ii<LS?Dn(uu,Ii++):0,su++,tn===10&&(su=1,ym++),tn}function os(){return Dn(uu,Ii)}function _f(){return Ii}function Sd(e,n){return dd(uu,e,n)}function pd(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function RS(e){return ym=su=1,LS=Qo(uu=e),Ii=0,[]}function DS(e){return uu="",e}function vf(e){return zS(Sd(Ii-1,O_(e===91?e+2:e===40?e+1:e)))}function jA(e){for(;(tn=os())&&tn<33;)qi();return pd(e)>2||pd(tn)>3?"":" "}function VA(e,n){for(;--n&&qi()&&!(tn<48||tn>102||tn>57&&tn<65||tn>70&&tn<97););return Sd(e,_f()+(n<6&&os()==32&&qi()==32))}function O_(e){for(;qi();)switch(tn){case e:return Ii;case 34:case 39:e!==34&&e!==39&&O_(tn);break;case 40:e===41&&O_(e);break;case 92:qi();break}return Ii}function qA(e,n){for(;qi()&&e+tn!==57;)if(e+tn===84&&os()===47)break;return"/*"+Sd(n,Ii-1)+"*"+gm(e===47?e:qi())}function HA(e){for(;!pd(os());)qi();return Sd(e,Ii)}function WA(e){return DS(xf("",null,null,null,[""],e=RS(e),0,[0],e))}function xf(e,n,s,c,f,x,v,d,L){for(var U=0,Z=0,j=v,F=0,me=0,ye=0,pe=1,je=1,re=1,ee=0,ae="",xe=f,Ee=x,Pe=c,Ae=ae;je;)switch(ye=ee,ee=qi()){case 40:if(ye!=108&&Dn(Ae,j-1)==58){F_(Ae+=Xt(vf(ee),"&","&\f"),"&\f")!=-1&&(re=-1);break}case 34:case 39:case 91:Ae+=vf(ee);break;case 9:case 10:case 13:case 32:Ae+=jA(ye);break;case 92:Ae+=VA(_f()-1,7);continue;case 47:switch(os()){case 42:case 47:Qp(GA(qA(qi(),_f()),n,s),L);break;default:Ae+="/"}break;case 123*pe:d[U++]=Qo(Ae)*re;case 125*pe:case 59:case 0:switch(ee){case 0:case 125:je=0;case 59+Z:re==-1&&(Ae=Xt(Ae,/\f/g,"")),me>0&&Qo(Ae)-j&&Qp(me>32?_b(Ae+";",c,s,j-1):_b(Xt(Ae," ","")+";",c,s,j-2),L);break;case 59:Ae+=";";default:if(Qp(Pe=yb(Ae,n,s,U,Z,f,d,ae,xe=[],Ee=[],j),x),ee===123)if(Z===0)xf(Ae,n,Pe,Pe,xe,x,j,d,Ee);else switch(F===99&&Dn(Ae,3)===110?100:F){case 100:case 108:case 109:case 115:xf(e,Pe,Pe,c&&Qp(yb(e,Pe,Pe,0,0,f,d,ae,f,xe=[],j),Ee),f,Ee,j,d,c?xe:Ee);break;default:xf(Ae,Pe,Pe,Pe,[""],Ee,0,d,Ee)}}U=Z=me=0,pe=re=1,ae=Ae="",j=v;break;case 58:j=1+Qo(Ae),me=ye;default:if(pe<1){if(ee==123)--pe;else if(ee==125&&pe++==0&&UA()==125)continue}switch(Ae+=gm(ee),ee*pe){case 38:re=Z>0?1:(Ae+="\f",-1);break;case 44:d[U++]=(Qo(Ae)-1)*re,re=1;break;case 64:os()===45&&(Ae+=vf(qi())),F=os(),Z=j=Qo(ae=Ae+=HA(_f())),ee++;break;case 45:ye===45&&Qo(Ae)==2&&(pe=0)}}return x}function yb(e,n,s,c,f,x,v,d,L,U,Z){for(var j=f-1,F=f===0?x:[""],me=J0(F),ye=0,pe=0,je=0;ye<c;++ye)for(var re=0,ee=dd(e,j+1,j=DA(pe=v[ye])),ae=e;re<me;++re)(ae=zS(pe>0?F[re]+" "+ee:Xt(ee,/&\f/g,F[re])))&&(L[je++]=ae);return _m(e,n,s,f===0?X0:d,L,U,Z)}function GA(e,n,s){return _m(e,n,s,PS,gm($A()),dd(e,2,-2),0)}function _b(e,n,s,c){return _m(e,n,s,Y0,dd(e,0,c),dd(e,c+1,-1),c)}function Zc(e,n){for(var s="",c=J0(e),f=0;f<c;f++)s+=n(e[f],f,e,n)||"";return s}function ZA(e,n,s,c){switch(e.type){case RA:if(e.children.length)break;case LA:case Y0:return e.return=e.return||e.value;case PS:return"";case MS:return e.return=e.value+"{"+Zc(e.children,c)+"}";case X0:e.value=e.props.join(",")}return Qo(s=Zc(e.children,c))?e.return=e.value+"{"+s+"}":""}function KA(e){var n=J0(e);return function(s,c,f,x){for(var v="",d=0;d<n;d++)v+=e[d](s,c,f,x)||"";return v}}function XA(e){return function(n){n.root||(n=n.return)&&e(n)}}var YA=function(n,s,c){for(var f=0,x=0;f=x,x=os(),f===38&&x===12&&(s[c]=1),!pd(x);)qi();return Sd(n,Ii)},JA=function(n,s){var c=-1,f=44;do switch(pd(f)){case 0:f===38&&os()===12&&(s[c]=1),n[c]+=YA(Ii-1,s,c);break;case 2:n[c]+=vf(f);break;case 4:if(f===44){n[++c]=os()===58?"&\f":"",s[c]=n[c].length;break}default:n[c]+=gm(f)}while(f=qi());return n},QA=function(n,s){return DS(JA(RS(n),s))},vb=new WeakMap,eP=function(n){if(!(n.type!=="rule"||!n.parent||n.length<1)){for(var s=n.value,c=n.parent,f=n.column===c.column&&n.line===c.line;c.type!=="rule";)if(c=c.parent,!c)return;if(!(n.props.length===1&&s.charCodeAt(0)!==58&&!vb.get(c))&&!f){vb.set(n,!0);for(var x=[],v=QA(s,x),d=c.props,L=0,U=0;L<v.length;L++)for(var Z=0;Z<d.length;Z++,U++)n.props[U]=x[L]?v[L].replace(/&\f/g,d[Z]):d[Z]+" "+v[L]}}},tP=function(n){if(n.type==="decl"){var s=n.value;s.charCodeAt(0)===108&&s.charCodeAt(2)===98&&(n.return="",n.value="")}};function BS(e,n){switch(FA(e,n)){case 5103:return Kt+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Kt+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Kt+e+Xf+e+Yn+e+e;case 6828:case 4268:return Kt+e+Yn+e+e;case 6165:return Kt+e+Yn+"flex-"+e+e;case 5187:return Kt+e+Xt(e,/(\w+).+(:[^]+)/,Kt+"box-$1$2"+Yn+"flex-$1$2")+e;case 5443:return Kt+e+Yn+"flex-item-"+Xt(e,/flex-|-self/,"")+e;case 4675:return Kt+e+Yn+"flex-line-pack"+Xt(e,/align-content|flex-|-self/,"")+e;case 5548:return Kt+e+Yn+Xt(e,"shrink","negative")+e;case 5292:return Kt+e+Yn+Xt(e,"basis","preferred-size")+e;case 6060:return Kt+"box-"+Xt(e,"-grow","")+Kt+e+Yn+Xt(e,"grow","positive")+e;case 4554:return Kt+Xt(e,/([^-])(transform)/g,"$1"+Kt+"$2")+e;case 6187:return Xt(Xt(Xt(e,/(zoom-|grab)/,Kt+"$1"),/(image-set)/,Kt+"$1"),e,"")+e;case 5495:case 3959:return Xt(e,/(image-set\([^]*)/,Kt+"$1$`$1");case 4968:return Xt(Xt(e,/(.+:)(flex-)?(.*)/,Kt+"box-pack:$3"+Yn+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Kt+e+e;case 4095:case 3583:case 4068:case 2532:return Xt(e,/(.+)-inline(.+)/,Kt+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Qo(e)-1-n>6)switch(Dn(e,n+1)){case 109:if(Dn(e,n+4)!==45)break;case 102:return Xt(e,/(.+:)(.+)-([^]+)/,"$1"+Kt+"$2-$3$1"+Xf+(Dn(e,n+3)==108?"$3":"$2-$3"))+e;case 115:return~F_(e,"stretch")?BS(Xt(e,"stretch","fill-available"),n)+e:e}break;case 4949:if(Dn(e,n+1)!==115)break;case 6444:switch(Dn(e,Qo(e)-3-(~F_(e,"!important")&&10))){case 107:return Xt(e,":",":"+Kt)+e;case 101:return Xt(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Kt+(Dn(e,14)===45?"inline-":"")+"box$3$1"+Kt+"$2$3$1"+Yn+"$2box$3")+e}break;case 5936:switch(Dn(e,n+11)){case 114:return Kt+e+Yn+Xt(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Kt+e+Yn+Xt(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Kt+e+Yn+Xt(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Kt+e+Yn+e+e}return e}var rP=function(n,s,c,f){if(n.length>-1&&!n.return)switch(n.type){case Y0:n.return=BS(n.value,n.length);break;case MS:return Zc([Mh(n,{value:Xt(n.value,"@","@"+Kt)})],f);case X0:if(n.length)return NA(n.props,function(x){switch(OA(x,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Zc([Mh(n,{props:[Xt(x,/:(read-\w+)/,":"+Xf+"$1")]})],f);case"::placeholder":return Zc([Mh(n,{props:[Xt(x,/:(plac\w+)/,":"+Kt+"input-$1")]}),Mh(n,{props:[Xt(x,/:(plac\w+)/,":"+Xf+"$1")]}),Mh(n,{props:[Xt(x,/:(plac\w+)/,Yn+"input-$1")]})],f)}return""})}},nP=[rP],FS=function(n){var s=n.key;if(s==="css"){var c=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(c,function(pe){var je=pe.getAttribute("data-emotion");je.indexOf(" ")!==-1&&(document.head.appendChild(pe),pe.setAttribute("data-s",""))})}var f=n.stylisPlugins||nP,x={},v,d=[];v=n.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+s+' "]'),function(pe){for(var je=pe.getAttribute("data-emotion").split(" "),re=1;re<je.length;re++)x[je[re]]=!0;d.push(pe)});var L,U=[eP,tP];{var Z,j=[ZA,XA(function(pe){Z.insert(pe)})],F=KA(U.concat(f,j)),me=function(je){return Zc(WA(je),F)};L=function(je,re,ee,ae){Z=ee,me(je?je+"{"+re.styles+"}":re.styles),ae&&(ye.inserted[re.name]=!0)}}var ye={key:s,sheet:new zA({key:s,container:v,nonce:n.nonce,speedy:n.speedy,prepend:n.prepend,insertionPoint:n.insertionPoint}),nonce:n.nonce,inserted:x,registered:{},insert:L};return ye.sheet.hydrate(d),ye},OS={exports:{}},rr={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sn=typeof Symbol=="function"&&Symbol.for,Q0=Sn?Symbol.for("react.element"):60103,ev=Sn?Symbol.for("react.portal"):60106,vm=Sn?Symbol.for("react.fragment"):60107,xm=Sn?Symbol.for("react.strict_mode"):60108,bm=Sn?Symbol.for("react.profiler"):60114,wm=Sn?Symbol.for("react.provider"):60109,Sm=Sn?Symbol.for("react.context"):60110,tv=Sn?Symbol.for("react.async_mode"):60111,Tm=Sn?Symbol.for("react.concurrent_mode"):60111,Cm=Sn?Symbol.for("react.forward_ref"):60112,Im=Sn?Symbol.for("react.suspense"):60113,iP=Sn?Symbol.for("react.suspense_list"):60120,Em=Sn?Symbol.for("react.memo"):60115,km=Sn?Symbol.for("react.lazy"):60116,oP=Sn?Symbol.for("react.block"):60121,sP=Sn?Symbol.for("react.fundamental"):60117,aP=Sn?Symbol.for("react.responder"):60118,lP=Sn?Symbol.for("react.scope"):60119;function Zi(e){if(typeof e=="object"&&e!==null){var n=e.$$typeof;switch(n){case Q0:switch(e=e.type,e){case tv:case Tm:case vm:case bm:case xm:case Im:return e;default:switch(e=e&&e.$$typeof,e){case Sm:case Cm:case km:case Em:case wm:return e;default:return n}}case ev:return n}}}function NS(e){return Zi(e)===Tm}rr.AsyncMode=tv;rr.ConcurrentMode=Tm;rr.ContextConsumer=Sm;rr.ContextProvider=wm;rr.Element=Q0;rr.ForwardRef=Cm;rr.Fragment=vm;rr.Lazy=km;rr.Memo=Em;rr.Portal=ev;rr.Profiler=bm;rr.StrictMode=xm;rr.Suspense=Im;rr.isAsyncMode=function(e){return NS(e)||Zi(e)===tv};rr.isConcurrentMode=NS;rr.isContextConsumer=function(e){return Zi(e)===Sm};rr.isContextProvider=function(e){return Zi(e)===wm};rr.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===Q0};rr.isForwardRef=function(e){return Zi(e)===Cm};rr.isFragment=function(e){return Zi(e)===vm};rr.isLazy=function(e){return Zi(e)===km};rr.isMemo=function(e){return Zi(e)===Em};rr.isPortal=function(e){return Zi(e)===ev};rr.isProfiler=function(e){return Zi(e)===bm};rr.isStrictMode=function(e){return Zi(e)===xm};rr.isSuspense=function(e){return Zi(e)===Im};rr.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===vm||e===Tm||e===bm||e===xm||e===Im||e===iP||typeof e=="object"&&e!==null&&(e.$$typeof===km||e.$$typeof===Em||e.$$typeof===wm||e.$$typeof===Sm||e.$$typeof===Cm||e.$$typeof===sP||e.$$typeof===aP||e.$$typeof===lP||e.$$typeof===oP)};rr.typeOf=Zi;OS.exports=rr;var cP=OS.exports,$S=cP,uP={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},hP={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},US={};US[$S.ForwardRef]=uP;US[$S.Memo]=hP;var dP=!0;function pP(e,n,s){var c="";return s.split(" ").forEach(function(f){e[f]!==void 0?n.push(e[f]+";"):c+=f+" "}),c}var jS=function(n,s,c){var f=n.key+"-"+s.name;(c===!1||dP===!1)&&n.registered[f]===void 0&&(n.registered[f]=s.styles)},VS=function(n,s,c){jS(n,s,c);var f=n.key+"-"+s.name;if(n.inserted[s.name]===void 0){var x=s;do n.insert(s===x?"."+f:"",x,n.sheet,!0),x=x.next;while(x!==void 0)}};function fP(e){for(var n=0,s,c=0,f=e.length;f>=4;++c,f-=4)s=e.charCodeAt(c)&255|(e.charCodeAt(++c)&255)<<8|(e.charCodeAt(++c)&255)<<16|(e.charCodeAt(++c)&255)<<24,s=(s&65535)*1540483477+((s>>>16)*59797<<16),s^=s>>>24,n=(s&65535)*1540483477+((s>>>16)*59797<<16)^(n&65535)*1540483477+((n>>>16)*59797<<16);switch(f){case 3:n^=(e.charCodeAt(c+2)&255)<<16;case 2:n^=(e.charCodeAt(c+1)&255)<<8;case 1:n^=e.charCodeAt(c)&255,n=(n&65535)*1540483477+((n>>>16)*59797<<16)}return n^=n>>>13,n=(n&65535)*1540483477+((n>>>16)*59797<<16),((n^n>>>15)>>>0).toString(36)}var mP={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},gP=!1,yP=/[A-Z]|^ms/g,_P=/_EMO_([^_]+?)_([^]*?)_EMO_/g,qS=function(n){return n.charCodeAt(1)===45},xb=function(n){return n!=null&&typeof n!="boolean"},By=AS(function(e){return qS(e)?e:e.replace(yP,"-$&").toLowerCase()}),bb=function(n,s){switch(n){case"animation":case"animationName":if(typeof s=="string")return s.replace(_P,function(c,f,x){return es={name:f,styles:x,next:es},f})}return mP[n]!==1&&!qS(n)&&typeof s=="number"&&s!==0?s+"px":s},vP="Component selectors can only be used in conjunction with @emotion/babel-plugin, the swc Emotion plugin, or another Emotion-aware compiler transform.";function fd(e,n,s){if(s==null)return"";var c=s;if(c.__emotion_styles!==void 0)return c;switch(typeof s){case"boolean":return"";case"object":{var f=s;if(f.anim===1)return es={name:f.name,styles:f.styles,next:es},f.name;var x=s;if(x.styles!==void 0){var v=x.next;if(v!==void 0)for(;v!==void 0;)es={name:v.name,styles:v.styles,next:es},v=v.next;var d=x.styles+";";return d}return xP(e,n,s)}case"function":{if(e!==void 0){var L=es,U=s(e);return es=L,fd(e,n,U)}break}}var Z=s;if(n==null)return Z;var j=n[Z];return j!==void 0?j:Z}function xP(e,n,s){var c="";if(Array.isArray(s))for(var f=0;f<s.length;f++)c+=fd(e,n,s[f])+";";else for(var x in s){var v=s[x];if(typeof v!="object"){var d=v;n!=null&&n[d]!==void 0?c+=x+"{"+n[d]+"}":xb(d)&&(c+=By(x)+":"+bb(x,d)+";")}else{if(x==="NO_COMPONENT_SELECTOR"&&gP)throw new Error(vP);if(Array.isArray(v)&&typeof v[0]=="string"&&(n==null||n[v[0]]===void 0))for(var L=0;L<v.length;L++)xb(v[L])&&(c+=By(x)+":"+bb(x,v[L])+";");else{var U=fd(e,n,v);switch(x){case"animation":case"animationName":{c+=By(x)+":"+U+";";break}default:c+=x+"{"+U+"}"}}}}return c}var wb=/label:\s*([^\s;\n{]+)\s*(;|$)/g,es;function rv(e,n,s){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var c=!0,f="";es=void 0;var x=e[0];if(x==null||x.raw===void 0)c=!1,f+=fd(s,n,x);else{var v=x;f+=v[0]}for(var d=1;d<e.length;d++)if(f+=fd(s,n,e[d]),c){var L=x;f+=L[d]}wb.lastIndex=0;for(var U="",Z;(Z=wb.exec(f))!==null;)U+="-"+Z[1];var j=fP(f)+U;return{name:j,styles:f,next:es}}var bP=function(n){return n()},HS=jy.useInsertionEffect?jy.useInsertionEffect:!1,wP=HS||bP,Sb=HS||Ge.useLayoutEffect,WS=Ge.createContext(typeof HTMLElement<"u"?FS({key:"css"}):null),SP=WS.Provider,GS=function(n){return Ge.forwardRef(function(s,c){var f=Ge.useContext(WS);return n(s,f,c)})},Am=Ge.createContext({});kS();var TP=GS(function(e,n){var s=e.styles,c=rv([s],void 0,Ge.useContext(Am)),f=Ge.useRef();return Sb(function(){var x=n.key+"-global",v=new n.sheet.constructor({key:x,nonce:n.sheet.nonce,container:n.sheet.container,speedy:n.sheet.isSpeedy}),d=!1,L=document.querySelector('style[data-emotion="'+x+" "+c.name+'"]');return n.sheet.tags.length&&(v.before=n.sheet.tags[0]),L!==null&&(d=!0,L.setAttribute("data-emotion",x),v.hydrate([L])),f.current=[v,d],function(){v.flush()}},[n]),Sb(function(){var x=f.current,v=x[0],d=x[1];if(d){x[1]=!1;return}if(c.next!==void 0&&VS(n,c.next,!0),v.tags.length){var L=v.tags[v.tags.length-1].nextElementSibling;v.before=L,v.flush()}n.insert("",c,v,!1)},[n,c.name]),null});function ZS(){for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];return rv(n)}var Pm=function(){var n=ZS.apply(void 0,arguments),s="animation-"+n.name;return{name:s,styles:"@keyframes "+s+"{"+n.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},CP=kA,IP=function(n){return n!=="theme"},Tb=function(n){return typeof n=="string"&&n.charCodeAt(0)>96?CP:IP},Cb=function(n,s,c){var f;if(s){var x=s.shouldForwardProp;f=n.__emotion_forwardProp&&x?function(v){return n.__emotion_forwardProp(v)&&x(v)}:x}return typeof f!="function"&&c&&(f=n.__emotion_forwardProp),f},EP=!1,kP=function(n){var s=n.cache,c=n.serialized,f=n.isStringTag;return jS(s,c,f),wP(function(){return VS(s,c,f)}),null},AP=function e(n,s){var c=n.__emotion_real===n,f=c&&n.__emotion_base||n,x,v;s!==void 0&&(x=s.label,v=s.target);var d=Cb(n,s,c),L=d||Tb(f),U=!L("as");return function(){var Z=arguments,j=c&&n.__emotion_styles!==void 0?n.__emotion_styles.slice(0):[];if(x!==void 0&&j.push("label:"+x+";"),Z[0]==null||Z[0].raw===void 0)j.push.apply(j,Z);else{j.push(Z[0][0]);for(var F=Z.length,me=1;me<F;me++)j.push(Z[me],Z[0][me])}var ye=GS(function(pe,je,re){var ee=U&&pe.as||f,ae="",xe=[],Ee=pe;if(pe.theme==null){Ee={};for(var Pe in pe)Ee[Pe]=pe[Pe];Ee.theme=Ge.useContext(Am)}typeof pe.className=="string"?ae=pP(je.registered,xe,pe.className):pe.className!=null&&(ae=pe.className+" ");var Ae=rv(j.concat(xe),je.registered,Ee);ae+=je.key+"-"+Ae.name,v!==void 0&&(ae+=" "+v);var Ke=U&&d===void 0?Tb(ee):L,vt={};for(var ot in pe)U&&ot==="as"||Ke(ot)&&(vt[ot]=pe[ot]);return vt.className=ae,re&&(vt.ref=re),Ge.createElement(Ge.Fragment,null,Ge.createElement(kP,{cache:je,serialized:Ae,isStringTag:typeof ee=="string"}),Ge.createElement(ee,vt))});return ye.displayName=x!==void 0?x:"Styled("+(typeof f=="string"?f:f.displayName||f.name||"Component")+")",ye.defaultProps=n.defaultProps,ye.__emotion_real=ye,ye.__emotion_base=f,ye.__emotion_styles=j,ye.__emotion_forwardProp=d,Object.defineProperty(ye,"toString",{value:function(){return v===void 0&&EP?"NO_COMPONENT_SELECTOR":"."+v}}),ye.withComponent=function(pe,je){return e(pe,ut({},s,je,{shouldForwardProp:Cb(ye,je,!0)})).apply(void 0,j)},ye}},PP=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],N_=AP.bind();PP.forEach(function(e){N_[e]=N_(e)});let $_;typeof document=="object"&&($_=FS({key:"css",prepend:!0}));function MP(e){const{injectFirst:n,children:s}=e;return n&&$_?qt.jsx(SP,{value:$_,children:s}):s}function zP(e){return e==null||Object.keys(e).length===0}function LP(e){const{styles:n,defaultTheme:s={}}=e,c=typeof n=="function"?f=>n(zP(f)?s:f):n;return qt.jsx(TP,{styles:c})}function KS(e,n){return N_(e,n)}const RP=(e,n)=>{Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=n(e.__emotion_styles))},DP=Object.freeze(Object.defineProperty({__proto__:null,GlobalStyles:LP,StyledEngineProvider:MP,ThemeContext:Am,css:ZS,default:KS,internal_processStyles:RP,keyframes:Pm},Symbol.toStringTag,{value:"Module"})),BP=Fs(DP);function ya(e){if(typeof e!="object"||e===null)return!1;const n=Object.getPrototypeOf(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function XS(e){if(!ya(e))return e;const n={};return Object.keys(e).forEach(s=>{n[s]=XS(e[s])}),n}function ss(e,n,s={clone:!0}){const c=s.clone?ut({},e):e;return ya(e)&&ya(n)&&Object.keys(n).forEach(f=>{ya(n[f])&&Object.prototype.hasOwnProperty.call(e,f)&&ya(e[f])?c[f]=ss(e[f],n[f],s):s.clone?c[f]=ya(n[f])?XS(n[f]):n[f]:c[f]=n[f]}),c}const FP=Object.freeze(Object.defineProperty({__proto__:null,default:ss,isPlainObject:ya},Symbol.toStringTag,{value:"Module"})),OP=Fs(FP);function md(e){let n="https://mui.com/production-error/?code="+e;for(let s=1;s<arguments.length;s+=1)n+="&args[]="+encodeURIComponent(arguments[s]);return"Minified MUI error #"+e+"; visit "+n+" for the full message."}const NP=Object.freeze(Object.defineProperty({__proto__:null,default:md},Symbol.toStringTag,{value:"Module"}));function nn(e){if(typeof e!="string")throw new Error(md(7));return e.charAt(0).toUpperCase()+e.slice(1)}const $P=Object.freeze(Object.defineProperty({__proto__:null,default:nn},Symbol.toStringTag,{value:"Module"})),UP=Fs($P);var YS={exports:{}},nr={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nv=Symbol.for("react.element"),iv=Symbol.for("react.portal"),Mm=Symbol.for("react.fragment"),zm=Symbol.for("react.strict_mode"),Lm=Symbol.for("react.profiler"),Rm=Symbol.for("react.provider"),Dm=Symbol.for("react.context"),jP=Symbol.for("react.server_context"),Bm=Symbol.for("react.forward_ref"),Fm=Symbol.for("react.suspense"),Om=Symbol.for("react.suspense_list"),Nm=Symbol.for("react.memo"),$m=Symbol.for("react.lazy"),VP=Symbol.for("react.offscreen"),JS;JS=Symbol.for("react.module.reference");function go(e){if(typeof e=="object"&&e!==null){var n=e.$$typeof;switch(n){case nv:switch(e=e.type,e){case Mm:case Lm:case zm:case Fm:case Om:return e;default:switch(e=e&&e.$$typeof,e){case jP:case Dm:case Bm:case $m:case Nm:case Rm:return e;default:return n}}case iv:return n}}}nr.ContextConsumer=Dm;nr.ContextProvider=Rm;nr.Element=nv;nr.ForwardRef=Bm;nr.Fragment=Mm;nr.Lazy=$m;nr.Memo=Nm;nr.Portal=iv;nr.Profiler=Lm;nr.StrictMode=zm;nr.Suspense=Fm;nr.SuspenseList=Om;nr.isAsyncMode=function(){return!1};nr.isConcurrentMode=function(){return!1};nr.isContextConsumer=function(e){return go(e)===Dm};nr.isContextProvider=function(e){return go(e)===Rm};nr.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===nv};nr.isForwardRef=function(e){return go(e)===Bm};nr.isFragment=function(e){return go(e)===Mm};nr.isLazy=function(e){return go(e)===$m};nr.isMemo=function(e){return go(e)===Nm};nr.isPortal=function(e){return go(e)===iv};nr.isProfiler=function(e){return go(e)===Lm};nr.isStrictMode=function(e){return go(e)===zm};nr.isSuspense=function(e){return go(e)===Fm};nr.isSuspenseList=function(e){return go(e)===Om};nr.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Mm||e===Lm||e===zm||e===Fm||e===Om||e===VP||typeof e=="object"&&e!==null&&(e.$$typeof===$m||e.$$typeof===Nm||e.$$typeof===Rm||e.$$typeof===Dm||e.$$typeof===Bm||e.$$typeof===JS||e.getModuleId!==void 0)};nr.typeOf=go;YS.exports=nr;var Ib=YS.exports;const qP=/^\s*function(?:\s|\s*\/\*.*\*\/\s*)+([^(\s/]*)\s*/;function QS(e){const n=`${e}`.match(qP);return n&&n[1]||""}function eT(e,n=""){return e.displayName||e.name||QS(e)||n}function Eb(e,n,s){const c=eT(n);return e.displayName||(c!==""?`${s}(${c})`:s)}function HP(e){if(e!=null){if(typeof e=="string")return e;if(typeof e=="function")return eT(e,"Component");if(typeof e=="object")switch(e.$$typeof){case Ib.ForwardRef:return Eb(e,e.render,"ForwardRef");case Ib.Memo:return Eb(e,e.type,"memo");default:return}}}const WP=Object.freeze(Object.defineProperty({__proto__:null,default:HP,getFunctionName:QS},Symbol.toStringTag,{value:"Module"})),GP=Fs(WP),ZP=["values","unit","step"],KP=e=>{const n=Object.keys(e).map(s=>({key:s,val:e[s]}))||[];return n.sort((s,c)=>s.val-c.val),n.reduce((s,c)=>ut({},s,{[c.key]:c.val}),{})};function tT(e){const{values:n={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:s="px",step:c=5}=e,f=On(e,ZP),x=KP(n),v=Object.keys(x);function d(F){return`@media (min-width:${typeof n[F]=="number"?n[F]:F}${s})`}function L(F){return`@media (max-width:${(typeof n[F]=="number"?n[F]:F)-c/100}${s})`}function U(F,me){const ye=v.indexOf(me);return`@media (min-width:${typeof n[F]=="number"?n[F]:F}${s}) and (max-width:${(ye!==-1&&typeof n[v[ye]]=="number"?n[v[ye]]:me)-c/100}${s})`}function Z(F){return v.indexOf(F)+1<v.length?U(F,v[v.indexOf(F)+1]):d(F)}function j(F){const me=v.indexOf(F);return me===0?d(v[1]):me===v.length-1?L(v[me]):U(F,v[v.indexOf(F)+1]).replace("@media","@media not all and")}return ut({keys:v,values:x,up:d,down:L,between:U,only:Z,not:j,unit:s},f)}const XP={borderRadius:4};function Zh(e,n){return n?ss(e,n,{clone:!1}):e}const ov={xs:0,sm:600,md:900,lg:1200,xl:1536},kb={keys:["xs","sm","md","lg","xl"],up:e=>`@media (min-width:${ov[e]}px)`};function Bs(e,n,s){const c=e.theme||{};if(Array.isArray(n)){const x=c.breakpoints||kb;return n.reduce((v,d,L)=>(v[x.up(x.keys[L])]=s(n[L]),v),{})}if(typeof n=="object"){const x=c.breakpoints||kb;return Object.keys(n).reduce((v,d)=>{if(Object.keys(x.values||ov).indexOf(d)!==-1){const L=x.up(d);v[L]=s(n[d],d)}else{const L=d;v[L]=n[L]}return v},{})}return s(n)}function YP(e={}){var n;return((n=e.keys)==null?void 0:n.reduce((c,f)=>{const x=e.up(f);return c[x]={},c},{}))||{}}function JP(e,n){return e.reduce((s,c)=>{const f=s[c];return(!f||Object.keys(f).length===0)&&delete s[c],s},n)}function Um(e,n,s=!0){if(!n||typeof n!="string")return null;if(e&&e.vars&&s){const c=`vars.${n}`.split(".").reduce((f,x)=>f&&f[x]?f[x]:null,e);if(c!=null)return c}return n.split(".").reduce((c,f)=>c&&c[f]!=null?c[f]:null,e)}function Yf(e,n,s,c=s){let f;return typeof e=="function"?f=e(s):Array.isArray(e)?f=e[s]||c:f=Um(e,s)||c,n&&(f=n(f,c,e)),f}function Wr(e){const{prop:n,cssProperty:s=e.prop,themeKey:c,transform:f}=e,x=v=>{if(v[n]==null)return null;const d=v[n],L=v.theme,U=Um(L,c)||{};return Bs(v,d,j=>{let F=Yf(U,f,j);return j===F&&typeof j=="string"&&(F=Yf(U,f,`${n}${j==="default"?"":nn(j)}`,j)),s===!1?F:{[s]:F}})};return x.propTypes={},x.filterProps=[n],x}function QP(e){const n={};return s=>(n[s]===void 0&&(n[s]=e(s)),n[s])}const eM={m:"margin",p:"padding"},tM={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},Ab={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},rM=QP(e=>{if(e.length>2)if(Ab[e])e=Ab[e];else return[e];const[n,s]=e.split(""),c=eM[n],f=tM[s]||"";return Array.isArray(f)?f.map(x=>c+x):[c+f]}),sv=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],av=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...sv,...av];function Td(e,n,s,c){var f;const x=(f=Um(e,n,!1))!=null?f:s;return typeof x=="number"?v=>typeof v=="string"?v:x*v:Array.isArray(x)?v=>typeof v=="string"?v:x[v]:typeof x=="function"?x:()=>{}}function rT(e){return Td(e,"spacing",8)}function Cd(e,n){if(typeof n=="string"||n==null)return n;const s=Math.abs(n),c=e(s);return n>=0?c:typeof c=="number"?-c:`-${c}`}function nM(e,n){return s=>e.reduce((c,f)=>(c[f]=Cd(n,s),c),{})}function iM(e,n,s,c){if(n.indexOf(s)===-1)return null;const f=rM(s),x=nM(f,c),v=e[s];return Bs(e,v,x)}function nT(e,n){const s=rT(e.theme);return Object.keys(e).map(c=>iM(e,n,c,s)).reduce(Zh,{})}function Or(e){return nT(e,sv)}Or.propTypes={};Or.filterProps=sv;function Nr(e){return nT(e,av)}Nr.propTypes={};Nr.filterProps=av;function oM(e=8){if(e.mui)return e;const n=rT({spacing:e}),s=(...c)=>(c.length===0?[1]:c).map(x=>{const v=n(x);return typeof v=="number"?`${v}px`:v}).join(" ");return s.mui=!0,s}function jm(...e){const n=e.reduce((c,f)=>(f.filterProps.forEach(x=>{c[x]=f}),c),{}),s=c=>Object.keys(c).reduce((f,x)=>n[x]?Zh(f,n[x](c)):f,{});return s.propTypes={},s.filterProps=e.reduce((c,f)=>c.concat(f.filterProps),[]),s}function co(e){return typeof e!="number"?e:`${e}px solid`}function yo(e,n){return Wr({prop:e,themeKey:"borders",transform:n})}const sM=yo("border",co),aM=yo("borderTop",co),lM=yo("borderRight",co),cM=yo("borderBottom",co),uM=yo("borderLeft",co),hM=yo("borderColor"),dM=yo("borderTopColor"),pM=yo("borderRightColor"),fM=yo("borderBottomColor"),mM=yo("borderLeftColor"),gM=yo("outline",co),yM=yo("outlineColor"),Vm=e=>{if(e.borderRadius!==void 0&&e.borderRadius!==null){const n=Td(e.theme,"shape.borderRadius",4),s=c=>({borderRadius:Cd(n,c)});return Bs(e,e.borderRadius,s)}return null};Vm.propTypes={};Vm.filterProps=["borderRadius"];jm(sM,aM,lM,cM,uM,hM,dM,pM,fM,mM,Vm,gM,yM);const qm=e=>{if(e.gap!==void 0&&e.gap!==null){const n=Td(e.theme,"spacing",8),s=c=>({gap:Cd(n,c)});return Bs(e,e.gap,s)}return null};qm.propTypes={};qm.filterProps=["gap"];const Hm=e=>{if(e.columnGap!==void 0&&e.columnGap!==null){const n=Td(e.theme,"spacing",8),s=c=>({columnGap:Cd(n,c)});return Bs(e,e.columnGap,s)}return null};Hm.propTypes={};Hm.filterProps=["columnGap"];const Wm=e=>{if(e.rowGap!==void 0&&e.rowGap!==null){const n=Td(e.theme,"spacing",8),s=c=>({rowGap:Cd(n,c)});return Bs(e,e.rowGap,s)}return null};Wm.propTypes={};Wm.filterProps=["rowGap"];const _M=Wr({prop:"gridColumn"}),vM=Wr({prop:"gridRow"}),xM=Wr({prop:"gridAutoFlow"}),bM=Wr({prop:"gridAutoColumns"}),wM=Wr({prop:"gridAutoRows"}),SM=Wr({prop:"gridTemplateColumns"}),TM=Wr({prop:"gridTemplateRows"}),CM=Wr({prop:"gridTemplateAreas"}),IM=Wr({prop:"gridArea"});jm(qm,Hm,Wm,_M,vM,xM,bM,wM,SM,TM,CM,IM);function Kc(e,n){return n==="grey"?n:e}const EM=Wr({prop:"color",themeKey:"palette",transform:Kc}),kM=Wr({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:Kc}),AM=Wr({prop:"backgroundColor",themeKey:"palette",transform:Kc});jm(EM,kM,AM);function Ui(e){return e<=1&&e!==0?`${e*100}%`:e}const PM=Wr({prop:"width",transform:Ui}),lv=e=>{if(e.maxWidth!==void 0&&e.maxWidth!==null){const n=s=>{var c,f;const x=((c=e.theme)==null||(c=c.breakpoints)==null||(c=c.values)==null?void 0:c[s])||ov[s];return x?((f=e.theme)==null||(f=f.breakpoints)==null?void 0:f.unit)!=="px"?{maxWidth:`${x}${e.theme.breakpoints.unit}`}:{maxWidth:x}:{maxWidth:Ui(s)}};return Bs(e,e.maxWidth,n)}return null};lv.filterProps=["maxWidth"];const MM=Wr({prop:"minWidth",transform:Ui}),zM=Wr({prop:"height",transform:Ui}),LM=Wr({prop:"maxHeight",transform:Ui}),RM=Wr({prop:"minHeight",transform:Ui});Wr({prop:"size",cssProperty:"width",transform:Ui});Wr({prop:"size",cssProperty:"height",transform:Ui});const DM=Wr({prop:"boxSizing"});jm(PM,lv,MM,zM,LM,RM,DM);const Id={border:{themeKey:"borders",transform:co},borderTop:{themeKey:"borders",transform:co},borderRight:{themeKey:"borders",transform:co},borderBottom:{themeKey:"borders",transform:co},borderLeft:{themeKey:"borders",transform:co},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:co},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:Vm},color:{themeKey:"palette",transform:Kc},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:Kc},backgroundColor:{themeKey:"palette",transform:Kc},p:{style:Nr},pt:{style:Nr},pr:{style:Nr},pb:{style:Nr},pl:{style:Nr},px:{style:Nr},py:{style:Nr},padding:{style:Nr},paddingTop:{style:Nr},paddingRight:{style:Nr},paddingBottom:{style:Nr},paddingLeft:{style:Nr},paddingX:{style:Nr},paddingY:{style:Nr},paddingInline:{style:Nr},paddingInlineStart:{style:Nr},paddingInlineEnd:{style:Nr},paddingBlock:{style:Nr},paddingBlockStart:{style:Nr},paddingBlockEnd:{style:Nr},m:{style:Or},mt:{style:Or},mr:{style:Or},mb:{style:Or},ml:{style:Or},mx:{style:Or},my:{style:Or},margin:{style:Or},marginTop:{style:Or},marginRight:{style:Or},marginBottom:{style:Or},marginLeft:{style:Or},marginX:{style:Or},marginY:{style:Or},marginInline:{style:Or},marginInlineStart:{style:Or},marginInlineEnd:{style:Or},marginBlock:{style:Or},marginBlockStart:{style:Or},marginBlockEnd:{style:Or},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:qm},rowGap:{style:Wm},columnGap:{style:Hm},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Ui},maxWidth:{style:lv},minWidth:{transform:Ui},height:{transform:Ui},maxHeight:{transform:Ui},minHeight:{transform:Ui},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function BM(...e){const n=e.reduce((c,f)=>c.concat(Object.keys(f)),[]),s=new Set(n);return e.every(c=>s.size===Object.keys(c).length)}function FM(e,n){return typeof e=="function"?e(n):e}function iT(){function e(s,c,f,x){const v={[s]:c,theme:f},d=x[s];if(!d)return{[s]:c};const{cssProperty:L=s,themeKey:U,transform:Z,style:j}=d;if(c==null)return null;if(U==="typography"&&c==="inherit")return{[s]:c};const F=Um(f,U)||{};return j?j(v):Bs(v,c,ye=>{let pe=Yf(F,Z,ye);return ye===pe&&typeof ye=="string"&&(pe=Yf(F,Z,`${s}${ye==="default"?"":nn(ye)}`,ye)),L===!1?pe:{[L]:pe}})}function n(s){var c;const{sx:f,theme:x={}}=s||{};if(!f)return null;const v=(c=x.unstable_sxConfig)!=null?c:Id;function d(L){let U=L;if(typeof L=="function")U=L(x);else if(typeof L!="object")return L;if(!U)return null;const Z=YP(x.breakpoints),j=Object.keys(Z);let F=Z;return Object.keys(U).forEach(me=>{const ye=FM(U[me],x);if(ye!=null)if(typeof ye=="object")if(v[me])F=Zh(F,e(me,ye,x,v));else{const pe=Bs({theme:x},ye,je=>({[me]:je}));BM(pe,ye)?F[me]=n({sx:ye,theme:x}):F=Zh(F,pe)}else F=Zh(F,e(me,ye,x,v))}),JP(j,F)}return Array.isArray(f)?f.map(d):d(f)}return n}const Ed=iT();Ed.filterProps=["sx"];function oT(e,n){const s=this;return s.vars&&typeof s.getColorSchemeSelector=="function"?{[s.getColorSchemeSelector(e).replace(/(\[[^\]]+\])/,"*:where($1)")]:n}:s.palette.mode===e?n:{}}const OM=["breakpoints","palette","spacing","shape"];function cv(e={},...n){const{breakpoints:s={},palette:c={},spacing:f,shape:x={}}=e,v=On(e,OM),d=tT(s),L=oM(f);let U=ss({breakpoints:d,direction:"ltr",components:{},palette:ut({mode:"light"},c),spacing:L,shape:ut({},XP,x)},v);return U.applyStyles=oT,U=n.reduce((Z,j)=>ss(Z,j),U),U.unstable_sxConfig=ut({},Id,v==null?void 0:v.unstable_sxConfig),U.unstable_sx=function(j){return Ed({sx:j,theme:this})},U}const NM=Object.freeze(Object.defineProperty({__proto__:null,default:cv,private_createBreakpoints:tT,unstable_applyStyles:oT},Symbol.toStringTag,{value:"Module"})),$M=Fs(NM),UM=["sx"],jM=e=>{var n,s;const c={systemProps:{},otherProps:{}},f=(n=e==null||(s=e.theme)==null?void 0:s.unstable_sxConfig)!=null?n:Id;return Object.keys(e).forEach(x=>{f[x]?c.systemProps[x]=e[x]:c.otherProps[x]=e[x]}),c};function uv(e){const{sx:n}=e,s=On(e,UM),{systemProps:c,otherProps:f}=jM(s);let x;return Array.isArray(n)?x=[c,...n]:typeof n=="function"?x=(...v)=>{const d=n(...v);return ya(d)?ut({},c,d):c}:x=ut({},c,n),ut({},f,{sx:x})}const VM=Object.freeze(Object.defineProperty({__proto__:null,default:Ed,extendSxProp:uv,unstable_createStyleFunctionSx:iT,unstable_defaultSxConfig:Id},Symbol.toStringTag,{value:"Module"})),qM=Fs(VM);var hu=K0;Object.defineProperty(wd,"__esModule",{value:!0});var HM=wd.default=i5;wd.shouldForwardProp=bf;wd.systemDefaultTheme=void 0;var oo=hu(kS()),U_=hu(IA()),Pb=JM(BP),WM=OP;hu(UP);hu(GP);var GM=hu($M),ZM=hu(qM);const KM=["ownerState"],XM=["variants"],YM=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function sT(e){if(typeof WeakMap!="function")return null;var n=new WeakMap,s=new WeakMap;return(sT=function(c){return c?s:n})(e)}function JM(e,n){if(e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var s=sT(n);if(s&&s.has(e))return s.get(e);var c={__proto__:null},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var x in e)if(x!=="default"&&Object.prototype.hasOwnProperty.call(e,x)){var v=f?Object.getOwnPropertyDescriptor(e,x):null;v&&(v.get||v.set)?Object.defineProperty(c,x,v):c[x]=e[x]}return c.default=e,s&&s.set(e,c),c}function QM(e){return Object.keys(e).length===0}function e5(e){return typeof e=="string"&&e.charCodeAt(0)>96}function bf(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}const t5=wd.systemDefaultTheme=(0,GM.default)(),r5=e=>e&&e.charAt(0).toLowerCase()+e.slice(1);function ef({defaultTheme:e,theme:n,themeId:s}){return QM(n)?e:n[s]||n}function n5(e){return e?(n,s)=>s[e]:null}function wf(e,n){let{ownerState:s}=n,c=(0,U_.default)(n,KM);const f=typeof e=="function"?e((0,oo.default)({ownerState:s},c)):e;if(Array.isArray(f))return f.flatMap(x=>wf(x,(0,oo.default)({ownerState:s},c)));if(f&&typeof f=="object"&&Array.isArray(f.variants)){const{variants:x=[]}=f;let d=(0,U_.default)(f,XM);return x.forEach(L=>{let U=!0;typeof L.props=="function"?U=L.props((0,oo.default)({ownerState:s},c,s)):Object.keys(L.props).forEach(Z=>{(s==null?void 0:s[Z])!==L.props[Z]&&c[Z]!==L.props[Z]&&(U=!1)}),U&&(Array.isArray(d)||(d=[d]),d.push(typeof L.style=="function"?L.style((0,oo.default)({ownerState:s},c,s)):L.style))}),d}return f}function i5(e={}){const{themeId:n,defaultTheme:s=t5,rootShouldForwardProp:c=bf,slotShouldForwardProp:f=bf}=e,x=v=>(0,ZM.default)((0,oo.default)({},v,{theme:ef((0,oo.default)({},v,{defaultTheme:s,themeId:n}))}));return x.__mui_systemSx=!0,(v,d={})=>{(0,Pb.internal_processStyles)(v,Ee=>Ee.filter(Pe=>!(Pe!=null&&Pe.__mui_systemSx)));const{name:L,slot:U,skipVariantsResolver:Z,skipSx:j,overridesResolver:F=n5(r5(U))}=d,me=(0,U_.default)(d,YM),ye=Z!==void 0?Z:U&&U!=="Root"&&U!=="root"||!1,pe=j||!1;let je,re=bf;U==="Root"||U==="root"?re=c:U?re=f:e5(v)&&(re=void 0);const ee=(0,Pb.default)(v,(0,oo.default)({shouldForwardProp:re,label:je},me)),ae=Ee=>typeof Ee=="function"&&Ee.__emotion_real!==Ee||(0,WM.isPlainObject)(Ee)?Pe=>wf(Ee,(0,oo.default)({},Pe,{theme:ef({theme:Pe.theme,defaultTheme:s,themeId:n})})):Ee,xe=(Ee,...Pe)=>{let Ae=ae(Ee);const Ke=Pe?Pe.map(ae):[];L&&F&&Ke.push(st=>{const Ft=ef((0,oo.default)({},st,{defaultTheme:s,themeId:n}));if(!Ft.components||!Ft.components[L]||!Ft.components[L].styleOverrides)return null;const Et=Ft.components[L].styleOverrides,zt={};return Object.entries(Et).forEach(([kr,vr])=>{zt[kr]=wf(vr,(0,oo.default)({},st,{theme:Ft}))}),F(st,zt)}),L&&!ye&&Ke.push(st=>{var Ft;const Et=ef((0,oo.default)({},st,{defaultTheme:s,themeId:n})),zt=Et==null||(Ft=Et.components)==null||(Ft=Ft[L])==null?void 0:Ft.variants;return wf({variants:zt},(0,oo.default)({},st,{theme:Et}))}),pe||Ke.push(x);const vt=Ke.length-Pe.length;if(Array.isArray(Ee)&&vt>0){const st=new Array(vt).fill("");Ae=[...Ee,...st],Ae.raw=[...Ee.raw,...st]}const ot=ee(Ae,...Ke);return v.muiName&&(ot.muiName=v.muiName),ot};return ee.withConfig&&(xe.withConfig=ee.withConfig),xe}}const Mb=e=>e,o5=()=>{let e=Mb;return{configure(n){e=n},generate(n){return e(n)},reset(){e=Mb}}},hv=o5(),s5={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function Da(e,n,s="Mui"){const c=s5[n];return c?`${s}-${c}`:`${hv.generate(e)}-${n}`}function a5(e,n){return ut({toolbar:{minHeight:56,[e.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[e.up("sm")]:{minHeight:64}}},n)}var Gr={};const l5=Fs(NP);function c5(e,n=Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER){return Math.max(n,Math.min(e,s))}const u5=Object.freeze(Object.defineProperty({__proto__:null,default:c5},Symbol.toStringTag,{value:"Module"})),h5=Fs(u5);var aT=K0;Object.defineProperty(Gr,"__esModule",{value:!0});var Jf=Gr.alpha=hT;Gr.blend=T5;Gr.colorChannel=void 0;var d5=Gr.darken=pv;Gr.decomposeColor=mo;Gr.emphasize=dT;var p5=Gr.getContrastRatio=v5;Gr.getLuminance=Qf;Gr.hexToRgb=lT;Gr.hslToRgb=uT;var f5=Gr.lighten=fv;Gr.private_safeAlpha=x5;Gr.private_safeColorChannel=void 0;Gr.private_safeDarken=b5;Gr.private_safeEmphasize=S5;Gr.private_safeLighten=w5;Gr.recomposeColor=du;Gr.rgbToHex=_5;var zb=aT(l5),m5=aT(h5);function dv(e,n=0,s=1){return(0,m5.default)(e,n,s)}function lT(e){e=e.slice(1);const n=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let s=e.match(n);return s&&s[0].length===1&&(s=s.map(c=>c+c)),s?`rgb${s.length===4?"a":""}(${s.map((c,f)=>f<3?parseInt(c,16):Math.round(parseInt(c,16)/255*1e3)/1e3).join(", ")})`:""}function g5(e){const n=e.toString(16);return n.length===1?`0${n}`:n}function mo(e){if(e.type)return e;if(e.charAt(0)==="#")return mo(lT(e));const n=e.indexOf("("),s=e.substring(0,n);if(["rgb","rgba","hsl","hsla","color"].indexOf(s)===-1)throw new Error((0,zb.default)(9,e));let c=e.substring(n+1,e.length-1),f;if(s==="color"){if(c=c.split(" "),f=c.shift(),c.length===4&&c[3].charAt(0)==="/"&&(c[3]=c[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(f)===-1)throw new Error((0,zb.default)(10,f))}else c=c.split(",");return c=c.map(x=>parseFloat(x)),{type:s,values:c,colorSpace:f}}const cT=e=>{const n=mo(e);return n.values.slice(0,3).map((s,c)=>n.type.indexOf("hsl")!==-1&&c!==0?`${s}%`:s).join(" ")};Gr.colorChannel=cT;const y5=(e,n)=>{try{return cT(e)}catch{return e}};Gr.private_safeColorChannel=y5;function du(e){const{type:n,colorSpace:s}=e;let{values:c}=e;return n.indexOf("rgb")!==-1?c=c.map((f,x)=>x<3?parseInt(f,10):f):n.indexOf("hsl")!==-1&&(c[1]=`${c[1]}%`,c[2]=`${c[2]}%`),n.indexOf("color")!==-1?c=`${s} ${c.join(" ")}`:c=`${c.join(", ")}`,`${n}(${c})`}function _5(e){if(e.indexOf("#")===0)return e;const{values:n}=mo(e);return`#${n.map((s,c)=>g5(c===3?Math.round(255*s):s)).join("")}`}function uT(e){e=mo(e);const{values:n}=e,s=n[0],c=n[1]/100,f=n[2]/100,x=c*Math.min(f,1-f),v=(U,Z=(U+s/30)%12)=>f-x*Math.max(Math.min(Z-3,9-Z,1),-1);let d="rgb";const L=[Math.round(v(0)*255),Math.round(v(8)*255),Math.round(v(4)*255)];return e.type==="hsla"&&(d+="a",L.push(n[3])),du({type:d,values:L})}function Qf(e){e=mo(e);let n=e.type==="hsl"||e.type==="hsla"?mo(uT(e)).values:e.values;return n=n.map(s=>(e.type!=="color"&&(s/=255),s<=.03928?s/12.92:((s+.055)/1.055)**2.4)),Number((.2126*n[0]+.7152*n[1]+.0722*n[2]).toFixed(3))}function v5(e,n){const s=Qf(e),c=Qf(n);return(Math.max(s,c)+.05)/(Math.min(s,c)+.05)}function hT(e,n){return e=mo(e),n=dv(n),(e.type==="rgb"||e.type==="hsl")&&(e.type+="a"),e.type==="color"?e.values[3]=`/${n}`:e.values[3]=n,du(e)}function x5(e,n,s){try{return hT(e,n)}catch{return e}}function pv(e,n){if(e=mo(e),n=dv(n),e.type.indexOf("hsl")!==-1)e.values[2]*=1-n;else if(e.type.indexOf("rgb")!==-1||e.type.indexOf("color")!==-1)for(let s=0;s<3;s+=1)e.values[s]*=1-n;return du(e)}function b5(e,n,s){try{return pv(e,n)}catch{return e}}function fv(e,n){if(e=mo(e),n=dv(n),e.type.indexOf("hsl")!==-1)e.values[2]+=(100-e.values[2])*n;else if(e.type.indexOf("rgb")!==-1)for(let s=0;s<3;s+=1)e.values[s]+=(255-e.values[s])*n;else if(e.type.indexOf("color")!==-1)for(let s=0;s<3;s+=1)e.values[s]+=(1-e.values[s])*n;return du(e)}function w5(e,n,s){try{return fv(e,n)}catch{return e}}function dT(e,n=.15){return Qf(e)>.5?pv(e,n):fv(e,n)}function S5(e,n,s){try{return dT(e,n)}catch{return e}}function T5(e,n,s,c=1){const f=(L,U)=>Math.round((L**(1/c)*(1-s)+U**(1/c)*s)**c),x=mo(e),v=mo(n),d=[f(x.values[0],v.values[0]),f(x.values[1],v.values[1]),f(x.values[2],v.values[2])];return du({type:"rgb",values:d})}const gd={black:"#000",white:"#fff"},C5={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},Tc={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},Cc={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},zh={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},Ic={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},Ec={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},kc={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},I5=["mode","contrastThreshold","tonalOffset"],Lb={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:gd.white,default:gd.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},Fy={text:{primary:gd.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:gd.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function Rb(e,n,s,c){const f=c.light||c,x=c.dark||c*1.5;e[n]||(e.hasOwnProperty(s)?e[n]=e[s]:n==="light"?e.light=f5(e.main,f):n==="dark"&&(e.dark=d5(e.main,x)))}function E5(e="light"){return e==="dark"?{main:Ic[200],light:Ic[50],dark:Ic[400]}:{main:Ic[700],light:Ic[400],dark:Ic[800]}}function k5(e="light"){return e==="dark"?{main:Tc[200],light:Tc[50],dark:Tc[400]}:{main:Tc[500],light:Tc[300],dark:Tc[700]}}function A5(e="light"){return e==="dark"?{main:Cc[500],light:Cc[300],dark:Cc[700]}:{main:Cc[700],light:Cc[400],dark:Cc[800]}}function P5(e="light"){return e==="dark"?{main:Ec[400],light:Ec[300],dark:Ec[700]}:{main:Ec[700],light:Ec[500],dark:Ec[900]}}function M5(e="light"){return e==="dark"?{main:kc[400],light:kc[300],dark:kc[700]}:{main:kc[800],light:kc[500],dark:kc[900]}}function z5(e="light"){return e==="dark"?{main:zh[400],light:zh[300],dark:zh[700]}:{main:"#ed6c02",light:zh[500],dark:zh[900]}}function L5(e){const{mode:n="light",contrastThreshold:s=3,tonalOffset:c=.2}=e,f=On(e,I5),x=e.primary||E5(n),v=e.secondary||k5(n),d=e.error||A5(n),L=e.info||P5(n),U=e.success||M5(n),Z=e.warning||z5(n);function j(pe){return p5(pe,Fy.text.primary)>=s?Fy.text.primary:Lb.text.primary}const F=({color:pe,name:je,mainShade:re=500,lightShade:ee=300,darkShade:ae=700})=>{if(pe=ut({},pe),!pe.main&&pe[re]&&(pe.main=pe[re]),!pe.hasOwnProperty("main"))throw new Error(md(11,je?` (${je})`:"",re));if(typeof pe.main!="string")throw new Error(md(12,je?` (${je})`:"",JSON.stringify(pe.main)));return Rb(pe,"light",ee,c),Rb(pe,"dark",ae,c),pe.contrastText||(pe.contrastText=j(pe.main)),pe},me={dark:Fy,light:Lb};return ss(ut({common:ut({},gd),mode:n,primary:F({color:x,name:"primary"}),secondary:F({color:v,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:F({color:d,name:"error"}),warning:F({color:Z,name:"warning"}),info:F({color:L,name:"info"}),success:F({color:U,name:"success"}),grey:C5,contrastThreshold:s,getContrastText:j,augmentColor:F,tonalOffset:c},me[n]),f)}const R5=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function D5(e){return Math.round(e*1e5)/1e5}const Db={textTransform:"uppercase"},Bb='"Roboto", "Helvetica", "Arial", sans-serif';function B5(e,n){const s=typeof n=="function"?n(e):n,{fontFamily:c=Bb,fontSize:f=14,fontWeightLight:x=300,fontWeightRegular:v=400,fontWeightMedium:d=500,fontWeightBold:L=700,htmlFontSize:U=16,allVariants:Z,pxToRem:j}=s,F=On(s,R5),me=f/14,ye=j||(re=>`${re/U*me}rem`),pe=(re,ee,ae,xe,Ee)=>ut({fontFamily:c,fontWeight:re,fontSize:ye(ee),lineHeight:ae},c===Bb?{letterSpacing:`${D5(xe/ee)}em`}:{},Ee,Z),je={h1:pe(x,96,1.167,-1.5),h2:pe(x,60,1.2,-.5),h3:pe(v,48,1.167,0),h4:pe(v,34,1.235,.25),h5:pe(v,24,1.334,0),h6:pe(d,20,1.6,.15),subtitle1:pe(v,16,1.75,.15),subtitle2:pe(d,14,1.57,.1),body1:pe(v,16,1.5,.15),body2:pe(v,14,1.43,.15),button:pe(d,14,1.75,.4,Db),caption:pe(v,12,1.66,.4),overline:pe(v,12,2.66,1,Db),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return ss(ut({htmlFontSize:U,pxToRem:ye,fontFamily:c,fontSize:f,fontWeightLight:x,fontWeightRegular:v,fontWeightMedium:d,fontWeightBold:L},je),F,{clone:!1})}const F5=.2,O5=.14,N5=.12;function Ir(...e){return[`${e[0]}px ${e[1]}px ${e[2]}px ${e[3]}px rgba(0,0,0,${F5})`,`${e[4]}px ${e[5]}px ${e[6]}px ${e[7]}px rgba(0,0,0,${O5})`,`${e[8]}px ${e[9]}px ${e[10]}px ${e[11]}px rgba(0,0,0,${N5})`].join(",")}const $5=["none",Ir(0,2,1,-1,0,1,1,0,0,1,3,0),Ir(0,3,1,-2,0,2,2,0,0,1,5,0),Ir(0,3,3,-2,0,3,4,0,0,1,8,0),Ir(0,2,4,-1,0,4,5,0,0,1,10,0),Ir(0,3,5,-1,0,5,8,0,0,1,14,0),Ir(0,3,5,-1,0,6,10,0,0,1,18,0),Ir(0,4,5,-2,0,7,10,1,0,2,16,1),Ir(0,5,5,-3,0,8,10,1,0,3,14,2),Ir(0,5,6,-3,0,9,12,1,0,3,16,2),Ir(0,6,6,-3,0,10,14,1,0,4,18,3),Ir(0,6,7,-4,0,11,15,1,0,4,20,3),Ir(0,7,8,-4,0,12,17,2,0,5,22,4),Ir(0,7,8,-4,0,13,19,2,0,5,24,4),Ir(0,7,9,-4,0,14,21,2,0,5,26,4),Ir(0,8,9,-5,0,15,22,2,0,6,28,5),Ir(0,8,10,-5,0,16,24,2,0,6,30,5),Ir(0,8,11,-5,0,17,26,2,0,6,32,5),Ir(0,9,11,-5,0,18,28,2,0,7,34,6),Ir(0,9,12,-6,0,19,29,2,0,7,36,6),Ir(0,10,13,-6,0,20,31,3,0,8,38,7),Ir(0,10,13,-6,0,21,33,3,0,8,40,7),Ir(0,10,14,-6,0,22,35,3,0,8,42,7),Ir(0,11,14,-7,0,23,36,3,0,9,44,8),Ir(0,11,15,-7,0,24,38,3,0,9,46,8)],U5=["duration","easing","delay"],j5={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},V5={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function Fb(e){return`${Math.round(e)}ms`}function q5(e){if(!e)return 0;const n=e/36;return Math.round((4+15*n**.25+n/5)*10)}function H5(e){const n=ut({},j5,e.easing),s=ut({},V5,e.duration);return ut({getAutoHeightDuration:q5,create:(f=["all"],x={})=>{const{duration:v=s.standard,easing:d=n.easeInOut,delay:L=0}=x;return On(x,U5),(Array.isArray(f)?f:[f]).map(U=>`${U} ${typeof v=="string"?v:Fb(v)} ${d} ${typeof L=="string"?L:Fb(L)}`).join(",")}},e,{easing:n,duration:s})}const W5={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},G5=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function pT(e={},...n){const{mixins:s={},palette:c={},transitions:f={},typography:x={}}=e,v=On(e,G5);if(e.vars)throw new Error(md(18));const d=L5(c),L=cv(e);let U=ss(L,{mixins:a5(L.breakpoints,s),palette:d,shadows:$5.slice(),typography:B5(d,x),transitions:H5(f),zIndex:ut({},W5)});return U=ss(U,v),U=n.reduce((Z,j)=>ss(Z,j),U),U.unstable_sxConfig=ut({},Id,v==null?void 0:v.unstable_sxConfig),U.unstable_sx=function(j){return Ed({sx:j,theme:this})},U}const Z5=pT(),fT="$$material";function K5(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}const X5=e=>K5(e)&&e!=="classes",as=HM({themeId:fT,defaultTheme:Z5,rootShouldForwardProp:X5});function Ns(e,n,s="Mui"){const c={};return n.forEach(f=>{c[f]=Da(e,f,s)}),c}function Y5(e){return Da("MuiToolbar",e)}Ns("MuiToolbar",["root","gutters","regular","dense"]);const J5=["className","component","disableGutters","variant"],Q5=e=>{const{classes:n,disableGutters:s,variant:c}=e;return El({root:["root",!s&&"gutters",c]},Y5,n)},ez=as("div",{name:"MuiToolbar",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:s}=e;return[n.root,!s.disableGutters&&n.gutters,n[s.variant]]}})(({theme:e,ownerState:n})=>ut({position:"relative",display:"flex",alignItems:"center"},!n.disableGutters&&{paddingLeft:e.spacing(2),paddingRight:e.spacing(2),[e.breakpoints.up("sm")]:{paddingLeft:e.spacing(3),paddingRight:e.spacing(3)}},n.variant==="dense"&&{minHeight:48}),({theme:e,ownerState:n})=>n.variant==="regular"&&e.mixins.toolbar),tz=Ge.forwardRef(function(n,s){const c=Ra({props:n,name:"MuiToolbar"}),{className:f,component:x="div",disableGutters:v=!1,variant:d="regular"}=c,L=On(c,J5),U=ut({},c,{component:x,disableGutters:v,variant:d}),Z=Q5(U);return qt.jsx(ez,ut({as:x,className:Rn(Z.root,f),ref:s,ownerState:U},L))});function rz(e){return Da("MuiTypography",e)}Ns("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const nz=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],iz=e=>{const{align:n,gutterBottom:s,noWrap:c,paragraph:f,variant:x,classes:v}=e,d={root:["root",x,e.align!=="inherit"&&`align${nn(n)}`,s&&"gutterBottom",c&&"noWrap",f&&"paragraph"]};return El(d,rz,v)},oz=as("span",{name:"MuiTypography",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:s}=e;return[n.root,s.variant&&n[s.variant],s.align!=="inherit"&&n[`align${nn(s.align)}`],s.noWrap&&n.noWrap,s.gutterBottom&&n.gutterBottom,s.paragraph&&n.paragraph]}})(({theme:e,ownerState:n})=>ut({margin:0},n.variant==="inherit"&&{font:"inherit"},n.variant!=="inherit"&&e.typography[n.variant],n.align!=="inherit"&&{textAlign:n.align},n.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},n.gutterBottom&&{marginBottom:"0.35em"},n.paragraph&&{marginBottom:16})),Ob={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},sz={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},az=e=>sz[e]||e,lz=Ge.forwardRef(function(n,s){const c=Ra({props:n,name:"MuiTypography"}),f=az(c.color),x=uv(ut({},c,{color:f})),{align:v="inherit",className:d,component:L,gutterBottom:U=!1,noWrap:Z=!1,paragraph:j=!1,variant:F="body1",variantMapping:me=Ob}=x,ye=On(x,nz),pe=ut({},x,{align:v,color:f,className:d,component:L,gutterBottom:U,noWrap:Z,paragraph:j,variant:F,variantMapping:me}),je=L||(j?"p":me[F]||Ob[F])||"span",re=iz(pe);return qt.jsx(oz,ut({as:je,ref:s,ownerState:pe,className:Rn(re.root,d)},ye))});function mT(e,n){typeof e=="function"?e(n):e&&(e.current=n)}function j_(...e){return Ge.useMemo(()=>e.every(n=>n==null)?null:n=>{e.forEach(s=>{mT(s,n)})},e)}const gT=typeof window<"u"?Ge.useLayoutEffect:Ge.useEffect;function Fh(e){const n=Ge.useRef(e);return gT(()=>{n.current=e}),Ge.useRef((...s)=>(0,n.current)(...s)).current}const Nb={};function cz(e,n){const s=Ge.useRef(Nb);return s.current===Nb&&(s.current=e(n)),s}const uz=[];function hz(e){Ge.useEffect(e,uz)}class Gm{constructor(){this.currentId=null,this.clear=()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)},this.disposeEffect=()=>this.clear}static create(){return new Gm}start(n,s){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,s()},n)}}function dz(){const e=cz(Gm.create).current;return hz(e.disposeEffect),e}let Zm=!0,V_=!1;const pz=new Gm,fz={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function mz(e){const{type:n,tagName:s}=e;return!!(s==="INPUT"&&fz[n]&&!e.readOnly||s==="TEXTAREA"&&!e.readOnly||e.isContentEditable)}function gz(e){e.metaKey||e.altKey||e.ctrlKey||(Zm=!0)}function Oy(){Zm=!1}function yz(){this.visibilityState==="hidden"&&V_&&(Zm=!0)}function _z(e){e.addEventListener("keydown",gz,!0),e.addEventListener("mousedown",Oy,!0),e.addEventListener("pointerdown",Oy,!0),e.addEventListener("touchstart",Oy,!0),e.addEventListener("visibilitychange",yz,!0)}function vz(e){const{target:n}=e;try{return n.matches(":focus-visible")}catch{}return Zm||mz(n)}function yT(){const e=Ge.useCallback(f=>{f!=null&&_z(f.ownerDocument)},[]),n=Ge.useRef(!1);function s(){return n.current?(V_=!0,pz.start(100,()=>{V_=!1}),n.current=!1,!0):!1}function c(f){return vz(f)?(n.current=!0,!0):!1}return{isFocusVisibleRef:n,onFocus:c,onBlur:s,ref:e}}function q_(e,n){return q_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,c){return s.__proto__=c,s},q_(e,n)}function xz(e,n){e.prototype=Object.create(n.prototype),e.prototype.constructor=e,q_(e,n)}const $b=dl.createContext(null);function bz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mv(e,n){var s=function(x){return n&&Ge.isValidElement(x)?n(x):x},c=Object.create(null);return e&&Ge.Children.map(e,function(f){return f}).forEach(function(f){c[f.key]=s(f)}),c}function wz(e,n){e=e||{},n=n||{};function s(Z){return Z in n?n[Z]:e[Z]}var c=Object.create(null),f=[];for(var x in e)x in n?f.length&&(c[x]=f,f=[]):f.push(x);var v,d={};for(var L in n){if(c[L])for(v=0;v<c[L].length;v++){var U=c[L][v];d[c[L][v]]=s(U)}d[L]=s(L)}for(v=0;v<f.length;v++)d[f[v]]=s(f[v]);return d}function gl(e,n,s){return s[n]!=null?s[n]:e.props[n]}function Sz(e,n){return mv(e.children,function(s){return Ge.cloneElement(s,{onExited:n.bind(null,s),in:!0,appear:gl(s,"appear",e),enter:gl(s,"enter",e),exit:gl(s,"exit",e)})})}function Tz(e,n,s){var c=mv(e.children),f=wz(n,c);return Object.keys(f).forEach(function(x){var v=f[x];if(Ge.isValidElement(v)){var d=x in n,L=x in c,U=n[x],Z=Ge.isValidElement(U)&&!U.props.in;L&&(!d||Z)?f[x]=Ge.cloneElement(v,{onExited:s.bind(null,v),in:!0,exit:gl(v,"exit",e),enter:gl(v,"enter",e)}):!L&&d&&!Z?f[x]=Ge.cloneElement(v,{in:!1}):L&&d&&Ge.isValidElement(U)&&(f[x]=Ge.cloneElement(v,{onExited:s.bind(null,v),in:U.props.in,exit:gl(v,"exit",e),enter:gl(v,"enter",e)}))}}),f}var Cz=Object.values||function(e){return Object.keys(e).map(function(n){return e[n]})},Iz={component:"div",childFactory:function(n){return n}},gv=function(e){xz(n,e);function n(c,f){var x;x=e.call(this,c,f)||this;var v=x.handleExited.bind(bz(x));return x.state={contextValue:{isMounting:!0},handleExited:v,firstRender:!0},x}var s=n.prototype;return s.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},s.componentWillUnmount=function(){this.mounted=!1},n.getDerivedStateFromProps=function(f,x){var v=x.children,d=x.handleExited,L=x.firstRender;return{children:L?Sz(f,d):Tz(f,v,d),firstRender:!1}},s.handleExited=function(f,x){var v=mv(this.props.children);f.key in v||(f.props.onExited&&f.props.onExited(x),this.mounted&&this.setState(function(d){var L=ut({},d.children);return delete L[f.key],{children:L}}))},s.render=function(){var f=this.props,x=f.component,v=f.childFactory,d=On(f,["component","childFactory"]),L=this.state.contextValue,U=Cz(this.state.children).map(v);return delete d.appear,delete d.enter,delete d.exit,x===null?dl.createElement($b.Provider,{value:L},U):dl.createElement($b.Provider,{value:L},dl.createElement(x,d,U))},n}(dl.Component);gv.propTypes={};gv.defaultProps=Iz;function Ez(e){return Object.keys(e).length===0}function kz(e=null){const n=Ge.useContext(Am);return!n||Ez(n)?e:n}const Az=cv();function Pz(e=Az){return kz(e)}const Mz=["className","component"];function zz(e={}){const{themeId:n,defaultTheme:s,defaultClassName:c="MuiBox-root",generateClassName:f}=e,x=KS("div",{shouldForwardProp:d=>d!=="theme"&&d!=="sx"&&d!=="as"})(Ed);return Ge.forwardRef(function(L,U){const Z=Pz(s),j=uv(L),{className:F,component:me="div"}=j,ye=On(j,Mz);return qt.jsx(x,ut({as:me,ref:U,className:Rn(F,f?f(c):c),theme:n&&Z[n]||Z},ye))})}function Lz(...e){return e.reduce((n,s)=>s==null?n:function(...f){n.apply(this,f),s.apply(this,f)},()=>{})}function Rz(e,n=166){let s;function c(...f){const x=()=>{e.apply(this,f)};clearTimeout(s),s=setTimeout(x,n)}return c.clear=()=>{clearTimeout(s)},c}function Dz(e,n){return()=>null}function Bz(e,n){var s,c;return Ge.isValidElement(e)&&n.indexOf((s=e.type.muiName)!=null?s:(c=e.type)==null||(c=c._payload)==null||(c=c.value)==null?void 0:c.muiName)!==-1}function _T(e){return e&&e.ownerDocument||document}function Fz(e){return _T(e).defaultView||window}function Oz(e,n){return()=>null}let Ub=0;function Nz(e){const[n,s]=Ge.useState(e),c=e||n;return Ge.useEffect(()=>{n==null&&(Ub+=1,s(`mui-${Ub}`))},[n]),c}const jb=jy.useId;function $z(e){if(jb!==void 0){const n=jb();return e??n}return Nz(e)}function Uz(e,n,s,c,f){return null}function jz({controlled:e,default:n,name:s,state:c="value"}){const{current:f}=Ge.useRef(e!==void 0),[x,v]=Ge.useState(n),d=f?e:x,L=Ge.useCallback(U=>{f||v(U)},[]);return[d,L]}function Vz(e){const{className:n,classes:s,pulsate:c=!1,rippleX:f,rippleY:x,rippleSize:v,in:d,onExited:L,timeout:U}=e,[Z,j]=Ge.useState(!1),F=Rn(n,s.ripple,s.rippleVisible,c&&s.ripplePulsate),me={width:v,height:v,top:-(v/2)+x,left:-(v/2)+f},ye=Rn(s.child,Z&&s.childLeaving,c&&s.childPulsate);return!d&&!Z&&j(!0),Ge.useEffect(()=>{if(!d&&L!=null){const pe=setTimeout(L,U);return()=>{clearTimeout(pe)}}},[L,d,U]),qt.jsx("span",{className:F,style:me,children:qt.jsx("span",{className:ye})})}const so=Ns("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),qz=["center","classes","className"];let Km=e=>e,Vb,qb,Hb,Wb;const H_=550,Hz=80,Wz=Pm(Vb||(Vb=Km`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),Gz=Pm(qb||(qb=Km`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),Zz=Pm(Hb||(Hb=Km`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),Kz=as("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),Xz=as(Vz,{name:"MuiTouchRipple",slot:"Ripple"})(Wb||(Wb=Km`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),so.rippleVisible,Wz,H_,({theme:e})=>e.transitions.easing.easeInOut,so.ripplePulsate,({theme:e})=>e.transitions.duration.shorter,so.child,so.childLeaving,Gz,H_,({theme:e})=>e.transitions.easing.easeInOut,so.childPulsate,Zz,({theme:e})=>e.transitions.easing.easeInOut),Yz=Ge.forwardRef(function(n,s){const c=Ra({props:n,name:"MuiTouchRipple"}),{center:f=!1,classes:x={},className:v}=c,d=On(c,qz),[L,U]=Ge.useState([]),Z=Ge.useRef(0),j=Ge.useRef(null);Ge.useEffect(()=>{j.current&&(j.current(),j.current=null)},[L]);const F=Ge.useRef(!1),me=dz(),ye=Ge.useRef(null),pe=Ge.useRef(null),je=Ge.useCallback(xe=>{const{pulsate:Ee,rippleX:Pe,rippleY:Ae,rippleSize:Ke,cb:vt}=xe;U(ot=>[...ot,qt.jsx(Xz,{classes:{ripple:Rn(x.ripple,so.ripple),rippleVisible:Rn(x.rippleVisible,so.rippleVisible),ripplePulsate:Rn(x.ripplePulsate,so.ripplePulsate),child:Rn(x.child,so.child),childLeaving:Rn(x.childLeaving,so.childLeaving),childPulsate:Rn(x.childPulsate,so.childPulsate)},timeout:H_,pulsate:Ee,rippleX:Pe,rippleY:Ae,rippleSize:Ke},Z.current)]),Z.current+=1,j.current=vt},[x]),re=Ge.useCallback((xe={},Ee={},Pe=()=>{})=>{const{pulsate:Ae=!1,center:Ke=f||Ee.pulsate,fakeElement:vt=!1}=Ee;if((xe==null?void 0:xe.type)==="mousedown"&&F.current){F.current=!1;return}(xe==null?void 0:xe.type)==="touchstart"&&(F.current=!0);const ot=vt?null:pe.current,st=ot?ot.getBoundingClientRect():{width:0,height:0,left:0,top:0};let Ft,Et,zt;if(Ke||xe===void 0||xe.clientX===0&&xe.clientY===0||!xe.clientX&&!xe.touches)Ft=Math.round(st.width/2),Et=Math.round(st.height/2);else{const{clientX:kr,clientY:vr}=xe.touches&&xe.touches.length>0?xe.touches[0]:xe;Ft=Math.round(kr-st.left),Et=Math.round(vr-st.top)}if(Ke)zt=Math.sqrt((2*st.width**2+st.height**2)/3),zt%2===0&&(zt+=1);else{const kr=Math.max(Math.abs((ot?ot.clientWidth:0)-Ft),Ft)*2+2,vr=Math.max(Math.abs((ot?ot.clientHeight:0)-Et),Et)*2+2;zt=Math.sqrt(kr**2+vr**2)}xe!=null&&xe.touches?ye.current===null&&(ye.current=()=>{je({pulsate:Ae,rippleX:Ft,rippleY:Et,rippleSize:zt,cb:Pe})},me.start(Hz,()=>{ye.current&&(ye.current(),ye.current=null)})):je({pulsate:Ae,rippleX:Ft,rippleY:Et,rippleSize:zt,cb:Pe})},[f,je,me]),ee=Ge.useCallback(()=>{re({},{pulsate:!0})},[re]),ae=Ge.useCallback((xe,Ee)=>{if(me.clear(),(xe==null?void 0:xe.type)==="touchend"&&ye.current){ye.current(),ye.current=null,me.start(0,()=>{ae(xe,Ee)});return}ye.current=null,U(Pe=>Pe.length>0?Pe.slice(1):Pe),j.current=Ee},[me]);return Ge.useImperativeHandle(s,()=>({pulsate:ee,start:re,stop:ae}),[ee,re,ae]),qt.jsx(Kz,ut({className:Rn(so.root,x.root,v),ref:pe},d,{children:qt.jsx(gv,{component:null,exit:!0,children:L})}))});function Jz(e){return Da("MuiButtonBase",e)}const Qz=Ns("MuiButtonBase",["root","disabled","focusVisible"]),eL=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],tL=e=>{const{disabled:n,focusVisible:s,focusVisibleClassName:c,classes:f}=e,v=El({root:["root",n&&"disabled",s&&"focusVisible"]},Jz,f);return s&&c&&(v.root+=` ${c}`),v},rL=as("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(e,n)=>n.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${Qz.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),nL=Ge.forwardRef(function(n,s){const c=Ra({props:n,name:"MuiButtonBase"}),{action:f,centerRipple:x=!1,children:v,className:d,component:L="button",disabled:U=!1,disableRipple:Z=!1,disableTouchRipple:j=!1,focusRipple:F=!1,LinkComponent:me="a",onBlur:ye,onClick:pe,onContextMenu:je,onDragLeave:re,onFocus:ee,onFocusVisible:ae,onKeyDown:xe,onKeyUp:Ee,onMouseDown:Pe,onMouseLeave:Ae,onMouseUp:Ke,onTouchEnd:vt,onTouchMove:ot,onTouchStart:st,tabIndex:Ft=0,TouchRippleProps:Et,touchRippleRef:zt,type:kr}=c,vr=On(c,eL),Rr=Ge.useRef(null),qe=Ge.useRef(null),mt=j_(qe,zt),{isFocusVisibleRef:gt,onFocus:At,onBlur:Lt,ref:Zr}=yT(),[xr,Kr]=Ge.useState(!1);U&&xr&&Kr(!1),Ge.useImperativeHandle(f,()=>({focusVisible:()=>{Kr(!0),Rr.current.focus()}}),[]);const[Ar,Xr]=Ge.useState(!1);Ge.useEffect(()=>{Xr(!0)},[]);const Ei=Ar&&!Z&&!U;Ge.useEffect(()=>{xr&&F&&!Z&&Ar&&qe.current.pulsate()},[Z,F,xr,Ar]);function un(ht,on,No=j){return Fh(Yi=>(on&&on(Yi),!No&&qe.current&&qe.current[ht](Yi),!0))}const Do=un("start",Pe),$s=un("stop",je),fi=un("stop",re),Ki=un("stop",Ke),br=un("stop",ht=>{xr&&ht.preventDefault(),Ae&&Ae(ht)}),Bo=un("start",st),be=un("stop",vt),Xi=un("stop",ot),ls=un("stop",ht=>{Lt(ht),gt.current===!1&&Kr(!1),ye&&ye(ht)},!1),Rt=Fh(ht=>{Rr.current||(Rr.current=ht.currentTarget),At(ht),gt.current===!0&&(Kr(!0),ae&&ae(ht)),ee&&ee(ht)}),Ht=()=>{const ht=Rr.current;return L&&L!=="button"&&!(ht.tagName==="A"&&ht.href)},ei=Ge.useRef(!1),Fo=Fh(ht=>{F&&!ei.current&&xr&&qe.current&&ht.key===" "&&(ei.current=!0,qe.current.stop(ht,()=>{qe.current.start(ht)})),ht.target===ht.currentTarget&&Ht()&&ht.key===" "&&ht.preventDefault(),xe&&xe(ht),ht.target===ht.currentTarget&&Ht()&&ht.key==="Enter"&&!U&&(ht.preventDefault(),pe&&pe(ht))}),cs=Fh(ht=>{F&&ht.key===" "&&qe.current&&xr&&!ht.defaultPrevented&&(ei.current=!1,qe.current.stop(ht,()=>{qe.current.pulsate(ht)})),Ee&&Ee(ht),pe&&ht.target===ht.currentTarget&&Ht()&&ht.key===" "&&!ht.defaultPrevented&&pe(ht)});let ki=L;ki==="button"&&(vr.href||vr.to)&&(ki=me);const Tn={};ki==="button"?(Tn.type=kr===void 0?"button":kr,Tn.disabled=U):(!vr.href&&!vr.to&&(Tn.role="button"),U&&(Tn["aria-disabled"]=U));const Oo=j_(s,Zr,Rr),us=ut({},c,{centerRipple:x,component:L,disabled:U,disableRipple:Z,disableTouchRipple:j,focusRipple:F,tabIndex:Ft,focusVisible:xr}),Re=tL(us);return qt.jsxs(rL,ut({as:ki,className:Rn(Re.root,d),ownerState:us,onBlur:ls,onClick:pe,onContextMenu:$s,onFocus:Rt,onKeyDown:Fo,onKeyUp:cs,onMouseDown:Do,onMouseLeave:br,onMouseUp:Ki,onDragLeave:fi,onTouchEnd:be,onTouchMove:Xi,onTouchStart:Bo,ref:Oo,tabIndex:U?-1:Ft,type:kr},Tn,vr,{children:[v,Ei?qt.jsx(Yz,ut({ref:mt,center:x},Et)):null]}))});function iL(e){return Da("MuiIconButton",e)}const oL=Ns("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge"]),sL=["edge","children","className","color","disabled","disableFocusRipple","size"],aL=e=>{const{classes:n,disabled:s,color:c,edge:f,size:x}=e,v={root:["root",s&&"disabled",c!=="default"&&`color${nn(c)}`,f&&`edge${nn(f)}`,`size${nn(x)}`]};return El(v,iL,n)},lL=as(nL,{name:"MuiIconButton",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:s}=e;return[n.root,s.color!=="default"&&n[`color${nn(s.color)}`],s.edge&&n[`edge${nn(s.edge)}`],n[`size${nn(s.size)}`]]}})(({theme:e,ownerState:n})=>ut({textAlign:"center",flex:"0 0 auto",fontSize:e.typography.pxToRem(24),padding:8,borderRadius:"50%",overflow:"visible",color:(e.vars||e).palette.action.active,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest})},!n.disableRipple&&{"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:Jf(e.palette.action.active,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},n.edge==="start"&&{marginLeft:n.size==="small"?-3:-12},n.edge==="end"&&{marginRight:n.size==="small"?-3:-12}),({theme:e,ownerState:n})=>{var s;const c=(s=(e.vars||e).palette)==null?void 0:s[n.color];return ut({},n.color==="inherit"&&{color:"inherit"},n.color!=="inherit"&&n.color!=="default"&&ut({color:c==null?void 0:c.main},!n.disableRipple&&{"&:hover":ut({},c&&{backgroundColor:e.vars?`rgba(${c.mainChannel} / ${e.vars.palette.action.hoverOpacity})`:Jf(c.main,e.palette.action.hoverOpacity)},{"@media (hover: none)":{backgroundColor:"transparent"}})}),n.size==="small"&&{padding:5,fontSize:e.typography.pxToRem(18)},n.size==="large"&&{padding:12,fontSize:e.typography.pxToRem(28)},{[`&.${oL.disabled}`]:{backgroundColor:"transparent",color:(e.vars||e).palette.action.disabled}})}),cL=Ge.forwardRef(function(n,s){const c=Ra({props:n,name:"MuiIconButton"}),{edge:f=!1,children:x,className:v,color:d="default",disabled:L=!1,disableFocusRipple:U=!1,size:Z="medium"}=c,j=On(c,sL),F=ut({},c,{edge:f,color:d,disabled:L,disableFocusRipple:U,size:Z}),me=aL(F);return qt.jsx(lL,ut({className:Rn(me.root,v),centerRipple:!0,focusRipple:!U,disabled:L,ref:s},j,{ownerState:F,children:x}))}),Gb=e=>{let n;return e<1?n=5.11916*e**2:n=4.5*Math.log(e+1)+2,(n/100).toFixed(2)};function uL(e){return Da("MuiPaper",e)}Ns("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const hL=["className","component","elevation","square","variant"],dL=e=>{const{square:n,elevation:s,variant:c,classes:f}=e,x={root:["root",c,!n&&"rounded",c==="elevation"&&`elevation${s}`]};return El(x,uL,f)},pL=as("div",{name:"MuiPaper",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:s}=e;return[n.root,n[s.variant],!s.square&&n.rounded,s.variant==="elevation"&&n[`elevation${s.elevation}`]]}})(({theme:e,ownerState:n})=>{var s;return ut({backgroundColor:(e.vars||e).palette.background.paper,color:(e.vars||e).palette.text.primary,transition:e.transitions.create("box-shadow")},!n.square&&{borderRadius:e.shape.borderRadius},n.variant==="outlined"&&{border:`1px solid ${(e.vars||e).palette.divider}`},n.variant==="elevation"&&ut({boxShadow:(e.vars||e).shadows[n.elevation]},!e.vars&&e.palette.mode==="dark"&&{backgroundImage:`linear-gradient(${Jf("#fff",Gb(n.elevation))}, ${Jf("#fff",Gb(n.elevation))})`},e.vars&&{backgroundImage:(s=e.vars.overlays)==null?void 0:s[n.elevation]}))}),fL=Ge.forwardRef(function(n,s){const c=Ra({props:n,name:"MuiPaper"}),{className:f,component:x="div",elevation:v=1,square:d=!1,variant:L="elevation"}=c,U=On(c,hL),Z=ut({},c,{component:x,elevation:v,square:d,variant:L}),j=dL(Z);return qt.jsx(pL,ut({as:x,ownerState:Z,className:Rn(j.root,f),ref:s},U))});function mL(e){return Da("MuiAppBar",e)}Ns("MuiAppBar",["root","positionFixed","positionAbsolute","positionSticky","positionStatic","positionRelative","colorDefault","colorPrimary","colorSecondary","colorInherit","colorTransparent","colorError","colorInfo","colorSuccess","colorWarning"]);const gL=["className","color","enableColorOnDark","position"],yL=e=>{const{color:n,position:s,classes:c}=e,f={root:["root",`color${nn(n)}`,`position${nn(s)}`]};return El(f,mL,c)},tf=(e,n)=>e?`${e==null?void 0:e.replace(")","")}, ${n})`:n,_L=as(fL,{name:"MuiAppBar",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:s}=e;return[n.root,n[`position${nn(s.position)}`],n[`color${nn(s.color)}`]]}})(({theme:e,ownerState:n})=>{const s=e.palette.mode==="light"?e.palette.grey[100]:e.palette.grey[900];return ut({display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",flexShrink:0},n.position==="fixed"&&{position:"fixed",zIndex:(e.vars||e).zIndex.appBar,top:0,left:"auto",right:0,"@media print":{position:"absolute"}},n.position==="absolute"&&{position:"absolute",zIndex:(e.vars||e).zIndex.appBar,top:0,left:"auto",right:0},n.position==="sticky"&&{position:"sticky",zIndex:(e.vars||e).zIndex.appBar,top:0,left:"auto",right:0},n.position==="static"&&{position:"static"},n.position==="relative"&&{position:"relative"},!e.vars&&ut({},n.color==="default"&&{backgroundColor:s,color:e.palette.getContrastText(s)},n.color&&n.color!=="default"&&n.color!=="inherit"&&n.color!=="transparent"&&{backgroundColor:e.palette[n.color].main,color:e.palette[n.color].contrastText},n.color==="inherit"&&{color:"inherit"},e.palette.mode==="dark"&&!n.enableColorOnDark&&{backgroundColor:null,color:null},n.color==="transparent"&&ut({backgroundColor:"transparent",color:"inherit"},e.palette.mode==="dark"&&{backgroundImage:"none"})),e.vars&&ut({},n.color==="default"&&{"--AppBar-background":n.enableColorOnDark?e.vars.palette.AppBar.defaultBg:tf(e.vars.palette.AppBar.darkBg,e.vars.palette.AppBar.defaultBg),"--AppBar-color":n.enableColorOnDark?e.vars.palette.text.primary:tf(e.vars.palette.AppBar.darkColor,e.vars.palette.text.primary)},n.color&&!n.color.match(/^(default|inherit|transparent)$/)&&{"--AppBar-background":n.enableColorOnDark?e.vars.palette[n.color].main:tf(e.vars.palette.AppBar.darkBg,e.vars.palette[n.color].main),"--AppBar-color":n.enableColorOnDark?e.vars.palette[n.color].contrastText:tf(e.vars.palette.AppBar.darkColor,e.vars.palette[n.color].contrastText)},!["inherit","transparent"].includes(n.color)&&{backgroundColor:"var(--AppBar-background)"},{color:n.color==="inherit"?"inherit":"var(--AppBar-color)"},n.color==="transparent"&&{backgroundImage:"none",backgroundColor:"transparent",color:"inherit"}))}),vL=Ge.forwardRef(function(n,s){const c=Ra({props:n,name:"MuiAppBar"}),{className:f,color:x="primary",enableColorOnDark:v=!1,position:d="fixed"}=c,L=On(c,gL),U=ut({},c,{color:x,position:d,enableColorOnDark:v}),Z=yL(U);return qt.jsx(_L,ut({square:!0,component:"header",ownerState:U,elevation:4,className:Rn(Z.root,f,d==="fixed"&&"mui-fixed"),ref:s},L))});var yv={},Ny={};function xL(e){return Da("MuiSvgIcon",e)}Ns("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const bL=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],wL=e=>{const{color:n,fontSize:s,classes:c}=e,f={root:["root",n!=="inherit"&&`color${nn(n)}`,`fontSize${nn(s)}`]};return El(f,xL,c)},SL=as("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:s}=e;return[n.root,s.color!=="inherit"&&n[`color${nn(s.color)}`],n[`fontSize${nn(s.fontSize)}`]]}})(({theme:e,ownerState:n})=>{var s,c,f,x,v,d,L,U,Z,j,F,me,ye;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:n.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:(s=e.transitions)==null||(c=s.create)==null?void 0:c.call(s,"fill",{duration:(f=e.transitions)==null||(f=f.duration)==null?void 0:f.shorter}),fontSize:{inherit:"inherit",small:((x=e.typography)==null||(v=x.pxToRem)==null?void 0:v.call(x,20))||"1.25rem",medium:((d=e.typography)==null||(L=d.pxToRem)==null?void 0:L.call(d,24))||"1.5rem",large:((U=e.typography)==null||(Z=U.pxToRem)==null?void 0:Z.call(U,35))||"2.1875rem"}[n.fontSize],color:(j=(F=(e.vars||e).palette)==null||(F=F[n.color])==null?void 0:F.main)!=null?j:{action:(me=(e.vars||e).palette)==null||(me=me.action)==null?void 0:me.active,disabled:(ye=(e.vars||e).palette)==null||(ye=ye.action)==null?void 0:ye.disabled,inherit:void 0}[n.color]}}),W_=Ge.forwardRef(function(n,s){const c=Ra({props:n,name:"MuiSvgIcon"}),{children:f,className:x,color:v="inherit",component:d="svg",fontSize:L="medium",htmlColor:U,inheritViewBox:Z=!1,titleAccess:j,viewBox:F="0 0 24 24"}=c,me=On(c,bL),ye=Ge.isValidElement(f)&&f.type==="svg",pe=ut({},c,{color:v,component:d,fontSize:L,instanceFontSize:n.fontSize,inheritViewBox:Z,viewBox:F,hasSvgAsChild:ye}),je={};Z||(je.viewBox=F);const re=wL(pe);return qt.jsxs(SL,ut({as:d,className:Rn(re.root,x),focusable:"false",color:U,"aria-hidden":j?void 0:!0,role:j?"img":void 0,ref:s},je,me,ye&&f.props,{ownerState:pe,children:[ye?f.props.children:f,j?qt.jsx("title",{children:j}):null]}))});W_.muiName="SvgIcon";function TL(e,n){function s(c,f){return qt.jsx(W_,ut({"data-testid":`${n}Icon`,ref:f},c,{children:e}))}return s.muiName=W_.muiName,Ge.memo(Ge.forwardRef(s))}const CL={configure:e=>{hv.configure(e)}},IL=Object.freeze(Object.defineProperty({__proto__:null,capitalize:nn,createChainedFunction:Lz,createSvgIcon:TL,debounce:Rz,deprecatedPropType:Dz,isMuiElement:Bz,ownerDocument:_T,ownerWindow:Fz,requirePropFactory:Oz,setRef:mT,unstable_ClassNameGenerator:CL,unstable_useEnhancedEffect:gT,unstable_useId:$z,unsupportedProp:Uz,useControlled:jz,useEventCallback:Fh,useForkRef:j_,useIsFocusVisible:yT},Symbol.toStringTag,{value:"Module"})),EL=Fs(IL);var Zb;function kL(){return Zb||(Zb=1,function(e){"use client";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"default",{enumerable:!0,get:function(){return n.createSvgIcon}});var n=EL}(Ny)),Ny}var AL=K0;Object.defineProperty(yv,"__esModule",{value:!0});var vT=yv.default=void 0,PL=AL(kL()),ML=qt;vT=yv.default=(0,PL.default)((0,ML.jsx)("path",{d:"M3 18h18v-2H3zm0-5h18v-2H3zm0-7v2h18V6z"}),"Menu");function zL({handleDrawerOpen:e,open:n}){const c=as(vL,{shouldForwardProp:f=>f!=="open"})(({theme:f,open:x})=>({transition:f.transitions.create("margin",{easing:f.transitions.easing.sharp,duration:f.transitions.duration.leavingScreen}),...x&&{width:"calc(100% - 250px)",marginLeft:"-250px",transition:f.transitions.create("margin",{easing:f.transitions.easing.easeOut,duration:f.transitions.duration.enteringScreen})}}));return qt.jsx(c,{position:"fixed",open:n,sx:{p:0},children:qt.jsxs(tz,{children:[qt.jsxs(cL,{edge:"start",color:"inherit","aria-label":"open drawer",onClick:e,sx:{mr:2,...n&&{display:"none"}},children:[qt.jsx(vT,{})," "]}),qt.jsx(lz,{variant:"h6",color:"inherit",component:"div",children:"This is my map App"})]})})}var xT={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.4.1/LICENSE.txt
 */(function(e,n){(function(s,c){e.exports=c()})(XI,function(){var s={},c={};function f(v,d,L){if(c[v]=L,v==="index"){var U="var sharedModule = {}; ("+c.shared+")(sharedModule); ("+c.worker+")(sharedModule);",Z={};return c.shared(Z),c.index(s,Z),typeof window<"u"&&s.setWorkerUrl(window.URL.createObjectURL(new Blob([U],{type:"text/javascript"}))),s}}f("shared",["exports"],function(v){function d(i,t,o,l){return new(o||(o=Promise))(function(h,m){function _(I){try{S(l.next(I))}catch(E){m(E)}}function b(I){try{S(l.throw(I))}catch(E){m(E)}}function S(I){var E;I.done?h(I.value):(E=I.value,E instanceof o?E:new o(function(A){A(E)})).then(_,b)}S((l=l.apply(i,t||[])).next())})}function L(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}typeof SuppressedError=="function"&&SuppressedError;var U=Z;function Z(i,t){this.x=i,this.y=t}Z.prototype={clone:function(){return new Z(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,t){return this.clone()._rotateAround(i,t)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var t=i.x-this.x,o=i.y-this.y;return t*t+o*o},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,t){return Math.atan2(this.x*t-this.y*i,this.x*i+this.y*t)},_matMult:function(i){var t=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=t,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var t=Math.cos(i),o=Math.sin(i),l=o*this.x+t*this.y;return this.x=t*this.x-o*this.y,this.y=l,this},_rotateAround:function(i,t){var o=Math.cos(i),l=Math.sin(i),h=t.y+l*(this.x-t.x)+o*(this.y-t.y);return this.x=t.x+o*(this.x-t.x)-l*(this.y-t.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Z.convert=function(i){return i instanceof Z?i:Array.isArray(i)?new Z(i[0],i[1]):i};var j=L(U),F=me;function me(i,t,o,l){this.cx=3*i,this.bx=3*(o-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(l-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=t,this.p2x=o,this.p2y=l}me.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,t){if(t===void 0&&(t=1e-6),i<0)return 0;if(i>1)return 1;for(var o=i,l=0;l<8;l++){var h=this.sampleCurveX(o)-i;if(Math.abs(h)<t)return o;var m=this.sampleCurveDerivativeX(o);if(Math.abs(m)<1e-6)break;o-=h/m}var _=0,b=1;for(o=i,l=0;l<20&&(h=this.sampleCurveX(o),!(Math.abs(h-i)<t));l++)i>h?_=o:b=o,o=.5*(b-_)+_;return o},solve:function(i,t){return this.sampleCurveY(this.solveCurveX(i,t))}};var ye=L(F);let pe,je;function re(){return pe==null&&(pe=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),pe}function ee(){if(je==null&&(je=!1,re())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let l=0;l<5*5;l++){const h=4*l;t.fillStyle=`rgb(${h},${h+1},${h+2})`,t.fillRect(l%5,Math.floor(l/5),1,1)}const o=t.getImageData(0,0,5,5).data;for(let l=0;l<5*5*4;l++)if(l%4!=3&&o[l]!==l){je=!0;break}}}return je||!1}function ae(i,t,o,l){const h=new ye(i,t,o,l);return m=>h.solve(m)}const xe=ae(.25,.1,.25,1);function Ee(i,t,o){return Math.min(o,Math.max(t,i))}function Pe(i,t,o){const l=o-t,h=((i-t)%l+l)%l+t;return h===t?o:h}function Ae(i,...t){for(const o of t)for(const l in o)i[l]=o[l];return i}let Ke=1;function vt(i,t,o){const l={};for(const h in i)l[h]=t.call(this,i[h],h,i);return l}function ot(i,t,o){const l={};for(const h in i)t.call(this,i[h],h,i)&&(l[h]=i[h]);return l}function st(i){return Array.isArray(i)?i.map(st):typeof i=="object"&&i?vt(i,st):i}const Ft={};function Et(i){Ft[i]||(typeof console<"u"&&console.warn(i),Ft[i]=!0)}function zt(i,t,o){return(o.y-i.y)*(t.x-i.x)>(t.y-i.y)*(o.x-i.x)}function kr(i){return typeof WorkerGlobalScope<"u"&&i!==void 0&&i instanceof WorkerGlobalScope}let vr=null;function Rr(i){return typeof ImageBitmap<"u"&&i instanceof ImageBitmap}const qe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function mt(i,t,o,l,h){return d(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const m=new VideoFrame(i,{timestamp:0});try{const _=m==null?void 0:m.format;if(!_||!_.startsWith("BGR")&&!_.startsWith("RGB"))throw new Error(`Unrecognized format ${_}`);const b=_.startsWith("BGR"),S=new Uint8ClampedArray(l*h*4);if(yield m.copyTo(S,function(I,E,A,z,D){const N=4*Math.max(-E,0),q=(Math.max(0,A)-A)*z*4+N,G=4*z,Q=Math.max(0,E),de=Math.max(0,A);return{rect:{x:Q,y:de,width:Math.min(I.width,E+z)-Q,height:Math.min(I.height,A+D)-de},layout:[{offset:q,stride:G}]}}(i,t,o,l,h)),b)for(let I=0;I<S.length;I+=4){const E=S[I];S[I]=S[I+2],S[I+2]=E}return S}finally{m.close()}})}let gt,At;const Lt="AbortError";function Zr(){return new Error(Lt)}const xr={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Kr(i){return xr.REGISTERED_PROTOCOLS[i.substring(0,i.indexOf("://"))]}const Ar="global-dispatcher";class Xr extends Error{constructor(t,o,l,h){super(`AJAXError: ${o} (${t}): ${l}`),this.status=t,this.statusText=o,this.url=l,this.body=h}}const Ei=()=>kr(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,un=function(i,t){if(/:\/\//.test(i.url)&&!/^https?:|^file:/.test(i.url)){const l=Kr(i.url);if(l)return l(i,t);if(kr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:i,targetMapId:Ar},t)}if(!(/^file:/.test(o=i.url)||/^file:/.test(Ei())&&!/^\w+:/.test(o))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(l,h){return d(this,void 0,void 0,function*(){const m=new Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,cache:l.cache,referrer:Ei(),signal:h.signal});l.type!=="json"||m.headers.has("Accept")||m.headers.set("Accept","application/json");const _=yield fetch(m);if(!_.ok){const I=yield _.blob();throw new Xr(_.status,_.statusText,l.url,I)}let b;b=l.type==="arrayBuffer"||l.type==="image"?_.arrayBuffer():l.type==="json"?_.json():_.text();const S=yield b;if(h.signal.aborted)throw Zr();return{data:S,cacheControl:_.headers.get("Cache-Control"),expires:_.headers.get("Expires")}})}(i,t);if(kr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:i,mustQueue:!0,targetMapId:Ar},t)}var o;return function(l,h){return new Promise((m,_)=>{var b;const S=new XMLHttpRequest;S.open(l.method||"GET",l.url,!0),l.type!=="arrayBuffer"&&l.type!=="image"||(S.responseType="arraybuffer");for(const I in l.headers)S.setRequestHeader(I,l.headers[I]);l.type==="json"&&(S.responseType="text",!((b=l.headers)===null||b===void 0)&&b.Accept||S.setRequestHeader("Accept","application/json")),S.withCredentials=l.credentials==="include",S.onerror=()=>{_(new Error(S.statusText))},S.onload=()=>{if(!h.signal.aborted)if((S.status>=200&&S.status<300||S.status===0)&&S.response!==null){let I=S.response;if(l.type==="json")try{I=JSON.parse(S.response)}catch(E){return void _(E)}m({data:I,cacheControl:S.getResponseHeader("Cache-Control"),expires:S.getResponseHeader("Expires")})}else{const I=new Blob([S.response],{type:S.getResponseHeader("Content-Type")});_(new Xr(S.status,S.statusText,l.url,I))}},h.signal.addEventListener("abort",()=>{S.abort(),_(Zr())}),S.send(l.body)})}(i,t)};function Do(i){if(!i||i.indexOf("://")<=0||i.indexOf("data:image/")===0||i.indexOf("blob:")===0)return!0;const t=new URL(i),o=window.location;return t.protocol===o.protocol&&t.host===o.host}function $s(i,t,o){o[i]&&o[i].indexOf(t)!==-1||(o[i]=o[i]||[],o[i].push(t))}function fi(i,t,o){if(o&&o[i]){const l=o[i].indexOf(t);l!==-1&&o[i].splice(l,1)}}class Ki{constructor(t,o={}){Ae(this,o),this.type=t}}class br extends Ki{constructor(t,o={}){super("error",Ae({error:t},o))}}class Bo{on(t,o){return this._listeners=this._listeners||{},$s(t,o,this._listeners),this}off(t,o){return fi(t,o,this._listeners),fi(t,o,this._oneTimeListeners),this}once(t,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},$s(t,o,this._oneTimeListeners),this):new Promise(l=>this.once(t,l))}fire(t,o){typeof t=="string"&&(t=new Ki(t,o||{}));const l=t.type;if(this.listens(l)){t.target=this;const h=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];for(const b of h)b.call(this,t);const m=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];for(const b of m)fi(l,b,this._oneTimeListeners),b.call(this,t);const _=this._eventedParent;_&&(Ae(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),_.fire(t))}else t instanceof br&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,o){return this._eventedParent=t,this._eventedParentData=o,this}}var be={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Xi=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function ls(i,t){const o={};for(const l in i)l!=="ref"&&(o[l]=i[l]);return Xi.forEach(l=>{l in t&&(o[l]=t[l])}),o}function Rt(i,t){if(Array.isArray(i)){if(!Array.isArray(t)||i.length!==t.length)return!1;for(let o=0;o<i.length;o++)if(!Rt(i[o],t[o]))return!1;return!0}if(typeof i=="object"&&i!==null&&t!==null){if(typeof t!="object"||Object.keys(i).length!==Object.keys(t).length)return!1;for(const o in i)if(!Rt(i[o],t[o]))return!1;return!0}return i===t}function Ht(i,t){i.push(t)}function ei(i,t,o){Ht(o,{command:"addSource",args:[i,t[i]]})}function Fo(i,t,o){Ht(t,{command:"removeSource",args:[i]}),o[i]=!0}function cs(i,t,o,l){Fo(i,o,l),ei(i,t,o)}function ki(i,t,o){let l;for(l in i[o])if(Object.prototype.hasOwnProperty.call(i[o],l)&&l!=="data"&&!Rt(i[o][l],t[o][l]))return!1;for(l in t[o])if(Object.prototype.hasOwnProperty.call(t[o],l)&&l!=="data"&&!Rt(i[o][l],t[o][l]))return!1;return!0}function Tn(i,t,o,l,h,m){i=i||{},t=t||{};for(const _ in i)Object.prototype.hasOwnProperty.call(i,_)&&(Rt(i[_],t[_])||o.push({command:m,args:[l,_,t[_],h]}));for(const _ in t)Object.prototype.hasOwnProperty.call(t,_)&&!Object.prototype.hasOwnProperty.call(i,_)&&(Rt(i[_],t[_])||o.push({command:m,args:[l,_,t[_],h]}))}function Oo(i){return i.id}function us(i,t){return i[t.id]=t,i}class Re{constructor(t,o,l,h){this.message=(t?`${t}: `:"")+l,h&&(this.identifier=h),o!=null&&o.__line__&&(this.line=o.__line__)}}function ht(i,...t){for(const o of t)for(const l in o)i[l]=o[l];return i}class on extends Error{constructor(t,o){super(o),this.message=o,this.key=t}}class No{constructor(t,o=[]){this.parent=t,this.bindings={};for(const[l,h]of o)this.bindings[l]=h}concat(t){return new No(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const Yi={kind:"null"},Le={kind:"number"},St={kind:"string"},xt={kind:"boolean"},Cn={kind:"color"},In={kind:"object"},bt={kind:"value"},_o={kind:"collator"},vo={kind:"formatted"},Yr={kind:"padding"},K={kind:"resolvedImage"},R={kind:"variableAnchorOffsetCollection"};function B(i,t){return{kind:"array",itemType:i,N:t}}function $(i){if(i.kind==="array"){const t=$(i.itemType);return typeof i.N=="number"?`array<${t}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${t}>`}return i.kind}const Y=[Yi,Le,St,xt,Cn,vo,In,B(bt),Yr,K,R];function oe(i,t){if(t.kind==="error")return null;if(i.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!oe(i.itemType,t.itemType))&&(typeof i.N!="number"||i.N===t.N))return null}else{if(i.kind===t.kind)return null;if(i.kind==="value"){for(const o of Y)if(!oe(o,t))return null}}return`Expected ${$(i)} but found ${$(t)} instead.`}function le(i,t){return t.some(o=>o.kind===i.kind)}function he(i,t){return t.some(o=>o==="null"?i===null:o==="array"?Array.isArray(i):o==="object"?i&&!Array.isArray(i)&&typeof i=="object":o===typeof i)}function ne(i,t){return i.kind==="array"&&t.kind==="array"?i.itemType.kind===t.itemType.kind&&typeof i.N=="number":i.kind===t.kind}const ge=.96422,Ie=.82521,Se=4/29,we=6/29,at=3*we*we,it=we*we*we,It=Math.PI/180,yt=180/Math.PI;function Pt(i){return(i%=360)<0&&(i+=360),i}function Wt([i,t,o,l]){let h,m;const _=Dr((.2225045*(i=ir(i))+.7168786*(t=ir(t))+.0606169*(o=ir(o)))/1);i===t&&t===o?h=m=_:(h=Dr((.4360747*i+.3850649*t+.1430804*o)/ge),m=Dr((.0139322*i+.0971045*t+.7141733*o)/Ie));const b=116*_-16;return[b<0?0:b,500*(h-_),200*(_-m),l]}function ir(i){return i<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function Dr(i){return i>it?Math.pow(i,1/3):i/at+Se}function wt([i,t,o,l]){let h=(i+16)/116,m=isNaN(t)?h:h+t/500,_=isNaN(o)?h:h-o/200;return h=1*Ur(h),m=ge*Ur(m),_=Ie*Ur(_),[hr(3.1338561*m-1.6168667*h-.4906146*_),hr(-.9787684*m+1.9161415*h+.033454*_),hr(.0719453*m-.2289914*h+1.4052427*_),l]}function hr(i){return(i=i<=.00304?12.92*i:1.055*Math.pow(i,1/2.4)-.055)<0?0:i>1?1:i}function Ur(i){return i>we?i*i*i:at*(i-Se)}function Nn(i){return parseInt(i.padEnd(2,i),16)/255}function ti(i,t){return jr(t?i/100:i,0,1)}function jr(i,t,o){return Math.min(Math.max(t,i),o)}function Us(i){return!i.some(Number.isNaN)}const Ym={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Vt{constructor(t,o,l,h=1,m=!0){this.r=t,this.g=o,this.b=l,this.a=h,m||(this.r*=h,this.g*=h,this.b*=h,h||this.overwriteGetter("rgb",[t,o,l,h]))}static parse(t){if(t instanceof Vt)return t;if(typeof t!="string")return;const o=function(l){if((l=l.toLowerCase().trim())==="transparent")return[0,0,0,0];const h=Ym[l];if(h){const[_,b,S]=h;return[_/255,b/255,S/255,1]}if(l.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(l)){const _=l.length<6?1:2;let b=1;return[Nn(l.slice(b,b+=_)),Nn(l.slice(b,b+=_)),Nn(l.slice(b,b+=_)),Nn(l.slice(b,b+_)||"ff")]}if(l.startsWith("rgb")){const _=l.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(_){const[b,S,I,E,A,z,D,N,q,G,Q,de]=_,ie=[E||" ",D||" ",G].join("");if(ie==="  "||ie==="  /"||ie===",,"||ie===",,,"){const ue=[I,z,q].join(""),ve=ue==="%%%"?100:ue===""?255:0;if(ve){const ke=[jr(+S/ve,0,1),jr(+A/ve,0,1),jr(+N/ve,0,1),Q?ti(+Q,de):1];if(Us(ke))return ke}}return}}const m=l.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(m){const[_,b,S,I,E,A,z,D,N]=m,q=[S||" ",E||" ",z].join("");if(q==="  "||q==="  /"||q===",,"||q===",,,"){const G=[+b,jr(+I,0,100),jr(+A,0,100),D?ti(+D,N):1];if(Us(G))return function([Q,de,ie,ue]){function ve(ke){const Ne=(ke+Q/30)%12,lt=de*Math.min(ie,1-ie);return ie-lt*Math.max(-1,Math.min(Ne-3,9-Ne,1))}return Q=Pt(Q),de/=100,ie/=100,[ve(0),ve(8),ve(4),ue]}(G)}}}(t);return o?new Vt(...o,!1):void 0}get rgb(){const{r:t,g:o,b:l,a:h}=this,m=h||1/0;return this.overwriteGetter("rgb",[t/m,o/m,l/m,h])}get hcl(){return this.overwriteGetter("hcl",function(t){const[o,l,h,m]=Wt(t),_=Math.sqrt(l*l+h*h);return[Math.round(1e4*_)?Pt(Math.atan2(h,l)*yt):NaN,_,o,m]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Wt(this.rgb))}overwriteGetter(t,o){return Object.defineProperty(this,t,{value:o}),o}toString(){const[t,o,l,h]=this.rgb;return`rgba(${[t,o,l].map(m=>Math.round(255*m)).join(",")},${h})`}}Vt.black=new Vt(0,0,0,1),Vt.white=new Vt(1,1,1,1),Vt.transparent=new Vt(0,0,0,0),Vt.red=new Vt(1,0,0,1);class fu{constructor(t,o,l){this.sensitivity=t?o?"variant":"case":o?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,o){return this.collator.compare(t,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class mu{constructor(t,o,l,h,m){this.text=t,this.image=o,this.scale=l,this.fontStack=h,this.textColor=m}}class ri{constructor(t){this.sections=t}static fromString(t){return new ri([new mu(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof ri?t:ri.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}}class $n{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof $n)return t;if(typeof t=="number")return new $n([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const o of t)if(typeof o!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new $n(t)}}toString(){return JSON.stringify(this.values)}}const Ba=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Un{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Un)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let o=0;o<t.length;o+=2){const l=t[o],h=t[o+1];if(typeof l!="string"||!Ba.has(l)||!Array.isArray(h)||h.length!==2||typeof h[0]!="number"||typeof h[1]!="number")return}return new Un(t)}}toString(){return JSON.stringify(this.values)}}class mi{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new mi({name:t,available:!1}):null}}function kd(i,t,o,l){return typeof i=="number"&&i>=0&&i<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof o=="number"&&o>=0&&o<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:`Invalid rgba value [${[i,t,o,l].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof l=="number"?[i,t,o,l]:[i,t,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function xo(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof Vt||i instanceof fu||i instanceof ri||i instanceof $n||i instanceof Un||i instanceof mi)return!0;if(Array.isArray(i)){for(const t of i)if(!xo(t))return!1;return!0}if(typeof i=="object"){for(const t in i)if(!xo(i[t]))return!1;return!0}return!1}function Br(i){if(i===null)return Yi;if(typeof i=="string")return St;if(typeof i=="boolean")return xt;if(typeof i=="number")return Le;if(i instanceof Vt)return Cn;if(i instanceof fu)return _o;if(i instanceof ri)return vo;if(i instanceof $n)return Yr;if(i instanceof Un)return R;if(i instanceof mi)return K;if(Array.isArray(i)){const t=i.length;let o;for(const l of i){const h=Br(l);if(o){if(o===h)continue;o=bt;break}o=h}return B(o||bt,t)}return In}function Fa(i){const t=typeof i;return i===null?"":t==="string"||t==="number"||t==="boolean"?String(i):i instanceof Vt||i instanceof ri||i instanceof $n||i instanceof Un||i instanceof mi?i.toString():JSON.stringify(i)}class hs{constructor(t,o){this.type=t,this.value=o}static parse(t,o){if(t.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!xo(t[1]))return o.error("invalid value");const l=t[1];let h=Br(l);const m=o.expectedType;return h.kind!=="array"||h.N!==0||!m||m.kind!=="array"||typeof m.N=="number"&&m.N!==0||(h=m),new hs(h,l)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class wr{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const ds={string:St,number:Le,boolean:xt,object:In};class Ai{constructor(t,o){this.type=t,this.args=o}static parse(t,o){if(t.length<2)return o.error("Expected at least one argument.");let l,h=1;const m=t[0];if(m==="array"){let b,S;if(t.length>2){const I=t[1];if(typeof I!="string"||!(I in ds)||I==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);b=ds[I],h++}else b=bt;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return o.error('The length argument to "array" must be a positive integer literal',2);S=t[2],h++}l=B(b,S)}else{if(!ds[m])throw new Error(`Types doesn't contain name = ${m}`);l=ds[m]}const _=[];for(;h<t.length;h++){const b=o.parse(t[h],h,bt);if(!b)return null;_.push(b)}return new Ai(l,_)}evaluate(t){for(let o=0;o<this.args.length;o++){const l=this.args[o].evaluate(t);if(!oe(this.type,Br(l)))return l;if(o===this.args.length-1)throw new wr(`Expected value to be of type ${$(this.type)}, but found ${$(Br(l))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const kl={"to-boolean":xt,"to-color":Cn,"to-number":Le,"to-string":St};class Ji{constructor(t,o){this.type=t,this.args=o}static parse(t,o){if(t.length<2)return o.error("Expected at least one argument.");const l=t[0];if(!kl[l])throw new Error(`Can't parse ${l} as it is not part of the known types`);if((l==="to-boolean"||l==="to-string")&&t.length!==2)return o.error("Expected one argument.");const h=kl[l],m=[];for(let _=1;_<t.length;_++){const b=o.parse(t[_],_,bt);if(!b)return null;m.push(b)}return new Ji(h,m)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let o,l;for(const h of this.args){if(o=h.evaluate(t),l=null,o instanceof Vt)return o;if(typeof o=="string"){const m=t.parseColor(o);if(m)return m}else if(Array.isArray(o)&&(l=o.length<3||o.length>4?`Invalid rbga value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:kd(o[0],o[1],o[2],o[3]),!l))return new Vt(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new wr(l||`Could not parse color from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"padding":{let o;for(const l of this.args){o=l.evaluate(t);const h=$n.parse(o);if(h)return h}throw new wr(`Could not parse padding from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"variableAnchorOffsetCollection":{let o;for(const l of this.args){o=l.evaluate(t);const h=Un.parse(o);if(h)return h}throw new wr(`Could not parse variableAnchorOffsetCollection from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"number":{let o=null;for(const l of this.args){if(o=l.evaluate(t),o===null)return 0;const h=Number(o);if(!isNaN(h))return h}throw new wr(`Could not convert ${JSON.stringify(o)} to number.`)}case"formatted":return ri.fromString(Fa(this.args[0].evaluate(t)));case"resolvedImage":return mi.fromString(Fa(this.args[0].evaluate(t)));default:return Fa(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const gu=["Unknown","Point","LineString","Polygon"];class js{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?gu[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let o=this._parseColorCache[t];return o||(o=this._parseColorCache[t]=Vt.parse(t)),o}}class Nt{constructor(t,o,l=[],h,m=new No,_=[]){this.registry=t,this.path=l,this.key=l.map(b=>`[${b}]`).join(""),this.scope=m,this.errors=_,this.expectedType=h,this._isConstant=o}parse(t,o,l,h,m={}){return o?this.concat(o,l,h)._parse(t,m):this._parse(t,m)}_parse(t,o){function l(h,m,_){return _==="assert"?new Ai(m,[h]):_==="coerce"?new Ji(m,[h]):h}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=t[0];if(typeof h!="string")return this.error(`Expression name must be a string, but found ${typeof h} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const m=this.registry[h];if(m){let _=m.parse(t,this);if(!_)return null;if(this.expectedType){const b=this.expectedType,S=_.type;if(b.kind!=="string"&&b.kind!=="number"&&b.kind!=="boolean"&&b.kind!=="object"&&b.kind!=="array"||S.kind!=="value")if(b.kind!=="color"&&b.kind!=="formatted"&&b.kind!=="resolvedImage"||S.kind!=="value"&&S.kind!=="string")if(b.kind!=="padding"||S.kind!=="value"&&S.kind!=="number"&&S.kind!=="array")if(b.kind!=="variableAnchorOffsetCollection"||S.kind!=="value"&&S.kind!=="array"){if(this.checkSubtype(b,S))return null}else _=l(_,b,o.typeAnnotation||"coerce");else _=l(_,b,o.typeAnnotation||"coerce");else _=l(_,b,o.typeAnnotation||"coerce");else _=l(_,b,o.typeAnnotation||"assert")}if(!(_ instanceof hs)&&_.type.kind!=="resolvedImage"&&this._isConstant(_)){const b=new js;try{_=new hs(_.type,_.evaluate(b))}catch(S){return this.error(S.message),null}}return _}return this.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,o,l){const h=typeof t=="number"?this.path.concat(t):this.path,m=l?this.scope.concat(l):this.scope;return new Nt(this.registry,this._isConstant,h,o||null,m,this.errors)}error(t,...o){const l=`${this.key}${o.map(h=>`[${h}]`).join("")}`;this.errors.push(new on(l,t))}checkSubtype(t,o){const l=oe(t,o);return l&&this.error(l),l}}class Al{constructor(t,o){this.type=o.type,this.bindings=[].concat(t),this.result=o}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const o of this.bindings)t(o[1]);t(this.result)}static parse(t,o){if(t.length<4)return o.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const l=[];for(let m=1;m<t.length-1;m+=2){const _=t[m];if(typeof _!="string")return o.error(`Expected string, but found ${typeof _} instead.`,m);if(/[^a-zA-Z0-9_]/.test(_))return o.error("Variable names must contain only alphanumeric characters or '_'.",m);const b=o.parse(t[m+1],m+1);if(!b)return null;l.push([_,b])}const h=o.parse(t[t.length-1],t.length-1,o.expectedType,l);return h?new Al(l,h):null}outputDefined(){return this.result.outputDefined()}}class Vs{constructor(t,o){this.type=o.type,this.name=t,this.boundExpression=o}static parse(t,o){if(t.length!==2||typeof t[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const l=t[1];return o.scope.has(l)?new Vs(l,o.scope.get(l)):o.error(`Unknown variable "${l}". Make sure "${l}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class yu{constructor(t,o,l){this.type=t,this.index=o,this.input=l}static parse(t,o){if(t.length!==3)return o.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const l=o.parse(t[1],1,Le),h=o.parse(t[2],2,B(o.expectedType||bt));return l&&h?new yu(h.type.itemType,l,h):null}evaluate(t){const o=this.index.evaluate(t),l=this.input.evaluate(t);if(o<0)throw new wr(`Array index out of bounds: ${o} < 0.`);if(o>=l.length)throw new wr(`Array index out of bounds: ${o} > ${l.length-1}.`);if(o!==Math.floor(o))throw new wr(`Array index must be an integer, but found ${o} instead.`);return l[o]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class Pl{constructor(t,o){this.type=xt,this.needle=t,this.haystack=o}static parse(t,o){if(t.length!==3)return o.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const l=o.parse(t[1],1,bt),h=o.parse(t[2],2,bt);return l&&h?le(l.type,[xt,St,Le,Yi,bt])?new Pl(l,h):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${$(l.type)} instead`):null}evaluate(t){const o=this.needle.evaluate(t),l=this.haystack.evaluate(t);if(!l)return!1;if(!he(o,["boolean","string","number","null"]))throw new wr(`Expected first argument to be of type boolean, string, number or null, but found ${$(Br(o))} instead.`);if(!he(l,["string","array"]))throw new wr(`Expected second argument to be of type array or string, but found ${$(Br(l))} instead.`);return l.indexOf(o)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class Oa{constructor(t,o,l){this.type=Le,this.needle=t,this.haystack=o,this.fromIndex=l}static parse(t,o){if(t.length<=2||t.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const l=o.parse(t[1],1,bt),h=o.parse(t[2],2,bt);if(!l||!h)return null;if(!le(l.type,[xt,St,Le,Yi,bt]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${$(l.type)} instead`);if(t.length===4){const m=o.parse(t[3],3,Le);return m?new Oa(l,h,m):null}return new Oa(l,h)}evaluate(t){const o=this.needle.evaluate(t),l=this.haystack.evaluate(t);if(!he(o,["boolean","string","number","null"]))throw new wr(`Expected first argument to be of type boolean, string, number or null, but found ${$(Br(o))} instead.`);if(!he(l,["string","array"]))throw new wr(`Expected second argument to be of type array or string, but found ${$(Br(l))} instead.`);if(this.fromIndex){const h=this.fromIndex.evaluate(t);return l.indexOf(o,h)}return l.indexOf(o)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class _u{constructor(t,o,l,h,m,_){this.inputType=t,this.type=o,this.input=l,this.cases=h,this.outputs=m,this.otherwise=_}static parse(t,o){if(t.length<5)return o.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return o.error("Expected an even number of arguments.");let l,h;o.expectedType&&o.expectedType.kind!=="value"&&(h=o.expectedType);const m={},_=[];for(let I=2;I<t.length-1;I+=2){let E=t[I];const A=t[I+1];Array.isArray(E)||(E=[E]);const z=o.concat(I);if(E.length===0)return z.error("Expected at least one branch label.");for(const N of E){if(typeof N!="number"&&typeof N!="string")return z.error("Branch labels must be numbers or strings.");if(typeof N=="number"&&Math.abs(N)>Number.MAX_SAFE_INTEGER)return z.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof N=="number"&&Math.floor(N)!==N)return z.error("Numeric branch labels must be integer values.");if(l){if(z.checkSubtype(l,Br(N)))return null}else l=Br(N);if(m[String(N)]!==void 0)return z.error("Branch labels must be unique.");m[String(N)]=_.length}const D=o.parse(A,I,h);if(!D)return null;h=h||D.type,_.push(D)}const b=o.parse(t[1],1,bt);if(!b)return null;const S=o.parse(t[t.length-1],t.length-1,h);return S?b.type.kind!=="value"&&o.concat(1).checkSubtype(l,b.type)?null:new _u(l,h,b,m,_,S):null}evaluate(t){const o=this.input.evaluate(t);return(Br(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class Ml{constructor(t,o,l){this.type=t,this.branches=o,this.otherwise=l}static parse(t,o){if(t.length<4)return o.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return o.error("Expected an odd number of arguments.");let l;o.expectedType&&o.expectedType.kind!=="value"&&(l=o.expectedType);const h=[];for(let _=1;_<t.length-1;_+=2){const b=o.parse(t[_],_,xt);if(!b)return null;const S=o.parse(t[_+1],_+1,l);if(!S)return null;h.push([b,S]),l=l||S.type}const m=o.parse(t[t.length-1],t.length-1,l);if(!m)return null;if(!l)throw new Error("Can't infer output type");return new Ml(l,h,m)}evaluate(t){for(const[o,l]of this.branches)if(o.evaluate(t))return l.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[o,l]of this.branches)t(o),t(l);t(this.otherwise)}outputDefined(){return this.branches.every(([t,o])=>o.outputDefined())&&this.otherwise.outputDefined()}}class Na{constructor(t,o,l,h){this.type=t,this.input=o,this.beginIndex=l,this.endIndex=h}static parse(t,o){if(t.length<=2||t.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const l=o.parse(t[1],1,bt),h=o.parse(t[2],2,Le);if(!l||!h)return null;if(!le(l.type,[B(bt),St,bt]))return o.error(`Expected first argument to be of type array or string, but found ${$(l.type)} instead`);if(t.length===4){const m=o.parse(t[3],3,Le);return m?new Na(l.type,l,h,m):null}return new Na(l.type,l,h)}evaluate(t){const o=this.input.evaluate(t),l=this.beginIndex.evaluate(t);if(!he(o,["string","array"]))throw new wr(`Expected first argument to be of type array or string, but found ${$(Br(o))} instead.`);if(this.endIndex){const h=this.endIndex.evaluate(t);return o.slice(l,h)}return o.slice(l)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function zl(i,t){const o=i.length-1;let l,h,m=0,_=o,b=0;for(;m<=_;)if(b=Math.floor((m+_)/2),l=i[b],h=i[b+1],l<=t){if(b===o||t<h)return b;m=b+1}else{if(!(l>t))throw new wr("Input is not a number.");_=b-1}return 0}class $a{constructor(t,o,l){this.type=t,this.input=o,this.labels=[],this.outputs=[];for(const[h,m]of l)this.labels.push(h),this.outputs.push(m)}static parse(t,o){if(t.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return o.error("Expected an even number of arguments.");const l=o.parse(t[1],1,Le);if(!l)return null;const h=[];let m=null;o.expectedType&&o.expectedType.kind!=="value"&&(m=o.expectedType);for(let _=1;_<t.length;_+=2){const b=_===1?-1/0:t[_],S=t[_+1],I=_,E=_+1;if(typeof b!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',I);if(h.length&&h[h.length-1][0]>=b)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',I);const A=o.parse(S,E,m);if(!A)return null;m=m||A.type,h.push([b,A])}return new $a(m,l,h)}evaluate(t){const o=this.labels,l=this.outputs;if(o.length===1)return l[0].evaluate(t);const h=this.input.evaluate(t);if(h<=o[0])return l[0].evaluate(t);const m=o.length;return h>=o[m-1]?l[m-1].evaluate(t):l[zl(o,h)].evaluate(t)}eachChild(t){t(this.input);for(const o of this.outputs)t(o)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function Jm(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Qm=vu;function vu(i,t,o,l){this.cx=3*i,this.bx=3*(o-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(l-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=t,this.p2x=o,this.p2y=l}vu.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,t){if(t===void 0&&(t=1e-6),i<0)return 0;if(i>1)return 1;for(var o=i,l=0;l<8;l++){var h=this.sampleCurveX(o)-i;if(Math.abs(h)<t)return o;var m=this.sampleCurveDerivativeX(o);if(Math.abs(m)<1e-6)break;o-=h/m}var _=0,b=1;for(o=i,l=0;l<20&&(h=this.sampleCurveX(o),!(Math.abs(h-i)<t));l++)i>h?_=o:b=o,o=.5*(b-_)+_;return o},solve:function(i,t){return this.sampleCurveY(this.solveCurveX(i,t))}};var Ad=Jm(Qm);function ps(i,t,o){return i+o*(t-i)}function Ll(i,t,o){return i.map((l,h)=>ps(l,t[h],o))}const En={number:ps,color:function(i,t,o,l="rgb"){switch(l){case"rgb":{const[h,m,_,b]=Ll(i.rgb,t.rgb,o);return new Vt(h,m,_,b,!1)}case"hcl":{const[h,m,_,b]=i.hcl,[S,I,E,A]=t.hcl;let z,D;if(isNaN(h)||isNaN(S))isNaN(h)?isNaN(S)?z=NaN:(z=S,_!==1&&_!==0||(D=I)):(z=h,E!==1&&E!==0||(D=m));else{let de=S-h;S>h&&de>180?de-=360:S<h&&h-S>180&&(de+=360),z=h+o*de}const[N,q,G,Q]=function([de,ie,ue,ve]){return de=isNaN(de)?0:de*It,wt([ue,Math.cos(de)*ie,Math.sin(de)*ie,ve])}([z,D??ps(m,I,o),ps(_,E,o),ps(b,A,o)]);return new Vt(N,q,G,Q,!1)}case"lab":{const[h,m,_,b]=wt(Ll(i.lab,t.lab,o));return new Vt(h,m,_,b,!1)}}},array:Ll,padding:function(i,t,o){return new $n(Ll(i.values,t.values,o))},variableAnchorOffsetCollection:function(i,t,o){const l=i.values,h=t.values;if(l.length!==h.length)throw new wr(`Cannot interpolate values of different length. from: ${i.toString()}, to: ${t.toString()}`);const m=[];for(let _=0;_<l.length;_+=2){if(l[_]!==h[_])throw new wr(`Cannot interpolate values containing mismatched anchors. from[${_}]: ${l[_]}, to[${_}]: ${h[_]}`);m.push(l[_]);const[b,S]=l[_+1],[I,E]=h[_+1];m.push([ps(b,I,o),ps(S,E,o)])}return new Un(m)}};class ni{constructor(t,o,l,h,m){this.type=t,this.operator=o,this.interpolation=l,this.input=h,this.labels=[],this.outputs=[];for(const[_,b]of m)this.labels.push(_),this.outputs.push(b)}static interpolationFactor(t,o,l,h){let m=0;if(t.name==="exponential")m=xu(o,t.base,l,h);else if(t.name==="linear")m=xu(o,1,l,h);else if(t.name==="cubic-bezier"){const _=t.controlPoints;m=new Ad(_[0],_[1],_[2],_[3]).solve(xu(o,1,l,h))}return m}static parse(t,o){let[l,h,m,..._]=t;if(!Array.isArray(h)||h.length===0)return o.error("Expected an interpolation type expression.",1);if(h[0]==="linear")h={name:"linear"};else if(h[0]==="exponential"){const I=h[1];if(typeof I!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:I}}else{if(h[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const I=h.slice(1);if(I.length!==4||I.some(E=>typeof E!="number"||E<0||E>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:I}}}if(t.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(m=o.parse(m,2,Le),!m)return null;const b=[];let S=null;l==="interpolate-hcl"||l==="interpolate-lab"?S=Cn:o.expectedType&&o.expectedType.kind!=="value"&&(S=o.expectedType);for(let I=0;I<_.length;I+=2){const E=_[I],A=_[I+1],z=I+3,D=I+4;if(typeof E!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',z);if(b.length&&b[b.length-1][0]>=E)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',z);const N=o.parse(A,D,S);if(!N)return null;S=S||N.type,b.push([E,N])}return ne(S,Le)||ne(S,Cn)||ne(S,Yr)||ne(S,R)||ne(S,B(Le))?new ni(S,l,h,m,b):o.error(`Type ${$(S)} is not interpolatable.`)}evaluate(t){const o=this.labels,l=this.outputs;if(o.length===1)return l[0].evaluate(t);const h=this.input.evaluate(t);if(h<=o[0])return l[0].evaluate(t);const m=o.length;if(h>=o[m-1])return l[m-1].evaluate(t);const _=zl(o,h),b=ni.interpolationFactor(this.interpolation,h,o[_],o[_+1]),S=l[_].evaluate(t),I=l[_+1].evaluate(t);switch(this.operator){case"interpolate":return En[this.type.kind](S,I,b);case"interpolate-hcl":return En.color(S,I,b,"hcl");case"interpolate-lab":return En.color(S,I,b,"lab")}}eachChild(t){t(this.input);for(const o of this.outputs)t(o)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function xu(i,t,o,l){const h=l-o,m=i-o;return h===0?0:t===1?m/h:(Math.pow(t,m)-1)/(Math.pow(t,h)-1)}class Rl{constructor(t,o){this.type=t,this.args=o}static parse(t,o){if(t.length<2)return o.error("Expectected at least one argument.");let l=null;const h=o.expectedType;h&&h.kind!=="value"&&(l=h);const m=[];for(const b of t.slice(1)){const S=o.parse(b,1+m.length,l,void 0,{typeAnnotation:"omit"});if(!S)return null;l=l||S.type,m.push(S)}if(!l)throw new Error("No output type");const _=h&&m.some(b=>oe(h,b.type));return new Rl(_?bt:l,m)}evaluate(t){let o,l=null,h=0;for(const m of this.args)if(h++,l=m.evaluate(t),l&&l instanceof mi&&!l.available&&(o||(o=l.name),l=null,h===this.args.length&&(l=o)),l!==null)break;return l}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}function bu(i,t){return i==="=="||i==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function wu(i,t,o,l){return l.compare(t,o)===0}function qs(i,t,o){const l=i!=="=="&&i!=="!=";return class bT{constructor(m,_,b){this.type=xt,this.lhs=m,this.rhs=_,this.collator=b,this.hasUntypedArgument=m.type.kind==="value"||_.type.kind==="value"}static parse(m,_){if(m.length!==3&&m.length!==4)return _.error("Expected two or three arguments.");const b=m[0];let S=_.parse(m[1],1,bt);if(!S)return null;if(!bu(b,S.type))return _.concat(1).error(`"${b}" comparisons are not supported for type '${$(S.type)}'.`);let I=_.parse(m[2],2,bt);if(!I)return null;if(!bu(b,I.type))return _.concat(2).error(`"${b}" comparisons are not supported for type '${$(I.type)}'.`);if(S.type.kind!==I.type.kind&&S.type.kind!=="value"&&I.type.kind!=="value")return _.error(`Cannot compare types '${$(S.type)}' and '${$(I.type)}'.`);l&&(S.type.kind==="value"&&I.type.kind!=="value"?S=new Ai(I.type,[S]):S.type.kind!=="value"&&I.type.kind==="value"&&(I=new Ai(S.type,[I])));let E=null;if(m.length===4){if(S.type.kind!=="string"&&I.type.kind!=="string"&&S.type.kind!=="value"&&I.type.kind!=="value")return _.error("Cannot use collator to compare non-string types.");if(E=_.parse(m[3],3,_o),!E)return null}return new bT(S,I,E)}evaluate(m){const _=this.lhs.evaluate(m),b=this.rhs.evaluate(m);if(l&&this.hasUntypedArgument){const S=Br(_),I=Br(b);if(S.kind!==I.kind||S.kind!=="string"&&S.kind!=="number")throw new wr(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${S.kind}, ${I.kind}) instead.`)}if(this.collator&&!l&&this.hasUntypedArgument){const S=Br(_),I=Br(b);if(S.kind!=="string"||I.kind!=="string")return t(m,_,b)}return this.collator?o(m,_,b,this.collator.evaluate(m)):t(m,_,b)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}}}const eg=qs("==",function(i,t,o){return t===o},wu),Pd=qs("!=",function(i,t,o){return t!==o},function(i,t,o,l){return!wu(0,t,o,l)}),Md=qs("<",function(i,t,o){return t<o},function(i,t,o,l){return l.compare(t,o)<0}),tg=qs(">",function(i,t,o){return t>o},function(i,t,o,l){return l.compare(t,o)>0}),rg=qs("<=",function(i,t,o){return t<=o},function(i,t,o,l){return l.compare(t,o)<=0}),ng=qs(">=",function(i,t,o){return t>=o},function(i,t,o,l){return l.compare(t,o)>=0});class Dl{constructor(t,o,l){this.type=_o,this.locale=l,this.caseSensitive=t,this.diacriticSensitive=o}static parse(t,o){if(t.length!==2)return o.error("Expected one argument.");const l=t[1];if(typeof l!="object"||Array.isArray(l))return o.error("Collator options argument must be an object.");const h=o.parse(l["case-sensitive"]!==void 0&&l["case-sensitive"],1,xt);if(!h)return null;const m=o.parse(l["diacritic-sensitive"]!==void 0&&l["diacritic-sensitive"],1,xt);if(!m)return null;let _=null;return l.locale&&(_=o.parse(l.locale,1,St),!_)?null:new Dl(h,m,_)}evaluate(t){return new fu(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class Su{constructor(t,o,l,h,m){this.type=St,this.number=t,this.locale=o,this.currency=l,this.minFractionDigits=h,this.maxFractionDigits=m}static parse(t,o){if(t.length!==3)return o.error("Expected two arguments.");const l=o.parse(t[1],1,Le);if(!l)return null;const h=t[2];if(typeof h!="object"||Array.isArray(h))return o.error("NumberFormat options argument must be an object.");let m=null;if(h.locale&&(m=o.parse(h.locale,1,St),!m))return null;let _=null;if(h.currency&&(_=o.parse(h.currency,1,St),!_))return null;let b=null;if(h["min-fraction-digits"]&&(b=o.parse(h["min-fraction-digits"],1,Le),!b))return null;let S=null;return h["max-fraction-digits"]&&(S=o.parse(h["max-fraction-digits"],1,Le),!S)?null:new Su(l,m,_,b,S)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class Bl{constructor(t){this.type=vo,this.sections=t}static parse(t,o){if(t.length<2)return o.error("Expected at least one argument.");const l=t[1];if(!Array.isArray(l)&&typeof l=="object")return o.error("First argument must be an image or text section.");const h=[];let m=!1;for(let _=1;_<=t.length-1;++_){const b=t[_];if(m&&typeof b=="object"&&!Array.isArray(b)){m=!1;let S=null;if(b["font-scale"]&&(S=o.parse(b["font-scale"],1,Le),!S))return null;let I=null;if(b["text-font"]&&(I=o.parse(b["text-font"],1,B(St)),!I))return null;let E=null;if(b["text-color"]&&(E=o.parse(b["text-color"],1,Cn),!E))return null;const A=h[h.length-1];A.scale=S,A.font=I,A.textColor=E}else{const S=o.parse(t[_],1,bt);if(!S)return null;const I=S.type.kind;if(I!=="string"&&I!=="value"&&I!=="null"&&I!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,h.push({content:S,scale:null,font:null,textColor:null})}}return new Bl(h)}evaluate(t){return new ri(this.sections.map(o=>{const l=o.content.evaluate(t);return Br(l)===K?new mu("",l,null,null,null):new mu(Fa(l),null,o.scale?o.scale.evaluate(t):null,o.font?o.font.evaluate(t).join(","):null,o.textColor?o.textColor.evaluate(t):null)}))}eachChild(t){for(const o of this.sections)t(o.content),o.scale&&t(o.scale),o.font&&t(o.font),o.textColor&&t(o.textColor)}outputDefined(){return!1}}class Tu{constructor(t){this.type=K,this.input=t}static parse(t,o){if(t.length!==2)return o.error("Expected two arguments.");const l=o.parse(t[1],1,St);return l?new Tu(l):o.error("No image name provided.")}evaluate(t){const o=this.input.evaluate(t),l=mi.fromString(o);return l&&t.availableImages&&(l.available=t.availableImages.indexOf(o)>-1),l}eachChild(t){t(this.input)}outputDefined(){return!1}}class Ua{constructor(t){this.type=Le,this.input=t}static parse(t,o){if(t.length!==2)return o.error(`Expected 1 argument, but found ${t.length-1} instead.`);const l=o.parse(t[1],1);return l?l.type.kind!=="array"&&l.type.kind!=="string"&&l.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${$(l.type)} instead.`):new Ua(l):null}evaluate(t){const o=this.input.evaluate(t);if(typeof o=="string"||Array.isArray(o))return o.length;throw new wr(`Expected value to be of type string or array, but found ${$(Br(o))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const ii=8192;function $t(i,t){const o=(180+i[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,h=Math.pow(2,t.z);return[Math.round(o*h*ii),Math.round(l*h*ii)]}function Cu(i,t){const o=Math.pow(2,t.z);return[(h=(i[0]/ii+t.x)/o,360*h-180),(l=(i[1]/ii+t.y)/o,360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90)];var l,h}function ja(i,t){i[0]=Math.min(i[0],t[0]),i[1]=Math.min(i[1],t[1]),i[2]=Math.max(i[2],t[0]),i[3]=Math.max(i[3],t[1])}function Va(i,t){return!(i[0]<=t[0]||i[2]>=t[2]||i[1]<=t[1]||i[3]>=t[3])}function ig(i,t,o){const l=i[0]-t[0],h=i[1]-t[1],m=i[0]-o[0],_=i[1]-o[1];return l*_-m*h==0&&l*m<=0&&h*_<=0}function Fl(i,t,o,l){return(h=[l[0]-o[0],l[1]-o[1]])[0]*(m=[t[0]-i[0],t[1]-i[1]])[1]-h[1]*m[0]!=0&&!(!Ld(i,t,o,l)||!Ld(o,l,i,t));var h,m}function og(i,t,o){for(const l of o)for(let h=0;h<l.length-1;++h)if(Fl(i,t,l[h],l[h+1]))return!0;return!1}function Hs(i,t,o=!1){let l=!1;for(const b of t)for(let S=0;S<b.length-1;S++){if(ig(i,b[S],b[S+1]))return o;(m=b[S])[1]>(h=i)[1]!=(_=b[S+1])[1]>h[1]&&h[0]<(_[0]-m[0])*(h[1]-m[1])/(_[1]-m[1])+m[0]&&(l=!l)}var h,m,_;return l}function sg(i,t){for(const o of t)if(Hs(i,o))return!0;return!1}function zd(i,t){for(const o of i)if(!Hs(o,t))return!1;for(let o=0;o<i.length-1;++o)if(og(i[o],i[o+1],t))return!1;return!0}function ag(i,t){for(const o of t)if(zd(i,o))return!0;return!1}function Ld(i,t,o,l){const h=l[0]-o[0],m=l[1]-o[1],_=(i[0]-o[0])*m-h*(i[1]-o[1]),b=(t[0]-o[0])*m-h*(t[1]-o[1]);return _>0&&b<0||_<0&&b>0}function Iu(i,t,o){const l=[];for(let h=0;h<i.length;h++){const m=[];for(let _=0;_<i[h].length;_++){const b=$t(i[h][_],o);ja(t,b),m.push(b)}l.push(m)}return l}function Rd(i,t,o){const l=[];for(let h=0;h<i.length;h++){const m=Iu(i[h],t,o);l.push(m)}return l}function Dd(i,t,o,l){if(i[0]<o[0]||i[0]>o[2]){const h=.5*l;let m=i[0]-o[0]>h?-l:o[0]-i[0]>h?l:0;m===0&&(m=i[0]-o[2]>h?-l:o[2]-i[0]>h?l:0),i[0]+=m}ja(t,i)}function Bd(i,t,o,l){const h=Math.pow(2,l.z)*ii,m=[l.x*ii,l.y*ii],_=[];for(const b of i)for(const S of b){const I=[S.x+m[0],S.y+m[1]];Dd(I,t,o,h),_.push(I)}return _}function Fd(i,t,o,l){const h=Math.pow(2,l.z)*ii,m=[l.x*ii,l.y*ii],_=[];for(const S of i){const I=[];for(const E of S){const A=[E.x+m[0],E.y+m[1]];ja(t,A),I.push(A)}_.push(I)}if(t[2]-t[0]<=h/2){(b=t)[0]=b[1]=1/0,b[2]=b[3]=-1/0;for(const S of _)for(const I of S)Dd(I,t,o,h)}var b;return _}class fs{constructor(t,o){this.type=xt,this.geojson=t,this.geometries=o}static parse(t,o){if(t.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(xo(t[1])){const l=t[1];if(l.type==="FeatureCollection"){const h=[];for(const m of l.features){const{type:_,coordinates:b}=m.geometry;_==="Polygon"&&h.push(b),_==="MultiPolygon"&&h.push(...b)}if(h.length)return new fs(l,{type:"MultiPolygon",coordinates:h})}else if(l.type==="Feature"){const h=l.geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new fs(l,l.geometry)}else if(l.type==="Polygon"||l.type==="MultiPolygon")return new fs(l,l)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(o,l){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],_=o.canonicalID();if(l.type==="Polygon"){const b=Iu(l.coordinates,m,_),S=Bd(o.geometry(),h,m,_);if(!Va(h,m))return!1;for(const I of S)if(!Hs(I,b))return!1}if(l.type==="MultiPolygon"){const b=Rd(l.coordinates,m,_),S=Bd(o.geometry(),h,m,_);if(!Va(h,m))return!1;for(const I of S)if(!sg(I,b))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(o,l){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],_=o.canonicalID();if(l.type==="Polygon"){const b=Iu(l.coordinates,m,_),S=Fd(o.geometry(),h,m,_);if(!Va(h,m))return!1;for(const I of S)if(!zd(I,b))return!1}if(l.type==="MultiPolygon"){const b=Rd(l.coordinates,m,_),S=Fd(o.geometry(),h,m,_);if(!Va(h,m))return!1;for(const I of S)if(!ag(I,b))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Od=class{constructor(i=[],t=lg){if(this.data=i,this.length=this.data.length,this.compare=t,this.length>0)for(let o=(this.length>>1)-1;o>=0;o--)this._down(o)}push(i){this.data.push(i),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const i=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:t,compare:o}=this,l=t[i];for(;i>0;){const h=i-1>>1,m=t[h];if(o(l,m)>=0)break;t[i]=m,i=h}t[i]=l}_down(i){const{data:t,compare:o}=this,l=this.length>>1,h=t[i];for(;i<l;){let m=1+(i<<1),_=t[m];const b=m+1;if(b<this.length&&o(t[b],_)<0&&(m=b,_=t[b]),o(_,h)>=0)break;t[i]=_,i=m}t[i]=h}};function lg(i,t){return i<t?-1:i>t?1:0}function cg(i,t,o,l,h){Nd(i,t,o,l||i.length-1,h||ug)}function Nd(i,t,o,l,h){for(;l>o;){if(l-o>600){var m=l-o+1,_=t-o+1,b=Math.log(m),S=.5*Math.exp(2*b/3),I=.5*Math.sqrt(b*S*(m-S)/m)*(_-m/2<0?-1:1);Nd(i,t,Math.max(o,Math.floor(t-_*S/m+I)),Math.min(l,Math.floor(t+(m-_)*S/m+I)),h)}var E=i[t],A=o,z=l;for(qa(i,o,t),h(i[l],E)>0&&qa(i,o,l);A<z;){for(qa(i,A,z),A++,z--;h(i[A],E)<0;)A++;for(;h(i[z],E)>0;)z--}h(i[o],E)===0?qa(i,o,z):qa(i,++z,l),z<=t&&(o=z+1),t<=z&&(l=z-1)}}function qa(i,t,o){var l=i[t];i[t]=i[o],i[o]=l}function ug(i,t){return i<t?-1:i>t?1:0}function Ol(i,t){if(i.length<=1)return[i];const o=[];let l,h;for(const m of i){const _=dg(m);_!==0&&(m.area=Math.abs(_),h===void 0&&(h=_<0),h===_<0?(l&&o.push(l),l=[m]):l.push(m))}if(l&&o.push(l),t>1)for(let m=0;m<o.length;m++)o[m].length<=t||(cg(o[m],t,1,o[m].length-1,hg),o[m]=o[m].slice(0,t));return o}function hg(i,t){return t.area-i.area}function dg(i){let t=0;for(let o,l,h=0,m=i.length,_=m-1;h<m;_=h++)o=i[h],l=i[_],t+=(l.x-o.x)*(o.y+l.y);return t}const $d=1/298.257223563,Ud=$d*(2-$d),jd=Math.PI/180;class Eu{constructor(t){const o=6378.137*jd*1e3,l=Math.cos(t*jd),h=1/(1-Ud*(1-l*l)),m=Math.sqrt(h);this.kx=o*m*l,this.ky=o*m*h*(1-Ud)}distance(t,o){const l=this.wrap(t[0]-o[0])*this.kx,h=(t[1]-o[1])*this.ky;return Math.sqrt(l*l+h*h)}pointOnLine(t,o){let l,h,m,_,b=1/0;for(let S=0;S<t.length-1;S++){let I=t[S][0],E=t[S][1],A=this.wrap(t[S+1][0]-I)*this.kx,z=(t[S+1][1]-E)*this.ky,D=0;A===0&&z===0||(D=(this.wrap(o[0]-I)*this.kx*A+(o[1]-E)*this.ky*z)/(A*A+z*z),D>1?(I=t[S+1][0],E=t[S+1][1]):D>0&&(I+=A/this.kx*D,E+=z/this.ky*D)),A=this.wrap(o[0]-I)*this.kx,z=(o[1]-E)*this.ky;const N=A*A+z*z;N<b&&(b=N,l=I,h=E,m=S,_=D)}return{point:[l,h],index:m,t:Math.max(0,Math.min(1,_))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function Vd(i,t){return t[0]-i[0]}function Ws(i){return i[1]-i[0]+1}function bo(i,t){return i[1]>=i[0]&&i[1]<t}function ku(i,t){if(i[0]>i[1])return[null,null];const o=Ws(i);if(t){if(o===2)return[i,null];const h=Math.floor(o/2);return[[i[0],i[0]+h],[i[0]+h,i[1]]]}if(o===1)return[i,null];const l=Math.floor(o/2)-1;return[[i[0],i[0]+l],[i[0]+l+1,i[1]]]}function Au(i,t){if(!bo(t,i.length))return[1/0,1/0,-1/0,-1/0];const o=[1/0,1/0,-1/0,-1/0];for(let l=t[0];l<=t[1];++l)ja(o,i[l]);return o}function Pu(i){const t=[1/0,1/0,-1/0,-1/0];for(const o of i)for(const l of o)ja(t,l);return t}function Sr(i){return i[0]!==-1/0&&i[1]!==-1/0&&i[2]!==1/0&&i[3]!==1/0}function Mu(i,t,o){if(!Sr(i)||!Sr(t))return NaN;let l=0,h=0;return i[2]<t[0]&&(l=t[0]-i[2]),i[0]>t[2]&&(l=i[0]-t[2]),i[1]>t[3]&&(h=i[1]-t[3]),i[3]<t[1]&&(h=t[1]-i[3]),o.distance([0,0],[l,h])}function Ct(i,t,o){const l=o.pointOnLine(t,i);return o.distance(i,l.point)}function Ha(i,t,o,l,h){const m=Math.min(Ct(i,[o,l],h),Ct(t,[o,l],h)),_=Math.min(Ct(o,[i,t],h),Ct(l,[i,t],h));return Math.min(m,_)}function dr(i,t,o,l,h){if(!bo(t,i.length)||!bo(l,o.length))return 1/0;let m=1/0;for(let _=t[0];_<t[1];++_){const b=i[_],S=i[_+1];for(let I=l[0];I<l[1];++I){const E=o[I],A=o[I+1];if(Fl(b,S,E,A))return 0;m=Math.min(m,Ha(b,S,E,A,h))}}return m}function ur(i,t,o,l,h){if(!bo(t,i.length)||!bo(l,o.length))return NaN;let m=1/0;for(let _=t[0];_<=t[1];++_)for(let b=l[0];b<=l[1];++b)if(m=Math.min(m,h.distance(i[_],o[b])),m===0)return m;return m}function Nl(i,t,o){if(Hs(i,t,!0))return 0;let l=1/0;for(const h of t){const m=h[0],_=h[h.length-1];if(m!==_&&(l=Math.min(l,Ct(i,[_,m],o)),l===0))return l;const b=o.pointOnLine(h,i);if(l=Math.min(l,o.distance(i,b.point)),l===0)return l}return l}function qd(i,t,o,l){if(!bo(t,i.length))return NaN;for(let m=t[0];m<=t[1];++m)if(Hs(i[m],o,!0))return 0;let h=1/0;for(let m=t[0];m<t[1];++m){const _=i[m],b=i[m+1];for(const S of o)for(let I=0,E=S.length,A=E-1;I<E;A=I++){const z=S[A],D=S[I];if(Fl(_,b,z,D))return 0;h=Math.min(h,Ha(_,b,z,D,l))}}return h}function zu(i,t){for(const o of i)for(const l of o)if(Hs(l,t,!0))return!0;return!1}function pg(i,t,o,l=1/0){const h=Pu(i),m=Pu(t);if(l!==1/0&&Mu(h,m,o)>=l)return l;if(Va(h,m)){if(zu(i,t))return 0}else if(zu(t,i))return 0;let _=1/0;for(const b of i)for(let S=0,I=b.length,E=I-1;S<I;E=S++){const A=b[E],z=b[S];for(const D of t)for(let N=0,q=D.length,G=q-1;N<q;G=N++){const Q=D[G],de=D[N];if(Fl(A,z,Q,de))return 0;_=Math.min(_,Ha(A,z,Q,de,o))}}return _}function Hd(i,t,o,l,h,m){if(!m)return;const _=Mu(Au(l,m),h,o);_<t&&i.push([_,m,[0,0]])}function $l(i,t,o,l,h,m,_){if(!m||!_)return;const b=Mu(Au(l,m),Au(h,_),o);b<t&&i.push([b,m,_])}function Ul(i,t,o,l,h=1/0){let m=Math.min(l.distance(i[0],o[0][0]),h);if(m===0)return m;const _=new Od([[0,[0,i.length-1],[0,0]]],Vd),b=Pu(o);for(;_.length>0;){const S=_.pop();if(S[0]>=m)continue;const I=S[1],E=t?50:100;if(Ws(I)<=E){if(!bo(I,i.length))return NaN;if(t){const A=qd(i,I,o,l);if(isNaN(A)||A===0)return A;m=Math.min(m,A)}else for(let A=I[0];A<=I[1];++A){const z=Nl(i[A],o,l);if(m=Math.min(m,z),m===0)return 0}}else{const A=ku(I,t);Hd(_,m,l,i,b,A[0]),Hd(_,m,l,i,b,A[1])}}return m}function Wa(i,t,o,l,h,m=1/0){let _=Math.min(m,h.distance(i[0],o[0]));if(_===0)return _;const b=new Od([[0,[0,i.length-1],[0,o.length-1]]],Vd);for(;b.length>0;){const S=b.pop();if(S[0]>=_)continue;const I=S[1],E=S[2],A=t?50:100,z=l?50:100;if(Ws(I)<=A&&Ws(E)<=z){if(!bo(I,i.length)&&bo(E,o.length))return NaN;let D;if(t&&l)D=dr(i,I,o,E,h),_=Math.min(_,D);else if(t&&!l){const N=i.slice(I[0],I[1]+1);for(let q=E[0];q<=E[1];++q)if(D=Ct(o[q],N,h),_=Math.min(_,D),_===0)return _}else if(!t&&l){const N=o.slice(E[0],E[1]+1);for(let q=I[0];q<=I[1];++q)if(D=Ct(i[q],N,h),_=Math.min(_,D),_===0)return _}else D=ur(i,I,o,E,h),_=Math.min(_,D)}else{const D=ku(I,t),N=ku(E,l);$l(b,_,h,i,o,D[0],N[0]),$l(b,_,h,i,o,D[0],N[1]),$l(b,_,h,i,o,D[1],N[0]),$l(b,_,h,i,o,D[1],N[1])}}return _}function jl(i){return i.type==="MultiPolygon"?i.coordinates.map(t=>({type:"Polygon",coordinates:t})):i.type==="MultiLineString"?i.coordinates.map(t=>({type:"LineString",coordinates:t})):i.type==="MultiPoint"?i.coordinates.map(t=>({type:"Point",coordinates:t})):[i]}class $o{constructor(t,o){this.type=Le,this.geojson=t,this.geometries=o}static parse(t,o){if(t.length!==2)return o.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(xo(t[1])){const l=t[1];if(l.type==="FeatureCollection")return new $o(l,l.features.map(h=>jl(h.geometry)).flat());if(l.type==="Feature")return new $o(l,jl(l.geometry));if("type"in l&&"coordinates"in l)return new $o(l,jl(l))}return o.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(o,l){const h=o.geometry(),m=h.flat().map(S=>Cu([S.x,S.y],o.canonical));if(h.length===0)return NaN;const _=new Eu(m[0][1]);let b=1/0;for(const S of l){switch(S.type){case"Point":b=Math.min(b,Wa(m,!1,[S.coordinates],!1,_,b));break;case"LineString":b=Math.min(b,Wa(m,!1,S.coordinates,!0,_,b));break;case"Polygon":b=Math.min(b,Ul(m,!1,S.coordinates,_,b))}if(b===0)return b}return b}(t,this.geometries);if(t.geometryType()==="LineString")return function(o,l){const h=o.geometry(),m=h.flat().map(S=>Cu([S.x,S.y],o.canonical));if(h.length===0)return NaN;const _=new Eu(m[0][1]);let b=1/0;for(const S of l){switch(S.type){case"Point":b=Math.min(b,Wa(m,!0,[S.coordinates],!1,_,b));break;case"LineString":b=Math.min(b,Wa(m,!0,S.coordinates,!0,_,b));break;case"Polygon":b=Math.min(b,Ul(m,!0,S.coordinates,_,b))}if(b===0)return b}return b}(t,this.geometries);if(t.geometryType()==="Polygon")return function(o,l){const h=o.geometry();if(h.length===0||h[0].length===0)return NaN;const m=Ol(h,0).map(S=>S.map(I=>I.map(E=>Cu([E.x,E.y],o.canonical)))),_=new Eu(m[0][0][0][1]);let b=1/0;for(const S of l)for(const I of m){switch(S.type){case"Point":b=Math.min(b,Ul([S.coordinates],!1,I,_,b));break;case"LineString":b=Math.min(b,Ul(S.coordinates,!0,I,_,b));break;case"Polygon":b=Math.min(b,pg(I,S.coordinates,_,b))}if(b===0)return b}return b}(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const ms={"==":eg,"!=":Pd,">":tg,"<":Md,">=":ng,"<=":rg,array:Ai,at:yu,boolean:Ai,case:Ml,coalesce:Rl,collator:Dl,format:Bl,image:Tu,in:Pl,"index-of":Oa,interpolate:ni,"interpolate-hcl":ni,"interpolate-lab":ni,length:Ua,let:Al,literal:hs,match:_u,number:Ai,"number-format":Su,object:Ai,slice:Na,step:$a,string:Ai,"to-boolean":Ji,"to-color":Ji,"to-number":Ji,"to-string":Ji,var:Vs,within:fs,distance:$o};class jn{constructor(t,o,l,h){this.name=t,this.type=o,this._evaluate=l,this.args=h}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,o){const l=t[0],h=jn.definitions[l];if(!h)return o.error(`Unknown expression "${l}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(h)?h[0]:h.type,_=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,b=_.filter(([I])=>!Array.isArray(I)||I.length===t.length-1);let S=null;for(const[I,E]of b){S=new Nt(o.registry,Vl,o.path,null,o.scope);const A=[];let z=!1;for(let D=1;D<t.length;D++){const N=t[D],q=Array.isArray(I)?I[D-1]:I.type,G=S.parse(N,1+A.length,q);if(!G){z=!0;break}A.push(G)}if(!z)if(Array.isArray(I)&&I.length!==A.length)S.error(`Expected ${I.length} arguments, but found ${A.length} instead.`);else{for(let D=0;D<A.length;D++){const N=Array.isArray(I)?I[D]:I.type,q=A[D];S.concat(D+1).checkSubtype(N,q.type)}if(S.errors.length===0)return new jn(l,m,E,A)}}if(b.length===1)o.errors.push(...S.errors);else{const I=(b.length?b:_).map(([A])=>{return z=A,Array.isArray(z)?`(${z.map($).join(", ")})`:`(${$(z.type)}...)`;var z}).join(" | "),E=[];for(let A=1;A<t.length;A++){const z=o.parse(t[A],1+E.length);if(!z)return null;E.push($(z.type))}o.error(`Expected arguments of type ${I}, but found (${E.join(", ")}) instead.`)}return null}static register(t,o){jn.definitions=o;for(const l in o)t[l]=jn}}function Wd(i,[t,o,l,h]){t=t.evaluate(i),o=o.evaluate(i),l=l.evaluate(i);const m=h?h.evaluate(i):1,_=kd(t,o,l,m);if(_)throw new wr(_);return new Vt(t/255,o/255,l/255,m,!1)}function Gd(i,t){return i in t}function Lu(i,t){const o=t[i];return o===void 0?null:o}function gs(i){return{type:i}}function Vl(i){if(i instanceof Vs)return Vl(i.boundExpression);if(i instanceof jn&&i.name==="error"||i instanceof Dl||i instanceof fs||i instanceof $o)return!1;const t=i instanceof Ji||i instanceof Ai;let o=!0;return i.eachChild(l=>{o=t?o&&Vl(l):o&&l instanceof hs}),!!o&&ql(i)&&Hl(i,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function ql(i){if(i instanceof jn&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof fs||i instanceof $o)return!1;let t=!0;return i.eachChild(o=>{t&&!ql(o)&&(t=!1)}),t}function Ga(i){if(i instanceof jn&&i.name==="feature-state")return!1;let t=!0;return i.eachChild(o=>{t&&!Ga(o)&&(t=!1)}),t}function Hl(i,t){if(i instanceof jn&&t.indexOf(i.name)>=0)return!1;let o=!0;return i.eachChild(l=>{o&&!Hl(l,t)&&(o=!1)}),o}function Ru(i){return{result:"success",value:i}}function ys(i){return{result:"error",value:i}}function wo(i){return i["property-type"]==="data-driven"||i["property-type"]==="cross-faded-data-driven"}function Zd(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function Wl(i){return!!i.expression&&i.expression.interpolated}function Dt(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function Gs(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function Gl(i){return i}function Za(i,t){const o=t.type==="color",l=i.stops&&typeof i.stops[0][0]=="object",h=l||!(l||i.property!==void 0),m=i.type||(Wl(t)?"exponential":"interval");if(o||t.type==="padding"){const E=o?Vt.parse:$n.parse;(i=ht({},i)).stops&&(i.stops=i.stops.map(A=>[A[0],E(A[1])])),i.default=E(i.default?i.default:t.default)}if(i.colorSpace&&(_=i.colorSpace)!=="rgb"&&_!=="hcl"&&_!=="lab")throw new Error(`Unknown color space: "${i.colorSpace}"`);var _;let b,S,I;if(m==="exponential")b=Bu;else if(m==="interval")b=Kd;else if(m==="categorical"){b=Du,S=Object.create(null);for(const E of i.stops)S[E[0]]=E[1];I=typeof i.stops[0][0]}else{if(m!=="identity")throw new Error(`Unknown function type "${m}"`);b=Zl}if(l){const E={},A=[];for(let N=0;N<i.stops.length;N++){const q=i.stops[N],G=q[0].zoom;E[G]===void 0&&(E[G]={zoom:G,type:i.type,property:i.property,default:i.default,stops:[]},A.push(G)),E[G].stops.push([q[0].value,q[1]])}const z=[];for(const N of A)z.push([E[N].zoom,Za(E[N],t)]);const D={name:"linear"};return{kind:"composite",interpolationType:D,interpolationFactor:ni.interpolationFactor.bind(void 0,D),zoomStops:z.map(N=>N[0]),evaluate:({zoom:N},q)=>Bu({stops:z,base:i.base},t,N).evaluate(N,q)}}if(h){const E=m==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:E,interpolationFactor:ni.interpolationFactor.bind(void 0,E),zoomStops:i.stops.map(A=>A[0]),evaluate:({zoom:A})=>b(i,t,A,S,I)}}return{kind:"source",evaluate(E,A){const z=A&&A.properties?A.properties[i.property]:void 0;return z===void 0?Zs(i.default,t.default):b(i,t,z,S,I)}}}function Zs(i,t,o){return i!==void 0?i:t!==void 0?t:o!==void 0?o:void 0}function Du(i,t,o,l,h){return Zs(typeof o===h?l[o]:void 0,i.default,t.default)}function Kd(i,t,o){if(Dt(o)!=="number")return Zs(i.default,t.default);const l=i.stops.length;if(l===1||o<=i.stops[0][0])return i.stops[0][1];if(o>=i.stops[l-1][0])return i.stops[l-1][1];const h=zl(i.stops.map(m=>m[0]),o);return i.stops[h][1]}function Bu(i,t,o){const l=i.base!==void 0?i.base:1;if(Dt(o)!=="number")return Zs(i.default,t.default);const h=i.stops.length;if(h===1||o<=i.stops[0][0])return i.stops[0][1];if(o>=i.stops[h-1][0])return i.stops[h-1][1];const m=zl(i.stops.map(E=>E[0]),o),_=function(E,A,z,D){const N=D-z,q=E-z;return N===0?0:A===1?q/N:(Math.pow(A,q)-1)/(Math.pow(A,N)-1)}(o,l,i.stops[m][0],i.stops[m+1][0]),b=i.stops[m][1],S=i.stops[m+1][1],I=En[t.type]||Gl;return typeof b.evaluate=="function"?{evaluate(...E){const A=b.evaluate.apply(void 0,E),z=S.evaluate.apply(void 0,E);if(A!==void 0&&z!==void 0)return I(A,z,_,i.colorSpace)}}:I(b,S,_,i.colorSpace)}function Zl(i,t,o){switch(t.type){case"color":o=Vt.parse(o);break;case"formatted":o=ri.fromString(o.toString());break;case"resolvedImage":o=mi.fromString(o.toString());break;case"padding":o=$n.parse(o);break;default:Dt(o)===t.type||t.type==="enum"&&t.values[o]||(o=void 0)}return Zs(o,i.default,t.default)}jn.register(ms,{error:[{kind:"error"},[St],(i,[t])=>{throw new wr(t.evaluate(i))}],typeof:[St,[bt],(i,[t])=>$(Br(t.evaluate(i)))],"to-rgba":[B(Le,4),[Cn],(i,[t])=>{const[o,l,h,m]=t.evaluate(i).rgb;return[255*o,255*l,255*h,m]}],rgb:[Cn,[Le,Le,Le],Wd],rgba:[Cn,[Le,Le,Le,Le],Wd],has:{type:xt,overloads:[[[St],(i,[t])=>Gd(t.evaluate(i),i.properties())],[[St,In],(i,[t,o])=>Gd(t.evaluate(i),o.evaluate(i))]]},get:{type:bt,overloads:[[[St],(i,[t])=>Lu(t.evaluate(i),i.properties())],[[St,In],(i,[t,o])=>Lu(t.evaluate(i),o.evaluate(i))]]},"feature-state":[bt,[St],(i,[t])=>Lu(t.evaluate(i),i.featureState||{})],properties:[In,[],i=>i.properties()],"geometry-type":[St,[],i=>i.geometryType()],id:[bt,[],i=>i.id()],zoom:[Le,[],i=>i.globals.zoom],"heatmap-density":[Le,[],i=>i.globals.heatmapDensity||0],"line-progress":[Le,[],i=>i.globals.lineProgress||0],accumulated:[bt,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[Le,gs(Le),(i,t)=>{let o=0;for(const l of t)o+=l.evaluate(i);return o}],"*":[Le,gs(Le),(i,t)=>{let o=1;for(const l of t)o*=l.evaluate(i);return o}],"-":{type:Le,overloads:[[[Le,Le],(i,[t,o])=>t.evaluate(i)-o.evaluate(i)],[[Le],(i,[t])=>-t.evaluate(i)]]},"/":[Le,[Le,Le],(i,[t,o])=>t.evaluate(i)/o.evaluate(i)],"%":[Le,[Le,Le],(i,[t,o])=>t.evaluate(i)%o.evaluate(i)],ln2:[Le,[],()=>Math.LN2],pi:[Le,[],()=>Math.PI],e:[Le,[],()=>Math.E],"^":[Le,[Le,Le],(i,[t,o])=>Math.pow(t.evaluate(i),o.evaluate(i))],sqrt:[Le,[Le],(i,[t])=>Math.sqrt(t.evaluate(i))],log10:[Le,[Le],(i,[t])=>Math.log(t.evaluate(i))/Math.LN10],ln:[Le,[Le],(i,[t])=>Math.log(t.evaluate(i))],log2:[Le,[Le],(i,[t])=>Math.log(t.evaluate(i))/Math.LN2],sin:[Le,[Le],(i,[t])=>Math.sin(t.evaluate(i))],cos:[Le,[Le],(i,[t])=>Math.cos(t.evaluate(i))],tan:[Le,[Le],(i,[t])=>Math.tan(t.evaluate(i))],asin:[Le,[Le],(i,[t])=>Math.asin(t.evaluate(i))],acos:[Le,[Le],(i,[t])=>Math.acos(t.evaluate(i))],atan:[Le,[Le],(i,[t])=>Math.atan(t.evaluate(i))],min:[Le,gs(Le),(i,t)=>Math.min(...t.map(o=>o.evaluate(i)))],max:[Le,gs(Le),(i,t)=>Math.max(...t.map(o=>o.evaluate(i)))],abs:[Le,[Le],(i,[t])=>Math.abs(t.evaluate(i))],round:[Le,[Le],(i,[t])=>{const o=t.evaluate(i);return o<0?-Math.round(-o):Math.round(o)}],floor:[Le,[Le],(i,[t])=>Math.floor(t.evaluate(i))],ceil:[Le,[Le],(i,[t])=>Math.ceil(t.evaluate(i))],"filter-==":[xt,[St,bt],(i,[t,o])=>i.properties()[t.value]===o.value],"filter-id-==":[xt,[bt],(i,[t])=>i.id()===t.value],"filter-type-==":[xt,[St],(i,[t])=>i.geometryType()===t.value],"filter-<":[xt,[St,bt],(i,[t,o])=>{const l=i.properties()[t.value],h=o.value;return typeof l==typeof h&&l<h}],"filter-id-<":[xt,[bt],(i,[t])=>{const o=i.id(),l=t.value;return typeof o==typeof l&&o<l}],"filter->":[xt,[St,bt],(i,[t,o])=>{const l=i.properties()[t.value],h=o.value;return typeof l==typeof h&&l>h}],"filter-id->":[xt,[bt],(i,[t])=>{const o=i.id(),l=t.value;return typeof o==typeof l&&o>l}],"filter-<=":[xt,[St,bt],(i,[t,o])=>{const l=i.properties()[t.value],h=o.value;return typeof l==typeof h&&l<=h}],"filter-id-<=":[xt,[bt],(i,[t])=>{const o=i.id(),l=t.value;return typeof o==typeof l&&o<=l}],"filter->=":[xt,[St,bt],(i,[t,o])=>{const l=i.properties()[t.value],h=o.value;return typeof l==typeof h&&l>=h}],"filter-id->=":[xt,[bt],(i,[t])=>{const o=i.id(),l=t.value;return typeof o==typeof l&&o>=l}],"filter-has":[xt,[bt],(i,[t])=>t.value in i.properties()],"filter-has-id":[xt,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[xt,[B(St)],(i,[t])=>t.value.indexOf(i.geometryType())>=0],"filter-id-in":[xt,[B(bt)],(i,[t])=>t.value.indexOf(i.id())>=0],"filter-in-small":[xt,[St,B(bt)],(i,[t,o])=>o.value.indexOf(i.properties()[t.value])>=0],"filter-in-large":[xt,[St,B(bt)],(i,[t,o])=>function(l,h,m,_){for(;m<=_;){const b=m+_>>1;if(h[b]===l)return!0;h[b]>l?_=b-1:m=b+1}return!1}(i.properties()[t.value],o.value,0,o.value.length-1)],all:{type:xt,overloads:[[[xt,xt],(i,[t,o])=>t.evaluate(i)&&o.evaluate(i)],[gs(xt),(i,t)=>{for(const o of t)if(!o.evaluate(i))return!1;return!0}]]},any:{type:xt,overloads:[[[xt,xt],(i,[t,o])=>t.evaluate(i)||o.evaluate(i)],[gs(xt),(i,t)=>{for(const o of t)if(o.evaluate(i))return!0;return!1}]]},"!":[xt,[xt],(i,[t])=>!t.evaluate(i)],"is-supported-script":[xt,[St],(i,[t])=>{const o=i.globals&&i.globals.isSupportedScript;return!o||o(t.evaluate(i))}],upcase:[St,[St],(i,[t])=>t.evaluate(i).toUpperCase()],downcase:[St,[St],(i,[t])=>t.evaluate(i).toLowerCase()],concat:[St,gs(bt),(i,t)=>t.map(o=>Fa(o.evaluate(i))).join("")],"resolved-locale":[St,[_o],(i,[t])=>t.evaluate(i).resolvedLocale()]});class Fu{constructor(t,o){var l;this.expression=t,this._warningHistory={},this._evaluator=new js,this._defaultValue=o?(l=o).type==="color"&&Gs(l.default)?new Vt(0,0,0,0):l.type==="color"?Vt.parse(l.default)||null:l.type==="padding"?$n.parse(l.default)||null:l.type==="variableAnchorOffsetCollection"?Un.parse(l.default)||null:l.default===void 0?null:l.default:null,this._enumValues=o&&o.type==="enum"?o.values:null}evaluateWithoutErrorHandling(t,o,l,h,m,_){return this._evaluator.globals=t,this._evaluator.feature=o,this._evaluator.featureState=l,this._evaluator.canonical=h,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=_,this.expression.evaluate(this._evaluator)}evaluate(t,o,l,h,m,_){this._evaluator.globals=t,this._evaluator.feature=o||null,this._evaluator.featureState=l||null,this._evaluator.canonical=h,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=_||null;try{const b=this.expression.evaluate(this._evaluator);if(b==null||typeof b=="number"&&b!=b)return this._defaultValue;if(this._enumValues&&!(b in this._enumValues))throw new wr(`Expected value to be one of ${Object.keys(this._enumValues).map(S=>JSON.stringify(S)).join(", ")}, but found ${JSON.stringify(b)} instead.`);return b}catch(b){return this._warningHistory[b.message]||(this._warningHistory[b.message]=!0,typeof console<"u"&&console.warn(b.message)),this._defaultValue}}}function Kl(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in ms}function Xl(i,t){const o=new Nt(ms,Vl,[],t?function(h){const m={color:Cn,string:St,number:Le,enum:St,boolean:xt,formatted:vo,padding:Yr,resolvedImage:K,variableAnchorOffsetCollection:R};return h.type==="array"?B(m[h.value]||bt,h.length):m[h.type]}(t):void 0),l=o.parse(i,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?Ru(new Fu(l,t)):ys(o.errors)}class Ou{constructor(t,o){this.kind=t,this._styleExpression=o,this.isStateDependent=t!=="constant"&&!Ga(o.expression)}evaluateWithoutErrorHandling(t,o,l,h,m,_){return this._styleExpression.evaluateWithoutErrorHandling(t,o,l,h,m,_)}evaluate(t,o,l,h,m,_){return this._styleExpression.evaluate(t,o,l,h,m,_)}}class Nu{constructor(t,o,l,h){this.kind=t,this.zoomStops=l,this._styleExpression=o,this.isStateDependent=t!=="camera"&&!Ga(o.expression),this.interpolationType=h}evaluateWithoutErrorHandling(t,o,l,h,m,_){return this._styleExpression.evaluateWithoutErrorHandling(t,o,l,h,m,_)}evaluate(t,o,l,h,m,_){return this._styleExpression.evaluate(t,o,l,h,m,_)}interpolationFactor(t,o,l){return this.interpolationType?ni.interpolationFactor(this.interpolationType,t,o,l):0}}function Ka(i,t){const o=Xl(i,t);if(o.result==="error")return o;const l=o.value.expression,h=ql(l);if(!h&&!wo(t))return ys([new on("","data expressions not supported")]);const m=Hl(l,["zoom"]);if(!m&&!Zd(t))return ys([new on("","zoom expressions not supported")]);const _=hn(l);return _||m?_ instanceof on?ys([_]):_ instanceof ni&&!Wl(t)?ys([new on("",'"interpolate" expressions cannot be used with this property')]):Ru(_?new Nu(h?"camera":"composite",o.value,_.labels,_ instanceof ni?_.interpolation:void 0):new Ou(h?"constant":"source",o.value)):ys([new on("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class _s{constructor(t,o){this._parameters=t,this._specification=o,ht(this,Za(this._parameters,this._specification))}static deserialize(t){return new _s(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function hn(i){let t=null;if(i instanceof Al)t=hn(i.result);else if(i instanceof Rl){for(const o of i.args)if(t=hn(o),t)break}else(i instanceof $a||i instanceof ni)&&i.input instanceof jn&&i.input.name==="zoom"&&(t=i);return t instanceof on||i.eachChild(o=>{const l=hn(o);l instanceof on?t=l:!t&&l?t=new on("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&l&&t!==l&&(t=new on("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function vs(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const t of i.slice(1))if(!vs(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const Xd={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function $u(i){if(i==null)return{filter:()=>!0,needGeometry:!1};vs(i)||(i=Xa(i));const t=Xl(i,Xd);if(t.result==="error")throw new Error(t.value.map(o=>`${o.key}: ${o.message}`).join(", "));return{filter:(o,l,h)=>t.value.evaluate(o,l,{},h),needGeometry:Ks(i)}}function fg(i,t){return i<t?-1:i>t?1:0}function Ks(i){if(!Array.isArray(i))return!1;if(i[0]==="within"||i[0]==="distance")return!0;for(let t=1;t<i.length;t++)if(Ks(i[t]))return!0;return!1}function Xa(i){if(!i)return!0;const t=i[0];return i.length<=1?t!=="any":t==="=="?Ya(i[1],i[2],"=="):t==="!="?Jl(Ya(i[1],i[2],"==")):t==="<"||t===">"||t==="<="||t===">="?Ya(i[1],i[2],t):t==="any"?(o=i.slice(1),["any"].concat(o.map(Xa))):t==="all"?["all"].concat(i.slice(1).map(Xa)):t==="none"?["all"].concat(i.slice(1).map(Xa).map(Jl)):t==="in"?Yd(i[1],i.slice(2)):t==="!in"?Jl(Yd(i[1],i.slice(2))):t==="has"?Yl(i[1]):t!=="!has"||Jl(Yl(i[1]));var o}function Ya(i,t,o){switch(i){case"$type":return[`filter-type-${o}`,t];case"$id":return[`filter-id-${o}`,t];default:return[`filter-${o}`,i,t]}}function Yd(i,t){if(t.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(o=>typeof o!=typeof t[0])?["filter-in-large",i,["literal",t.sort(fg)]]:["filter-in-small",i,["literal",t]]}}function Yl(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function Jl(i){return["!",i]}function xs(i){const t=typeof i;if(t==="number"||t==="boolean"||t==="string"||i==null)return JSON.stringify(i);if(Array.isArray(i)){let h="[";for(const m of i)h+=`${xs(m)},`;return`${h}]`}const o=Object.keys(i).sort();let l="{";for(let h=0;h<o.length;h++)l+=`${JSON.stringify(o[h])}:${xs(i[o[h]])},`;return`${l}}`}function mg(i){let t="";for(const o of Xi)t+=`/${xs(i[o])}`;return t}function Ql(i){const t=i.value;return t?[new Re(i.key,t,"constants have been deprecated as of v8")]:[]}function mr(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function So(i){if(Array.isArray(i))return i.map(So);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const t={};for(const o in i)t[o]=So(i[o]);return t}return mr(i)}function oi(i){const t=i.key,o=i.value,l=i.valueSpec||{},h=i.objectElementValidators||{},m=i.style,_=i.styleSpec,b=i.validateSpec;let S=[];const I=Dt(o);if(I!=="object")return[new Re(t,o,`object expected, ${I} found`)];for(const E in o){const A=E.split(".")[0],z=l[A]||l["*"];let D;if(h[A])D=h[A];else if(l[A])D=b;else if(h["*"])D=h["*"];else{if(!l["*"]){S.push(new Re(t,o[E],`unknown property "${E}"`));continue}D=b}S=S.concat(D({key:(t&&`${t}.`)+E,value:o[E],valueSpec:z,style:m,styleSpec:_,object:o,objectKey:E,validateSpec:b},o))}for(const E in l)h[E]||l[E].required&&l[E].default===void 0&&o[E]===void 0&&S.push(new Re(t,o,`missing required property "${E}"`));return S}function ec(i){const t=i.value,o=i.valueSpec,l=i.style,h=i.styleSpec,m=i.key,_=i.arrayElementValidator||i.validateSpec;if(Dt(t)!=="array")return[new Re(m,t,`array expected, ${Dt(t)} found`)];if(o.length&&t.length!==o.length)return[new Re(m,t,`array length ${o.length} expected, length ${t.length} found`)];if(o["min-length"]&&t.length<o["min-length"])return[new Re(m,t,`array length at least ${o["min-length"]} expected, length ${t.length} found`)];let b={type:o.value,values:o.values};h.$version<7&&(b.function=o.function),Dt(o.value)==="object"&&(b=o.value);let S=[];for(let I=0;I<t.length;I++)S=S.concat(_({array:t,arrayIndex:I,value:t[I],valueSpec:b,validateSpec:i.validateSpec,style:l,styleSpec:h,key:`${m}[${I}]`}));return S}function Uu(i){const t=i.key,o=i.value,l=i.valueSpec;let h=Dt(o);return h==="number"&&o!=o&&(h="NaN"),h!=="number"?[new Re(t,o,`number expected, ${h} found`)]:"minimum"in l&&o<l.minimum?[new Re(t,o,`${o} is less than the minimum value ${l.minimum}`)]:"maximum"in l&&o>l.maximum?[new Re(t,o,`${o} is greater than the maximum value ${l.maximum}`)]:[]}function tc(i){const t=i.valueSpec,o=mr(i.value.type);let l,h,m,_={};const b=o!=="categorical"&&i.value.property===void 0,S=!b,I=Dt(i.value.stops)==="array"&&Dt(i.value.stops[0])==="array"&&Dt(i.value.stops[0][0])==="object",E=oi({key:i.key,value:i.value,valueSpec:i.styleSpec.function,validateSpec:i.validateSpec,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(D){if(o==="identity")return[new Re(D.key,D.value,'identity function may not have a "stops" property')];let N=[];const q=D.value;return N=N.concat(ec({key:D.key,value:q,valueSpec:D.valueSpec,validateSpec:D.validateSpec,style:D.style,styleSpec:D.styleSpec,arrayElementValidator:A})),Dt(q)==="array"&&q.length===0&&N.push(new Re(D.key,q,"array must have at least one stop")),N},default:function(D){return D.validateSpec({key:D.key,value:D.value,valueSpec:t,validateSpec:D.validateSpec,style:D.style,styleSpec:D.styleSpec})}}});return o==="identity"&&b&&E.push(new Re(i.key,i.value,'missing required property "property"')),o==="identity"||i.value.stops||E.push(new Re(i.key,i.value,'missing required property "stops"')),o==="exponential"&&i.valueSpec.expression&&!Wl(i.valueSpec)&&E.push(new Re(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(S&&!wo(i.valueSpec)?E.push(new Re(i.key,i.value,"property functions not supported")):b&&!Zd(i.valueSpec)&&E.push(new Re(i.key,i.value,"zoom functions not supported"))),o!=="categorical"&&!I||i.value.property!==void 0||E.push(new Re(i.key,i.value,'"property" property is required')),E;function A(D){let N=[];const q=D.value,G=D.key;if(Dt(q)!=="array")return[new Re(G,q,`array expected, ${Dt(q)} found`)];if(q.length!==2)return[new Re(G,q,`array length 2 expected, length ${q.length} found`)];if(I){if(Dt(q[0])!=="object")return[new Re(G,q,`object expected, ${Dt(q[0])} found`)];if(q[0].zoom===void 0)return[new Re(G,q,"object stop key must have zoom")];if(q[0].value===void 0)return[new Re(G,q,"object stop key must have value")];if(m&&m>mr(q[0].zoom))return[new Re(G,q[0].zoom,"stop zoom values must appear in ascending order")];mr(q[0].zoom)!==m&&(m=mr(q[0].zoom),h=void 0,_={}),N=N.concat(oi({key:`${G}[0]`,value:q[0],valueSpec:{zoom:{}},validateSpec:D.validateSpec,style:D.style,styleSpec:D.styleSpec,objectElementValidators:{zoom:Uu,value:z}}))}else N=N.concat(z({key:`${G}[0]`,value:q[0],valueSpec:{},validateSpec:D.validateSpec,style:D.style,styleSpec:D.styleSpec},q));return Kl(So(q[1]))?N.concat([new Re(`${G}[1]`,q[1],"expressions are not allowed in function stops.")]):N.concat(D.validateSpec({key:`${G}[1]`,value:q[1],valueSpec:t,validateSpec:D.validateSpec,style:D.style,styleSpec:D.styleSpec}))}function z(D,N){const q=Dt(D.value),G=mr(D.value),Q=D.value!==null?D.value:N;if(l){if(q!==l)return[new Re(D.key,Q,`${q} stop domain type must match previous stop domain type ${l}`)]}else l=q;if(q!=="number"&&q!=="string"&&q!=="boolean")return[new Re(D.key,Q,"stop domain value must be a number, string, or boolean")];if(q!=="number"&&o!=="categorical"){let de=`number expected, ${q} found`;return wo(t)&&o===void 0&&(de+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Re(D.key,Q,de)]}return o!=="categorical"||q!=="number"||isFinite(G)&&Math.floor(G)===G?o!=="categorical"&&q==="number"&&h!==void 0&&G<h?[new Re(D.key,Q,"stop domain values must appear in ascending order")]:(h=G,o==="categorical"&&G in _?[new Re(D.key,Q,"stop domain values must be unique")]:(_[G]=!0,[])):[new Re(D.key,Q,`integer expected, found ${G}`)]}}function To(i){const t=(i.expressionContext==="property"?Ka:Xl)(So(i.value),i.valueSpec);if(t.result==="error")return t.value.map(l=>new Re(`${i.key}${l.key}`,i.value,l.message));const o=t.value.expression||t.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!o.outputDefined())return[new Re(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!Ga(o))return[new Re(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter"&&!Ga(o))return[new Re(i.key,i.value,'"feature-state" data expressions are not supported with filters.')];if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!Hl(o,["zoom","feature-state"]))return[new Re(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!ql(o))return[new Re(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Xs(i){const t=i.key,o=i.value,l=i.valueSpec,h=[];return Array.isArray(l.values)?l.values.indexOf(mr(o))===-1&&h.push(new Re(t,o,`expected one of [${l.values.join(", ")}], ${JSON.stringify(o)} found`)):Object.keys(l.values).indexOf(mr(o))===-1&&h.push(new Re(t,o,`expected one of [${Object.keys(l.values).join(", ")}], ${JSON.stringify(o)} found`)),h}function rc(i){return vs(So(i.value))?To(ht({},i,{expressionContext:"filter",valueSpec:{value:"boolean"}})):ju(i)}function ju(i){const t=i.value,o=i.key;if(Dt(t)!=="array")return[new Re(o,t,`array expected, ${Dt(t)} found`)];const l=i.styleSpec;let h,m=[];if(t.length<1)return[new Re(o,t,"filter array must have at least 1 element")];switch(m=m.concat(Xs({key:`${o}[0]`,value:t[0],valueSpec:l.filter_operator,style:i.style,styleSpec:i.styleSpec})),mr(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&mr(t[1])==="$type"&&m.push(new Re(o,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&m.push(new Re(o,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(h=Dt(t[1]),h!=="string"&&m.push(new Re(`${o}[1]`,t[1],`string expected, ${h} found`)));for(let _=2;_<t.length;_++)h=Dt(t[_]),mr(t[1])==="$type"?m=m.concat(Xs({key:`${o}[${_}]`,value:t[_],valueSpec:l.geometry_type,style:i.style,styleSpec:i.styleSpec})):h!=="string"&&h!=="number"&&h!=="boolean"&&m.push(new Re(`${o}[${_}]`,t[_],`string, number, or boolean expected, ${h} found`));break;case"any":case"all":case"none":for(let _=1;_<t.length;_++)m=m.concat(ju({key:`${o}[${_}]`,value:t[_],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":h=Dt(t[1]),t.length!==2?m.push(new Re(o,t,`filter array for "${t[0]}" operator must have 2 elements`)):h!=="string"&&m.push(new Re(`${o}[1]`,t[1],`string expected, ${h} found`))}return m}function Vu(i,t){const o=i.key,l=i.validateSpec,h=i.style,m=i.styleSpec,_=i.value,b=i.objectKey,S=m[`${t}_${i.layerType}`];if(!S)return[];const I=b.match(/^(.*)-transition$/);if(t==="paint"&&I&&S[I[1]]&&S[I[1]].transition)return l({key:o,value:_,valueSpec:m.transition,style:h,styleSpec:m});const E=i.valueSpec||S[b];if(!E)return[new Re(o,_,`unknown property "${b}"`)];let A;if(Dt(_)==="string"&&wo(E)&&!E.tokens&&(A=/^{([^}]+)}$/.exec(_)))return[new Re(o,_,`"${b}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(A[1])} }\`.`)];const z=[];return i.layerType==="symbol"&&(b==="text-field"&&h&&!h.glyphs&&z.push(new Re(o,_,'use of "text-field" requires a style "glyphs" property')),b==="text-font"&&Gs(So(_))&&mr(_.type)==="identity"&&z.push(new Re(o,_,'"text-font" does not support identity functions'))),z.concat(l({key:i.key,value:_,valueSpec:E,style:h,styleSpec:m,expressionContext:"property",propertyType:t,propertyKey:b}))}function nc(i){return Vu(i,"paint")}function qu(i){return Vu(i,"layout")}function Jd(i){let t=[];const o=i.value,l=i.key,h=i.style,m=i.styleSpec;o.type||o.ref||t.push(new Re(l,o,'either "type" or "ref" is required'));let _=mr(o.type);const b=mr(o.ref);if(o.id){const S=mr(o.id);for(let I=0;I<i.arrayIndex;I++){const E=h.layers[I];mr(E.id)===S&&t.push(new Re(l,o.id,`duplicate layer id "${o.id}", previously used at line ${E.id.__line__}`))}}if("ref"in o){let S;["type","source","source-layer","filter","layout"].forEach(I=>{I in o&&t.push(new Re(l,o[I],`"${I}" is prohibited for ref layers`))}),h.layers.forEach(I=>{mr(I.id)===b&&(S=I)}),S?S.ref?t.push(new Re(l,o.ref,"ref cannot reference another ref layer")):_=mr(S.type):t.push(new Re(l,o.ref,`ref layer "${b}" not found`))}else if(_!=="background")if(o.source){const S=h.sources&&h.sources[o.source],I=S&&mr(S.type);S?I==="vector"&&_==="raster"?t.push(new Re(l,o.source,`layer "${o.id}" requires a raster source`)):I!=="raster-dem"&&_==="hillshade"?t.push(new Re(l,o.source,`layer "${o.id}" requires a raster-dem source`)):I==="raster"&&_!=="raster"?t.push(new Re(l,o.source,`layer "${o.id}" requires a vector source`)):I!=="vector"||o["source-layer"]?I==="raster-dem"&&_!=="hillshade"?t.push(new Re(l,o.source,"raster-dem source can only be used with layer type 'hillshade'.")):_!=="line"||!o.paint||!o.paint["line-gradient"]||I==="geojson"&&S.lineMetrics||t.push(new Re(l,o,`layer "${o.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new Re(l,o,`layer "${o.id}" must specify a "source-layer"`)):t.push(new Re(l,o.source,`source "${o.source}" not found`))}else t.push(new Re(l,o,'missing required property "source"'));return t=t.concat(oi({key:l,value:o,valueSpec:m.layer,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,objectElementValidators:{"*":()=>[],type:()=>i.validateSpec({key:`${l}.type`,value:o.type,valueSpec:m.layer.type,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,object:o,objectKey:"type"}),filter:rc,layout:S=>oi({layer:o,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":I=>qu(ht({layerType:_},I))}}),paint:S=>oi({layer:o,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":I=>nc(ht({layerType:_},I))}})}})),t}function Uo(i){const t=i.value,o=i.key,l=Dt(t);return l!=="string"?[new Re(o,t,`string expected, ${l} found`)]:[]}const Qd={promoteId:function({key:i,value:t}){if(Dt(t)==="string")return Uo({key:i,value:t});{const o=[];for(const l in t)o.push(...Uo({key:`${i}.${l}`,value:t[l]}));return o}}};function Hu(i){const t=i.value,o=i.key,l=i.styleSpec,h=i.style,m=i.validateSpec;if(!t.type)return[new Re(o,t,'"type" is required')];const _=mr(t.type);let b;switch(_){case"vector":case"raster":return b=oi({key:o,value:t,valueSpec:l[`source_${_.replace("-","_")}`],style:i.style,styleSpec:l,objectElementValidators:Qd,validateSpec:m}),b;case"raster-dem":return b=function(S){var I;const E=(I=S.sourceName)!==null&&I!==void 0?I:"",A=S.value,z=S.styleSpec,D=z.source_raster_dem,N=S.style;let q=[];const G=Dt(A);if(A===void 0)return q;if(G!=="object")return q.push(new Re("source_raster_dem",A,`object expected, ${G} found`)),q;const Q=mr(A.encoding)==="custom",de=["redFactor","greenFactor","blueFactor","baseShift"],ie=S.value.encoding?`"${S.value.encoding}"`:"Default";for(const ue in A)!Q&&de.includes(ue)?q.push(new Re(ue,A[ue],`In "${E}": "${ue}" is only valid when "encoding" is set to "custom". ${ie} encoding found`)):D[ue]?q=q.concat(S.validateSpec({key:ue,value:A[ue],valueSpec:D[ue],validateSpec:S.validateSpec,style:N,styleSpec:z})):q.push(new Re(ue,A[ue],`unknown property "${ue}"`));return q}({sourceName:o,value:t,style:i.style,styleSpec:l,validateSpec:m}),b;case"geojson":if(b=oi({key:o,value:t,valueSpec:l.source_geojson,style:h,styleSpec:l,validateSpec:m,objectElementValidators:Qd}),t.cluster)for(const S in t.clusterProperties){const[I,E]=t.clusterProperties[S],A=typeof I=="string"?[I,["accumulated"],["get",S]]:I;b.push(...To({key:`${o}.${S}.map`,value:E,validateSpec:m,expressionContext:"cluster-map"})),b.push(...To({key:`${o}.${S}.reduce`,value:A,validateSpec:m,expressionContext:"cluster-reduce"}))}return b;case"video":return oi({key:o,value:t,valueSpec:l.source_video,style:h,validateSpec:m,styleSpec:l});case"image":return oi({key:o,value:t,valueSpec:l.source_image,style:h,validateSpec:m,styleSpec:l});case"canvas":return[new Re(o,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Xs({key:`${o}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:h,validateSpec:m,styleSpec:l})}}function Wu(i){const t=i.value,o=i.styleSpec,l=o.light,h=i.style;let m=[];const _=Dt(t);if(t===void 0)return m;if(_!=="object")return m=m.concat([new Re("light",t,`object expected, ${_} found`)]),m;for(const b in t){const S=b.match(/^(.*)-transition$/);m=m.concat(S&&l[S[1]]&&l[S[1]].transition?i.validateSpec({key:b,value:t[b],valueSpec:o.transition,validateSpec:i.validateSpec,style:h,styleSpec:o}):l[b]?i.validateSpec({key:b,value:t[b],valueSpec:l[b],validateSpec:i.validateSpec,style:h,styleSpec:o}):[new Re(b,t[b],`unknown property "${b}"`)])}return m}function Gu(i){const t=i.value,o=i.styleSpec,l=o.sky,h=i.style,m=Dt(t);if(t===void 0)return[];if(m!=="object")return[new Re("sky",t,`object expected, ${m} found`)];let _=[];for(const b in t)_=_.concat(l[b]?i.validateSpec({key:b,value:t[b],valueSpec:l[b],style:h,styleSpec:o}):[new Re(b,t[b],`unknown property "${b}"`)]);return _}function ep(i){const t=i.value,o=i.styleSpec,l=o.terrain,h=i.style;let m=[];const _=Dt(t);if(t===void 0)return m;if(_!=="object")return m=m.concat([new Re("terrain",t,`object expected, ${_} found`)]),m;for(const b in t)m=m.concat(l[b]?i.validateSpec({key:b,value:t[b],valueSpec:l[b],validateSpec:i.validateSpec,style:h,styleSpec:o}):[new Re(b,t[b],`unknown property "${b}"`)]);return m}function tp(i){let t=[];const o=i.value,l=i.key;if(Array.isArray(o)){const h=[],m=[];for(const _ in o)o[_].id&&h.includes(o[_].id)&&t.push(new Re(l,o,`all the sprites' ids must be unique, but ${o[_].id} is duplicated`)),h.push(o[_].id),o[_].url&&m.includes(o[_].url)&&t.push(new Re(l,o,`all the sprites' URLs must be unique, but ${o[_].url} is duplicated`)),m.push(o[_].url),t=t.concat(oi({key:`${l}[${_}]`,value:o[_],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:i.validateSpec}));return t}return Uo({key:l,value:o})}const Zu={"*":()=>[],array:ec,boolean:function(i){const t=i.value,o=i.key,l=Dt(t);return l!=="boolean"?[new Re(o,t,`boolean expected, ${l} found`)]:[]},number:Uu,color:function(i){const t=i.key,o=i.value,l=Dt(o);return l!=="string"?[new Re(t,o,`color expected, ${l} found`)]:Vt.parse(String(o))?[]:[new Re(t,o,`color expected, "${o}" found`)]},constants:Ql,enum:Xs,filter:rc,function:tc,layer:Jd,object:oi,source:Hu,light:Wu,sky:Gu,terrain:ep,projection:function(i){const t=i.value,o=i.styleSpec,l=o.projection,h=i.style,m=Dt(t);if(t===void 0)return[];if(m!=="object")return[new Re("projection",t,`object expected, ${m} found`)];let _=[];for(const b in t)_=_.concat(l[b]?i.validateSpec({key:b,value:t[b],valueSpec:l[b],style:h,styleSpec:o}):[new Re(b,t[b],`unknown property "${b}"`)]);return _},string:Uo,formatted:function(i){return Uo(i).length===0?[]:To(i)},resolvedImage:function(i){return Uo(i).length===0?[]:To(i)},padding:function(i){const t=i.key,o=i.value;if(Dt(o)==="array"){if(o.length<1||o.length>4)return[new Re(t,o,`padding requires 1 to 4 values; ${o.length} values found`)];const l={type:"number"};let h=[];for(let m=0;m<o.length;m++)h=h.concat(i.validateSpec({key:`${t}[${m}]`,value:o[m],validateSpec:i.validateSpec,valueSpec:l}));return h}return Uu({key:t,value:o,valueSpec:{}})},variableAnchorOffsetCollection:function(i){const t=i.key,o=i.value,l=Dt(o),h=i.styleSpec;if(l!=="array"||o.length<1||o.length%2!=0)return[new Re(t,o,"variableAnchorOffsetCollection requires a non-empty array of even length")];let m=[];for(let _=0;_<o.length;_+=2)m=m.concat(Xs({key:`${t}[${_}]`,value:o[_],valueSpec:h.layout_symbol["text-anchor"]})),m=m.concat(ec({key:`${t}[${_+1}]`,value:o[_+1],valueSpec:{length:2,value:"number"},validateSpec:i.validateSpec,style:i.style,styleSpec:h}));return m},sprite:tp};function Ys(i){const t=i.value,o=i.valueSpec,l=i.styleSpec;return i.validateSpec=Ys,o.expression&&Gs(mr(t))?tc(i):o.expression&&Kl(So(t))?To(i):o.type&&Zu[o.type]?Zu[o.type](i):oi(ht({},i,{valueSpec:o.type?l[o.type]:o}))}function Ku(i){const t=i.value,o=i.key,l=Uo(i);return l.length||(t.indexOf("{fontstack}")===-1&&l.push(new Re(o,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&l.push(new Re(o,t,'"glyphs" url must include a "{range}" token'))),l}function gi(i,t=be){let o=[];return o=o.concat(Ys({key:"",value:i,valueSpec:t.$root,styleSpec:t,style:i,validateSpec:Ys,objectElementValidators:{glyphs:Ku,"*":()=>[]}})),i.constants&&(o=o.concat(Ql({key:"constants",value:i.constants,style:i,styleSpec:t,validateSpec:Ys}))),rp(o)}function si(i){return function(t){return i({...t,validateSpec:Ys})}}function rp(i){return[].concat(i).sort((t,o)=>t.line-o.line)}function yi(i){return function(...t){return rp(i.apply(this,t))}}gi.source=yi(si(Hu)),gi.sprite=yi(si(tp)),gi.glyphs=yi(si(Ku)),gi.light=yi(si(Wu)),gi.sky=yi(si(Gu)),gi.terrain=yi(si(ep)),gi.layer=yi(si(Jd)),gi.filter=yi(si(rc)),gi.paintProperty=yi(si(nc)),gi.layoutProperty=yi(si(qu));const Ja=gi,gg=Ja.light,np=Ja.paintProperty,ip=Ja.layoutProperty;function Xu(i,t){let o=!1;if(t&&t.length)for(const l of t)i.fire(new br(new Error(l.message))),o=!0;return o}class Qa{constructor(t,o,l){const h=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const _=new Int32Array(this.arrayBuffer);t=_[0],this.d=(o=_[1])+2*(l=_[2]);for(let S=0;S<this.d*this.d;S++){const I=_[3+S],E=_[3+S+1];h.push(I===E?null:_.subarray(I,E))}const b=_[3+h.length+1];this.keys=_.subarray(_[3+h.length],b),this.bboxes=_.subarray(b),this.insert=this._insertReadonly}else{this.d=o+2*l;for(let _=0;_<this.d*this.d;_++)h.push([]);this.keys=[],this.bboxes=[]}this.n=o,this.extent=t,this.padding=l,this.scale=o/t,this.uid=0;const m=l/o*t;this.min=-m,this.max=t+m}insert(t,o,l,h,m){this._forEachCell(o,l,h,m,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(o),this.bboxes.push(l),this.bboxes.push(h),this.bboxes.push(m)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,o,l,h,m,_){this.cells[m].push(_)}query(t,o,l,h,m){const _=this.min,b=this.max;if(t<=_&&o<=_&&b<=l&&b<=h&&!m)return Array.prototype.slice.call(this.keys);{const S=[];return this._forEachCell(t,o,l,h,this._queryCell,S,{},m),S}}_queryCell(t,o,l,h,m,_,b,S){const I=this.cells[m];if(I!==null){const E=this.keys,A=this.bboxes;for(let z=0;z<I.length;z++){const D=I[z];if(b[D]===void 0){const N=4*D;(S?S(A[N+0],A[N+1],A[N+2],A[N+3]):t<=A[N+2]&&o<=A[N+3]&&l>=A[N+0]&&h>=A[N+1])?(b[D]=!0,_.push(E[D])):b[D]=!1}}}}_forEachCell(t,o,l,h,m,_,b,S){const I=this._convertToCellCoord(t),E=this._convertToCellCoord(o),A=this._convertToCellCoord(l),z=this._convertToCellCoord(h);for(let D=I;D<=A;D++)for(let N=E;N<=z;N++){const q=this.d*N+D;if((!S||S(this._convertFromCellCoord(D),this._convertFromCellCoord(N),this._convertFromCellCoord(D+1),this._convertFromCellCoord(N+1)))&&m.call(this,t,o,l,h,q,_,b,S))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,o=3+this.cells.length+1+1;let l=0;for(let _=0;_<this.cells.length;_++)l+=this.cells[_].length;const h=new Int32Array(o+l+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;let m=o;for(let _=0;_<t.length;_++){const b=t[_];h[3+_]=m,h.set(b,m),m+=b.length}return h[3+t.length]=m,h.set(this.keys,m),m+=this.keys.length,h[3+t.length+1]=m,h.set(this.bboxes,m),m+=this.bboxes.length,h.buffer}static serialize(t,o){const l=t.toArrayBuffer();return o&&o.push(l),{buffer:l}}static deserialize(t){return new Qa(t.buffer)}}const jo={};function Xe(i,t,o={}){if(jo[i])throw new Error(`${i} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:i,writeable:!1}),jo[i]={klass:t,omit:o.omit||[],shallow:o.shallow||[]}}Xe("Object",Object),Xe("TransferableGridIndex",Qa),Xe("Color",Vt),Xe("Error",Error),Xe("AJAXError",Xr),Xe("ResolvedImage",mi),Xe("StylePropertyFunction",_s),Xe("StyleExpression",Fu,{omit:["_evaluator"]}),Xe("ZoomDependentExpression",Nu),Xe("ZoomConstantExpression",Ou),Xe("CompoundExpression",jn,{omit:["_evaluate"]});for(const i in ms)ms[i]._classRegistryKey||Xe(`Expression_${i}`,ms[i]);function op(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function el(i,t){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob||i instanceof Error)return i;if(op(i)||Rr(i))return t&&t.push(i),i;if(ArrayBuffer.isView(i)){const o=i;return t&&t.push(o.buffer),o}if(i instanceof ImageData)return t&&t.push(i.data.buffer),i;if(Array.isArray(i)){const o=[];for(const l of i)o.push(el(l,t));return o}if(typeof i=="object"){const o=i.constructor,l=o._classRegistryKey;if(!l)throw new Error(`can't serialize object of unregistered class ${o.name}`);if(!jo[l])throw new Error(`${l} is not registered.`);const h=o.serialize?o.serialize(i,t):{};if(o.serialize){if(t&&h===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const m in i){if(!i.hasOwnProperty(m)||jo[l].omit.indexOf(m)>=0)continue;const _=i[m];h[m]=jo[l].shallow.indexOf(m)>=0?_:el(_,t)}i instanceof Error&&(h.message=i.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return l!=="Object"&&(h.$name=l),h}throw new Error("can't serialize object of type "+typeof i)}function Qi(i){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob||i instanceof Error||op(i)||Rr(i)||ArrayBuffer.isView(i)||i instanceof ImageData)return i;if(Array.isArray(i))return i.map(Qi);if(typeof i=="object"){const t=i.$name||"Object";if(!jo[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:o}=jo[t];if(!o)throw new Error(`can't deserialize unregistered class ${t}`);if(o.deserialize)return o.deserialize(i);const l=Object.create(o.prototype);for(const h of Object.keys(i)){if(h==="$name")continue;const m=i[h];l[h]=jo[t].shallow.indexOf(h)>=0?m:Qi(m)}return l}throw new Error("can't deserialize object of type "+typeof i)}class sp{constructor(){this.first=!0}update(t,o){const l=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=l,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=l,!0):(this.lastFloorZoom>l?(this.lastIntegerZoom=l+1,this.lastIntegerZoomTime=o):this.lastFloorZoom<l&&(this.lastIntegerZoom=l,this.lastIntegerZoomTime=o),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=l,!0))}}const Ve={"Latin-1 Supplement":i=>i>=128&&i<=255,Arabic:i=>i>=1536&&i<=1791,"Arabic Supplement":i=>i>=1872&&i<=1919,"Arabic Extended-A":i=>i>=2208&&i<=2303,"Hangul Jamo":i=>i>=4352&&i<=4607,"Unified Canadian Aboriginal Syllabics":i=>i>=5120&&i<=5759,Khmer:i=>i>=6016&&i<=6143,"Unified Canadian Aboriginal Syllabics Extended":i=>i>=6320&&i<=6399,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"CJK Radicals Supplement":i=>i>=11904&&i<=12031,"Kangxi Radicals":i=>i>=12032&&i<=12255,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Hiragana:i=>i>=12352&&i<=12447,Katakana:i=>i>=12448&&i<=12543,Bopomofo:i=>i>=12544&&i<=12591,"Hangul Compatibility Jamo":i=>i>=12592&&i<=12687,Kanbun:i=>i>=12688&&i<=12703,"Bopomofo Extended":i=>i>=12704&&i<=12735,"CJK Strokes":i=>i>=12736&&i<=12783,"Katakana Phonetic Extensions":i=>i>=12784&&i<=12799,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"CJK Unified Ideographs Extension A":i=>i>=13312&&i<=19903,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"CJK Unified Ideographs":i=>i>=19968&&i<=40959,"Yi Syllables":i=>i>=40960&&i<=42127,"Yi Radicals":i=>i>=42128&&i<=42191,"Hangul Jamo Extended-A":i=>i>=43360&&i<=43391,"Hangul Syllables":i=>i>=44032&&i<=55215,"Hangul Jamo Extended-B":i=>i>=55216&&i<=55295,"Private Use Area":i=>i>=57344&&i<=63743,"CJK Compatibility Ideographs":i=>i>=63744&&i<=64255,"Arabic Presentation Forms-A":i=>i>=64336&&i<=65023,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Arabic Presentation Forms-B":i=>i>=65136&&i<=65279,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519};function Yu(i){for(const t of i)if(Ju(t.charCodeAt(0)))return!0;return!1}function yg(i){for(const t of i)if(!ap(t.charCodeAt(0)))return!1;return!0}function ap(i){return!(Ve.Arabic(i)||Ve["Arabic Supplement"](i)||Ve["Arabic Extended-A"](i)||Ve["Arabic Presentation Forms-A"](i)||Ve["Arabic Presentation Forms-B"](i))}function Ju(i){return!(i!==746&&i!==747&&(i<4352||!(Ve["Bopomofo Extended"](i)||Ve.Bopomofo(i)||Ve["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||Ve["CJK Compatibility Ideographs"](i)||Ve["CJK Compatibility"](i)||Ve["CJK Radicals Supplement"](i)||Ve["CJK Strokes"](i)||!(!Ve["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||Ve["CJK Unified Ideographs Extension A"](i)||Ve["CJK Unified Ideographs"](i)||Ve["Enclosed CJK Letters and Months"](i)||Ve["Hangul Compatibility Jamo"](i)||Ve["Hangul Jamo Extended-A"](i)||Ve["Hangul Jamo Extended-B"](i)||Ve["Hangul Jamo"](i)||Ve["Hangul Syllables"](i)||Ve.Hiragana(i)||Ve["Ideographic Description Characters"](i)||Ve.Kanbun(i)||Ve["Kangxi Radicals"](i)||Ve["Katakana Phonetic Extensions"](i)||Ve.Katakana(i)&&i!==12540||!(!Ve["Halfwidth and Fullwidth Forms"](i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!Ve["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||Ve["Unified Canadian Aboriginal Syllabics"](i)||Ve["Unified Canadian Aboriginal Syllabics Extended"](i)||Ve["Vertical Forms"](i)||Ve["Yijing Hexagram Symbols"](i)||Ve["Yi Syllables"](i)||Ve["Yi Radicals"](i))))}function lp(i){return!(Ju(i)||function(t){return!!(Ve["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||Ve["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||Ve["Letterlike Symbols"](t)||Ve["Number Forms"](t)||Ve["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||Ve["Control Pictures"](t)&&t!==9251||Ve["Optical Character Recognition"](t)||Ve["Enclosed Alphanumerics"](t)||Ve["Geometric Shapes"](t)||Ve["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Ve["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Ve["CJK Symbols and Punctuation"](t)||Ve.Katakana(t)||Ve["Private Use Area"](t)||Ve["CJK Compatibility Forms"](t)||Ve["Small Form Variants"](t)||Ve["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(i))}function Vo(i){return i>=1424&&i<=2303||Ve["Arabic Presentation Forms-A"](i)||Ve["Arabic Presentation Forms-B"](i)}function cp(i,t){return!(!t&&Vo(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||Ve.Khmer(i))}function Qu(i){for(const t of i)if(Vo(t.charCodeAt(0)))return!0;return!1}const qo=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(i){this.pluginStatus=i.pluginStatus,this.pluginURL=i.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(i){this.applyArabicShaping=i.applyArabicShaping,this.processBidirectionalText=i.processBidirectionalText,this.processStyledBidirectionalText=i.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class Qt{constructor(t,o){this.zoom=t,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.zoomHistory=o.zoomHistory,this.transition=o.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new sp,this.transition={})}isSupportedScript(t){return function(o,l){for(const h of o)if(!cp(h.charCodeAt(0),l))return!1;return!0}(t,qo.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,o=t-Math.floor(t),l=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:o+(1-o)*l}:{fromScale:.5,toScale:1,t:1-(1-l)*o}}}class ic{constructor(t,o){this.property=t,this.value=o,this.expression=function(l,h){if(Gs(l))return new _s(l,h);if(Kl(l)){const m=Ka(l,h);if(m.result==="error")throw new Error(m.value.map(_=>`${_.key}: ${_.message}`).join(", "));return m.value}{let m=l;return h.type==="color"&&typeof l=="string"?m=Vt.parse(l):h.type!=="padding"||typeof l!="number"&&!Array.isArray(l)?h.type==="variableAnchorOffsetCollection"&&Array.isArray(l)&&(m=Un.parse(l)):m=$n.parse(l),{kind:"constant",evaluate:()=>m}}}(o===void 0?t.specification.default:o,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,o,l){return this.property.possiblyEvaluate(this,t,o,l)}}class Js{constructor(t){this.property=t,this.value=new ic(t,void 0)}transitioned(t,o){return new up(this.property,this.value,o,Ae({},t.transition,this.transition),t.now)}untransitioned(){return new up(this.property,this.value,null,{},0)}}class Qs{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return st(this._values[t].value.value)}setValue(t,o){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Js(this._values[t].property)),this._values[t].value=new ic(this._values[t].property,o===null?void 0:st(o))}getTransition(t){return st(this._values[t].transition)}setTransition(t,o){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Js(this._values[t].property)),this._values[t].transition=st(o)||void 0}serialize(){const t={};for(const o of Object.keys(this._values)){const l=this.getValue(o);l!==void 0&&(t[o]=l);const h=this.getTransition(o);h!==void 0&&(t[`${o}-transition`]=h)}return t}transitioned(t,o){const l=new eh(this._properties);for(const h of Object.keys(this._values))l._values[h]=this._values[h].transitioned(t,o._values[h]);return l}untransitioned(){const t=new eh(this._properties);for(const o of Object.keys(this._values))t._values[o]=this._values[o].untransitioned();return t}}class up{constructor(t,o,l,h,m){this.property=t,this.value=o,this.begin=m+h.delay||0,this.end=this.begin+h.duration||0,t.specification.transition&&(h.delay||h.duration)&&(this.prior=l)}possiblyEvaluate(t,o,l){const h=t.now||0,m=this.value.possiblyEvaluate(t,o,l),_=this.prior;if(_){if(h>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(h<this.begin)return _.possiblyEvaluate(t,o,l);{const b=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(_.possiblyEvaluate(t,o,l),m,function(S){if(S<=0)return 0;if(S>=1)return 1;const I=S*S,E=I*S;return 4*(S<.5?E:3*(S-I)+E-.75)}(b))}}return m}}class eh{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,o,l){const h=new oc(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(t,o,l);return h}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class tl{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return this._values[t].value!==void 0}getValue(t){return st(this._values[t].value)}setValue(t,o){this._values[t]=new ic(this._values[t].property,o===null?void 0:st(o))}serialize(){const t={};for(const o of Object.keys(this._values)){const l=this.getValue(o);l!==void 0&&(t[o]=l)}return t}possiblyEvaluate(t,o,l){const h=new oc(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(t,o,l);return h}}class eo{constructor(t,o,l){this.property=t,this.value=o,this.parameters=l}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,o,l,h){return this.property.evaluate(this.value,this.parameters,t,o,l,h)}}class oc{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class tt{constructor(t){this.specification=t}possiblyEvaluate(t,o){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(o)}interpolate(t,o,l){const h=En[this.specification.type];return h?h(t,o,l):t}}class ct{constructor(t,o){this.specification=t,this.overrides=o}possiblyEvaluate(t,o,l,h){return new eo(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(o,null,{},l,h)}:t.expression,o)}interpolate(t,o,l){if(t.value.kind!=="constant"||o.value.kind!=="constant")return t;if(t.value.value===void 0||o.value.value===void 0)return new eo(this,{kind:"constant",value:void 0},t.parameters);const h=En[this.specification.type];if(h){const m=h(t.value.value,o.value.value,l);return new eo(this,{kind:"constant",value:m},t.parameters)}return t}evaluate(t,o,l,h,m,_){return t.kind==="constant"?t.value:t.evaluate(o,l,h,m,_)}}class g extends ct{possiblyEvaluate(t,o,l,h){if(t.value===void 0)return new eo(this,{kind:"constant",value:void 0},o);if(t.expression.kind==="constant"){const m=t.expression.evaluate(o,null,{},l,h),_=t.property.specification.type==="resolvedImage"&&typeof m!="string"?m.name:m,b=this._calculate(_,_,_,o);return new eo(this,{kind:"constant",value:b},o)}if(t.expression.kind==="camera"){const m=this._calculate(t.expression.evaluate({zoom:o.zoom-1}),t.expression.evaluate({zoom:o.zoom}),t.expression.evaluate({zoom:o.zoom+1}),o);return new eo(this,{kind:"constant",value:m},o)}return new eo(this,t.expression,o)}evaluate(t,o,l,h,m,_){if(t.kind==="source"){const b=t.evaluate(o,l,h,m,_);return this._calculate(b,b,b,o)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(o.zoom)-1},l,h),t.evaluate({zoom:Math.floor(o.zoom)},l,h),t.evaluate({zoom:Math.floor(o.zoom)+1},l,h),o):t.value}_calculate(t,o,l,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:t,to:o}:{from:l,to:o}}interpolate(t){return t}}class r{constructor(t){this.specification=t}possiblyEvaluate(t,o,l,h){if(t.value!==void 0){if(t.expression.kind==="constant"){const m=t.expression.evaluate(o,null,{},l,h);return this._calculate(m,m,m,o)}return this._calculate(t.expression.evaluate(new Qt(Math.floor(o.zoom-1),o)),t.expression.evaluate(new Qt(Math.floor(o.zoom),o)),t.expression.evaluate(new Qt(Math.floor(o.zoom+1),o)),o)}}_calculate(t,o,l,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:t,to:o}:{from:l,to:o}}interpolate(t){return t}}class a{constructor(t){this.specification=t}possiblyEvaluate(t,o,l,h){return!!t.expression.evaluate(o,null,{},l,h)}interpolate(){return!1}}class u{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const o in t){const l=t[o];l.specification.overridable&&this.overridableProperties.push(o);const h=this.defaultPropertyValues[o]=new ic(l,void 0),m=this.defaultTransitionablePropertyValues[o]=new Js(l);this.defaultTransitioningPropertyValues[o]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[o]=h.possiblyEvaluate({})}}}Xe("DataDrivenProperty",ct),Xe("DataConstantProperty",tt),Xe("CrossFadedDataDrivenProperty",g),Xe("CrossFadedProperty",r),Xe("ColorRampProperty",a);const p="-transition";class y extends Bo{constructor(t,o){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),o.layout&&(this._unevaluatedLayout=new tl(o.layout)),o.paint)){this._transitionablePaint=new Qs(o.paint);for(const l in t.paint)this.setPaintProperty(l,t.paint[l],{validate:!1});for(const l in t.layout)this.setLayoutProperty(l,t.layout[l],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new oc(o.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,o,l={}){o!=null&&this._validate(ip,`layers.${this.id}.layout.${t}`,t,o,l)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,o):this.visibility=o)}getPaintProperty(t){return t.endsWith(p)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,o,l={}){if(o!=null&&this._validate(np,`layers.${this.id}.paint.${t}`,t,o,l))return!1;if(t.endsWith(p))return this._transitionablePaint.setTransition(t.slice(0,-11),o||void 0),!1;{const h=this._transitionablePaint._values[t],m=h.property.specification["property-type"]==="cross-faded-data-driven",_=h.value.isDataDriven(),b=h.value;this._transitionablePaint.setValue(t,o),this._handleSpecialPaintPropertyUpdate(t);const S=this._transitionablePaint._values[t].value;return S.isDataDriven()||_||m||this._handleOverridablePaintPropertyUpdate(t,b,S)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,o,l){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,o){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,o)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),ot(t,(o,l)=>!(o===void 0||l==="layout"&&!Object.keys(o).length||l==="paint"&&!Object.keys(o).length))}_validate(t,o,l,h,m={}){return(!m||m.validate!==!1)&&Xu(this,t.call(Ja,{key:o,layerType:this.type,objectKey:l,value:h,styleSpec:be,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const o=this.paint.get(t);if(o instanceof eo&&wo(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}}const w={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class T{constructor(t,o){this._structArray=t,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class C{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,o){return t._trim(),o&&(t.isTransferred=!0,o.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const o=Object.create(this.prototype);return o.arrayBuffer=t.arrayBuffer,o.length=t.length,o.capacity=t.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function k(i,t=1){let o=0,l=0;return{members:i.map(h=>{const m=w[h.type].BYTES_PER_ELEMENT,_=o=M(o,Math.max(t,m)),b=h.components||1;return l=Math.max(l,m),o+=m*b,{name:h.name,type:h.type,components:b,offset:_}}),size:M(o,Math.max(l,t)),alignment:t}}function M(i,t){return Math.ceil(i/t)*t}class P extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o){const l=this.length;return this.resize(l+1),this.emplace(l,t,o)}emplace(t,o,l){const h=2*t;return this.int16[h+0]=o,this.int16[h+1]=l,t}}P.prototype.bytesPerElement=4,Xe("StructArrayLayout2i4",P);class O extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,l){const h=this.length;return this.resize(h+1),this.emplace(h,t,o,l)}emplace(t,o,l,h){const m=3*t;return this.int16[m+0]=o,this.int16[m+1]=l,this.int16[m+2]=h,t}}O.prototype.bytesPerElement=6,Xe("StructArrayLayout3i6",O);class V extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,l,h){const m=this.length;return this.resize(m+1),this.emplace(m,t,o,l,h)}emplace(t,o,l,h,m){const _=4*t;return this.int16[_+0]=o,this.int16[_+1]=l,this.int16[_+2]=h,this.int16[_+3]=m,t}}V.prototype.bytesPerElement=8,Xe("StructArrayLayout4i8",V);class H extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,l,h,m,_){const b=this.length;return this.resize(b+1),this.emplace(b,t,o,l,h,m,_)}emplace(t,o,l,h,m,_,b){const S=6*t;return this.int16[S+0]=o,this.int16[S+1]=l,this.int16[S+2]=h,this.int16[S+3]=m,this.int16[S+4]=_,this.int16[S+5]=b,t}}H.prototype.bytesPerElement=12,Xe("StructArrayLayout2i4i12",H);class J extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,l,h,m,_){const b=this.length;return this.resize(b+1),this.emplace(b,t,o,l,h,m,_)}emplace(t,o,l,h,m,_,b){const S=4*t,I=8*t;return this.int16[S+0]=o,this.int16[S+1]=l,this.uint8[I+4]=h,this.uint8[I+5]=m,this.uint8[I+6]=_,this.uint8[I+7]=b,t}}J.prototype.bytesPerElement=8,Xe("StructArrayLayout2i4ub8",J);class W extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o){const l=this.length;return this.resize(l+1),this.emplace(l,t,o)}emplace(t,o,l){const h=2*t;return this.float32[h+0]=o,this.float32[h+1]=l,t}}W.prototype.bytesPerElement=8,Xe("StructArrayLayout2f8",W);class te extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,l,h,m,_,b,S,I,E){const A=this.length;return this.resize(A+1),this.emplace(A,t,o,l,h,m,_,b,S,I,E)}emplace(t,o,l,h,m,_,b,S,I,E,A){const z=10*t;return this.uint16[z+0]=o,this.uint16[z+1]=l,this.uint16[z+2]=h,this.uint16[z+3]=m,this.uint16[z+4]=_,this.uint16[z+5]=b,this.uint16[z+6]=S,this.uint16[z+7]=I,this.uint16[z+8]=E,this.uint16[z+9]=A,t}}te.prototype.bytesPerElement=20,Xe("StructArrayLayout10ui20",te);class se extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,l,h,m,_,b,S,I,E,A,z){const D=this.length;return this.resize(D+1),this.emplace(D,t,o,l,h,m,_,b,S,I,E,A,z)}emplace(t,o,l,h,m,_,b,S,I,E,A,z,D){const N=12*t;return this.int16[N+0]=o,this.int16[N+1]=l,this.int16[N+2]=h,this.int16[N+3]=m,this.uint16[N+4]=_,this.uint16[N+5]=b,this.uint16[N+6]=S,this.uint16[N+7]=I,this.int16[N+8]=E,this.int16[N+9]=A,this.int16[N+10]=z,this.int16[N+11]=D,t}}se.prototype.bytesPerElement=24,Xe("StructArrayLayout4i4ui4i24",se);class X extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,l){const h=this.length;return this.resize(h+1),this.emplace(h,t,o,l)}emplace(t,o,l,h){const m=3*t;return this.float32[m+0]=o,this.float32[m+1]=l,this.float32[m+2]=h,t}}X.prototype.bytesPerElement=12,Xe("StructArrayLayout3f12",X);class ce extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.uint32[1*t+0]=o,t}}ce.prototype.bytesPerElement=4,Xe("StructArrayLayout1ul4",ce);class fe extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,l,h,m,_,b,S,I){const E=this.length;return this.resize(E+1),this.emplace(E,t,o,l,h,m,_,b,S,I)}emplace(t,o,l,h,m,_,b,S,I,E){const A=10*t,z=5*t;return this.int16[A+0]=o,this.int16[A+1]=l,this.int16[A+2]=h,this.int16[A+3]=m,this.int16[A+4]=_,this.int16[A+5]=b,this.uint32[z+3]=S,this.uint16[A+8]=I,this.uint16[A+9]=E,t}}fe.prototype.bytesPerElement=20,Xe("StructArrayLayout6i1ul2ui20",fe);class _e extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,l,h,m,_){const b=this.length;return this.resize(b+1),this.emplace(b,t,o,l,h,m,_)}emplace(t,o,l,h,m,_,b){const S=6*t;return this.int16[S+0]=o,this.int16[S+1]=l,this.int16[S+2]=h,this.int16[S+3]=m,this.int16[S+4]=_,this.int16[S+5]=b,t}}_e.prototype.bytesPerElement=12,Xe("StructArrayLayout2i2i2i12",_e);class Ce extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,l,h,m){const _=this.length;return this.resize(_+1),this.emplace(_,t,o,l,h,m)}emplace(t,o,l,h,m,_){const b=4*t,S=8*t;return this.float32[b+0]=o,this.float32[b+1]=l,this.float32[b+2]=h,this.int16[S+6]=m,this.int16[S+7]=_,t}}Ce.prototype.bytesPerElement=16,Xe("StructArrayLayout2f1f2i16",Ce);class Me extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,l,h,m,_){const b=this.length;return this.resize(b+1),this.emplace(b,t,o,l,h,m,_)}emplace(t,o,l,h,m,_,b){const S=16*t,I=4*t,E=8*t;return this.uint8[S+0]=o,this.uint8[S+1]=l,this.float32[I+1]=h,this.float32[I+2]=m,this.int16[E+6]=_,this.int16[E+7]=b,t}}Me.prototype.bytesPerElement=16,Xe("StructArrayLayout2ub2f2i16",Me);class He extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,l){const h=this.length;return this.resize(h+1),this.emplace(h,t,o,l)}emplace(t,o,l,h){const m=3*t;return this.uint16[m+0]=o,this.uint16[m+1]=l,this.uint16[m+2]=h,t}}He.prototype.bytesPerElement=6,Xe("StructArrayLayout3ui6",He);class We extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,l,h,m,_,b,S,I,E,A,z,D,N,q,G,Q){const de=this.length;return this.resize(de+1),this.emplace(de,t,o,l,h,m,_,b,S,I,E,A,z,D,N,q,G,Q)}emplace(t,o,l,h,m,_,b,S,I,E,A,z,D,N,q,G,Q,de){const ie=24*t,ue=12*t,ve=48*t;return this.int16[ie+0]=o,this.int16[ie+1]=l,this.uint16[ie+2]=h,this.uint16[ie+3]=m,this.uint32[ue+2]=_,this.uint32[ue+3]=b,this.uint32[ue+4]=S,this.uint16[ie+10]=I,this.uint16[ie+11]=E,this.uint16[ie+12]=A,this.float32[ue+7]=z,this.float32[ue+8]=D,this.uint8[ve+36]=N,this.uint8[ve+37]=q,this.uint8[ve+38]=G,this.uint32[ue+10]=Q,this.int16[ie+22]=de,t}}We.prototype.bytesPerElement=48,Xe("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",We);class ze extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,l,h,m,_,b,S,I,E,A,z,D,N,q,G,Q,de,ie,ue,ve,ke,Ne,lt,Ue,Oe,et,Ye){const Ze=this.length;return this.resize(Ze+1),this.emplace(Ze,t,o,l,h,m,_,b,S,I,E,A,z,D,N,q,G,Q,de,ie,ue,ve,ke,Ne,lt,Ue,Oe,et,Ye)}emplace(t,o,l,h,m,_,b,S,I,E,A,z,D,N,q,G,Q,de,ie,ue,ve,ke,Ne,lt,Ue,Oe,et,Ye,Ze){const Te=32*t,rt=16*t;return this.int16[Te+0]=o,this.int16[Te+1]=l,this.int16[Te+2]=h,this.int16[Te+3]=m,this.int16[Te+4]=_,this.int16[Te+5]=b,this.int16[Te+6]=S,this.int16[Te+7]=I,this.uint16[Te+8]=E,this.uint16[Te+9]=A,this.uint16[Te+10]=z,this.uint16[Te+11]=D,this.uint16[Te+12]=N,this.uint16[Te+13]=q,this.uint16[Te+14]=G,this.uint16[Te+15]=Q,this.uint16[Te+16]=de,this.uint16[Te+17]=ie,this.uint16[Te+18]=ue,this.uint16[Te+19]=ve,this.uint16[Te+20]=ke,this.uint16[Te+21]=Ne,this.uint16[Te+22]=lt,this.uint32[rt+12]=Ue,this.float32[rt+13]=Oe,this.float32[rt+14]=et,this.uint16[Te+30]=Ye,this.uint16[Te+31]=Ze,t}}ze.prototype.bytesPerElement=64,Xe("StructArrayLayout8i15ui1ul2f2ui64",ze);class De extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.float32[1*t+0]=o,t}}De.prototype.bytesPerElement=4,Xe("StructArrayLayout1f4",De);class Je extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,l){const h=this.length;return this.resize(h+1),this.emplace(h,t,o,l)}emplace(t,o,l,h){const m=3*t;return this.uint16[6*t+0]=o,this.float32[m+1]=l,this.float32[m+2]=h,t}}Je.prototype.bytesPerElement=12,Xe("StructArrayLayout1ui2f12",Je);class _t extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,l){const h=this.length;return this.resize(h+1),this.emplace(h,t,o,l)}emplace(t,o,l,h){const m=4*t;return this.uint32[2*t+0]=o,this.uint16[m+2]=l,this.uint16[m+3]=h,t}}_t.prototype.bytesPerElement=8,Xe("StructArrayLayout1ul2ui8",_t);class Fe extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o){const l=this.length;return this.resize(l+1),this.emplace(l,t,o)}emplace(t,o,l){const h=2*t;return this.uint16[h+0]=o,this.uint16[h+1]=l,t}}Fe.prototype.bytesPerElement=4,Xe("StructArrayLayout2ui4",Fe);class $e extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.uint16[1*t+0]=o,t}}$e.prototype.bytesPerElement=2,Xe("StructArrayLayout1ui2",$e);class dt extends C{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,l,h){const m=this.length;return this.resize(m+1),this.emplace(m,t,o,l,h)}emplace(t,o,l,h,m){const _=4*t;return this.float32[_+0]=o,this.float32[_+1]=l,this.float32[_+2]=h,this.float32[_+3]=m,t}}dt.prototype.bytesPerElement=16,Xe("StructArrayLayout4f16",dt);class or extends T{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new j(this.anchorPointX,this.anchorPointY)}}or.prototype.size=20;class Tt extends fe{get(t){return new or(this,t)}}Xe("CollisionBoxArray",Tt);class kt extends T{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}kt.prototype.size=48;class sr extends We{get(t){return new kt(this,t)}}Xe("PlacedSymbolArray",sr);class dn extends T{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}dn.prototype.size=64;class Pi extends ze{get(t){return new dn(this,t)}}Xe("SymbolInstanceArray",Pi);class ar extends De{getoffsetX(t){return this.float32[1*t+0]}}Xe("GlyphOffsetArray",ar);class Vn extends O{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}Xe("SymbolLineVertexArray",Vn);class kn extends T{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}kn.prototype.size=12;class pn extends Je{get(t){return new kn(this,t)}}Xe("TextAnchorOffsetArray",pn);class fn extends T{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}fn.prototype.size=8;class Mi extends _t{get(t){return new fn(this,t)}}Xe("FeatureIndexArray",Mi);class bs extends P{}class sc extends P{}class ea extends P{}class ws extends H{}class ac extends J{}class th extends W{}class sn extends te{}class zi extends se{}class Ho extends X{}class ta extends ce{}class mn extends _e{}class gn extends Me{}class Jr extends He{}class pr extends Fe{}const ra=k([{name:"a_pos",components:2,type:"Int16"}],4),{members:rh}=ra;class Vr{constructor(t=[]){this.segments=t}prepareSegment(t,o,l,h){let m=this.segments[this.segments.length-1];return t>Vr.MAX_VERTEX_ARRAY_LENGTH&&Et(`Max vertices per segment is ${Vr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!m||m.vertexLength+t>Vr.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==h)&&(m={vertexOffset:o.length,primitiveOffset:l.length,vertexLength:0,primitiveLength:0},h!==void 0&&(m.sortKey=h),this.segments.push(m)),m}get(){return this.segments}destroy(){for(const t of this.segments)for(const o in t.vaos)t.vaos[o].destroy()}static simpleSegment(t,o,l,h){return new Vr([{vertexOffset:t,primitiveOffset:o,vertexLength:l,primitiveLength:h,vaos:{},sortKey:0}])}}function hp(i,t){return 256*(i=Ee(Math.floor(i),0,255))+Ee(Math.floor(t),0,255)}Vr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Xe("SegmentVector",Vr);const lc=k([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var cc={exports:{}},Wo={exports:{}};Wo.exports=function(i,t){var o,l,h,m,_,b,S,I;for(l=i.length-(o=3&i.length),h=t,_=3432918353,b=461845907,I=0;I<l;)S=255&i.charCodeAt(I)|(255&i.charCodeAt(++I))<<8|(255&i.charCodeAt(++I))<<16|(255&i.charCodeAt(++I))<<24,++I,h=27492+(65535&(m=5*(65535&(h=(h^=S=(65535&(S=(S=(65535&S)*_+(((S>>>16)*_&65535)<<16)&4294967295)<<15|S>>>17))*b+(((S>>>16)*b&65535)<<16)&4294967295)<<13|h>>>19))+((5*(h>>>16)&65535)<<16)&4294967295))+((58964+(m>>>16)&65535)<<16);switch(S=0,o){case 3:S^=(255&i.charCodeAt(I+2))<<16;case 2:S^=(255&i.charCodeAt(I+1))<<8;case 1:h^=S=(65535&(S=(S=(65535&(S^=255&i.charCodeAt(I)))*_+(((S>>>16)*_&65535)<<16)&4294967295)<<15|S>>>17))*b+(((S>>>16)*b&65535)<<16)&4294967295}return h^=i.length,h=2246822507*(65535&(h^=h>>>16))+((2246822507*(h>>>16)&65535)<<16)&4294967295,h=3266489909*(65535&(h^=h>>>13))+((3266489909*(h>>>16)&65535)<<16)&4294967295,(h^=h>>>16)>>>0};var dp=Wo.exports,nh={exports:{}};nh.exports=function(i,t){for(var o,l=i.length,h=t^l,m=0;l>=4;)o=1540483477*(65535&(o=255&i.charCodeAt(m)|(255&i.charCodeAt(++m))<<8|(255&i.charCodeAt(++m))<<16|(255&i.charCodeAt(++m))<<24))+((1540483477*(o>>>16)&65535)<<16),h=1540483477*(65535&h)+((1540483477*(h>>>16)&65535)<<16)^(o=1540483477*(65535&(o^=o>>>24))+((1540483477*(o>>>16)&65535)<<16)),l-=4,++m;switch(l){case 3:h^=(255&i.charCodeAt(m+2))<<16;case 2:h^=(255&i.charCodeAt(m+1))<<8;case 1:h=1540483477*(65535&(h^=255&i.charCodeAt(m)))+((1540483477*(h>>>16)&65535)<<16)}return h=1540483477*(65535&(h^=h>>>13))+((1540483477*(h>>>16)&65535)<<16),(h^=h>>>15)>>>0};var ih=dp,oh=nh.exports;cc.exports=ih,cc.exports.murmur3=ih,cc.exports.murmur2=oh;var uc=L(cc.exports);class na{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,o,l,h){this.ids.push(wv(t)),this.positions.push(o,l,h)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const o=wv(t);let l=0,h=this.ids.length-1;for(;l<h;){const _=l+h>>1;this.ids[_]>=o?h=_:l=_+1}const m=[];for(;this.ids[l]===o;)m.push({index:this.positions[3*l],start:this.positions[3*l+1],end:this.positions[3*l+2]}),l++;return m}static serialize(t,o){const l=new Float64Array(t.ids),h=new Uint32Array(t.positions);return _g(l,h,0,l.length-1),o&&o.push(l.buffer,h.buffer),{ids:l,positions:h}}static deserialize(t){const o=new na;return o.ids=t.ids,o.positions=t.positions,o.indexed=!0,o}}function wv(i){const t=+i;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:uc(String(i))}function _g(i,t,o,l){for(;o<l;){const h=i[o+l>>1];let m=o-1,_=l+1;for(;;){do m++;while(i[m]<h);do _--;while(i[_]>h);if(m>=_)break;pp(i,m,_),pp(t,3*m,3*_),pp(t,3*m+1,3*_+1),pp(t,3*m+2,3*_+2)}_-o<l-_?(_g(i,t,o,_),o=_+1):(_g(i,t,_+1,l),l=_)}}function pp(i,t,o){const l=i[t];i[t]=i[o],i[o]=l}Xe("FeaturePositionMap",na);class rl{constructor(t,o){this.gl=t.gl,this.location=o}}class fp extends rl{constructor(t,o){super(t,o),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class Sv extends rl{constructor(t,o){super(t,o),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class Tv extends rl{constructor(t,o){super(t,o),this.current=Vt.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const rC=new Float32Array(16);function vg(i){return[hp(255*i.r,255*i.g),hp(255*i.b,255*i.a)]}class sh{constructor(t,o,l){this.value=t,this.uniformNames=o.map(h=>`u_${h}`),this.type=l}setUniform(t,o,l){t.set(l.constantOr(this.value))}getBinding(t,o,l){return this.type==="color"?new Tv(t,o):new fp(t,o)}}class hc{constructor(t,o){this.uniformNames=o.map(l=>`u_${l}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,o){this.pixelRatioFrom=o.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=o.tlbr,this.patternTo=t.tlbr}setUniform(t,o,l,h){const m=h==="u_pattern_to"?this.patternTo:h==="u_pattern_from"?this.patternFrom:h==="u_pixel_ratio_to"?this.pixelRatioTo:h==="u_pixel_ratio_from"?this.pixelRatioFrom:null;m&&t.set(m)}getBinding(t,o,l){return l.substr(0,9)==="u_pattern"?new Sv(t,o):new fp(t,o)}}class Ss{constructor(t,o,l,h){this.expression=t,this.type=l,this.maxValue=0,this.paintVertexAttributes=o.map(m=>({name:`a_${m}`,type:"Float32",components:l==="color"?2:1,offset:0})),this.paintVertexArray=new h}populatePaintArray(t,o,l,h,m){const _=this.paintVertexArray.length,b=this.expression.evaluate(new Qt(0),o,{},h,[],m);this.paintVertexArray.resize(t),this._setPaintValue(_,t,b)}updatePaintArray(t,o,l,h){const m=this.expression.evaluate({zoom:0},l,h);this._setPaintValue(t,o,m)}_setPaintValue(t,o,l){if(this.type==="color"){const h=vg(l);for(let m=t;m<o;m++)this.paintVertexArray.emplace(m,h[0],h[1])}else{for(let h=t;h<o;h++)this.paintVertexArray.emplace(h,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Co{constructor(t,o,l,h,m,_){this.expression=t,this.uniformNames=o.map(b=>`u_${b}_t`),this.type=l,this.useIntegerZoom=h,this.zoom=m,this.maxValue=0,this.paintVertexAttributes=o.map(b=>({name:`a_${b}`,type:"Float32",components:l==="color"?4:2,offset:0})),this.paintVertexArray=new _}populatePaintArray(t,o,l,h,m){const _=this.expression.evaluate(new Qt(this.zoom),o,{},h,[],m),b=this.expression.evaluate(new Qt(this.zoom+1),o,{},h,[],m),S=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(S,t,_,b)}updatePaintArray(t,o,l,h){const m=this.expression.evaluate({zoom:this.zoom},l,h),_=this.expression.evaluate({zoom:this.zoom+1},l,h);this._setPaintValue(t,o,m,_)}_setPaintValue(t,o,l,h){if(this.type==="color"){const m=vg(l),_=vg(h);for(let b=t;b<o;b++)this.paintVertexArray.emplace(b,m[0],m[1],_[0],_[1])}else{for(let m=t;m<o;m++)this.paintVertexArray.emplace(m,l,h);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(h))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,o){const l=this.useIntegerZoom?Math.floor(o.zoom):o.zoom,h=Ee(this.expression.interpolationFactor(l,this.zoom,this.zoom+1),0,1);t.set(h)}getBinding(t,o,l){return new fp(t,o)}}class ia{constructor(t,o,l,h,m,_){this.expression=t,this.type=o,this.useIntegerZoom=l,this.zoom=h,this.layerId=_,this.zoomInPaintVertexArray=new m,this.zoomOutPaintVertexArray=new m}populatePaintArray(t,o,l){const h=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(h,t,o.patterns&&o.patterns[this.layerId],l)}updatePaintArray(t,o,l,h,m){this._setPaintValues(t,o,l.patterns&&l.patterns[this.layerId],m)}_setPaintValues(t,o,l,h){if(!h||!l)return;const{min:m,mid:_,max:b}=l,S=h[m],I=h[_],E=h[b];if(S&&I&&E)for(let A=t;A<o;A++)this.zoomInPaintVertexArray.emplace(A,I.tl[0],I.tl[1],I.br[0],I.br[1],S.tl[0],S.tl[1],S.br[0],S.br[1],I.pixelRatio,S.pixelRatio),this.zoomOutPaintVertexArray.emplace(A,I.tl[0],I.tl[1],I.br[0],I.br[1],E.tl[0],E.tl[1],E.br[0],E.br[1],I.pixelRatio,E.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,lc.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,lc.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Cv{constructor(t,o,l){this.binders={},this._buffers=[];const h=[];for(const m in t.paint._values){if(!l(m))continue;const _=t.paint.get(m);if(!(_ instanceof eo&&wo(_.property.specification)))continue;const b=nC(m,t.type),S=_.value,I=_.property.specification.type,E=_.property.useIntegerZoom,A=_.property.specification["property-type"],z=A==="cross-faded"||A==="cross-faded-data-driven";if(S.kind==="constant")this.binders[m]=z?new hc(S.value,b):new sh(S.value,b,I),h.push(`/u_${m}`);else if(S.kind==="source"||z){const D=Iv(m,I,"source");this.binders[m]=z?new ia(S,I,E,o,D,t.id):new Ss(S,b,I,D),h.push(`/a_${m}`)}else{const D=Iv(m,I,"composite");this.binders[m]=new Co(S,b,I,E,o,D),h.push(`/z_${m}`)}}this.cacheKey=h.sort().join("")}getMaxValue(t){const o=this.binders[t];return o instanceof Ss||o instanceof Co?o.maxValue:0}populatePaintArrays(t,o,l,h,m){for(const _ in this.binders){const b=this.binders[_];(b instanceof Ss||b instanceof Co||b instanceof ia)&&b.populatePaintArray(t,o,l,h,m)}}setConstantPatternPositions(t,o){for(const l in this.binders){const h=this.binders[l];h instanceof hc&&h.setConstantPatternPositions(t,o)}}updatePaintArrays(t,o,l,h,m){let _=!1;for(const b in t){const S=o.getPositions(b);for(const I of S){const E=l.feature(I.index);for(const A in this.binders){const z=this.binders[A];if((z instanceof Ss||z instanceof Co||z instanceof ia)&&z.expression.isStateDependent===!0){const D=h.paint.get(A);z.expression=D.value,z.updatePaintArray(I.start,I.end,E,t[b],m),_=!0}}}}return _}defines(){const t=[];for(const o in this.binders){const l=this.binders[o];(l instanceof sh||l instanceof hc)&&t.push(...l.uniformNames.map(h=>`#define HAS_UNIFORM_${h}`))}return t}getBinderAttributes(){const t=[];for(const o in this.binders){const l=this.binders[o];if(l instanceof Ss||l instanceof Co)for(let h=0;h<l.paintVertexAttributes.length;h++)t.push(l.paintVertexAttributes[h].name);else if(l instanceof ia)for(let h=0;h<lc.members.length;h++)t.push(lc.members[h].name)}return t}getBinderUniforms(){const t=[];for(const o in this.binders){const l=this.binders[o];if(l instanceof sh||l instanceof hc||l instanceof Co)for(const h of l.uniformNames)t.push(h)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,o){const l=[];for(const h in this.binders){const m=this.binders[h];if(m instanceof sh||m instanceof hc||m instanceof Co){for(const _ of m.uniformNames)if(o[_]){const b=m.getBinding(t,o[_],_);l.push({name:_,property:h,binding:b})}}}return l}setUniforms(t,o,l,h){for(const{name:m,property:_,binding:b}of o)this.binders[_].setUniform(b,h,l.get(_),m)}updatePaintBuffers(t){this._buffers=[];for(const o in this.binders){const l=this.binders[o];if(t&&l instanceof ia){const h=t.fromScale===2?l.zoomInPaintVertexBuffer:l.zoomOutPaintVertexBuffer;h&&this._buffers.push(h)}else(l instanceof Ss||l instanceof Co)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}}upload(t){for(const o in this.binders){const l=this.binders[o];(l instanceof Ss||l instanceof Co||l instanceof ia)&&l.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const o=this.binders[t];(o instanceof Ss||o instanceof Co||o instanceof ia)&&o.destroy()}}}class nl{constructor(t,o,l=()=>!0){this.programConfigurations={};for(const h of t)this.programConfigurations[h.id]=new Cv(h,o,l);this.needsUpload=!1,this._featureMap=new na,this._bufferOffset=0}populatePaintArrays(t,o,l,h,m,_){for(const b in this.programConfigurations)this.programConfigurations[b].populatePaintArrays(t,o,h,m,_);o.id!==void 0&&this._featureMap.add(o.id,l,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,o,l,h){for(const m of l)this.needsUpload=this.programConfigurations[m.id].updatePaintArrays(t,this._featureMap,o,m,h)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function nC(i,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[i]||[i.replace(`${t}-`,"").replace(/-/g,"_")]}function Iv(i,t,o){const l={color:{source:W,composite:dt},number:{source:De,composite:W}},h=function(m){return{"line-pattern":{source:sn,composite:sn},"fill-pattern":{source:sn,composite:sn},"fill-extrusion-pattern":{source:sn,composite:sn}}[m]}(i);return h&&h[o]||l[t][o]}Xe("ConstantBinder",sh),Xe("CrossFadedConstantBinder",hc),Xe("SourceExpressionBinder",Ss),Xe("CrossFadedCompositeBinder",ia),Xe("CompositeExpressionBinder",Co),Xe("ProgramConfiguration",Cv,{omit:["_buffers"]}),Xe("ProgramConfigurationSet",nl);const Fr=8192,xg=Math.pow(2,14)-1,Ev=-xg-1;function il(i){const t=Fr/i.extent,o=i.loadGeometry();for(let l=0;l<o.length;l++){const h=o[l];for(let m=0;m<h.length;m++){const _=h[m],b=Math.round(_.x*t),S=Math.round(_.y*t);_.x=Ee(b,Ev,xg),_.y=Ee(S,Ev,xg),(b<_.x||b>_.x+1||S<_.y||S>_.y+1)&&Et("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return o}function ol(i,t){return{type:i.type,id:i.id,properties:i.properties,geometry:t?il(i):[]}}function mp(i,t,o,l,h){i.emplaceBack(2*t+(l+1)/2,2*o+(h+1)/2)}class bg{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new sc,this.indexArray=new Jr,this.segments=new Vr,this.programConfigurations=new nl(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(t,o,l){const h=this.layers[0],m=[];let _=null,b=!1;h.type==="circle"&&(_=h.layout.get("circle-sort-key"),b=!_.isConstant());for(const{feature:S,id:I,index:E,sourceLayerIndex:A}of t){const z=this.layers[0]._featureFilter.needGeometry,D=ol(S,z);if(!this.layers[0]._featureFilter.filter(new Qt(this.zoom),D,l))continue;const N=b?_.evaluate(D,{},l):void 0,q={id:I,properties:S.properties,type:S.type,sourceLayerIndex:A,index:E,geometry:z?D.geometry:il(S),patterns:{},sortKey:N};m.push(q)}b&&m.sort((S,I)=>S.sortKey-I.sortKey);for(const S of m){const{geometry:I,index:E,sourceLayerIndex:A}=S,z=t[E].feature;this.addFeature(S,I,E,l),o.featureIndex.insert(z,I,E,A,this.index)}}update(t,o,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,o,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,rh),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,o,l,h){for(const m of o)for(const _ of m){const b=_.x,S=_.y;if(b<0||b>=Fr||S<0||S>=Fr)continue;const I=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),E=I.vertexLength;mp(this.layoutVertexArray,b,S,-1,-1),mp(this.layoutVertexArray,b,S,1,-1),mp(this.layoutVertexArray,b,S,1,1),mp(this.layoutVertexArray,b,S,-1,1),this.indexArray.emplaceBack(E,E+1,E+2),this.indexArray.emplaceBack(E,E+3,E+2),I.vertexLength+=4,I.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,{},h)}}function kv(i,t){for(let o=0;o<i.length;o++)if(dc(t,i[o]))return!0;for(let o=0;o<t.length;o++)if(dc(i,t[o]))return!0;return!!wg(i,t)}function iC(i,t,o){return!!dc(i,t)||!!Sg(t,i,o)}function Av(i,t){if(i.length===1)return Mv(t,i[0]);for(let o=0;o<t.length;o++){const l=t[o];for(let h=0;h<l.length;h++)if(dc(i,l[h]))return!0}for(let o=0;o<i.length;o++)if(Mv(t,i[o]))return!0;for(let o=0;o<t.length;o++)if(wg(i,t[o]))return!0;return!1}function oC(i,t,o){if(i.length>1){if(wg(i,t))return!0;for(let l=0;l<t.length;l++)if(Sg(t[l],i,o))return!0}for(let l=0;l<i.length;l++)if(Sg(i[l],t,o))return!0;return!1}function wg(i,t){if(i.length===0||t.length===0)return!1;for(let o=0;o<i.length-1;o++){const l=i[o],h=i[o+1];for(let m=0;m<t.length-1;m++)if(sC(l,h,t[m],t[m+1]))return!0}return!1}function sC(i,t,o,l){return zt(i,o,l)!==zt(t,o,l)&&zt(i,t,o)!==zt(i,t,l)}function Sg(i,t,o){const l=o*o;if(t.length===1)return i.distSqr(t[0])<l;for(let h=1;h<t.length;h++)if(Pv(i,t[h-1],t[h])<l)return!0;return!1}function Pv(i,t,o){const l=t.distSqr(o);if(l===0)return i.distSqr(t);const h=((i.x-t.x)*(o.x-t.x)+(i.y-t.y)*(o.y-t.y))/l;return i.distSqr(h<0?t:h>1?o:o.sub(t)._mult(h)._add(t))}function Mv(i,t){let o,l,h,m=!1;for(let _=0;_<i.length;_++){o=i[_];for(let b=0,S=o.length-1;b<o.length;S=b++)l=o[b],h=o[S],l.y>t.y!=h.y>t.y&&t.x<(h.x-l.x)*(t.y-l.y)/(h.y-l.y)+l.x&&(m=!m)}return m}function dc(i,t){let o=!1;for(let l=0,h=i.length-1;l<i.length;h=l++){const m=i[l],_=i[h];m.y>t.y!=_.y>t.y&&t.x<(_.x-m.x)*(t.y-m.y)/(_.y-m.y)+m.x&&(o=!o)}return o}function aC(i,t,o){const l=o[0],h=o[2];if(i.x<l.x&&t.x<l.x||i.x>h.x&&t.x>h.x||i.y<l.y&&t.y<l.y||i.y>h.y&&t.y>h.y)return!1;const m=zt(i,t,o[0]);return m!==zt(i,t,o[1])||m!==zt(i,t,o[2])||m!==zt(i,t,o[3])}function ah(i,t,o){const l=t.paint.get(i).value;return l.kind==="constant"?l.value:o.programConfigurations.get(t.id).getMaxValue(i)}function gp(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function yp(i,t,o,l,h){if(!t[0]&&!t[1])return i;const m=j.convert(t)._mult(h);o==="viewport"&&m._rotate(-l);const _=[];for(let b=0;b<i.length;b++)_.push(i[b].sub(m));return _}let zv,Lv;Xe("CircleBucket",bg,{omit:["layers"]});var lC={get paint(){return Lv=Lv||new u({"circle-radius":new ct(be.paint_circle["circle-radius"]),"circle-color":new ct(be.paint_circle["circle-color"]),"circle-blur":new ct(be.paint_circle["circle-blur"]),"circle-opacity":new ct(be.paint_circle["circle-opacity"]),"circle-translate":new tt(be.paint_circle["circle-translate"]),"circle-translate-anchor":new tt(be.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new tt(be.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new tt(be.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ct(be.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ct(be.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ct(be.paint_circle["circle-stroke-opacity"])})},get layout(){return zv=zv||new u({"circle-sort-key":new ct(be.layout_circle["circle-sort-key"])})}},qn=1e-6,pc=typeof Float32Array<"u"?Float32Array:Array;function Tg(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function Rv(i,t,o){var l=t[0],h=t[1],m=t[2],_=t[3],b=t[4],S=t[5],I=t[6],E=t[7],A=t[8],z=t[9],D=t[10],N=t[11],q=t[12],G=t[13],Q=t[14],de=t[15],ie=o[0],ue=o[1],ve=o[2],ke=o[3];return i[0]=ie*l+ue*b+ve*A+ke*q,i[1]=ie*h+ue*S+ve*z+ke*G,i[2]=ie*m+ue*I+ve*D+ke*Q,i[3]=ie*_+ue*E+ve*N+ke*de,i[4]=(ie=o[4])*l+(ue=o[5])*b+(ve=o[6])*A+(ke=o[7])*q,i[5]=ie*h+ue*S+ve*z+ke*G,i[6]=ie*m+ue*I+ve*D+ke*Q,i[7]=ie*_+ue*E+ve*N+ke*de,i[8]=(ie=o[8])*l+(ue=o[9])*b+(ve=o[10])*A+(ke=o[11])*q,i[9]=ie*h+ue*S+ve*z+ke*G,i[10]=ie*m+ue*I+ve*D+ke*Q,i[11]=ie*_+ue*E+ve*N+ke*de,i[12]=(ie=o[12])*l+(ue=o[13])*b+(ve=o[14])*A+(ke=o[15])*q,i[13]=ie*h+ue*S+ve*z+ke*G,i[14]=ie*m+ue*I+ve*D+ke*Q,i[15]=ie*_+ue*E+ve*N+ke*de,i}Math.hypot||(Math.hypot=function(){for(var i=0,t=arguments.length;t--;)i+=arguments[t]*arguments[t];return Math.sqrt(i)});var lh,cC=Rv;function _p(i,t,o){var l=t[0],h=t[1],m=t[2],_=t[3];return i[0]=o[0]*l+o[4]*h+o[8]*m+o[12]*_,i[1]=o[1]*l+o[5]*h+o[9]*m+o[13]*_,i[2]=o[2]*l+o[6]*h+o[10]*m+o[14]*_,i[3]=o[3]*l+o[7]*h+o[11]*m+o[15]*_,i}lh=new pc(4),pc!=Float32Array&&(lh[0]=0,lh[1]=0,lh[2]=0,lh[3]=0);class uC extends y{constructor(t){super(t,lC)}createBucket(t){return new bg(t)}queryRadius(t){const o=t;return ah("circle-radius",this,o)+ah("circle-stroke-width",this,o)+gp(this.paint.get("circle-translate"))}queryIntersectsFeature(t,o,l,h,m,_,b,S){const I=yp(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),_.angle,b),E=this.paint.get("circle-radius").evaluate(o,l)+this.paint.get("circle-stroke-width").evaluate(o,l),A=this.paint.get("circle-pitch-alignment")==="map",z=A?I:function(N,q){return N.map(G=>Dv(G,q))}(I,S),D=A?E*b:E;for(const N of h)for(const q of N){const G=A?q:Dv(q,S);let Q=D;const de=_p([],[q.x,q.y,0,1],S);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Q*=de[3]/_.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Q*=_.cameraToCenterDistance/de[3]),iC(z,G,Q))return!0}return!1}}function Dv(i,t){const o=_p([],[i.x,i.y,0,1],t);return new j(o[0]/o[3],o[1]/o[3])}class Bv extends bg{}let Fv;Xe("HeatmapBucket",Bv,{omit:["layers"]});var hC={get paint(){return Fv=Fv||new u({"heatmap-radius":new ct(be.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ct(be.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new tt(be.paint_heatmap["heatmap-intensity"]),"heatmap-color":new a(be.paint_heatmap["heatmap-color"]),"heatmap-opacity":new tt(be.paint_heatmap["heatmap-opacity"])})}};function Cg(i,{width:t,height:o},l,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==t*o*l)throw new RangeError(`mismatched image size. expected: ${h.length} but got: ${t*o*l}`)}else h=new Uint8Array(t*o*l);return i.width=t,i.height=o,i.data=h,i}function Ov(i,{width:t,height:o},l){if(t===i.width&&o===i.height)return;const h=Cg({},{width:t,height:o},l);Ig(i,h,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,t),height:Math.min(i.height,o)},l),i.width=t,i.height=o,i.data=h.data}function Ig(i,t,o,l,h,m){if(h.width===0||h.height===0)return t;if(h.width>i.width||h.height>i.height||o.x>i.width-h.width||o.y>i.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>t.width||h.height>t.height||l.x>t.width-h.width||l.y>t.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const _=i.data,b=t.data;if(_===b)throw new Error("srcData equals dstData, so image is already copied");for(let S=0;S<h.height;S++){const I=((o.y+S)*i.width+o.x)*m,E=((l.y+S)*t.width+l.x)*m;for(let A=0;A<h.width*m;A++)b[E+A]=_[I+A]}return t}class ch{constructor(t,o){Cg(this,t,1,o)}resize(t){Ov(this,t,1)}clone(){return new ch({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,o,l,h,m){Ig(t,o,l,h,m,1)}}class Li{constructor(t,o){Cg(this,t,4,o)}resize(t){Ov(this,t,4)}replace(t,o){o?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Li({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,o,l,h,m){Ig(t,o,l,h,m,4)}}function Nv(i){const t={},o=i.resolution||256,l=i.clips?i.clips.length:1,h=i.image||new Li({width:o,height:l});if(Math.log(o)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${o}`);const m=(_,b,S)=>{t[i.evaluationKey]=S;const I=i.expression.evaluate(t);h.data[_+b+0]=Math.floor(255*I.r/I.a),h.data[_+b+1]=Math.floor(255*I.g/I.a),h.data[_+b+2]=Math.floor(255*I.b/I.a),h.data[_+b+3]=Math.floor(255*I.a)};if(i.clips)for(let _=0,b=0;_<l;++_,b+=4*o)for(let S=0,I=0;S<o;S++,I+=4){const E=S/(o-1),{start:A,end:z}=i.clips[_];m(b,I,A*(1-E)+z*E)}else for(let _=0,b=0;_<o;_++,b+=4)m(0,b,_/(o-1));return h}Xe("AlphaImage",ch),Xe("RGBAImage",Li);class dC extends y{createBucket(t){return new Bv(t)}constructor(t){super(t,hC),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Nv({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let $v;var pC={get paint(){return $v=$v||new u({"hillshade-illumination-direction":new tt(be.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new tt(be.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new tt(be.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new tt(be.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new tt(be.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new tt(be.paint_hillshade["hillshade-accent-color"])})}};class fC extends y{constructor(t){super(t,pC)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const mC=k([{name:"a_pos",components:2,type:"Int16"}],4),{members:gC}=mC;var Eg={exports:{}};function vp(i,t,o){o=o||2;var l,h,m,_,b,S,I,E=t&&t.length,A=E?t[0]*o:i.length,z=Uv(i,0,A,o,!0),D=[];if(!z||z.next===z.prev)return D;if(E&&(z=function(q,G,Q,de){var ie,ue,ve,ke=[];for(ie=0,ue=G.length;ie<ue;ie++)(ve=Uv(q,G[ie]*de,ie<ue-1?G[ie+1]*de:q.length,de,!1))===ve.next&&(ve.steiner=!0),ke.push(TC(ve));for(ke.sort(bC),ie=0;ie<ke.length;ie++)Q=wC(ke[ie],Q);return Q}(i,t,z,o)),i.length>80*o){l=m=i[0],h=_=i[1];for(var N=o;N<A;N+=o)(b=i[N])<l&&(l=b),(S=i[N+1])<h&&(h=S),b>m&&(m=b),S>_&&(_=S);I=(I=Math.max(m-l,_-h))!==0?32767/I:0}return uh(z,D,o,l,h,I,0),D}function Uv(i,t,o,l,h){var m,_;if(h===Pg(i,t,o,l)>0)for(m=t;m<o;m+=l)_=qv(m,i[m],i[m+1],_);else for(m=o-l;m>=t;m-=l)_=qv(m,i[m],i[m+1],_);return _&&xp(_,_.next)&&(dh(_),_=_.next),_}function sl(i,t){if(!i)return i;t||(t=i);var o,l=i;do if(o=!1,l.steiner||!xp(l,l.next)&&Pr(l.prev,l,l.next)!==0)l=l.next;else{if(dh(l),(l=t=l.prev)===l.next)break;o=!0}while(o||l!==t);return t}function uh(i,t,o,l,h,m,_){if(i){!_&&m&&function(E,A,z,D){var N=E;do N.z===0&&(N.z=kg(N.x,N.y,A,z,D)),N.prevZ=N.prev,N.nextZ=N.next,N=N.next;while(N!==E);N.prevZ.nextZ=null,N.prevZ=null,function(q){var G,Q,de,ie,ue,ve,ke,Ne,lt=1;do{for(Q=q,q=null,ue=null,ve=0;Q;){for(ve++,de=Q,ke=0,G=0;G<lt&&(ke++,de=de.nextZ);G++);for(Ne=lt;ke>0||Ne>0&&de;)ke!==0&&(Ne===0||!de||Q.z<=de.z)?(ie=Q,Q=Q.nextZ,ke--):(ie=de,de=de.nextZ,Ne--),ue?ue.nextZ=ie:q=ie,ie.prevZ=ue,ue=ie;Q=de}ue.nextZ=null,lt*=2}while(ve>1)}(N)}(i,l,h,m);for(var b,S,I=i;i.prev!==i.next;)if(b=i.prev,S=i.next,m?_C(i,l,h,m):yC(i))t.push(b.i/o|0),t.push(i.i/o|0),t.push(S.i/o|0),dh(i),i=S.next,I=S.next;else if((i=S)===I){_?_===1?uh(i=vC(sl(i),t,o),t,o,l,h,m,2):_===2&&xC(i,t,o,l,h,m):uh(sl(i),t,o,l,h,m,1);break}}}function yC(i){var t=i.prev,o=i,l=i.next;if(Pr(t,o,l)>=0)return!1;for(var h=t.x,m=o.x,_=l.x,b=t.y,S=o.y,I=l.y,E=h<m?h<_?h:_:m<_?m:_,A=b<S?b<I?b:I:S<I?S:I,z=h>m?h>_?h:_:m>_?m:_,D=b>S?b>I?b:I:S>I?S:I,N=l.next;N!==t;){if(N.x>=E&&N.x<=z&&N.y>=A&&N.y<=D&&fc(h,b,m,S,_,I,N.x,N.y)&&Pr(N.prev,N,N.next)>=0)return!1;N=N.next}return!0}function _C(i,t,o,l){var h=i.prev,m=i,_=i.next;if(Pr(h,m,_)>=0)return!1;for(var b=h.x,S=m.x,I=_.x,E=h.y,A=m.y,z=_.y,D=b<S?b<I?b:I:S<I?S:I,N=E<A?E<z?E:z:A<z?A:z,q=b>S?b>I?b:I:S>I?S:I,G=E>A?E>z?E:z:A>z?A:z,Q=kg(D,N,t,o,l),de=kg(q,G,t,o,l),ie=i.prevZ,ue=i.nextZ;ie&&ie.z>=Q&&ue&&ue.z<=de;){if(ie.x>=D&&ie.x<=q&&ie.y>=N&&ie.y<=G&&ie!==h&&ie!==_&&fc(b,E,S,A,I,z,ie.x,ie.y)&&Pr(ie.prev,ie,ie.next)>=0||(ie=ie.prevZ,ue.x>=D&&ue.x<=q&&ue.y>=N&&ue.y<=G&&ue!==h&&ue!==_&&fc(b,E,S,A,I,z,ue.x,ue.y)&&Pr(ue.prev,ue,ue.next)>=0))return!1;ue=ue.nextZ}for(;ie&&ie.z>=Q;){if(ie.x>=D&&ie.x<=q&&ie.y>=N&&ie.y<=G&&ie!==h&&ie!==_&&fc(b,E,S,A,I,z,ie.x,ie.y)&&Pr(ie.prev,ie,ie.next)>=0)return!1;ie=ie.prevZ}for(;ue&&ue.z<=de;){if(ue.x>=D&&ue.x<=q&&ue.y>=N&&ue.y<=G&&ue!==h&&ue!==_&&fc(b,E,S,A,I,z,ue.x,ue.y)&&Pr(ue.prev,ue,ue.next)>=0)return!1;ue=ue.nextZ}return!0}function vC(i,t,o){var l=i;do{var h=l.prev,m=l.next.next;!xp(h,m)&&jv(h,l,l.next,m)&&hh(h,m)&&hh(m,h)&&(t.push(h.i/o|0),t.push(l.i/o|0),t.push(m.i/o|0),dh(l),dh(l.next),l=i=m),l=l.next}while(l!==i);return sl(l)}function xC(i,t,o,l,h,m){var _=i;do{for(var b=_.next.next;b!==_.prev;){if(_.i!==b.i&&CC(_,b)){var S=Vv(_,b);return _=sl(_,_.next),S=sl(S,S.next),uh(_,t,o,l,h,m,0),void uh(S,t,o,l,h,m,0)}b=b.next}_=_.next}while(_!==i)}function bC(i,t){return i.x-t.x}function wC(i,t){var o=function(h,m){var _,b=m,S=h.x,I=h.y,E=-1/0;do{if(I<=b.y&&I>=b.next.y&&b.next.y!==b.y){var A=b.x+(I-b.y)*(b.next.x-b.x)/(b.next.y-b.y);if(A<=S&&A>E&&(E=A,_=b.x<b.next.x?b:b.next,A===S))return _}b=b.next}while(b!==m);if(!_)return null;var z,D=_,N=_.x,q=_.y,G=1/0;b=_;do S>=b.x&&b.x>=N&&S!==b.x&&fc(I<q?S:E,I,N,q,I<q?E:S,I,b.x,b.y)&&(z=Math.abs(I-b.y)/(S-b.x),hh(b,h)&&(z<G||z===G&&(b.x>_.x||b.x===_.x&&SC(_,b)))&&(_=b,G=z)),b=b.next;while(b!==D);return _}(i,t);if(!o)return t;var l=Vv(o,i);return sl(l,l.next),sl(o,o.next)}function SC(i,t){return Pr(i.prev,i,t.prev)<0&&Pr(t.next,i,i.next)<0}function kg(i,t,o,l,h){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-o)*h|0)|i<<8))|i<<4))|i<<2))|i<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-l)*h|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function TC(i){var t=i,o=i;do(t.x<o.x||t.x===o.x&&t.y<o.y)&&(o=t),t=t.next;while(t!==i);return o}function fc(i,t,o,l,h,m,_,b){return(h-_)*(t-b)>=(i-_)*(m-b)&&(i-_)*(l-b)>=(o-_)*(t-b)&&(o-_)*(m-b)>=(h-_)*(l-b)}function CC(i,t){return i.next.i!==t.i&&i.prev.i!==t.i&&!function(o,l){var h=o;do{if(h.i!==o.i&&h.next.i!==o.i&&h.i!==l.i&&h.next.i!==l.i&&jv(h,h.next,o,l))return!0;h=h.next}while(h!==o);return!1}(i,t)&&(hh(i,t)&&hh(t,i)&&function(o,l){var h=o,m=!1,_=(o.x+l.x)/2,b=(o.y+l.y)/2;do h.y>b!=h.next.y>b&&h.next.y!==h.y&&_<(h.next.x-h.x)*(b-h.y)/(h.next.y-h.y)+h.x&&(m=!m),h=h.next;while(h!==o);return m}(i,t)&&(Pr(i.prev,i,t.prev)||Pr(i,t.prev,t))||xp(i,t)&&Pr(i.prev,i,i.next)>0&&Pr(t.prev,t,t.next)>0)}function Pr(i,t,o){return(t.y-i.y)*(o.x-t.x)-(t.x-i.x)*(o.y-t.y)}function xp(i,t){return i.x===t.x&&i.y===t.y}function jv(i,t,o,l){var h=wp(Pr(i,t,o)),m=wp(Pr(i,t,l)),_=wp(Pr(o,l,i)),b=wp(Pr(o,l,t));return h!==m&&_!==b||!(h!==0||!bp(i,o,t))||!(m!==0||!bp(i,l,t))||!(_!==0||!bp(o,i,l))||!(b!==0||!bp(o,t,l))}function bp(i,t,o){return t.x<=Math.max(i.x,o.x)&&t.x>=Math.min(i.x,o.x)&&t.y<=Math.max(i.y,o.y)&&t.y>=Math.min(i.y,o.y)}function wp(i){return i>0?1:i<0?-1:0}function hh(i,t){return Pr(i.prev,i,i.next)<0?Pr(i,t,i.next)>=0&&Pr(i,i.prev,t)>=0:Pr(i,t,i.prev)<0||Pr(i,i.next,t)<0}function Vv(i,t){var o=new Ag(i.i,i.x,i.y),l=new Ag(t.i,t.x,t.y),h=i.next,m=t.prev;return i.next=t,t.prev=i,o.next=h,h.prev=o,l.next=o,o.prev=l,m.next=l,l.prev=m,l}function qv(i,t,o,l){var h=new Ag(i,t,o);return l?(h.next=l.next,h.prev=l,l.next.prev=h,l.next=h):(h.prev=h,h.next=h),h}function dh(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function Ag(i,t,o){this.i=i,this.x=t,this.y=o,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Pg(i,t,o,l){for(var h=0,m=t,_=o-l;m<o;m+=l)h+=(i[_]-i[m])*(i[m+1]+i[_+1]),_=m;return h}Eg.exports=vp,Eg.exports.default=vp,vp.deviation=function(i,t,o,l){var h=t&&t.length,m=Math.abs(Pg(i,0,h?t[0]*o:i.length,o));if(h)for(var _=0,b=t.length;_<b;_++)m-=Math.abs(Pg(i,t[_]*o,_<b-1?t[_+1]*o:i.length,o));var S=0;for(_=0;_<l.length;_+=3){var I=l[_]*o,E=l[_+1]*o,A=l[_+2]*o;S+=Math.abs((i[I]-i[A])*(i[E+1]-i[I+1])-(i[I]-i[E])*(i[A+1]-i[I+1]))}return m===0&&S===0?0:Math.abs((S-m)/m)},vp.flatten=function(i){for(var t=i[0][0].length,o={vertices:[],holes:[],dimensions:t},l=0,h=0;h<i.length;h++){for(var m=0;m<i[h].length;m++)for(var _=0;_<t;_++)o.vertices.push(i[h][m][_]);h>0&&o.holes.push(l+=i[h-1].length)}return o};var Hv=L(Eg.exports);function Mg(i,t,o){const l=o.patternDependencies;let h=!1;for(const m of t){const _=m.paint.get(`${i}-pattern`);_.isConstant()||(h=!0);const b=_.constantOr(null);b&&(h=!0,l[b.to]=!0,l[b.from]=!0)}return h}function zg(i,t,o,l,h){const m=h.patternDependencies;for(const _ of t){const b=_.paint.get(`${i}-pattern`).value;if(b.kind!=="constant"){let S=b.evaluate({zoom:l-1},o,{},h.availableImages),I=b.evaluate({zoom:l},o,{},h.availableImages),E=b.evaluate({zoom:l+1},o,{},h.availableImages);S=S&&S.name?S.name:S,I=I&&I.name?I.name:I,E=E&&E.name?E.name:E,m[S]=!0,m[I]=!0,m[E]=!0,o.patterns[_.id]={min:S,mid:I,max:E}}}return o}class Lg{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ea,this.indexArray=new Jr,this.indexArray2=new pr,this.programConfigurations=new nl(t.layers,t.zoom),this.segments=new Vr,this.segments2=new Vr,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(t,o,l){this.hasPattern=Mg("fill",this.layers,o);const h=this.layers[0].layout.get("fill-sort-key"),m=!h.isConstant(),_=[];for(const{feature:b,id:S,index:I,sourceLayerIndex:E}of t){const A=this.layers[0]._featureFilter.needGeometry,z=ol(b,A);if(!this.layers[0]._featureFilter.filter(new Qt(this.zoom),z,l))continue;const D=m?h.evaluate(z,{},l,o.availableImages):void 0,N={id:S,properties:b.properties,type:b.type,sourceLayerIndex:E,index:I,geometry:A?z.geometry:il(b),patterns:{},sortKey:D};_.push(N)}m&&_.sort((b,S)=>b.sortKey-S.sortKey);for(const b of _){const{geometry:S,index:I,sourceLayerIndex:E}=b;if(this.hasPattern){const A=zg("fill",this.layers,b,this.zoom,o);this.patternFeatures.push(A)}else this.addFeature(b,S,I,l,{});o.featureIndex.insert(t[I].feature,S,I,E,this.index)}}update(t,o,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,o,this.stateDependentLayers,l)}addFeatures(t,o,l){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,o,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,gC),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,o,l,h,m){for(const _ of Ol(o,500)){let b=0;for(const D of _)b+=D.length;const S=this.segments.prepareSegment(b,this.layoutVertexArray,this.indexArray),I=S.vertexLength,E=[],A=[];for(const D of _){if(D.length===0)continue;D!==_[0]&&A.push(E.length/2);const N=this.segments2.prepareSegment(D.length,this.layoutVertexArray,this.indexArray2),q=N.vertexLength;this.layoutVertexArray.emplaceBack(D[0].x,D[0].y),this.indexArray2.emplaceBack(q+D.length-1,q),E.push(D[0].x),E.push(D[0].y);for(let G=1;G<D.length;G++)this.layoutVertexArray.emplaceBack(D[G].x,D[G].y),this.indexArray2.emplaceBack(q+G-1,q+G),E.push(D[G].x),E.push(D[G].y);N.vertexLength+=D.length,N.primitiveLength+=D.length}const z=Hv(E,A);for(let D=0;D<z.length;D+=3)this.indexArray.emplaceBack(I+z[D],I+z[D+1],I+z[D+2]);S.vertexLength+=b,S.primitiveLength+=z.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,m,h)}}let Wv,Gv;Xe("FillBucket",Lg,{omit:["layers","patternFeatures"]});var IC={get paint(){return Gv=Gv||new u({"fill-antialias":new tt(be.paint_fill["fill-antialias"]),"fill-opacity":new ct(be.paint_fill["fill-opacity"]),"fill-color":new ct(be.paint_fill["fill-color"]),"fill-outline-color":new ct(be.paint_fill["fill-outline-color"]),"fill-translate":new tt(be.paint_fill["fill-translate"]),"fill-translate-anchor":new tt(be.paint_fill["fill-translate-anchor"]),"fill-pattern":new g(be.paint_fill["fill-pattern"])})},get layout(){return Wv=Wv||new u({"fill-sort-key":new ct(be.layout_fill["fill-sort-key"])})}};class EC extends y{constructor(t){super(t,IC)}recalculate(t,o){super.recalculate(t,o);const l=this.paint._values["fill-outline-color"];l.value.kind==="constant"&&l.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new Lg(t)}queryRadius(){return gp(this.paint.get("fill-translate"))}queryIntersectsFeature(t,o,l,h,m,_,b){return Av(yp(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),_.angle,b),h)}isTileClipped(){return!0}}const kC=k([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),AC=k([{name:"a_centroid",components:2,type:"Int16"}],4),{members:PC}=kC;var oa={},MC=U,Zv=mc;function mc(i,t,o,l,h){this.properties={},this.extent=o,this.type=0,this._pbf=i,this._geometry=-1,this._keys=l,this._values=h,i.readFields(zC,this,t)}function zC(i,t,o){i==1?t.id=o.readVarint():i==2?function(l,h){for(var m=l.readVarint()+l.pos;l.pos<m;){var _=h._keys[l.readVarint()],b=h._values[l.readVarint()];h.properties[_]=b}}(o,t):i==3?t.type=o.readVarint():i==4&&(t._geometry=o.pos)}function LC(i){for(var t,o,l=0,h=0,m=i.length,_=m-1;h<m;_=h++)l+=((o=i[_]).x-(t=i[h]).x)*(t.y+o.y);return l}mc.types=["Unknown","Point","LineString","Polygon"],mc.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var t,o=i.readVarint()+i.pos,l=1,h=0,m=0,_=0,b=[];i.pos<o;){if(h<=0){var S=i.readVarint();l=7&S,h=S>>3}if(h--,l===1||l===2)m+=i.readSVarint(),_+=i.readSVarint(),l===1&&(t&&b.push(t),t=[]),t.push(new MC(m,_));else{if(l!==7)throw new Error("unknown command "+l);t&&t.push(t[0].clone())}}return t&&b.push(t),b},mc.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var t=i.readVarint()+i.pos,o=1,l=0,h=0,m=0,_=1/0,b=-1/0,S=1/0,I=-1/0;i.pos<t;){if(l<=0){var E=i.readVarint();o=7&E,l=E>>3}if(l--,o===1||o===2)(h+=i.readSVarint())<_&&(_=h),h>b&&(b=h),(m+=i.readSVarint())<S&&(S=m),m>I&&(I=m);else if(o!==7)throw new Error("unknown command "+o)}return[_,S,b,I]},mc.prototype.toGeoJSON=function(i,t,o){var l,h,m=this.extent*Math.pow(2,o),_=this.extent*i,b=this.extent*t,S=this.loadGeometry(),I=mc.types[this.type];function E(D){for(var N=0;N<D.length;N++){var q=D[N];D[N]=[360*(q.x+_)/m-180,360/Math.PI*Math.atan(Math.exp((180-360*(q.y+b)/m)*Math.PI/180))-90]}}switch(this.type){case 1:var A=[];for(l=0;l<S.length;l++)A[l]=S[l][0];E(S=A);break;case 2:for(l=0;l<S.length;l++)E(S[l]);break;case 3:for(S=function(D){var N=D.length;if(N<=1)return[D];for(var q,G,Q=[],de=0;de<N;de++){var ie=LC(D[de]);ie!==0&&(G===void 0&&(G=ie<0),G===ie<0?(q&&Q.push(q),q=[D[de]]):q.push(D[de]))}return q&&Q.push(q),Q}(S),l=0;l<S.length;l++)for(h=0;h<S[l].length;h++)E(S[l][h])}S.length===1?S=S[0]:I="Multi"+I;var z={type:"Feature",geometry:{type:I,coordinates:S},properties:this.properties};return"id"in this&&(z.id=this.id),z};var RC=Zv,Kv=Xv;function Xv(i,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(DC,this,t),this.length=this._features.length}function DC(i,t,o){i===15?t.version=o.readVarint():i===1?t.name=o.readString():i===5?t.extent=o.readVarint():i===2?t._features.push(o.pos):i===3?t._keys.push(o.readString()):i===4&&t._values.push(function(l){for(var h=null,m=l.readVarint()+l.pos;l.pos<m;){var _=l.readVarint()>>3;h=_===1?l.readString():_===2?l.readFloat():_===3?l.readDouble():_===4?l.readVarint64():_===5?l.readVarint():_===6?l.readSVarint():_===7?l.readBoolean():null}return h}(o))}Xv.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var t=this._pbf.readVarint()+this._pbf.pos;return new RC(this._pbf,t,this.extent,this._keys,this._values)};var BC=Kv;function FC(i,t,o){if(i===3){var l=new BC(o,o.readVarint()+o.pos);l.length&&(t[l.name]=l)}}oa.VectorTile=function(i,t){this.layers=i.readFields(FC,{},t)},oa.VectorTileFeature=Zv,oa.VectorTileLayer=Kv;const OC=oa.VectorTileFeature.types,Rg=Math.pow(2,13);function ph(i,t,o,l,h,m,_,b){i.emplaceBack(t,o,2*Math.floor(l*Rg)+_,h*Rg*2,m*Rg*2,Math.round(b))}class Dg{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new ws,this.centroidVertexArray=new bs,this.indexArray=new Jr,this.programConfigurations=new nl(t.layers,t.zoom),this.segments=new Vr,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(t,o,l){this.features=[],this.hasPattern=Mg("fill-extrusion",this.layers,o);for(const{feature:h,id:m,index:_,sourceLayerIndex:b}of t){const S=this.layers[0]._featureFilter.needGeometry,I=ol(h,S);if(!this.layers[0]._featureFilter.filter(new Qt(this.zoom),I,l))continue;const E={id:m,sourceLayerIndex:b,index:_,geometry:S?I.geometry:il(h),properties:h.properties,type:h.type,patterns:{}};this.hasPattern?this.features.push(zg("fill-extrusion",this.layers,E,this.zoom,o)):this.addFeature(E,E.geometry,_,l,{}),o.featureIndex.insert(h,E.geometry,_,b,this.index,!0)}}addFeatures(t,o,l){for(const h of this.features){const{geometry:m}=h;this.addFeature(h,m,h.index,o,l)}}update(t,o,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,o,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,PC),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,AC.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,o,l,h,m){for(const _ of Ol(o,500)){const b={x:0,y:0,vertexCount:0};let S=0;for(const N of _)S+=N.length;let I=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const N of _){if(N.length===0||$C(N))continue;let q=0;for(let G=0;G<N.length;G++){const Q=N[G];if(G>=1){const de=N[G-1];if(!NC(Q,de)){I.vertexLength+4>Vr.MAX_VERTEX_ARRAY_LENGTH&&(I=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const ie=Q.sub(de)._perp()._unit(),ue=de.dist(Q);q+ue>32768&&(q=0),ph(this.layoutVertexArray,Q.x,Q.y,ie.x,ie.y,0,0,q),ph(this.layoutVertexArray,Q.x,Q.y,ie.x,ie.y,0,1,q),b.x+=2*Q.x,b.y+=2*Q.y,b.vertexCount+=2,q+=ue,ph(this.layoutVertexArray,de.x,de.y,ie.x,ie.y,0,0,q),ph(this.layoutVertexArray,de.x,de.y,ie.x,ie.y,0,1,q),b.x+=2*de.x,b.y+=2*de.y,b.vertexCount+=2;const ve=I.vertexLength;this.indexArray.emplaceBack(ve,ve+2,ve+1),this.indexArray.emplaceBack(ve+1,ve+2,ve+3),I.vertexLength+=4,I.primitiveLength+=2}}}}if(I.vertexLength+S>Vr.MAX_VERTEX_ARRAY_LENGTH&&(I=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray)),OC[t.type]!=="Polygon")continue;const E=[],A=[],z=I.vertexLength;for(const N of _)if(N.length!==0){N!==_[0]&&A.push(E.length/2);for(let q=0;q<N.length;q++){const G=N[q];ph(this.layoutVertexArray,G.x,G.y,0,0,1,1,0),b.x+=G.x,b.y+=G.y,b.vertexCount+=1,E.push(G.x),E.push(G.y)}}const D=Hv(E,A);for(let N=0;N<D.length;N+=3)this.indexArray.emplaceBack(z+D[N],z+D[N+2],z+D[N+1]);I.primitiveLength+=D.length/3,I.vertexLength+=S;for(let N=0;N<b.vertexCount;N++){const q=Math.floor(b.x/b.vertexCount),G=Math.floor(b.y/b.vertexCount);this.centroidVertexArray.emplaceBack(q,G)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,m,h)}}function NC(i,t){return i.x===t.x&&(i.x<0||i.x>Fr)||i.y===t.y&&(i.y<0||i.y>Fr)}function $C(i){return i.every(t=>t.x<0)||i.every(t=>t.x>Fr)||i.every(t=>t.y<0)||i.every(t=>t.y>Fr)}let Yv;Xe("FillExtrusionBucket",Dg,{omit:["layers","features"]});var UC={get paint(){return Yv=Yv||new u({"fill-extrusion-opacity":new tt(be["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ct(be["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new tt(be["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new tt(be["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new g(be["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ct(be["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ct(be["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new tt(be["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class jC extends y{constructor(t){super(t,UC)}createBucket(t){return new Dg(t)}queryRadius(){return gp(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(t,o,l,h,m,_,b,S){const I=yp(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),_.angle,b),E=this.paint.get("fill-extrusion-height").evaluate(o,l),A=this.paint.get("fill-extrusion-base").evaluate(o,l),z=function(N,q,G,Q){const de=[];for(const ie of N){const ue=[ie.x,ie.y,0,1];_p(ue,ue,q),de.push(new j(ue[0]/ue[3],ue[1]/ue[3]))}return de}(I,S),D=function(N,q,G,Q){const de=[],ie=[],ue=Q[8]*q,ve=Q[9]*q,ke=Q[10]*q,Ne=Q[11]*q,lt=Q[8]*G,Ue=Q[9]*G,Oe=Q[10]*G,et=Q[11]*G;for(const Ye of N){const Ze=[],Te=[];for(const rt of Ye){const Qe=rt.x,ft=rt.y,Jt=Q[0]*Qe+Q[4]*ft+Q[12],Zt=Q[1]*Qe+Q[5]*ft+Q[13],Qr=Q[2]*Qe+Q[6]*ft+Q[14],to=Q[3]*Qe+Q[7]*ft+Q[15],_n=Qr+ke,Tr=to+Ne,Hn=Jt+lt,Wn=Zt+Ue,Gn=Qr+Oe,Cr=to+et,en=new j((Jt+ue)/Tr,(Zt+ve)/Tr);en.z=_n/Tr,Ze.push(en);const An=new j(Hn/Cr,Wn/Cr);An.z=Gn/Cr,Te.push(An)}de.push(Ze),ie.push(Te)}return[de,ie]}(h,A,E,S);return function(N,q,G){let Q=1/0;Av(G,q)&&(Q=Jv(G,q[0]));for(let de=0;de<q.length;de++){const ie=q[de],ue=N[de];for(let ve=0;ve<ie.length-1;ve++){const ke=ie[ve],Ne=[ke,ie[ve+1],ue[ve+1],ue[ve],ke];kv(G,Ne)&&(Q=Math.min(Q,Jv(G,Ne)))}}return Q!==1/0&&Q}(D[0],D[1],z)}}function fh(i,t){return i.x*t.x+i.y*t.y}function Jv(i,t){if(i.length===1){let o=0;const l=t[o++];let h;for(;!h||l.equals(h);)if(h=t[o++],!h)return 1/0;for(;o<t.length;o++){const m=t[o],_=i[0],b=h.sub(l),S=m.sub(l),I=_.sub(l),E=fh(b,b),A=fh(b,S),z=fh(S,S),D=fh(I,b),N=fh(I,S),q=E*z-A*A,G=(z*D-A*N)/q,Q=(E*N-A*D)/q,de=l.z*(1-G-Q)+h.z*G+m.z*Q;if(isFinite(de))return de}return 1/0}{let o=1/0;for(const l of t)o=Math.min(o,l.z);return o}}const VC=k([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:qC}=VC,HC=k([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:WC}=HC,GC=oa.VectorTileFeature.types,ZC=Math.cos(Math.PI/180*37.5),Qv=Math.pow(2,14)/.5;class Bg{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new ac,this.layoutVertexArray2=new th,this.indexArray=new Jr,this.programConfigurations=new nl(t.layers,t.zoom),this.segments=new Vr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(t,o,l){this.hasPattern=Mg("line",this.layers,o);const h=this.layers[0].layout.get("line-sort-key"),m=!h.isConstant(),_=[];for(const{feature:b,id:S,index:I,sourceLayerIndex:E}of t){const A=this.layers[0]._featureFilter.needGeometry,z=ol(b,A);if(!this.layers[0]._featureFilter.filter(new Qt(this.zoom),z,l))continue;const D=m?h.evaluate(z,{},l):void 0,N={id:S,properties:b.properties,type:b.type,sourceLayerIndex:E,index:I,geometry:A?z.geometry:il(b),patterns:{},sortKey:D};_.push(N)}m&&_.sort((b,S)=>b.sortKey-S.sortKey);for(const b of _){const{geometry:S,index:I,sourceLayerIndex:E}=b;if(this.hasPattern){const A=zg("line",this.layers,b,this.zoom,o);this.patternFeatures.push(A)}else this.addFeature(b,S,I,l,{});o.featureIndex.insert(t[I].feature,S,I,E,this.index)}}update(t,o,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,o,this.stateDependentLayers,l)}addFeatures(t,o,l){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,o,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,WC)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,qC),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,o,l,h,m){const _=this.layers[0].layout,b=_.get("line-join").evaluate(t,{}),S=_.get("line-cap"),I=_.get("line-miter-limit"),E=_.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const A of o)this.addLine(A,t,b,S,I,E);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,m,h)}addLine(t,o,l,h,m,_){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Q=0;Q<t.length-1;Q++)this.totalDistance+=t[Q].dist(t[Q+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const b=GC[o.type]==="Polygon";let S=t.length;for(;S>=2&&t[S-1].equals(t[S-2]);)S--;let I=0;for(;I<S-1&&t[I].equals(t[I+1]);)I++;if(S<(b?3:2))return;l==="bevel"&&(m=1.05);const E=this.overscaling<=16?15*Fr/(512*this.overscaling):0,A=this.segments.prepareSegment(10*S,this.layoutVertexArray,this.indexArray);let z,D,N,q,G;this.e1=this.e2=-1,b&&(z=t[S-2],G=t[I].sub(z)._unit()._perp());for(let Q=I;Q<S;Q++){if(N=Q===S-1?b?t[I+1]:void 0:t[Q+1],N&&t[Q].equals(N))continue;G&&(q=G),z&&(D=z),z=t[Q],G=N?N.sub(z)._unit()._perp():q,q=q||G;let de=q.add(G);de.x===0&&de.y===0||de._unit();const ie=q.x*G.x+q.y*G.y,ue=de.x*G.x+de.y*G.y,ve=ue!==0?1/ue:1/0,ke=2*Math.sqrt(2-2*ue),Ne=ue<ZC&&D&&N,lt=q.x*G.y-q.y*G.x>0;if(Ne&&Q>I){const et=z.dist(D);if(et>2*E){const Ye=z.sub(z.sub(D)._mult(E/et)._round());this.updateDistance(D,Ye),this.addCurrentVertex(Ye,q,0,0,A),D=Ye}}const Ue=D&&N;let Oe=Ue?l:b?"butt":h;if(Ue&&Oe==="round"&&(ve<_?Oe="miter":ve<=2&&(Oe="fakeround")),Oe==="miter"&&ve>m&&(Oe="bevel"),Oe==="bevel"&&(ve>2&&(Oe="flipbevel"),ve<m&&(Oe="miter")),D&&this.updateDistance(D,z),Oe==="miter")de._mult(ve),this.addCurrentVertex(z,de,0,0,A);else if(Oe==="flipbevel"){if(ve>100)de=G.mult(-1);else{const et=ve*q.add(G).mag()/q.sub(G).mag();de._perp()._mult(et*(lt?-1:1))}this.addCurrentVertex(z,de,0,0,A),this.addCurrentVertex(z,de.mult(-1),0,0,A)}else if(Oe==="bevel"||Oe==="fakeround"){const et=-Math.sqrt(ve*ve-1),Ye=lt?et:0,Ze=lt?0:et;if(D&&this.addCurrentVertex(z,q,Ye,Ze,A),Oe==="fakeround"){const Te=Math.round(180*ke/Math.PI/20);for(let rt=1;rt<Te;rt++){let Qe=rt/Te;if(Qe!==.5){const Jt=Qe-.5;Qe+=Qe*Jt*(Qe-1)*((1.0904+ie*(ie*(3.55645-1.43519*ie)-3.2452))*Jt*Jt+(.848013+ie*(.215638*ie-1.06021)))}const ft=G.sub(q)._mult(Qe)._add(q)._unit()._mult(lt?-1:1);this.addHalfVertex(z,ft.x,ft.y,!1,lt,0,A)}}N&&this.addCurrentVertex(z,G,-Ye,-Ze,A)}else if(Oe==="butt")this.addCurrentVertex(z,de,0,0,A);else if(Oe==="square"){const et=D?1:-1;this.addCurrentVertex(z,de,et,et,A)}else Oe==="round"&&(D&&(this.addCurrentVertex(z,q,0,0,A),this.addCurrentVertex(z,q,1,1,A,!0)),N&&(this.addCurrentVertex(z,G,-1,-1,A,!0),this.addCurrentVertex(z,G,0,0,A)));if(Ne&&Q<S-1){const et=z.dist(N);if(et>2*E){const Ye=z.add(N.sub(z)._mult(E/et)._round());this.updateDistance(z,Ye),this.addCurrentVertex(Ye,G,0,0,A),z=Ye}}}}addCurrentVertex(t,o,l,h,m,_=!1){const b=o.y*h-o.x,S=-o.y-o.x*h;this.addHalfVertex(t,o.x+o.y*l,o.y-o.x*l,_,!1,l,m),this.addHalfVertex(t,b,S,_,!0,-h,m),this.distance>Qv/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,o,l,h,m,_))}addHalfVertex({x:t,y:o},l,h,m,_,b,S){const I=.5*(this.lineClips?this.scaledDistance*(Qv-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(m?1:0),(o<<1)+(_?1:0),Math.round(63*l)+128,Math.round(63*h)+128,1+(b===0?0:b<0?-1:1)|(63&I)<<2,I>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const E=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,E),S.primitiveLength++),_?this.e2=E:this.e1=E}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,o){this.distance+=t.dist(o),this.updateScaledDistance()}}let e1,t1;Xe("LineBucket",Bg,{omit:["layers","patternFeatures"]});var r1={get paint(){return t1=t1||new u({"line-opacity":new ct(be.paint_line["line-opacity"]),"line-color":new ct(be.paint_line["line-color"]),"line-translate":new tt(be.paint_line["line-translate"]),"line-translate-anchor":new tt(be.paint_line["line-translate-anchor"]),"line-width":new ct(be.paint_line["line-width"]),"line-gap-width":new ct(be.paint_line["line-gap-width"]),"line-offset":new ct(be.paint_line["line-offset"]),"line-blur":new ct(be.paint_line["line-blur"]),"line-dasharray":new r(be.paint_line["line-dasharray"]),"line-pattern":new g(be.paint_line["line-pattern"]),"line-gradient":new a(be.paint_line["line-gradient"])})},get layout(){return e1=e1||new u({"line-cap":new tt(be.layout_line["line-cap"]),"line-join":new ct(be.layout_line["line-join"]),"line-miter-limit":new tt(be.layout_line["line-miter-limit"]),"line-round-limit":new tt(be.layout_line["line-round-limit"]),"line-sort-key":new ct(be.layout_line["line-sort-key"])})}};class KC extends ct{possiblyEvaluate(t,o){return o=new Qt(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,zoomHistory:o.zoomHistory,transition:o.transition}),super.possiblyEvaluate(t,o)}evaluate(t,o,l,h){return o=Ae({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(t,o,l,h)}}let Sp;class XC extends y{constructor(t){super(t,r1),this.gradientVersion=0,Sp||(Sp=new KC(r1.paint.properties["line-width"].specification),Sp.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const o=this.gradientExpression();this.stepInterpolant=!!function(l){return l._styleExpression!==void 0}(o)&&o._styleExpression.expression instanceof $a,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,o){super.recalculate(t,o),this.paint._values["line-floorwidth"]=Sp.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new Bg(t)}queryRadius(t){const o=t,l=n1(ah("line-width",this,o),ah("line-gap-width",this,o)),h=ah("line-offset",this,o);return l/2+Math.abs(h)+gp(this.paint.get("line-translate"))}queryIntersectsFeature(t,o,l,h,m,_,b){const S=yp(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),_.angle,b),I=b/2*n1(this.paint.get("line-width").evaluate(o,l),this.paint.get("line-gap-width").evaluate(o,l)),E=this.paint.get("line-offset").evaluate(o,l);return E&&(h=function(A,z){const D=[];for(let N=0;N<A.length;N++){const q=A[N],G=[];for(let Q=0;Q<q.length;Q++){const de=q[Q-1],ie=q[Q],ue=q[Q+1],ve=Q===0?new j(0,0):ie.sub(de)._unit()._perp(),ke=Q===q.length-1?new j(0,0):ue.sub(ie)._unit()._perp(),Ne=ve._add(ke)._unit(),lt=Ne.x*ke.x+Ne.y*ke.y;lt!==0&&Ne._mult(1/lt),G.push(Ne._mult(z)._add(ie))}D.push(G)}return D}(h,E*b)),function(A,z,D){for(let N=0;N<z.length;N++){const q=z[N];if(A.length>=3){for(let G=0;G<q.length;G++)if(dc(A,q[G]))return!0}if(oC(A,q,D))return!0}return!1}(S,h,I)}isTileClipped(){return!0}}function n1(i,t){return t>0?t+2*i:i}const YC=k([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),JC=k([{name:"a_projected_pos",components:3,type:"Float32"}],4);k([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const QC=k([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);k([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const i1=k([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),eI=k([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function tI(i,t,o){return i.sections.forEach(l=>{l.text=function(h,m,_){const b=m.layout.get("text-transform").evaluate(_,{});return b==="uppercase"?h=h.toLocaleUpperCase():b==="lowercase"&&(h=h.toLocaleLowerCase()),qo.applyArabicShaping&&(h=qo.applyArabicShaping(h)),h}(l.text,t,o)}),i}k([{name:"triangle",components:3,type:"Uint16"}]),k([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),k([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),k([{type:"Float32",name:"offsetX"}]),k([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),k([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const mh={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var qr=24,o1=Gt,s1=function(i,t,o,l,h){var m,_,b=8*h-l-1,S=(1<<b)-1,I=S>>1,E=-7,A=h-1,z=-1,D=i[t+A];for(A+=z,m=D&(1<<-E)-1,D>>=-E,E+=b;E>0;m=256*m+i[t+A],A+=z,E-=8);for(_=m&(1<<-E)-1,m>>=-E,E+=l;E>0;_=256*_+i[t+A],A+=z,E-=8);if(m===0)m=1-I;else{if(m===S)return _?NaN:1/0*(D?-1:1);_+=Math.pow(2,l),m-=I}return(D?-1:1)*_*Math.pow(2,m-l)},a1=function(i,t,o,l,h,m){var _,b,S,I=8*m-h-1,E=(1<<I)-1,A=E>>1,z=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,D=0,N=1,q=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(b=isNaN(t)?1:0,_=E):(_=Math.floor(Math.log(t)/Math.LN2),t*(S=Math.pow(2,-_))<1&&(_--,S*=2),(t+=_+A>=1?z/S:z*Math.pow(2,1-A))*S>=2&&(_++,S/=2),_+A>=E?(b=0,_=E):_+A>=1?(b=(t*S-1)*Math.pow(2,h),_+=A):(b=t*Math.pow(2,A-1)*Math.pow(2,h),_=0));h>=8;i[o+D]=255&b,D+=N,b/=256,h-=8);for(_=_<<h|b,I+=h;I>0;i[o+D]=255&_,D+=N,_/=256,I-=8);i[o+D-N]|=128*q};function Gt(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}Gt.Varint=0,Gt.Fixed64=1,Gt.Bytes=2,Gt.Fixed32=5;var Fg=4294967296,l1=1/Fg,c1=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Ts(i){return i.type===Gt.Bytes?i.readVarint()+i.pos:i.pos+1}function gc(i,t,o){return o?4294967296*t+(i>>>0):4294967296*(t>>>0)+(i>>>0)}function u1(i,t,o){var l=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));o.realloc(l);for(var h=o.pos-1;h>=i;h--)o.buf[h+l]=o.buf[h]}function rI(i,t){for(var o=0;o<i.length;o++)t.writeVarint(i[o])}function nI(i,t){for(var o=0;o<i.length;o++)t.writeSVarint(i[o])}function iI(i,t){for(var o=0;o<i.length;o++)t.writeFloat(i[o])}function oI(i,t){for(var o=0;o<i.length;o++)t.writeDouble(i[o])}function sI(i,t){for(var o=0;o<i.length;o++)t.writeBoolean(i[o])}function aI(i,t){for(var o=0;o<i.length;o++)t.writeFixed32(i[o])}function lI(i,t){for(var o=0;o<i.length;o++)t.writeSFixed32(i[o])}function cI(i,t){for(var o=0;o<i.length;o++)t.writeFixed64(i[o])}function uI(i,t){for(var o=0;o<i.length;o++)t.writeSFixed64(i[o])}function Tp(i,t){return(i[t]|i[t+1]<<8|i[t+2]<<16)+16777216*i[t+3]}function yc(i,t,o){i[o]=t,i[o+1]=t>>>8,i[o+2]=t>>>16,i[o+3]=t>>>24}function h1(i,t){return(i[t]|i[t+1]<<8|i[t+2]<<16)+(i[t+3]<<24)}Gt.prototype={destroy:function(){this.buf=null},readFields:function(i,t,o){for(o=o||this.length;this.pos<o;){var l=this.readVarint(),h=l>>3,m=this.pos;this.type=7&l,i(h,t,this),this.pos===m&&this.skip(l)}return t},readMessage:function(i,t){return this.readFields(i,t,this.readVarint()+this.pos)},readFixed32:function(){var i=Tp(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=h1(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=Tp(this.buf,this.pos)+Tp(this.buf,this.pos+4)*Fg;return this.pos+=8,i},readSFixed64:function(){var i=Tp(this.buf,this.pos)+h1(this.buf,this.pos+4)*Fg;return this.pos+=8,i},readFloat:function(){var i=s1(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=s1(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var t,o,l=this.buf;return t=127&(o=l[this.pos++]),o<128?t:(t|=(127&(o=l[this.pos++]))<<7,o<128?t:(t|=(127&(o=l[this.pos++]))<<14,o<128?t:(t|=(127&(o=l[this.pos++]))<<21,o<128?t:function(h,m,_){var b,S,I=_.buf;if(b=(112&(S=I[_.pos++]))>>4,S<128||(b|=(127&(S=I[_.pos++]))<<3,S<128)||(b|=(127&(S=I[_.pos++]))<<10,S<128)||(b|=(127&(S=I[_.pos++]))<<17,S<128)||(b|=(127&(S=I[_.pos++]))<<24,S<128)||(b|=(1&(S=I[_.pos++]))<<31,S<128))return gc(h,b,m);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(o=l[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?(i+1)/-2:i/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var i=this.readVarint()+this.pos,t=this.pos;return this.pos=i,i-t>=12&&c1?function(o,l,h){return c1.decode(o.subarray(l,h))}(this.buf,t,i):function(o,l,h){for(var m="",_=l;_<h;){var b,S,I,E=o[_],A=null,z=E>239?4:E>223?3:E>191?2:1;if(_+z>h)break;z===1?E<128&&(A=E):z===2?(192&(b=o[_+1]))==128&&(A=(31&E)<<6|63&b)<=127&&(A=null):z===3?(S=o[_+2],(192&(b=o[_+1]))==128&&(192&S)==128&&((A=(15&E)<<12|(63&b)<<6|63&S)<=2047||A>=55296&&A<=57343)&&(A=null)):z===4&&(S=o[_+2],I=o[_+3],(192&(b=o[_+1]))==128&&(192&S)==128&&(192&I)==128&&((A=(15&E)<<18|(63&b)<<12|(63&S)<<6|63&I)<=65535||A>=1114112)&&(A=null)),A===null?(A=65533,z=1):A>65535&&(A-=65536,m+=String.fromCharCode(A>>>10&1023|55296),A=56320|1023&A),m+=String.fromCharCode(A),_+=z}return m}(this.buf,t,i)},readBytes:function(){var i=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,i);return this.pos=i,t},readPackedVarint:function(i,t){if(this.type!==Gt.Bytes)return i.push(this.readVarint(t));var o=Ts(this);for(i=i||[];this.pos<o;)i.push(this.readVarint(t));return i},readPackedSVarint:function(i){if(this.type!==Gt.Bytes)return i.push(this.readSVarint());var t=Ts(this);for(i=i||[];this.pos<t;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==Gt.Bytes)return i.push(this.readBoolean());var t=Ts(this);for(i=i||[];this.pos<t;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==Gt.Bytes)return i.push(this.readFloat());var t=Ts(this);for(i=i||[];this.pos<t;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==Gt.Bytes)return i.push(this.readDouble());var t=Ts(this);for(i=i||[];this.pos<t;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==Gt.Bytes)return i.push(this.readFixed32());var t=Ts(this);for(i=i||[];this.pos<t;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==Gt.Bytes)return i.push(this.readSFixed32());var t=Ts(this);for(i=i||[];this.pos<t;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==Gt.Bytes)return i.push(this.readFixed64());var t=Ts(this);for(i=i||[];this.pos<t;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==Gt.Bytes)return i.push(this.readSFixed64());var t=Ts(this);for(i=i||[];this.pos<t;)i.push(this.readSFixed64());return i},skip:function(i){var t=7&i;if(t===Gt.Varint)for(;this.buf[this.pos++]>127;);else if(t===Gt.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Gt.Fixed32)this.pos+=4;else{if(t!==Gt.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(i,t){this.writeVarint(i<<3|t)},realloc:function(i){for(var t=this.length||16;t<this.pos+i;)t*=2;if(t!==this.length){var o=new Uint8Array(t);o.set(this.buf),this.buf=o,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),yc(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),yc(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),yc(this.buf,-1&i,this.pos),yc(this.buf,Math.floor(i*l1),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),yc(this.buf,-1&i,this.pos),yc(this.buf,Math.floor(i*l1),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?function(t,o){var l,h;if(t>=0?(l=t%4294967296|0,h=t/4294967296|0):(h=~(-t/4294967296),4294967295^(l=~(-t%4294967296))?l=l+1|0:(l=0,h=h+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");o.realloc(10),function(m,_,b){b.buf[b.pos++]=127&m|128,m>>>=7,b.buf[b.pos++]=127&m|128,m>>>=7,b.buf[b.pos++]=127&m|128,m>>>=7,b.buf[b.pos++]=127&m|128,b.buf[b.pos]=127&(m>>>=7)}(l,0,o),function(m,_){var b=(7&m)<<4;_.buf[_.pos++]|=b|((m>>>=3)?128:0),m&&(_.buf[_.pos++]=127&m|((m>>>=7)?128:0),m&&(_.buf[_.pos++]=127&m|((m>>>=7)?128:0),m&&(_.buf[_.pos++]=127&m|((m>>>=7)?128:0),m&&(_.buf[_.pos++]=127&m|((m>>>=7)?128:0),m&&(_.buf[_.pos++]=127&m)))))}(h,o)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?2*-i-1:2*i)},writeBoolean:function(i){this.writeVarint(!!i)},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var t=this.pos;this.pos=function(l,h,m){for(var _,b,S=0;S<h.length;S++){if((_=h.charCodeAt(S))>55295&&_<57344){if(!b){_>56319||S+1===h.length?(l[m++]=239,l[m++]=191,l[m++]=189):b=_;continue}if(_<56320){l[m++]=239,l[m++]=191,l[m++]=189,b=_;continue}_=b-55296<<10|_-56320|65536,b=null}else b&&(l[m++]=239,l[m++]=191,l[m++]=189,b=null);_<128?l[m++]=_:(_<2048?l[m++]=_>>6|192:(_<65536?l[m++]=_>>12|224:(l[m++]=_>>18|240,l[m++]=_>>12&63|128),l[m++]=_>>6&63|128),l[m++]=63&_|128)}return m}(this.buf,i,this.pos);var o=this.pos-t;o>=128&&u1(t,o,this),this.pos=t-1,this.writeVarint(o),this.pos+=o},writeFloat:function(i){this.realloc(4),a1(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),a1(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var t=i.length;this.writeVarint(t),this.realloc(t);for(var o=0;o<t;o++)this.buf[this.pos++]=i[o]},writeRawMessage:function(i,t){this.pos++;var o=this.pos;i(t,this);var l=this.pos-o;l>=128&&u1(o,l,this),this.pos=o-1,this.writeVarint(l),this.pos+=l},writeMessage:function(i,t,o){this.writeTag(i,Gt.Bytes),this.writeRawMessage(t,o)},writePackedVarint:function(i,t){t.length&&this.writeMessage(i,rI,t)},writePackedSVarint:function(i,t){t.length&&this.writeMessage(i,nI,t)},writePackedBoolean:function(i,t){t.length&&this.writeMessage(i,sI,t)},writePackedFloat:function(i,t){t.length&&this.writeMessage(i,iI,t)},writePackedDouble:function(i,t){t.length&&this.writeMessage(i,oI,t)},writePackedFixed32:function(i,t){t.length&&this.writeMessage(i,aI,t)},writePackedSFixed32:function(i,t){t.length&&this.writeMessage(i,lI,t)},writePackedFixed64:function(i,t){t.length&&this.writeMessage(i,cI,t)},writePackedSFixed64:function(i,t){t.length&&this.writeMessage(i,uI,t)},writeBytesField:function(i,t){this.writeTag(i,Gt.Bytes),this.writeBytes(t)},writeFixed32Field:function(i,t){this.writeTag(i,Gt.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(i,t){this.writeTag(i,Gt.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(i,t){this.writeTag(i,Gt.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(i,t){this.writeTag(i,Gt.Fixed64),this.writeSFixed64(t)},writeVarintField:function(i,t){this.writeTag(i,Gt.Varint),this.writeVarint(t)},writeSVarintField:function(i,t){this.writeTag(i,Gt.Varint),this.writeSVarint(t)},writeStringField:function(i,t){this.writeTag(i,Gt.Bytes),this.writeString(t)},writeFloatField:function(i,t){this.writeTag(i,Gt.Fixed32),this.writeFloat(t)},writeDoubleField:function(i,t){this.writeTag(i,Gt.Fixed64),this.writeDouble(t)},writeBooleanField:function(i,t){this.writeVarintField(i,!!t)}};var Og=L(o1);const Ng=3;function hI(i,t,o){i===1&&o.readMessage(dI,t)}function dI(i,t,o){if(i===3){const{id:l,bitmap:h,width:m,height:_,left:b,top:S,advance:I}=o.readMessage(pI,{});t.push({id:l,bitmap:new ch({width:m+2*Ng,height:_+2*Ng},h),metrics:{width:m,height:_,left:b,top:S,advance:I}})}}function pI(i,t,o){i===1?t.id=o.readVarint():i===2?t.bitmap=o.readBytes():i===3?t.width=o.readVarint():i===4?t.height=o.readVarint():i===5?t.left=o.readSVarint():i===6?t.top=o.readSVarint():i===7&&(t.advance=o.readVarint())}const d1=Ng;function p1(i){let t=0,o=0;for(const _ of i)t+=_.w*_.h,o=Math.max(o,_.w);i.sort((_,b)=>b.h-_.h);const l=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),o),h:1/0}];let h=0,m=0;for(const _ of i)for(let b=l.length-1;b>=0;b--){const S=l[b];if(!(_.w>S.w||_.h>S.h)){if(_.x=S.x,_.y=S.y,m=Math.max(m,_.y+_.h),h=Math.max(h,_.x+_.w),_.w===S.w&&_.h===S.h){const I=l.pop();b<l.length&&(l[b]=I)}else _.h===S.h?(S.x+=_.w,S.w-=_.w):_.w===S.w?(S.y+=_.h,S.h-=_.h):(l.push({x:S.x+_.w,y:S.y,w:S.w-_.w,h:_.h}),S.y+=_.h,S.h-=_.h);break}}return{w:h,h:m,fill:t/(h*m)||0}}const ai=1;class $g{constructor(t,{pixelRatio:o,version:l,stretchX:h,stretchY:m,content:_,textFitWidth:b,textFitHeight:S}){this.paddedRect=t,this.pixelRatio=o,this.stretchX=h,this.stretchY=m,this.content=_,this.version=l,this.textFitWidth=b,this.textFitHeight=S}get tl(){return[this.paddedRect.x+ai,this.paddedRect.y+ai]}get br(){return[this.paddedRect.x+this.paddedRect.w-ai,this.paddedRect.y+this.paddedRect.h-ai]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*ai)/this.pixelRatio,(this.paddedRect.h-2*ai)/this.pixelRatio]}}class f1{constructor(t,o){const l={},h={};this.haveRenderCallbacks=[];const m=[];this.addImages(t,l,m),this.addImages(o,h,m);const{w:_,h:b}=p1(m),S=new Li({width:_||1,height:b||1});for(const I in t){const E=t[I],A=l[I].paddedRect;Li.copy(E.data,S,{x:0,y:0},{x:A.x+ai,y:A.y+ai},E.data)}for(const I in o){const E=o[I],A=h[I].paddedRect,z=A.x+ai,D=A.y+ai,N=E.data.width,q=E.data.height;Li.copy(E.data,S,{x:0,y:0},{x:z,y:D},E.data),Li.copy(E.data,S,{x:0,y:q-1},{x:z,y:D-1},{width:N,height:1}),Li.copy(E.data,S,{x:0,y:0},{x:z,y:D+q},{width:N,height:1}),Li.copy(E.data,S,{x:N-1,y:0},{x:z-1,y:D},{width:1,height:q}),Li.copy(E.data,S,{x:0,y:0},{x:z+N,y:D},{width:1,height:q})}this.image=S,this.iconPositions=l,this.patternPositions=h}addImages(t,o,l){for(const h in t){const m=t[h],_={x:0,y:0,w:m.data.width+2*ai,h:m.data.height+2*ai};l.push(_),o[h]=new $g(_,m),m.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(t,o){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const l in t.updatedImages)this.patchUpdatedImage(this.iconPositions[l],t.getImage(l),o),this.patchUpdatedImage(this.patternPositions[l],t.getImage(l),o)}patchUpdatedImage(t,o,l){if(!t||!o||t.version===o.version)return;t.version=o.version;const[h,m]=t.tl;l.update(o.data,void 0,{x:h,y:m})}}var sa;Xe("ImagePosition",$g),Xe("ImageAtlas",f1),v.ah=void 0,(sa=v.ah||(v.ah={}))[sa.none=0]="none",sa[sa.horizontal=1]="horizontal",sa[sa.vertical=2]="vertical",sa[sa.horizontalOnly=3]="horizontalOnly";const gh=-17;class yh{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,o){const l=new yh;return l.scale=t||1,l.fontStack=o,l}static forImage(t){const o=new yh;return o.imageName=t,o}}class _c{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,o){const l=new _c;for(let h=0;h<t.sections.length;h++){const m=t.sections[h];m.image?l.addImageSection(m):l.addTextSection(m,o)}return l}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let o="";for(let l=0;l<t.length;l++){const h=t.charCodeAt(l+1)||null,m=t.charCodeAt(l-1)||null;o+=h&&lp(h)&&!mh[t[l+1]]||m&&lp(m)&&!mh[t[l-1]]||!mh[t[l]]?t[l]:mh[t[l]]}return o}(this.text)}trim(){let t=0;for(let l=0;l<this.text.length&&Ip[this.text.charCodeAt(l)];l++)t++;let o=this.text.length;for(let l=this.text.length-1;l>=0&&l>=t&&Ip[this.text.charCodeAt(l)];l--)o--;this.text=this.text.substring(t,o),this.sectionIndex=this.sectionIndex.slice(t,o)}substring(t,o){const l=new _c;return l.text=this.text.substring(t,o),l.sectionIndex=this.sectionIndex.slice(t,o),l.sections=this.sections,l}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,o)=>Math.max(t,this.sections[o].scale),0)}addTextSection(t,o){this.text+=t.text,this.sections.push(yh.forText(t.scale,t.fontStack||o));const l=this.sections.length-1;for(let h=0;h<t.text.length;++h)this.sectionIndex.push(l)}addImageSection(t){const o=t.image?t.image.name:"";if(o.length===0)return void Et("Can't add FormattedSection with an empty image.");const l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCharCode(l),this.sections.push(yh.forImage(o)),this.sectionIndex.push(this.sections.length-1)):Et("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Cp(i,t,o,l,h,m,_,b,S,I,E,A,z,D,N){const q=_c.fromFeature(i,h);let G;A===v.ah.vertical&&q.verticalizePunctuation();const{processBidirectionalText:Q,processStyledBidirectionalText:de}=qo;if(Q&&q.sections.length===1){G=[];const ve=Q(q.toString(),Ug(q,I,m,t,l,D));for(const ke of ve){const Ne=new _c;Ne.text=ke,Ne.sections=q.sections;for(let lt=0;lt<ke.length;lt++)Ne.sectionIndex.push(0);G.push(Ne)}}else if(de){G=[];const ve=de(q.text,q.sectionIndex,Ug(q,I,m,t,l,D));for(const ke of ve){const Ne=new _c;Ne.text=ke[0],Ne.sectionIndex=ke[1],Ne.sections=q.sections,G.push(Ne)}}else G=function(ve,ke){const Ne=[],lt=ve.text;let Ue=0;for(const Oe of ke)Ne.push(ve.substring(Ue,Oe)),Ue=Oe;return Ue<lt.length&&Ne.push(ve.substring(Ue,lt.length)),Ne}(q,Ug(q,I,m,t,l,D));const ie=[],ue={positionedLines:ie,text:q.toString(),top:E[1],bottom:E[1],left:E[0],right:E[0],writingMode:A,iconsInText:!1,verticalizable:!1};return function(ve,ke,Ne,lt,Ue,Oe,et,Ye,Ze,Te,rt,Qe){let ft=0,Jt=gh,Zt=0,Qr=0;const to=Ye==="right"?1:Ye==="left"?0:.5;let _n=0;for(const Cr of Ue){Cr.trim();const en=Cr.getMaxScale(),An=(en-1)*qr,vn={positionedGlyphs:[],lineOffset:0};ve.positionedLines[_n]=vn;const Zn=vn.positionedGlyphs;let xn=0;if(!Cr.length()){Jt+=Oe,++_n;continue}for(let li=0;li<Cr.length();li++){const Bt=Cr.getSection(li),er=Cr.getSectionIndex(li),lr=Cr.getCharCode(li);let _i=0,gr=null,wc=null,Zo=null,Ko=qr;const ro=!(Ze===v.ah.horizontal||!rt&&!Ju(lr)||rt&&(Ip[lr]||(Tr=lr,Ve.Arabic(Tr)||Ve["Arabic Supplement"](Tr)||Ve["Arabic Extended-A"](Tr)||Ve["Arabic Presentation Forms-A"](Tr)||Ve["Arabic Presentation Forms-B"](Tr))));if(Bt.imageName){const Bi=lt[Bt.imageName];if(!Bi)continue;Zo=Bt.imageName,ve.iconsInText=ve.iconsInText||!0,wc=Bi.paddedRect;const an=Bi.displaySize;Bt.scale=Bt.scale*qr/Qe,gr={width:an[0],height:an[1],left:ai,top:-d1,advance:ro?an[1]:an[0]},_i=An+(qr-an[1]*Bt.scale),Ko=gr.advance;const Cs=ro?an[0]*Bt.scale-qr*en:an[1]*Bt.scale-qr*en;Cs>0&&Cs>xn&&(xn=Cs)}else{const Bi=Ne[Bt.fontStack],an=Bi&&Bi[lr];if(an&&an.rect)wc=an.rect,gr=an.metrics;else{const Cs=ke[Bt.fontStack],wh=Cs&&Cs[lr];if(!wh)continue;gr=wh.metrics}_i=(en-Bt.scale)*qr}ro?(ve.verticalizable=!0,Zn.push({glyph:lr,imageName:Zo,x:ft,y:Jt+_i,vertical:ro,scale:Bt.scale,fontStack:Bt.fontStack,sectionIndex:er,metrics:gr,rect:wc}),ft+=Ko*Bt.scale+Te):(Zn.push({glyph:lr,imageName:Zo,x:ft,y:Jt+_i,vertical:ro,scale:Bt.scale,fontStack:Bt.fontStack,sectionIndex:er,metrics:gr,rect:wc}),ft+=gr.advance*Bt.scale+Te)}Zn.length!==0&&(Zt=Math.max(ft-Te,Zt),yI(Zn,0,Zn.length-1,to,xn)),ft=0;const Di=Oe*en+xn;vn.lineOffset=Math.max(xn,An),Jt+=Di,Qr=Math.max(Di,Qr),++_n}var Tr;const Hn=Jt-gh,{horizontalAlign:Wn,verticalAlign:Gn}=jg(et);(function(Cr,en,An,vn,Zn,xn,Di,li,Bt){const er=(en-An)*Zn;let lr=0;lr=xn!==Di?-li*vn-gh:(-vn*Bt+.5)*Di;for(const _i of Cr)for(const gr of _i.positionedGlyphs)gr.x+=er,gr.y+=lr})(ve.positionedLines,to,Wn,Gn,Zt,Qr,Oe,Hn,Ue.length),ve.top+=-Gn*Hn,ve.bottom=ve.top+Hn,ve.left+=-Wn*Zt,ve.right=ve.left+Zt}(ue,t,o,l,G,_,b,S,A,I,z,N),!function(ve){for(const ke of ve)if(ke.positionedGlyphs.length!==0)return!1;return!0}(ie)&&ue}const Ip={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},fI={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},mI={40:!0};function m1(i,t,o,l,h,m){if(t.imageName){const _=l[t.imageName];return _?_.displaySize[0]*t.scale*qr/m+h:0}{const _=o[t.fontStack],b=_&&_[i];return b?b.metrics.advance*t.scale+h:0}}function g1(i,t,o,l){const h=Math.pow(i-t,2);return l?i<t?h/2:2*h:h+Math.abs(o)*o}function gI(i,t,o){let l=0;return i===10&&(l-=1e4),o&&(l+=150),i!==40&&i!==65288||(l+=50),t!==41&&t!==65289||(l+=50),l}function y1(i,t,o,l,h,m){let _=null,b=g1(t,o,h,m);for(const S of l){const I=g1(t-S.x,o,h,m)+S.badness;I<=b&&(_=S,b=I)}return{index:i,x:t,priorBreak:_,badness:b}}function _1(i){return i?_1(i.priorBreak).concat(i.index):[]}function Ug(i,t,o,l,h,m){if(!i)return[];const _=[],b=function(A,z,D,N,q,G){let Q=0;for(let de=0;de<A.length();de++){const ie=A.getSection(de);Q+=m1(A.getCharCode(de),ie,N,q,z,G)}return Q/Math.max(1,Math.ceil(Q/D))}(i,t,o,l,h,m),S=i.text.indexOf("")>=0;let I=0;for(let A=0;A<i.length();A++){const z=i.getSection(A),D=i.getCharCode(A);if(Ip[D]||(I+=m1(D,z,l,h,t,m)),A<i.length()-1){const N=!((E=D)<11904||!(Ve["Bopomofo Extended"](E)||Ve.Bopomofo(E)||Ve["CJK Compatibility Forms"](E)||Ve["CJK Compatibility Ideographs"](E)||Ve["CJK Compatibility"](E)||Ve["CJK Radicals Supplement"](E)||Ve["CJK Strokes"](E)||Ve["CJK Symbols and Punctuation"](E)||Ve["CJK Unified Ideographs Extension A"](E)||Ve["CJK Unified Ideographs"](E)||Ve["Enclosed CJK Letters and Months"](E)||Ve["Halfwidth and Fullwidth Forms"](E)||Ve.Hiragana(E)||Ve["Ideographic Description Characters"](E)||Ve["Kangxi Radicals"](E)||Ve["Katakana Phonetic Extensions"](E)||Ve.Katakana(E)||Ve["Vertical Forms"](E)||Ve["Yi Radicals"](E)||Ve["Yi Syllables"](E)));(fI[D]||N||z.imageName||A!==i.length()-2&&mI[i.getCharCode(A+1)])&&_.push(y1(A+1,I,b,_,gI(D,i.getCharCode(A+1),N&&S),!1))}}var E;return _1(y1(i.length(),I,b,_,0,!0))}function jg(i){let t=.5,o=.5;switch(i){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:t,verticalAlign:o}}function yI(i,t,o,l,h){if(!l&&!h)return;const m=i[o],_=(i[o].x+m.metrics.advance*m.scale)*l;for(let b=t;b<=o;b++)i[b].x-=_,i[b].y+=h}function _I(i,t,o){const{horizontalAlign:l,verticalAlign:h}=jg(o),m=t[0]-i.displaySize[0]*l,_=t[1]-i.displaySize[1]*h;return{image:i,top:_,bottom:_+i.displaySize[1],left:m,right:m+i.displaySize[0]}}function v1(i){var t,o;let l=i.left,h=i.top,m=i.right-l,_=i.bottom-h;const b=(t=i.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",S=(o=i.image.textFitHeight)!==null&&o!==void 0?o:"stretchOrShrink",I=(i.image.content[2]-i.image.content[0])/(i.image.content[3]-i.image.content[1]);if(S==="proportional"){if(b==="stretchOnly"&&m/_<I||b==="proportional"){const E=Math.ceil(_*I);l*=E/m,m=E}}else if(b==="proportional"&&S==="stretchOnly"&&I!==0&&m/_>I){const E=Math.ceil(m/I);h*=E/_,_=E}return{x1:l,y1:h,x2:l+m,y2:h+_}}function x1(i,t,o,l,h,m){const _=i.image;let b;if(_.content){const G=_.content,Q=_.pixelRatio||1;b=[G[0]/Q,G[1]/Q,_.displaySize[0]-G[2]/Q,_.displaySize[1]-G[3]/Q]}const S=t.left*m,I=t.right*m;let E,A,z,D;o==="width"||o==="both"?(D=h[0]+S-l[3],A=h[0]+I+l[1]):(D=h[0]+(S+I-_.displaySize[0])/2,A=D+_.displaySize[0]);const N=t.top*m,q=t.bottom*m;return o==="height"||o==="both"?(E=h[1]+N-l[0],z=h[1]+q+l[2]):(E=h[1]+(N+q-_.displaySize[1])/2,z=E+_.displaySize[1]),{image:_,top:E,right:A,bottom:z,left:D,collisionPadding:b}}const _h=255,Go=128,aa=_h*Go;function b1(i,t){const{expression:o}=t;if(o.kind==="constant")return{kind:"constant",layoutSize:o.evaluate(new Qt(i+1))};if(o.kind==="source")return{kind:"source"};{const{zoomStops:l,interpolationType:h}=o;let m=0;for(;m<l.length&&l[m]<=i;)m++;m=Math.max(0,m-1);let _=m;for(;_<l.length&&l[_]<i+1;)_++;_=Math.min(l.length-1,_);const b=l[m],S=l[_];return o.kind==="composite"?{kind:"composite",minZoom:b,maxZoom:S,interpolationType:h}:{kind:"camera",minZoom:b,maxZoom:S,minSize:o.evaluate(new Qt(b)),maxSize:o.evaluate(new Qt(S)),interpolationType:h}}}function Vg(i,t,o){let l="never";const h=i.get(t);return h?l=h:i.get(o)&&(l="always"),l}const vI=oa.VectorTileFeature.types,xI=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Ep(i,t,o,l,h,m,_,b,S,I,E,A,z){const D=b?Math.min(aa,Math.round(b[0])):0,N=b?Math.min(aa,Math.round(b[1])):0;i.emplaceBack(t,o,Math.round(32*l),Math.round(32*h),m,_,(D<<1)+(S?1:0),N,16*I,16*E,256*A,256*z)}function qg(i,t,o){i.emplaceBack(t.x,t.y,o),i.emplaceBack(t.x,t.y,o),i.emplaceBack(t.x,t.y,o),i.emplaceBack(t.x,t.y,o)}function bI(i){for(const t of i.sections)if(Qu(t.text))return!0;return!1}class Hg{constructor(t){this.layoutVertexArray=new zi,this.indexArray=new Jr,this.programConfigurations=t,this.segments=new Vr,this.dynamicLayoutVertexArray=new Ho,this.opacityVertexArray=new ta,this.hasVisibleVertices=!1,this.placedSymbolArray=new sr}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,o,l,h){this.isEmpty()||(l&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,YC.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,JC.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,xI,!0),this.opacityVertexBuffer.itemSize=1),(l||h)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Xe("SymbolBuffers",Hg);class Wg{constructor(t,o,l){this.layoutVertexArray=new t,this.layoutAttributes=o,this.indexArray=new l,this.segments=new Vr,this.collisionVertexArray=new gn}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,QC.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Xe("CollisionBuffers",Wg);class vc{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(_=>_.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Tg([]),this.placementViewportMatrix=Tg([]);const o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=b1(this.zoom,o["text-size"]),this.iconSizeData=b1(this.zoom,o["icon-size"]);const l=this.layers[0].layout,h=l.get("symbol-sort-key"),m=l.get("symbol-z-order");this.canOverlap=Vg(l,"text-overlap","text-allow-overlap")!=="never"||Vg(l,"icon-overlap","icon-allow-overlap")!=="never"||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&!h.isConstant(),this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,l.get("symbol-placement")==="point"&&(this.writingModes=l.get("text-writing-mode").map(_=>v.ah[_])),this.stateDependentLayerIds=this.layers.filter(_=>_.isStateDependent()).map(_=>_.id),this.sourceID=t.sourceID}createArrays(){this.text=new Hg(new nl(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new Hg(new nl(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new ar,this.lineVertexArray=new Vn,this.symbolInstances=new Pi,this.textAnchorOffsets=new pn}calculateGlyphDependencies(t,o,l,h,m){for(let _=0;_<t.length;_++)if(o[t.charCodeAt(_)]=!0,(l||h)&&m){const b=mh[t.charAt(_)];b&&(o[b.charCodeAt(0)]=!0)}}populate(t,o,l){const h=this.layers[0],m=h.layout,_=m.get("text-font"),b=m.get("text-field"),S=m.get("icon-image"),I=(b.value.kind!=="constant"||b.value.value instanceof ri&&!b.value.value.isEmpty()||b.value.value.toString().length>0)&&(_.value.kind!=="constant"||_.value.value.length>0),E=S.value.kind!=="constant"||!!S.value.value||Object.keys(S.parameters).length>0,A=m.get("symbol-sort-key");if(this.features=[],!I&&!E)return;const z=o.iconDependencies,D=o.glyphDependencies,N=o.availableImages,q=new Qt(this.zoom);for(const{feature:G,id:Q,index:de,sourceLayerIndex:ie}of t){const ue=h._featureFilter.needGeometry,ve=ol(G,ue);if(!h._featureFilter.filter(q,ve,l))continue;let ke,Ne;if(ue||(ve.geometry=il(G)),I){const Ue=h.getValueAndResolveTokens("text-field",ve,l,N),Oe=ri.factory(Ue),et=this.hasRTLText=this.hasRTLText||bI(Oe);(!et||qo.getRTLTextPluginStatus()==="unavailable"||et&&qo.isParsed())&&(ke=tI(Oe,h,ve))}if(E){const Ue=h.getValueAndResolveTokens("icon-image",ve,l,N);Ne=Ue instanceof mi?Ue:mi.fromString(Ue)}if(!ke&&!Ne)continue;const lt=this.sortFeaturesByKey?A.evaluate(ve,{},l):void 0;if(this.features.push({id:Q,text:ke,icon:Ne,index:de,sourceLayerIndex:ie,geometry:ve.geometry,properties:G.properties,type:vI[G.type],sortKey:lt}),Ne&&(z[Ne.name]=!0),ke){const Ue=_.evaluate(ve,{},l).join(","),Oe=m.get("text-rotation-alignment")!=="viewport"&&m.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(v.ah.vertical)>=0;for(const et of ke.sections)if(et.image)z[et.image.name]=!0;else{const Ye=Yu(ke.toString()),Ze=et.fontStack||Ue,Te=D[Ze]=D[Ze]||{};this.calculateGlyphDependencies(et.text,Te,Oe,this.allowVerticalPlacement,Ye)}}}m.get("symbol-placement")==="line"&&(this.features=function(G){const Q={},de={},ie=[];let ue=0;function ve(Ue){ie.push(G[Ue]),ue++}function ke(Ue,Oe,et){const Ye=de[Ue];return delete de[Ue],de[Oe]=Ye,ie[Ye].geometry[0].pop(),ie[Ye].geometry[0]=ie[Ye].geometry[0].concat(et[0]),Ye}function Ne(Ue,Oe,et){const Ye=Q[Oe];return delete Q[Oe],Q[Ue]=Ye,ie[Ye].geometry[0].shift(),ie[Ye].geometry[0]=et[0].concat(ie[Ye].geometry[0]),Ye}function lt(Ue,Oe,et){const Ye=et?Oe[0][Oe[0].length-1]:Oe[0][0];return`${Ue}:${Ye.x}:${Ye.y}`}for(let Ue=0;Ue<G.length;Ue++){const Oe=G[Ue],et=Oe.geometry,Ye=Oe.text?Oe.text.toString():null;if(!Ye){ve(Ue);continue}const Ze=lt(Ye,et),Te=lt(Ye,et,!0);if(Ze in de&&Te in Q&&de[Ze]!==Q[Te]){const rt=Ne(Ze,Te,et),Qe=ke(Ze,Te,ie[rt].geometry);delete Q[Ze],delete de[Te],de[lt(Ye,ie[Qe].geometry,!0)]=Qe,ie[rt].geometry=null}else Ze in de?ke(Ze,Te,et):Te in Q?Ne(Ze,Te,et):(ve(Ue),Q[Ze]=ue-1,de[Te]=ue-1)}return ie.filter(Ue=>Ue.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((G,Q)=>G.sortKey-Q.sortKey)}update(t,o,l){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,o,this.layers,l),this.icon.programConfigurations.updatePaintArrays(t,o,this.layers,l))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,o){const l=this.lineVertexArray.length;if(t.segment!==void 0){let h=t.dist(o[t.segment+1]),m=t.dist(o[t.segment]);const _={};for(let b=t.segment+1;b<o.length;b++)_[b]={x:o[b].x,y:o[b].y,tileUnitDistanceFromAnchor:h},b<o.length-1&&(h+=o[b+1].dist(o[b]));for(let b=t.segment||0;b>=0;b--)_[b]={x:o[b].x,y:o[b].y,tileUnitDistanceFromAnchor:m},b>0&&(m+=o[b-1].dist(o[b]));for(let b=0;b<o.length;b++){const S=_[b];this.lineVertexArray.emplaceBack(S.x,S.y,S.tileUnitDistanceFromAnchor)}}return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}}addSymbols(t,o,l,h,m,_,b,S,I,E,A,z){const D=t.indexArray,N=t.layoutVertexArray,q=t.segments.prepareSegment(4*o.length,N,D,this.canOverlap?_.sortKey:void 0),G=this.glyphOffsetArray.length,Q=q.vertexLength,de=this.allowVerticalPlacement&&b===v.ah.vertical?Math.PI/2:0,ie=_.text&&_.text.sections;for(let ue=0;ue<o.length;ue++){const{tl:ve,tr:ke,bl:Ne,br:lt,tex:Ue,pixelOffsetTL:Oe,pixelOffsetBR:et,minFontScaleX:Ye,minFontScaleY:Ze,glyphOffset:Te,isSDF:rt,sectionIndex:Qe}=o[ue],ft=q.vertexLength,Jt=Te[1];Ep(N,S.x,S.y,ve.x,Jt+ve.y,Ue.x,Ue.y,l,rt,Oe.x,Oe.y,Ye,Ze),Ep(N,S.x,S.y,ke.x,Jt+ke.y,Ue.x+Ue.w,Ue.y,l,rt,et.x,Oe.y,Ye,Ze),Ep(N,S.x,S.y,Ne.x,Jt+Ne.y,Ue.x,Ue.y+Ue.h,l,rt,Oe.x,et.y,Ye,Ze),Ep(N,S.x,S.y,lt.x,Jt+lt.y,Ue.x+Ue.w,Ue.y+Ue.h,l,rt,et.x,et.y,Ye,Ze),qg(t.dynamicLayoutVertexArray,S,de),D.emplaceBack(ft,ft+1,ft+2),D.emplaceBack(ft+1,ft+2,ft+3),q.vertexLength+=4,q.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Te[0]),ue!==o.length-1&&Qe===o[ue+1].sectionIndex||t.programConfigurations.populatePaintArrays(N.length,_,_.index,{},z,ie&&ie[Qe])}t.placedSymbolArray.emplaceBack(S.x,S.y,G,this.glyphOffsetArray.length-G,Q,I,E,S.segment,l?l[0]:0,l?l[1]:0,h[0],h[1],b,0,!1,0,A)}_addCollisionDebugVertex(t,o,l,h,m,_){return o.emplaceBack(0,0),t.emplaceBack(l.x,l.y,h,m,Math.round(_.x),Math.round(_.y))}addCollisionDebugVertices(t,o,l,h,m,_,b){const S=m.segments.prepareSegment(4,m.layoutVertexArray,m.indexArray),I=S.vertexLength,E=m.layoutVertexArray,A=m.collisionVertexArray,z=b.anchorX,D=b.anchorY;this._addCollisionDebugVertex(E,A,_,z,D,new j(t,o)),this._addCollisionDebugVertex(E,A,_,z,D,new j(l,o)),this._addCollisionDebugVertex(E,A,_,z,D,new j(l,h)),this._addCollisionDebugVertex(E,A,_,z,D,new j(t,h)),S.vertexLength+=4;const N=m.indexArray;N.emplaceBack(I,I+1),N.emplaceBack(I+1,I+2),N.emplaceBack(I+2,I+3),N.emplaceBack(I+3,I),S.primitiveLength+=4}addDebugCollisionBoxes(t,o,l,h){for(let m=t;m<o;m++){const _=this.collisionBoxArray.get(m);this.addCollisionDebugVertices(_.x1,_.y1,_.x2,_.y2,h?this.textCollisionBox:this.iconCollisionBox,_.anchorPoint,l)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Wg(mn,i1.members,pr),this.iconCollisionBox=new Wg(mn,i1.members,pr);for(let t=0;t<this.symbolInstances.length;t++){const o=this.symbolInstances.get(t);this.addDebugCollisionBoxes(o.textBoxStartIndex,o.textBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.iconBoxStartIndex,o.iconBoxEndIndex,o,!1),this.addDebugCollisionBoxes(o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o,!1)}}_deserializeCollisionBoxesForSymbol(t,o,l,h,m,_,b,S,I){const E={};for(let A=o;A<l;A++){const z=t.get(A);E.textBox={x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2,anchorPointX:z.anchorPointX,anchorPointY:z.anchorPointY},E.textFeatureIndex=z.featureIndex;break}for(let A=h;A<m;A++){const z=t.get(A);E.verticalTextBox={x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2,anchorPointX:z.anchorPointX,anchorPointY:z.anchorPointY},E.verticalTextFeatureIndex=z.featureIndex;break}for(let A=_;A<b;A++){const z=t.get(A);E.iconBox={x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2,anchorPointX:z.anchorPointX,anchorPointY:z.anchorPointY},E.iconFeatureIndex=z.featureIndex;break}for(let A=S;A<I;A++){const z=t.get(A);E.verticalIconBox={x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2,anchorPointX:z.anchorPointX,anchorPointY:z.anchorPointY},E.verticalIconFeatureIndex=z.featureIndex;break}return E}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const l=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,o){const l=t.placedSymbolArray.get(o),h=l.vertexStartIndex+4*l.numGlyphs;for(let m=l.vertexStartIndex;m<h;m+=4)t.indexArray.emplaceBack(m,m+1,m+2),t.indexArray.emplaceBack(m+1,m+2,m+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(t),l=Math.cos(t),h=[],m=[],_=[];for(let b=0;b<this.symbolInstances.length;++b){_.push(b);const S=this.symbolInstances.get(b);h.push(0|Math.round(o*S.anchorX+l*S.anchorY)),m.push(S.featureIndex)}return _.sort((b,S)=>h[b]-h[S]||m[S]-m[b]),_}addToSortKeyRanges(t,o){const l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===o?l.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const l=this.symbolInstances.get(o);this.featureSortOrder.push(l.featureIndex),[l.rightJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.leftJustifiedTextSymbolIndex].forEach((h,m,_)=>{h>=0&&_.indexOf(h)===m&&this.addIndicesForPlacedSymbol(this.text,h)}),l.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,l.verticalPlacedTextSymbolIndex),l.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.placedIconSymbolIndex),l.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let w1,S1;Xe("SymbolBucket",vc,{omit:["layers","collisionBoxArray","features","compareText"]}),vc.MAX_GLYPHS=65535,vc.addDynamicAttributes=qg;var Gg={get paint(){return S1=S1||new u({"icon-opacity":new ct(be.paint_symbol["icon-opacity"]),"icon-color":new ct(be.paint_symbol["icon-color"]),"icon-halo-color":new ct(be.paint_symbol["icon-halo-color"]),"icon-halo-width":new ct(be.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ct(be.paint_symbol["icon-halo-blur"]),"icon-translate":new tt(be.paint_symbol["icon-translate"]),"icon-translate-anchor":new tt(be.paint_symbol["icon-translate-anchor"]),"text-opacity":new ct(be.paint_symbol["text-opacity"]),"text-color":new ct(be.paint_symbol["text-color"],{runtimeType:Cn,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new ct(be.paint_symbol["text-halo-color"]),"text-halo-width":new ct(be.paint_symbol["text-halo-width"]),"text-halo-blur":new ct(be.paint_symbol["text-halo-blur"]),"text-translate":new tt(be.paint_symbol["text-translate"]),"text-translate-anchor":new tt(be.paint_symbol["text-translate-anchor"])})},get layout(){return w1=w1||new u({"symbol-placement":new tt(be.layout_symbol["symbol-placement"]),"symbol-spacing":new tt(be.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new tt(be.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ct(be.layout_symbol["symbol-sort-key"]),"symbol-z-order":new tt(be.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new tt(be.layout_symbol["icon-allow-overlap"]),"icon-overlap":new tt(be.layout_symbol["icon-overlap"]),"icon-ignore-placement":new tt(be.layout_symbol["icon-ignore-placement"]),"icon-optional":new tt(be.layout_symbol["icon-optional"]),"icon-rotation-alignment":new tt(be.layout_symbol["icon-rotation-alignment"]),"icon-size":new ct(be.layout_symbol["icon-size"]),"icon-text-fit":new tt(be.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new tt(be.layout_symbol["icon-text-fit-padding"]),"icon-image":new ct(be.layout_symbol["icon-image"]),"icon-rotate":new ct(be.layout_symbol["icon-rotate"]),"icon-padding":new ct(be.layout_symbol["icon-padding"]),"icon-keep-upright":new tt(be.layout_symbol["icon-keep-upright"]),"icon-offset":new ct(be.layout_symbol["icon-offset"]),"icon-anchor":new ct(be.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new tt(be.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new tt(be.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new tt(be.layout_symbol["text-rotation-alignment"]),"text-field":new ct(be.layout_symbol["text-field"]),"text-font":new ct(be.layout_symbol["text-font"]),"text-size":new ct(be.layout_symbol["text-size"]),"text-max-width":new ct(be.layout_symbol["text-max-width"]),"text-line-height":new tt(be.layout_symbol["text-line-height"]),"text-letter-spacing":new ct(be.layout_symbol["text-letter-spacing"]),"text-justify":new ct(be.layout_symbol["text-justify"]),"text-radial-offset":new ct(be.layout_symbol["text-radial-offset"]),"text-variable-anchor":new tt(be.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new ct(be.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new ct(be.layout_symbol["text-anchor"]),"text-max-angle":new tt(be.layout_symbol["text-max-angle"]),"text-writing-mode":new tt(be.layout_symbol["text-writing-mode"]),"text-rotate":new ct(be.layout_symbol["text-rotate"]),"text-padding":new tt(be.layout_symbol["text-padding"]),"text-keep-upright":new tt(be.layout_symbol["text-keep-upright"]),"text-transform":new ct(be.layout_symbol["text-transform"]),"text-offset":new ct(be.layout_symbol["text-offset"]),"text-allow-overlap":new tt(be.layout_symbol["text-allow-overlap"]),"text-overlap":new tt(be.layout_symbol["text-overlap"]),"text-ignore-placement":new tt(be.layout_symbol["text-ignore-placement"]),"text-optional":new tt(be.layout_symbol["text-optional"])})}};class T1{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:Yi,this.defaultValue=t}evaluate(t){if(t.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(t.formattedSection))return o.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Xe("FormatSectionOverride",T1,{omit:["defaultValue"]});class kp extends y{constructor(t){super(t,Gg)}recalculate(t,o){if(super.recalculate(t,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const l=this.layout.get("text-writing-mode");if(l){const h=[];for(const m of l)h.indexOf(m)<0&&h.push(m);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,o,l,h){const m=this.layout.get(t).evaluate(o,{},l,h),_=this._unevaluatedLayout._values[t];return _.isDataDriven()||Kl(_.value)||!m?m:function(b,S){return S.replace(/{([^{}]+)}/g,(I,E)=>b&&E in b?String(b[E]):"")}(o.properties,m)}createBucket(t){return new vc(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of Gg.paint.overridableProperties){if(!kp.hasPaintOverride(this.layout,t))continue;const o=this.paint.get(t),l=new T1(o),h=new Fu(l,o.property.specification);let m=null;m=o.value.kind==="constant"||o.value.kind==="source"?new Ou("source",h):new Nu("composite",h,o.value.zoomStops),this.paint._values[t]=new eo(o.property,m,o.parameters)}}_handleOverridablePaintPropertyUpdate(t,o,l){return!(!this.layout||o.isDataDriven()||l.isDataDriven())&&kp.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,o){const l=t.get("text-field"),h=Gg.paint.properties[o];let m=!1;const _=b=>{for(const S of b)if(h.overrides&&h.overrides.hasOverride(S))return void(m=!0)};if(l.value.kind==="constant"&&l.value.value instanceof ri)_(l.value.value.sections);else if(l.value.kind==="source"){const b=I=>{m||(I instanceof hs&&Br(I.value)===vo?_(I.value.sections):I instanceof Bl?_(I.sections):I.eachChild(b))},S=l.value;S._styleExpression&&b(S._styleExpression.expression)}return m}}let C1;var wI={get paint(){return C1=C1||new u({"background-color":new tt(be.paint_background["background-color"]),"background-pattern":new r(be.paint_background["background-pattern"]),"background-opacity":new tt(be.paint_background["background-opacity"])})}};class SI extends y{constructor(t){super(t,wI)}}let I1;var TI={get paint(){return I1=I1||new u({"raster-opacity":new tt(be.paint_raster["raster-opacity"]),"raster-hue-rotate":new tt(be.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new tt(be.paint_raster["raster-brightness-min"]),"raster-brightness-max":new tt(be.paint_raster["raster-brightness-max"]),"raster-saturation":new tt(be.paint_raster["raster-saturation"]),"raster-contrast":new tt(be.paint_raster["raster-contrast"]),"raster-resampling":new tt(be.paint_raster["raster-resampling"]),"raster-fade-duration":new tt(be.paint_raster["raster-fade-duration"])})}};class CI extends y{constructor(t){super(t,TI)}}class II extends y{constructor(t){super(t,{}),this.onAdd=o=>{this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)},this.onRemove=o=>{this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class EI{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Zg=63710088e-1;class la{constructor(t,o){if(isNaN(t)||isNaN(o))throw new Error(`Invalid LngLat object: (${t}, ${o})`);if(this.lng=+t,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new la(Pe(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const o=Math.PI/180,l=this.lat*o,h=t.lat*o,m=Math.sin(l)*Math.sin(h)+Math.cos(l)*Math.cos(h)*Math.cos((t.lng-this.lng)*o);return Zg*Math.acos(Math.min(m,1))}static convert(t){if(t instanceof la)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new la(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new la(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const E1=2*Math.PI*Zg;function k1(i){return E1*Math.cos(i*Math.PI/180)}function A1(i){return(180+i)/360}function P1(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function M1(i,t){return i/k1(t)}function Kg(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}class Ap{constructor(t,o,l=0){this.x=+t,this.y=+o,this.z=+l}static fromLngLat(t,o=0){const l=la.convert(t);return new Ap(A1(l.lng),P1(l.lat),M1(o,l.lat))}toLngLat(){return new la(360*this.x-180,Kg(this.y))}toAltitude(){return this.z*k1(Kg(this.y))}meterInMercatorCoordinateUnits(){return 1/E1*(t=Kg(this.y),1/Math.cos(t*Math.PI/180));var t}}function z1(i,t,o){var l=2*Math.PI*6378137/256/Math.pow(2,o);return[i*l-2*Math.PI*6378137/2,t*l-2*Math.PI*6378137/2]}class Xg{constructor(t,o,l){if(t<0||t>25||l<0||l>=Math.pow(2,t)||o<0||o>=Math.pow(2,t))throw new Error(`x=${o}, y=${l}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=o,this.y=l,this.key=vh(0,t,t,o,l)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,o,l){const h=(_=this.y,b=this.z,S=z1(256*(m=this.x),256*(_=Math.pow(2,b)-_-1),b),I=z1(256*(m+1),256*(_+1),b),S[0]+","+S[1]+","+I[0]+","+I[1]);var m,_,b,S,I;const E=function(A,z,D){let N,q="";for(let G=A;G>0;G--)N=1<<G-1,q+=(z&N?1:0)+(D&N?2:0);return q}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(l==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,o>1?"@2x":"").replace(/{quadkey}/g,E).replace(/{bbox-epsg-3857}/g,h)}isChildOf(t){const o=this.z-t.z;return o>0&&t.x===this.x>>o&&t.y===this.y>>o}getTilePoint(t){const o=Math.pow(2,this.z);return new j((t.x*o-this.x)*Fr,(t.y*o-this.y)*Fr)}toString(){return`${this.z}/${this.x}/${this.y}`}}class L1{constructor(t,o){this.wrap=t,this.canonical=o,this.key=vh(t,o.z,o.z,o.x,o.y)}}class Ri{constructor(t,o,l,h,m){if(t<l)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${l}`);this.overscaledZ=t,this.wrap=o,this.canonical=new Xg(l,+h,+m),this.key=vh(o,t,l,h,m)}clone(){return new Ri(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const o=this.canonical.z-t;return t>this.canonical.z?new Ri(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ri(t,this.wrap,t,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(t,o){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const l=this.canonical.z-t;return t>this.canonical.z?vh(this.wrap*+o,t,this.canonical.z,this.canonical.x,this.canonical.y):vh(this.wrap*+o,t,t,this.canonical.x>>l,this.canonical.y>>l)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const o=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>o&&t.canonical.y===this.canonical.y>>o}children(t){if(this.overscaledZ>=t)return[new Ri(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,l=2*this.canonical.x,h=2*this.canonical.y;return[new Ri(o,this.wrap,o,l,h),new Ri(o,this.wrap,o,l+1,h),new Ri(o,this.wrap,o,l,h+1),new Ri(o,this.wrap,o,l+1,h+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Ri(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Ri(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new L1(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new Ap(t.x-this.wrap,t.y))}}function vh(i,t,o,l,h){(i*=2)<0&&(i=-1*i-1);const m=1<<o;return(m*m*i+m*h+l).toString(36)+o.toString(36)+t.toString(36)}Xe("CanonicalTileID",Xg),Xe("OverscaledTileID",Ri,{omit:["posMatrix"]});class R1{constructor(t,o,l,h=1,m=1,_=1,b=0){if(this.uid=t,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(l&&!["mapbox","terrarium","custom"].includes(l))return void Et(`"${l}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=o.height;const S=this.dim=o.height-2;switch(this.data=new Uint32Array(o.data.buffer),l){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=h,this.greenFactor=m,this.blueFactor=_,this.baseShift=b;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let I=0;I<S;I++)this.data[this._idx(-1,I)]=this.data[this._idx(0,I)],this.data[this._idx(S,I)]=this.data[this._idx(S-1,I)],this.data[this._idx(I,-1)]=this.data[this._idx(I,0)],this.data[this._idx(I,S)]=this.data[this._idx(I,S-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(S,-1)]=this.data[this._idx(S-1,0)],this.data[this._idx(-1,S)]=this.data[this._idx(0,S-1)],this.data[this._idx(S,S)]=this.data[this._idx(S-1,S-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let I=0;I<S;I++)for(let E=0;E<S;E++){const A=this.get(I,E);A>this.max&&(this.max=A),A<this.min&&(this.min=A)}}get(t,o){const l=new Uint8Array(this.data.buffer),h=4*this._idx(t,o);return this.unpack(l[h],l[h+1],l[h+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,o){if(t<-1||t>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(t+1)}unpack(t,o,l){return t*this.redFactor+o*this.greenFactor+l*this.blueFactor-this.baseShift}getPixels(){return new Li({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,o,l){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let h=o*this.dim,m=o*this.dim+this.dim,_=l*this.dim,b=l*this.dim+this.dim;switch(o){case-1:h=m-1;break;case 1:m=h+1}switch(l){case-1:_=b-1;break;case 1:b=_+1}const S=-o*this.dim,I=-l*this.dim;for(let E=_;E<b;E++)for(let A=h;A<m;A++)this.data[this._idx(A,E)]=t.data[this._idx(A+S,E+I)]}}Xe("DEMData",R1);class D1{constructor(t){this._stringToNumber={},this._numberToString=[];for(let o=0;o<t.length;o++){const l=t[o];this._stringToNumber[l]=o,this._numberToString[o]=l}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class B1{constructor(t,o,l,h,m){this.type="Feature",this._vectorTileFeature=t,t._z=o,t._x=l,t._y=h,this.properties=t.properties,this.id=m}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const o in this)o!=="_geometry"&&o!=="_vectorTileFeature"&&(t[o]=this[o]);return t}}class F1{constructor(t,o){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Qa(Fr,16,0),this.grid3D=new Qa(Fr,16,0),this.featureIndexArray=new Mi,this.promoteId=o}insert(t,o,l,h,m,_){const b=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,h,m);const S=_?this.grid3D:this.grid;for(let I=0;I<o.length;I++){const E=o[I],A=[1/0,1/0,-1/0,-1/0];for(let z=0;z<E.length;z++){const D=E[z];A[0]=Math.min(A[0],D.x),A[1]=Math.min(A[1],D.y),A[2]=Math.max(A[2],D.x),A[3]=Math.max(A[3],D.y)}A[0]<Fr&&A[1]<Fr&&A[2]>=0&&A[3]>=0&&S.insert(b,A[0],A[1],A[2],A[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new oa.VectorTile(new Og(this.rawTileData)).layers,this.sourceLayerCoder=new D1(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,o,l,h){this.loadVTLayers();const m=t.params||{},_=Fr/t.tileSize/t.scale,b=$u(m.filter),S=t.queryGeometry,I=t.queryPadding*_,E=N1(S),A=this.grid.query(E.minX-I,E.minY-I,E.maxX+I,E.maxY+I),z=N1(t.cameraQueryGeometry),D=this.grid3D.query(z.minX-I,z.minY-I,z.maxX+I,z.maxY+I,(G,Q,de,ie)=>function(ue,ve,ke,Ne,lt){for(const Oe of ue)if(ve<=Oe.x&&ke<=Oe.y&&Ne>=Oe.x&&lt>=Oe.y)return!0;const Ue=[new j(ve,ke),new j(ve,lt),new j(Ne,lt),new j(Ne,ke)];if(ue.length>2){for(const Oe of Ue)if(dc(ue,Oe))return!0}for(let Oe=0;Oe<ue.length-1;Oe++)if(aC(ue[Oe],ue[Oe+1],Ue))return!0;return!1}(t.cameraQueryGeometry,G-I,Q-I,de+I,ie+I));for(const G of D)A.push(G);A.sort(kI);const N={};let q;for(let G=0;G<A.length;G++){const Q=A[G];if(Q===q)continue;q=Q;const de=this.featureIndexArray.get(Q);let ie=null;this.loadMatchingFeature(N,de.bucketIndex,de.sourceLayerIndex,de.featureIndex,b,m.layers,m.availableImages,o,l,h,(ue,ve,ke)=>(ie||(ie=il(ue)),ve.queryIntersectsFeature(S,ue,ke,ie,this.z,t.transform,_,t.pixelPosMatrix)))}return N}loadMatchingFeature(t,o,l,h,m,_,b,S,I,E,A){const z=this.bucketLayerIDs[o];if(_&&!function(G,Q){for(let de=0;de<G.length;de++)if(Q.indexOf(G[de])>=0)return!0;return!1}(_,z))return;const D=this.sourceLayerCoder.decode(l),N=this.vtLayers[D].feature(h);if(m.needGeometry){const G=ol(N,!0);if(!m.filter(new Qt(this.tileID.overscaledZ),G,this.tileID.canonical))return}else if(!m.filter(new Qt(this.tileID.overscaledZ),N))return;const q=this.getId(N,D);for(let G=0;G<z.length;G++){const Q=z[G];if(_&&_.indexOf(Q)<0)continue;const de=S[Q];if(!de)continue;let ie={};q&&E&&(ie=E.getState(de.sourceLayer||"_geojsonTileLayer",q));const ue=Ae({},I[Q]);ue.paint=O1(ue.paint,de.paint,N,ie,b),ue.layout=O1(ue.layout,de.layout,N,ie,b);const ve=!A||A(N,de,ie);if(!ve)continue;const ke=new B1(N,this.z,this.x,this.y,q);ke.layer=ue;let Ne=t[Q];Ne===void 0&&(Ne=t[Q]=[]),Ne.push({featureIndex:h,feature:ke,intersectionZ:ve})}}lookupSymbolFeatures(t,o,l,h,m,_,b,S){const I={};this.loadVTLayers();const E=$u(m);for(const A of t)this.loadMatchingFeature(I,l,h,A,E,_,b,S,o);return I}hasLayer(t){for(const o of this.bucketLayerIDs)for(const l of o)if(t===l)return!0;return!1}getId(t,o){let l=t.id;return this.promoteId&&(l=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[o]],typeof l=="boolean"&&(l=Number(l))),l}}function O1(i,t,o,l,h){return vt(i,(m,_)=>{const b=t instanceof oc?t.get(_):null;return b&&b.evaluate?b.evaluate(o,l,h):b})}function N1(i){let t=1/0,o=1/0,l=-1/0,h=-1/0;for(const m of i)t=Math.min(t,m.x),o=Math.min(o,m.y),l=Math.max(l,m.x),h=Math.max(h,m.y);return{minX:t,minY:o,maxX:l,maxY:h}}function kI(i,t){return t-i}function $1(i,t,o,l,h){const m=[];for(let _=0;_<i.length;_++){const b=i[_];let S;for(let I=0;I<b.length-1;I++){let E=b[I],A=b[I+1];E.x<t&&A.x<t||(E.x<t?E=new j(t,E.y+(t-E.x)/(A.x-E.x)*(A.y-E.y))._round():A.x<t&&(A=new j(t,E.y+(t-E.x)/(A.x-E.x)*(A.y-E.y))._round()),E.y<o&&A.y<o||(E.y<o?E=new j(E.x+(o-E.y)/(A.y-E.y)*(A.x-E.x),o)._round():A.y<o&&(A=new j(E.x+(o-E.y)/(A.y-E.y)*(A.x-E.x),o)._round()),E.x>=l&&A.x>=l||(E.x>=l?E=new j(l,E.y+(l-E.x)/(A.x-E.x)*(A.y-E.y))._round():A.x>=l&&(A=new j(l,E.y+(l-E.x)/(A.x-E.x)*(A.y-E.y))._round()),E.y>=h&&A.y>=h||(E.y>=h?E=new j(E.x+(h-E.y)/(A.y-E.y)*(A.x-E.x),h)._round():A.y>=h&&(A=new j(E.x+(h-E.y)/(A.y-E.y)*(A.x-E.x),h)._round()),S&&E.equals(S[S.length-1])||(S=[E],m.push(S)),S.push(A)))))}}return m}Xe("FeatureIndex",F1,{omit:["rawTileData","sourceLayerCoder"]});class ca extends j{constructor(t,o,l,h){super(t,o),this.angle=l,h!==void 0&&(this.segment=h)}clone(){return new ca(this.x,this.y,this.angle,this.segment)}}function U1(i,t,o,l,h){if(t.segment===void 0||o===0)return!0;let m=t,_=t.segment+1,b=0;for(;b>-o/2;){if(_--,_<0)return!1;b-=i[_].dist(m),m=i[_]}b+=i[_].dist(i[_+1]),_++;const S=[];let I=0;for(;b<o/2;){const E=i[_],A=i[_+1];if(!A)return!1;let z=i[_-1].angleTo(E)-E.angleTo(A);for(z=Math.abs((z+3*Math.PI)%(2*Math.PI)-Math.PI),S.push({distance:b,angleDelta:z}),I+=z;b-S[0].distance>l;)I-=S.shift().angleDelta;if(I>h)return!1;_++,b+=E.dist(A)}return!0}function j1(i){let t=0;for(let o=0;o<i.length-1;o++)t+=i[o].dist(i[o+1]);return t}function V1(i,t,o){return i?.6*t*o:0}function q1(i,t){return Math.max(i?i.right-i.left:0,t?t.right-t.left:0)}function AI(i,t,o,l,h,m){const _=V1(o,h,m),b=q1(o,l)*m;let S=0;const I=j1(i)/2;for(let E=0;E<i.length-1;E++){const A=i[E],z=i[E+1],D=A.dist(z);if(S+D>I){const N=(I-S)/D,q=En.number(A.x,z.x,N),G=En.number(A.y,z.y,N),Q=new ca(q,G,z.angleTo(A),E);return Q._round(),!_||U1(i,Q,b,_,t)?Q:void 0}S+=D}}function PI(i,t,o,l,h,m,_,b,S){const I=V1(l,m,_),E=q1(l,h),A=E*_,z=i[0].x===0||i[0].x===S||i[0].y===0||i[0].y===S;return t-A<t/4&&(t=A+t/4),H1(i,z?t/2*b%t:(E/2+2*m)*_*b%t,t,I,o,A,z,!1,S)}function H1(i,t,o,l,h,m,_,b,S){const I=m/2,E=j1(i);let A=0,z=t-o,D=[];for(let N=0;N<i.length-1;N++){const q=i[N],G=i[N+1],Q=q.dist(G),de=G.angleTo(q);for(;z+o<A+Q;){z+=o;const ie=(z-A)/Q,ue=En.number(q.x,G.x,ie),ve=En.number(q.y,G.y,ie);if(ue>=0&&ue<S&&ve>=0&&ve<S&&z-I>=0&&z+I<=E){const ke=new ca(ue,ve,de,N);ke._round(),l&&!U1(i,ke,m,l,h)||D.push(ke)}}A+=Q}return b||D.length||_||(D=H1(i,A/2,o,l,h,m,_,!0,S)),D}Xe("Anchor",ca);const xc=ai;function W1(i,t,o,l){const h=[],m=i.image,_=m.pixelRatio,b=m.paddedRect.w-2*xc,S=m.paddedRect.h-2*xc;let I={x1:i.left,y1:i.top,x2:i.right,y2:i.bottom};const E=m.stretchX||[[0,b]],A=m.stretchY||[[0,S]],z=(Te,rt)=>Te+rt[1]-rt[0],D=E.reduce(z,0),N=A.reduce(z,0),q=b-D,G=S-N;let Q=0,de=D,ie=0,ue=N,ve=0,ke=q,Ne=0,lt=G;if(m.content&&l){const Te=m.content,rt=Te[2]-Te[0],Qe=Te[3]-Te[1];(m.textFitWidth||m.textFitHeight)&&(I=v1(i)),Q=Pp(E,0,Te[0]),ie=Pp(A,0,Te[1]),de=Pp(E,Te[0],Te[2]),ue=Pp(A,Te[1],Te[3]),ve=Te[0]-Q,Ne=Te[1]-ie,ke=rt-de,lt=Qe-ue}const Ue=I.x1,Oe=I.y1,et=I.x2-Ue,Ye=I.y2-Oe,Ze=(Te,rt,Qe,ft)=>{const Jt=Mp(Te.stretch-Q,de,et,Ue),Zt=zp(Te.fixed-ve,ke,Te.stretch,D),Qr=Mp(rt.stretch-ie,ue,Ye,Oe),to=zp(rt.fixed-Ne,lt,rt.stretch,N),_n=Mp(Qe.stretch-Q,de,et,Ue),Tr=zp(Qe.fixed-ve,ke,Qe.stretch,D),Hn=Mp(ft.stretch-ie,ue,Ye,Oe),Wn=zp(ft.fixed-Ne,lt,ft.stretch,N),Gn=new j(Jt,Qr),Cr=new j(_n,Qr),en=new j(_n,Hn),An=new j(Jt,Hn),vn=new j(Zt/_,to/_),Zn=new j(Tr/_,Wn/_),xn=t*Math.PI/180;if(xn){const Bt=Math.sin(xn),er=Math.cos(xn),lr=[er,-Bt,Bt,er];Gn._matMult(lr),Cr._matMult(lr),An._matMult(lr),en._matMult(lr)}const Di=Te.stretch+Te.fixed,li=rt.stretch+rt.fixed;return{tl:Gn,tr:Cr,bl:An,br:en,tex:{x:m.paddedRect.x+xc+Di,y:m.paddedRect.y+xc+li,w:Qe.stretch+Qe.fixed-Di,h:ft.stretch+ft.fixed-li},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:vn,pixelOffsetBR:Zn,minFontScaleX:ke/_/et,minFontScaleY:lt/_/Ye,isSDF:o}};if(l&&(m.stretchX||m.stretchY)){const Te=G1(E,q,D),rt=G1(A,G,N);for(let Qe=0;Qe<Te.length-1;Qe++){const ft=Te[Qe],Jt=Te[Qe+1];for(let Zt=0;Zt<rt.length-1;Zt++)h.push(Ze(ft,rt[Zt],Jt,rt[Zt+1]))}}else h.push(Ze({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:b+1},{fixed:0,stretch:S+1}));return h}function Pp(i,t,o){let l=0;for(const h of i)l+=Math.max(t,Math.min(o,h[1]))-Math.max(t,Math.min(o,h[0]));return l}function G1(i,t,o){const l=[{fixed:-xc,stretch:0}];for(const[h,m]of i){const _=l[l.length-1];l.push({fixed:h-_.stretch,stretch:_.stretch}),l.push({fixed:h-_.stretch,stretch:_.stretch+(m-h)})}return l.push({fixed:t+xc,stretch:o}),l}function Mp(i,t,o,l){return i/t*o+l}function zp(i,t,o,l){return i-t*o/l}class Lp{constructor(t,o,l,h,m,_,b,S,I,E){var A;if(this.boxStartIndex=t.length,I){let z=_.top,D=_.bottom;const N=_.collisionPadding;N&&(z-=N[1],D+=N[3]);let q=D-z;q>0&&(q=Math.max(10,q),this.circleDiameter=q)}else{const z=!((A=_.image)===null||A===void 0)&&A.content&&(_.image.textFitWidth||_.image.textFitHeight)?v1(_):{x1:_.left,y1:_.top,x2:_.right,y2:_.bottom};z.y1=z.y1*b-S[0],z.y2=z.y2*b+S[2],z.x1=z.x1*b-S[3],z.x2=z.x2*b+S[1];const D=_.collisionPadding;if(D&&(z.x1-=D[0]*b,z.y1-=D[1]*b,z.x2+=D[2]*b,z.y2+=D[3]*b),E){const N=new j(z.x1,z.y1),q=new j(z.x2,z.y1),G=new j(z.x1,z.y2),Q=new j(z.x2,z.y2),de=E*Math.PI/180;N._rotate(de),q._rotate(de),G._rotate(de),Q._rotate(de),z.x1=Math.min(N.x,q.x,G.x,Q.x),z.x2=Math.max(N.x,q.x,G.x,Q.x),z.y1=Math.min(N.y,q.y,G.y,Q.y),z.y2=Math.max(N.y,q.y,G.y,Q.y)}t.emplaceBack(o.x,o.y,z.x1,z.y1,z.x2,z.y2,l,h,m)}this.boxEndIndex=t.length}}class MI{constructor(t=[],o=zI){if(this.data=t,this.length=this.data.length,this.compare=o,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const t=this.data[0],o=this.data.pop();return this.length--,this.length>0&&(this.data[0]=o,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:o,compare:l}=this,h=o[t];for(;t>0;){const m=t-1>>1,_=o[m];if(l(h,_)>=0)break;o[t]=_,t=m}o[t]=h}_down(t){const{data:o,compare:l}=this,h=this.length>>1,m=o[t];for(;t<h;){let _=1+(t<<1),b=o[_];const S=_+1;if(S<this.length&&l(o[S],b)<0&&(_=S,b=o[S]),l(b,m)>=0)break;o[t]=b,t=_}o[t]=m}}function zI(i,t){return i<t?-1:i>t?1:0}function LI(i,t=1,o=!1){let l=1/0,h=1/0,m=-1/0,_=-1/0;const b=i[0];for(let D=0;D<b.length;D++){const N=b[D];(!D||N.x<l)&&(l=N.x),(!D||N.y<h)&&(h=N.y),(!D||N.x>m)&&(m=N.x),(!D||N.y>_)&&(_=N.y)}const S=Math.min(m-l,_-h);let I=S/2;const E=new MI([],RI);if(S===0)return new j(l,h);for(let D=l;D<m;D+=S)for(let N=h;N<_;N+=S)E.push(new bc(D+I,N+I,I,i));let A=function(D){let N=0,q=0,G=0;const Q=D[0];for(let de=0,ie=Q.length,ue=ie-1;de<ie;ue=de++){const ve=Q[de],ke=Q[ue],Ne=ve.x*ke.y-ke.x*ve.y;q+=(ve.x+ke.x)*Ne,G+=(ve.y+ke.y)*Ne,N+=3*Ne}return new bc(q/N,G/N,0,D)}(i),z=E.length;for(;E.length;){const D=E.pop();(D.d>A.d||!A.d)&&(A=D,o&&console.log("found best %d after %d probes",Math.round(1e4*D.d)/1e4,z)),D.max-A.d<=t||(I=D.h/2,E.push(new bc(D.p.x-I,D.p.y-I,I,i)),E.push(new bc(D.p.x+I,D.p.y-I,I,i)),E.push(new bc(D.p.x-I,D.p.y+I,I,i)),E.push(new bc(D.p.x+I,D.p.y+I,I,i)),z+=4)}return o&&(console.log(`num probes: ${z}`),console.log(`best distance: ${A.d}`)),A.p}function RI(i,t){return t.max-i.max}function bc(i,t,o,l){this.p=new j(i,t),this.h=o,this.d=function(h,m){let _=!1,b=1/0;for(let S=0;S<m.length;S++){const I=m[S];for(let E=0,A=I.length,z=A-1;E<A;z=E++){const D=I[E],N=I[z];D.y>h.y!=N.y>h.y&&h.x<(N.x-D.x)*(h.y-D.y)/(N.y-D.y)+D.x&&(_=!_),b=Math.min(b,Pv(h,D,N))}}return(_?1:-1)*Math.sqrt(b)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}var yn;v.aq=void 0,(yn=v.aq||(v.aq={}))[yn.center=1]="center",yn[yn.left=2]="left",yn[yn.right=3]="right",yn[yn.top=4]="top",yn[yn.bottom=5]="bottom",yn[yn["top-left"]=6]="top-left",yn[yn["top-right"]=7]="top-right",yn[yn["bottom-left"]=8]="bottom-left",yn[yn["bottom-right"]=9]="bottom-right";const ua=7,Yg=Number.POSITIVE_INFINITY;function Z1(i,t){return t[1]!==Yg?function(o,l,h){let m=0,_=0;switch(l=Math.abs(l),h=Math.abs(h),o){case"top-right":case"top-left":case"top":_=h-ua;break;case"bottom-right":case"bottom-left":case"bottom":_=-h+ua}switch(o){case"top-right":case"bottom-right":case"right":m=-l;break;case"top-left":case"bottom-left":case"left":m=l}return[m,_]}(i,t[0],t[1]):function(o,l){let h=0,m=0;l<0&&(l=0);const _=l/Math.SQRT2;switch(o){case"top-right":case"top-left":m=_-ua;break;case"bottom-right":case"bottom-left":m=-_+ua;break;case"bottom":m=-l+ua;break;case"top":m=l-ua}switch(o){case"top-right":case"bottom-right":h=-_;break;case"top-left":case"bottom-left":h=_;break;case"left":h=l;break;case"right":h=-l}return[h,m]}(i,t[0])}function K1(i,t,o){var l;const h=i.layout,m=(l=h.get("text-variable-anchor-offset"))===null||l===void 0?void 0:l.evaluate(t,{},o);if(m){const b=m.values,S=[];for(let I=0;I<b.length;I+=2){const E=S[I]=b[I],A=b[I+1].map(z=>z*qr);E.startsWith("top")?A[1]-=ua:E.startsWith("bottom")&&(A[1]+=ua),S[I+1]=A}return new Un(S)}const _=h.get("text-variable-anchor");if(_){let b;b=i._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[h.get("text-radial-offset").evaluate(t,{},o)*qr,Yg]:h.get("text-offset").evaluate(t,{},o).map(I=>I*qr);const S=[];for(const I of _)S.push(I,Z1(I,b));return new Un(S)}return null}function Jg(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function DI(i,t,o,l,h,m,_,b,S,I,E){let A=m.textMaxSize.evaluate(t,{});A===void 0&&(A=_);const z=i.layers[0].layout,D=z.get("icon-offset").evaluate(t,{},E),N=Y1(o.horizontal),q=_/24,G=i.tilePixelRatio*q,Q=i.tilePixelRatio*A/24,de=i.tilePixelRatio*b,ie=i.tilePixelRatio*z.get("symbol-spacing"),ue=z.get("text-padding")*i.tilePixelRatio,ve=function(Te,rt,Qe,ft=1){const Jt=Te.get("icon-padding").evaluate(rt,{},Qe),Zt=Jt&&Jt.values;return[Zt[0]*ft,Zt[1]*ft,Zt[2]*ft,Zt[3]*ft]}(z,t,E,i.tilePixelRatio),ke=z.get("text-max-angle")/180*Math.PI,Ne=z.get("text-rotation-alignment")!=="viewport"&&z.get("symbol-placement")!=="point",lt=z.get("icon-rotation-alignment")==="map"&&z.get("symbol-placement")!=="point",Ue=z.get("symbol-placement"),Oe=ie/2,et=z.get("icon-text-fit");let Ye;l&&et!=="none"&&(i.allowVerticalPlacement&&o.vertical&&(Ye=x1(l,o.vertical,et,z.get("icon-text-fit-padding"),D,q)),N&&(l=x1(l,N,et,z.get("icon-text-fit-padding"),D,q)));const Ze=(Te,rt)=>{rt.x<0||rt.x>=Fr||rt.y<0||rt.y>=Fr||function(Qe,ft,Jt,Zt,Qr,to,_n,Tr,Hn,Wn,Gn,Cr,en,An,vn,Zn,xn,Di,li,Bt,er,lr,_i,gr,wc){const Zo=Qe.addToLineVertexArray(ft,Jt);let Ko,ro,Bi,an,Cs=0,wh=0,tx=0,rx=0,sy=-1,ay=-1;const Is={};let nx=uc("");if(Qe.allowVerticalPlacement&&Zt.vertical){const Pn=Tr.layout.get("text-rotate").evaluate(er,{},gr)+90;Bi=new Lp(Hn,ft,Wn,Gn,Cr,Zt.vertical,en,An,vn,Pn),_n&&(an=new Lp(Hn,ft,Wn,Gn,Cr,_n,xn,Di,vn,Pn))}if(Qr){const Pn=Tr.layout.get("icon-rotate").evaluate(er,{}),Fi=Tr.layout.get("icon-text-fit")!=="none",al=W1(Qr,Pn,_i,Fi),Eo=_n?W1(_n,Pn,_i,Fi):void 0;ro=new Lp(Hn,ft,Wn,Gn,Cr,Qr,xn,Di,!1,Pn),Cs=4*al.length;const ll=Qe.iconSizeData;let Xo=null;ll.kind==="source"?(Xo=[Go*Tr.layout.get("icon-size").evaluate(er,{})],Xo[0]>aa&&Et(`${Qe.layerIds[0]}: Value for "icon-size" is >= ${_h}. Reduce your "icon-size".`)):ll.kind==="composite"&&(Xo=[Go*lr.compositeIconSizes[0].evaluate(er,{},gr),Go*lr.compositeIconSizes[1].evaluate(er,{},gr)],(Xo[0]>aa||Xo[1]>aa)&&Et(`${Qe.layerIds[0]}: Value for "icon-size" is >= ${_h}. Reduce your "icon-size".`)),Qe.addSymbols(Qe.icon,al,Xo,Bt,li,er,v.ah.none,ft,Zo.lineStartIndex,Zo.lineLength,-1,gr),sy=Qe.icon.placedSymbolArray.length-1,Eo&&(wh=4*Eo.length,Qe.addSymbols(Qe.icon,Eo,Xo,Bt,li,er,v.ah.vertical,ft,Zo.lineStartIndex,Zo.lineLength,-1,gr),ay=Qe.icon.placedSymbolArray.length-1)}const ix=Object.keys(Zt.horizontal);for(const Pn of ix){const Fi=Zt.horizontal[Pn];if(!Ko){nx=uc(Fi.text);const Eo=Tr.layout.get("text-rotate").evaluate(er,{},gr);Ko=new Lp(Hn,ft,Wn,Gn,Cr,Fi,en,An,vn,Eo)}const al=Fi.positionedLines.length===1;if(tx+=X1(Qe,ft,Fi,to,Tr,vn,er,Zn,Zo,Zt.vertical?v.ah.horizontal:v.ah.horizontalOnly,al?ix:[Pn],Is,sy,lr,gr),al)break}Zt.vertical&&(rx+=X1(Qe,ft,Zt.vertical,to,Tr,vn,er,Zn,Zo,v.ah.vertical,["vertical"],Is,ay,lr,gr));const OI=Ko?Ko.boxStartIndex:Qe.collisionBoxArray.length,NI=Ko?Ko.boxEndIndex:Qe.collisionBoxArray.length,$I=Bi?Bi.boxStartIndex:Qe.collisionBoxArray.length,UI=Bi?Bi.boxEndIndex:Qe.collisionBoxArray.length,jI=ro?ro.boxStartIndex:Qe.collisionBoxArray.length,VI=ro?ro.boxEndIndex:Qe.collisionBoxArray.length,qI=an?an.boxStartIndex:Qe.collisionBoxArray.length,HI=an?an.boxEndIndex:Qe.collisionBoxArray.length;let Io=-1;const Dp=(Pn,Fi)=>Pn&&Pn.circleDiameter?Math.max(Pn.circleDiameter,Fi):Fi;Io=Dp(Ko,Io),Io=Dp(Bi,Io),Io=Dp(ro,Io),Io=Dp(an,Io);const ox=Io>-1?1:0;ox&&(Io*=wc/qr),Qe.glyphOffsetArray.length>=vc.MAX_GLYPHS&&Et("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),er.sortKey!==void 0&&Qe.addToSortKeyRanges(Qe.symbolInstances.length,er.sortKey);const WI=K1(Tr,er,gr),[GI,ZI]=function(Pn,Fi){const al=Pn.length,Eo=Fi==null?void 0:Fi.values;if((Eo==null?void 0:Eo.length)>0)for(let ll=0;ll<Eo.length;ll+=2){const Xo=Eo[ll+1];Pn.emplaceBack(v.aq[Eo[ll]],Xo[0],Xo[1])}return[al,Pn.length]}(Qe.textAnchorOffsets,WI);Qe.symbolInstances.emplaceBack(ft.x,ft.y,Is.right>=0?Is.right:-1,Is.center>=0?Is.center:-1,Is.left>=0?Is.left:-1,Is.vertical||-1,sy,ay,nx,OI,NI,$I,UI,jI,VI,qI,HI,Wn,tx,rx,Cs,wh,ox,0,en,Io,GI,ZI)}(i,rt,Te,o,l,h,Ye,i.layers[0],i.collisionBoxArray,t.index,t.sourceLayerIndex,i.index,G,[ue,ue,ue,ue],Ne,S,de,ve,lt,D,t,m,I,E,_)};if(Ue==="line")for(const Te of $1(t.geometry,0,0,Fr,Fr)){const rt=PI(Te,ie,ke,o.vertical||N,l,24,Q,i.overscaling,Fr);for(const Qe of rt)N&&BI(i,N.text,Oe,Qe)||Ze(Te,Qe)}else if(Ue==="line-center"){for(const Te of t.geometry)if(Te.length>1){const rt=AI(Te,ke,o.vertical||N,l,24,Q);rt&&Ze(Te,rt)}}else if(t.type==="Polygon")for(const Te of Ol(t.geometry,0)){const rt=LI(Te,16);Ze(Te[0],new ca(rt.x,rt.y,0))}else if(t.type==="LineString")for(const Te of t.geometry)Ze(Te,new ca(Te[0].x,Te[0].y,0));else if(t.type==="Point")for(const Te of t.geometry)for(const rt of Te)Ze([rt],new ca(rt.x,rt.y,0))}function X1(i,t,o,l,h,m,_,b,S,I,E,A,z,D,N){const q=function(de,ie,ue,ve,ke,Ne,lt,Ue){const Oe=ve.layout.get("text-rotate").evaluate(Ne,{})*Math.PI/180,et=[];for(const Ye of ie.positionedLines)for(const Ze of Ye.positionedGlyphs){if(!Ze.rect)continue;const Te=Ze.rect||{};let rt=d1+1,Qe=!0,ft=1,Jt=0;const Zt=(ke||Ue)&&Ze.vertical,Qr=Ze.metrics.advance*Ze.scale/2;if(Ue&&ie.verticalizable&&(Jt=Ye.lineOffset/2-(Ze.imageName?-(qr-Ze.metrics.width*Ze.scale)/2:(Ze.scale-1)*qr)),Ze.imageName){const Bt=lt[Ze.imageName];Qe=Bt.sdf,ft=Bt.pixelRatio,rt=ai/ft}const to=ke?[Ze.x+Qr,Ze.y]:[0,0];let _n=ke?[0,0]:[Ze.x+Qr+ue[0],Ze.y+ue[1]-Jt],Tr=[0,0];Zt&&(Tr=_n,_n=[0,0]);const Hn=Ze.metrics.isDoubleResolution?2:1,Wn=(Ze.metrics.left-rt)*Ze.scale-Qr+_n[0],Gn=(-Ze.metrics.top-rt)*Ze.scale+_n[1],Cr=Wn+Te.w/Hn*Ze.scale/ft,en=Gn+Te.h/Hn*Ze.scale/ft,An=new j(Wn,Gn),vn=new j(Cr,Gn),Zn=new j(Wn,en),xn=new j(Cr,en);if(Zt){const Bt=new j(-Qr,Qr-gh),er=-Math.PI/2,lr=qr/2-Qr,_i=new j(5-gh-lr,-(Ze.imageName?lr:0)),gr=new j(...Tr);An._rotateAround(er,Bt)._add(_i)._add(gr),vn._rotateAround(er,Bt)._add(_i)._add(gr),Zn._rotateAround(er,Bt)._add(_i)._add(gr),xn._rotateAround(er,Bt)._add(_i)._add(gr)}if(Oe){const Bt=Math.sin(Oe),er=Math.cos(Oe),lr=[er,-Bt,Bt,er];An._matMult(lr),vn._matMult(lr),Zn._matMult(lr),xn._matMult(lr)}const Di=new j(0,0),li=new j(0,0);et.push({tl:An,tr:vn,bl:Zn,br:xn,tex:Te,writingMode:ie.writingMode,glyphOffset:to,sectionIndex:Ze.sectionIndex,isSDF:Qe,pixelOffsetTL:Di,pixelOffsetBR:li,minFontScaleX:0,minFontScaleY:0})}return et}(0,o,b,h,m,_,l,i.allowVerticalPlacement),G=i.textSizeData;let Q=null;G.kind==="source"?(Q=[Go*h.layout.get("text-size").evaluate(_,{})],Q[0]>aa&&Et(`${i.layerIds[0]}: Value for "text-size" is >= ${_h}. Reduce your "text-size".`)):G.kind==="composite"&&(Q=[Go*D.compositeTextSizes[0].evaluate(_,{},N),Go*D.compositeTextSizes[1].evaluate(_,{},N)],(Q[0]>aa||Q[1]>aa)&&Et(`${i.layerIds[0]}: Value for "text-size" is >= ${_h}. Reduce your "text-size".`)),i.addSymbols(i.text,q,Q,b,m,_,I,t,S.lineStartIndex,S.lineLength,z,N);for(const de of E)A[de]=i.text.placedSymbolArray.length-1;return 4*q.length}function Y1(i){for(const t in i)return i[t];return null}function BI(i,t,o,l){const h=i.compareText;if(t in h){const m=h[t];for(let _=m.length-1;_>=0;_--)if(l.dist(m[_])<o)return!0}else h[t]=[];return h[t].push(l),!1}const J1=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Qg{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[o,l]=new Uint8Array(t,0,2);if(o!==219)throw new Error("Data does not appear to be in a KDBush format.");const h=l>>4;if(h!==1)throw new Error(`Got v${h} data when expected v1.`);const m=J1[15&l];if(!m)throw new Error("Unrecognized array type.");const[_]=new Uint16Array(t,2,1),[b]=new Uint32Array(t,4,1);return new Qg(b,_,m,t)}constructor(t,o=64,l=Float64Array,h){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+o,2),65535),this.ArrayType=l,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const m=J1.indexOf(this.ArrayType),_=2*t*this.ArrayType.BYTES_PER_ELEMENT,b=t*this.IndexArrayType.BYTES_PER_ELEMENT,S=(8-b%8)%8;if(m<0)throw new Error(`Unexpected typed array class: ${l}.`);h&&h instanceof ArrayBuffer?(this.data=h,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+b+S,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+_+b+S),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+b+S,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+m]),new Uint16Array(this.data,2,1)[0]=o,new Uint32Array(this.data,4,1)[0]=t)}add(t,o){const l=this._pos>>1;return this.ids[l]=l,this.coords[this._pos++]=t,this.coords[this._pos++]=o,l}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return ey(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,o,l,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:_,nodeSize:b}=this,S=[0,m.length-1,0],I=[];for(;S.length;){const E=S.pop()||0,A=S.pop()||0,z=S.pop()||0;if(A-z<=b){for(let G=z;G<=A;G++){const Q=_[2*G],de=_[2*G+1];Q>=t&&Q<=l&&de>=o&&de<=h&&I.push(m[G])}continue}const D=z+A>>1,N=_[2*D],q=_[2*D+1];N>=t&&N<=l&&q>=o&&q<=h&&I.push(m[D]),(E===0?t<=N:o<=q)&&(S.push(z),S.push(D-1),S.push(1-E)),(E===0?l>=N:h>=q)&&(S.push(D+1),S.push(A),S.push(1-E))}return I}within(t,o,l){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:m,nodeSize:_}=this,b=[0,h.length-1,0],S=[],I=l*l;for(;b.length;){const E=b.pop()||0,A=b.pop()||0,z=b.pop()||0;if(A-z<=_){for(let G=z;G<=A;G++)ex(m[2*G],m[2*G+1],t,o)<=I&&S.push(h[G]);continue}const D=z+A>>1,N=m[2*D],q=m[2*D+1];ex(N,q,t,o)<=I&&S.push(h[D]),(E===0?t-l<=N:o-l<=q)&&(b.push(z),b.push(D-1),b.push(1-E)),(E===0?t+l>=N:o+l>=q)&&(b.push(D+1),b.push(A),b.push(1-E))}return S}}function ey(i,t,o,l,h,m){if(h-l<=o)return;const _=l+h>>1;Q1(i,t,_,l,h,m),ey(i,t,o,l,_-1,1-m),ey(i,t,o,_+1,h,1-m)}function Q1(i,t,o,l,h,m){for(;h>l;){if(h-l>600){const I=h-l+1,E=o-l+1,A=Math.log(I),z=.5*Math.exp(2*A/3),D=.5*Math.sqrt(A*z*(I-z)/I)*(E-I/2<0?-1:1);Q1(i,t,o,Math.max(l,Math.floor(o-E*z/I+D)),Math.min(h,Math.floor(o+(I-E)*z/I+D)),m)}const _=t[2*o+m];let b=l,S=h;for(xh(i,t,l,o),t[2*h+m]>_&&xh(i,t,l,h);b<S;){for(xh(i,t,b,S),b++,S--;t[2*b+m]<_;)b++;for(;t[2*S+m]>_;)S--}t[2*l+m]===_?xh(i,t,l,S):(S++,xh(i,t,S,h)),S<=o&&(l=S+1),o<=S&&(h=S-1)}}function xh(i,t,o,l){ty(i,o,l),ty(t,2*o,2*l),ty(t,2*o+1,2*l+1)}function ty(i,t,o){const l=i[t];i[t]=i[o],i[o]=l}function ex(i,t,o,l){const h=i-o,m=t-l;return h*h+m*m}var ry;v.be=void 0,(ry=v.be||(v.be={})).create="create",ry.load="load",ry.fullLoad="fullLoad";let Rp=null,bh=[];const ny=1e3/60,iy="loadTime",oy="fullLoadTime",FI={mark(i){performance.mark(i)},frame(i){const t=i;Rp!=null&&bh.push(t-Rp),Rp=t},clearMetrics(){Rp=null,bh=[],performance.clearMeasures(iy),performance.clearMeasures(oy);for(const i in v.be)performance.clearMarks(v.be[i])},getPerformanceMetrics(){performance.measure(iy,v.be.create,v.be.load),performance.measure(oy,v.be.create,v.be.fullLoad);const i=performance.getEntriesByName(iy)[0].duration,t=performance.getEntriesByName(oy)[0].duration,o=bh.length,l=1/(bh.reduce((m,_)=>m+_,0)/o/1e3),h=bh.filter(m=>m>ny).reduce((m,_)=>m+(_-ny)/ny,0);return{loadTime:i,fullLoadTime:t,fps:l,percentDroppedFrames:h/(o+h)*100,totalFrames:o}}};v.$=Vr,v.A=pc,v.B=function(i){if(vr==null){const t=i.navigator?i.navigator.userAgent:null;vr=!!i.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return vr},v.C=class{constructor(i,t){this.target=i,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new EI(()=>this.process()),this.subscription=function(o,l,h,m){return o.addEventListener(l,h,!1),{unsubscribe:()=>{o.removeEventListener(l,h,!1)}}}(this.target,"message",o=>this.receive(o)),this.globalScope=kr(self)?i:window}registerMessageHandler(i,t){this.messageHandlers[i]=t}sendAsync(i,t){return new Promise((o,l)=>{const h=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[h]={resolve:o,reject:l},t&&t.signal.addEventListener("abort",()=>{delete this.resolveRejects[h];const b={id:h,type:"<cancel>",origin:location.origin,targetMapId:i.targetMapId,sourceMapId:this.mapId};this.target.postMessage(b)},{once:!0});const m=[],_=Object.assign(Object.assign({},i),{id:h,sourceMapId:this.mapId,origin:location.origin,data:el(i.data,m)});this.target.postMessage(_,{transfer:m})})}receive(i){const t=i.data,o=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[o];const l=this.abortControllers[o];return delete this.abortControllers[o],void(l&&l.abort())}if(kr(self)||t.mustQueue)return this.tasks[o]=t,this.taskQueue.push(o),void this.invoker.trigger();this.processTask(o,t)}}process(){if(this.taskQueue.length===0)return;const i=this.taskQueue.shift(),t=this.tasks[i];delete this.tasks[i],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(i,t)}processTask(i,t){return d(this,void 0,void 0,function*(){if(t.type==="<response>"){const h=this.resolveRejects[i];return delete this.resolveRejects[i],h?void(t.error?h.reject(Qi(t.error)):h.resolve(Qi(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(i,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const o=Qi(t.data),l=new AbortController;this.abortControllers[i]=l;try{const h=yield this.messageHandlers[t.type](t.sourceMapId,o,l);this.completeTask(i,null,h)}catch(h){this.completeTask(i,h)}})}completeTask(i,t,o){const l=[];delete this.abortControllers[i];const h={id:i,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?el(t):null,data:el(o,l)};this.target.postMessage(h,{transfer:l})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},v.D=tt,v.E=Bo,v.F=function(){var i=new pc(16);return pc!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},v.G=Ar,v.H=function(i,t,o){var l,h,m,_,b,S,I,E,A,z,D,N,q=o[0],G=o[1],Q=o[2];return t===i?(i[12]=t[0]*q+t[4]*G+t[8]*Q+t[12],i[13]=t[1]*q+t[5]*G+t[9]*Q+t[13],i[14]=t[2]*q+t[6]*G+t[10]*Q+t[14],i[15]=t[3]*q+t[7]*G+t[11]*Q+t[15]):(h=t[1],m=t[2],_=t[3],b=t[4],S=t[5],I=t[6],E=t[7],A=t[8],z=t[9],D=t[10],N=t[11],i[0]=l=t[0],i[1]=h,i[2]=m,i[3]=_,i[4]=b,i[5]=S,i[6]=I,i[7]=E,i[8]=A,i[9]=z,i[10]=D,i[11]=N,i[12]=l*q+b*G+A*Q+t[12],i[13]=h*q+S*G+z*Q+t[13],i[14]=m*q+I*G+D*Q+t[14],i[15]=_*q+E*G+N*Q+t[15]),i},v.I=$g,v.J=function(i,t,o){var l=o[0],h=o[1],m=o[2];return i[0]=t[0]*l,i[1]=t[1]*l,i[2]=t[2]*l,i[3]=t[3]*l,i[4]=t[4]*h,i[5]=t[5]*h,i[6]=t[6]*h,i[7]=t[7]*h,i[8]=t[8]*m,i[9]=t[9]*m,i[10]=t[10]*m,i[11]=t[11]*m,i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i},v.K=Rv,v.L=function(i,t){const o={};for(let l=0;l<t.length;l++){const h=t[l];h in i&&(o[h]=i[h])}return o},v.M=la,v.N=A1,v.O=P1,v.P=j,v.Q=Ri,v.R=Li,v.S=re,v.T=Qs,v.U=ee,v.V=mt,v.W=Fr,v.X=k,v.Y=Ap,v.Z=class extends V{},v._=d,v.a=xr,v.a$=function(i,t){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i},v.a0=Xg,v.a1=Re,v.a2=i=>{const t=window.document.createElement("video");return t.muted=!0,new Promise(o=>{t.onloadstart=()=>{o(t)};for(const l of i){const h=window.document.createElement("source");Do(l)||(t.crossOrigin="Anonymous"),h.src=l,t.appendChild(h)}})},v.a3=function(){return Ke++},v.a4=Tt,v.a5=vc,v.a6=$u,v.a7=ol,v.a8=Qt,v.a9=B1,v.aA=function(i){if(i.type==="custom")return new II(i);switch(i.type){case"background":return new SI(i);case"circle":return new uC(i);case"fill":return new EC(i);case"fill-extrusion":return new jC(i);case"heatmap":return new dC(i);case"hillshade":return new fC(i);case"line":return new XC(i);case"raster":return new CI(i);case"symbol":return new kp(i)}},v.aB=st,v.aC=function(i,t){if(!i)return[{command:"setStyle",args:[t]}];let o=[];try{if(!Rt(i.version,t.version))return[{command:"setStyle",args:[t]}];Rt(i.center,t.center)||o.push({command:"setCenter",args:[t.center]}),Rt(i.zoom,t.zoom)||o.push({command:"setZoom",args:[t.zoom]}),Rt(i.bearing,t.bearing)||o.push({command:"setBearing",args:[t.bearing]}),Rt(i.pitch,t.pitch)||o.push({command:"setPitch",args:[t.pitch]}),Rt(i.sprite,t.sprite)||o.push({command:"setSprite",args:[t.sprite]}),Rt(i.glyphs,t.glyphs)||o.push({command:"setGlyphs",args:[t.glyphs]}),Rt(i.transition,t.transition)||o.push({command:"setTransition",args:[t.transition]}),Rt(i.light,t.light)||o.push({command:"setLight",args:[t.light]}),Rt(i.terrain,t.terrain)||o.push({command:"setTerrain",args:[t.terrain]}),Rt(i.sky,t.sky)||o.push({command:"setSky",args:[t.sky]}),Rt(i.projection,t.projection)||o.push({command:"setProjection",args:[t.projection]});const l={},h=[];(function(_,b,S,I){let E;for(E in b=b||{},_=_||{})Object.prototype.hasOwnProperty.call(_,E)&&(Object.prototype.hasOwnProperty.call(b,E)||Fo(E,S,I));for(E in b)Object.prototype.hasOwnProperty.call(b,E)&&(Object.prototype.hasOwnProperty.call(_,E)?Rt(_[E],b[E])||(_[E].type==="geojson"&&b[E].type==="geojson"&&ki(_,b,E)?Ht(S,{command:"setGeoJSONSourceData",args:[E,b[E].data]}):cs(E,b,S,I)):ei(E,b,S))})(i.sources,t.sources,h,l);const m=[];i.layers&&i.layers.forEach(_=>{"source"in _&&l[_.source]?o.push({command:"removeLayer",args:[_.id]}):m.push(_)}),o=o.concat(h),function(_,b,S){b=b||[];const I=(_=_||[]).map(Oo),E=b.map(Oo),A=_.reduce(us,{}),z=b.reduce(us,{}),D=I.slice(),N=Object.create(null);let q,G,Q,de,ie;for(let ue=0,ve=0;ue<I.length;ue++)q=I[ue],Object.prototype.hasOwnProperty.call(z,q)?ve++:(Ht(S,{command:"removeLayer",args:[q]}),D.splice(D.indexOf(q,ve),1));for(let ue=0,ve=0;ue<E.length;ue++)q=E[E.length-1-ue],D[D.length-1-ue]!==q&&(Object.prototype.hasOwnProperty.call(A,q)?(Ht(S,{command:"removeLayer",args:[q]}),D.splice(D.lastIndexOf(q,D.length-ve),1)):ve++,de=D[D.length-ue],Ht(S,{command:"addLayer",args:[z[q],de]}),D.splice(D.length-ue,0,q),N[q]=!0);for(let ue=0;ue<E.length;ue++)if(q=E[ue],G=A[q],Q=z[q],!N[q]&&!Rt(G,Q))if(Rt(G.source,Q.source)&&Rt(G["source-layer"],Q["source-layer"])&&Rt(G.type,Q.type)){for(ie in Tn(G.layout,Q.layout,S,q,null,"setLayoutProperty"),Tn(G.paint,Q.paint,S,q,null,"setPaintProperty"),Rt(G.filter,Q.filter)||Ht(S,{command:"setFilter",args:[q,Q.filter]}),Rt(G.minzoom,Q.minzoom)&&Rt(G.maxzoom,Q.maxzoom)||Ht(S,{command:"setLayerZoomRange",args:[q,Q.minzoom,Q.maxzoom]}),G)Object.prototype.hasOwnProperty.call(G,ie)&&ie!=="layout"&&ie!=="paint"&&ie!=="filter"&&ie!=="metadata"&&ie!=="minzoom"&&ie!=="maxzoom"&&(ie.indexOf("paint.")===0?Tn(G[ie],Q[ie],S,q,ie.slice(6),"setPaintProperty"):Rt(G[ie],Q[ie])||Ht(S,{command:"setLayerProperty",args:[q,ie,Q[ie]]}));for(ie in Q)Object.prototype.hasOwnProperty.call(Q,ie)&&!Object.prototype.hasOwnProperty.call(G,ie)&&ie!=="layout"&&ie!=="paint"&&ie!=="filter"&&ie!=="metadata"&&ie!=="minzoom"&&ie!=="maxzoom"&&(ie.indexOf("paint.")===0?Tn(G[ie],Q[ie],S,q,ie.slice(6),"setPaintProperty"):Rt(G[ie],Q[ie])||Ht(S,{command:"setLayerProperty",args:[q,ie,Q[ie]]}))}else Ht(S,{command:"removeLayer",args:[q]}),de=D[D.lastIndexOf(q)+1],Ht(S,{command:"addLayer",args:[Q,de]})}(m,t.layers,o)}catch(l){console.warn("Unable to compute style diff:",l),o=[{command:"setStyle",args:[t]}]}return o},v.aD=function(i){const t=[],o=i.id;return o===void 0&&t.push({message:`layers.${o}: missing required property "id"`}),i.render===void 0&&t.push({message:`layers.${o}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&t.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),t},v.aE=function i(t,o){if(Array.isArray(t)){if(!Array.isArray(o)||t.length!==o.length)return!1;for(let l=0;l<t.length;l++)if(!i(t[l],o[l]))return!1;return!0}if(typeof t=="object"&&t!==null&&o!==null){if(typeof o!="object"||Object.keys(t).length!==Object.keys(o).length)return!1;for(const l in t)if(!i(t[l],o[l]))return!1;return!0}return t===o},v.aF=vt,v.aG=ot,v.aH=class extends rl{constructor(i,t){super(i,t),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},v.aI=fp,v.aJ=class extends rl{constructor(i,t){super(i,t),this.current=rC}set(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let t=1;t<16;t++)if(i[t]!==this.current[t]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}},v.aK=Sv,v.aL=class extends rl{constructor(i,t){super(i,t),this.current=[0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))}},v.aM=class extends rl{constructor(i,t){super(i,t),this.current=[0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))}},v.aN=Tv,v.aO=function(i,t,o,l,h,m,_){var b=1/(t-o),S=1/(l-h),I=1/(m-_);return i[0]=-2*b,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*S,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*I,i[11]=0,i[12]=(t+o)*b,i[13]=(h+l)*S,i[14]=(_+m)*I,i[15]=1,i},v.aP=Vt,v.aQ=cC,v.aR=class extends Ce{},v.aS=eI,v.aT=class extends He{},v.aU=function(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))},v.aV=Nv,v.aW=bs,v.aX=class extends $e{},v.aY=Jr,v.aZ=function(i,t){return i[0]===t[0]&&i[1]===t[1]&&i[2]===t[2]&&i[3]===t[3]&&i[4]===t[4]&&i[5]===t[5]&&i[6]===t[6]&&i[7]===t[7]&&i[8]===t[8]&&i[9]===t[9]&&i[10]===t[10]&&i[11]===t[11]&&i[12]===t[12]&&i[13]===t[13]&&i[14]===t[14]&&i[15]===t[15]},v.a_=function(i,t){var o=i[0],l=i[1],h=i[2],m=i[3],_=i[4],b=i[5],S=i[6],I=i[7],E=i[8],A=i[9],z=i[10],D=i[11],N=i[12],q=i[13],G=i[14],Q=i[15],de=t[0],ie=t[1],ue=t[2],ve=t[3],ke=t[4],Ne=t[5],lt=t[6],Ue=t[7],Oe=t[8],et=t[9],Ye=t[10],Ze=t[11],Te=t[12],rt=t[13],Qe=t[14],ft=t[15];return Math.abs(o-de)<=qn*Math.max(1,Math.abs(o),Math.abs(de))&&Math.abs(l-ie)<=qn*Math.max(1,Math.abs(l),Math.abs(ie))&&Math.abs(h-ue)<=qn*Math.max(1,Math.abs(h),Math.abs(ue))&&Math.abs(m-ve)<=qn*Math.max(1,Math.abs(m),Math.abs(ve))&&Math.abs(_-ke)<=qn*Math.max(1,Math.abs(_),Math.abs(ke))&&Math.abs(b-Ne)<=qn*Math.max(1,Math.abs(b),Math.abs(Ne))&&Math.abs(S-lt)<=qn*Math.max(1,Math.abs(S),Math.abs(lt))&&Math.abs(I-Ue)<=qn*Math.max(1,Math.abs(I),Math.abs(Ue))&&Math.abs(E-Oe)<=qn*Math.max(1,Math.abs(E),Math.abs(Oe))&&Math.abs(A-et)<=qn*Math.max(1,Math.abs(A),Math.abs(et))&&Math.abs(z-Ye)<=qn*Math.max(1,Math.abs(z),Math.abs(Ye))&&Math.abs(D-Ze)<=qn*Math.max(1,Math.abs(D),Math.abs(Ze))&&Math.abs(N-Te)<=qn*Math.max(1,Math.abs(N),Math.abs(Te))&&Math.abs(q-rt)<=qn*Math.max(1,Math.abs(q),Math.abs(rt))&&Math.abs(G-Qe)<=qn*Math.max(1,Math.abs(G),Math.abs(Qe))&&Math.abs(Q-ft)<=qn*Math.max(1,Math.abs(Q),Math.abs(ft))},v.aa=function(i){const t={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,l,h,m)=>{const _=h||m;return t[l]=!_||_.toLowerCase(),""}),t["max-age"]){const o=parseInt(t["max-age"],10);isNaN(o)?delete t["max-age"]:t["max-age"]=o}return t},v.ab=function(i,t){const o=[];for(const l in i)l in t||o.push(l);return o},v.ac=Ee,v.ad=function(i,t,o){var l=Math.sin(o),h=Math.cos(o),m=t[0],_=t[1],b=t[2],S=t[3],I=t[4],E=t[5],A=t[6],z=t[7];return t!==i&&(i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[0]=m*h+I*l,i[1]=_*h+E*l,i[2]=b*h+A*l,i[3]=S*h+z*l,i[4]=I*h-m*l,i[5]=E*h-_*l,i[6]=A*h-b*l,i[7]=z*h-S*l,i},v.ae=function(i){var t=new pc(16);return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],t},v.af=_p,v.ag=function(i,t){let o=0,l=0;if(i.kind==="constant")l=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:h,minZoom:m,maxZoom:_}=i,b=h?Ee(ni.interpolationFactor(h,t,m,_),0,1):0;i.kind==="camera"?l=En.number(i.minSize,i.maxSize,b):o=b}return{uSizeT:o,uSize:l}},v.ai=function(i,{uSize:t,uSizeT:o},{lowerSize:l,upperSize:h}){return i.kind==="source"?l/Go:i.kind==="composite"?En.number(l/Go,h/Go,o):t},v.aj=qg,v.ak=function(i,t,o,l){const h=t.y-i.y,m=t.x-i.x,_=l.y-o.y,b=l.x-o.x,S=_*m-b*h;if(S===0)return null;const I=(b*(i.y-o.y)-_*(i.x-o.x))/S;return new j(i.x+I*m,i.y+I*h)},v.al=$1,v.am=kv,v.an=Tg,v.ao=function(i){let t=1/0,o=1/0,l=-1/0,h=-1/0;for(const m of i)t=Math.min(t,m.x),o=Math.min(o,m.y),l=Math.max(l,m.x),h=Math.max(h,m.y);return[t,o,l,h]},v.ap=qr,v.ar=Vg,v.as=function(i,t){var o=t[0],l=t[1],h=t[2],m=t[3],_=t[4],b=t[5],S=t[6],I=t[7],E=t[8],A=t[9],z=t[10],D=t[11],N=t[12],q=t[13],G=t[14],Q=t[15],de=o*b-l*_,ie=o*S-h*_,ue=o*I-m*_,ve=l*S-h*b,ke=l*I-m*b,Ne=h*I-m*S,lt=E*q-A*N,Ue=E*G-z*N,Oe=E*Q-D*N,et=A*G-z*q,Ye=A*Q-D*q,Ze=z*Q-D*G,Te=de*Ze-ie*Ye+ue*et+ve*Oe-ke*Ue+Ne*lt;return Te?(i[0]=(b*Ze-S*Ye+I*et)*(Te=1/Te),i[1]=(h*Ye-l*Ze-m*et)*Te,i[2]=(q*Ne-G*ke+Q*ve)*Te,i[3]=(z*ke-A*Ne-D*ve)*Te,i[4]=(S*Oe-_*Ze-I*Ue)*Te,i[5]=(o*Ze-h*Oe+m*Ue)*Te,i[6]=(G*ue-N*Ne-Q*ie)*Te,i[7]=(E*Ne-z*ue+D*ie)*Te,i[8]=(_*Ye-b*Oe+I*lt)*Te,i[9]=(l*Oe-o*Ye-m*lt)*Te,i[10]=(N*ke-q*ue+Q*de)*Te,i[11]=(A*ue-E*ke-D*de)*Te,i[12]=(b*Ue-_*et-S*lt)*Te,i[13]=(o*et-l*Ue+h*lt)*Te,i[14]=(q*ie-N*ve-G*de)*Te,i[15]=(E*ve-A*ie+z*de)*Te,i):null},v.at=Jg,v.au=jg,v.av=Qg,v.aw=function(){const i={},t=be.$version;for(const o in be.$root){const l=be.$root[o];if(l.required){let h=null;h=o==="version"?t:l.type==="array"?[]:{},h!=null&&(i[o]=h)}}return i},v.ax=sp,v.ay=Ei,v.az=function(i){i=i.slice();const t=Object.create(null);for(let o=0;o<i.length;o++)t[i[o].id]=i[o];for(let o=0;o<i.length;o++)"ref"in i[o]&&(i[o]=ls(i[o],t[i[o].ref]));return i},v.b=Rr,v.b0=function(i,t,o){return i[0]=t[0]*o[0],i[1]=t[1]*o[1],i[2]=t[2]*o[2],i[3]=t[3]*o[3],i},v.b1=function(i,t){return i[0]*t[0]+i[1]*t[1]+i[2]*t[2]+i[3]*t[3]},v.b2=Pe,v.b3=L1,v.b4=M1,v.b5=function(i,t,o,l,h){var m,_=1/Math.tan(t/2);return i[0]=_/o,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=_,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,h!=null&&h!==1/0?(i[10]=(h+l)*(m=1/(l-h)),i[14]=2*h*l*m):(i[10]=-1,i[14]=-2*l),i},v.b6=function(i,t,o){var l=Math.sin(o),h=Math.cos(o),m=t[4],_=t[5],b=t[6],S=t[7],I=t[8],E=t[9],A=t[10],z=t[11];return t!==i&&(i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[4]=m*h+I*l,i[5]=_*h+E*l,i[6]=b*h+A*l,i[7]=S*h+z*l,i[8]=I*h-m*l,i[9]=E*h-_*l,i[10]=A*h-b*l,i[11]=z*h-S*l,i},v.b7=ae,v.b8=xe,v.b9=function(i){return i*Math.PI/180},v.bA=Xl,v.bB=qo,v.ba=function(i,t){return i[0]=t[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=t[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=t[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},v.bb=class extends O{},v.bc=Zg,v.bd=FI,v.bf=Xr,v.bg=function(i,t){xr.REGISTERED_PROTOCOLS[i]=t},v.bh=function(i){delete xr.REGISTERED_PROTOCOLS[i]},v.bi=function(i,t){const o={};for(let h=0;h<i.length;h++){const m=t&&t[i[h].id]||mg(i[h]);t&&(t[i[h].id]=m);let _=o[m];_||(_=o[m]=[]),_.push(i[h])}const l=[];for(const h in o)l.push(o[h]);return l},v.bj=Xe,v.bk=D1,v.bl=F1,v.bm=f1,v.bn=function(i){i.bucket.createArrays(),i.bucket.tilePixelRatio=Fr/(512*i.bucket.overscaling),i.bucket.compareText={},i.bucket.iconsNeedLinear=!1;const t=i.bucket.layers[0],o=t.layout,l=t._unevaluatedLayout._values,h={layoutIconSize:l["icon-size"].possiblyEvaluate(new Qt(i.bucket.zoom+1),i.canonical),layoutTextSize:l["text-size"].possiblyEvaluate(new Qt(i.bucket.zoom+1),i.canonical),textMaxSize:l["text-size"].possiblyEvaluate(new Qt(18))};if(i.bucket.textSizeData.kind==="composite"){const{minZoom:I,maxZoom:E}=i.bucket.textSizeData;h.compositeTextSizes=[l["text-size"].possiblyEvaluate(new Qt(I),i.canonical),l["text-size"].possiblyEvaluate(new Qt(E),i.canonical)]}if(i.bucket.iconSizeData.kind==="composite"){const{minZoom:I,maxZoom:E}=i.bucket.iconSizeData;h.compositeIconSizes=[l["icon-size"].possiblyEvaluate(new Qt(I),i.canonical),l["icon-size"].possiblyEvaluate(new Qt(E),i.canonical)]}const m=o.get("text-line-height")*qr,_=o.get("text-rotation-alignment")!=="viewport"&&o.get("symbol-placement")!=="point",b=o.get("text-keep-upright"),S=o.get("text-size");for(const I of i.bucket.features){const E=o.get("text-font").evaluate(I,{},i.canonical).join(","),A=S.evaluate(I,{},i.canonical),z=h.layoutTextSize.evaluate(I,{},i.canonical),D=h.layoutIconSize.evaluate(I,{},i.canonical),N={horizontal:{},vertical:void 0},q=I.text;let G,Q=[0,0];if(q){const ue=q.toString(),ve=o.get("text-letter-spacing").evaluate(I,{},i.canonical)*qr,ke=yg(ue)?ve:0,Ne=o.get("text-anchor").evaluate(I,{},i.canonical),lt=K1(t,I,i.canonical);if(!lt){const Ye=o.get("text-radial-offset").evaluate(I,{},i.canonical);Q=Ye?Z1(Ne,[Ye*qr,Yg]):o.get("text-offset").evaluate(I,{},i.canonical).map(Ze=>Ze*qr)}let Ue=_?"center":o.get("text-justify").evaluate(I,{},i.canonical);const Oe=o.get("symbol-placement")==="point"?o.get("text-max-width").evaluate(I,{},i.canonical)*qr:1/0,et=()=>{i.bucket.allowVerticalPlacement&&Yu(ue)&&(N.vertical=Cp(q,i.glyphMap,i.glyphPositions,i.imagePositions,E,Oe,m,Ne,"left",ke,Q,v.ah.vertical,!0,z,A))};if(!_&&lt){const Ye=new Set;if(Ue==="auto")for(let Te=0;Te<lt.values.length;Te+=2)Ye.add(Jg(lt.values[Te]));else Ye.add(Ue);let Ze=!1;for(const Te of Ye)if(!N.horizontal[Te])if(Ze)N.horizontal[Te]=N.horizontal[0];else{const rt=Cp(q,i.glyphMap,i.glyphPositions,i.imagePositions,E,Oe,m,"center",Te,ke,Q,v.ah.horizontal,!1,z,A);rt&&(N.horizontal[Te]=rt,Ze=rt.positionedLines.length===1)}et()}else{Ue==="auto"&&(Ue=Jg(Ne));const Ye=Cp(q,i.glyphMap,i.glyphPositions,i.imagePositions,E,Oe,m,Ne,Ue,ke,Q,v.ah.horizontal,!1,z,A);Ye&&(N.horizontal[Ue]=Ye),et(),Yu(ue)&&_&&b&&(N.vertical=Cp(q,i.glyphMap,i.glyphPositions,i.imagePositions,E,Oe,m,Ne,Ue,ke,Q,v.ah.vertical,!1,z,A))}}let de=!1;if(I.icon&&I.icon.name){const ue=i.imageMap[I.icon.name];ue&&(G=_I(i.imagePositions[I.icon.name],o.get("icon-offset").evaluate(I,{},i.canonical),o.get("icon-anchor").evaluate(I,{},i.canonical)),de=!!ue.sdf,i.bucket.sdfIcons===void 0?i.bucket.sdfIcons=de:i.bucket.sdfIcons!==de&&Et("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ue.pixelRatio!==i.bucket.pixelRatio||o.get("icon-rotate").constantOr(1)!==0)&&(i.bucket.iconsNeedLinear=!0))}const ie=Y1(N.horizontal)||N.vertical;i.bucket.iconsInText=!!ie&&ie.iconsInText,(ie||G)&&DI(i.bucket,I,N,G,i.imageMap,h,z,D,Q,de,i.canonical)}i.showCollisionBoxes&&i.bucket.generateCollisionDebugBuffers()},v.bo=Bg,v.bp=Lg,v.bq=Dg,v.br=oa,v.bs=Og,v.bt=class{constructor(i){this._marks={start:[i.url,"start"].join("#"),end:[i.url,"end"].join("#"),measure:i.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let i=performance.getEntriesByName(this._marks.measure);return i.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),i=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),i}},v.bu=function(i,t,o,l,h){return d(this,void 0,void 0,function*(){if(ee())try{return yield mt(i,t,o,l,h)}catch{}return function(m,_,b,S,I){const E=m.width,A=m.height;gt&&At||(gt=new OffscreenCanvas(E,A),At=gt.getContext("2d",{willReadFrequently:!0})),gt.width=E,gt.height=A,At.drawImage(m,0,0,E,A);const z=At.getImageData(_,b,S,I);return At.clearRect(0,0,E,A),z.data}(i,t,o,l,h)})},v.bv=R1,v.bw=L,v.bx=U,v.by=o1,v.bz=function(i){return i.message===Lt},v.c=Zr,v.d=i=>d(void 0,void 0,void 0,function*(){if(i.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(i)],{type:"image/png"});try{return createImageBitmap(t)}catch(o){throw new Error(`Could not load image because of ${o.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),v.e=Ae,v.f=i=>new Promise((t,o)=>{const l=new Image;l.onload=()=>{t(l),URL.revokeObjectURL(l.src),l.onload=null,window.requestAnimationFrame(()=>{l.src=qe})},l.onerror=()=>o(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const h=new Blob([new Uint8Array(i)],{type:"image/png"});l.src=i.byteLength?URL.createObjectURL(h):qe}),v.g=Kr,v.h=(i,t)=>un(Ae(i,{type:"json"}),t),v.i=kr,v.j=br,v.k=Ki,v.l=(i,t)=>un(Ae(i,{type:"arrayBuffer"}),t),v.m=un,v.n=function(i){return new Og(i).readFields(hI,[])},v.o=ch,v.p=p1,v.q=u,v.r=gg,v.s=Do,v.t=Xu,v.u=Ve,v.v=be,v.w=Et,v.x=Ja,v.y=function([i,t,o]){return t+=90,t*=Math.PI/180,o*=Math.PI/180,{x:i*Math.cos(t)*Math.sin(o),y:i*Math.sin(t)*Math.sin(o),z:i*Math.cos(o)}},v.z=En}),f("worker",["./shared"],function(v){class d{constructor(R){this.keyCache={},R&&this.replace(R)}replace(R){this._layerConfigs={},this._layers={},this.update(R,[])}update(R,B){for(const Y of R){this._layerConfigs[Y.id]=Y;const oe=this._layers[Y.id]=v.aA(Y);oe._featureFilter=v.a6(oe.filter),this.keyCache[Y.id]&&delete this.keyCache[Y.id]}for(const Y of B)delete this.keyCache[Y],delete this._layerConfigs[Y],delete this._layers[Y];this.familiesBySource={};const $=v.bi(Object.values(this._layerConfigs),this.keyCache);for(const Y of $){const oe=Y.map(Se=>this._layers[Se.id]),le=oe[0];if(le.visibility==="none")continue;const he=le.source||"";let ne=this.familiesBySource[he];ne||(ne=this.familiesBySource[he]={});const ge=le.sourceLayer||"_geojsonTileLayer";let Ie=ne[ge];Ie||(Ie=ne[ge]=[]),Ie.push(oe)}}}class L{constructor(R){const B={},$=[];for(const he in R){const ne=R[he],ge=B[he]={};for(const Ie in ne){const Se=ne[+Ie];if(!Se||Se.bitmap.width===0||Se.bitmap.height===0)continue;const we={x:0,y:0,w:Se.bitmap.width+2,h:Se.bitmap.height+2};$.push(we),ge[Ie]={rect:we,metrics:Se.metrics}}}const{w:Y,h:oe}=v.p($),le=new v.o({width:Y||1,height:oe||1});for(const he in R){const ne=R[he];for(const ge in ne){const Ie=ne[+ge];if(!Ie||Ie.bitmap.width===0||Ie.bitmap.height===0)continue;const Se=B[he][ge].rect;v.o.copy(Ie.bitmap,le,{x:0,y:0},{x:Se.x+1,y:Se.y+1},Ie.bitmap)}}this.image=le,this.positions=B}}v.bj("GlyphAtlas",L);class U{constructor(R){this.tileID=new v.Q(R.tileID.overscaledZ,R.tileID.wrap,R.tileID.canonical.z,R.tileID.canonical.x,R.tileID.canonical.y),this.uid=R.uid,this.zoom=R.zoom,this.pixelRatio=R.pixelRatio,this.tileSize=R.tileSize,this.source=R.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=R.showCollisionBoxes,this.collectResourceTiming=!!R.collectResourceTiming,this.returnDependencies=!!R.returnDependencies,this.promoteId=R.promoteId,this.inFlightDependencies=[]}parse(R,B,$,Y){return v._(this,void 0,void 0,function*(){this.status="parsing",this.data=R,this.collisionBoxArray=new v.a4;const oe=new v.bk(Object.keys(R.layers).sort()),le=new v.bl(this.tileID,this.promoteId);le.bucketLayerIDs=[];const he={},ne={featureIndex:le,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:$},ge=B.familiesBySource[this.source];for(const wt in ge){const hr=R.layers[wt];if(!hr)continue;hr.version===1&&v.w(`Vector tile source "${this.source}" layer "${wt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Ur=oe.encode(wt),Nn=[];for(let ti=0;ti<hr.length;ti++){const jr=hr.feature(ti),Us=le.getId(jr,wt);Nn.push({feature:jr,id:Us,index:ti,sourceLayerIndex:Ur})}for(const ti of ge[wt]){const jr=ti[0];jr.source!==this.source&&v.w(`layer.source = ${jr.source} does not equal this.source = ${this.source}`),jr.minzoom&&this.zoom<Math.floor(jr.minzoom)||jr.maxzoom&&this.zoom>=jr.maxzoom||jr.visibility!=="none"&&(Z(ti,this.zoom,$),(he[jr.id]=jr.createBucket({index:le.bucketLayerIDs.length,layers:ti,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ur,sourceID:this.source})).populate(Nn,ne,this.tileID.canonical),le.bucketLayerIDs.push(ti.map(Us=>Us.id)))}}const Ie=v.aF(ne.glyphDependencies,wt=>Object.keys(wt).map(Number));this.inFlightDependencies.forEach(wt=>wt==null?void 0:wt.abort()),this.inFlightDependencies=[];let Se=Promise.resolve({});if(Object.keys(Ie).length){const wt=new AbortController;this.inFlightDependencies.push(wt),Se=Y.sendAsync({type:"GG",data:{stacks:Ie,source:this.source,tileID:this.tileID,type:"glyphs"}},wt)}const we=Object.keys(ne.iconDependencies);let at=Promise.resolve({});if(we.length){const wt=new AbortController;this.inFlightDependencies.push(wt),at=Y.sendAsync({type:"GI",data:{icons:we,source:this.source,tileID:this.tileID,type:"icons"}},wt)}const it=Object.keys(ne.patternDependencies);let It=Promise.resolve({});if(it.length){const wt=new AbortController;this.inFlightDependencies.push(wt),It=Y.sendAsync({type:"GI",data:{icons:it,source:this.source,tileID:this.tileID,type:"patterns"}},wt)}const[yt,Pt,Wt]=yield Promise.all([Se,at,It]),ir=new L(yt),Dr=new v.bm(Pt,Wt);for(const wt in he){const hr=he[wt];hr instanceof v.a5?(Z(hr.layers,this.zoom,$),v.bn({bucket:hr,glyphMap:yt,glyphPositions:ir.positions,imageMap:Pt,imagePositions:Dr.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):hr.hasPattern&&(hr instanceof v.bo||hr instanceof v.bp||hr instanceof v.bq)&&(Z(hr.layers,this.zoom,$),hr.addFeatures(ne,this.tileID.canonical,Dr.patternPositions))}return this.status="done",{buckets:Object.values(he).filter(wt=>!wt.isEmpty()),featureIndex:le,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ir.image,imageAtlas:Dr,glyphMap:this.returnDependencies?yt:null,iconMap:this.returnDependencies?Pt:null,glyphPositions:this.returnDependencies?ir.positions:null}})}}function Z(K,R,B){const $=new v.a8(R);for(const Y of K)Y.recalculate($,B)}class j{constructor(R,B,$){this.actor=R,this.layerIndex=B,this.availableImages=$,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(R,B){return v._(this,void 0,void 0,function*(){const $=yield v.l(R.request,B);try{return{vectorTile:new v.br.VectorTile(new v.bs($.data)),rawData:$.data,cacheControl:$.cacheControl,expires:$.expires}}catch(Y){const oe=new Uint8Array($.data);let le=`Unable to parse the tile at ${R.request.url}, `;throw le+=oe[0]===31&&oe[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${Y.message}`,new Error(le)}})}loadTile(R){return v._(this,void 0,void 0,function*(){const B=R.uid,$=!!(R&&R.request&&R.request.collectResourceTiming)&&new v.bt(R.request),Y=new U(R);this.loading[B]=Y;const oe=new AbortController;Y.abort=oe;try{const le=yield this.loadVectorTile(R,oe);if(delete this.loading[B],!le)return null;const he=le.rawData,ne={};le.expires&&(ne.expires=le.expires),le.cacheControl&&(ne.cacheControl=le.cacheControl);const ge={};if($){const Se=$.finish();Se&&(ge.resourceTiming=JSON.parse(JSON.stringify(Se)))}Y.vectorTile=le.vectorTile;const Ie=Y.parse(le.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[B]=Y,this.fetching[B]={rawTileData:he,cacheControl:ne,resourceTiming:ge};try{const Se=yield Ie;return v.e({rawTileData:he.slice(0)},Se,ne,ge)}finally{delete this.fetching[B]}}catch(le){throw delete this.loading[B],Y.status="done",this.loaded[B]=Y,le}})}reloadTile(R){return v._(this,void 0,void 0,function*(){const B=R.uid;if(!this.loaded||!this.loaded[B])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const $=this.loaded[B];if($.showCollisionBoxes=R.showCollisionBoxes,$.status==="parsing"){const Y=yield $.parse($.vectorTile,this.layerIndex,this.availableImages,this.actor);let oe;if(this.fetching[B]){const{rawTileData:le,cacheControl:he,resourceTiming:ne}=this.fetching[B];delete this.fetching[B],oe=v.e({rawTileData:le.slice(0)},Y,he,ne)}else oe=Y;return oe}if($.status==="done"&&$.vectorTile)return $.parse($.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(R){return v._(this,void 0,void 0,function*(){const B=this.loading,$=R.uid;B&&B[$]&&B[$].abort&&(B[$].abort.abort(),delete B[$])})}removeTile(R){return v._(this,void 0,void 0,function*(){this.loaded&&this.loaded[R.uid]&&delete this.loaded[R.uid]})}}class F{constructor(){this.loaded={}}loadTile(R){return v._(this,void 0,void 0,function*(){const{uid:B,encoding:$,rawImageData:Y,redFactor:oe,greenFactor:le,blueFactor:he,baseShift:ne}=R,ge=Y.width+2,Ie=Y.height+2,Se=v.b(Y)?new v.R({width:ge,height:Ie},yield v.bu(Y,-1,-1,ge,Ie)):Y,we=new v.bv(B,Se,$,oe,le,he,ne);return this.loaded=this.loaded||{},this.loaded[B]=we,we})}removeTile(R){const B=this.loaded,$=R.uid;B&&B[$]&&delete B[$]}}function me(K,R){if(K.length!==0){ye(K[0],R);for(var B=1;B<K.length;B++)ye(K[B],!R)}}function ye(K,R){for(var B=0,$=0,Y=0,oe=K.length,le=oe-1;Y<oe;le=Y++){var he=(K[Y][0]-K[le][0])*(K[le][1]+K[Y][1]),ne=B+he;$+=Math.abs(B)>=Math.abs(he)?B-ne+he:he-ne+B,B=ne}B+$>=0!=!!R&&K.reverse()}var pe=v.bw(function K(R,B){var $,Y=R&&R.type;if(Y==="FeatureCollection")for($=0;$<R.features.length;$++)K(R.features[$],B);else if(Y==="GeometryCollection")for($=0;$<R.geometries.length;$++)K(R.geometries[$],B);else if(Y==="Feature")K(R.geometry,B);else if(Y==="Polygon")me(R.coordinates,B);else if(Y==="MultiPolygon")for($=0;$<R.coordinates.length;$++)me(R.coordinates[$],B);return R});const je=v.br.VectorTileFeature.prototype.toGeoJSON;var re={exports:{}},ee=v.bx,ae=v.br.VectorTileFeature,xe=Ee;function Ee(K,R){this.options=R||{},this.features=K,this.length=K.length}function Pe(K,R){this.id=typeof K.id=="number"?K.id:void 0,this.type=K.type,this.rawGeometry=K.type===1?[K.geometry]:K.geometry,this.properties=K.tags,this.extent=R||4096}Ee.prototype.feature=function(K){return new Pe(this.features[K],this.options.extent)},Pe.prototype.loadGeometry=function(){var K=this.rawGeometry;this.geometry=[];for(var R=0;R<K.length;R++){for(var B=K[R],$=[],Y=0;Y<B.length;Y++)$.push(new ee(B[Y][0],B[Y][1]));this.geometry.push($)}return this.geometry},Pe.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var K=this.geometry,R=1/0,B=-1/0,$=1/0,Y=-1/0,oe=0;oe<K.length;oe++)for(var le=K[oe],he=0;he<le.length;he++){var ne=le[he];R=Math.min(R,ne.x),B=Math.max(B,ne.x),$=Math.min($,ne.y),Y=Math.max(Y,ne.y)}return[R,$,B,Y]},Pe.prototype.toGeoJSON=ae.prototype.toGeoJSON;var Ae=v.by,Ke=xe;function vt(K){var R=new Ae;return function(B,$){for(var Y in B.layers)$.writeMessage(3,ot,B.layers[Y])}(K,R),R.finish()}function ot(K,R){var B;R.writeVarintField(15,K.version||1),R.writeStringField(1,K.name||""),R.writeVarintField(5,K.extent||4096);var $={keys:[],values:[],keycache:{},valuecache:{}};for(B=0;B<K.length;B++)$.feature=K.feature(B),R.writeMessage(2,st,$);var Y=$.keys;for(B=0;B<Y.length;B++)R.writeStringField(3,Y[B]);var oe=$.values;for(B=0;B<oe.length;B++)R.writeMessage(4,vr,oe[B])}function st(K,R){var B=K.feature;B.id!==void 0&&R.writeVarintField(1,B.id),R.writeMessage(2,Ft,K),R.writeVarintField(3,B.type),R.writeMessage(4,kr,B)}function Ft(K,R){var B=K.feature,$=K.keys,Y=K.values,oe=K.keycache,le=K.valuecache;for(var he in B.properties){var ne=B.properties[he],ge=oe[he];if(ne!==null){ge===void 0&&($.push(he),oe[he]=ge=$.length-1),R.writeVarint(ge);var Ie=typeof ne;Ie!=="string"&&Ie!=="boolean"&&Ie!=="number"&&(ne=JSON.stringify(ne));var Se=Ie+":"+ne,we=le[Se];we===void 0&&(Y.push(ne),le[Se]=we=Y.length-1),R.writeVarint(we)}}}function Et(K,R){return(R<<3)+(7&K)}function zt(K){return K<<1^K>>31}function kr(K,R){for(var B=K.loadGeometry(),$=K.type,Y=0,oe=0,le=B.length,he=0;he<le;he++){var ne=B[he],ge=1;$===1&&(ge=ne.length),R.writeVarint(Et(1,ge));for(var Ie=$===3?ne.length-1:ne.length,Se=0;Se<Ie;Se++){Se===1&&$!==1&&R.writeVarint(Et(2,Ie-1));var we=ne[Se].x-Y,at=ne[Se].y-oe;R.writeVarint(zt(we)),R.writeVarint(zt(at)),Y+=we,oe+=at}$===3&&R.writeVarint(Et(7,1))}}function vr(K,R){var B=typeof K;B==="string"?R.writeStringField(1,K):B==="boolean"?R.writeBooleanField(7,K):B==="number"&&(K%1!=0?R.writeDoubleField(3,K):K<0?R.writeSVarintField(6,K):R.writeVarintField(5,K))}re.exports=vt,re.exports.fromVectorTileJs=vt,re.exports.fromGeojsonVt=function(K,R){R=R||{};var B={};for(var $ in K)B[$]=new Ke(K[$].features,R),B[$].name=$,B[$].version=R.version,B[$].extent=R.extent;return vt({layers:B})},re.exports.GeoJSONWrapper=Ke;var Rr=v.bw(re.exports);const qe={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:K=>K},mt=Math.fround||(gt=new Float32Array(1),K=>(gt[0]=+K,gt[0]));var gt;const At=3,Lt=5,Zr=6;class xr{constructor(R){this.options=Object.assign(Object.create(qe),R),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(R){const{log:B,minZoom:$,maxZoom:Y}=this.options;B&&console.time("total time");const oe=`prepare ${R.length} points`;B&&console.time(oe),this.points=R;const le=[];for(let ne=0;ne<R.length;ne++){const ge=R[ne];if(!ge.geometry)continue;const[Ie,Se]=ge.geometry.coordinates,we=mt(Xr(Ie)),at=mt(Ei(Se));le.push(we,at,1/0,ne,-1,1),this.options.reduce&&le.push(0)}let he=this.trees[Y+1]=this._createTree(le);B&&console.timeEnd(oe);for(let ne=Y;ne>=$;ne--){const ge=+Date.now();he=this.trees[ne]=this._createTree(this._cluster(he,ne)),B&&console.log("z%d: %d clusters in %dms",ne,he.numItems,+Date.now()-ge)}return B&&console.timeEnd("total time"),this}getClusters(R,B){let $=((R[0]+180)%360+360)%360-180;const Y=Math.max(-90,Math.min(90,R[1]));let oe=R[2]===180?180:((R[2]+180)%360+360)%360-180;const le=Math.max(-90,Math.min(90,R[3]));if(R[2]-R[0]>=360)$=-180,oe=180;else if($>oe){const Se=this.getClusters([$,Y,180,le],B),we=this.getClusters([-180,Y,oe,le],B);return Se.concat(we)}const he=this.trees[this._limitZoom(B)],ne=he.range(Xr($),Ei(le),Xr(oe),Ei(Y)),ge=he.data,Ie=[];for(const Se of ne){const we=this.stride*Se;Ie.push(ge[we+Lt]>1?Kr(ge,we,this.clusterProps):this.points[ge[we+At]])}return Ie}getChildren(R){const B=this._getOriginId(R),$=this._getOriginZoom(R),Y="No cluster with the specified id.",oe=this.trees[$];if(!oe)throw new Error(Y);const le=oe.data;if(B*this.stride>=le.length)throw new Error(Y);const he=this.options.radius/(this.options.extent*Math.pow(2,$-1)),ne=oe.within(le[B*this.stride],le[B*this.stride+1],he),ge=[];for(const Ie of ne){const Se=Ie*this.stride;le[Se+4]===R&&ge.push(le[Se+Lt]>1?Kr(le,Se,this.clusterProps):this.points[le[Se+At]])}if(ge.length===0)throw new Error(Y);return ge}getLeaves(R,B,$){const Y=[];return this._appendLeaves(Y,R,B=B||10,$=$||0,0),Y}getTile(R,B,$){const Y=this.trees[this._limitZoom(R)],oe=Math.pow(2,R),{extent:le,radius:he}=this.options,ne=he/le,ge=($-ne)/oe,Ie=($+1+ne)/oe,Se={features:[]};return this._addTileFeatures(Y.range((B-ne)/oe,ge,(B+1+ne)/oe,Ie),Y.data,B,$,oe,Se),B===0&&this._addTileFeatures(Y.range(1-ne/oe,ge,1,Ie),Y.data,oe,$,oe,Se),B===oe-1&&this._addTileFeatures(Y.range(0,ge,ne/oe,Ie),Y.data,-1,$,oe,Se),Se.features.length?Se:null}getClusterExpansionZoom(R){let B=this._getOriginZoom(R)-1;for(;B<=this.options.maxZoom;){const $=this.getChildren(R);if(B++,$.length!==1)break;R=$[0].properties.cluster_id}return B}_appendLeaves(R,B,$,Y,oe){const le=this.getChildren(B);for(const he of le){const ne=he.properties;if(ne&&ne.cluster?oe+ne.point_count<=Y?oe+=ne.point_count:oe=this._appendLeaves(R,ne.cluster_id,$,Y,oe):oe<Y?oe++:R.push(he),R.length===$)break}return oe}_createTree(R){const B=new v.av(R.length/this.stride|0,this.options.nodeSize,Float32Array);for(let $=0;$<R.length;$+=this.stride)B.add(R[$],R[$+1]);return B.finish(),B.data=R,B}_addTileFeatures(R,B,$,Y,oe,le){for(const he of R){const ne=he*this.stride,ge=B[ne+Lt]>1;let Ie,Se,we;if(ge)Ie=Ar(B,ne,this.clusterProps),Se=B[ne],we=B[ne+1];else{const It=this.points[B[ne+At]];Ie=It.properties;const[yt,Pt]=It.geometry.coordinates;Se=Xr(yt),we=Ei(Pt)}const at={type:1,geometry:[[Math.round(this.options.extent*(Se*oe-$)),Math.round(this.options.extent*(we*oe-Y))]],tags:Ie};let it;it=ge||this.options.generateId?B[ne+At]:this.points[B[ne+At]].id,it!==void 0&&(at.id=it),le.features.push(at)}}_limitZoom(R){return Math.max(this.options.minZoom,Math.min(Math.floor(+R),this.options.maxZoom+1))}_cluster(R,B){const{radius:$,extent:Y,reduce:oe,minPoints:le}=this.options,he=$/(Y*Math.pow(2,B)),ne=R.data,ge=[],Ie=this.stride;for(let Se=0;Se<ne.length;Se+=Ie){if(ne[Se+2]<=B)continue;ne[Se+2]=B;const we=ne[Se],at=ne[Se+1],it=R.within(ne[Se],ne[Se+1],he),It=ne[Se+Lt];let yt=It;for(const Pt of it){const Wt=Pt*Ie;ne[Wt+2]>B&&(yt+=ne[Wt+Lt])}if(yt>It&&yt>=le){let Pt,Wt=we*It,ir=at*It,Dr=-1;const wt=((Se/Ie|0)<<5)+(B+1)+this.points.length;for(const hr of it){const Ur=hr*Ie;if(ne[Ur+2]<=B)continue;ne[Ur+2]=B;const Nn=ne[Ur+Lt];Wt+=ne[Ur]*Nn,ir+=ne[Ur+1]*Nn,ne[Ur+4]=wt,oe&&(Pt||(Pt=this._map(ne,Se,!0),Dr=this.clusterProps.length,this.clusterProps.push(Pt)),oe(Pt,this._map(ne,Ur)))}ne[Se+4]=wt,ge.push(Wt/yt,ir/yt,1/0,wt,-1,yt),oe&&ge.push(Dr)}else{for(let Pt=0;Pt<Ie;Pt++)ge.push(ne[Se+Pt]);if(yt>1)for(const Pt of it){const Wt=Pt*Ie;if(!(ne[Wt+2]<=B)){ne[Wt+2]=B;for(let ir=0;ir<Ie;ir++)ge.push(ne[Wt+ir])}}}}return ge}_getOriginId(R){return R-this.points.length>>5}_getOriginZoom(R){return(R-this.points.length)%32}_map(R,B,$){if(R[B+Lt]>1){const le=this.clusterProps[R[B+Zr]];return $?Object.assign({},le):le}const Y=this.points[R[B+At]].properties,oe=this.options.map(Y);return $&&oe===Y?Object.assign({},oe):oe}}function Kr(K,R,B){return{type:"Feature",id:K[R+At],properties:Ar(K,R,B),geometry:{type:"Point",coordinates:[($=K[R],360*($-.5)),un(K[R+1])]}};var $}function Ar(K,R,B){const $=K[R+Lt],Y=$>=1e4?`${Math.round($/1e3)}k`:$>=1e3?Math.round($/100)/10+"k":$,oe=K[R+Zr],le=oe===-1?{}:Object.assign({},B[oe]);return Object.assign(le,{cluster:!0,cluster_id:K[R+At],point_count:$,point_count_abbreviated:Y})}function Xr(K){return K/360+.5}function Ei(K){const R=Math.sin(K*Math.PI/180),B=.5-.25*Math.log((1+R)/(1-R))/Math.PI;return B<0?0:B>1?1:B}function un(K){const R=(180-360*K)*Math.PI/180;return 360*Math.atan(Math.exp(R))/Math.PI-90}function Do(K,R,B,$){for(var Y,oe=$,le=B-R>>1,he=B-R,ne=K[R],ge=K[R+1],Ie=K[B],Se=K[B+1],we=R+3;we<B;we+=3){var at=$s(K[we],K[we+1],ne,ge,Ie,Se);if(at>oe)Y=we,oe=at;else if(at===oe){var it=Math.abs(we-le);it<he&&(Y=we,he=it)}}oe>$&&(Y-R>3&&Do(K,R,Y,$),K[Y+2]=oe,B-Y>3&&Do(K,Y,B,$))}function $s(K,R,B,$,Y,oe){var le=Y-B,he=oe-$;if(le!==0||he!==0){var ne=((K-B)*le+(R-$)*he)/(le*le+he*he);ne>1?(B=Y,$=oe):ne>0&&(B+=le*ne,$+=he*ne)}return(le=K-B)*le+(he=R-$)*he}function fi(K,R,B,$){var Y={id:K===void 0?null:K,type:R,geometry:B,tags:$,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(oe){var le=oe.geometry,he=oe.type;if(he==="Point"||he==="MultiPoint"||he==="LineString")Ki(oe,le);else if(he==="Polygon"||he==="MultiLineString")for(var ne=0;ne<le.length;ne++)Ki(oe,le[ne]);else if(he==="MultiPolygon")for(ne=0;ne<le.length;ne++)for(var ge=0;ge<le[ne].length;ge++)Ki(oe,le[ne][ge])}(Y),Y}function Ki(K,R){for(var B=0;B<R.length;B+=3)K.minX=Math.min(K.minX,R[B]),K.minY=Math.min(K.minY,R[B+1]),K.maxX=Math.max(K.maxX,R[B]),K.maxY=Math.max(K.maxY,R[B+1])}function br(K,R,B,$){if(R.geometry){var Y=R.geometry.coordinates,oe=R.geometry.type,le=Math.pow(B.tolerance/((1<<B.maxZoom)*B.extent),2),he=[],ne=R.id;if(B.promoteId?ne=R.properties[B.promoteId]:B.generateId&&(ne=$||0),oe==="Point")Bo(Y,he);else if(oe==="MultiPoint")for(var ge=0;ge<Y.length;ge++)Bo(Y[ge],he);else if(oe==="LineString")be(Y,he,le,!1);else if(oe==="MultiLineString"){if(B.lineMetrics){for(ge=0;ge<Y.length;ge++)be(Y[ge],he=[],le,!1),K.push(fi(ne,"LineString",he,R.properties));return}Xi(Y,he,le,!1)}else if(oe==="Polygon")Xi(Y,he,le,!0);else{if(oe!=="MultiPolygon"){if(oe==="GeometryCollection"){for(ge=0;ge<R.geometry.geometries.length;ge++)br(K,{id:ne,geometry:R.geometry.geometries[ge],properties:R.properties},B,$);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ge=0;ge<Y.length;ge++){var Ie=[];Xi(Y[ge],Ie,le,!0),he.push(Ie)}}K.push(fi(ne,oe,he,R.properties))}}function Bo(K,R){R.push(ls(K[0])),R.push(Rt(K[1])),R.push(0)}function be(K,R,B,$){for(var Y,oe,le=0,he=0;he<K.length;he++){var ne=ls(K[he][0]),ge=Rt(K[he][1]);R.push(ne),R.push(ge),R.push(0),he>0&&(le+=$?(Y*ge-ne*oe)/2:Math.sqrt(Math.pow(ne-Y,2)+Math.pow(ge-oe,2))),Y=ne,oe=ge}var Ie=R.length-3;R[2]=1,Do(R,0,Ie,B),R[Ie+2]=1,R.size=Math.abs(le),R.start=0,R.end=R.size}function Xi(K,R,B,$){for(var Y=0;Y<K.length;Y++){var oe=[];be(K[Y],oe,B,$),R.push(oe)}}function ls(K){return K/360+.5}function Rt(K){var R=Math.sin(K*Math.PI/180),B=.5-.25*Math.log((1+R)/(1-R))/Math.PI;return B<0?0:B>1?1:B}function Ht(K,R,B,$,Y,oe,le,he){if($/=R,oe>=(B/=R)&&le<$)return K;if(le<B||oe>=$)return null;for(var ne=[],ge=0;ge<K.length;ge++){var Ie=K[ge],Se=Ie.geometry,we=Ie.type,at=Y===0?Ie.minX:Ie.minY,it=Y===0?Ie.maxX:Ie.maxY;if(at>=B&&it<$)ne.push(Ie);else if(!(it<B||at>=$)){var It=[];if(we==="Point"||we==="MultiPoint")ei(Se,It,B,$,Y);else if(we==="LineString")Fo(Se,It,B,$,Y,!1,he.lineMetrics);else if(we==="MultiLineString")ki(Se,It,B,$,Y,!1);else if(we==="Polygon")ki(Se,It,B,$,Y,!0);else if(we==="MultiPolygon")for(var yt=0;yt<Se.length;yt++){var Pt=[];ki(Se[yt],Pt,B,$,Y,!0),Pt.length&&It.push(Pt)}if(It.length){if(he.lineMetrics&&we==="LineString"){for(yt=0;yt<It.length;yt++)ne.push(fi(Ie.id,we,It[yt],Ie.tags));continue}we!=="LineString"&&we!=="MultiLineString"||(It.length===1?(we="LineString",It=It[0]):we="MultiLineString"),we!=="Point"&&we!=="MultiPoint"||(we=It.length===3?"Point":"MultiPoint"),ne.push(fi(Ie.id,we,It,Ie.tags))}}}return ne.length?ne:null}function ei(K,R,B,$,Y){for(var oe=0;oe<K.length;oe+=3){var le=K[oe+Y];le>=B&&le<=$&&(R.push(K[oe]),R.push(K[oe+1]),R.push(K[oe+2]))}}function Fo(K,R,B,$,Y,oe,le){for(var he,ne,ge=cs(K),Ie=Y===0?Oo:us,Se=K.start,we=0;we<K.length-3;we+=3){var at=K[we],it=K[we+1],It=K[we+2],yt=K[we+3],Pt=K[we+4],Wt=Y===0?at:it,ir=Y===0?yt:Pt,Dr=!1;le&&(he=Math.sqrt(Math.pow(at-yt,2)+Math.pow(it-Pt,2))),Wt<B?ir>B&&(ne=Ie(ge,at,it,yt,Pt,B),le&&(ge.start=Se+he*ne)):Wt>$?ir<$&&(ne=Ie(ge,at,it,yt,Pt,$),le&&(ge.start=Se+he*ne)):Tn(ge,at,it,It),ir<B&&Wt>=B&&(ne=Ie(ge,at,it,yt,Pt,B),Dr=!0),ir>$&&Wt<=$&&(ne=Ie(ge,at,it,yt,Pt,$),Dr=!0),!oe&&Dr&&(le&&(ge.end=Se+he*ne),R.push(ge),ge=cs(K)),le&&(Se+=he)}var wt=K.length-3;at=K[wt],it=K[wt+1],It=K[wt+2],(Wt=Y===0?at:it)>=B&&Wt<=$&&Tn(ge,at,it,It),wt=ge.length-3,oe&&wt>=3&&(ge[wt]!==ge[0]||ge[wt+1]!==ge[1])&&Tn(ge,ge[0],ge[1],ge[2]),ge.length&&R.push(ge)}function cs(K){var R=[];return R.size=K.size,R.start=K.start,R.end=K.end,R}function ki(K,R,B,$,Y,oe){for(var le=0;le<K.length;le++)Fo(K[le],R,B,$,Y,oe,!1)}function Tn(K,R,B,$){K.push(R),K.push(B),K.push($)}function Oo(K,R,B,$,Y,oe){var le=(oe-R)/($-R);return K.push(oe),K.push(B+(Y-B)*le),K.push(1),le}function us(K,R,B,$,Y,oe){var le=(oe-B)/(Y-B);return K.push(R+($-R)*le),K.push(oe),K.push(1),le}function Re(K,R){for(var B=[],$=0;$<K.length;$++){var Y,oe=K[$],le=oe.type;if(le==="Point"||le==="MultiPoint"||le==="LineString")Y=ht(oe.geometry,R);else if(le==="MultiLineString"||le==="Polygon"){Y=[];for(var he=0;he<oe.geometry.length;he++)Y.push(ht(oe.geometry[he],R))}else if(le==="MultiPolygon")for(Y=[],he=0;he<oe.geometry.length;he++){for(var ne=[],ge=0;ge<oe.geometry[he].length;ge++)ne.push(ht(oe.geometry[he][ge],R));Y.push(ne)}B.push(fi(oe.id,le,Y,oe.tags))}return B}function ht(K,R){var B=[];B.size=K.size,K.start!==void 0&&(B.start=K.start,B.end=K.end);for(var $=0;$<K.length;$+=3)B.push(K[$]+R,K[$+1],K[$+2]);return B}function on(K,R){if(K.transformed)return K;var B,$,Y,oe=1<<K.z,le=K.x,he=K.y;for(B=0;B<K.features.length;B++){var ne=K.features[B],ge=ne.geometry,Ie=ne.type;if(ne.geometry=[],Ie===1)for($=0;$<ge.length;$+=2)ne.geometry.push(No(ge[$],ge[$+1],R,oe,le,he));else for($=0;$<ge.length;$++){var Se=[];for(Y=0;Y<ge[$].length;Y+=2)Se.push(No(ge[$][Y],ge[$][Y+1],R,oe,le,he));ne.geometry.push(Se)}}return K.transformed=!0,K}function No(K,R,B,$,Y,oe){return[Math.round(B*(K*$-Y)),Math.round(B*(R*$-oe))]}function Yi(K,R,B,$,Y){for(var oe=R===Y.maxZoom?0:Y.tolerance/((1<<R)*Y.extent),le={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:B,y:$,z:R,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},he=0;he<K.length;he++){le.numFeatures++,Le(le,K[he],oe,Y);var ne=K[he].minX,ge=K[he].minY,Ie=K[he].maxX,Se=K[he].maxY;ne<le.minX&&(le.minX=ne),ge<le.minY&&(le.minY=ge),Ie>le.maxX&&(le.maxX=Ie),Se>le.maxY&&(le.maxY=Se)}return le}function Le(K,R,B,$){var Y=R.geometry,oe=R.type,le=[];if(oe==="Point"||oe==="MultiPoint")for(var he=0;he<Y.length;he+=3)le.push(Y[he]),le.push(Y[he+1]),K.numPoints++,K.numSimplified++;else if(oe==="LineString")St(le,Y,K,B,!1,!1);else if(oe==="MultiLineString"||oe==="Polygon")for(he=0;he<Y.length;he++)St(le,Y[he],K,B,oe==="Polygon",he===0);else if(oe==="MultiPolygon")for(var ne=0;ne<Y.length;ne++){var ge=Y[ne];for(he=0;he<ge.length;he++)St(le,ge[he],K,B,!0,he===0)}if(le.length){var Ie=R.tags||null;if(oe==="LineString"&&$.lineMetrics){for(var Se in Ie={},R.tags)Ie[Se]=R.tags[Se];Ie.mapbox_clip_start=Y.start/Y.size,Ie.mapbox_clip_end=Y.end/Y.size}var we={geometry:le,type:oe==="Polygon"||oe==="MultiPolygon"?3:oe==="LineString"||oe==="MultiLineString"?2:1,tags:Ie};R.id!==null&&(we.id=R.id),K.features.push(we)}}function St(K,R,B,$,Y,oe){var le=$*$;if($>0&&R.size<(Y?le:$))B.numPoints+=R.length/3;else{for(var he=[],ne=0;ne<R.length;ne+=3)($===0||R[ne+2]>le)&&(B.numSimplified++,he.push(R[ne]),he.push(R[ne+1])),B.numPoints++;Y&&function(ge,Ie){for(var Se=0,we=0,at=ge.length,it=at-2;we<at;it=we,we+=2)Se+=(ge[we]-ge[it])*(ge[we+1]+ge[it+1]);if(Se>0===Ie)for(we=0,at=ge.length;we<at/2;we+=2){var It=ge[we],yt=ge[we+1];ge[we]=ge[at-2-we],ge[we+1]=ge[at-1-we],ge[at-2-we]=It,ge[at-1-we]=yt}}(he,oe),K.push(he)}}function xt(K,R){var B=(R=this.options=function(Y,oe){for(var le in oe)Y[le]=oe[le];return Y}(Object.create(this.options),R)).debug;if(B&&console.time("preprocess data"),R.maxZoom<0||R.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(R.promoteId&&R.generateId)throw new Error("promoteId and generateId cannot be used together.");var $=function(Y,oe){var le=[];if(Y.type==="FeatureCollection")for(var he=0;he<Y.features.length;he++)br(le,Y.features[he],oe,he);else br(le,Y.type==="Feature"?Y:{geometry:Y},oe);return le}(K,R);this.tiles={},this.tileCoords=[],B&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",R.indexMaxZoom,R.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),$=function(Y,oe){var le=oe.buffer/oe.extent,he=Y,ne=Ht(Y,1,-1-le,le,0,-1,2,oe),ge=Ht(Y,1,1-le,2+le,0,-1,2,oe);return(ne||ge)&&(he=Ht(Y,1,-le,1+le,0,-1,2,oe)||[],ne&&(he=Re(ne,1).concat(he)),ge&&(he=he.concat(Re(ge,-1)))),he}($,R),$.length&&this.splitTile($,0,0,0),B&&($.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Cn(K,R,B){return 32*((1<<K)*B+R)+K}function In(K,R){return R?K.properties[R]:K.id}function bt(K,R){if(K==null)return!0;if(K.type==="Feature")return In(K,R)!=null;if(K.type==="FeatureCollection"){const B=new Set;for(const $ of K.features){const Y=In($,R);if(Y==null||B.has(Y))return!1;B.add(Y)}return!0}return!1}function _o(K,R){const B=new Map;if(K!=null)if(K.type==="Feature")B.set(In(K,R),K);else for(const $ of K.features)B.set(In($,R),$);return B}xt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},xt.prototype.splitTile=function(K,R,B,$,Y,oe,le){for(var he=[K,R,B,$],ne=this.options,ge=ne.debug;he.length;){$=he.pop(),B=he.pop(),R=he.pop(),K=he.pop();var Ie=1<<R,Se=Cn(R,B,$),we=this.tiles[Se];if(!we&&(ge>1&&console.time("creation"),we=this.tiles[Se]=Yi(K,R,B,$,ne),this.tileCoords.push({z:R,x:B,y:$}),ge)){ge>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",R,B,$,we.numFeatures,we.numPoints,we.numSimplified),console.timeEnd("creation"));var at="z"+R;this.stats[at]=(this.stats[at]||0)+1,this.total++}if(we.source=K,Y){if(R===ne.maxZoom||R===Y)continue;var it=1<<Y-R;if(B!==Math.floor(oe/it)||$!==Math.floor(le/it))continue}else if(R===ne.indexMaxZoom||we.numPoints<=ne.indexMaxPoints)continue;if(we.source=null,K.length!==0){ge>1&&console.time("clipping");var It,yt,Pt,Wt,ir,Dr,wt=.5*ne.buffer/ne.extent,hr=.5-wt,Ur=.5+wt,Nn=1+wt;It=yt=Pt=Wt=null,ir=Ht(K,Ie,B-wt,B+Ur,0,we.minX,we.maxX,ne),Dr=Ht(K,Ie,B+hr,B+Nn,0,we.minX,we.maxX,ne),K=null,ir&&(It=Ht(ir,Ie,$-wt,$+Ur,1,we.minY,we.maxY,ne),yt=Ht(ir,Ie,$+hr,$+Nn,1,we.minY,we.maxY,ne),ir=null),Dr&&(Pt=Ht(Dr,Ie,$-wt,$+Ur,1,we.minY,we.maxY,ne),Wt=Ht(Dr,Ie,$+hr,$+Nn,1,we.minY,we.maxY,ne),Dr=null),ge>1&&console.timeEnd("clipping"),he.push(It||[],R+1,2*B,2*$),he.push(yt||[],R+1,2*B,2*$+1),he.push(Pt||[],R+1,2*B+1,2*$),he.push(Wt||[],R+1,2*B+1,2*$+1)}}},xt.prototype.getTile=function(K,R,B){var $=this.options,Y=$.extent,oe=$.debug;if(K<0||K>24)return null;var le=1<<K,he=Cn(K,R=(R%le+le)%le,B);if(this.tiles[he])return on(this.tiles[he],Y);oe>1&&console.log("drilling down to z%d-%d-%d",K,R,B);for(var ne,ge=K,Ie=R,Se=B;!ne&&ge>0;)ge--,Ie=Math.floor(Ie/2),Se=Math.floor(Se/2),ne=this.tiles[Cn(ge,Ie,Se)];return ne&&ne.source?(oe>1&&console.log("found parent tile z%d-%d-%d",ge,Ie,Se),oe>1&&console.time("drilling down"),this.splitTile(ne.source,ge,Ie,Se,K,R,B),oe>1&&console.timeEnd("drilling down"),this.tiles[he]?on(this.tiles[he],Y):null):null};class vo extends j{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(R,B){return v._(this,void 0,void 0,function*(){const $=R.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const Y=this._geoJSONIndex.getTile($.z,$.x,$.y);if(!Y)return null;const oe=new class{constructor(he){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=v.W,this.length=he.length,this._features=he}feature(he){return new class{constructor(ne){this._feature=ne,this.extent=v.W,this.type=ne.type,this.properties=ne.tags,"id"in ne&&!isNaN(ne.id)&&(this.id=parseInt(ne.id,10))}loadGeometry(){if(this._feature.type===1){const ne=[];for(const ge of this._feature.geometry)ne.push([new v.P(ge[0],ge[1])]);return ne}{const ne=[];for(const ge of this._feature.geometry){const Ie=[];for(const Se of ge)Ie.push(new v.P(Se[0],Se[1]));ne.push(Ie)}return ne}}toGeoJSON(ne,ge,Ie){return je.call(this,ne,ge,Ie)}}(this._features[he])}}(Y.features);let le=Rr(oe);return le.byteOffset===0&&le.byteLength===le.buffer.byteLength||(le=new Uint8Array(le)),{vectorTile:oe,rawData:le.buffer}})}loadData(R){return v._(this,void 0,void 0,function*(){var B;(B=this._pendingRequest)===null||B===void 0||B.abort();const $=!!(R&&R.request&&R.request.collectResourceTiming)&&new v.bt(R.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(R,this._pendingRequest),this._geoJSONIndex=R.cluster?new xr(function({superclusterOptions:oe,clusterProperties:le}){if(!le||!oe)return oe;const he={},ne={},ge={accumulated:null,zoom:0},Ie={properties:null},Se=Object.keys(le);for(const we of Se){const[at,it]=le[we],It=v.bA(it),yt=v.bA(typeof at=="string"?[at,["accumulated"],["get",we]]:at);he[we]=It.value,ne[we]=yt.value}return oe.map=we=>{Ie.properties=we;const at={};for(const it of Se)at[it]=he[it].evaluate(ge,Ie);return at},oe.reduce=(we,at)=>{Ie.properties=at;for(const it of Se)ge.accumulated=we[it],we[it]=ne[it].evaluate(ge,Ie)},oe}(R)).load((yield this._pendingData).features):new xt(yield this._pendingData,R.geojsonVtOptions),this.loaded={};const Y={};if($){const oe=$.finish();oe&&(Y.resourceTiming={},Y.resourceTiming[R.source]=JSON.parse(JSON.stringify(oe)))}return Y}catch(Y){if(delete this._pendingRequest,v.bz(Y))return{abandoned:!0};throw Y}})}getData(){return v._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(R){const B=this.loaded;return B&&B[R.uid]?super.reloadTile(R):this.loadTile(R)}loadAndProcessGeoJSON(R,B){return v._(this,void 0,void 0,function*(){let $=yield this.loadGeoJSON(R,B);if(delete this._pendingRequest,typeof $!="object")throw new Error(`Input data given to '${R.source}' is not a valid GeoJSON object.`);if(pe($,!0),R.filter){const Y=v.bA(R.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Y.result==="error")throw new Error(Y.value.map(le=>`${le.key}: ${le.message}`).join(", "));$={type:"FeatureCollection",features:$.features.filter(le=>Y.value.evaluate({zoom:0},le))}}return $})}loadGeoJSON(R,B){return v._(this,void 0,void 0,function*(){const{promoteId:$}=R;if(R.request){const Y=yield v.h(R.request,B);return this._dataUpdateable=bt(Y.data,$)?_o(Y.data,$):void 0,Y.data}if(typeof R.data=="string")try{const Y=JSON.parse(R.data);return this._dataUpdateable=bt(Y,$)?_o(Y,$):void 0,Y}catch{throw new Error(`Input data given to '${R.source}' is not a valid GeoJSON object.`)}if(!R.dataDiff)throw new Error(`Input data given to '${R.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${R.source}`);return function(Y,oe,le){var he,ne,ge,Ie;if(oe.removeAll&&Y.clear(),oe.remove)for(const Se of oe.remove)Y.delete(Se);if(oe.add)for(const Se of oe.add){const we=In(Se,le);we!=null&&Y.set(we,Se)}if(oe.update)for(const Se of oe.update){let we=Y.get(Se.id);if(we==null)continue;const at=!Se.removeAllProperties&&(((he=Se.removeProperties)===null||he===void 0?void 0:he.length)>0||((ne=Se.addOrUpdateProperties)===null||ne===void 0?void 0:ne.length)>0);if((Se.newGeometry||Se.removeAllProperties||at)&&(we=Object.assign({},we),Y.set(Se.id,we),at&&(we.properties=Object.assign({},we.properties))),Se.newGeometry&&(we.geometry=Se.newGeometry),Se.removeAllProperties)we.properties={};else if(((ge=Se.removeProperties)===null||ge===void 0?void 0:ge.length)>0)for(const it of Se.removeProperties)Object.prototype.hasOwnProperty.call(we.properties,it)&&delete we.properties[it];if(((Ie=Se.addOrUpdateProperties)===null||Ie===void 0?void 0:Ie.length)>0)for(const{key:it,value:It}of Se.addOrUpdateProperties)we.properties[it]=It}}(this._dataUpdateable,R.dataDiff,$),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(R){return v._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(R){return this._geoJSONIndex.getClusterExpansionZoom(R.clusterId)}getClusterChildren(R){return this._geoJSONIndex.getChildren(R.clusterId)}getClusterLeaves(R){return this._geoJSONIndex.getLeaves(R.clusterId,R.limit,R.offset)}}class Yr{constructor(R){this.self=R,this.actor=new v.C(R),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(B,$)=>{if(this.externalWorkerSourceTypes[B])throw new Error(`Worker source with name "${B}" already registered.`);this.externalWorkerSourceTypes[B]=$},this.self.addProtocol=v.bg,this.self.removeProtocol=v.bh,this.self.registerRTLTextPlugin=B=>{if(v.bB.isParsed())throw new Error("RTL text plugin already registered.");v.bB.setMethods(B)},this.actor.registerMessageHandler("LDT",(B,$)=>this._getDEMWorkerSource(B,$.source).loadTile($)),this.actor.registerMessageHandler("RDT",(B,$)=>v._(this,void 0,void 0,function*(){this._getDEMWorkerSource(B,$.source).removeTile($)})),this.actor.registerMessageHandler("GCEZ",(B,$)=>v._(this,void 0,void 0,function*(){return this._getWorkerSource(B,$.type,$.source).getClusterExpansionZoom($)})),this.actor.registerMessageHandler("GCC",(B,$)=>v._(this,void 0,void 0,function*(){return this._getWorkerSource(B,$.type,$.source).getClusterChildren($)})),this.actor.registerMessageHandler("GCL",(B,$)=>v._(this,void 0,void 0,function*(){return this._getWorkerSource(B,$.type,$.source).getClusterLeaves($)})),this.actor.registerMessageHandler("LD",(B,$)=>this._getWorkerSource(B,$.type,$.source).loadData($)),this.actor.registerMessageHandler("GD",(B,$)=>this._getWorkerSource(B,$.type,$.source).getData()),this.actor.registerMessageHandler("LT",(B,$)=>this._getWorkerSource(B,$.type,$.source).loadTile($)),this.actor.registerMessageHandler("RT",(B,$)=>this._getWorkerSource(B,$.type,$.source).reloadTile($)),this.actor.registerMessageHandler("AT",(B,$)=>this._getWorkerSource(B,$.type,$.source).abortTile($)),this.actor.registerMessageHandler("RMT",(B,$)=>this._getWorkerSource(B,$.type,$.source).removeTile($)),this.actor.registerMessageHandler("RS",(B,$)=>v._(this,void 0,void 0,function*(){if(!this.workerSources[B]||!this.workerSources[B][$.type]||!this.workerSources[B][$.type][$.source])return;const Y=this.workerSources[B][$.type][$.source];delete this.workerSources[B][$.type][$.source],Y.removeSource!==void 0&&Y.removeSource($)})),this.actor.registerMessageHandler("RM",B=>v._(this,void 0,void 0,function*(){delete this.layerIndexes[B],delete this.availableImages[B],delete this.workerSources[B],delete this.demWorkerSources[B]})),this.actor.registerMessageHandler("SR",(B,$)=>v._(this,void 0,void 0,function*(){this.referrer=$})),this.actor.registerMessageHandler("SRPS",(B,$)=>this._syncRTLPluginState(B,$)),this.actor.registerMessageHandler("IS",(B,$)=>v._(this,void 0,void 0,function*(){this.self.importScripts($)})),this.actor.registerMessageHandler("SI",(B,$)=>this._setImages(B,$)),this.actor.registerMessageHandler("UL",(B,$)=>v._(this,void 0,void 0,function*(){this._getLayerIndex(B).update($.layers,$.removedIds)})),this.actor.registerMessageHandler("SL",(B,$)=>v._(this,void 0,void 0,function*(){this._getLayerIndex(B).replace($)}))}_setImages(R,B){return v._(this,void 0,void 0,function*(){this.availableImages[R]=B;for(const $ in this.workerSources[R]){const Y=this.workerSources[R][$];for(const oe in Y)Y[oe].availableImages=B}})}_syncRTLPluginState(R,B){return v._(this,void 0,void 0,function*(){if(v.bB.isParsed())return v.bB.getState();if(B.pluginStatus!=="loading")return v.bB.setState(B),B;const $=B.pluginURL;if(this.self.importScripts($),v.bB.isParsed()){const Y={pluginStatus:"loaded",pluginURL:$};return v.bB.setState(Y),Y}throw v.bB.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${$}`)})}_getAvailableImages(R){let B=this.availableImages[R];return B||(B=[]),B}_getLayerIndex(R){let B=this.layerIndexes[R];return B||(B=this.layerIndexes[R]=new d),B}_getWorkerSource(R,B,$){if(this.workerSources[R]||(this.workerSources[R]={}),this.workerSources[R][B]||(this.workerSources[R][B]={}),!this.workerSources[R][B][$]){const Y={sendAsync:(oe,le)=>(oe.targetMapId=R,this.actor.sendAsync(oe,le))};switch(B){case"vector":this.workerSources[R][B][$]=new j(Y,this._getLayerIndex(R),this._getAvailableImages(R));break;case"geojson":this.workerSources[R][B][$]=new vo(Y,this._getLayerIndex(R),this._getAvailableImages(R));break;default:this.workerSources[R][B][$]=new this.externalWorkerSourceTypes[B](Y,this._getLayerIndex(R),this._getAvailableImages(R))}}return this.workerSources[R][B][$]}_getDEMWorkerSource(R,B){return this.demWorkerSources[R]||(this.demWorkerSources[R]={}),this.demWorkerSources[R][B]||(this.demWorkerSources[R][B]=new F),this.demWorkerSources[R][B]}}return v.i(self)&&(self.worker=new Yr(self)),Yr}),f("index",["exports","./shared"],function(v,d){var L="4.4.1";let U,Z;const j={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:g=>new Promise((r,a)=>{const u=requestAnimationFrame(r);g.signal.addEventListener("abort",()=>{cancelAnimationFrame(u),a(d.c())})}),getImageData(g,r=0){return this.getImageCanvasContext(g).getImageData(-r,-r,g.width+2*r,g.height+2*r)},getImageCanvasContext(g){const r=window.document.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0});if(!a)throw new Error("failed to create canvas 2d context");return r.width=g.width,r.height=g.height,a.drawImage(g,0,0,g.width,g.height),a},resolveURL:g=>(U||(U=document.createElement("a")),U.href=g,U.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Z==null&&(Z=matchMedia("(prefers-reduced-motion: reduce)")),Z.matches)}};class F{static testProp(r){if(!F.docStyle)return r[0];for(let a=0;a<r.length;a++)if(r[a]in F.docStyle)return r[a];return r[0]}static create(r,a,u){const p=window.document.createElement(r);return a!==void 0&&(p.className=a),u&&u.appendChild(p),p}static createNS(r,a){return window.document.createElementNS(r,a)}static disableDrag(){F.docStyle&&F.selectProp&&(F.userSelect=F.docStyle[F.selectProp],F.docStyle[F.selectProp]="none")}static enableDrag(){F.docStyle&&F.selectProp&&(F.docStyle[F.selectProp]=F.userSelect)}static setTransform(r,a){r.style[F.transformProp]=a}static addEventListener(r,a,u,p={}){r.addEventListener(a,u,"passive"in p?p:p.capture)}static removeEventListener(r,a,u,p={}){r.removeEventListener(a,u,"passive"in p?p:p.capture)}static suppressClickInternal(r){r.preventDefault(),r.stopPropagation(),window.removeEventListener("click",F.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",F.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",F.suppressClickInternal,!0)},0)}static getScale(r){const a=r.getBoundingClientRect();return{x:a.width/r.offsetWidth||1,y:a.height/r.offsetHeight||1,boundingClientRect:a}}static getPoint(r,a,u){const p=a.boundingClientRect;return new d.P((u.clientX-p.left)/a.x-r.clientLeft,(u.clientY-p.top)/a.y-r.clientTop)}static mousePos(r,a){const u=F.getScale(r);return F.getPoint(r,u,a)}static touchPos(r,a){const u=[],p=F.getScale(r);for(let y=0;y<a.length;y++)u.push(F.getPoint(r,p,a[y]));return u}static mouseButton(r){return r.button}static remove(r){r.parentNode&&r.parentNode.removeChild(r)}}F.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,F.selectProp=F.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),F.transformProp=F.testProp(["transform","WebkitTransform"]);const me={supported:!1,testSupport:function(g){!je&&pe&&(re?ee(g):ye=g)}};let ye,pe,je=!1,re=!1;function ee(g){const r=g.createTexture();g.bindTexture(g.TEXTURE_2D,r);try{if(g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,pe),g.isContextLost())return;me.supported=!0}catch{}g.deleteTexture(r),je=!0}var ae;typeof document<"u"&&(pe=document.createElement("img"),pe.onload=()=>{ye&&ee(ye),ye=null,re=!0},pe.onerror=()=>{je=!0,ye=null},pe.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(g){let r,a,u,p;g.resetRequestQueue=()=>{r=[],a=0,u=0,p={}},g.addThrottleControl=C=>{const k=u++;return p[k]=C,k},g.removeThrottleControl=C=>{delete p[C],w()},g.getImage=(C,k,M=!0)=>new Promise((P,O)=>{me.supported&&(C.headers||(C.headers={}),C.headers.accept="image/webp,*/*"),d.e(C,{type:"image"}),r.push({abortController:k,requestParameters:C,supportImageRefresh:M,state:"queued",onError:V=>{O(V)},onSuccess:V=>{P(V)}}),w()});const y=C=>d._(this,void 0,void 0,function*(){C.state="running";const{requestParameters:k,supportImageRefresh:M,onError:P,onSuccess:O,abortController:V}=C,H=M===!1&&!d.i(self)&&!d.g(k.url)&&(!k.headers||Object.keys(k.headers).reduce((te,se)=>te&&se==="accept",!0));a++;const J=H?T(k,V):d.m(k,V);try{const te=yield J;delete C.abortController,C.state="completed",te.data instanceof HTMLImageElement||d.b(te.data)?O(te):te.data&&O({data:yield(W=te.data,typeof createImageBitmap=="function"?d.d(W):d.f(W)),cacheControl:te.cacheControl,expires:te.expires})}catch(te){delete C.abortController,P(te)}finally{a--,w()}var W}),w=()=>{const C=(()=>{for(const k of Object.keys(p))if(p[k]())return!0;return!1})()?d.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:d.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let k=a;k<C&&r.length>0;k++){const M=r.shift();M.abortController.signal.aborted?k--:y(M)}},T=(C,k)=>new Promise((M,P)=>{const O=new Image,V=C.url,H=C.credentials;H&&H==="include"?O.crossOrigin="use-credentials":(H&&H==="same-origin"||!d.s(V))&&(O.crossOrigin="anonymous"),k.signal.addEventListener("abort",()=>{O.src="",P(d.c())}),O.fetchPriority="high",O.onload=()=>{O.onerror=O.onload=null,M({data:O})},O.onerror=()=>{O.onerror=O.onload=null,k.signal.aborted||P(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},O.src=V})}(ae||(ae={})),ae.resetRequestQueue();class xe{constructor(r){this._transformRequestFn=r}transformRequest(r,a){return this._transformRequestFn&&this._transformRequestFn(r,a)||{url:r}}setTransformRequest(r){this._transformRequestFn=r}}function Ee(g){var r=new d.A(3);return r[0]=g[0],r[1]=g[1],r[2]=g[2],r}var Pe,Ae=function(g,r,a){return g[0]=r[0]-a[0],g[1]=r[1]-a[1],g[2]=r[2]-a[2],g};Pe=new d.A(3),d.A!=Float32Array&&(Pe[0]=0,Pe[1]=0,Pe[2]=0);var Ke=function(g){var r=g[0],a=g[1];return r*r+a*a};function vt(g){const r=[];if(typeof g=="string")r.push({id:"default",url:g});else if(g&&g.length>0){const a=[];for(const{id:u,url:p}of g){const y=`${u}${p}`;a.indexOf(y)===-1&&(a.push(y),r.push({id:u,url:p}))}}return r}function ot(g,r,a){const u=g.split("?");return u[0]+=`${r}${a}`,u.join("?")}(function(){var g=new d.A(2);d.A!=Float32Array&&(g[0]=0,g[1]=0)})();class st{constructor(r,a,u,p){this.context=r,this.format=u,this.texture=r.gl.createTexture(),this.update(a,p)}update(r,a,u){const{width:p,height:y}=r,w=!(this.size&&this.size[0]===p&&this.size[1]===y||u),{context:T}=this,{gl:C}=T;if(this.useMipmap=!!(a&&a.useMipmap),C.bindTexture(C.TEXTURE_2D,this.texture),T.pixelStoreUnpackFlipY.set(!1),T.pixelStoreUnpack.set(1),T.pixelStoreUnpackPremultiplyAlpha.set(this.format===C.RGBA&&(!a||a.premultiply!==!1)),w)this.size=[p,y],r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||d.b(r)?C.texImage2D(C.TEXTURE_2D,0,this.format,this.format,C.UNSIGNED_BYTE,r):C.texImage2D(C.TEXTURE_2D,0,this.format,p,y,0,this.format,C.UNSIGNED_BYTE,r.data);else{const{x:k,y:M}=u||{x:0,y:0};r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||d.b(r)?C.texSubImage2D(C.TEXTURE_2D,0,k,M,C.RGBA,C.UNSIGNED_BYTE,r):C.texSubImage2D(C.TEXTURE_2D,0,k,M,p,y,C.RGBA,C.UNSIGNED_BYTE,r.data)}this.useMipmap&&this.isSizePowerOfTwo()&&C.generateMipmap(C.TEXTURE_2D)}bind(r,a,u){const{context:p}=this,{gl:y}=p;y.bindTexture(y.TEXTURE_2D,this.texture),u!==y.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(u=y.LINEAR),r!==this.filter&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,r),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,u||r),this.filter=r),a!==this.wrap&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,a),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,a),this.wrap=a)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:r}=this.context;r.deleteTexture(this.texture),this.texture=null}}function Ft(g){const{userImage:r}=g;return!!(r&&r.render&&r.render())&&(g.data.replace(new Uint8Array(r.data.buffer)),!0)}class Et extends d.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new d.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(r){if(this.loaded!==r&&(this.loaded=r,r)){for(const{ids:a,promiseResolve:u}of this.requestors)u(this._getImagesForIds(a));this.requestors=[]}}getImage(r){const a=this.images[r];if(a&&!a.data&&a.spriteData){const u=a.spriteData;a.data=new d.R({width:u.width,height:u.height},u.context.getImageData(u.x,u.y,u.width,u.height).data),a.spriteData=null}return a}addImage(r,a){if(this.images[r])throw new Error(`Image id ${r} already exist, use updateImage instead`);this._validate(r,a)&&(this.images[r]=a)}_validate(r,a){let u=!0;const p=a.data||a.spriteData;return this._validateStretch(a.stretchX,p&&p.width)||(this.fire(new d.j(new Error(`Image "${r}" has invalid "stretchX" value`))),u=!1),this._validateStretch(a.stretchY,p&&p.height)||(this.fire(new d.j(new Error(`Image "${r}" has invalid "stretchY" value`))),u=!1),this._validateContent(a.content,a)||(this.fire(new d.j(new Error(`Image "${r}" has invalid "content" value`))),u=!1),u}_validateStretch(r,a){if(!r)return!0;let u=0;for(const p of r){if(p[0]<u||p[1]<p[0]||a<p[1])return!1;u=p[1]}return!0}_validateContent(r,a){if(!r)return!0;if(r.length!==4)return!1;const u=a.spriteData,p=u&&u.width||a.data.width,y=u&&u.height||a.data.height;return!(r[0]<0||p<r[0]||r[1]<0||y<r[1]||r[2]<0||p<r[2]||r[3]<0||y<r[3]||r[2]<r[0]||r[3]<r[1])}updateImage(r,a,u=!0){const p=this.getImage(r);if(u&&(p.data.width!==a.data.width||p.data.height!==a.data.height))throw new Error(`size mismatch between old image (${p.data.width}x${p.data.height}) and new image (${a.data.width}x${a.data.height}).`);a.version=p.version+1,this.images[r]=a,this.updatedImages[r]=!0}removeImage(r){const a=this.images[r];delete this.images[r],delete this.patterns[r],a.userImage&&a.userImage.onRemove&&a.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(r){return new Promise((a,u)=>{let p=!0;if(!this.isLoaded())for(const y of r)this.images[y]||(p=!1);this.isLoaded()||p?a(this._getImagesForIds(r)):this.requestors.push({ids:r,promiseResolve:a})})}_getImagesForIds(r){const a={};for(const u of r){let p=this.getImage(u);p||(this.fire(new d.k("styleimagemissing",{id:u})),p=this.getImage(u)),p?a[u]={data:p.data.clone(),pixelRatio:p.pixelRatio,sdf:p.sdf,version:p.version,stretchX:p.stretchX,stretchY:p.stretchY,content:p.content,textFitWidth:p.textFitWidth,textFitHeight:p.textFitHeight,hasRenderCallback:!!(p.userImage&&p.userImage.render)}:d.w(`Image "${u}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return a}getPixelSize(){const{width:r,height:a}=this.atlasImage;return{width:r,height:a}}getPattern(r){const a=this.patterns[r],u=this.getImage(r);if(!u)return null;if(a&&a.position.version===u.version)return a.position;if(a)a.position.version=u.version;else{const p={w:u.data.width+2,h:u.data.height+2,x:0,y:0},y=new d.I(p,u);this.patterns[r]={bin:p,position:y}}return this._updatePatternAtlas(),this.patterns[r].position}bind(r){const a=r.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new st(r,this.atlasImage,a.RGBA),this.atlasTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE)}_updatePatternAtlas(){const r=[];for(const y in this.patterns)r.push(this.patterns[y].bin);const{w:a,h:u}=d.p(r),p=this.atlasImage;p.resize({width:a||1,height:u||1});for(const y in this.patterns){const{bin:w}=this.patterns[y],T=w.x+1,C=w.y+1,k=this.getImage(y).data,M=k.width,P=k.height;d.R.copy(k,p,{x:0,y:0},{x:T,y:C},{width:M,height:P}),d.R.copy(k,p,{x:0,y:P-1},{x:T,y:C-1},{width:M,height:1}),d.R.copy(k,p,{x:0,y:0},{x:T,y:C+P},{width:M,height:1}),d.R.copy(k,p,{x:M-1,y:0},{x:T-1,y:C},{width:1,height:P}),d.R.copy(k,p,{x:0,y:0},{x:T+M,y:C},{width:1,height:P})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(r){for(const a of r){if(this.callbackDispatchedThisFrame[a])continue;this.callbackDispatchedThisFrame[a]=!0;const u=this.getImage(a);u||d.w(`Image with ID: "${a}" was not found`),Ft(u)&&this.updateImage(a,u)}}}const zt=1e20;function kr(g,r,a,u,p,y,w,T,C){for(let k=r;k<r+u;k++)vr(g,a*y+k,y,p,w,T,C);for(let k=a;k<a+p;k++)vr(g,k*y+r,1,u,w,T,C)}function vr(g,r,a,u,p,y,w){y[0]=0,w[0]=-zt,w[1]=zt,p[0]=g[r];for(let T=1,C=0,k=0;T<u;T++){p[T]=g[r+T*a];const M=T*T;do{const P=y[C];k=(p[T]-p[P]+M-P*P)/(T-P)/2}while(k<=w[C]&&--C>-1);C++,y[C]=T,w[C]=k,w[C+1]=zt}for(let T=0,C=0;T<u;T++){for(;w[C+1]<T;)C++;const k=y[C],M=T-k;g[r+T*a]=p[k]+M*M}}class Rr{constructor(r,a){this.requestManager=r,this.localIdeographFontFamily=a,this.entries={}}setURL(r){this.url=r}getGlyphs(r){return d._(this,void 0,void 0,function*(){const a=[];for(const y in r)for(const w of r[y])a.push(this._getAndCacheGlyphsPromise(y,w));const u=yield Promise.all(a),p={};for(const{stack:y,id:w,glyph:T}of u)p[y]||(p[y]={}),p[y][w]=T&&{id:T.id,bitmap:T.bitmap.clone(),metrics:T.metrics};return p})}_getAndCacheGlyphsPromise(r,a){return d._(this,void 0,void 0,function*(){let u=this.entries[r];u||(u=this.entries[r]={glyphs:{},requests:{},ranges:{}});let p=u.glyphs[a];if(p!==void 0)return{stack:r,id:a,glyph:p};if(p=this._tinySDF(u,r,a),p)return u.glyphs[a]=p,{stack:r,id:a,glyph:p};const y=Math.floor(a/256);if(256*y>65535)throw new Error("glyphs > 65535 not supported");if(u.ranges[y])return{stack:r,id:a,glyph:p};if(!this.url)throw new Error("glyphsUrl is not set");if(!u.requests[y]){const T=Rr.loadGlyphRange(r,y,this.url,this.requestManager);u.requests[y]=T}const w=yield u.requests[y];for(const T in w)this._doesCharSupportLocalGlyph(+T)||(u.glyphs[+T]=w[+T]);return u.ranges[y]=!0,{stack:r,id:a,glyph:w[a]||null}})}_doesCharSupportLocalGlyph(r){return!!this.localIdeographFontFamily&&(d.u["CJK Unified Ideographs"](r)||d.u["Hangul Syllables"](r)||d.u.Hiragana(r)||d.u.Katakana(r))}_tinySDF(r,a,u){const p=this.localIdeographFontFamily;if(!p||!this._doesCharSupportLocalGlyph(u))return;let y=r.tinySDF;if(!y){let T="400";/bold/i.test(a)?T="900":/medium/i.test(a)?T="500":/light/i.test(a)&&(T="200"),y=r.tinySDF=new Rr.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:p,fontWeight:T})}const w=y.draw(String.fromCharCode(u));return{id:u,bitmap:new d.o({width:w.width||60,height:w.height||60},w.data),metrics:{width:w.glyphWidth/2||24,height:w.glyphHeight/2||24,left:w.glyphLeft/2+.5||0,top:w.glyphTop/2-27.5||-8,advance:w.glyphAdvance/2||24,isDoubleResolution:!0}}}}Rr.loadGlyphRange=function(g,r,a,u){return d._(this,void 0,void 0,function*(){const p=256*r,y=p+255,w=u.transformRequest(a.replace("{fontstack}",g).replace("{range}",`${p}-${y}`),"Glyphs"),T=yield d.l(w,new AbortController);if(!T||!T.data)throw new Error(`Could not load glyph range. range: ${r}, ${p}-${y}`);const C={};for(const k of d.n(T.data))C[k.id]=k;return C})},Rr.TinySDF=class{constructor({fontSize:g=24,buffer:r=3,radius:a=8,cutoff:u=.25,fontFamily:p="sans-serif",fontWeight:y="normal",fontStyle:w="normal"}={}){this.buffer=r,this.cutoff=u,this.radius=a;const T=this.size=g+4*r,C=this._createCanvas(T),k=this.ctx=C.getContext("2d",{willReadFrequently:!0});k.font=`${w} ${y} ${g}px ${p}`,k.textBaseline="alphabetic",k.textAlign="left",k.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Uint16Array(T)}_createCanvas(g){const r=document.createElement("canvas");return r.width=r.height=g,r}draw(g){const{width:r,actualBoundingBoxAscent:a,actualBoundingBoxDescent:u,actualBoundingBoxLeft:p,actualBoundingBoxRight:y}=this.ctx.measureText(g),w=Math.ceil(a),T=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(y-p))),C=Math.min(this.size-this.buffer,w+Math.ceil(u)),k=T+2*this.buffer,M=C+2*this.buffer,P=Math.max(k*M,0),O=new Uint8ClampedArray(P),V={data:O,width:k,height:M,glyphWidth:T,glyphHeight:C,glyphTop:w,glyphLeft:0,glyphAdvance:r};if(T===0||C===0)return V;const{ctx:H,buffer:J,gridInner:W,gridOuter:te}=this;H.clearRect(J,J,T,C),H.fillText(g,J,J+w);const se=H.getImageData(J,J,T,C);te.fill(zt,0,P),W.fill(0,0,P);for(let X=0;X<C;X++)for(let ce=0;ce<T;ce++){const fe=se.data[4*(X*T+ce)+3]/255;if(fe===0)continue;const _e=(X+J)*k+ce+J;if(fe===1)te[_e]=0,W[_e]=zt;else{const Ce=.5-fe;te[_e]=Ce>0?Ce*Ce:0,W[_e]=Ce<0?Ce*Ce:0}}kr(te,0,0,k,M,k,this.f,this.v,this.z),kr(W,J,J,T,C,k,this.f,this.v,this.z);for(let X=0;X<P;X++){const ce=Math.sqrt(te[X])-Math.sqrt(W[X]);O[X]=Math.round(255-255*(ce/this.radius+this.cutoff))}return V}};class qe{constructor(){this.specification=d.v.light.position}possiblyEvaluate(r,a){return d.y(r.expression.evaluate(a))}interpolate(r,a,u){return{x:d.z.number(r.x,a.x,u),y:d.z.number(r.y,a.y,u),z:d.z.number(r.z,a.z,u)}}}let mt;class gt extends d.E{constructor(r){super(),mt=mt||new d.q({anchor:new d.D(d.v.light.anchor),position:new qe,color:new d.D(d.v.light.color),intensity:new d.D(d.v.light.intensity)}),this._transitionable=new d.T(mt),this.setLight(r),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,a={}){if(!this._validate(d.r,r,a))for(const u in r){const p=r[u];u.endsWith("-transition")?this._transitionable.setTransition(u.slice(0,-11),p):this._transitionable.setValue(u,p)}}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,a,u){return(!u||u.validate!==!1)&&d.t(this,r.call(d.x,{value:a,style:{glyphs:!0,sprite:!0},styleSpec:d.v}))}}class At{constructor(r,a){this.width=r,this.height=a,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(r,a){const u=r.join(",")+String(a);return this.dashEntry[u]||(this.dashEntry[u]=this.addDash(r,a)),this.dashEntry[u]}getDashRanges(r,a,u){const p=[];let y=r.length%2==1?-r[r.length-1]*u:0,w=r[0]*u,T=!0;p.push({left:y,right:w,isDash:T,zeroLength:r[0]===0});let C=r[0];for(let k=1;k<r.length;k++){T=!T;const M=r[k];y=C*u,C+=M,w=C*u,p.push({left:y,right:w,isDash:T,zeroLength:M===0})}return p}addRoundDash(r,a,u){const p=a/2;for(let y=-u;y<=u;y++){const w=this.width*(this.nextRow+u+y);let T=0,C=r[T];for(let k=0;k<this.width;k++){k/C.right>1&&(C=r[++T]);const M=Math.abs(k-C.left),P=Math.abs(k-C.right),O=Math.min(M,P);let V;const H=y/u*(p+1);if(C.isDash){const J=p-Math.abs(H);V=Math.sqrt(O*O+J*J)}else V=p-Math.sqrt(O*O+H*H);this.data[w+k]=Math.max(0,Math.min(255,V+128))}}}addRegularDash(r){for(let T=r.length-1;T>=0;--T){const C=r[T],k=r[T+1];C.zeroLength?r.splice(T,1):k&&k.isDash===C.isDash&&(k.left=C.left,r.splice(T,1))}const a=r[0],u=r[r.length-1];a.isDash===u.isDash&&(a.left=u.left-this.width,u.right=a.right+this.width);const p=this.width*this.nextRow;let y=0,w=r[y];for(let T=0;T<this.width;T++){T/w.right>1&&(w=r[++y]);const C=Math.abs(T-w.left),k=Math.abs(T-w.right),M=Math.min(C,k);this.data[p+T]=Math.max(0,Math.min(255,(w.isDash?M:-M)+128))}}addDash(r,a){const u=a?7:0,p=2*u+1;if(this.nextRow+p>this.height)return d.w("LineAtlas out of space"),null;let y=0;for(let T=0;T<r.length;T++)y+=r[T];if(y!==0){const T=this.width/y,C=this.getDashRanges(r,this.width,T);a?this.addRoundDash(C,T,u):this.addRegularDash(C)}const w={y:(this.nextRow+u+.5)/this.height,height:2*u/this.height,width:y};return this.nextRow+=p,this.dirty=!0,w}bind(r){const a=r.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))}}const Lt="maplibre_preloaded_worker_pool";class Zr{constructor(){this.active={}}acquire(r){if(!this.workers)for(this.workers=[];this.workers.length<Zr.workerCount;)this.workers.push(new Worker(d.a.WORKER_URL));return this.active[r]=!0,this.workers.slice()}release(r){delete this.active[r],this.numActive()===0&&(this.workers.forEach(a=>{a.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Lt]}numActive(){return Object.keys(this.active).length}}const xr=Math.floor(j.hardwareConcurrency/2);let Kr,Ar;function Xr(){return Kr||(Kr=new Zr),Kr}Zr.workerCount=d.B(globalThis)?Math.max(Math.min(xr,3),1):1;class Ei{constructor(r,a){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=a;const u=this.workerPool.acquire(a);for(let p=0;p<u.length;p++){const y=new d.C(u[p],a);y.name=`Worker ${p}`,this.actors.push(y)}if(!this.actors.length)throw new Error("No actors found")}broadcast(r,a){const u=[];for(const p of this.actors)u.push(p.sendAsync({type:r,data:a}));return Promise.all(u)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(r=!0){this.actors.forEach(a=>{a.remove()}),this.actors=[],r&&this.workerPool.release(this.id)}registerMessageHandler(r,a){for(const u of this.actors)u.registerMessageHandler(r,a)}}function un(){return Ar||(Ar=new Ei(Xr(),d.G),Ar.registerMessageHandler("GR",(g,r,a)=>d.m(r,a))),Ar}function Do(g,r){const a=d.F();return d.H(a,a,[1,1,0]),d.J(a,a,[.5*g.width,.5*g.height,1]),d.K(a,a,g.calculatePosMatrix(r.toUnwrapped()))}function $s(g,r,a,u,p,y){const w=function(P,O,V){if(P)for(const H of P){const J=O[H];if(J&&J.source===V&&J.type==="fill-extrusion")return!0}else for(const H in O){const J=O[H];if(J.source===V&&J.type==="fill-extrusion")return!0}return!1}(p&&p.layers,r,g.id),T=y.maxPitchScaleFactor(),C=g.tilesIn(u,T,w);C.sort(fi);const k=[];for(const P of C)k.push({wrappedTileID:P.tileID.wrapped().key,queryResults:P.tile.queryRenderedFeatures(r,a,g._state,P.queryGeometry,P.cameraQueryGeometry,P.scale,p,y,T,Do(g.transform,P.tileID))});const M=function(P){const O={},V={};for(const H of P){const J=H.queryResults,W=H.wrappedTileID,te=V[W]=V[W]||{};for(const se in J){const X=J[se],ce=te[se]=te[se]||{},fe=O[se]=O[se]||[];for(const _e of X)ce[_e.featureIndex]||(ce[_e.featureIndex]=!0,fe.push(_e))}}return O}(k);for(const P in M)M[P].forEach(O=>{const V=O.feature,H=g.getFeatureState(V.layer["source-layer"],V.id);V.source=V.layer.source,V.layer["source-layer"]&&(V.sourceLayer=V.layer["source-layer"]),V.state=H});return M}function fi(g,r){const a=g.tileID,u=r.tileID;return a.overscaledZ-u.overscaledZ||a.canonical.y-u.canonical.y||a.wrap-u.wrap||a.canonical.x-u.canonical.x}function Ki(g,r,a){return d._(this,void 0,void 0,function*(){let u=g;if(g.url?u=(yield d.h(r.transformRequest(g.url,"Source"),a)).data:yield j.frameAsync(a),!u)return null;const p=d.L(d.e(u,g),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in u&&u.vector_layers&&(p.vectorLayerIds=u.vector_layers.map(y=>y.id)),p})}class br{constructor(r,a){r&&(a?this.setSouthWest(r).setNorthEast(a):Array.isArray(r)&&(r.length===4?this.setSouthWest([r[0],r[1]]).setNorthEast([r[2],r[3]]):this.setSouthWest(r[0]).setNorthEast(r[1])))}setNorthEast(r){return this._ne=r instanceof d.M?new d.M(r.lng,r.lat):d.M.convert(r),this}setSouthWest(r){return this._sw=r instanceof d.M?new d.M(r.lng,r.lat):d.M.convert(r),this}extend(r){const a=this._sw,u=this._ne;let p,y;if(r instanceof d.M)p=r,y=r;else{if(!(r instanceof br))return Array.isArray(r)?r.length===4||r.every(Array.isArray)?this.extend(br.convert(r)):this.extend(d.M.convert(r)):r&&("lng"in r||"lon"in r)&&"lat"in r?this.extend(d.M.convert(r)):this;if(p=r._sw,y=r._ne,!p||!y)return this}return a||u?(a.lng=Math.min(p.lng,a.lng),a.lat=Math.min(p.lat,a.lat),u.lng=Math.max(y.lng,u.lng),u.lat=Math.max(y.lat,u.lat)):(this._sw=new d.M(p.lng,p.lat),this._ne=new d.M(y.lng,y.lat)),this}getCenter(){return new d.M((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new d.M(this.getWest(),this.getNorth())}getSouthEast(){return new d.M(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(r){const{lng:a,lat:u}=d.M.convert(r);let p=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(p=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&p}static convert(r){return r instanceof br?r:r&&new br(r)}static fromLngLat(r,a=0){const u=360*a/40075017,p=u/Math.cos(Math.PI/180*r.lat);return new br(new d.M(r.lng-p,r.lat-u),new d.M(r.lng+p,r.lat+u))}}class Bo{constructor(r,a,u){this.bounds=br.convert(this.validateBounds(r)),this.minzoom=a||0,this.maxzoom=u||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}contains(r){const a=Math.pow(2,r.z),u=Math.floor(d.N(this.bounds.getWest())*a),p=Math.floor(d.O(this.bounds.getNorth())*a),y=Math.ceil(d.N(this.bounds.getEast())*a),w=Math.ceil(d.O(this.bounds.getSouth())*a);return r.x>=u&&r.x<y&&r.y>=p&&r.y<w}}class be extends d.E{constructor(r,a,u,p){if(super(),this.id=r,this.dispatcher=u,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,d.e(this,d.L(a,["url","scheme","tileSize","promoteId"])),this._options=d.e({type:"vector"},a),this._collectResourceTiming=a.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(p)}load(){return d._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new d.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const r=yield Ki(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),r&&(d.e(this,r),r.bounds&&(this.tileBounds=new Bo(r.bounds,this.minzoom,this.maxzoom)),this.fire(new d.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new d.k("data",{dataType:"source",sourceDataType:"content"})))}catch(r){this._tileJSONRequest=null,this.fire(new d.j(r))}})}loaded(){return this._loaded}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}onAdd(r){this.map=r,this.load()}setSourceProperty(r){this._tileJSONRequest&&this._tileJSONRequest.abort(),r(),this.load()}setTiles(r){return this.setSourceProperty(()=>{this._options.tiles=r}),this}setUrl(r){return this.setSourceProperty(()=>{this.url=r,this._options.url=r}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return d.e({},this._options)}loadTile(r){return d._(this,void 0,void 0,function*(){const a=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),u={request:this.map._requestManager.transformRequest(a,"Tile"),uid:r.uid,tileID:r.tileID,zoom:r.tileID.overscaledZ,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};u.request.collectResourceTiming=this._collectResourceTiming;let p="RT";if(r.actor&&r.state!=="expired"){if(r.state==="loading")return new Promise((y,w)=>{r.reloadPromise={resolve:y,reject:w}})}else r.actor=this.dispatcher.getActor(),p="LT";r.abortController=new AbortController;try{const y=yield r.actor.sendAsync({type:p,data:u},r.abortController);if(delete r.abortController,r.aborted)return;this._afterTileLoadWorkerResponse(r,y)}catch(y){if(delete r.abortController,r.aborted)return;if(y&&y.status!==404)throw y;this._afterTileLoadWorkerResponse(r,null)}})}_afterTileLoadWorkerResponse(r,a){if(a&&a.resourceTiming&&(r.resourceTiming=a.resourceTiming),a&&this.map._refreshExpiredTiles&&r.setExpiryData(a),r.loadVectorData(a,this.map.painter),r.reloadPromise){const u=r.reloadPromise;r.reloadPromise=null,this.loadTile(r).then(u.resolve).catch(u.reject)}}abortTile(r){return d._(this,void 0,void 0,function*(){r.abortController&&(r.abortController.abort(),delete r.abortController),r.actor&&(yield r.actor.sendAsync({type:"AT",data:{uid:r.uid,type:this.type,source:this.id}}))})}unloadTile(r){return d._(this,void 0,void 0,function*(){r.unloadVectorData(),r.actor&&(yield r.actor.sendAsync({type:"RMT",data:{uid:r.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Xi extends d.E{constructor(r,a,u,p){super(),this.id=r,this.dispatcher=u,this.setEventedParent(p),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=d.e({type:"raster"},a),d.e(this,d.L(a,["url","scheme","tileSize"]))}load(){return d._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new d.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const r=yield Ki(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,r&&(d.e(this,r),r.bounds&&(this.tileBounds=new Bo(r.bounds,this.minzoom,this.maxzoom)),this.fire(new d.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new d.k("data",{dataType:"source",sourceDataType:"content"})))}catch(r){this._tileJSONRequest=null,this.fire(new d.j(r))}})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(r){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),r(),this.load()}setTiles(r){return this.setSourceProperty(()=>{this._options.tiles=r}),this}setUrl(r){return this.setSourceProperty(()=>{this.url=r,this._options.url=r}),this}serialize(){return d.e({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r){return d._(this,void 0,void 0,function*(){const a=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);r.abortController=new AbortController;try{const u=yield ae.getImage(this.map._requestManager.transformRequest(a,"Tile"),r.abortController,this.map._refreshExpiredTiles);if(delete r.abortController,r.aborted)return void(r.state="unloaded");if(u&&u.data){this.map._refreshExpiredTiles&&u.cacheControl&&u.expires&&r.setExpiryData({cacheControl:u.cacheControl,expires:u.expires});const p=this.map.painter.context,y=p.gl,w=u.data;r.texture=this.map.painter.getTileTexture(w.width),r.texture?r.texture.update(w,{useMipmap:!0}):(r.texture=new st(p,w,y.RGBA,{useMipmap:!0}),r.texture.bind(y.LINEAR,y.CLAMP_TO_EDGE,y.LINEAR_MIPMAP_NEAREST),p.extTextureFilterAnisotropic&&y.texParameterf(y.TEXTURE_2D,p.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,p.extTextureFilterAnisotropicMax)),r.state="loaded"}}catch(u){if(delete r.abortController,r.aborted)r.state="unloaded";else if(u)throw r.state="errored",u}})}abortTile(r){return d._(this,void 0,void 0,function*(){r.abortController&&(r.abortController.abort(),delete r.abortController)})}unloadTile(r){return d._(this,void 0,void 0,function*(){r.texture&&this.map.painter.saveTileTexture(r.texture)})}hasTransition(){return!1}}class ls extends Xi{constructor(r,a,u,p){super(r,a,u,p),this.type="raster-dem",this.maxzoom=22,this._options=d.e({type:"raster-dem"},a),this.encoding=a.encoding||"mapbox",this.redFactor=a.redFactor,this.greenFactor=a.greenFactor,this.blueFactor=a.blueFactor,this.baseShift=a.baseShift}loadTile(r){return d._(this,void 0,void 0,function*(){const a=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),u=this.map._requestManager.transformRequest(a,"Tile");r.neighboringTiles=this._getNeighboringTiles(r.tileID),r.abortController=new AbortController;try{const p=yield ae.getImage(u,r.abortController,this.map._refreshExpiredTiles);if(delete r.abortController,r.aborted)return void(r.state="unloaded");if(p&&p.data){const y=p.data;this.map._refreshExpiredTiles&&p.cacheControl&&p.expires&&r.setExpiryData({cacheControl:p.cacheControl,expires:p.expires});const w=d.b(y)&&d.S()?y:yield this.readImageNow(y),T={type:this.type,uid:r.uid,source:this.id,rawImageData:w,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!r.actor||r.state==="expired"){r.actor=this.dispatcher.getActor();const C=yield r.actor.sendAsync({type:"LDT",data:T});r.dem=C,r.needsHillshadePrepare=!0,r.needsTerrainPrepare=!0,r.state="loaded"}}}catch(p){if(delete r.abortController,r.aborted)r.state="unloaded";else if(p)throw r.state="errored",p}})}readImageNow(r){return d._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&d.U()){const a=r.width+2,u=r.height+2;try{return new d.R({width:a,height:u},yield d.V(r,-1,-1,a,u))}catch{}}return j.getImageData(r,1)})}_getNeighboringTiles(r){const a=r.canonical,u=Math.pow(2,a.z),p=(a.x-1+u)%u,y=a.x===0?r.wrap-1:r.wrap,w=(a.x+1+u)%u,T=a.x+1===u?r.wrap+1:r.wrap,C={};return C[new d.Q(r.overscaledZ,y,a.z,p,a.y).key]={backfilled:!1},C[new d.Q(r.overscaledZ,T,a.z,w,a.y).key]={backfilled:!1},a.y>0&&(C[new d.Q(r.overscaledZ,y,a.z,p,a.y-1).key]={backfilled:!1},C[new d.Q(r.overscaledZ,r.wrap,a.z,a.x,a.y-1).key]={backfilled:!1},C[new d.Q(r.overscaledZ,T,a.z,w,a.y-1).key]={backfilled:!1}),a.y+1<u&&(C[new d.Q(r.overscaledZ,y,a.z,p,a.y+1).key]={backfilled:!1},C[new d.Q(r.overscaledZ,r.wrap,a.z,a.x,a.y+1).key]={backfilled:!1},C[new d.Q(r.overscaledZ,T,a.z,w,a.y+1).key]={backfilled:!1}),C}unloadTile(r){return d._(this,void 0,void 0,function*(){r.demTexture&&this.map.painter.saveTileTexture(r.demTexture),r.fbo&&(r.fbo.destroy(),delete r.fbo),r.dem&&delete r.dem,delete r.neighboringTiles,r.state="unloaded",r.actor&&(yield r.actor.sendAsync({type:"RDT",data:{type:this.type,uid:r.uid,source:this.id}}))})}}class Rt extends d.E{constructor(r,a,u,p){super(),this.id=r,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=u.getActor(),this.setEventedParent(p),this._data=a.data,this._options=d.e({},a),this._collectResourceTiming=a.collectResourceTiming,a.maxzoom!==void 0&&(this.maxzoom=a.maxzoom),a.type&&(this.type=a.type),a.attribution&&(this.attribution=a.attribution),this.promoteId=a.promoteId;const y=d.W/this.tileSize;this.workerOptions=d.e({source:this.id,cluster:a.cluster||!1,geojsonVtOptions:{buffer:(a.buffer!==void 0?a.buffer:128)*y,tolerance:(a.tolerance!==void 0?a.tolerance:.375)*y,extent:d.W,maxZoom:this.maxzoom,lineMetrics:a.lineMetrics||!1,generateId:a.generateId||!1},superclusterOptions:{maxZoom:a.clusterMaxZoom!==void 0?a.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,a.clusterMinPoints||2),extent:d.W,radius:(a.clusterRadius||50)*y,log:!1,generateId:a.generateId||!1},clusterProperties:a.clusterProperties,filter:a.filter},a.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return d._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(r){this.map=r,this.load()}setData(r){return this._data=r,this._updateWorkerData(),this}updateData(r){return this._updateWorkerData(r),this}getData(){return d._(this,void 0,void 0,function*(){const r=d.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:r})})}setClusterOptions(r){return this.workerOptions.cluster=r.cluster,r&&(r.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=r.clusterRadius),r.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=r.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(r){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:r,source:this.id}})}getClusterChildren(r){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:r,source:this.id}})}getClusterLeaves(r,a,u){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:r,limit:a,offset:u}})}_updateWorkerData(r){return d._(this,void 0,void 0,function*(){const a=d.e({type:this.type},this.workerOptions);r?a.dataDiff=r:typeof this._data=="string"?(a.request=this.map._requestManager.transformRequest(j.resolveURL(this._data),"Source"),a.request.collectResourceTiming=this._collectResourceTiming):a.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new d.k("dataloading",{dataType:"source"}));try{const u=yield this.actor.sendAsync({type:"LD",data:a});if(this._pendingLoads--,this._removed||u.abandoned)return void this.fire(new d.k("dataabort",{dataType:"source"}));let p=null;u.resourceTiming&&u.resourceTiming[this.id]&&(p=u.resourceTiming[this.id].slice(0));const y={dataType:"source"};this._collectResourceTiming&&p&&p.length>0&&d.e(y,{resourceTiming:p}),this.fire(new d.k("data",Object.assign(Object.assign({},y),{sourceDataType:"metadata"}))),this.fire(new d.k("data",Object.assign(Object.assign({},y),{sourceDataType:"content"})))}catch(u){if(this._pendingLoads--,this._removed)return void this.fire(new d.k("dataabort",{dataType:"source"}));this.fire(new d.j(u))}})}loaded(){return this._pendingLoads===0}loadTile(r){return d._(this,void 0,void 0,function*(){const a=r.actor?"RT":"LT";r.actor=this.actor;const u={type:this.type,uid:r.uid,tileID:r.tileID,zoom:r.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};r.abortController=new AbortController;const p=yield this.actor.sendAsync({type:a,data:u},r.abortController);delete r.abortController,r.unloadVectorData(),r.aborted||r.loadVectorData(p,this.map.painter,a==="RT")})}abortTile(r){return d._(this,void 0,void 0,function*(){r.abortController&&(r.abortController.abort(),delete r.abortController),r.aborted=!0})}unloadTile(r){return d._(this,void 0,void 0,function*(){r.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:r.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return d.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var Ht=d.X([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class ei extends d.E{constructor(r,a,u,p){super(),this.id=r,this.dispatcher=u,this.coordinates=a.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(p),this.options=a}load(r){return d._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new d.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const a=yield ae.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,a&&a.data&&(this.image=a.data,r&&(this.coordinates=r),this._finishLoading())}catch(a){this._request=null,this._loaded=!0,this.fire(new d.j(a))}})}loaded(){return this._loaded}updateImage(r){return r.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=r.url,this.load(r.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new d.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(r){this.map=r,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(r){this.coordinates=r;const a=r.map(d.Y.fromLngLat);this.tileID=function(p){let y=1/0,w=1/0,T=-1/0,C=-1/0;for(const O of p)y=Math.min(y,O.x),w=Math.min(w,O.y),T=Math.max(T,O.x),C=Math.max(C,O.y);const k=Math.max(T-y,C-w),M=Math.max(0,Math.floor(-Math.log(k)/Math.LN2)),P=Math.pow(2,M);return new d.a0(M,Math.floor((y+T)/2*P),Math.floor((w+C)/2*P))}(a),this.minzoom=this.maxzoom=this.tileID.z;const u=a.map(p=>this.tileID.getTilePoint(p)._round());return this._boundsArray=new d.Z,this._boundsArray.emplaceBack(u[0].x,u[0].y,0,0),this._boundsArray.emplaceBack(u[1].x,u[1].y,d.W,0),this._boundsArray.emplaceBack(u[3].x,u[3].y,0,d.W),this._boundsArray.emplaceBack(u[2].x,u[2].y,d.W,d.W),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new d.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const r=this.map.painter.context,a=r.gl;this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,Ht.members)),this.boundsSegments||(this.boundsSegments=d.$.simpleSegment(0,0,4,2)),this.texture||(this.texture=new st(r,this.image,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let u=!1;for(const p in this.tiles){const y=this.tiles[p];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture,u=!0)}u&&this.fire(new d.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(r){return d._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(r.tileID.canonical)?(this.tiles[String(r.tileID.wrap)]=r,r.buckets={}):r.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Fo extends ei{constructor(r,a,u,p){super(r,a,u,p),this.roundZoom=!0,this.type="video",this.options=a}load(){return d._(this,void 0,void 0,function*(){this._loaded=!1;const r=this.options;this.urls=[];for(const a of r.urls)this.urls.push(this.map._requestManager.transformRequest(a,"Source").url);try{const a=yield d.a2(this.urls);if(this._loaded=!0,!a)return;this.video=a,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(a){this.fire(new d.j(a))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(r){if(this.video){const a=this.video.seekable;r<a.start(0)||r>a.end(0)?this.fire(new d.j(new d.a1(`sources.${this.id}`,null,`Playback for this video can be set only between the ${a.start(0)} and ${a.end(0)}-second mark.`))):this.video.currentTime=r}}getVideo(){return this.video}onAdd(r){this.map||(this.map=r,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const r=this.map.painter.context,a=r.gl;this.boundsBuffer||(this.boundsBuffer=r.createVertexBuffer(this._boundsArray,Ht.members)),this.boundsSegments||(this.boundsSegments=d.$.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,this.video)):(this.texture=new st(r,this.video,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let u=!1;for(const p in this.tiles){const y=this.tiles[p];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture,u=!0)}u&&this.fire(new d.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class cs extends ei{constructor(r,a,u,p){super(r,a,u,p),a.coordinates?Array.isArray(a.coordinates)&&a.coordinates.length===4&&!a.coordinates.some(y=>!Array.isArray(y)||y.length!==2||y.some(w=>typeof w!="number"))||this.fire(new d.j(new d.a1(`sources.${r}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new d.j(new d.a1(`sources.${r}`,null,'missing required property "coordinates"'))),a.animate&&typeof a.animate!="boolean"&&this.fire(new d.j(new d.a1(`sources.${r}`,null,'optional "animate" property must be a boolean value'))),a.canvas?typeof a.canvas=="string"||a.canvas instanceof HTMLCanvasElement||this.fire(new d.j(new d.a1(`sources.${r}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new d.j(new d.a1(`sources.${r}`,null,'missing required property "canvas"'))),this.options=a,this.animate=a.animate===void 0||a.animate}load(){return d._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new d.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(r){this.map=r,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let r=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,r=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,r=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const a=this.map.painter.context,u=a.gl;this.boundsBuffer||(this.boundsBuffer=a.createVertexBuffer(this._boundsArray,Ht.members)),this.boundsSegments||(this.boundsSegments=d.$.simpleSegment(0,0,4,2)),this.texture?(r||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new st(a,this.canvas,u.RGBA,{premultiply:!0});let p=!1;for(const y in this.tiles){const w=this.tiles[y];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture,p=!0)}p&&this.fire(new d.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const r of[this.canvas.width,this.canvas.height])if(isNaN(r)||r<=0)return!0;return!1}}const ki={},Tn=g=>{switch(g){case"geojson":return Rt;case"image":return ei;case"raster":return Xi;case"raster-dem":return ls;case"vector":return be;case"video":return Fo;case"canvas":return cs}return ki[g]},Oo="RTLPluginLoaded";class us extends d.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=un()}_syncState(r){return this.status=r,this.dispatcher.broadcast("SRPS",{pluginStatus:r,pluginURL:this.url}).catch(a=>{throw this.status="error",a})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(r){return d._(this,arguments,void 0,function*(a,u=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=j.resolveURL(a),!this.url)throw new Error(`requested url ${a} is invalid`);if(this.status==="unavailable"){if(!u)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return d._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new d.k(Oo))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Re=null;function ht(){return Re||(Re=new us),Re}class on{constructor(r,a){this.timeAdded=0,this.fadeEndTime=0,this.tileID=r,this.uid=d.a3(),this.uses=0,this.tileSize=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(r){const a=r+this.timeAdded;a<this.fadeEndTime||(this.fadeEndTime=a)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(r){this.demTexture&&r.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(r,a,u){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",r){r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=function(p,y){const w={};if(!y)return w;for(const T of p){const C=T.layerIds.map(k=>y.getLayer(k)).filter(Boolean);if(C.length!==0){T.layers=C,T.stateDependentLayerIds&&(T.stateDependentLayers=T.stateDependentLayerIds.map(k=>C.filter(M=>M.id===k)[0]));for(const k of C)w[k.id]=T}}return w}(r.buckets,a.style),this.hasSymbolBuckets=!1;for(const p in this.buckets){const y=this.buckets[p];if(y instanceof d.a5){if(this.hasSymbolBuckets=!0,!u)break;y.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const p in this.buckets){const y=this.buckets[p];if(y instanceof d.a5&&y.hasRTLText){this.hasRTLText=!0,ht().lazyLoad();break}}this.queryPadding=0;for(const p in this.buckets){const y=this.buckets[p];this.queryPadding=Math.max(this.queryPadding,a.style.getLayer(p).queryRadius(y))}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage)}else this.collisionBoxArray=new d.a4}unloadVectorData(){for(const r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(r){return this.buckets[r.id]}upload(r){for(const u in this.buckets){const p=this.buckets[u];p.uploadPending()&&p.upload(r)}const a=r.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new st(r,this.imageAtlas.image,a.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new st(r,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null)}prepare(r){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture)}queryRenderedFeatures(r,a,u,p,y,w,T,C,k,M){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:p,cameraQueryGeometry:y,scale:w,tileSize:this.tileSize,pixelPosMatrix:M,transform:C,params:T,queryPadding:this.queryPadding*k},r,a,u):{}}querySourceFeatures(r,a){const u=this.latestFeatureIndex;if(!u||!u.rawTileData)return;const p=u.loadVTLayers(),y=a&&a.sourceLayer?a.sourceLayer:"",w=p._geojsonTileLayer||p[y];if(!w)return;const T=d.a6(a&&a.filter),{z:C,x:k,y:M}=this.tileID.canonical,P={z:C,x:k,y:M};for(let O=0;O<w.length;O++){const V=w.feature(O);if(T.needGeometry){const W=d.a7(V,!0);if(!T.filter(new d.a8(this.tileID.overscaledZ),W,this.tileID.canonical))continue}else if(!T.filter(new d.a8(this.tileID.overscaledZ),V))continue;const H=u.getId(V,y),J=new d.a9(V,C,k,M,H);J.tile=P,r.push(J)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(r){const a=this.expirationTime;if(r.cacheControl){const u=d.aa(r.cacheControl);u["max-age"]&&(this.expirationTime=Date.now()+1e3*u["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){const u=Date.now();let p=!1;if(this.expirationTime>u)p=!1;else if(a)if(this.expirationTime<a)p=!0;else{const y=this.expirationTime-a;y?this.expirationTime=u+Math.max(y,3e4):p=!0}else p=!0;p?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(r,a){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(r).length===0)return;const u=this.latestFeatureIndex.loadVTLayers();for(const p in this.buckets){if(!a.style.hasLayer(p))continue;const y=this.buckets[p],w=y.layers[0].sourceLayer||"_geojsonTileLayer",T=u[w],C=r[w];if(!T||!C||Object.keys(C).length===0)continue;y.update(C,T,this.imageAtlas&&this.imageAtlas.patternPositions||{});const k=a&&a.style&&a.style.getLayer(p);k&&(this.queryPadding=Math.max(this.queryPadding,k.queryRadius(y)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<j.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(r){this.symbolFadeHoldUntil=j.now()+r}setDependencies(r,a){const u={};for(const p of a)u[p]=!0;this.dependencies[r]=u}hasDependency(r,a){for(const u of r){const p=this.dependencies[u];if(p){for(const y of a)if(p[y])return!0}}return!1}}class No{constructor(r,a){this.max=r,this.onRemove=a,this.reset()}reset(){for(const r in this.data)for(const a of this.data[r])a.timeout&&clearTimeout(a.timeout),this.onRemove(a.value);return this.data={},this.order=[],this}add(r,a,u){const p=r.wrapped().key;this.data[p]===void 0&&(this.data[p]=[]);const y={value:a,timeout:void 0};if(u!==void 0&&(y.timeout=setTimeout(()=>{this.remove(r,y)},u)),this.data[p].push(y),this.order.push(p),this.order.length>this.max){const w=this._getAndRemoveByKey(this.order[0]);w&&this.onRemove(w)}return this}has(r){return r.wrapped().key in this.data}getAndRemove(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null}_getAndRemoveByKey(r){const a=this.data[r].shift();return a.timeout&&clearTimeout(a.timeout),this.data[r].length===0&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),a.value}getByKey(r){const a=this.data[r];return a?a[0].value:null}get(r){return this.has(r)?this.data[r.wrapped().key][0].value:null}remove(r,a){if(!this.has(r))return this;const u=r.wrapped().key,p=a===void 0?0:this.data[u].indexOf(a),y=this.data[u][p];return this.data[u].splice(p,1),y.timeout&&clearTimeout(y.timeout),this.data[u].length===0&&delete this.data[u],this.onRemove(y.value),this.order.splice(this.order.indexOf(u),1),this}setMaxSize(r){for(this.max=r;this.order.length>this.max;){const a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this}filter(r){const a=[];for(const u in this.data)for(const p of this.data[u])r(p.value)||a.push(p);for(const u of a)this.remove(u.value.tileID,u)}}class Yi{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(r,a,u){const p=String(a);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][p]=this.stateChanges[r][p]||{},d.e(this.stateChanges[r][p],u),this.deletedStates[r]===null){this.deletedStates[r]={};for(const y in this.state[r])y!==p&&(this.deletedStates[r][y]=null)}else if(this.deletedStates[r]&&this.deletedStates[r][p]===null){this.deletedStates[r][p]={};for(const y in this.state[r][p])u[y]||(this.deletedStates[r][p][y]=null)}else for(const y in u)this.deletedStates[r]&&this.deletedStates[r][p]&&this.deletedStates[r][p][y]===null&&delete this.deletedStates[r][p][y]}removeFeatureState(r,a,u){if(this.deletedStates[r]===null)return;const p=String(a);if(this.deletedStates[r]=this.deletedStates[r]||{},u&&a!==void 0)this.deletedStates[r][p]!==null&&(this.deletedStates[r][p]=this.deletedStates[r][p]||{},this.deletedStates[r][p][u]=null);else if(a!==void 0)if(this.stateChanges[r]&&this.stateChanges[r][p])for(u in this.deletedStates[r][p]={},this.stateChanges[r][p])this.deletedStates[r][p][u]=null;else this.deletedStates[r][p]=null;else this.deletedStates[r]=null}getState(r,a){const u=String(a),p=d.e({},(this.state[r]||{})[u],(this.stateChanges[r]||{})[u]);if(this.deletedStates[r]===null)return{};if(this.deletedStates[r]){const y=this.deletedStates[r][a];if(y===null)return{};for(const w in y)delete p[w]}return p}initializeTileState(r,a){r.setFeatureState(this.state,a)}coalesceChanges(r,a){const u={};for(const p in this.stateChanges){this.state[p]=this.state[p]||{};const y={};for(const w in this.stateChanges[p])this.state[p][w]||(this.state[p][w]={}),d.e(this.state[p][w],this.stateChanges[p][w]),y[w]=this.state[p][w];u[p]=y}for(const p in this.deletedStates){this.state[p]=this.state[p]||{};const y={};if(this.deletedStates[p]===null)for(const w in this.state[p])y[w]={},this.state[p][w]={};else for(const w in this.deletedStates[p]){if(this.deletedStates[p][w]===null)this.state[p][w]={};else for(const T of Object.keys(this.deletedStates[p][w]))delete this.state[p][w][T];y[w]=this.state[p][w]}u[p]=u[p]||{},d.e(u[p],y)}if(this.stateChanges={},this.deletedStates={},Object.keys(u).length!==0)for(const p in r)r[p].setFeatureState(u,a)}}class Le extends d.E{constructor(r,a,u){super(),this.id=r,this.dispatcher=u,this.on("data",p=>this._dataHandler(p)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((p,y,w,T)=>{const C=new(Tn(y.type))(p,y,w,T);if(C.id!==p)throw new Error(`Expected Source id to be ${p} instead of ${C.id}`);return C})(r,a,u,this),this._tiles={},this._cache=new No(0,p=>this._unloadTile(p)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Yi,this._didEmitContent=!1,this._updated=!1}onAdd(r){this.map=r,this._maxTileCacheSize=r?r._maxTileCacheSize:null,this._maxTileCacheZoomLevels=r?r._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(r)}onRemove(r){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(r)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const r in this._tiles){const a=this._tiles[r];if(a.state!=="loaded"&&a.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const r=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,r&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(r,a,u){return d._(this,void 0,void 0,function*(){try{yield this._source.loadTile(r),this._tileLoaded(r,a,u)}catch(p){r.state="errored",p.status!==404?this._source.fire(new d.j(p,{tile:r})):this.update(this.transform,this.terrain)}})}_unloadTile(r){this._source.unloadTile&&this._source.unloadTile(r)}_abortTile(r){this._source.abortTile&&this._source.abortTile(r),this._source.fire(new d.k("dataabort",{tile:r,coord:r.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(r){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const a in this._tiles){const u=this._tiles[a];u.upload(r),u.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(r=>r.tileID).sort(St).map(r=>r.key)}getRenderableIds(r){const a=[];for(const u in this._tiles)this._isIdRenderable(u,r)&&a.push(this._tiles[u]);return r?a.sort((u,p)=>{const y=u.tileID,w=p.tileID,T=new d.P(y.canonical.x,y.canonical.y)._rotate(this.transform.angle),C=new d.P(w.canonical.x,w.canonical.y)._rotate(this.transform.angle);return y.overscaledZ-w.overscaledZ||C.y-T.y||C.x-T.x}).map(u=>u.tileID.key):a.map(u=>u.tileID).sort(St).map(u=>u.key)}hasRenderableParent(r){const a=this.findLoadedParent(r,0);return!!a&&this._isIdRenderable(a.tileID.key)}_isIdRenderable(r,a){return this._tiles[r]&&this._tiles[r].hasData()&&!this._coveredTiles[r]&&(a||!this._tiles[r].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)this._tiles[r].state!=="errored"&&this._reloadTile(r,"reloading")}}_reloadTile(r,a){return d._(this,void 0,void 0,function*(){const u=this._tiles[r];u&&(u.state!=="loading"&&(u.state=a),yield this._loadTile(u,r,a))})}_tileLoaded(r,a,u){r.timeAdded=j.now(),u==="expired"&&(r.refreshedUponExpiration=!0),this._setTileReloadTimer(a,r),this.getSource().type==="raster-dem"&&r.dem&&this._backfillDEM(r),this._state.initializeTileState(r,this.map?this.map.painter:null),r.aborted||this._source.fire(new d.k("data",{dataType:"source",tile:r,coord:r.tileID}))}_backfillDEM(r){const a=this.getRenderableIds();for(let p=0;p<a.length;p++){const y=a[p];if(r.neighboringTiles&&r.neighboringTiles[y]){const w=this.getTileByID(y);u(r,w),u(w,r)}}function u(p,y){p.needsHillshadePrepare=!0,p.needsTerrainPrepare=!0;let w=y.tileID.canonical.x-p.tileID.canonical.x;const T=y.tileID.canonical.y-p.tileID.canonical.y,C=Math.pow(2,p.tileID.canonical.z),k=y.tileID.key;w===0&&T===0||Math.abs(T)>1||(Math.abs(w)>1&&(Math.abs(w+C)===1?w+=C:Math.abs(w-C)===1&&(w-=C)),y.dem&&p.dem&&(p.dem.backfillBorder(y.dem,w,T),p.neighboringTiles&&p.neighboringTiles[k]&&(p.neighboringTiles[k].backfilled=!0)))}}getTile(r){return this.getTileByID(r.key)}getTileByID(r){return this._tiles[r]}_retainLoadedChildren(r,a,u,p){for(const y in this._tiles){let w=this._tiles[y];if(p[y]||!w.hasData()||w.tileID.overscaledZ<=a||w.tileID.overscaledZ>u)continue;let T=w.tileID;for(;w&&w.tileID.overscaledZ>a+1;){const k=w.tileID.scaledTo(w.tileID.overscaledZ-1);w=this._tiles[k.key],w&&w.hasData()&&(T=k)}let C=T;for(;C.overscaledZ>a;)if(C=C.scaledTo(C.overscaledZ-1),r[C.key]){p[T.key]=T;break}}}findLoadedParent(r,a){if(r.key in this._loadedParentTiles){const u=this._loadedParentTiles[r.key];return u&&u.tileID.overscaledZ>=a?u:null}for(let u=r.overscaledZ-1;u>=a;u--){const p=r.scaledTo(u),y=this._getLoadedTile(p);if(y)return y}}findLoadedSibling(r){return this._getLoadedTile(r)}_getLoadedTile(r){const a=this._tiles[r.key];return a&&a.hasData()?a:this._cache.getByKey(r.wrapped().key)}updateCacheSize(r){const a=Math.ceil(r.width/this._source.tileSize)+1,u=Math.ceil(r.height/this._source.tileSize)+1,p=Math.floor(a*u*(this._maxTileCacheZoomLevels===null?d.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),y=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,p):p;this._cache.setMaxSize(y)}handleWrapJump(r){const a=Math.round((r-(this._prevLng===void 0?r:this._prevLng))/360);if(this._prevLng=r,a){const u={};for(const p in this._tiles){const y=this._tiles[p];y.tileID=y.tileID.unwrapTo(y.tileID.wrap+a),u[y.tileID.key]=y}this._tiles=u;for(const p in this._timers)clearTimeout(this._timers[p]),delete this._timers[p];for(const p in this._tiles)this._setTileReloadTimer(p,this._tiles[p])}}_updateCoveredAndRetainedTiles(r,a,u,p,y,w){const T={},C={},k=Object.keys(r),M=j.now();for(const P of k){const O=r[P],V=this._tiles[P];if(!V||V.fadeEndTime!==0&&V.fadeEndTime<=M)continue;const H=this.findLoadedParent(O,a),J=this.findLoadedSibling(O),W=H||J||null;W&&(this._addTile(W.tileID),T[W.tileID.key]=W.tileID),C[P]=O}this._retainLoadedChildren(C,p,u,r);for(const P in T)r[P]||(this._coveredTiles[P]=!0,r[P]=T[P]);if(w){const P={},O={};for(const V of y)this._tiles[V.key].hasData()?P[V.key]=V:O[V.key]=V;for(const V in O){const H=O[V].children(this._source.maxzoom);this._tiles[H[0].key]&&this._tiles[H[1].key]&&this._tiles[H[2].key]&&this._tiles[H[3].key]&&(P[H[0].key]=r[H[0].key]=H[0],P[H[1].key]=r[H[1].key]=H[1],P[H[2].key]=r[H[2].key]=H[2],P[H[3].key]=r[H[3].key]=H[3],delete O[V])}for(const V in O){const H=O[V],J=this.findLoadedParent(H,this._source.minzoom),W=this.findLoadedSibling(H),te=J||W||null;if(te){P[te.tileID.key]=r[te.tileID.key]=te.tileID;for(const se in P)P[se].isChildOf(te.tileID)&&delete P[se]}}for(const V in this._tiles)P[V]||(this._coveredTiles[V]=!0)}}update(r,a){if(!this._sourceLoaded||this._paused)return;let u;this.transform=r,this.terrain=a,this.updateCacheSize(r),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?u=r.getVisibleUnwrappedCoordinates(this._source.tileID).map(M=>new d.Q(M.canonical.z,M.wrap,M.canonical.z,M.canonical.x,M.canonical.y)):(u=r.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:a}),this._source.hasTile&&(u=u.filter(M=>this._source.hasTile(M)))):u=[];const p=r.coveringZoomLevel(this._source),y=Math.max(p-Le.maxOverzooming,this._source.minzoom),w=Math.max(p+Le.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const M={};for(const P of u)if(P.canonical.z>this._source.minzoom){const O=P.scaledTo(P.canonical.z-1);M[O.key]=O;const V=P.scaledTo(Math.max(this._source.minzoom,Math.min(P.canonical.z,5)));M[V.key]=V}u=u.concat(Object.values(M))}const T=u.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,T&&this.fire(new d.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const C=this._updateRetainedTiles(u,p);xt(this._source.type)&&this._updateCoveredAndRetainedTiles(C,y,w,p,u,a);for(const M in C)this._tiles[M].clearFadeHold();const k=d.ab(this._tiles,C);for(const M of k){const P=this._tiles[M];P.hasSymbolBuckets&&!P.holdingForFade()?P.setHoldDuration(this.map._fadeDuration):P.hasSymbolBuckets&&!P.symbolFadeFinished()||this._removeTile(M)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const r in this._tiles)this._tiles[r].holdingForFade()&&this._removeTile(r)}_updateRetainedTiles(r,a){var u;const p={},y={},w=Math.max(a-Le.maxOverzooming,this._source.minzoom),T=Math.max(a+Le.maxUnderzooming,this._source.minzoom),C={};for(const k of r){const M=this._addTile(k);p[k.key]=k,M.hasData()||a<this._source.maxzoom&&(C[k.key]=k)}this._retainLoadedChildren(C,a,T,p);for(const k of r){let M=this._tiles[k.key];if(M.hasData())continue;if(a+1>this._source.maxzoom){const O=k.children(this._source.maxzoom)[0],V=this.getTile(O);if(V&&V.hasData()){p[O.key]=O;continue}}else{const O=k.children(this._source.maxzoom);if(p[O[0].key]&&p[O[1].key]&&p[O[2].key]&&p[O[3].key])continue}let P=M.wasRequested();for(let O=k.overscaledZ-1;O>=w;--O){const V=k.scaledTo(O);if(y[V.key])break;if(y[V.key]=!0,M=this.getTile(V),!M&&P&&(M=this._addTile(V)),M){const H=M.hasData();if((H||!(!((u=this.map)===null||u===void 0)&&u.cancelPendingTileRequestsWhileZooming)||P)&&(p[V.key]=V),P=M.wasRequested(),H)break}}}return p}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const r in this._tiles){const a=[];let u,p=this._tiles[r].tileID;for(;p.overscaledZ>0;){if(p.key in this._loadedParentTiles){u=this._loadedParentTiles[p.key];break}a.push(p.key);const y=p.scaledTo(p.overscaledZ-1);if(u=this._getLoadedTile(y),u)break;p=y}for(const y of a)this._loadedParentTiles[y]=u}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const r in this._tiles){const a=this._tiles[r].tileID,u=this._getLoadedTile(a);this._loadedSiblingTiles[a.key]=u}}_addTile(r){let a=this._tiles[r.key];if(a)return a;a=this._cache.getAndRemove(r),a&&(this._setTileReloadTimer(r.key,a),a.tileID=r,this._state.initializeTileState(a,this.map?this.map.painter:null),this._cacheTimers[r.key]&&(clearTimeout(this._cacheTimers[r.key]),delete this._cacheTimers[r.key],this._setTileReloadTimer(r.key,a)));const u=a;return a||(a=new on(r,this._source.tileSize*r.overscaleFactor()),this._loadTile(a,r.key,a.state)),a.uses++,this._tiles[r.key]=a,u||this._source.fire(new d.k("dataloading",{tile:a,coord:a.tileID,dataType:"source"})),a}_setTileReloadTimer(r,a){r in this._timers&&(clearTimeout(this._timers[r]),delete this._timers[r]);const u=a.getExpiryTimeout();u&&(this._timers[r]=setTimeout(()=>{this._reloadTile(r,"expired"),delete this._timers[r]},u))}_removeTile(r){const a=this._tiles[r];a&&(a.uses--,delete this._tiles[r],this._timers[r]&&(clearTimeout(this._timers[r]),delete this._timers[r]),a.uses>0||(a.hasData()&&a.state!=="reloading"?this._cache.add(a.tileID,a,a.getExpiryTimeout()):(a.aborted=!0,this._abortTile(a),this._unloadTile(a))))}_dataHandler(r){const a=r.sourceDataType;r.dataType==="source"&&a==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&r.dataType==="source"&&a==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const r in this._tiles)this._removeTile(r);this._cache.reset()}tilesIn(r,a,u){const p=[],y=this.transform;if(!y)return p;const w=u?y.getCameraQueryGeometry(r):r,T=r.map(H=>y.pointCoordinate(H,this.terrain)),C=w.map(H=>y.pointCoordinate(H,this.terrain)),k=this.getIds();let M=1/0,P=1/0,O=-1/0,V=-1/0;for(const H of C)M=Math.min(M,H.x),P=Math.min(P,H.y),O=Math.max(O,H.x),V=Math.max(V,H.y);for(let H=0;H<k.length;H++){const J=this._tiles[k[H]];if(J.holdingForFade())continue;const W=J.tileID,te=Math.pow(2,y.zoom-J.tileID.overscaledZ),se=a*J.queryPadding*d.W/J.tileSize/te,X=[W.getTilePoint(new d.Y(M,P)),W.getTilePoint(new d.Y(O,V))];if(X[0].x-se<d.W&&X[0].y-se<d.W&&X[1].x+se>=0&&X[1].y+se>=0){const ce=T.map(_e=>W.getTilePoint(_e)),fe=C.map(_e=>W.getTilePoint(_e));p.push({tile:J,tileID:W,queryGeometry:ce,cameraQueryGeometry:fe,scale:te})}}return p}getVisibleCoordinates(r){const a=this.getRenderableIds(r).map(u=>this._tiles[u].tileID);for(const u of a)u.posMatrix=this.transform.calculatePosMatrix(u.toUnwrapped());return a}hasTransition(){if(this._source.hasTransition())return!0;if(xt(this._source.type)){const r=j.now();for(const a in this._tiles)if(this._tiles[a].fadeEndTime>=r)return!0}return!1}setFeatureState(r,a,u){this._state.updateState(r=r||"_geojsonTileLayer",a,u)}removeFeatureState(r,a,u){this._state.removeFeatureState(r=r||"_geojsonTileLayer",a,u)}getFeatureState(r,a){return this._state.getState(r=r||"_geojsonTileLayer",a)}setDependencies(r,a,u){const p=this._tiles[r];p&&p.setDependencies(a,u)}reloadTilesForDependencies(r,a){for(const u in this._tiles)this._tiles[u].hasDependency(r,a)&&this._reloadTile(u,"reloading");this._cache.filter(u=>!u.hasDependency(r,a))}}function St(g,r){const a=Math.abs(2*g.wrap)-+(g.wrap<0),u=Math.abs(2*r.wrap)-+(r.wrap<0);return g.overscaledZ-r.overscaledZ||u-a||r.canonical.y-g.canonical.y||r.canonical.x-g.canonical.x}function xt(g){return g==="raster"||g==="image"||g==="video"}Le.maxOverzooming=10,Le.maxUnderzooming=3;class Cn{constructor(r,a){this.reset(r,a)}reset(r,a){this.points=r||[],this._distances=[0];for(let u=1;u<this.points.length;u++)this._distances[u]=this._distances[u-1]+this.points[u].dist(this.points[u-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=d.ac(r,0,1);let a=1,u=this._distances[a];const p=r*this.paddedLength+this.padding;for(;u<p&&a<this._distances.length;)u=this._distances[++a];const y=a-1,w=this._distances[y],T=u-w,C=T>0?(p-w)/T:0;return this.points[y].mult(1-C).add(this.points[a].mult(C))}}function In(g,r){let a=!0;return g==="always"||g!=="never"&&r!=="never"||(a=!1),a}class bt{constructor(r,a,u){const p=this.boxCells=[],y=this.circleCells=[];this.xCellCount=Math.ceil(r/u),this.yCellCount=Math.ceil(a/u);for(let w=0;w<this.xCellCount*this.yCellCount;w++)p.push([]),y.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=a,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/a,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,a,u,p,y){this._forEachCell(a,u,p,y,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(a),this.bboxes.push(u),this.bboxes.push(p),this.bboxes.push(y)}insertCircle(r,a,u,p){this._forEachCell(a-p,u-p,a+p,u+p,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(a),this.circles.push(u),this.circles.push(p)}_insertBoxCell(r,a,u,p,y,w){this.boxCells[y].push(w)}_insertCircleCell(r,a,u,p,y,w){this.circleCells[y].push(w)}_query(r,a,u,p,y,w,T){if(u<0||r>this.width||p<0||a>this.height)return[];const C=[];if(r<=0&&a<=0&&this.width<=u&&this.height<=p){if(y)return[{key:null,x1:r,y1:a,x2:u,y2:p}];for(let k=0;k<this.boxKeys.length;k++)C.push({key:this.boxKeys[k],x1:this.bboxes[4*k],y1:this.bboxes[4*k+1],x2:this.bboxes[4*k+2],y2:this.bboxes[4*k+3]});for(let k=0;k<this.circleKeys.length;k++){const M=this.circles[3*k],P=this.circles[3*k+1],O=this.circles[3*k+2];C.push({key:this.circleKeys[k],x1:M-O,y1:P-O,x2:M+O,y2:P+O})}}else this._forEachCell(r,a,u,p,this._queryCell,C,{hitTest:y,overlapMode:w,seenUids:{box:{},circle:{}}},T);return C}query(r,a,u,p){return this._query(r,a,u,p,!1,null)}hitTest(r,a,u,p,y,w){return this._query(r,a,u,p,!0,y,w).length>0}hitTestCircle(r,a,u,p,y){const w=r-u,T=r+u,C=a-u,k=a+u;if(T<0||w>this.width||k<0||C>this.height)return!1;const M=[];return this._forEachCell(w,C,T,k,this._queryCellCircle,M,{hitTest:!0,overlapMode:p,circle:{x:r,y:a,radius:u},seenUids:{box:{},circle:{}}},y),M.length>0}_queryCell(r,a,u,p,y,w,T,C){const{seenUids:k,hitTest:M,overlapMode:P}=T,O=this.boxCells[y];if(O!==null){const H=this.bboxes;for(const J of O)if(!k.box[J]){k.box[J]=!0;const W=4*J,te=this.boxKeys[J];if(r<=H[W+2]&&a<=H[W+3]&&u>=H[W+0]&&p>=H[W+1]&&(!C||C(te))&&(!M||!In(P,te.overlapMode))&&(w.push({key:te,x1:H[W],y1:H[W+1],x2:H[W+2],y2:H[W+3]}),M))return!0}}const V=this.circleCells[y];if(V!==null){const H=this.circles;for(const J of V)if(!k.circle[J]){k.circle[J]=!0;const W=3*J,te=this.circleKeys[J];if(this._circleAndRectCollide(H[W],H[W+1],H[W+2],r,a,u,p)&&(!C||C(te))&&(!M||!In(P,te.overlapMode))){const se=H[W],X=H[W+1],ce=H[W+2];if(w.push({key:te,x1:se-ce,y1:X-ce,x2:se+ce,y2:X+ce}),M)return!0}}}return!1}_queryCellCircle(r,a,u,p,y,w,T,C){const{circle:k,seenUids:M,overlapMode:P}=T,O=this.boxCells[y];if(O!==null){const H=this.bboxes;for(const J of O)if(!M.box[J]){M.box[J]=!0;const W=4*J,te=this.boxKeys[J];if(this._circleAndRectCollide(k.x,k.y,k.radius,H[W+0],H[W+1],H[W+2],H[W+3])&&(!C||C(te))&&!In(P,te.overlapMode))return w.push(!0),!0}}const V=this.circleCells[y];if(V!==null){const H=this.circles;for(const J of V)if(!M.circle[J]){M.circle[J]=!0;const W=3*J,te=this.circleKeys[J];if(this._circlesCollide(H[W],H[W+1],H[W+2],k.x,k.y,k.radius)&&(!C||C(te))&&!In(P,te.overlapMode))return w.push(!0),!0}}}_forEachCell(r,a,u,p,y,w,T,C){const k=this._convertToXCellCoord(r),M=this._convertToYCellCoord(a),P=this._convertToXCellCoord(u),O=this._convertToYCellCoord(p);for(let V=k;V<=P;V++)for(let H=M;H<=O;H++)if(y.call(this,r,a,u,p,this.xCellCount*H+V,w,T,C))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,a,u,p,y,w){const T=p-r,C=y-a,k=u+w;return k*k>T*T+C*C}_circleAndRectCollide(r,a,u,p,y,w,T){const C=(w-p)/2,k=Math.abs(r-(p+C));if(k>C+u)return!1;const M=(T-y)/2,P=Math.abs(a-(y+M));if(P>M+u)return!1;if(k<=C||P<=M)return!0;const O=k-C,V=P-M;return O*O+V*V<=u*u}}function _o(g,r,a,u,p){const y=d.F();return r?(d.J(y,y,[1/p,1/p,1]),a||d.ad(y,y,u.angle)):d.K(y,u.labelPlaneMatrix,g),y}function vo(g,r,a,u,p){if(r){const y=d.ae(g);return d.J(y,y,[p,p,1]),a||d.ad(y,y,-u.angle),y}return u.glCoordMatrix}function Yr(g,r,a){let u;a?(u=[g.x,g.y,a(g.x,g.y),1],d.af(u,u,r)):(u=[g.x,g.y,0,1],function(y,w,T){const C=w[0],k=w[1];y[0]=T[0]*C+T[4]*k+T[12],y[1]=T[1]*C+T[5]*k+T[13],y[3]=T[3]*C+T[7]*k+T[15]}(u,u,r));const p=u[3];return{point:new d.P(u[0]/p,u[1]/p),signedDistanceFromCamera:p,isOccluded:!1}}function K(g,r){return .5+g/r*.5}function R(g,r){return g.x>=-r[0]&&g.x<=r[0]&&g.y>=-r[1]&&g.y<=r[1]}function B(g,r,a,u,p,y,w,T,C,k,M,P,O,V,H){const J=u?g.textSizeData:g.iconSizeData,W=d.ag(J,a.transform.zoom),te=[256/a.width*2+1,256/a.height*2+1],se=u?g.text.dynamicLayoutVertexArray:g.icon.dynamicLayoutVertexArray;se.clear();const X=g.lineVertexArray,ce=u?g.text.placedSymbolArray:g.icon.placedSymbolArray,fe=a.transform.width/a.transform.height;let _e=!1;for(let Ce=0;Ce<ce.length;Ce++){const Me=ce.get(Ce);if(Me.hidden||Me.writingMode===d.ah.vertical&&!_e){at(Me.numGlyphs,se);continue}_e=!1;const He=Yr(new d.P(Me.anchorX,Me.anchorY),r,H);if(!R(He.point,te)){at(Me.numGlyphs,se);continue}const We=K(a.transform.cameraToCenterDistance,He.signedDistanceFromCamera),ze=d.ai(J,W,Me),De=w?ze/We:ze*We,Je={getElevation:H,labelPlaneMatrix:p,lineVertexArray:X,pitchWithMap:w,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:k,tileAnchorPoint:new d.P(Me.anchorX,Me.anchorY),unwrappedTileID:M,width:P,height:O,translation:V},_t=oe(Je,Me,De,!1,T,r,y,g.glyphOffsetArray,se,fe,C);_e=_t.useVertical,(_t.notEnoughRoom||_e||_t.needsFlipping&&oe(Je,Me,De,!0,T,r,y,g.glyphOffsetArray,se,fe,C).notEnoughRoom)&&at(Me.numGlyphs,se)}u?g.text.dynamicLayoutVertexBuffer.updateData(se):g.icon.dynamicLayoutVertexBuffer.updateData(se)}function $(g,r,a,u,p,y,w,T){const C=y.glyphStartIndex+y.numGlyphs,k=y.lineStartIndex,M=y.lineStartIndex+y.lineLength,P=r.getoffsetX(y.glyphStartIndex),O=r.getoffsetX(C-1),V=Se(g*P,a,u,p,y.segment,k,M,T,w);if(!V)return null;const H=Se(g*O,a,u,p,y.segment,k,M,T,w);return H?T.projectionCache.anyProjectionOccluded?null:{first:V,last:H}:null}function Y(g,r,a,u){return g===d.ah.horizontal&&Math.abs(a.y-r.y)>Math.abs(a.x-r.x)*u?{useVertical:!0}:(g===d.ah.vertical?r.y<a.y:r.x>a.x)?{needsFlipping:!0}:null}function oe(g,r,a,u,p,y,w,T,C,k,M){const P=a/24,O=r.lineOffsetX*P,V=r.lineOffsetY*P;let H;if(r.numGlyphs>1){const J=r.glyphStartIndex+r.numGlyphs,W=r.lineStartIndex,te=r.lineStartIndex+r.lineLength,se=$(P,T,O,V,u,r,M,g);if(!se)return{notEnoughRoom:!0};const X=Yr(se.first.point,w,g.getElevation).point,ce=Yr(se.last.point,w,g.getElevation).point;if(p&&!u){const fe=Y(r.writingMode,X,ce,k);if(fe)return fe}H=[se.first];for(let fe=r.glyphStartIndex+1;fe<J-1;fe++)H.push(Se(P*T.getoffsetX(fe),O,V,u,r.segment,W,te,g,M));H.push(se.last)}else{if(p&&!u){const W=Yr(g.tileAnchorPoint,y,g.getElevation).point,te=r.lineStartIndex+r.segment+1,se=new d.P(g.lineVertexArray.getx(te),g.lineVertexArray.gety(te)),X=Yr(se,y,g.getElevation),ce=X.signedDistanceFromCamera>0?X.point:function(_e,Ce,Me,He,We,ze){return le(_e,Ce,Me,1,We,ze)}(g.tileAnchorPoint,se,W,0,y,g),fe=Y(r.writingMode,W,ce,k);if(fe)return fe}const J=Se(P*T.getoffsetX(r.glyphStartIndex),O,V,u,r.segment,r.lineStartIndex,r.lineStartIndex+r.lineLength,g,M);if(!J||g.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};H=[J]}for(const J of H)d.aj(C,J.point,J.angle);return{}}function le(g,r,a,u,p,y){const w=g.add(g.sub(r)._unit()),T=p!==void 0?Yr(w,p,y.getElevation).point:ne(w.x,w.y,y).point,C=a.sub(T);return a.add(C._mult(u/C.mag()))}function he(g,r,a){const u=r.projectionCache;if(u.projections[g])return u.projections[g];const p=new d.P(r.lineVertexArray.getx(g),r.lineVertexArray.gety(g)),y=ne(p.x,p.y,r);if(y.signedDistanceFromCamera>0)return u.projections[g]=y.point,u.anyProjectionOccluded=u.anyProjectionOccluded||y.isOccluded,y.point;const w=g-a.direction;return function(T,C,k,M,P){return le(T,C,k,M,void 0,P)}(a.distanceFromAnchor===0?r.tileAnchorPoint:new d.P(r.lineVertexArray.getx(w),r.lineVertexArray.gety(w)),p,a.previousVertex,a.absOffsetX-a.distanceFromAnchor+1,r)}function ne(g,r,a){const u=g+a.translation[0],p=r+a.translation[1];let y;return!a.pitchWithMap&&a.projection.useSpecialProjectionForSymbols?(y=a.projection.projectTileCoordinates(u,p,a.unwrappedTileID,a.getElevation),y.point.x=(.5*y.point.x+.5)*a.width,y.point.y=(.5*-y.point.y+.5)*a.height):(y=Yr(new d.P(u,p),a.labelPlaneMatrix,a.getElevation),y.isOccluded=!1),y}function ge(g,r,a){return g._unit()._perp()._mult(r*a)}function Ie(g,r,a,u,p,y,w,T,C){if(T.projectionCache.offsets[g])return T.projectionCache.offsets[g];const k=a.add(r);if(g+C.direction<u||g+C.direction>=p)return T.projectionCache.offsets[g]=k,k;const M=he(g+C.direction,T,C),P=ge(M.sub(a),w,C.direction),O=a.add(P),V=M.add(P);return T.projectionCache.offsets[g]=d.ak(y,k,O,V)||k,T.projectionCache.offsets[g]}function Se(g,r,a,u,p,y,w,T,C){const k=u?g-r:g+r;let M=k>0?1:-1,P=0;u&&(M*=-1,P=Math.PI),M<0&&(P+=Math.PI);let O,V=M>0?y+p:y+p+1;T.projectionCache.cachedAnchorPoint?O=T.projectionCache.cachedAnchorPoint:(O=ne(T.tileAnchorPoint.x,T.tileAnchorPoint.y,T).point,T.projectionCache.cachedAnchorPoint=O);let H,J,W=O,te=O,se=0,X=0;const ce=Math.abs(k),fe=[];let _e;for(;se+X<=ce;){if(V+=M,V<y||V>=w)return null;se+=X,te=W,J=H;const He={absOffsetX:ce,direction:M,distanceFromAnchor:se,previousVertex:te};if(W=he(V,T,He),a===0)fe.push(te),_e=W.sub(te);else{let We;const ze=W.sub(te);We=ze.mag()===0?ge(he(V+M,T,He).sub(W),a,M):ge(ze,a,M),J||(J=te.add(We)),H=Ie(V,We,W,y,w,J,a,T,He),fe.push(J),_e=H.sub(J)}X=_e.mag()}const Ce=_e._mult((ce-se)/X)._add(J||te),Me=P+Math.atan2(W.y-te.y,W.x-te.x);return fe.push(Ce),{point:Ce,angle:C?Me:0,path:fe}}const we=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function at(g,r){for(let a=0;a<g;a++){const u=r.length;r.resize(u+4),r.float32.set(we,3*u)}}const it=100;class It{constructor(r,a,u=new bt(r.width+200,r.height+200,25),p=new bt(r.width+200,r.height+200,25)){this.transform=r,this.mapProjection=a,this.grid=u,this.ignoredGrid=p,this.pitchFactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+it,this.screenBottomBoundary=r.height+it,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(r,a,u,p,y,w,T,C,k,M,P){const O=r.anchorPointX+C[0],V=r.anchorPointY+C[1],H=this.projectAndGetPerspectiveRatio(p,O,V,y,M),J=this._projectCollisionBox(r,u,p,y,w,T,C,H,M,P),[W,te,se,X]=J.box;return this.mapProjection.useSpecialProjectionForSymbols&&(w?J.allPointsOccluded:this.mapProjection.isOccluded(O,V,y))||H.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(W,te,se,X)||a!=="always"&&this.grid.hitTest(W,te,se,X,a,k)?{box:[W,te,se,X],placeable:!1,offscreen:!1}:{box:[W,te,se,X],placeable:!0,offscreen:this.isOffscreen(W,te,se,X)}}placeCollisionCircles(r,a,u,p,y,w,T,C,k,M,P,O,V,H,J,W){const te=[],se=new d.P(a.anchorX,a.anchorY),X=this.getPerspectiveRatio(w,se.x,se.y,T,W),ce=(P?y/X:y*X)/d.ap,fe={getElevation:W,labelPlaneMatrix:C,lineVertexArray:u,pitchWithMap:P,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:se,unwrappedTileID:T,width:this.transform.width,height:this.transform.height,translation:J},_e=$(ce,p,a.lineOffsetX*ce,a.lineOffsetY*ce,!1,a,!1,fe);let Ce=!1,Me=!1,He=!0;if(_e){const We=.5*V*X+H,ze=new d.P(-100,-100),De=new d.P(this.screenRightBoundary,this.screenBottomBoundary),Je=new Cn,_t=_e.first,Fe=_e.last;let $e=[];for(let Tt=_t.path.length-1;Tt>=1;Tt--)$e.push(_t.path[Tt]);for(let Tt=1;Tt<Fe.path.length;Tt++)$e.push(Fe.path[Tt]);const dt=2.5*We;if(k){const Tt=this.projectPathToScreenSpace($e,fe,k);$e=Tt.some(kt=>kt.signedDistanceFromCamera<=0)?[]:Tt.map(kt=>kt.point)}let or=[];if($e.length>0){const Tt=$e[0].clone(),kt=$e[0].clone();for(let sr=1;sr<$e.length;sr++)Tt.x=Math.min(Tt.x,$e[sr].x),Tt.y=Math.min(Tt.y,$e[sr].y),kt.x=Math.max(kt.x,$e[sr].x),kt.y=Math.max(kt.y,$e[sr].y);or=Tt.x>=ze.x&&kt.x<=De.x&&Tt.y>=ze.y&&kt.y<=De.y?[$e]:kt.x<ze.x||Tt.x>De.x||kt.y<ze.y||Tt.y>De.y?[]:d.al([$e],ze.x,ze.y,De.x,De.y)}for(const Tt of or){Je.reset(Tt,.25*We);let kt=0;kt=Je.length<=.5*We?1:Math.ceil(Je.paddedLength/dt)+1;for(let sr=0;sr<kt;sr++){const dn=sr/Math.max(kt-1,1),Pi=Je.lerp(dn),ar=Pi.x+it,Vn=Pi.y+it;te.push(ar,Vn,We,0);const kn=ar-We,pn=Vn-We,fn=ar+We,Mi=Vn+We;if(He=He&&this.isOffscreen(kn,pn,fn,Mi),Me=Me||this.isInsideGrid(kn,pn,fn,Mi),r!=="always"&&this.grid.hitTestCircle(ar,Vn,We,r,O)&&(Ce=!0,!M))return{circles:[],offscreen:!1,collisionDetected:Ce}}}}return{circles:!M&&Ce||!Me||X<this.perspectiveRatioCutoff?[]:te,offscreen:He,collisionDetected:Ce}}projectPathToScreenSpace(r,a,u){return r.map(p=>Yr(p,u,a.getElevation))}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const a=[];let u=1/0,p=1/0,y=-1/0,w=-1/0;for(const M of r){const P=new d.P(M.x+it,M.y+it);u=Math.min(u,P.x),p=Math.min(p,P.y),y=Math.max(y,P.x),w=Math.max(w,P.y),a.push(P)}const T=this.grid.query(u,p,y,w).concat(this.ignoredGrid.query(u,p,y,w)),C={},k={};for(const M of T){const P=M.key;if(C[P.bucketInstanceId]===void 0&&(C[P.bucketInstanceId]={}),C[P.bucketInstanceId][P.featureIndex])continue;const O=[new d.P(M.x1,M.y1),new d.P(M.x2,M.y1),new d.P(M.x2,M.y2),new d.P(M.x1,M.y2)];d.am(a,O)&&(C[P.bucketInstanceId][P.featureIndex]=!0,k[P.bucketInstanceId]===void 0&&(k[P.bucketInstanceId]=[]),k[P.bucketInstanceId].push(P.featureIndex))}return k}insertCollisionBox(r,a,u,p,y,w){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:y,collisionGroupID:w,overlapMode:a},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,a,u,p,y,w){const T=u?this.ignoredGrid:this.grid,C={bucketInstanceId:p,featureIndex:y,collisionGroupID:w,overlapMode:a};for(let k=0;k<r.length;k+=4)T.insertCircle(C,r[k],r[k+1],r[k+2])}projectAndGetPerspectiveRatio(r,a,u,p,y){const w=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(a,u,p,y):Yr(new d.P(a,u),r,y);return{point:new d.P((w.point.x+1)/2*this.transform.width+it,(1-w.point.y)/2*this.transform.height+it),perspectiveRatio:.5+this.transform.cameraToCenterDistance/w.signedDistanceFromCamera*.5,isOccluded:w.isOccluded,signedDistanceFromCamera:w.signedDistanceFromCamera}}getPerspectiveRatio(r,a,u,p,y){const w=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(a,u,p,y):Yr(new d.P(a,u),r,y);return .5+this.transform.cameraToCenterDistance/w.signedDistanceFromCamera*.5}isOffscreen(r,a,u,p){return u<it||r>=this.screenRightBoundary||p<it||a>this.screenBottomBoundary}isInsideGrid(r,a,u,p){return u>=0&&r<this.gridRightBoundary&&p>=0&&a<this.gridBottomBoundary}getViewportMatrix(){const r=d.an([]);return d.H(r,r,[-100,-100,0]),r}_projectCollisionBox(r,a,u,p,y,w,T,C,k,M){const P=a*C.perspectiveRatio;let O=new d.P(1,0),V=new d.P(0,1);const H=new d.P(r.anchorPointX+T[0],r.anchorPointY+T[1]);if(w&&!y){const We=this.projectAndGetPerspectiveRatio(u,H.x+1,H.y,p,k).point.sub(C.point).unit(),ze=Math.atan(We.y/We.x)+(We.x<0?Math.PI:0),De=Math.sin(ze),Je=Math.cos(ze);O=new d.P(Je,De),V=new d.P(-De,Je)}else if(!w&&y){const We=-this.transform.angle,ze=Math.sin(We),De=Math.cos(We);O=new d.P(De,ze),V=new d.P(-ze,De)}let J=C.point,W=P;if(y){J=H;const We=this.transform.zoom-Math.floor(this.transform.zoom);W=Math.pow(2,-We),W*=this.mapProjection.getPitchedTextCorrection(this.transform,H,p),M||(W*=d.ac(.5+C.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}M&&(J=J.add(O.mult(M.x*W)).add(V.mult(M.y*W)));const te=r.x1*W,se=r.x2*W,X=(te+se)/2,ce=r.y1*W,fe=r.y2*W,_e=(ce+fe)/2,Ce=[{offsetX:te,offsetY:ce},{offsetX:X,offsetY:ce},{offsetX:se,offsetY:ce},{offsetX:se,offsetY:_e},{offsetX:se,offsetY:fe},{offsetX:X,offsetY:fe},{offsetX:te,offsetY:fe},{offsetX:te,offsetY:_e}];let Me=[];for(const{offsetX:We,offsetY:ze}of Ce)Me.push(new d.P(J.x+O.x*We+V.x*ze,J.y+O.y*We+V.y*ze));let He=!1;if(y){const We=Me.map(ze=>this.projectAndGetPerspectiveRatio(u,ze.x,ze.y,p,k));He=We.some(ze=>!ze.isOccluded),Me=We.map(ze=>ze.point)}else He=!0;return{box:d.ao(Me),allPointsOccluded:!He}}}function yt(g,r,a){return r*(d.W/(g.tileSize*Math.pow(2,a-g.tileID.overscaledZ)))}class Pt{constructor(r,a,u,p){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?a:-a))):p&&u?1:0,this.placed=u}isHidden(){return this.opacity===0&&!this.placed}}class Wt{constructor(r,a,u,p,y){this.text=new Pt(r?r.text:null,a,u,y),this.icon=new Pt(r?r.icon:null,a,p,y)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ir{constructor(r,a,u){this.text=r,this.icon=a,this.skipFade=u}}class Dr{constructor(){this.invProjMatrix=d.F(),this.viewportMatrix=d.F(),this.circles=[]}}class wt{constructor(r,a,u,p,y){this.bucketInstanceId=r,this.featureIndex=a,this.sourceLayerIndex=u,this.bucketIndex=p,this.tileID=y}}class hr{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const a=++this.maxGroupID;this.collisionGroups[r]={ID:a,predicate:u=>u.collisionGroupID===a}}return this.collisionGroups[r]}}function Ur(g,r,a,u,p){const{horizontalAlign:y,verticalAlign:w}=d.au(g);return new d.P(-(y-.5)*r+u[0]*p,-(w-.5)*a+u[1]*p)}class Nn{constructor(r,a,u,p,y,w){this.transform=r.clone(),this.terrain=u,this.collisionIndex=new It(this.transform,a),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=p,this.retainedQueryData={},this.collisionGroups=new hr(y),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(r){const a=this.terrain;return a?(u,p)=>a.getElevation(r,u,p):null}getBucketParts(r,a,u,p){const y=u.getBucket(a),w=u.latestFeatureIndex;if(!y||!w||a.id!==y.layerIds[0])return;const T=u.collisionBoxArray,C=y.layers[0].layout,k=y.layers[0].paint,M=Math.pow(2,this.transform.zoom-u.tileID.overscaledZ),P=u.tileSize/d.W,O=u.tileID.toUnwrapped(),V=this.transform.calculatePosMatrix(O),H=C.get("text-pitch-alignment")==="map",J=C.get("text-rotation-alignment")==="map",W=yt(u,1,this.transform.zoom),te=this.collisionIndex.mapProjection.translatePosition(this.transform,u,k.get("text-translate"),k.get("text-translate-anchor")),se=this.collisionIndex.mapProjection.translatePosition(this.transform,u,k.get("icon-translate"),k.get("icon-translate-anchor")),X=_o(V,H,J,this.transform,W);let ce=null;if(H){const _e=vo(V,H,J,this.transform,W);ce=d.K([],this.transform.labelPlaneMatrix,_e)}this.retainedQueryData[y.bucketInstanceId]=new wt(y.bucketInstanceId,w,y.sourceLayerIndex,y.index,u.tileID);const fe={bucket:y,layout:C,translationText:te,translationIcon:se,posMatrix:V,unwrappedTileID:O,textLabelPlaneMatrix:X,labelToScreenMatrix:ce,scale:M,textPixelRatio:P,holdingForFade:u.holdingForFade(),collisionBoxArray:T,partiallyEvaluatedTextSize:d.ag(y.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(y.sourceID)};if(p)for(const _e of y.sortKeyRanges){const{sortKey:Ce,symbolInstanceStart:Me,symbolInstanceEnd:He}=_e;r.push({sortKey:Ce,symbolInstanceStart:Me,symbolInstanceEnd:He,parameters:fe})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:y.symbolInstances.length,parameters:fe})}attemptAnchorPlacement(r,a,u,p,y,w,T,C,k,M,P,O,V,H,J,W,te,se,X){const ce=d.aq[r.textAnchor],fe=[r.textOffset0,r.textOffset1],_e=Ur(ce,u,p,fe,y),Ce=this.collisionIndex.placeCollisionBox(a,O,C,k,M,T,w,W,P.predicate,X,_e);if((!se||this.collisionIndex.placeCollisionBox(se,O,C,k,M,T,w,te,P.predicate,X,_e).placeable)&&Ce.placeable){let Me;if(this.prevPlacement&&this.prevPlacement.variableOffsets[V.crossTileID]&&this.prevPlacement.placements[V.crossTileID]&&this.prevPlacement.placements[V.crossTileID].text&&(Me=this.prevPlacement.variableOffsets[V.crossTileID].anchor),V.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[V.crossTileID]={textOffset:fe,width:u,height:p,anchor:ce,textBoxScale:y,prevAnchor:Me},this.markUsedJustification(H,ce,V,J),H.allowVerticalPlacement&&(this.markUsedOrientation(H,J,V),this.placedOrientations[V.crossTileID]=J),{shift:_e,placedGlyphBoxes:Ce}}}placeLayerBucketPart(r,a,u){const{bucket:p,layout:y,translationText:w,translationIcon:T,posMatrix:C,unwrappedTileID:k,textLabelPlaneMatrix:M,labelToScreenMatrix:P,textPixelRatio:O,holdingForFade:V,collisionBoxArray:H,partiallyEvaluatedTextSize:J,collisionGroup:W}=r.parameters,te=y.get("text-optional"),se=y.get("icon-optional"),X=d.ar(y,"text-overlap","text-allow-overlap"),ce=X==="always",fe=d.ar(y,"icon-overlap","icon-allow-overlap"),_e=fe==="always",Ce=y.get("text-rotation-alignment")==="map",Me=y.get("text-pitch-alignment")==="map",He=y.get("icon-text-fit")!=="none",We=y.get("symbol-z-order")==="viewport-y",ze=ce&&(_e||!p.hasIconData()||se),De=_e&&(ce||!p.hasTextData()||te);!p.collisionArrays&&H&&p.deserializeCollisionBoxes(H);const Je=this._getTerrainElevationFunc(this.retainedQueryData[p.bucketInstanceId].tileID),_t=(Fe,$e,dt)=>{var or,Tt;if(a[Fe.crossTileID])return;if(V)return void(this.placements[Fe.crossTileID]=new ir(!1,!1,!1));let kt=!1,sr=!1,dn=!0,Pi=null,ar={box:null,placeable:!1,offscreen:null},Vn={box:null,placeable:!1,offscreen:null},kn=null,pn=null,fn=null,Mi=0,bs=0,sc=0;$e.textFeatureIndex?Mi=$e.textFeatureIndex:Fe.useRuntimeCollisionCircles&&(Mi=Fe.featureIndex),$e.verticalTextFeatureIndex&&(bs=$e.verticalTextFeatureIndex);const ea=$e.textBox;if(ea){const sn=mn=>{let gn=d.ah.horizontal;if(p.allowVerticalPlacement&&!mn&&this.prevPlacement){const Jr=this.prevPlacement.placedOrientations[Fe.crossTileID];Jr&&(this.placedOrientations[Fe.crossTileID]=Jr,gn=Jr,this.markUsedOrientation(p,gn,Fe))}return gn},zi=(mn,gn)=>{if(p.allowVerticalPlacement&&Fe.numVerticalGlyphVertices>0&&$e.verticalTextBox){for(const Jr of p.writingModes)if(Jr===d.ah.vertical?(ar=gn(),Vn=ar):ar=mn(),ar&&ar.placeable)break}else ar=mn()},Ho=Fe.textAnchorOffsetStartIndex,ta=Fe.textAnchorOffsetEndIndex;if(ta===Ho){const mn=(gn,Jr)=>{const pr=this.collisionIndex.placeCollisionBox(gn,X,O,C,k,Me,Ce,w,W.predicate,Je);return pr&&pr.placeable&&(this.markUsedOrientation(p,Jr,Fe),this.placedOrientations[Fe.crossTileID]=Jr),pr};zi(()=>mn(ea,d.ah.horizontal),()=>{const gn=$e.verticalTextBox;return p.allowVerticalPlacement&&Fe.numVerticalGlyphVertices>0&&gn?mn(gn,d.ah.vertical):{box:null,offscreen:null}}),sn(ar&&ar.placeable)}else{let mn=d.aq[(Tt=(or=this.prevPlacement)===null||or===void 0?void 0:or.variableOffsets[Fe.crossTileID])===null||Tt===void 0?void 0:Tt.anchor];const gn=(pr,ra,rh)=>{const Vr=pr.x2-pr.x1,hp=pr.y2-pr.y1,lc=Fe.textBoxScale,cc=He&&fe==="never"?ra:null;let Wo=null,dp=X==="never"?1:2,nh="never";mn&&dp++;for(let ih=0;ih<dp;ih++){for(let oh=Ho;oh<ta;oh++){const uc=p.textAnchorOffsets.get(oh);if(mn&&uc.textAnchor!==mn)continue;const na=this.attemptAnchorPlacement(uc,pr,Vr,hp,lc,Ce,Me,O,C,k,W,nh,Fe,p,rh,w,T,cc,Je);if(na&&(Wo=na.placedGlyphBoxes,Wo&&Wo.placeable))return kt=!0,Pi=na.shift,Wo}mn?mn=null:nh=X}return u&&!Wo&&(Wo={box:this.collisionIndex.placeCollisionBox(ea,"always",O,C,k,Me,Ce,w,W.predicate,Je,new d.P(0,0)).box,offscreen:!1,placeable:!1}),Wo};zi(()=>gn(ea,$e.iconBox,d.ah.horizontal),()=>{const pr=$e.verticalTextBox;return p.allowVerticalPlacement&&(!ar||!ar.placeable)&&Fe.numVerticalGlyphVertices>0&&pr?gn(pr,$e.verticalIconBox,d.ah.vertical):{box:null,occluded:!0,offscreen:null}}),ar&&(kt=ar.placeable,dn=ar.offscreen);const Jr=sn(ar&&ar.placeable);if(!kt&&this.prevPlacement){const pr=this.prevPlacement.variableOffsets[Fe.crossTileID];pr&&(this.variableOffsets[Fe.crossTileID]=pr,this.markUsedJustification(p,pr.anchor,Fe,Jr))}}}if(kn=ar,kt=kn&&kn.placeable,dn=kn&&kn.offscreen,Fe.useRuntimeCollisionCircles){const sn=p.text.placedSymbolArray.get(Fe.centerJustifiedTextSymbolIndex),zi=d.ai(p.textSizeData,J,sn),Ho=y.get("text-padding");pn=this.collisionIndex.placeCollisionCircles(X,sn,p.lineVertexArray,p.glyphOffsetArray,zi,C,k,M,P,u,Me,W.predicate,Fe.collisionCircleDiameter,Ho,w,Je),pn.circles.length&&pn.collisionDetected&&!u&&d.w("Collisions detected, but collision boxes are not shown"),kt=ce||pn.circles.length>0&&!pn.collisionDetected,dn=dn&&pn.offscreen}if($e.iconFeatureIndex&&(sc=$e.iconFeatureIndex),$e.iconBox){const sn=zi=>this.collisionIndex.placeCollisionBox(zi,fe,O,C,k,Me,Ce,T,W.predicate,Je,He&&Pi?Pi:void 0);Vn&&Vn.placeable&&$e.verticalIconBox?(fn=sn($e.verticalIconBox),sr=fn.placeable):(fn=sn($e.iconBox),sr=fn.placeable),dn=dn&&fn.offscreen}const ws=te||Fe.numHorizontalGlyphVertices===0&&Fe.numVerticalGlyphVertices===0,ac=se||Fe.numIconVertices===0;ws||ac?ac?ws||(sr=sr&&kt):kt=sr&&kt:sr=kt=sr&&kt;const th=sr&&fn.placeable;if(kt&&kn.placeable&&this.collisionIndex.insertCollisionBox(kn.box,X,y.get("text-ignore-placement"),p.bucketInstanceId,Vn&&Vn.placeable&&bs?bs:Mi,W.ID),th&&this.collisionIndex.insertCollisionBox(fn.box,fe,y.get("icon-ignore-placement"),p.bucketInstanceId,sc,W.ID),pn&&kt&&this.collisionIndex.insertCollisionCircles(pn.circles,X,y.get("text-ignore-placement"),p.bucketInstanceId,Mi,W.ID),u&&this.storeCollisionData(p.bucketInstanceId,dt,$e,kn,fn,pn),Fe.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(p.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Fe.crossTileID]=new ir(kt||ze,sr||De,dn||p.justReloaded),a[Fe.crossTileID]=!0};if(We){if(r.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Fe=p.getSortedSymbolIndexes(this.transform.angle);for(let $e=Fe.length-1;$e>=0;--$e){const dt=Fe[$e];_t(p.symbolInstances.get(dt),p.collisionArrays[dt],dt)}}else for(let Fe=r.symbolInstanceStart;Fe<r.symbolInstanceEnd;Fe++)_t(p.symbolInstances.get(Fe),p.collisionArrays[Fe],Fe);if(u&&p.bucketInstanceId in this.collisionCircleArrays){const Fe=this.collisionCircleArrays[p.bucketInstanceId];d.as(Fe.invProjMatrix,C),Fe.viewportMatrix=this.collisionIndex.getViewportMatrix()}p.justReloaded=!1}storeCollisionData(r,a,u,p,y,w){if(u.textBox||u.iconBox){let T,C;this.collisionBoxArrays.has(r)?T=this.collisionBoxArrays.get(r):(T=new Map,this.collisionBoxArrays.set(r,T)),T.has(a)?C=T.get(a):(C={text:null,icon:null},T.set(a,C)),u.textBox&&(C.text=p.box),u.iconBox&&(C.icon=y.box)}if(w){let T=this.collisionCircleArrays[r];T===void 0&&(T=this.collisionCircleArrays[r]=new Dr);for(let C=0;C<w.circles.length;C+=4)T.circles.push(w.circles[C+0]),T.circles.push(w.circles[C+1]),T.circles.push(w.circles[C+2]),T.circles.push(w.collisionDetected?1:0)}}markUsedJustification(r,a,u,p){let y;y=p===d.ah.vertical?u.verticalPlacedTextSymbolIndex:{left:u.leftJustifiedTextSymbolIndex,center:u.centerJustifiedTextSymbolIndex,right:u.rightJustifiedTextSymbolIndex}[d.at(a)];const w=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex,u.verticalPlacedTextSymbolIndex];for(const T of w)T>=0&&(r.text.placedSymbolArray.get(T).crossTileID=y>=0&&T!==y?0:u.crossTileID)}markUsedOrientation(r,a,u){const p=a===d.ah.horizontal||a===d.ah.horizontalOnly?a:0,y=a===d.ah.vertical?a:0,w=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex];for(const T of w)r.text.placedSymbolArray.get(T).placedOrientation=p;u.verticalPlacedTextSymbolIndex&&(r.text.placedSymbolArray.get(u.verticalPlacedTextSymbolIndex).placedOrientation=y)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const a=this.prevPlacement;let u=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;const p=a?a.symbolFadeChange(r):1,y=a?a.opacities:{},w=a?a.variableOffsets:{},T=a?a.placedOrientations:{};for(const C in this.placements){const k=this.placements[C],M=y[C];M?(this.opacities[C]=new Wt(M,p,k.text,k.icon),u=u||k.text!==M.text.placed||k.icon!==M.icon.placed):(this.opacities[C]=new Wt(null,p,k.text,k.icon,k.skipFade),u=u||k.text||k.icon)}for(const C in y){const k=y[C];if(!this.opacities[C]){const M=new Wt(k,p,!1,!1);M.isHidden()||(this.opacities[C]=M,u=u||k.text.placed||k.icon.placed)}}for(const C in w)this.variableOffsets[C]||!this.opacities[C]||this.opacities[C].isHidden()||(this.variableOffsets[C]=w[C]);for(const C in T)this.placedOrientations[C]||!this.opacities[C]||this.opacities[C].isHidden()||(this.placedOrientations[C]=T[C]);if(a&&a.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");u?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:r)}updateLayerOpacities(r,a){const u={};for(const p of a){const y=p.getBucket(r);y&&p.latestFeatureIndex&&r.id===y.layerIds[0]&&this.updateBucketOpacities(y,p.tileID,u,p.collisionBoxArray)}}updateBucketOpacities(r,a,u,p){r.hasTextData()&&(r.text.opacityVertexArray.clear(),r.text.hasVisibleVertices=!1),r.hasIconData()&&(r.icon.opacityVertexArray.clear(),r.icon.hasVisibleVertices=!1),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const y=r.layers[0],w=y.layout,T=new Wt(null,0,!1,!1,!0),C=w.get("text-allow-overlap"),k=w.get("icon-allow-overlap"),M=y._unevaluatedLayout.hasValue("text-variable-anchor")||y._unevaluatedLayout.hasValue("text-variable-anchor-offset"),P=w.get("text-rotation-alignment")==="map",O=w.get("text-pitch-alignment")==="map",V=w.get("icon-text-fit")!=="none",H=new Wt(null,0,C&&(k||!r.hasIconData()||w.get("icon-optional")),k&&(C||!r.hasTextData()||w.get("text-optional")),!0);!r.collisionArrays&&p&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(p);const J=(te,se,X)=>{for(let ce=0;ce<se/4;ce++)te.opacityVertexArray.emplaceBack(X);te.hasVisibleVertices=te.hasVisibleVertices||X!==Ba},W=this.collisionBoxArrays.get(r.bucketInstanceId);for(let te=0;te<r.symbolInstances.length;te++){const se=r.symbolInstances.get(te),{numHorizontalGlyphVertices:X,numVerticalGlyphVertices:ce,crossTileID:fe}=se;let _e=this.opacities[fe];u[fe]?_e=T:_e||(_e=H,this.opacities[fe]=_e),u[fe]=!0;const Ce=se.numIconVertices>0,Me=this.placedOrientations[se.crossTileID],He=Me===d.ah.vertical,We=Me===d.ah.horizontal||Me===d.ah.horizontalOnly;if(X>0||ce>0){const De=$n(_e.text);J(r.text,X,He?Ba:De),J(r.text,ce,We?Ba:De);const Je=_e.text.isHidden();[se.rightJustifiedTextSymbolIndex,se.centerJustifiedTextSymbolIndex,se.leftJustifiedTextSymbolIndex].forEach($e=>{$e>=0&&(r.text.placedSymbolArray.get($e).hidden=Je||He?1:0)}),se.verticalPlacedTextSymbolIndex>=0&&(r.text.placedSymbolArray.get(se.verticalPlacedTextSymbolIndex).hidden=Je||We?1:0);const _t=this.variableOffsets[se.crossTileID];_t&&this.markUsedJustification(r,_t.anchor,se,Me);const Fe=this.placedOrientations[se.crossTileID];Fe&&(this.markUsedJustification(r,"left",se,Fe),this.markUsedOrientation(r,Fe,se))}if(Ce){const De=$n(_e.icon),Je=!(V&&se.verticalPlacedIconSymbolIndex&&He);se.placedIconSymbolIndex>=0&&(J(r.icon,se.numIconVertices,Je?De:Ba),r.icon.placedSymbolArray.get(se.placedIconSymbolIndex).hidden=_e.icon.isHidden()),se.verticalPlacedIconSymbolIndex>=0&&(J(r.icon,se.numVerticalIconVertices,Je?Ba:De),r.icon.placedSymbolArray.get(se.verticalPlacedIconSymbolIndex).hidden=_e.icon.isHidden())}const ze=W&&W.has(te)?W.get(te):{text:null,icon:null};if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const De=r.collisionArrays[te];if(De){let Je=new d.P(0,0);if(De.textBox||De.verticalTextBox){let _t=!0;if(M){const Fe=this.variableOffsets[fe];Fe?(Je=Ur(Fe.anchor,Fe.width,Fe.height,Fe.textOffset,Fe.textBoxScale),P&&Je._rotate(O?this.transform.angle:-this.transform.angle)):_t=!1}if(De.textBox||De.verticalTextBox){let Fe;De.textBox&&(Fe=He),De.verticalTextBox&&(Fe=We),ti(r.textCollisionBox.collisionVertexArray,_e.text.placed,!_t||Fe,ze.text,Je.x,Je.y)}}if(De.iconBox||De.verticalIconBox){const _t=!!(!We&&De.verticalIconBox);let Fe;De.iconBox&&(Fe=_t),De.verticalIconBox&&(Fe=!_t),ti(r.iconCollisionBox.collisionVertexArray,_e.icon.placed,Fe,ze.icon,V?Je.x:0,V?Je.y:0)}}}}if(r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.text.opacityVertexArray.length!==r.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${r.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${r.text.layoutVertexArray.length}) / 4`);if(r.icon.opacityVertexArray.length!==r.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${r.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${r.icon.layoutVertexArray.length}) / 4`);if(r.bucketInstanceId in this.collisionCircleArrays){const te=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=te.invProjMatrix,r.placementViewportMatrix=te.viewportMatrix,r.collisionCircleArray=te.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,a){const u=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*u>r}setStale(){this.stale=!0}}function ti(g,r,a,u,p,y){u&&u.length!==0||(u=[0,0,0,0]);const w=u[0]-it,T=u[1]-it,C=u[2]-it,k=u[3]-it;g.emplaceBack(r?1:0,a?1:0,p||0,y||0,w,T),g.emplaceBack(r?1:0,a?1:0,p||0,y||0,C,T),g.emplaceBack(r?1:0,a?1:0,p||0,y||0,C,k),g.emplaceBack(r?1:0,a?1:0,p||0,y||0,w,k)}const jr=Math.pow(2,25),Us=Math.pow(2,24),Ym=Math.pow(2,17),Vt=Math.pow(2,16),fu=Math.pow(2,9),mu=Math.pow(2,8),ri=Math.pow(2,1);function $n(g){if(g.opacity===0&&!g.placed)return 0;if(g.opacity===1&&g.placed)return 4294967295;const r=g.placed?1:0,a=Math.floor(127*g.opacity);return a*jr+r*Us+a*Ym+r*Vt+a*fu+r*mu+a*ri+r}const Ba=0;function Un(){return{isOccluded:(g,r,a)=>!1,getPitchedTextCorrection:(g,r,a)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(g,r,a,u){throw new Error("Not implemented.")},translatePosition:(g,r,a,u)=>function(p,y,w,T,C=!1){if(!w[0]&&!w[1])return[0,0];const k=C?T==="map"?p.angle:0:T==="viewport"?-p.angle:0;if(k){const M=Math.sin(k),P=Math.cos(k);w=[w[0]*P-w[1]*M,w[0]*M+w[1]*P]}return[C?w[0]:yt(y,w[0],p.zoom),C?w[1]:yt(y,w[1],p.zoom)]}(g,r,a,u),getCircleRadiusCorrection:g=>1}}class mi{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&!r.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(r,a,u,p,y){const w=this._bucketParts;for(;this._currentTileIndex<r.length;)if(a.getBucketParts(w,p,r[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,y())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,w.sort((T,C)=>T.sortKey-C.sortKey));this._currentPartIndex<w.length;)if(a.placeLayerBucketPart(w[this._currentPartIndex],this._seenCrossTileIDs,u),this._currentPartIndex++,y())return!0;return!1}}class kd{constructor(r,a,u,p,y,w,T,C){this.placement=new Nn(r,Un(),a,w,T,C),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=y,this._done=!1}isDone(){return this._done}continuePlacement(r,a,u){const p=j.now(),y=()=>!this._forceFullPlacement&&j.now()-p>2;for(;this._currentPlacementIndex>=0;){const w=a[r[this._currentPlacementIndex]],T=this.placement.collisionIndex.transform.zoom;if(w.type==="symbol"&&(!w.minzoom||w.minzoom<=T)&&(!w.maxzoom||w.maxzoom>T)){if(this._inProgressLayer||(this._inProgressLayer=new mi(w)),this._inProgressLayer.continuePlacement(u[w.source],this.placement,this._showCollisionBoxes,w,y))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const xo=512/d.W/2;class Br{constructor(r,a,u){this.tileID=r,this.bucketInstanceId=u,this._symbolsByKey={};const p=new Map;for(let y=0;y<a.length;y++){const w=a.get(y),T=w.key,C=p.get(T);C?C.push(w):p.set(T,[w])}for(const[y,w]of p){const T={positions:w.map(C=>({x:Math.floor(C.anchorX*xo),y:Math.floor(C.anchorY*xo)})),crossTileIDs:w.map(C=>C.crossTileID)};if(T.positions.length>128){const C=new d.av(T.positions.length,16,Uint16Array);for(const{x:k,y:M}of T.positions)C.add(k,M);C.finish(),delete T.positions,T.index=C}this._symbolsByKey[y]=T}}getScaledCoordinates(r,a){const{x:u,y:p,z:y}=this.tileID.canonical,{x:w,y:T,z:C}=a.canonical,k=xo/Math.pow(2,C-y),M=(T*d.W+r.anchorY)*k,P=p*d.W*xo;return{x:Math.floor((w*d.W+r.anchorX)*k-u*d.W*xo),y:Math.floor(M-P)}}findMatches(r,a,u){const p=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z);for(let y=0;y<r.length;y++){const w=r.get(y);if(w.crossTileID)continue;const T=this._symbolsByKey[w.key];if(!T)continue;const C=this.getScaledCoordinates(w,a);if(T.index){const k=T.index.range(C.x-p,C.y-p,C.x+p,C.y+p).sort();for(const M of k){const P=T.crossTileIDs[M];if(!u[P]){u[P]=!0,w.crossTileID=P;break}}}else if(T.positions)for(let k=0;k<T.positions.length;k++){const M=T.positions[k],P=T.crossTileIDs[k];if(Math.abs(M.x-C.x)<=p&&Math.abs(M.y-C.y)<=p&&!u[P]){u[P]=!0,w.crossTileID=P;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:r})=>r)}}class Fa{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class hs{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const a=Math.round((r-this.lng)/360);if(a!==0)for(const u in this.indexes){const p=this.indexes[u],y={};for(const w in p){const T=p[w];T.tileID=T.tileID.unwrapTo(T.tileID.wrap+a),y[T.tileID.key]=T}this.indexes[u]=y}this.lng=r}addBucket(r,a,u){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let y=0;y<a.symbolInstances.length;y++)a.symbolInstances.get(y).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]={});const p=this.usedCrossTileIDs[r.overscaledZ];for(const y in this.indexes){const w=this.indexes[y];if(Number(y)>r.overscaledZ)for(const T in w){const C=w[T];C.tileID.isChildOf(r)&&C.findMatches(a.symbolInstances,r,p)}else{const T=w[r.scaledTo(Number(y)).key];T&&T.findMatches(a.symbolInstances,r,p)}}for(let y=0;y<a.symbolInstances.length;y++){const w=a.symbolInstances.get(y);w.crossTileID||(w.crossTileID=u.generate(),p[w.crossTileID]=!0)}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new Br(r,a.symbolInstances,a.bucketInstanceId),!0}removeBucketCrossTileIDs(r,a){for(const u of a.getCrossTileIDsLists())for(const p of u)delete this.usedCrossTileIDs[r][p]}removeStaleBuckets(r){let a=!1;for(const u in this.indexes){const p=this.indexes[u];for(const y in p)r[p[y].bucketInstanceId]||(this.removeBucketCrossTileIDs(u,p[y]),delete p[y],a=!0)}return a}}class wr{constructor(){this.layerIndexes={},this.crossTileIDs=new Fa,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,a,u){let p=this.layerIndexes[r.id];p===void 0&&(p=this.layerIndexes[r.id]=new hs);let y=!1;const w={};p.handleWrapJump(u);for(const T of a){const C=T.getBucket(r);C&&r.id===C.layerIds[0]&&(C.bucketInstanceId||(C.bucketInstanceId=++this.maxBucketInstanceId),p.addBucket(T.tileID,C,this.crossTileIDs)&&(y=!0),w[C.bucketInstanceId]=!0)}return p.removeStaleBuckets(w)&&(y=!0),y}pruneUnusedLayers(r){const a={};r.forEach(u=>{a[u]=!0});for(const u in this.layerIndexes)a[u]||delete this.layerIndexes[u]}}const ds=(g,r)=>d.t(g,r&&r.filter(a=>a.identifier!=="source.canvas")),Ai=d.aw();class kl extends d.E{constructor(r,a={}){super(),this._rtlPluginLoaded=()=>{for(const u in this.sourceCaches){const p=this.sourceCaches[u].getSource().type;p!=="vector"&&p!=="geojson"||this.sourceCaches[u].reload()}},this.map=r,this.dispatcher=new Ei(Xr(),r._getMapId()),this.dispatcher.registerMessageHandler("GG",(u,p)=>this.getGlyphs(u,p)),this.dispatcher.registerMessageHandler("GI",(u,p)=>this.getImages(u,p)),this.imageManager=new Et,this.imageManager.setEventedParent(this),this.glyphManager=new Rr(r._requestManager,a.localIdeographFontFamily),this.lineAtlas=new At(256,512),this.crossTileSymbolIndex=new wr,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new d.ax,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",d.ay()),ht().on(Oo,this._rtlPluginLoaded),this.on("data",u=>{if(u.dataType!=="source"||u.sourceDataType!=="metadata")return;const p=this.sourceCaches[u.sourceId];if(!p)return;const y=p.getSource();if(y&&y.vectorLayerIds)for(const w in this._layers){const T=this._layers[w];T.source===y.id&&this._validateLayer(T)}})}loadURL(r,a={},u){this.fire(new d.k("dataloading",{dataType:"style"})),a.validate=typeof a.validate!="boolean"||a.validate;const p=this.map._requestManager.transformRequest(r,"Style");this._loadStyleRequest=new AbortController,d.h(p,this._loadStyleRequest).then(y=>{this._loadStyleRequest=null,this._load(y.data,a,u)}).catch(y=>{this._loadStyleRequest=null,y&&this.fire(new d.j(y))})}loadJSON(r,a={},u){this.fire(new d.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,j.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,a.validate=a.validate!==!1,this._load(r,a,u)}).catch(()=>{})}loadEmpty(){this.fire(new d.k("dataloading",{dataType:"style"})),this._load(Ai,{validate:!1})}_load(r,a,u){var p;const y=a.transformStyle?a.transformStyle(u,r):r;if(!a.validate||!ds(this,d.x(y))){this._loaded=!0,this.stylesheet=y;for(const w in y.sources)this.addSource(w,y.sources[w],{validate:!1});y.sprite?this._loadSprite(y.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(y.glyphs),this._createLayers(),this.light=new gt(this.stylesheet.light),this.map.setTerrain((p=this.stylesheet.terrain)!==null&&p!==void 0?p:null),this.fire(new d.k("data",{dataType:"style"})),this.fire(new d.k("style.load"))}}_createLayers(){const r=d.az(this.stylesheet.layers);this.dispatcher.broadcast("SL",r),this._order=r.map(a=>a.id),this._layers={},this._serializedLayers=null;for(const a of r){const u=d.aA(a);u.setEventedParent(this,{layer:{id:a.id}}),this._layers[a.id]=u}}_loadSprite(r,a=!1,u=void 0){let p;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(y,w,T,C){return d._(this,void 0,void 0,function*(){const k=vt(y),M=T>1?"@2x":"",P={},O={};for(const{id:V,url:H}of k){const J=w.transformRequest(ot(H,M,".json"),"SpriteJSON");P[V]=d.h(J,C);const W=w.transformRequest(ot(H,M,".png"),"SpriteImage");O[V]=ae.getImage(W,C)}return yield Promise.all([...Object.values(P),...Object.values(O)]),function(V,H){return d._(this,void 0,void 0,function*(){const J={};for(const W in V){J[W]={};const te=j.getImageCanvasContext((yield H[W]).data),se=(yield V[W]).data;for(const X in se){const{width:ce,height:fe,x:_e,y:Ce,sdf:Me,pixelRatio:He,stretchX:We,stretchY:ze,content:De,textFitWidth:Je,textFitHeight:_t}=se[X];J[W][X]={data:null,pixelRatio:He,sdf:Me,stretchX:We,stretchY:ze,content:De,textFitWidth:Je,textFitHeight:_t,spriteData:{width:ce,height:fe,x:_e,y:Ce,context:te}}}}return J})}(P,O)})}(r,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(y=>{if(this._spriteRequest=null,y)for(const w in y){this._spritesImagesIds[w]=[];const T=this._spritesImagesIds[w]?this._spritesImagesIds[w].filter(C=>!(C in y)):[];for(const C of T)this.imageManager.removeImage(C),this._changedImages[C]=!0;for(const C in y[w]){const k=w==="default"?C:`${w}:${C}`;this._spritesImagesIds[w].push(k),k in this.imageManager.images?this.imageManager.updateImage(k,y[w][C],!1):this.imageManager.addImage(k,y[w][C]),a&&(this._changedImages[k]=!0)}}}).catch(y=>{this._spriteRequest=null,p=y,this.fire(new d.j(p))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),a&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new d.k("data",{dataType:"style"})),u&&u(p)})}_unloadSprite(){for(const r of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(r),this._changedImages[r]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new d.k("data",{dataType:"style"}))}_validateLayer(r){const a=this.sourceCaches[r.source];if(!a)return;const u=r.sourceLayer;if(!u)return;const p=a.getSource();(p.type==="geojson"||p.vectorLayerIds&&p.vectorLayerIds.indexOf(u)===-1)&&this.fire(new d.j(new Error(`Source layer "${u}" does not exist on source "${p.id}" as specified by style layer "${r.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const r in this.sourceCaches)if(!this.sourceCaches[r].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(r){const a=this._serializedAllLayers();if(!r||r.length===0)return Object.values(a);const u=[];for(const p of r)a[p]&&u.push(a[p]);return u}_serializedAllLayers(){let r=this._serializedLayers;if(r)return r;r=this._serializedLayers={};const a=Object.keys(this._layers);for(const u of a){const p=this._layers[u];p.type!=="custom"&&(r[u]=p.serialize())}return r}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const r in this.sourceCaches)if(this.sourceCaches[r].hasTransition())return!0;for(const r in this._layers)if(this._layers[r].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(r){if(!this._loaded)return;const a=this._changed;if(a){const p=Object.keys(this._updatedLayers),y=Object.keys(this._removedLayers);(p.length||y.length)&&this._updateWorkerLayers(p,y);for(const w in this._updatedSources){const T=this._updatedSources[w];if(T==="reload")this._reloadSource(w);else{if(T!=="clear")throw new Error(`Invalid action ${T}`);this._clearSource(w)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const w in this._updatedPaintProps)this._layers[w].updateTransitions(r);this.light.updateTransitions(r),this._resetUpdates()}const u={};for(const p in this.sourceCaches){const y=this.sourceCaches[p];u[p]=y.used,y.used=!1}for(const p of this._order){const y=this._layers[p];y.recalculate(r,this._availableImages),!y.isHidden(r.zoom)&&y.source&&(this.sourceCaches[y.source].used=!0)}for(const p in u){const y=this.sourceCaches[p];!!u[p]!=!!y.used&&y.fire(new d.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:p}))}this.light.recalculate(r),this.z=r.zoom,a&&this.fire(new d.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const r=Object.keys(this._changedImages);if(r.length){for(const a in this.sourceCaches)this.sourceCaches[a].reloadTilesForDependencies(["icons","patterns"],r);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const r in this.sourceCaches)this.sourceCaches[r].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(r,a){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(r),removedIds:a})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(r,a={}){var u;this._checkLoaded();const p=this.serialize();if(r=a.transformStyle?a.transformStyle(p,r):r,((u=a.validate)===null||u===void 0||u)&&ds(this,d.x(r)))return!1;(r=d.aB(r)).layers=d.az(r.layers);const y=d.aC(p,r),w=this._getOperationsToPerform(y);if(w.unimplemented.length>0)throw new Error(`Unimplemented: ${w.unimplemented.join(", ")}.`);if(w.operations.length===0)return!1;for(const T of w.operations)T();return this.stylesheet=r,this._serializedLayers=null,!0}_getOperationsToPerform(r){const a=[],u=[];for(const p of r)switch(p.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":a.push(()=>this.addLayer.apply(this,p.args));break;case"removeLayer":a.push(()=>this.removeLayer.apply(this,p.args));break;case"setPaintProperty":a.push(()=>this.setPaintProperty.apply(this,p.args));break;case"setLayoutProperty":a.push(()=>this.setLayoutProperty.apply(this,p.args));break;case"setFilter":a.push(()=>this.setFilter.apply(this,p.args));break;case"addSource":a.push(()=>this.addSource.apply(this,p.args));break;case"removeSource":a.push(()=>this.removeSource.apply(this,p.args));break;case"setLayerZoomRange":a.push(()=>this.setLayerZoomRange.apply(this,p.args));break;case"setLight":a.push(()=>this.setLight.apply(this,p.args));break;case"setGeoJSONSourceData":a.push(()=>this.setGeoJSONSourceData.apply(this,p.args));break;case"setGlyphs":a.push(()=>this.setGlyphs.apply(this,p.args));break;case"setSprite":a.push(()=>this.setSprite.apply(this,p.args));break;case"setTerrain":a.push(()=>this.map.setTerrain.apply(this,p.args));break;case"setTransition":a.push(()=>{});break;default:u.push(p.command)}return{operations:a,unimplemented:u}}addImage(r,a){if(this.getImage(r))return this.fire(new d.j(new Error(`An image named "${r}" already exists.`)));this.imageManager.addImage(r,a),this._afterImageUpdated(r)}updateImage(r,a){this.imageManager.updateImage(r,a)}getImage(r){return this.imageManager.getImage(r)}removeImage(r){if(!this.getImage(r))return this.fire(new d.j(new Error(`An image named "${r}" does not exist.`)));this.imageManager.removeImage(r),this._afterImageUpdated(r)}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(),this._changedImages[r]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new d.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(r,a,u={}){if(this._checkLoaded(),this.sourceCaches[r]!==void 0)throw new Error(`Source "${r}" already exists.`);if(!a.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(a).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(a.type)>=0&&this._validate(d.x.source,`sources.${r}`,a,null,u))return;this.map&&this.map._collectResourceTiming&&(a.collectResourceTiming=!0);const p=this.sourceCaches[r]=new Le(r,a,this.dispatcher);p.style=this,p.setEventedParent(this,()=>({isSourceLoaded:p.loaded(),source:p.serialize(),sourceId:r})),p.onAdd(this.map),this._changed=!0}removeSource(r){if(this._checkLoaded(),this.sourceCaches[r]===void 0)throw new Error("There is no source with this ID");for(const u in this._layers)if(this._layers[u].source===r)return this.fire(new d.j(new Error(`Source "${r}" cannot be removed while layer "${u}" is using it.`)));const a=this.sourceCaches[r];delete this.sourceCaches[r],delete this._updatedSources[r],a.fire(new d.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:r})),a.setEventedParent(null),a.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(r,a){if(this._checkLoaded(),this.sourceCaches[r]===void 0)throw new Error(`There is no source with this ID=${r}`);const u=this.sourceCaches[r].getSource();if(u.type!=="geojson")throw new Error(`geojsonSource.type is ${u.type}, which is !== 'geojson`);u.setData(a),this._changed=!0}getSource(r){return this.sourceCaches[r]&&this.sourceCaches[r].getSource()}addLayer(r,a,u={}){this._checkLoaded();const p=r.id;if(this.getLayer(p))return void this.fire(new d.j(new Error(`Layer "${p}" already exists on this map.`)));let y;if(r.type==="custom"){if(ds(this,d.aD(r)))return;y=d.aA(r)}else{if("source"in r&&typeof r.source=="object"&&(this.addSource(p,r.source),r=d.aB(r),r=d.e(r,{source:p})),this._validate(d.x.layer,`layers.${p}`,r,{arrayIndex:-1},u))return;y=d.aA(r),this._validateLayer(y),y.setEventedParent(this,{layer:{id:p}})}const w=a?this._order.indexOf(a):this._order.length;if(a&&w===-1)this.fire(new d.j(new Error(`Cannot add layer "${p}" before non-existing layer "${a}".`)));else{if(this._order.splice(w,0,p),this._layerOrderChanged=!0,this._layers[p]=y,this._removedLayers[p]&&y.source&&y.type!=="custom"){const T=this._removedLayers[p];delete this._removedLayers[p],T.type!==y.type?this._updatedSources[y.source]="clear":(this._updatedSources[y.source]="reload",this.sourceCaches[y.source].pause())}this._updateLayer(y),y.onAdd&&y.onAdd(this.map)}}moveLayer(r,a){if(this._checkLoaded(),this._changed=!0,!this._layers[r])return void this.fire(new d.j(new Error(`The layer '${r}' does not exist in the map's style and cannot be moved.`)));if(r===a)return;const u=this._order.indexOf(r);this._order.splice(u,1);const p=a?this._order.indexOf(a):this._order.length;a&&p===-1?this.fire(new d.j(new Error(`Cannot move layer "${r}" before non-existing layer "${a}".`))):(this._order.splice(p,0,r),this._layerOrderChanged=!0)}removeLayer(r){this._checkLoaded();const a=this._layers[r];if(!a)return void this.fire(new d.j(new Error(`Cannot remove non-existing layer "${r}".`)));a.setEventedParent(null);const u=this._order.indexOf(r);this._order.splice(u,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[r]=a,delete this._layers[r],this._serializedLayers&&delete this._serializedLayers[r],delete this._updatedLayers[r],delete this._updatedPaintProps[r],a.onRemove&&a.onRemove(this.map)}getLayer(r){return this._layers[r]}getLayersOrder(){return[...this._order]}hasLayer(r){return r in this._layers}setLayerZoomRange(r,a,u){this._checkLoaded();const p=this.getLayer(r);p?p.minzoom===a&&p.maxzoom===u||(a!=null&&(p.minzoom=a),u!=null&&(p.maxzoom=u),this._updateLayer(p)):this.fire(new d.j(new Error(`Cannot set the zoom range of non-existing layer "${r}".`)))}setFilter(r,a,u={}){this._checkLoaded();const p=this.getLayer(r);if(p){if(!d.aE(p.filter,a))return a==null?(p.filter=void 0,void this._updateLayer(p)):void(this._validate(d.x.filter,`layers.${p.id}.filter`,a,null,u)||(p.filter=d.aB(a),this._updateLayer(p)))}else this.fire(new d.j(new Error(`Cannot filter non-existing layer "${r}".`)))}getFilter(r){return d.aB(this.getLayer(r).filter)}setLayoutProperty(r,a,u,p={}){this._checkLoaded();const y=this.getLayer(r);y?d.aE(y.getLayoutProperty(a),u)||(y.setLayoutProperty(a,u,p),this._updateLayer(y)):this.fire(new d.j(new Error(`Cannot style non-existing layer "${r}".`)))}getLayoutProperty(r,a){const u=this.getLayer(r);if(u)return u.getLayoutProperty(a);this.fire(new d.j(new Error(`Cannot get style of non-existing layer "${r}".`)))}setPaintProperty(r,a,u,p={}){this._checkLoaded();const y=this.getLayer(r);y?d.aE(y.getPaintProperty(a),u)||(y.setPaintProperty(a,u,p)&&this._updateLayer(y),this._changed=!0,this._updatedPaintProps[r]=!0,this._serializedLayers=null):this.fire(new d.j(new Error(`Cannot style non-existing layer "${r}".`)))}getPaintProperty(r,a){return this.getLayer(r).getPaintProperty(a)}setFeatureState(r,a){this._checkLoaded();const u=r.source,p=r.sourceLayer,y=this.sourceCaches[u];if(y===void 0)return void this.fire(new d.j(new Error(`The source '${u}' does not exist in the map's style.`)));const w=y.getSource().type;w==="geojson"&&p?this.fire(new d.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):w!=="vector"||p?(r.id===void 0&&this.fire(new d.j(new Error("The feature id parameter must be provided."))),y.setFeatureState(p,r.id,a)):this.fire(new d.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(r,a){this._checkLoaded();const u=r.source,p=this.sourceCaches[u];if(p===void 0)return void this.fire(new d.j(new Error(`The source '${u}' does not exist in the map's style.`)));const y=p.getSource().type,w=y==="vector"?r.sourceLayer:void 0;y!=="vector"||w?a&&typeof r.id!="string"&&typeof r.id!="number"?this.fire(new d.j(new Error("A feature id is required to remove its specific state property."))):p.removeFeatureState(w,r.id,a):this.fire(new d.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(r){this._checkLoaded();const a=r.source,u=r.sourceLayer,p=this.sourceCaches[a];if(p!==void 0)return p.getSource().type!=="vector"||u?(r.id===void 0&&this.fire(new d.j(new Error("The feature id parameter must be provided."))),p.getFeatureState(u,r.id)):void this.fire(new d.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new d.j(new Error(`The source '${a}' does not exist in the map's style.`)))}getTransition(){return d.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const r=d.aF(this.sourceCaches,y=>y.serialize()),a=this._serializeByIds(this._order),u=this.map.getTerrain()||void 0,p=this.stylesheet;return d.aG({version:p.version,name:p.name,metadata:p.metadata,light:p.light,center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch,sprite:p.sprite,glyphs:p.glyphs,transition:p.transition,sources:r,layers:a,terrain:u},y=>y!==void 0)}_updateLayer(r){this._updatedLayers[r.id]=!0,r.source&&!this._updatedSources[r.source]&&this.sourceCaches[r.source].getSource().type!=="raster"&&(this._updatedSources[r.source]="reload",this.sourceCaches[r.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(r){const a=w=>this._layers[w].type==="fill-extrusion",u={},p=[];for(let w=this._order.length-1;w>=0;w--){const T=this._order[w];if(a(T)){u[T]=w;for(const C of r){const k=C[T];if(k)for(const M of k)p.push(M)}}}p.sort((w,T)=>T.intersectionZ-w.intersectionZ);const y=[];for(let w=this._order.length-1;w>=0;w--){const T=this._order[w];if(a(T))for(let C=p.length-1;C>=0;C--){const k=p[C].feature;if(u[k.layer.id]<w)break;y.push(k),p.pop()}else for(const C of r){const k=C[T];if(k)for(const M of k)y.push(M.feature)}}return y}queryRenderedFeatures(r,a,u){a&&a.filter&&this._validate(d.x.filter,"queryRenderedFeatures.filter",a.filter,null,a);const p={};if(a&&a.layers){if(!Array.isArray(a.layers))return this.fire(new d.j(new Error("parameters.layers must be an Array."))),[];for(const T of a.layers){const C=this._layers[T];if(!C)return this.fire(new d.j(new Error(`The layer '${T}' does not exist in the map's style and cannot be queried for features.`))),[];p[C.source]=!0}}const y=[];a.availableImages=this._availableImages;const w=this._serializedAllLayers();for(const T in this.sourceCaches)a.layers&&!p[T]||y.push($s(this.sourceCaches[T],this._layers,w,r,a,u));return this.placement&&y.push(function(T,C,k,M,P,O,V){const H={},J=O.queryRenderedSymbols(M),W=[];for(const te of Object.keys(J).map(Number))W.push(V[te]);W.sort(fi);for(const te of W){const se=te.featureIndex.lookupSymbolFeatures(J[te.bucketInstanceId],C,te.bucketIndex,te.sourceLayerIndex,P.filter,P.layers,P.availableImages,T);for(const X in se){const ce=H[X]=H[X]||[],fe=se[X];fe.sort((_e,Ce)=>{const Me=te.featureSortOrder;if(Me){const He=Me.indexOf(_e.featureIndex);return Me.indexOf(Ce.featureIndex)-He}return Ce.featureIndex-_e.featureIndex});for(const _e of fe)ce.push(_e)}}for(const te in H)H[te].forEach(se=>{const X=se.feature,ce=k[T[te].source].getFeatureState(X.layer["source-layer"],X.id);X.source=X.layer.source,X.layer["source-layer"]&&(X.sourceLayer=X.layer["source-layer"]),X.state=ce});return H}(this._layers,w,this.sourceCaches,r,a,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(y)}querySourceFeatures(r,a){a&&a.filter&&this._validate(d.x.filter,"querySourceFeatures.filter",a.filter,null,a);const u=this.sourceCaches[r];return u?function(p,y){const w=p.getRenderableIds().map(k=>p.getTileByID(k)),T=[],C={};for(let k=0;k<w.length;k++){const M=w[k],P=M.tileID.canonical.key;C[P]||(C[P]=!0,M.querySourceFeatures(T,y))}return T}(u,a):[]}getLight(){return this.light.getLight()}setLight(r,a={}){this._checkLoaded();const u=this.light.getLight();let p=!1;for(const w in r)if(!d.aE(r[w],u[w])){p=!0;break}if(!p)return;const y={now:j.now(),transition:d.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(r,a),this.light.updateTransitions(y)}_validate(r,a,u,p,y={}){return(!y||y.validate!==!1)&&ds(this,r.call(d.x,d.e({key:a,style:this.serialize(),value:u,styleSpec:d.v},p)))}_remove(r=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),ht().off(Oo,this._rtlPluginLoaded);for(const a in this._layers)this._layers[a].setEventedParent(null);for(const a in this.sourceCaches){const u=this.sourceCaches[a];u.setEventedParent(null),u.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),r&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(r)}_clearSource(r){this.sourceCaches[r].clearTiles()}_reloadSource(r){this.sourceCaches[r].resume(),this.sourceCaches[r].reload()}_updateSources(r){for(const a in this.sourceCaches)this.sourceCaches[a].update(r,this.map.terrain)}_generateCollisionBoxes(){for(const r in this.sourceCaches)this._reloadSource(r)}_updatePlacement(r,a,u,p,y=!1){let w=!1,T=!1;const C={};for(const k of this._order){const M=this._layers[k];if(M.type!=="symbol")continue;if(!C[M.source]){const O=this.sourceCaches[M.source];C[M.source]=O.getRenderableIds(!0).map(V=>O.getTileByID(V)).sort((V,H)=>H.tileID.overscaledZ-V.tileID.overscaledZ||(V.tileID.isLessThan(H.tileID)?-1:1))}const P=this.crossTileSymbolIndex.addLayer(M,C[M.source],r.center.lng);w=w||P}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((y=y||this._layerOrderChanged||u===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(j.now(),r.zoom))&&(this.pauseablePlacement=new kd(r,this.map.terrain,this._order,y,a,u,p,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,C),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(j.now()),T=!0),w&&this.pauseablePlacement.placement.setStale()),T||w)for(const k of this._order){const M=this._layers[k];M.type==="symbol"&&this.placement.updateLayerOpacities(M,C[M.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(j.now())}_releaseSymbolFadeTiles(){for(const r in this.sourceCaches)this.sourceCaches[r].releaseSymbolFadeTiles()}getImages(r,a){return d._(this,void 0,void 0,function*(){const u=yield this.imageManager.getImages(a.icons);this._updateTilesForChangedImages();const p=this.sourceCaches[a.source];return p&&p.setDependencies(a.tileID.key,a.type,a.icons),u})}getGlyphs(r,a){return d._(this,void 0,void 0,function*(){const u=yield this.glyphManager.getGlyphs(a.stacks),p=this.sourceCaches[a.source];return p&&p.setDependencies(a.tileID.key,a.type,[""]),u})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(r,a={}){this._checkLoaded(),r&&this._validate(d.x.glyphs,"glyphs",r,null,a)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=r,this.glyphManager.entries={},this.glyphManager.setURL(r))}addSprite(r,a,u={},p){this._checkLoaded();const y=[{id:r,url:a}],w=[...vt(this.stylesheet.sprite),...y];this._validate(d.x.sprite,"sprite",w,null,u)||(this.stylesheet.sprite=w,this._loadSprite(y,!0,p))}removeSprite(r){this._checkLoaded();const a=vt(this.stylesheet.sprite);if(a.find(u=>u.id===r)){if(this._spritesImagesIds[r])for(const u of this._spritesImagesIds[r])this.imageManager.removeImage(u),this._changedImages[u]=!0;a.splice(a.findIndex(u=>u.id===r),1),this.stylesheet.sprite=a.length>0?a:void 0,delete this._spritesImagesIds[r],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new d.k("data",{dataType:"style"}))}else this.fire(new d.j(new Error(`Sprite "${r}" doesn't exists on this map.`)))}getSprite(){return vt(this.stylesheet.sprite)}setSprite(r,a={},u){this._checkLoaded(),r&&this._validate(d.x.sprite,"sprite",r,null,a)||(this.stylesheet.sprite=r,r?this._loadSprite(r,!0,u):(this._unloadSprite(),u&&u(null)))}}var Ji=d.X([{name:"a_pos",type:"Int16",components:2}]),gu="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const js={prelude:Nt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Nt(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Nt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Nt(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Nt("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Nt(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:Nt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Nt("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Nt("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Nt("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Nt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Nt(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Nt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Nt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Nt(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Nt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Nt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Nt(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Nt(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Nt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Nt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Nt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Nt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Nt(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Nt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Nt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Nt("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",gu),terrainDepth:Nt("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",gu),terrainCoords:Nt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",gu)};function Nt(g,r){const a=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,u=r.match(/attribute ([\w]+) ([\w]+)/g),p=g.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),y=r.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=y?y.concat(p):p,T={};return{fragmentSource:g=g.replace(a,(C,k,M,P,O)=>(T[O]=!0,k==="define"?`
#ifndef HAS_UNIFORM_u_${O}
varying ${M} ${P} ${O};
#else
uniform ${M} ${P} u_${O};
#endif
`:`
#ifdef HAS_UNIFORM_u_${O}
    ${M} ${P} ${O} = u_${O};
#endif
`)),vertexSource:r=r.replace(a,(C,k,M,P,O)=>{const V=P==="float"?"vec2":"vec4",H=O.match(/color/)?"color":V;return T[O]?k==="define"?`
#ifndef HAS_UNIFORM_u_${O}
uniform lowp float u_${O}_t;
attribute ${M} ${V} a_${O};
varying ${M} ${P} ${O};
#else
uniform ${M} ${P} u_${O};
#endif
`:H==="vec4"?`
#ifndef HAS_UNIFORM_u_${O}
    ${O} = a_${O};
#else
    ${M} ${P} ${O} = u_${O};
#endif
`:`
#ifndef HAS_UNIFORM_u_${O}
    ${O} = unpack_mix_${H}(a_${O}, u_${O}_t);
#else
    ${M} ${P} ${O} = u_${O};
#endif
`:k==="define"?`
#ifndef HAS_UNIFORM_u_${O}
uniform lowp float u_${O}_t;
attribute ${M} ${V} a_${O};
#else
uniform ${M} ${P} u_${O};
#endif
`:H==="vec4"?`
#ifndef HAS_UNIFORM_u_${O}
    ${M} ${P} ${O} = a_${O};
#else
    ${M} ${P} ${O} = u_${O};
#endif
`:`
#ifndef HAS_UNIFORM_u_${O}
    ${M} ${P} ${O} = unpack_mix_${H}(a_${O}, u_${O}_t);
#else
    ${M} ${P} ${O} = u_${O};
#endif
`}),staticAttributes:u,staticUniforms:w}}class Al{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(r,a,u,p,y,w,T,C,k){this.context=r;let M=this.boundPaintVertexBuffers.length!==p.length;for(let P=0;!M&&P<p.length;P++)this.boundPaintVertexBuffers[P]!==p[P]&&(M=!0);!this.vao||this.boundProgram!==a||this.boundLayoutVertexBuffer!==u||M||this.boundIndexBuffer!==y||this.boundVertexOffset!==w||this.boundDynamicVertexBuffer!==T||this.boundDynamicVertexBuffer2!==C||this.boundDynamicVertexBuffer3!==k?this.freshBind(a,u,p,y,w,T,C,k):(r.bindVertexArray.set(this.vao),T&&T.bind(),y&&y.dynamicDraw&&y.bind(),C&&C.bind(),k&&k.bind())}freshBind(r,a,u,p,y,w,T,C){const k=r.numAttributes,M=this.context,P=M.gl;this.vao&&this.destroy(),this.vao=M.createVertexArray(),M.bindVertexArray.set(this.vao),this.boundProgram=r,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=u,this.boundIndexBuffer=p,this.boundVertexOffset=y,this.boundDynamicVertexBuffer=w,this.boundDynamicVertexBuffer2=T,this.boundDynamicVertexBuffer3=C,a.enableAttributes(P,r);for(const O of u)O.enableAttributes(P,r);w&&w.enableAttributes(P,r),T&&T.enableAttributes(P,r),C&&C.enableAttributes(P,r),a.bind(),a.setVertexAttribPointers(P,r,y);for(const O of u)O.bind(),O.setVertexAttribPointers(P,r,y);w&&(w.bind(),w.setVertexAttribPointers(P,r,y)),p&&p.bind(),T&&(T.bind(),T.setVertexAttribPointers(P,r,y)),C&&(C.bind(),C.setVertexAttribPointers(P,r,y)),M.currentNumAttributes=k}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function Vs(g){const r=[];for(let a=0;a<g.length;a++){if(g[a]===null)continue;const u=g[a].split(" ");r.push(u.pop())}return r}class yu{constructor(r,a,u,p,y,w){const T=r.gl;this.program=T.createProgram();const C=Vs(a.staticAttributes),k=u?u.getBinderAttributes():[],M=C.concat(k),P=js.prelude.staticUniforms?Vs(js.prelude.staticUniforms):[],O=a.staticUniforms?Vs(a.staticUniforms):[],V=u?u.getBinderUniforms():[],H=P.concat(O).concat(V),J=[];for(const _e of H)J.indexOf(_e)<0&&J.push(_e);const W=u?u.defines():[];y&&W.push("#define OVERDRAW_INSPECTOR;"),w&&W.push("#define TERRAIN3D;");const te=W.concat(js.prelude.fragmentSource,a.fragmentSource).join(`
`),se=W.concat(js.prelude.vertexSource,a.vertexSource).join(`
`),X=T.createShader(T.FRAGMENT_SHADER);if(T.isContextLost())return void(this.failedToCreate=!0);if(T.shaderSource(X,te),T.compileShader(X),!T.getShaderParameter(X,T.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${T.getShaderInfoLog(X)}`);T.attachShader(this.program,X);const ce=T.createShader(T.VERTEX_SHADER);if(T.isContextLost())return void(this.failedToCreate=!0);if(T.shaderSource(ce,se),T.compileShader(ce),!T.getShaderParameter(ce,T.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${T.getShaderInfoLog(ce)}`);T.attachShader(this.program,ce),this.attributes={};const fe={};this.numAttributes=M.length;for(let _e=0;_e<this.numAttributes;_e++)M[_e]&&(T.bindAttribLocation(this.program,_e,M[_e]),this.attributes[M[_e]]=_e);if(T.linkProgram(this.program),!T.getProgramParameter(this.program,T.LINK_STATUS))throw new Error(`Program failed to link: ${T.getProgramInfoLog(this.program)}`);T.deleteShader(ce),T.deleteShader(X);for(let _e=0;_e<J.length;_e++){const Ce=J[_e];if(Ce&&!fe[Ce]){const Me=T.getUniformLocation(this.program,Ce);Me&&(fe[Ce]=Me)}}this.fixedUniforms=p(r,fe),this.terrainUniforms=((_e,Ce)=>({u_depth:new d.aH(_e,Ce.u_depth),u_terrain:new d.aH(_e,Ce.u_terrain),u_terrain_dim:new d.aI(_e,Ce.u_terrain_dim),u_terrain_matrix:new d.aJ(_e,Ce.u_terrain_matrix),u_terrain_unpack:new d.aK(_e,Ce.u_terrain_unpack),u_terrain_exaggeration:new d.aI(_e,Ce.u_terrain_exaggeration)}))(r,fe),this.binderUniforms=u?u.getUniforms(r,fe):[]}draw(r,a,u,p,y,w,T,C,k,M,P,O,V,H,J,W,te,se){const X=r.gl;if(this.failedToCreate)return;if(r.program.set(this.program),r.setDepthMode(u),r.setStencilMode(p),r.setColorMode(y),r.setCullFace(w),C){r.activeTexture.set(X.TEXTURE2),X.bindTexture(X.TEXTURE_2D,C.depthTexture),r.activeTexture.set(X.TEXTURE3),X.bindTexture(X.TEXTURE_2D,C.texture);for(const fe in this.terrainUniforms)this.terrainUniforms[fe].set(C[fe])}for(const fe in this.fixedUniforms)this.fixedUniforms[fe].set(T[fe]);J&&J.setUniforms(r,this.binderUniforms,V,{zoom:H});let ce=0;switch(a){case X.LINES:ce=2;break;case X.TRIANGLES:ce=3;break;case X.LINE_STRIP:ce=1}for(const fe of O.get()){const _e=fe.vaos||(fe.vaos={});(_e[k]||(_e[k]=new Al)).bind(r,this,M,J?J.getPaintVertexBuffers():[],P,fe.vertexOffset,W,te,se),X.drawElements(a,fe.primitiveLength*ce,X.UNSIGNED_SHORT,fe.primitiveOffset*ce*2)}}}function Pl(g,r,a){const u=1/yt(a,1,r.transform.tileZoom),p=Math.pow(2,a.tileID.overscaledZ),y=a.tileSize*Math.pow(2,r.transform.tileZoom)/p,w=y*(a.tileID.canonical.x+a.tileID.wrap*p),T=y*a.tileID.canonical.y;return{u_image:0,u_texsize:a.imageAtlasTexture.size,u_scale:[u,g.fromScale,g.toScale],u_fade:g.t,u_pixel_coord_upper:[w>>16,T>>16],u_pixel_coord_lower:[65535&w,65535&T]}}const Oa=(g,r,a,u)=>{const p=r.style.light,y=p.properties.get("position"),w=[y.x,y.y,y.z],T=function(){var k=new d.A(9);return d.A!=Float32Array&&(k[1]=0,k[2]=0,k[3]=0,k[5]=0,k[6]=0,k[7]=0),k[0]=1,k[4]=1,k[8]=1,k}();p.properties.get("anchor")==="viewport"&&function(k,M){var P=Math.sin(M),O=Math.cos(M);k[0]=O,k[1]=P,k[2]=0,k[3]=-P,k[4]=O,k[5]=0,k[6]=0,k[7]=0,k[8]=1}(T,-r.transform.angle),function(k,M,P){var O=M[0],V=M[1],H=M[2];k[0]=O*P[0]+V*P[3]+H*P[6],k[1]=O*P[1]+V*P[4]+H*P[7],k[2]=O*P[2]+V*P[5]+H*P[8]}(w,w,T);const C=p.properties.get("color");return{u_matrix:g,u_lightpos:w,u_lightintensity:p.properties.get("intensity"),u_lightcolor:[C.r,C.g,C.b],u_vertical_gradient:+a,u_opacity:u}},_u=(g,r,a,u,p,y,w)=>d.e(Oa(g,r,a,u),Pl(y,r,w),{u_height_factor:-Math.pow(2,p.overscaledZ)/w.tileSize/8}),Ml=g=>({u_matrix:g}),Na=(g,r,a,u)=>d.e(Ml(g),Pl(a,r,u)),zl=(g,r)=>({u_matrix:g,u_world:r}),$a=(g,r,a,u,p)=>d.e(Na(g,r,a,u),{u_world:p}),Jm=(g,r,a,u)=>{const p=g.transform;let y,w;if(u.paint.get("circle-pitch-alignment")==="map"){const T=yt(a,1,p.zoom);y=!0,w=[T,T]}else y=!1,w=p.pixelsToGLUnits;return{u_camera_to_center_distance:p.cameraToCenterDistance,u_scale_with_map:+(u.paint.get("circle-pitch-scale")==="map"),u_matrix:g.translatePosMatrix(r.posMatrix,a,u.paint.get("circle-translate"),u.paint.get("circle-translate-anchor")),u_pitch_with_map:+y,u_device_pixel_ratio:g.pixelRatio,u_extrude_scale:w}},Qm=(g,r,a)=>({u_matrix:g,u_inv_matrix:r,u_camera_to_center_distance:a.cameraToCenterDistance,u_viewport_size:[a.width,a.height]}),vu=(g,r,a=1)=>({u_matrix:g,u_color:r,u_overlay:0,u_overlay_scale:a}),Ad=g=>({u_matrix:g}),ps=(g,r,a,u)=>({u_matrix:g,u_extrude_scale:yt(r,1,a),u_intensity:u});function Ll(g,r){const a=Math.pow(2,r.canonical.z),u=r.canonical.y;return[new d.Y(0,u/a).toLngLat().lat,new d.Y(0,(u+1)/a).toLngLat().lat]}const En=(g,r,a,u)=>{const p=g.transform;return{u_matrix:wu(g,r,a,u),u_ratio:1/yt(r,1,p.zoom),u_device_pixel_ratio:g.pixelRatio,u_units_to_pixels:[1/p.pixelsToGLUnits[0],1/p.pixelsToGLUnits[1]]}},ni=(g,r,a,u,p)=>d.e(En(g,r,a,p),{u_image:0,u_image_height:u}),xu=(g,r,a,u,p)=>{const y=g.transform,w=bu(r,y);return{u_matrix:wu(g,r,a,p),u_texsize:r.imageAtlasTexture.size,u_ratio:1/yt(r,1,y.zoom),u_device_pixel_ratio:g.pixelRatio,u_image:0,u_scale:[w,u.fromScale,u.toScale],u_fade:u.t,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},Rl=(g,r,a,u,p,y)=>{const w=g.lineAtlas,T=bu(r,g.transform),C=a.layout.get("line-cap")==="round",k=w.getDash(u.from,C),M=w.getDash(u.to,C),P=k.width*p.fromScale,O=M.width*p.toScale;return d.e(En(g,r,a,y),{u_patternscale_a:[T/P,-k.height/2],u_patternscale_b:[T/O,-M.height/2],u_sdfgamma:w.width/(256*Math.min(P,O)*g.pixelRatio)/2,u_image:0,u_tex_y_a:k.y,u_tex_y_b:M.y,u_mix:p.t})};function bu(g,r){return 1/yt(g,1,r.tileZoom)}function wu(g,r,a,u){return g.translatePosMatrix(u?u.posMatrix:r.tileID.posMatrix,r,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}const qs=(g,r,a,u,p)=>{return{u_matrix:g,u_tl_parent:r,u_scale_parent:a,u_buffer_scale:1,u_fade_t:u.mix,u_opacity:u.opacity*p.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:p.paint.get("raster-brightness-min"),u_brightness_high:p.paint.get("raster-brightness-max"),u_saturation_factor:(w=p.paint.get("raster-saturation"),w>0?1-1/(1.001-w):-w),u_contrast_factor:(y=p.paint.get("raster-contrast"),y>0?1/(1-y):1+y),u_spin_weights:eg(p.paint.get("raster-hue-rotate"))};var y,w};function eg(g){g*=Math.PI/180;const r=Math.sin(g),a=Math.cos(g);return[(2*a+1)/3,(-Math.sqrt(3)*r-a+1)/3,(Math.sqrt(3)*r-a+1)/3]}const Pd=(g,r,a,u,p,y,w,T,C,k,M,P,O,V)=>{const H=w.transform;return{u_is_size_zoom_constant:+(g==="constant"||g==="source"),u_is_size_feature_constant:+(g==="constant"||g==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:H.cameraToCenterDistance,u_pitch:H.pitch/360*2*Math.PI,u_rotate_symbol:+a,u_aspect_ratio:H.width/H.height,u_fade_change:w.options.fadeDuration?w.symbolFadeChange:1,u_matrix:T,u_label_plane_matrix:C,u_coord_matrix:k,u_is_text:+P,u_pitch_with_map:+u,u_is_along_line:p,u_is_variable_anchor:y,u_texsize:O,u_texture:0,u_translation:M,u_pitched_scale:V}},Md=(g,r,a,u,p,y,w,T,C,k,M,P,O,V,H)=>{const J=w.transform;return d.e(Pd(g,r,a,u,p,y,w,T,C,k,M,P,O,H),{u_gamma_scale:u?Math.cos(J._pitch)*J.cameraToCenterDistance:1,u_device_pixel_ratio:w.pixelRatio,u_is_halo:+V})},tg=(g,r,a,u,p,y,w,T,C,k,M,P,O,V)=>d.e(Md(g,r,a,u,p,y,w,T,C,k,M,!0,P,!0,V),{u_texsize_icon:O,u_texture_icon:1}),rg=(g,r,a)=>({u_matrix:g,u_opacity:r,u_color:a}),ng=(g,r,a,u,p,y)=>d.e(function(w,T,C,k){const M=C.imageManager.getPattern(w.from.toString()),P=C.imageManager.getPattern(w.to.toString()),{width:O,height:V}=C.imageManager.getPixelSize(),H=Math.pow(2,k.tileID.overscaledZ),J=k.tileSize*Math.pow(2,C.transform.tileZoom)/H,W=J*(k.tileID.canonical.x+k.tileID.wrap*H),te=J*k.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:M.tl,u_pattern_br_a:M.br,u_pattern_tl_b:P.tl,u_pattern_br_b:P.br,u_texsize:[O,V],u_mix:T.t,u_pattern_size_a:M.displaySize,u_pattern_size_b:P.displaySize,u_scale_a:T.fromScale,u_scale_b:T.toScale,u_tile_units_to_pixels:1/yt(k,1,C.transform.tileZoom),u_pixel_coord_upper:[W>>16,te>>16],u_pixel_coord_lower:[65535&W,65535&te]}}(u,y,a,p),{u_matrix:g,u_opacity:r}),Dl={fillExtrusion:(g,r)=>({u_matrix:new d.aJ(g,r.u_matrix),u_lightpos:new d.aL(g,r.u_lightpos),u_lightintensity:new d.aI(g,r.u_lightintensity),u_lightcolor:new d.aL(g,r.u_lightcolor),u_vertical_gradient:new d.aI(g,r.u_vertical_gradient),u_opacity:new d.aI(g,r.u_opacity)}),fillExtrusionPattern:(g,r)=>({u_matrix:new d.aJ(g,r.u_matrix),u_lightpos:new d.aL(g,r.u_lightpos),u_lightintensity:new d.aI(g,r.u_lightintensity),u_lightcolor:new d.aL(g,r.u_lightcolor),u_vertical_gradient:new d.aI(g,r.u_vertical_gradient),u_height_factor:new d.aI(g,r.u_height_factor),u_image:new d.aH(g,r.u_image),u_texsize:new d.aM(g,r.u_texsize),u_pixel_coord_upper:new d.aM(g,r.u_pixel_coord_upper),u_pixel_coord_lower:new d.aM(g,r.u_pixel_coord_lower),u_scale:new d.aL(g,r.u_scale),u_fade:new d.aI(g,r.u_fade),u_opacity:new d.aI(g,r.u_opacity)}),fill:(g,r)=>({u_matrix:new d.aJ(g,r.u_matrix)}),fillPattern:(g,r)=>({u_matrix:new d.aJ(g,r.u_matrix),u_image:new d.aH(g,r.u_image),u_texsize:new d.aM(g,r.u_texsize),u_pixel_coord_upper:new d.aM(g,r.u_pixel_coord_upper),u_pixel_coord_lower:new d.aM(g,r.u_pixel_coord_lower),u_scale:new d.aL(g,r.u_scale),u_fade:new d.aI(g,r.u_fade)}),fillOutline:(g,r)=>({u_matrix:new d.aJ(g,r.u_matrix),u_world:new d.aM(g,r.u_world)}),fillOutlinePattern:(g,r)=>({u_matrix:new d.aJ(g,r.u_matrix),u_world:new d.aM(g,r.u_world),u_image:new d.aH(g,r.u_image),u_texsize:new d.aM(g,r.u_texsize),u_pixel_coord_upper:new d.aM(g,r.u_pixel_coord_upper),u_pixel_coord_lower:new d.aM(g,r.u_pixel_coord_lower),u_scale:new d.aL(g,r.u_scale),u_fade:new d.aI(g,r.u_fade)}),circle:(g,r)=>({u_camera_to_center_distance:new d.aI(g,r.u_camera_to_center_distance),u_scale_with_map:new d.aH(g,r.u_scale_with_map),u_pitch_with_map:new d.aH(g,r.u_pitch_with_map),u_extrude_scale:new d.aM(g,r.u_extrude_scale),u_device_pixel_ratio:new d.aI(g,r.u_device_pixel_ratio),u_matrix:new d.aJ(g,r.u_matrix)}),collisionBox:(g,r)=>({u_matrix:new d.aJ(g,r.u_matrix),u_pixel_extrude_scale:new d.aM(g,r.u_pixel_extrude_scale)}),collisionCircle:(g,r)=>({u_matrix:new d.aJ(g,r.u_matrix),u_inv_matrix:new d.aJ(g,r.u_inv_matrix),u_camera_to_center_distance:new d.aI(g,r.u_camera_to_center_distance),u_viewport_size:new d.aM(g,r.u_viewport_size)}),debug:(g,r)=>({u_color:new d.aN(g,r.u_color),u_matrix:new d.aJ(g,r.u_matrix),u_overlay:new d.aH(g,r.u_overlay),u_overlay_scale:new d.aI(g,r.u_overlay_scale)}),clippingMask:(g,r)=>({u_matrix:new d.aJ(g,r.u_matrix)}),heatmap:(g,r)=>({u_extrude_scale:new d.aI(g,r.u_extrude_scale),u_intensity:new d.aI(g,r.u_intensity),u_matrix:new d.aJ(g,r.u_matrix)}),heatmapTexture:(g,r)=>({u_matrix:new d.aJ(g,r.u_matrix),u_world:new d.aM(g,r.u_world),u_image:new d.aH(g,r.u_image),u_color_ramp:new d.aH(g,r.u_color_ramp),u_opacity:new d.aI(g,r.u_opacity)}),hillshade:(g,r)=>({u_matrix:new d.aJ(g,r.u_matrix),u_image:new d.aH(g,r.u_image),u_latrange:new d.aM(g,r.u_latrange),u_light:new d.aM(g,r.u_light),u_shadow:new d.aN(g,r.u_shadow),u_highlight:new d.aN(g,r.u_highlight),u_accent:new d.aN(g,r.u_accent)}),hillshadePrepare:(g,r)=>({u_matrix:new d.aJ(g,r.u_matrix),u_image:new d.aH(g,r.u_image),u_dimension:new d.aM(g,r.u_dimension),u_zoom:new d.aI(g,r.u_zoom),u_unpack:new d.aK(g,r.u_unpack)}),line:(g,r)=>({u_matrix:new d.aJ(g,r.u_matrix),u_ratio:new d.aI(g,r.u_ratio),u_device_pixel_ratio:new d.aI(g,r.u_device_pixel_ratio),u_units_to_pixels:new d.aM(g,r.u_units_to_pixels)}),lineGradient:(g,r)=>({u_matrix:new d.aJ(g,r.u_matrix),u_ratio:new d.aI(g,r.u_ratio),u_device_pixel_ratio:new d.aI(g,r.u_device_pixel_ratio),u_units_to_pixels:new d.aM(g,r.u_units_to_pixels),u_image:new d.aH(g,r.u_image),u_image_height:new d.aI(g,r.u_image_height)}),linePattern:(g,r)=>({u_matrix:new d.aJ(g,r.u_matrix),u_texsize:new d.aM(g,r.u_texsize),u_ratio:new d.aI(g,r.u_ratio),u_device_pixel_ratio:new d.aI(g,r.u_device_pixel_ratio),u_image:new d.aH(g,r.u_image),u_units_to_pixels:new d.aM(g,r.u_units_to_pixels),u_scale:new d.aL(g,r.u_scale),u_fade:new d.aI(g,r.u_fade)}),lineSDF:(g,r)=>({u_matrix:new d.aJ(g,r.u_matrix),u_ratio:new d.aI(g,r.u_ratio),u_device_pixel_ratio:new d.aI(g,r.u_device_pixel_ratio),u_units_to_pixels:new d.aM(g,r.u_units_to_pixels),u_patternscale_a:new d.aM(g,r.u_patternscale_a),u_patternscale_b:new d.aM(g,r.u_patternscale_b),u_sdfgamma:new d.aI(g,r.u_sdfgamma),u_image:new d.aH(g,r.u_image),u_tex_y_a:new d.aI(g,r.u_tex_y_a),u_tex_y_b:new d.aI(g,r.u_tex_y_b),u_mix:new d.aI(g,r.u_mix)}),raster:(g,r)=>({u_matrix:new d.aJ(g,r.u_matrix),u_tl_parent:new d.aM(g,r.u_tl_parent),u_scale_parent:new d.aI(g,r.u_scale_parent),u_buffer_scale:new d.aI(g,r.u_buffer_scale),u_fade_t:new d.aI(g,r.u_fade_t),u_opacity:new d.aI(g,r.u_opacity),u_image0:new d.aH(g,r.u_image0),u_image1:new d.aH(g,r.u_image1),u_brightness_low:new d.aI(g,r.u_brightness_low),u_brightness_high:new d.aI(g,r.u_brightness_high),u_saturation_factor:new d.aI(g,r.u_saturation_factor),u_contrast_factor:new d.aI(g,r.u_contrast_factor),u_spin_weights:new d.aL(g,r.u_spin_weights)}),symbolIcon:(g,r)=>({u_is_size_zoom_constant:new d.aH(g,r.u_is_size_zoom_constant),u_is_size_feature_constant:new d.aH(g,r.u_is_size_feature_constant),u_size_t:new d.aI(g,r.u_size_t),u_size:new d.aI(g,r.u_size),u_camera_to_center_distance:new d.aI(g,r.u_camera_to_center_distance),u_pitch:new d.aI(g,r.u_pitch),u_rotate_symbol:new d.aH(g,r.u_rotate_symbol),u_aspect_ratio:new d.aI(g,r.u_aspect_ratio),u_fade_change:new d.aI(g,r.u_fade_change),u_matrix:new d.aJ(g,r.u_matrix),u_label_plane_matrix:new d.aJ(g,r.u_label_plane_matrix),u_coord_matrix:new d.aJ(g,r.u_coord_matrix),u_is_text:new d.aH(g,r.u_is_text),u_pitch_with_map:new d.aH(g,r.u_pitch_with_map),u_is_along_line:new d.aH(g,r.u_is_along_line),u_is_variable_anchor:new d.aH(g,r.u_is_variable_anchor),u_texsize:new d.aM(g,r.u_texsize),u_texture:new d.aH(g,r.u_texture),u_translation:new d.aM(g,r.u_translation),u_pitched_scale:new d.aI(g,r.u_pitched_scale)}),symbolSDF:(g,r)=>({u_is_size_zoom_constant:new d.aH(g,r.u_is_size_zoom_constant),u_is_size_feature_constant:new d.aH(g,r.u_is_size_feature_constant),u_size_t:new d.aI(g,r.u_size_t),u_size:new d.aI(g,r.u_size),u_camera_to_center_distance:new d.aI(g,r.u_camera_to_center_distance),u_pitch:new d.aI(g,r.u_pitch),u_rotate_symbol:new d.aH(g,r.u_rotate_symbol),u_aspect_ratio:new d.aI(g,r.u_aspect_ratio),u_fade_change:new d.aI(g,r.u_fade_change),u_matrix:new d.aJ(g,r.u_matrix),u_label_plane_matrix:new d.aJ(g,r.u_label_plane_matrix),u_coord_matrix:new d.aJ(g,r.u_coord_matrix),u_is_text:new d.aH(g,r.u_is_text),u_pitch_with_map:new d.aH(g,r.u_pitch_with_map),u_is_along_line:new d.aH(g,r.u_is_along_line),u_is_variable_anchor:new d.aH(g,r.u_is_variable_anchor),u_texsize:new d.aM(g,r.u_texsize),u_texture:new d.aH(g,r.u_texture),u_gamma_scale:new d.aI(g,r.u_gamma_scale),u_device_pixel_ratio:new d.aI(g,r.u_device_pixel_ratio),u_is_halo:new d.aH(g,r.u_is_halo),u_translation:new d.aM(g,r.u_translation),u_pitched_scale:new d.aI(g,r.u_pitched_scale)}),symbolTextAndIcon:(g,r)=>({u_is_size_zoom_constant:new d.aH(g,r.u_is_size_zoom_constant),u_is_size_feature_constant:new d.aH(g,r.u_is_size_feature_constant),u_size_t:new d.aI(g,r.u_size_t),u_size:new d.aI(g,r.u_size),u_camera_to_center_distance:new d.aI(g,r.u_camera_to_center_distance),u_pitch:new d.aI(g,r.u_pitch),u_rotate_symbol:new d.aH(g,r.u_rotate_symbol),u_aspect_ratio:new d.aI(g,r.u_aspect_ratio),u_fade_change:new d.aI(g,r.u_fade_change),u_matrix:new d.aJ(g,r.u_matrix),u_label_plane_matrix:new d.aJ(g,r.u_label_plane_matrix),u_coord_matrix:new d.aJ(g,r.u_coord_matrix),u_is_text:new d.aH(g,r.u_is_text),u_pitch_with_map:new d.aH(g,r.u_pitch_with_map),u_is_along_line:new d.aH(g,r.u_is_along_line),u_is_variable_anchor:new d.aH(g,r.u_is_variable_anchor),u_texsize:new d.aM(g,r.u_texsize),u_texsize_icon:new d.aM(g,r.u_texsize_icon),u_texture:new d.aH(g,r.u_texture),u_texture_icon:new d.aH(g,r.u_texture_icon),u_gamma_scale:new d.aI(g,r.u_gamma_scale),u_device_pixel_ratio:new d.aI(g,r.u_device_pixel_ratio),u_is_halo:new d.aH(g,r.u_is_halo),u_translation:new d.aM(g,r.u_translation),u_pitched_scale:new d.aI(g,r.u_pitched_scale)}),background:(g,r)=>({u_matrix:new d.aJ(g,r.u_matrix),u_opacity:new d.aI(g,r.u_opacity),u_color:new d.aN(g,r.u_color)}),backgroundPattern:(g,r)=>({u_matrix:new d.aJ(g,r.u_matrix),u_opacity:new d.aI(g,r.u_opacity),u_image:new d.aH(g,r.u_image),u_pattern_tl_a:new d.aM(g,r.u_pattern_tl_a),u_pattern_br_a:new d.aM(g,r.u_pattern_br_a),u_pattern_tl_b:new d.aM(g,r.u_pattern_tl_b),u_pattern_br_b:new d.aM(g,r.u_pattern_br_b),u_texsize:new d.aM(g,r.u_texsize),u_mix:new d.aI(g,r.u_mix),u_pattern_size_a:new d.aM(g,r.u_pattern_size_a),u_pattern_size_b:new d.aM(g,r.u_pattern_size_b),u_scale_a:new d.aI(g,r.u_scale_a),u_scale_b:new d.aI(g,r.u_scale_b),u_pixel_coord_upper:new d.aM(g,r.u_pixel_coord_upper),u_pixel_coord_lower:new d.aM(g,r.u_pixel_coord_lower),u_tile_units_to_pixels:new d.aI(g,r.u_tile_units_to_pixels)}),terrain:(g,r)=>({u_matrix:new d.aJ(g,r.u_matrix),u_texture:new d.aH(g,r.u_texture),u_ele_delta:new d.aI(g,r.u_ele_delta)}),terrainDepth:(g,r)=>({u_matrix:new d.aJ(g,r.u_matrix),u_ele_delta:new d.aI(g,r.u_ele_delta)}),terrainCoords:(g,r)=>({u_matrix:new d.aJ(g,r.u_matrix),u_texture:new d.aH(g,r.u_texture),u_terrain_coords_id:new d.aI(g,r.u_terrain_coords_id),u_ele_delta:new d.aI(g,r.u_ele_delta)})};class Su{constructor(r,a,u){this.context=r;const p=r.gl;this.buffer=p.createBuffer(),this.dynamicDraw=!!u,this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),p.bufferData(p.ELEMENT_ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?p.DYNAMIC_DRAW:p.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){const a=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Bl={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Tu{constructor(r,a,u,p){this.length=a.length,this.attributes=u,this.itemSize=a.bytesPerElement,this.dynamicDraw=p,this.context=r;const y=r.gl;this.buffer=y.createBuffer(),r.bindVertexBuffer.set(this.buffer),y.bufferData(y.ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){if(r.length!==this.length)throw new Error(`Length of new data is ${r.length}, which doesn't match current length of ${this.length}`);const a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,a){for(let u=0;u<this.attributes.length;u++){const p=a.attributes[this.attributes[u].name];p!==void 0&&r.enableVertexAttribArray(p)}}setVertexAttribPointers(r,a,u){for(let p=0;p<this.attributes.length;p++){const y=this.attributes[p],w=a.attributes[y.name];w!==void 0&&r.vertexAttribPointer(w,y.components,r[Bl[y.type]],!1,this.itemSize,y.offset+this.itemSize*(u||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ua=new WeakMap;function ii(g){var r;if(Ua.has(g))return Ua.get(g);{const a=(r=g.getParameter(g.VERSION))===null||r===void 0?void 0:r.startsWith("WebGL 2.0");return Ua.set(g,a),a}}class $t{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Cu extends $t{getDefault(){return d.aP.transparent}set(r){const a=this.current;(r.r!==a.r||r.g!==a.g||r.b!==a.b||r.a!==a.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class ja extends $t{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class Va extends $t{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class ig extends $t{getDefault(){return[!0,!0,!0,!0]}set(r){const a=this.current;(r[0]!==a[0]||r[1]!==a[1]||r[2]!==a[2]||r[3]!==a[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Fl extends $t{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class og extends $t{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class Hs extends $t{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const a=this.current;(r.func!==a.func||r.ref!==a.ref||r.mask!==a.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class sg extends $t{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const a=this.current;(r[0]!==a[0]||r[1]!==a[1]||r[2]!==a[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class zd extends $t{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const a=this.gl;r?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST),this.current=r,this.dirty=!1}}class ag extends $t{getDefault(){return[0,1]}set(r){const a=this.current;(r[0]!==a[0]||r[1]!==a[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class Ld extends $t{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const a=this.gl;r?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST),this.current=r,this.dirty=!1}}class Iu extends $t{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class Rd extends $t{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const a=this.gl;r?a.enable(a.BLEND):a.disable(a.BLEND),this.current=r,this.dirty=!1}}class Dd extends $t{getDefault(){const r=this.gl;return[r.ONE,r.ZERO]}set(r){const a=this.current;(r[0]!==a[0]||r[1]!==a[1]||this.dirty)&&(this.gl.blendFunc(r[0],r[1]),this.current=r,this.dirty=!1)}}class Bd extends $t{getDefault(){return d.aP.transparent}set(r){const a=this.current;(r.r!==a.r||r.g!==a.g||r.b!==a.b||r.a!==a.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class Fd extends $t{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquation(r),this.current=r,this.dirty=!1)}}class fs extends $t{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const a=this.gl;r?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE),this.current=r,this.dirty=!1}}class Od extends $t{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class lg extends $t{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}class cg extends $t{getDefault(){return null}set(r){(r!==this.current||this.dirty)&&(this.gl.useProgram(r),this.current=r,this.dirty=!1)}}class Nd extends $t{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class qa extends $t{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const a=this.current;(r[0]!==a[0]||r[1]!==a[1]||r[2]!==a[2]||r[3]!==a[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class ug extends $t{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class Ol extends $t{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const a=this.gl;a.bindRenderbuffer(a.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class hg extends $t{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const a=this.gl;a.bindTexture(a.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class dg extends $t{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const a=this.gl;a.bindBuffer(a.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class $d extends $t{getDefault(){return null}set(r){const a=this.gl;a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class Ud extends $t{getDefault(){return null}set(r){var a;if(r===this.current&&!this.dirty)return;const u=this.gl;ii(u)?u.bindVertexArray(r):(a=u.getExtension("OES_vertex_array_object"))===null||a===void 0||a.bindVertexArrayOES(r),this.current=r,this.dirty=!1}}class jd extends $t{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class Eu extends $t{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class Vd extends $t{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class Ws extends $t{constructor(r,a){super(r),this.context=r,this.parent=a}getDefault(){return null}}class bo extends Ws{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class ku extends Ws{set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class Au extends Ws{set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class Pu{constructor(r,a,u,p,y){this.context=r,this.width=a,this.height=u;const w=r.gl,T=this.framebuffer=w.createFramebuffer();if(this.colorAttachment=new bo(r,T),p)this.depthAttachment=y?new Au(r,T):new ku(r,T);else if(y)throw new Error("Stencil cannot be set without depth");if(w.checkFramebufferStatus(w.FRAMEBUFFER)!==w.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const r=this.context.gl,a=this.colorAttachment.get();if(a&&r.deleteTexture(a),this.depthAttachment){const u=this.depthAttachment.get();u&&r.deleteRenderbuffer(u)}r.deleteFramebuffer(this.framebuffer)}}class Sr{constructor(r,a,u){this.blendFunction=r,this.blendColor=a,this.mask=u}}Sr.Replace=[1,0],Sr.disabled=new Sr(Sr.Replace,d.aP.transparent,[!1,!1,!1,!1]),Sr.unblended=new Sr(Sr.Replace,d.aP.transparent,[!0,!0,!0,!0]),Sr.alphaBlended=new Sr([1,771],d.aP.transparent,[!0,!0,!0,!0]);class Mu{constructor(r){var a,u;if(this.gl=r,this.clearColor=new Cu(this),this.clearDepth=new ja(this),this.clearStencil=new Va(this),this.colorMask=new ig(this),this.depthMask=new Fl(this),this.stencilMask=new og(this),this.stencilFunc=new Hs(this),this.stencilOp=new sg(this),this.stencilTest=new zd(this),this.depthRange=new ag(this),this.depthTest=new Ld(this),this.depthFunc=new Iu(this),this.blend=new Rd(this),this.blendFunc=new Dd(this),this.blendColor=new Bd(this),this.blendEquation=new Fd(this),this.cullFace=new fs(this),this.cullFaceSide=new Od(this),this.frontFace=new lg(this),this.program=new cg(this),this.activeTexture=new Nd(this),this.viewport=new qa(this),this.bindFramebuffer=new ug(this),this.bindRenderbuffer=new Ol(this),this.bindTexture=new hg(this),this.bindVertexBuffer=new dg(this),this.bindElementBuffer=new $d(this),this.bindVertexArray=new Ud(this),this.pixelStoreUnpack=new jd(this),this.pixelStoreUnpackPremultiplyAlpha=new Eu(this),this.pixelStoreUnpackFlipY=new Vd(this),this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),ii(r)){this.HALF_FLOAT=r.HALF_FLOAT;const p=r.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(a=r.RGBA16F)!==null&&a!==void 0?a:p==null?void 0:p.RGBA16F_EXT,this.RGB16F=(u=r.RGB16F)!==null&&u!==void 0?u:p==null?void 0:p.RGB16F_EXT,r.getExtension("EXT_color_buffer_float")}else{r.getExtension("EXT_color_buffer_half_float"),r.getExtension("OES_texture_half_float_linear");const p=r.getExtension("OES_texture_half_float");this.HALF_FLOAT=p==null?void 0:p.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,a){return new Su(this,r,a)}createVertexBuffer(r,a,u){return new Tu(this,r,a,u)}createRenderbuffer(r,a,u){const p=this.gl,y=p.createRenderbuffer();return this.bindRenderbuffer.set(y),p.renderbufferStorage(p.RENDERBUFFER,r,a,u),this.bindRenderbuffer.set(null),y}createFramebuffer(r,a,u,p){return new Pu(this,r,a,u,p)}clear({color:r,depth:a,stencil:u}){const p=this.gl;let y=0;r&&(y|=p.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set([!0,!0,!0,!0])),a!==void 0&&(y|=p.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(a),this.depthMask.set(!0)),u!==void 0&&(y|=p.STENCIL_BUFFER_BIT,this.clearStencil.set(u),this.stencilMask.set(255)),p.clear(y)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){d.aE(r.blendFunction,Sr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor)),this.colorMask.set(r.mask)}createVertexArray(){var r;return ii(this.gl)?this.gl.createVertexArray():(r=this.gl.getExtension("OES_vertex_array_object"))===null||r===void 0?void 0:r.createVertexArrayOES()}deleteVertexArray(r){var a;return ii(this.gl)?this.gl.deleteVertexArray(r):(a=this.gl.getExtension("OES_vertex_array_object"))===null||a===void 0?void 0:a.deleteVertexArrayOES(r)}unbindVAO(){this.bindVertexArray.set(null)}}class Ct{constructor(r,a,u){this.func=r,this.mask=a,this.range=u}}Ct.ReadOnly=!1,Ct.ReadWrite=!0,Ct.disabled=new Ct(519,Ct.ReadOnly,[0,1]);const Ha=7680;class dr{constructor(r,a,u,p,y,w){this.test=r,this.ref=a,this.mask=u,this.fail=p,this.depthFail=y,this.pass=w}}dr.disabled=new dr({func:519,mask:0},0,0,Ha,Ha,Ha);class ur{constructor(r,a,u){this.enable=r,this.mode=a,this.frontFace=u}}let Nl;function qd(g,r,a,u,p){const y=g.context,w=y.gl,T=g.useProgram("collisionBox"),C=[];let k=0,M=0;for(let te=0;te<u.length;te++){const se=u[te],X=r.getTile(se).getBucket(a);if(!X)continue;const ce=p?X.textCollisionBox:X.iconCollisionBox,fe=X.collisionCircleArray;if(fe.length>0){const _e=d.F();d.aQ(_e,X.placementInvProjMatrix,g.transform.glCoordMatrix),d.aQ(_e,_e,X.placementViewportMatrix),C.push({circleArray:fe,circleOffset:M,transform:se.posMatrix,invTransform:_e,coord:se}),k+=fe.length/4,M=k}ce&&T.draw(y,w.LINES,Ct.disabled,dr.disabled,g.colorModeForRenderPass(),ur.disabled,{u_matrix:se.posMatrix,u_pixel_extrude_scale:[1/(P=g.transform).width,1/P.height]},g.style.map.terrain&&g.style.map.terrain.getTerrainData(se),a.id,ce.layoutVertexBuffer,ce.indexBuffer,ce.segments,null,g.transform.zoom,null,null,ce.collisionVertexBuffer)}var P;if(!p||!C.length)return;const O=g.useProgram("collisionCircle"),V=new d.aR;V.resize(4*k),V._trim();let H=0;for(const te of C)for(let se=0;se<te.circleArray.length/4;se++){const X=4*se,ce=te.circleArray[X+0],fe=te.circleArray[X+1],_e=te.circleArray[X+2],Ce=te.circleArray[X+3];V.emplace(H++,ce,fe,_e,Ce,0),V.emplace(H++,ce,fe,_e,Ce,1),V.emplace(H++,ce,fe,_e,Ce,2),V.emplace(H++,ce,fe,_e,Ce,3)}(!Nl||Nl.length<2*k)&&(Nl=function(te){const se=2*te,X=new d.aT;X.resize(se),X._trim();for(let ce=0;ce<se;ce++){const fe=6*ce;X.uint16[fe+0]=4*ce+0,X.uint16[fe+1]=4*ce+1,X.uint16[fe+2]=4*ce+2,X.uint16[fe+3]=4*ce+2,X.uint16[fe+4]=4*ce+3,X.uint16[fe+5]=4*ce+0}return X}(k));const J=y.createIndexBuffer(Nl,!0),W=y.createVertexBuffer(V,d.aS.members,!0);for(const te of C){const se=Qm(te.transform,te.invTransform,g.transform);O.draw(y,w.TRIANGLES,Ct.disabled,dr.disabled,g.colorModeForRenderPass(),ur.disabled,se,g.style.map.terrain&&g.style.map.terrain.getTerrainData(te.coord),a.id,W,J,d.$.simpleSegment(0,2*te.circleOffset,te.circleArray.length,te.circleArray.length/2),null,g.transform.zoom,null,null,null)}W.destroy(),J.destroy()}ur.disabled=new ur(!1,1029,2305),ur.backCCW=new ur(!0,1029,2305);const zu=d.an(new Float32Array(16));function pg(g,r,a,u,p,y){const{horizontalAlign:w,verticalAlign:T}=d.au(g);return new d.P((-(w-.5)*r/p+u[0])*y,(-(T-.5)*a/p+u[1])*y)}function Hd(g,r,a,u,p,y){const w=r.tileAnchorPoint.add(new d.P(r.translation[0],r.translation[1]));if(r.pitchWithMap){let T=u.mult(y);return a||(T=T.rotate(-p)),Yr(w.add(T),r.labelPlaneMatrix,r.getElevation).point}if(a){const T=ne(r.tileAnchorPoint.x+1,r.tileAnchorPoint.y,r).point.sub(g),C=Math.atan(T.y/T.x)+(T.x<0?Math.PI:0);return g.add(u.rotate(C))}return g.add(u)}function $l(g,r,a,u,p,y,w,T,C,k,M,P,O,V){const H=g.text.placedSymbolArray,J=g.text.dynamicLayoutVertexArray,W=g.icon.dynamicLayoutVertexArray,te={};J.clear();for(let se=0;se<H.length;se++){const X=H.get(se),ce=X.hidden||!X.crossTileID||g.allowVerticalPlacement&&!X.placedOrientation?null:u[X.crossTileID];if(ce){const fe=new d.P(X.anchorX,X.anchorY),_e={getElevation:V,width:p.width,height:p.height,labelPlaneMatrix:y,lineVertexArray:null,pitchWithMap:a,projection:M,projectionCache:null,tileAnchorPoint:fe,translation:P,unwrappedTileID:O},Ce=a?Yr(fe,w,V):ne(fe.x,fe.y,_e),Me=K(p.cameraToCenterDistance,Ce.signedDistanceFromCamera);let He=d.ai(g.textSizeData,C,X)*Me/d.ap;a&&(He*=g.tilePixelRatio/T);const{width:We,height:ze,anchor:De,textOffset:Je,textBoxScale:_t}=ce,Fe=pg(De,We,ze,Je,_t,He),$e=M.getPitchedTextCorrection(p,fe.add(new d.P(P[0],P[1])),O),dt=Hd(Ce.point,_e,r,Fe,p.angle,$e),or=g.allowVerticalPlacement&&X.placedOrientation===d.ah.vertical?Math.PI/2:0;for(let Tt=0;Tt<X.numGlyphs;Tt++)d.aj(J,dt,or);k&&X.associatedIconIndex>=0&&(te[X.associatedIconIndex]={shiftedAnchor:dt,angle:or})}else at(X.numGlyphs,J)}if(k){W.clear();const se=g.icon.placedSymbolArray;for(let X=0;X<se.length;X++){const ce=se.get(X);if(ce.hidden)at(ce.numGlyphs,W);else{const fe=te[X];if(fe)for(let _e=0;_e<ce.numGlyphs;_e++)d.aj(W,fe.shiftedAnchor,fe.angle);else at(ce.numGlyphs,W)}}g.icon.dynamicLayoutVertexBuffer.updateData(W)}g.text.dynamicLayoutVertexBuffer.updateData(J)}function Ul(g,r,a){return a.iconsInText&&r?"symbolTextAndIcon":g?"symbolSDF":"symbolIcon"}function Wa(g,r,a,u,p,y,w,T,C,k,M,P){const O=g.context,V=O.gl,H=g.transform,J=Un(),W=T==="map",te=C==="map",se=T!=="viewport"&&a.layout.get("symbol-placement")!=="point",X=W&&!te&&!se,ce=!te&&se,fe=!a.layout.get("symbol-sort-key").isConstant();let _e=!1;const Ce=g.depthModeForSublayer(0,Ct.ReadOnly),Me=a._unevaluatedLayout.hasValue("text-variable-anchor")||a._unevaluatedLayout.hasValue("text-variable-anchor-offset"),He=[],We=J.getCircleRadiusCorrection(H);for(const ze of u){const De=r.getTile(ze),Je=De.getBucket(a);if(!Je)continue;const _t=p?Je.text:Je.icon;if(!_t||!_t.segments.get().length||!_t.hasVisibleVertices)continue;const Fe=_t.programConfigurations.get(a.id),$e=p||Je.sdfIcons,dt=p?Je.textSizeData:Je.iconSizeData,or=te||H.pitch!==0,Tt=g.useProgram(Ul($e,p,Je),Fe),kt=d.ag(dt,H.zoom),sr=g.style.map.terrain&&g.style.map.terrain.getTerrainData(ze);let dn,Pi,ar,Vn,kn=[0,0],pn=null;if(p)Pi=De.glyphAtlasTexture,ar=V.LINEAR,dn=De.glyphAtlasTexture.size,Je.iconsInText&&(kn=De.imageAtlasTexture.size,pn=De.imageAtlasTexture,Vn=or||g.options.rotating||g.options.zooming||dt.kind==="composite"||dt.kind==="camera"?V.LINEAR:V.NEAREST);else{const pr=a.layout.get("icon-size").constantOr(0)!==1||Je.iconsNeedLinear;Pi=De.imageAtlasTexture,ar=$e||g.options.rotating||g.options.zooming||pr||or?V.LINEAR:V.NEAREST,dn=De.imageAtlasTexture.size}const fn=yt(De,1,g.transform.zoom),Mi=ce?ze.posMatrix:zu,bs=_o(Mi,te,W,g.transform,fn),sc=vo(Mi,te,W,g.transform,fn),ea=vo(ze.posMatrix,te,W,g.transform,fn),ws=J.translatePosition(g.transform,De,y,w),ac=Me&&Je.hasTextData(),th=a.layout.get("icon-text-fit")!=="none"&&ac&&Je.hasIconData();if(se){const pr=g.style.map.terrain?(rh,Vr)=>g.style.map.terrain.getElevation(ze,rh,Vr):null,ra=a.layout.get("text-rotation-alignment")==="map";B(Je,ze.posMatrix,g,p,bs,ea,te,k,ra,J,ze.toUnwrapped(),H.width,H.height,ws,pr)}const sn=ze.posMatrix,zi=p&&Me||th,Ho=se||zi?zu:bs,ta=sc,mn=$e&&a.paint.get(p?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let gn;gn=$e?Je.iconsInText?tg(dt.kind,kt,X,te,se,zi,g,sn,Ho,ta,ws,dn,kn,We):Md(dt.kind,kt,X,te,se,zi,g,sn,Ho,ta,ws,p,dn,!0,We):Pd(dt.kind,kt,X,te,se,zi,g,sn,Ho,ta,ws,p,dn,We);const Jr={program:Tt,buffers:_t,uniformValues:gn,atlasTexture:Pi,atlasTextureIcon:pn,atlasInterpolation:ar,atlasInterpolationIcon:Vn,isSDF:$e,hasHalo:mn};if(fe&&Je.canOverlap){_e=!0;const pr=_t.segments.get();for(const ra of pr)He.push({segments:new d.$([ra]),sortKey:ra.sortKey,state:Jr,terrainData:sr})}else He.push({segments:_t.segments,sortKey:0,state:Jr,terrainData:sr})}_e&&He.sort((ze,De)=>ze.sortKey-De.sortKey);for(const ze of He){const De=ze.state;if(O.activeTexture.set(V.TEXTURE0),De.atlasTexture.bind(De.atlasInterpolation,V.CLAMP_TO_EDGE),De.atlasTextureIcon&&(O.activeTexture.set(V.TEXTURE1),De.atlasTextureIcon&&De.atlasTextureIcon.bind(De.atlasInterpolationIcon,V.CLAMP_TO_EDGE)),De.isSDF){const Je=De.uniformValues;De.hasHalo&&(Je.u_is_halo=1,jl(De.buffers,ze.segments,a,g,De.program,Ce,M,P,Je,ze.terrainData)),Je.u_is_halo=0}jl(De.buffers,ze.segments,a,g,De.program,Ce,M,P,De.uniformValues,ze.terrainData)}}function jl(g,r,a,u,p,y,w,T,C,k){const M=u.context;p.draw(M,M.gl.TRIANGLES,y,w,T,ur.disabled,C,k,a.id,g.layoutVertexBuffer,g.indexBuffer,r,a.paint,u.transform.zoom,g.programConfigurations.get(a.id),g.dynamicLayoutVertexBuffer,g.opacityVertexBuffer)}function $o(g,r,a,u,p){if(!a||!u||!u.imageAtlas)return;const y=u.imageAtlas.patternPositions;let w=y[a.to.toString()],T=y[a.from.toString()];if(!w&&T&&(w=T),!T&&w&&(T=w),!w||!T){const C=p.getPaintProperty(r);w=y[C],T=y[C]}w&&T&&g.setConstantPatternPositions(w,T)}function ms(g,r,a,u,p,y,w){const T=g.context.gl,C="fill-pattern",k=a.paint.get(C),M=k&&k.constantOr(1),P=a.getCrossfadeParameters();let O,V,H,J,W;w?(V=M&&!a.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",O=T.LINES):(V=M?"fillPattern":"fill",O=T.TRIANGLES);const te=k.constantOr(null);for(const se of u){const X=r.getTile(se);if(M&&!X.patternsLoaded())continue;const ce=X.getBucket(a);if(!ce)continue;const fe=ce.programConfigurations.get(a.id),_e=g.useProgram(V,fe),Ce=g.style.map.terrain&&g.style.map.terrain.getTerrainData(se);M&&(g.context.activeTexture.set(T.TEXTURE0),X.imageAtlasTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),fe.updatePaintBuffers(P)),$o(fe,C,te,X,a);const Me=Ce?se:null,He=g.translatePosMatrix(Me?Me.posMatrix:se.posMatrix,X,a.paint.get("fill-translate"),a.paint.get("fill-translate-anchor"));if(w){J=ce.indexBuffer2,W=ce.segments2;const We=[T.drawingBufferWidth,T.drawingBufferHeight];H=V==="fillOutlinePattern"&&M?$a(He,g,P,X,We):zl(He,We)}else J=ce.indexBuffer,W=ce.segments,H=M?Na(He,g,P,X):Ml(He);_e.draw(g.context,O,p,g.stencilModeForClipping(se),y,ur.disabled,H,Ce,a.id,ce.layoutVertexBuffer,J,W,a.paint,g.transform.zoom,fe)}}function jn(g,r,a,u,p,y,w){const T=g.context,C=T.gl,k="fill-extrusion-pattern",M=a.paint.get(k),P=M.constantOr(1),O=a.getCrossfadeParameters(),V=a.paint.get("fill-extrusion-opacity"),H=M.constantOr(null);for(const J of u){const W=r.getTile(J),te=W.getBucket(a);if(!te)continue;const se=g.style.map.terrain&&g.style.map.terrain.getTerrainData(J),X=te.programConfigurations.get(a.id),ce=g.useProgram(P?"fillExtrusionPattern":"fillExtrusion",X);P&&(g.context.activeTexture.set(C.TEXTURE0),W.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),X.updatePaintBuffers(O)),$o(X,k,H,W,a);const fe=g.translatePosMatrix(J.posMatrix,W,a.paint.get("fill-extrusion-translate"),a.paint.get("fill-extrusion-translate-anchor")),_e=a.paint.get("fill-extrusion-vertical-gradient"),Ce=P?_u(fe,g,_e,V,J,O,W):Oa(fe,g,_e,V);ce.draw(T,T.gl.TRIANGLES,p,y,w,ur.backCCW,Ce,se,a.id,te.layoutVertexBuffer,te.indexBuffer,te.segments,a.paint,g.transform.zoom,X,g.style.map.terrain&&te.centroidVertexBuffer)}}function Wd(g,r,a,u,p,y,w){const T=g.context,C=T.gl,k=a.fbo;if(!k)return;const M=g.useProgram("hillshade"),P=g.style.map.terrain&&g.style.map.terrain.getTerrainData(r);T.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,k.colorAttachment.get()),M.draw(T,C.TRIANGLES,p,y,w,ur.disabled,((O,V,H,J)=>{const W=H.paint.get("hillshade-shadow-color"),te=H.paint.get("hillshade-highlight-color"),se=H.paint.get("hillshade-accent-color");let X=H.paint.get("hillshade-illumination-direction")*(Math.PI/180);H.paint.get("hillshade-illumination-anchor")==="viewport"&&(X-=O.transform.angle);const ce=!O.options.moving;return{u_matrix:J?J.posMatrix:O.transform.calculatePosMatrix(V.tileID.toUnwrapped(),ce),u_image:0,u_latrange:Ll(0,V.tileID),u_light:[H.paint.get("hillshade-exaggeration"),X],u_shadow:W,u_highlight:te,u_accent:se}})(g,a,u,P?r:null),P,u.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments)}function Gd(g,r,a,u,p,y){const w=g.context,T=w.gl,C=r.dem;if(C&&C.data){const k=C.dim,M=C.stride,P=C.getPixels();if(w.activeTexture.set(T.TEXTURE1),w.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||g.getTileTexture(M),r.demTexture){const V=r.demTexture;V.update(P,{premultiply:!1}),V.bind(T.NEAREST,T.CLAMP_TO_EDGE)}else r.demTexture=new st(w,P,T.RGBA,{premultiply:!1}),r.demTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE);w.activeTexture.set(T.TEXTURE0);let O=r.fbo;if(!O){const V=new st(w,{width:k,height:k,data:null},T.RGBA);V.bind(T.LINEAR,T.CLAMP_TO_EDGE),O=r.fbo=w.createFramebuffer(k,k,!0,!1),O.colorAttachment.set(V.texture)}w.bindFramebuffer.set(O.framebuffer),w.viewport.set([0,0,k,k]),g.useProgram("hillshadePrepare").draw(w,T.TRIANGLES,u,p,y,ur.disabled,((V,H)=>{const J=H.stride,W=d.F();return d.aO(W,0,d.W,-d.W,0,0,1),d.H(W,W,[0,-d.W,0]),{u_matrix:W,u_image:1,u_dimension:[J,J],u_zoom:V.overscaledZ,u_unpack:H.getUnpackVector()}})(r.tileID,C),null,a.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments),r.needsHillshadePrepare=!1}}function Lu(g,r,a,u,p,y){const w=u.paint.get("raster-fade-duration");if(!y&&w>0){const T=j.now(),C=(T-g.timeAdded)/w,k=r?(T-r.timeAdded)/w:-1,M=a.getSource(),P=p.coveringZoomLevel({tileSize:M.tileSize,roundZoom:M.roundZoom}),O=!r||Math.abs(r.tileID.overscaledZ-P)>Math.abs(g.tileID.overscaledZ-P),V=O&&g.refreshedUponExpiration?1:d.ac(O?C:1-k,0,1);return g.refreshedUponExpiration&&C>=1&&(g.refreshedUponExpiration=!1),r?{opacity:1,mix:1-V}:{opacity:V,mix:0}}return{opacity:1,mix:0}}const gs=new d.aP(1,0,0,1),Vl=new d.aP(0,1,0,1),ql=new d.aP(0,0,1,1),Ga=new d.aP(1,0,1,1),Hl=new d.aP(0,1,1,1);function Ru(g,r,a,u){wo(g,0,r+a/2,g.transform.width,a,u)}function ys(g,r,a,u){wo(g,r-a/2,0,a,g.transform.height,u)}function wo(g,r,a,u,p,y){const w=g.context,T=w.gl;T.enable(T.SCISSOR_TEST),T.scissor(r*g.pixelRatio,a*g.pixelRatio,u*g.pixelRatio,p*g.pixelRatio),w.clear({color:y}),T.disable(T.SCISSOR_TEST)}function Zd(g,r,a){const u=g.context,p=u.gl,y=a.posMatrix,w=g.useProgram("debug"),T=Ct.disabled,C=dr.disabled,k=g.colorModeForRenderPass(),M="$debug",P=g.style.map.terrain&&g.style.map.terrain.getTerrainData(a);u.activeTexture.set(p.TEXTURE0);const O=r.getTileByID(a.key).latestRawTileData,V=Math.floor((O&&O.byteLength||0)/1024),H=r.getTile(a).tileSize,J=512/Math.min(H,512)*(a.overscaledZ/g.transform.zoom)*.5;let W=a.canonical.toString();a.overscaledZ!==a.canonical.z&&(W+=` => ${a.overscaledZ}`),function(te,se){te.initDebugOverlayCanvas();const X=te.debugOverlayCanvas,ce=te.context.gl,fe=te.debugOverlayCanvas.getContext("2d");fe.clearRect(0,0,X.width,X.height),fe.shadowColor="white",fe.shadowBlur=2,fe.lineWidth=1.5,fe.strokeStyle="white",fe.textBaseline="top",fe.font="bold 36px Open Sans, sans-serif",fe.fillText(se,5,5),fe.strokeText(se,5,5),te.debugOverlayTexture.update(X),te.debugOverlayTexture.bind(ce.LINEAR,ce.CLAMP_TO_EDGE)}(g,`${W} ${V}kB`),w.draw(u,p.TRIANGLES,T,C,Sr.alphaBlended,ur.disabled,vu(y,d.aP.transparent,J),null,M,g.debugBuffer,g.quadTriangleIndexBuffer,g.debugSegments),w.draw(u,p.LINE_STRIP,T,C,k,ur.disabled,vu(y,d.aP.red),P,M,g.debugBuffer,g.tileBorderIndexBuffer,g.debugSegments)}function Wl(g,r,a){const u=g.context,p=u.gl,y=g.colorModeForRenderPass(),w=new Ct(p.LEQUAL,Ct.ReadWrite,g.depthRangeFor3D),T=g.useProgram("terrain"),C=r.getTerrainMesh();u.bindFramebuffer.set(null),u.viewport.set([0,0,g.width,g.height]);for(const k of a){const M=g.renderToTexture.getTexture(k),P=r.getTerrainData(k.tileID);u.activeTexture.set(p.TEXTURE0),p.bindTexture(p.TEXTURE_2D,M.texture);const O={u_matrix:g.transform.calculatePosMatrix(k.tileID.toUnwrapped()),u_texture:0,u_ele_delta:r.getMeshFrameDelta(g.transform.zoom)};T.draw(u,p.TRIANGLES,w,dr.disabled,y,ur.backCCW,O,P,"terrain",C.vertexBuffer,C.indexBuffer,C.segments)}}class Dt{constructor(r,a){this.context=new Mu(r),this.transform=a,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:d.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Le.maxUnderzooming+Le.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new wr}resize(r,a,u){if(this.width=Math.floor(r*u),this.height=Math.floor(a*u),this.pixelRatio=u,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const p of this.style._order)this.style._layers[p].resize()}setup(){const r=this.context,a=new d.aW;a.emplaceBack(0,0),a.emplaceBack(d.W,0),a.emplaceBack(0,d.W),a.emplaceBack(d.W,d.W),this.tileExtentBuffer=r.createVertexBuffer(a,Ji.members),this.tileExtentSegments=d.$.simpleSegment(0,0,4,2);const u=new d.aW;u.emplaceBack(0,0),u.emplaceBack(d.W,0),u.emplaceBack(0,d.W),u.emplaceBack(d.W,d.W),this.debugBuffer=r.createVertexBuffer(u,Ji.members),this.debugSegments=d.$.simpleSegment(0,0,4,5);const p=new d.Z;p.emplaceBack(0,0,0,0),p.emplaceBack(d.W,0,d.W,0),p.emplaceBack(0,d.W,0,d.W),p.emplaceBack(d.W,d.W,d.W,d.W),this.rasterBoundsBuffer=r.createVertexBuffer(p,Ht.members),this.rasterBoundsSegments=d.$.simpleSegment(0,0,4,2);const y=new d.aW;y.emplaceBack(0,0),y.emplaceBack(1,0),y.emplaceBack(0,1),y.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(y,Ji.members),this.viewportSegments=d.$.simpleSegment(0,0,4,2);const w=new d.aX;w.emplaceBack(0),w.emplaceBack(1),w.emplaceBack(3),w.emplaceBack(2),w.emplaceBack(0),this.tileBorderIndexBuffer=r.createIndexBuffer(w);const T=new d.aY;T.emplaceBack(0,1,2),T.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(T);const C=this.context.gl;this.stencilClearMode=new dr({func:C.ALWAYS,mask:0},0,255,C.ZERO,C.ZERO,C.ZERO)}clearStencil(){const r=this.context,a=r.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const u=d.F();d.aO(u,0,this.width,this.height,0,0,1),d.J(u,u,[a.drawingBufferWidth,a.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(r,a.TRIANGLES,Ct.disabled,this.stencilClearMode,Sr.disabled,ur.disabled,Ad(u),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(r,a){if(this.currentStencilSource===r.source||!r.isTileClipped()||!a||!a.length)return;this.currentStencilSource=r.source;const u=this.context,p=u.gl;this.nextStencilID+a.length>256&&this.clearStencil(),u.setColorMode(Sr.disabled),u.setDepthMode(Ct.disabled);const y=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const w of a){const T=this._tileClippingMaskIDs[w.key]=this.nextStencilID++,C=this.style.map.terrain&&this.style.map.terrain.getTerrainData(w);y.draw(u,p.TRIANGLES,Ct.disabled,new dr({func:p.ALWAYS,mask:0},T,255,p.KEEP,p.KEEP,p.REPLACE),Sr.disabled,ur.disabled,Ad(w.posMatrix),C,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,a=this.context.gl;return new dr({func:a.NOTEQUAL,mask:255},r,255,a.KEEP,a.KEEP,a.REPLACE)}stencilModeForClipping(r){const a=this.context.gl;return new dr({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,a.KEEP,a.KEEP,a.REPLACE)}stencilConfigForOverlap(r){const a=this.context.gl,u=r.sort((w,T)=>T.overscaledZ-w.overscaledZ),p=u[u.length-1].overscaledZ,y=u[0].overscaledZ-p+1;if(y>1){this.currentStencilSource=void 0,this.nextStencilID+y>256&&this.clearStencil();const w={};for(let T=0;T<y;T++)w[T+p]=new dr({func:a.GEQUAL,mask:255},T+this.nextStencilID,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID+=y,[w,u]}return[{[p]:dr.disabled},u]}colorModeForRenderPass(){const r=this.context.gl;return this._showOverdrawInspector?new Sr([r.CONSTANT_COLOR,r.ONE],new d.aP(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Sr.unblended:Sr.alphaBlended}depthModeForSublayer(r,a,u){if(!this.opaquePassEnabledForLayer())return Ct.disabled;const p=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new Ct(u||this.context.gl.LEQUAL,a,[p,p])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(r,a){this.style=r,this.options=a,this.lineAtlas=r.lineAtlas,this.imageManager=r.imageManager,this.glyphManager=r.glyphManager,this.symbolFadeChange=r.placement.symbolFadeChange(j.now()),this.imageManager.beginFrame();const u=this.style._order,p=this.style.sourceCaches,y={},w={},T={};for(const C in p){const k=p[C];k.used&&k.prepare(this.context),y[C]=k.getVisibleCoordinates(),w[C]=y[C].slice().reverse(),T[C]=k.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let C=0;C<u.length;C++)if(this.style._layers[u[C]].is3D()){this.opaquePassCutoff=C;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const C of u){const k=this.style._layers[C];if(!k.hasOffscreenPass()||k.isHidden(this.transform.zoom))continue;const M=w[k.source];(k.type==="custom"||M.length)&&this.renderLayer(this,p[k.source],k,M)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?d.aP.black:d.aP.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(r._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=u.length-1;this.currentLayer>=0;this.currentLayer--){const C=this.style._layers[u[this.currentLayer]],k=p[C.source],M=y[C.source];this._renderTileClippingMasks(C,M),this.renderLayer(this,k,C,M)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<u.length;this.currentLayer++){const C=this.style._layers[u[this.currentLayer]],k=p[C.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(C))continue;const M=(C.type==="symbol"?T:w)[C.source];this._renderTileClippingMasks(C,y[C.source]),this.renderLayer(this,k,C,M)}if(this.options.showTileBoundaries){const C=function(k,M){let P=null;const O=Object.values(k._layers).flatMap(W=>W.source&&!W.isHidden(M)?[k.sourceCaches[W.source]]:[]),V=O.filter(W=>W.getSource().type==="vector"),H=O.filter(W=>W.getSource().type!=="vector"),J=W=>{(!P||P.getSource().maxzoom<W.getSource().maxzoom)&&(P=W)};return V.forEach(W=>J(W)),P||H.forEach(W=>J(W)),P}(this.style,this.transform.zoom);C&&function(k,M,P){for(let O=0;O<P.length;O++)Zd(k,M,P[O])}(this,C,C.getVisibleCoordinates())}this.options.showPadding&&function(C){const k=C.transform.padding;Ru(C,C.transform.height-(k.top||0),3,gs),Ru(C,k.bottom||0,3,Vl),ys(C,k.left||0,3,ql),ys(C,C.transform.width-(k.right||0),3,Ga);const M=C.transform.centerPoint;(function(P,O,V,H){wo(P,O-1,V-10,2,20,H),wo(P,O-10,V-1,20,2,H)})(C,M.x,C.transform.height-M.y,Hl)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(r){if(!this.style||!this.style.map||!this.style.map.terrain)return;const a=this.terrainFacilitator.matrix,u=this.transform.modelViewProjectionMatrix;let p=this.terrainFacilitator.dirty;p||(p=r?!d.aZ(a,u):!d.a_(a,u)),p||(p=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),p&&(d.a$(a,u),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(y,w){const T=y.context,C=T.gl,k=Sr.unblended,M=new Ct(C.LEQUAL,Ct.ReadWrite,[0,1]),P=w.getTerrainMesh(),O=w.sourceCache.getRenderableTiles(),V=y.useProgram("terrainDepth");T.bindFramebuffer.set(w.getFramebuffer("depth").framebuffer),T.viewport.set([0,0,y.width/devicePixelRatio,y.height/devicePixelRatio]),T.clear({color:d.aP.transparent,depth:1});for(const H of O){const J=w.getTerrainData(H.tileID),W={u_matrix:y.transform.calculatePosMatrix(H.tileID.toUnwrapped()),u_ele_delta:w.getMeshFrameDelta(y.transform.zoom)};V.draw(T,C.TRIANGLES,M,dr.disabled,k,ur.backCCW,W,J,"terrain",P.vertexBuffer,P.indexBuffer,P.segments)}T.bindFramebuffer.set(null),T.viewport.set([0,0,y.width,y.height])}(this,this.style.map.terrain),function(y,w){const T=y.context,C=T.gl,k=Sr.unblended,M=new Ct(C.LEQUAL,Ct.ReadWrite,[0,1]),P=w.getTerrainMesh(),O=w.getCoordsTexture(),V=w.sourceCache.getRenderableTiles(),H=y.useProgram("terrainCoords");T.bindFramebuffer.set(w.getFramebuffer("coords").framebuffer),T.viewport.set([0,0,y.width/devicePixelRatio,y.height/devicePixelRatio]),T.clear({color:d.aP.transparent,depth:1}),w.coordsIndex=[];for(const J of V){const W=w.getTerrainData(J.tileID);T.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,O.texture);const te={u_matrix:y.transform.calculatePosMatrix(J.tileID.toUnwrapped()),u_terrain_coords_id:(255-w.coordsIndex.length)/255,u_texture:0,u_ele_delta:w.getMeshFrameDelta(y.transform.zoom)};H.draw(T,C.TRIANGLES,M,dr.disabled,k,ur.backCCW,te,W,"terrain",P.vertexBuffer,P.indexBuffer,P.segments),w.coordsIndex.push(J.tileID.key)}T.bindFramebuffer.set(null),T.viewport.set([0,0,y.width,y.height])}(this,this.style.map.terrain))}renderLayer(r,a,u,p){if(!u.isHidden(this.transform.zoom)&&(u.type==="background"||u.type==="custom"||(p||[]).length))switch(this.id=u.id,u.type){case"symbol":(function(y,w,T,C,k){if(y.renderPass!=="translucent")return;const M=dr.disabled,P=y.colorModeForRenderPass();(T._unevaluatedLayout.hasValue("text-variable-anchor")||T._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(O,V,H,J,W,te,se,X,ce){const fe=V.transform,_e=Un(),Ce=W==="map",Me=te==="map";for(const He of O){const We=J.getTile(He),ze=We.getBucket(H);if(!ze||!ze.text||!ze.text.segments.get().length)continue;const De=d.ag(ze.textSizeData,fe.zoom),Je=yt(We,1,V.transform.zoom),_t=_o(He.posMatrix,Me,Ce,V.transform,Je),Fe=H.layout.get("icon-text-fit")!=="none"&&ze.hasIconData();if(De){const $e=Math.pow(2,fe.zoom-We.tileID.overscaledZ),dt=V.style.map.terrain?(Tt,kt)=>V.style.map.terrain.getElevation(He,Tt,kt):null,or=_e.translatePosition(fe,We,se,X);$l(ze,Ce,Me,ce,fe,_t,He.posMatrix,$e,De,Fe,_e,or,He.toUnwrapped(),dt)}}}(C,y,T,w,T.layout.get("text-rotation-alignment"),T.layout.get("text-pitch-alignment"),T.paint.get("text-translate"),T.paint.get("text-translate-anchor"),k),T.paint.get("icon-opacity").constantOr(1)!==0&&Wa(y,w,T,C,!1,T.paint.get("icon-translate"),T.paint.get("icon-translate-anchor"),T.layout.get("icon-rotation-alignment"),T.layout.get("icon-pitch-alignment"),T.layout.get("icon-keep-upright"),M,P),T.paint.get("text-opacity").constantOr(1)!==0&&Wa(y,w,T,C,!0,T.paint.get("text-translate"),T.paint.get("text-translate-anchor"),T.layout.get("text-rotation-alignment"),T.layout.get("text-pitch-alignment"),T.layout.get("text-keep-upright"),M,P),w.map.showCollisionBoxes&&(qd(y,w,T,C,!0),qd(y,w,T,C,!1))})(r,a,u,p,this.style.placement.variableOffsets);break;case"circle":(function(y,w,T,C){if(y.renderPass!=="translucent")return;const k=T.paint.get("circle-opacity"),M=T.paint.get("circle-stroke-width"),P=T.paint.get("circle-stroke-opacity"),O=!T.layout.get("circle-sort-key").isConstant();if(k.constantOr(1)===0&&(M.constantOr(1)===0||P.constantOr(1)===0))return;const V=y.context,H=V.gl,J=y.depthModeForSublayer(0,Ct.ReadOnly),W=dr.disabled,te=y.colorModeForRenderPass(),se=[];for(let X=0;X<C.length;X++){const ce=C[X],fe=w.getTile(ce),_e=fe.getBucket(T);if(!_e)continue;const Ce=_e.programConfigurations.get(T.id),Me=y.useProgram("circle",Ce),He=_e.layoutVertexBuffer,We=_e.indexBuffer,ze=y.style.map.terrain&&y.style.map.terrain.getTerrainData(ce),De={programConfiguration:Ce,program:Me,layoutVertexBuffer:He,indexBuffer:We,uniformValues:Jm(y,ce,fe,T),terrainData:ze};if(O){const Je=_e.segments.get();for(const _t of Je)se.push({segments:new d.$([_t]),sortKey:_t.sortKey,state:De})}else se.push({segments:_e.segments,sortKey:0,state:De})}O&&se.sort((X,ce)=>X.sortKey-ce.sortKey);for(const X of se){const{programConfiguration:ce,program:fe,layoutVertexBuffer:_e,indexBuffer:Ce,uniformValues:Me,terrainData:He}=X.state;fe.draw(V,H.TRIANGLES,J,W,te,ur.disabled,Me,He,T.id,_e,Ce,X.segments,T.paint,y.transform.zoom,ce)}})(r,a,u,p);break;case"heatmap":(function(y,w,T,C){if(T.paint.get("heatmap-opacity")!==0)if(y.renderPass==="offscreen"){const k=y.context,M=k.gl,P=dr.disabled,O=new Sr([M.ONE,M.ONE],d.aP.transparent,[!0,!0,!0,!0]);(function(V,H,J){const W=V.gl;V.activeTexture.set(W.TEXTURE1),V.viewport.set([0,0,H.width/4,H.height/4]);let te=J.heatmapFbo;if(te)W.bindTexture(W.TEXTURE_2D,te.colorAttachment.get()),V.bindFramebuffer.set(te.framebuffer);else{const se=W.createTexture();W.bindTexture(W.TEXTURE_2D,se),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_WRAP_S,W.CLAMP_TO_EDGE),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_WRAP_T,W.CLAMP_TO_EDGE),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_MIN_FILTER,W.LINEAR),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_MAG_FILTER,W.LINEAR),te=J.heatmapFbo=V.createFramebuffer(H.width/4,H.height/4,!1,!1),function(X,ce,fe,_e){var Ce,Me;const He=X.gl,We=(Ce=X.HALF_FLOAT)!==null&&Ce!==void 0?Ce:He.UNSIGNED_BYTE,ze=(Me=X.RGBA16F)!==null&&Me!==void 0?Me:He.RGBA;He.texImage2D(He.TEXTURE_2D,0,ze,ce.width/4,ce.height/4,0,He.RGBA,We,null),_e.colorAttachment.set(fe)}(V,H,se,te)}})(k,y,T),k.clear({color:d.aP.transparent});for(let V=0;V<C.length;V++){const H=C[V];if(w.hasRenderableParent(H))continue;const J=w.getTile(H),W=J.getBucket(T);if(!W)continue;const te=W.programConfigurations.get(T.id),se=y.useProgram("heatmap",te),{zoom:X}=y.transform;se.draw(k,M.TRIANGLES,Ct.disabled,P,O,ur.disabled,ps(H.posMatrix,J,X,T.paint.get("heatmap-intensity")),null,T.id,W.layoutVertexBuffer,W.indexBuffer,W.segments,T.paint,y.transform.zoom,te)}k.viewport.set([0,0,y.width,y.height])}else y.renderPass==="translucent"&&(y.context.setColorMode(y.colorModeForRenderPass()),function(k,M){const P=k.context,O=P.gl,V=M.heatmapFbo;if(!V)return;P.activeTexture.set(O.TEXTURE0),O.bindTexture(O.TEXTURE_2D,V.colorAttachment.get()),P.activeTexture.set(O.TEXTURE1);let H=M.colorRampTexture;H||(H=M.colorRampTexture=new st(P,M.colorRamp,O.RGBA)),H.bind(O.LINEAR,O.CLAMP_TO_EDGE),k.useProgram("heatmapTexture").draw(P,O.TRIANGLES,Ct.disabled,dr.disabled,k.colorModeForRenderPass(),ur.disabled,((J,W,te,se)=>{const X=d.F();d.aO(X,0,J.width,J.height,0,0,1);const ce=J.context.gl;return{u_matrix:X,u_world:[ce.drawingBufferWidth,ce.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:W.paint.get("heatmap-opacity")}})(k,M),null,M.id,k.viewportBuffer,k.quadTriangleIndexBuffer,k.viewportSegments,M.paint,k.transform.zoom)}(y,T))})(r,a,u,p);break;case"line":(function(y,w,T,C){if(y.renderPass!=="translucent")return;const k=T.paint.get("line-opacity"),M=T.paint.get("line-width");if(k.constantOr(1)===0||M.constantOr(1)===0)return;const P=y.depthModeForSublayer(0,Ct.ReadOnly),O=y.colorModeForRenderPass(),V=T.paint.get("line-dasharray"),H=T.paint.get("line-pattern"),J=H.constantOr(1),W=T.paint.get("line-gradient"),te=T.getCrossfadeParameters(),se=J?"linePattern":V?"lineSDF":W?"lineGradient":"line",X=y.context,ce=X.gl;let fe=!0;for(const _e of C){const Ce=w.getTile(_e);if(J&&!Ce.patternsLoaded())continue;const Me=Ce.getBucket(T);if(!Me)continue;const He=Me.programConfigurations.get(T.id),We=y.context.program.get(),ze=y.useProgram(se,He),De=fe||ze.program!==We,Je=y.style.map.terrain&&y.style.map.terrain.getTerrainData(_e),_t=H.constantOr(null);if(_t&&Ce.imageAtlas){const dt=Ce.imageAtlas,or=dt.patternPositions[_t.to.toString()],Tt=dt.patternPositions[_t.from.toString()];or&&Tt&&He.setConstantPatternPositions(or,Tt)}const Fe=Je?_e:null,$e=J?xu(y,Ce,T,te,Fe):V?Rl(y,Ce,T,V,te,Fe):W?ni(y,Ce,T,Me.lineClipsArray.length,Fe):En(y,Ce,T,Fe);if(J)X.activeTexture.set(ce.TEXTURE0),Ce.imageAtlasTexture.bind(ce.LINEAR,ce.CLAMP_TO_EDGE),He.updatePaintBuffers(te);else if(V&&(De||y.lineAtlas.dirty))X.activeTexture.set(ce.TEXTURE0),y.lineAtlas.bind(X);else if(W){const dt=Me.gradients[T.id];let or=dt.texture;if(T.gradientVersion!==dt.version){let Tt=256;if(T.stepInterpolant){const kt=w.getSource().maxzoom,sr=_e.canonical.z===kt?Math.ceil(1<<y.transform.maxZoom-_e.canonical.z):1;Tt=d.ac(d.aU(Me.maxLineLength/d.W*1024*sr),256,X.maxTextureSize)}dt.gradient=d.aV({expression:T.gradientExpression(),evaluationKey:"lineProgress",resolution:Tt,image:dt.gradient||void 0,clips:Me.lineClipsArray}),dt.texture?dt.texture.update(dt.gradient):dt.texture=new st(X,dt.gradient,ce.RGBA),dt.version=T.gradientVersion,or=dt.texture}X.activeTexture.set(ce.TEXTURE0),or.bind(T.stepInterpolant?ce.NEAREST:ce.LINEAR,ce.CLAMP_TO_EDGE)}ze.draw(X,ce.TRIANGLES,P,y.stencilModeForClipping(_e),O,ur.disabled,$e,Je,T.id,Me.layoutVertexBuffer,Me.indexBuffer,Me.segments,T.paint,y.transform.zoom,He,Me.layoutVertexBuffer2),fe=!1}})(r,a,u,p);break;case"fill":(function(y,w,T,C){const k=T.paint.get("fill-color"),M=T.paint.get("fill-opacity");if(M.constantOr(1)===0)return;const P=y.colorModeForRenderPass(),O=T.paint.get("fill-pattern"),V=y.opaquePassEnabledForLayer()&&!O.constantOr(1)&&k.constantOr(d.aP.transparent).a===1&&M.constantOr(0)===1?"opaque":"translucent";if(y.renderPass===V){const H=y.depthModeForSublayer(1,y.renderPass==="opaque"?Ct.ReadWrite:Ct.ReadOnly);ms(y,w,T,C,H,P,!1)}if(y.renderPass==="translucent"&&T.paint.get("fill-antialias")){const H=y.depthModeForSublayer(T.getPaintProperty("fill-outline-color")?2:0,Ct.ReadOnly);ms(y,w,T,C,H,P,!0)}})(r,a,u,p);break;case"fill-extrusion":(function(y,w,T,C){const k=T.paint.get("fill-extrusion-opacity");if(k!==0&&y.renderPass==="translucent"){const M=new Ct(y.context.gl.LEQUAL,Ct.ReadWrite,y.depthRangeFor3D);if(k!==1||T.paint.get("fill-extrusion-pattern").constantOr(1))jn(y,w,T,C,M,dr.disabled,Sr.disabled),jn(y,w,T,C,M,y.stencilModeFor3D(),y.colorModeForRenderPass());else{const P=y.colorModeForRenderPass();jn(y,w,T,C,M,dr.disabled,P)}}})(r,a,u,p);break;case"hillshade":(function(y,w,T,C){if(y.renderPass!=="offscreen"&&y.renderPass!=="translucent")return;const k=y.context,M=y.depthModeForSublayer(0,Ct.ReadOnly),P=y.colorModeForRenderPass(),[O,V]=y.renderPass==="translucent"?y.stencilConfigForOverlap(C):[{},C];for(const H of V){const J=w.getTile(H);J.needsHillshadePrepare!==void 0&&J.needsHillshadePrepare&&y.renderPass==="offscreen"?Gd(y,J,T,M,dr.disabled,P):y.renderPass==="translucent"&&Wd(y,H,J,T,M,O[H.overscaledZ],P)}k.viewport.set([0,0,y.width,y.height])})(r,a,u,p);break;case"raster":(function(y,w,T,C){if(y.renderPass!=="translucent"||T.paint.get("raster-opacity")===0||!C.length)return;const k=y.context,M=k.gl,P=w.getSource(),O=y.useProgram("raster"),V=y.colorModeForRenderPass(),[H,J]=P instanceof ei?[{},C]:y.stencilConfigForOverlap(C),W=J[J.length-1].overscaledZ,te=!y.options.moving;for(const se of J){const X=y.depthModeForSublayer(se.overscaledZ-W,T.paint.get("raster-opacity")===1?Ct.ReadWrite:Ct.ReadOnly,M.LESS),ce=w.getTile(se);ce.registerFadeDuration(T.paint.get("raster-fade-duration"));const fe=w.findLoadedParent(se,0),_e=w.findLoadedSibling(se),Ce=Lu(ce,fe||_e||null,w,T,y.transform,y.style.map.terrain);let Me,He;const We=T.paint.get("raster-resampling")==="nearest"?M.NEAREST:M.LINEAR;k.activeTexture.set(M.TEXTURE0),ce.texture.bind(We,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST),k.activeTexture.set(M.TEXTURE1),fe?(fe.texture.bind(We,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST),Me=Math.pow(2,fe.tileID.overscaledZ-ce.tileID.overscaledZ),He=[ce.tileID.canonical.x*Me%1,ce.tileID.canonical.y*Me%1]):ce.texture.bind(We,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST);const ze=y.style.map.terrain&&y.style.map.terrain.getTerrainData(se),De=ze?se:null,Je=De?De.posMatrix:y.transform.calculatePosMatrix(se.toUnwrapped(),te),_t=qs(Je,He||[0,0],Me||1,Ce,T);P instanceof ei?O.draw(k,M.TRIANGLES,X,dr.disabled,V,ur.disabled,_t,ze,T.id,P.boundsBuffer,y.quadTriangleIndexBuffer,P.boundsSegments):O.draw(k,M.TRIANGLES,X,H[se.overscaledZ],V,ur.disabled,_t,ze,T.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments)}})(r,a,u,p);break;case"background":(function(y,w,T,C){const k=T.paint.get("background-color"),M=T.paint.get("background-opacity");if(M===0)return;const P=y.context,O=P.gl,V=y.transform,H=V.tileSize,J=T.paint.get("background-pattern");if(y.isPatternMissing(J))return;const W=!J&&k.a===1&&M===1&&y.opaquePassEnabledForLayer()?"opaque":"translucent";if(y.renderPass!==W)return;const te=dr.disabled,se=y.depthModeForSublayer(0,W==="opaque"?Ct.ReadWrite:Ct.ReadOnly),X=y.colorModeForRenderPass(),ce=y.useProgram(J?"backgroundPattern":"background"),fe=C||V.coveringTiles({tileSize:H,terrain:y.style.map.terrain});J&&(P.activeTexture.set(O.TEXTURE0),y.imageManager.bind(y.context));const _e=T.getCrossfadeParameters();for(const Ce of fe){const Me=C?Ce.posMatrix:y.transform.calculatePosMatrix(Ce.toUnwrapped()),He=J?ng(Me,M,y,J,{tileID:Ce,tileSize:H},_e):rg(Me,M,k),We=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Ce);ce.draw(P,O.TRIANGLES,se,te,X,ur.disabled,He,We,T.id,y.tileExtentBuffer,y.quadTriangleIndexBuffer,y.tileExtentSegments)}})(r,0,u,p);break;case"custom":(function(y,w,T){const C=y.context,k=T.implementation;if(y.renderPass==="offscreen"){const M=k.prerender;M&&(y.setCustomLayerDefaults(),C.setColorMode(y.colorModeForRenderPass()),M.call(k,C.gl,y.transform.customLayerMatrix()),C.setDirty(),y.setBaseState())}else if(y.renderPass==="translucent"){y.setCustomLayerDefaults(),C.setColorMode(y.colorModeForRenderPass()),C.setStencilMode(dr.disabled);const M=k.renderingMode==="3d"?new Ct(y.context.gl.LEQUAL,Ct.ReadWrite,y.depthRangeFor3D):y.depthModeForSublayer(0,Ct.ReadOnly);C.setDepthMode(M),k.render(C.gl,y.transform.customLayerMatrix()),C.setDirty(),y.setBaseState(),C.bindFramebuffer.set(null)}})(r,0,u)}}translatePosMatrix(r,a,u,p,y){if(!u[0]&&!u[1])return r;const w=y?p==="map"?this.transform.angle:0:p==="viewport"?-this.transform.angle:0;if(w){const k=Math.sin(w),M=Math.cos(w);u=[u[0]*M-u[1]*k,u[0]*k+u[1]*M]}const T=[y?u[0]:yt(a,u[0],this.transform.zoom),y?u[1]:yt(a,u[1],this.transform.zoom),0],C=new Float32Array(16);return d.H(C,r,T),C}saveTileTexture(r){const a=this._tileTextures[r.size[0]];a?a.push(r):this._tileTextures[r.size[0]]=[r]}getTileTexture(r){const a=this._tileTextures[r];return a&&a.length>0?a.pop():null}isPatternMissing(r){if(!r)return!1;if(!r.from||!r.to)return!0;const a=this.imageManager.getPattern(r.from.toString()),u=this.imageManager.getPattern(r.to.toString());return!a||!u}useProgram(r,a){this.cache=this.cache||{};const u=r+(a?a.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[u]||(this.cache[u]=new yu(this.context,js[r],a,Dl[r],this._showOverdrawInspector,this.style.map.terrain)),this.cache[u]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new st(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:r,drawingBufferHeight:a}=this.context.gl;return this.width!==r||this.height!==a}}class Gs{constructor(r,a){this.points=r,this.planes=a}static fromInvProjectionMatrix(r,a,u){const p=Math.pow(2,u),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(T=>{const C=1/(T=d.af([],T,r))[3]/a*p;return d.b0(T,T,[C,C,1/T[3],C])}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(T=>{const C=function(O,V){var H=V[0],J=V[1],W=V[2],te=H*H+J*J+W*W;return te>0&&(te=1/Math.sqrt(te)),O[0]=V[0]*te,O[1]=V[1]*te,O[2]=V[2]*te,O}([],function(O,V,H){var J=V[0],W=V[1],te=V[2],se=H[0],X=H[1],ce=H[2];return O[0]=W*ce-te*X,O[1]=te*se-J*ce,O[2]=J*X-W*se,O}([],Ae([],y[T[0]],y[T[1]]),Ae([],y[T[2]],y[T[1]]))),k=-((M=C)[0]*(P=y[T[1]])[0]+M[1]*P[1]+M[2]*P[2]);var M,P;return C.concat(k)});return new Gs(y,w)}}class Gl{constructor(r,a){this.min=r,this.max=a,this.center=function(u,p,y){return u[0]=.5*p[0],u[1]=.5*p[1],u[2]=.5*p[2],u}([],function(u,p,y){return u[0]=p[0]+y[0],u[1]=p[1]+y[1],u[2]=p[2]+y[2],u}([],this.min,this.max))}quadrant(r){const a=[r%2==0,r<2],u=Ee(this.min),p=Ee(this.max);for(let y=0;y<a.length;y++)u[y]=a[y]?this.min[y]:this.center[y],p[y]=a[y]?this.center[y]:this.max[y];return p[2]=this.max[2],new Gl(u,p)}distanceX(r){return Math.max(Math.min(this.max[0],r[0]),this.min[0])-r[0]}distanceY(r){return Math.max(Math.min(this.max[1],r[1]),this.min[1])-r[1]}intersects(r){const a=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let u=!0;for(let p=0;p<r.planes.length;p++){const y=r.planes[p];let w=0;for(let T=0;T<a.length;T++)d.b1(y,a[T])>=0&&w++;if(w===0)return 0;w!==a.length&&(u=!1)}if(u)return 2;for(let p=0;p<3;p++){let y=Number.MAX_VALUE,w=-Number.MAX_VALUE;for(let T=0;T<r.points.length;T++){const C=r.points[T][p]-this.min[p];y=Math.min(y,C),w=Math.max(w,C)}if(w<0||y>this.max[p]-this.min[p])return 0}return 1}}class Za{constructor(r=0,a=0,u=0,p=0){if(isNaN(r)||r<0||isNaN(a)||a<0||isNaN(u)||u<0||isNaN(p)||p<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=a,this.left=u,this.right=p}interpolate(r,a,u){return a.top!=null&&r.top!=null&&(this.top=d.z.number(r.top,a.top,u)),a.bottom!=null&&r.bottom!=null&&(this.bottom=d.z.number(r.bottom,a.bottom,u)),a.left!=null&&r.left!=null&&(this.left=d.z.number(r.left,a.left,u)),a.right!=null&&r.right!=null&&(this.right=d.z.number(r.right,a.right,u)),this}getCenter(r,a){const u=d.ac((this.left+r-this.right)/2,0,r),p=d.ac((this.top+a-this.bottom)/2,0,a);return new d.P(u,p)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new Za(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Zs=85.051129;class Du{constructor(r,a,u,p,y){this.tileSize=512,this._renderWorldCopies=y===void 0||!!y,this._minZoom=r||0,this._maxZoom=a||22,this._minPitch=u??0,this._maxPitch=p??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new d.M(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Za,this._posMatrixCache={},this._alignedPosMatrixCache={},this.minElevationForCurrentTile=0}clone(){const r=new Du(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return r.apply(this),r}apply(r){this.tileSize=r.tileSize,this.latRange=r.latRange,this.width=r.width,this.height=r.height,this._center=r._center,this._elevation=r._elevation,this.minElevationForCurrentTile=r.minElevationForCurrentTile,this.zoom=r.zoom,this.angle=r.angle,this._fov=r._fov,this._pitch=r._pitch,this._unmodified=r._unmodified,this._edgeInsets=r._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}get maxZoom(){return this._maxZoom}set maxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}get minPitch(){return this._minPitch}set minPitch(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))}get maxPitch(){return this._maxPitch}set maxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new d.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(r){const a=-d.b2(r,-180,180)*Math.PI/180;this.angle!==a&&(this._unmodified=!1,this.angle=a,this._calcMatrices(),this.rotationMatrix=function(){var u=new d.A(4);return d.A!=Float32Array&&(u[1]=0,u[2]=0),u[0]=1,u[3]=1,u}(),function(u,p,y){var w=p[0],T=p[1],C=p[2],k=p[3],M=Math.sin(y),P=Math.cos(y);u[0]=w*P+C*M,u[1]=T*P+k*M,u[2]=w*-M+C*P,u[3]=T*-M+k*P}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(r){const a=d.ac(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==a&&(this._unmodified=!1,this._pitch=a,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=r/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(r){const a=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this.tileZoom=Math.max(0,Math.floor(a)),this.scale=this.zoomScale(a),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(r){r!==this._elevation&&(this._elevation=r,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,a,u){this._unmodified=!1,this._edgeInsets.interpolate(r,a,u),this._constrain(),this._calcMatrices()}coveringZoomLevel(r){const a=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,a)}getVisibleUnwrappedCoordinates(r){const a=[new d.b3(0,r)];if(this._renderWorldCopies){const u=this.pointCoordinate(new d.P(0,0)),p=this.pointCoordinate(new d.P(this.width,0)),y=this.pointCoordinate(new d.P(this.width,this.height)),w=this.pointCoordinate(new d.P(0,this.height)),T=Math.floor(Math.min(u.x,p.x,y.x,w.x)),C=Math.floor(Math.max(u.x,p.x,y.x,w.x)),k=1;for(let M=T-k;M<=C+k;M++)M!==0&&a.push(new d.b3(M,r))}return a}coveringTiles(r){var a,u;let p=this.coveringZoomLevel(r);const y=p;if(r.minzoom!==void 0&&p<r.minzoom)return[];r.maxzoom!==void 0&&p>r.maxzoom&&(p=r.maxzoom);const w=this.pointCoordinate(this.getCameraPoint()),T=d.Y.fromLngLat(this.center),C=Math.pow(2,p),k=[C*w.x,C*w.y,0],M=[C*T.x,C*T.y,0],P=Gs.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,p);let O=r.minzoom||0;!r.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(O=p);const V=r.terrain?2/Math.min(this.tileSize,r.tileSize)*this.tileSize:3,H=X=>({aabb:new Gl([X*C,0,0],[(X+1)*C,C,0]),zoom:0,x:0,y:0,wrap:X,fullyVisible:!1}),J=[],W=[],te=p,se=r.reparseOverscaled?y:p;if(this._renderWorldCopies)for(let X=1;X<=3;X++)J.push(H(-X)),J.push(H(X));for(J.push(H(0));J.length>0;){const X=J.pop(),ce=X.x,fe=X.y;let _e=X.fullyVisible;if(!_e){const ze=X.aabb.intersects(P);if(ze===0)continue;_e=ze===2}const Ce=r.terrain?k:M,Me=X.aabb.distanceX(Ce),He=X.aabb.distanceY(Ce),We=Math.max(Math.abs(Me),Math.abs(He));if(X.zoom===te||We>V+(1<<te-X.zoom)-2&&X.zoom>=O){const ze=te-X.zoom,De=k[0]-.5-(ce<<ze),Je=k[1]-.5-(fe<<ze);W.push({tileID:new d.Q(X.zoom===te?se:X.zoom,X.wrap,X.zoom,ce,fe),distanceSq:Ke([M[0]-.5-ce,M[1]-.5-fe]),tileDistanceToCamera:Math.sqrt(De*De+Je*Je)})}else for(let ze=0;ze<4;ze++){const De=(ce<<1)+ze%2,Je=(fe<<1)+(ze>>1),_t=X.zoom+1;let Fe=X.aabb.quadrant(ze);if(r.terrain){const $e=new d.Q(_t,X.wrap,_t,De,Je),dt=r.terrain.getMinMaxElevation($e),or=(a=dt.minElevation)!==null&&a!==void 0?a:this.elevation,Tt=(u=dt.maxElevation)!==null&&u!==void 0?u:this.elevation;Fe=new Gl([Fe.min[0],Fe.min[1],or],[Fe.max[0],Fe.max[1],Tt])}J.push({aabb:Fe,zoom:_t,x:De,y:Je,wrap:X.wrap,fullyVisible:_e})}}return W.sort((X,ce)=>X.distanceSq-ce.distanceSq).map(X=>X.tileID)}resize(r,a){this.width=r,this.height=a,this.pixelsToGLUnits=[2/r,-2/a],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(r){return Math.pow(2,r)}scaleZoom(r){return Math.log(r)/Math.LN2}project(r){const a=d.ac(r.lat,-85.051129,Zs);return new d.P(d.N(r.lng)*this.worldSize,d.O(a)*this.worldSize)}unproject(r){return new d.Y(r.x/this.worldSize,r.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(r){const a=this.elevation,u=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,p=this.pointLocation(this.centerPoint,r),y=r.getElevationForLngLatZoom(p,this.tileZoom);if(!(this.elevation-y))return;const w=u+a-y,T=Math.cos(this._pitch)*this.cameraToCenterDistance/w/d.b4(1,p.lat),C=this.scaleZoom(T/this.tileSize);this._elevation=y,this._center=p,this.zoom=C}setLocationAtPoint(r,a){const u=this.pointCoordinate(a),p=this.pointCoordinate(this.centerPoint),y=this.locationCoordinate(r),w=new d.Y(y.x-(u.x-p.x),y.y-(u.y-p.y));this.center=this.coordinateLocation(w),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(r,a){return a?this.coordinatePoint(this.locationCoordinate(r),a.getElevationForLngLatZoom(r,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(r))}pointLocation(r,a){return this.coordinateLocation(this.pointCoordinate(r,a))}locationCoordinate(r){return d.Y.fromLngLat(r)}coordinateLocation(r){return r&&r.toLngLat()}pointCoordinate(r,a){if(a){const O=a.pointCoordinate(r);if(O!=null)return O}const u=[r.x,r.y,0,1],p=[r.x,r.y,1,1];d.af(u,u,this.pixelMatrixInverse),d.af(p,p,this.pixelMatrixInverse);const y=u[3],w=p[3],T=u[1]/y,C=p[1]/w,k=u[2]/y,M=p[2]/w,P=k===M?0:(0-k)/(M-k);return new d.Y(d.z.number(u[0]/y,p[0]/w,P)/this.worldSize,d.z.number(T,C,P)/this.worldSize)}coordinatePoint(r,a=0,u=this.pixelMatrix){const p=[r.x*this.worldSize,r.y*this.worldSize,a,1];return d.af(p,p,u),new d.P(p[0]/p[3],p[1]/p[3])}getBounds(){const r=Math.max(0,this.height/2-this.getHorizon());return new br().extend(this.pointLocation(new d.P(0,r))).extend(this.pointLocation(new d.P(this.width,r))).extend(this.pointLocation(new d.P(this.width,this.height))).extend(this.pointLocation(new d.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new br([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(r){r?(this.lngRange=[r.getWest(),r.getEast()],this.latRange=[r.getSouth(),r.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,Zs])}calculatePosMatrix(r,a=!1){const u=r.key,p=a?this._alignedPosMatrixCache:this._posMatrixCache;if(p[u])return p[u];const y=r.canonical,w=this.worldSize/this.zoomScale(y.z),T=y.x+Math.pow(2,y.z)*r.wrap,C=d.an(new Float64Array(16));return d.H(C,C,[T*w,y.y*w,0]),d.J(C,C,[w/d.W,w/d.W,1]),d.K(C,a?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,C),p[u]=new Float32Array(C),p[u]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(r,a){a=d.ac(+a,this.minZoom,this.maxZoom);const u={center:new d.M(r.lng,r.lat),zoom:a};let p=this.lngRange;if(!this._renderWorldCopies&&p===null){const X=179.9999999999;p=[-X,X]}const y=this.tileSize*this.zoomScale(u.zoom);let w=0,T=y,C=0,k=y,M=0,P=0;const{x:O,y:V}=this.size;if(this.latRange){const X=this.latRange;w=d.O(X[1])*y,T=d.O(X[0])*y,T-w<V&&(M=V/(T-w))}p&&(C=d.b2(d.N(p[0])*y,0,y),k=d.b2(d.N(p[1])*y,0,y),k<C&&(k+=y),k-C<O&&(P=O/(k-C)));const{x:H,y:J}=this.project.call({worldSize:y},r);let W,te;const se=Math.max(P||0,M||0);if(se){const X=new d.P(P?(k+C)/2:H,M?(T+w)/2:J);return u.center=this.unproject.call({worldSize:y},X).wrap(),u.zoom+=this.scaleZoom(se),u}if(this.latRange){const X=V/2;J-X<w&&(te=w+X),J+X>T&&(te=T-X)}if(p){const X=(C+k)/2;let ce=H;this._renderWorldCopies&&(ce=d.b2(H,X-y/2,X+y/2));const fe=O/2;ce-fe<C&&(W=C+fe),ce+fe>k&&(W=k-fe)}if(W!==void 0||te!==void 0){const X=new d.P(W??H,te??J);u.center=this.unproject.call({worldSize:y},X).wrap()}return u}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const r=this._unmodified,{center:a,zoom:u}=this.getConstrained(this.center,this.zoom);this.center=a,this.zoom=u,this._unmodified=r,this._constraining=!1}_calcMatrices(){if(!this.height)return;const r=this.centerOffset,a=this.point.x,u=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=d.b4(1,this.center.lat)*this.worldSize;let p=d.an(new Float64Array(16));d.J(p,p,[this.width/2,-this.height/2,1]),d.H(p,p,[1,-1,0]),this.labelPlaneMatrix=p,p=d.an(new Float64Array(16)),d.J(p,p,[1,-1,1]),d.H(p,p,[-1,-1,0]),d.J(p,p,[2/this.width,2/this.height,1]),this.glCoordMatrix=p;const y=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),w=Math.min(this.elevation,this.minElevationForCurrentTile),T=y-w*this._pixelPerMeter/Math.cos(this._pitch),C=w<0?T:y,k=Math.PI/2+this._pitch,M=this._fov*(.5+r.y/this.height),P=Math.sin(M)*C/Math.sin(d.ac(Math.PI-k-M,.01,Math.PI-.01)),O=this.getHorizon(),V=2*Math.atan(O/this.cameraToCenterDistance)*(.5+r.y/(2*O)),H=Math.sin(V)*C/Math.sin(d.ac(Math.PI-k-V,.01,Math.PI-.01)),J=Math.min(P,H),W=1.01*(Math.cos(Math.PI/2-this._pitch)*J+C),te=this.height/50;p=new Float64Array(16),d.b5(p,this._fov,this.width/this.height,te,W),p[8]=2*-r.x/this.width,p[9]=2*r.y/this.height,d.J(p,p,[1,-1,1]),d.H(p,p,[0,0,-this.cameraToCenterDistance]),d.b6(p,p,this._pitch),d.ad(p,p,this.angle),d.H(p,p,[-a,-u,0]),this.mercatorMatrix=d.J([],p,[this.worldSize,this.worldSize,this.worldSize]),d.J(p,p,[1,1,this._pixelPerMeter]),this.pixelMatrix=d.K(new Float64Array(16),this.labelPlaneMatrix,p),d.H(p,p,[0,0,-this.elevation]),this.modelViewProjectionMatrix=p,this.invModelViewProjectionMatrix=d.as([],p),this.pixelMatrix3D=d.K(new Float64Array(16),this.labelPlaneMatrix,p);const se=this.width%2/2,X=this.height%2/2,ce=Math.cos(this.angle),fe=Math.sin(this.angle),_e=a-Math.round(a)+ce*se+fe*X,Ce=u-Math.round(u)+ce*X+fe*se,Me=new Float64Array(p);if(d.H(Me,Me,[_e>.5?_e-1:_e,Ce>.5?Ce-1:Ce,0]),this.alignedModelViewProjectionMatrix=Me,p=d.as(new Float64Array(16),this.pixelMatrix),!p)throw new Error("failed to invert matrix");this.pixelMatrixInverse=p,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const r=this.pointCoordinate(new d.P(0,0)),a=[r.x*this.worldSize,r.y*this.worldSize,0,1];return d.af(a,a,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new d.P(0,r))}getCameraQueryGeometry(r){const a=this.getCameraPoint();if(r.length===1)return[r[0],a];{let u=a.x,p=a.y,y=a.x,w=a.y;for(const T of r)u=Math.min(u,T.x),p=Math.min(p,T.y),y=Math.max(y,T.x),w=Math.max(w,T.y);return[new d.P(u,p),new d.P(y,p),new d.P(y,w),new d.P(u,w),new d.P(u,p)]}}lngLatToCameraDepth(r,a){const u=this.locationCoordinate(r),p=[u.x*this.worldSize,u.y*this.worldSize,a,1];return d.af(p,p,this.modelViewProjectionMatrix),p[2]/p[3]}}function Kd(g,r){let a,u=!1,p=null,y=null;const w=()=>{p=null,u&&(g.apply(y,a),p=setTimeout(w,r),u=!1)};return(...T)=>(u=!0,y=this,a=T,p||w(),p)}class Bu{constructor(r){this._getCurrentHash=()=>{const a=window.location.hash.replace("#","");if(this._hashName){let u;return a.split("&").map(p=>p.split("=")).forEach(p=>{p[0]===this._hashName&&(u=p)}),(u&&u[1]||"").split("/")}return a.split("/")},this._onHashChange=()=>{const a=this._getCurrentHash();if(a.length>=3&&!a.some(u=>isNaN(u))){const u=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(a[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:u,pitch:+(a[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const a=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,a)}catch{}},this._updateHash=Kd(this._updateHashUnthrottled,300),this._hashName=r&&encodeURIComponent(r)}addTo(r){return this._map=r,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(r){const a=this._map.getCenter(),u=Math.round(100*this._map.getZoom())/100,p=Math.ceil((u*Math.LN2+Math.log(512/360/.5))/Math.LN10),y=Math.pow(10,p),w=Math.round(a.lng*y)/y,T=Math.round(a.lat*y)/y,C=this._map.getBearing(),k=this._map.getPitch();let M="";if(M+=r?`/${w}/${T}/${u}`:`${u}/${T}/${w}`,(C||k)&&(M+="/"+Math.round(10*C)/10),k&&(M+=`/${Math.round(k)}`),this._hashName){const P=this._hashName;let O=!1;const V=window.location.hash.slice(1).split("&").map(H=>{const J=H.split("=")[0];return J===P?(O=!0,`${J}=${M}`):H}).filter(H=>H);return O||V.push(`${P}=${M}`),`#${V.join("&")}`}return`#${M}`}}const Zl={linearity:.3,easing:d.b7(0,0,.3,1)},Fu=d.e({deceleration:2500,maxSpeed:1400},Zl),Kl=d.e({deceleration:20,maxSpeed:1400},Zl),Xl=d.e({deceleration:1e3,maxSpeed:360},Zl),Ou=d.e({deceleration:1e3,maxSpeed:90},Zl);class Nu{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:j.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,a=j.now();for(;r.length>0&&a-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const a={zoom:0,bearing:0,pitch:0,pan:new d.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:y}of this._inertiaBuffer)a.zoom+=y.zoomDelta||0,a.bearing+=y.bearingDelta||0,a.pitch+=y.pitchDelta||0,y.panDelta&&a.pan._add(y.panDelta),y.around&&(a.around=y.around),y.pinchAround&&(a.pinchAround=y.pinchAround);const u=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,p={};if(a.pan.mag()){const y=_s(a.pan.mag(),u,d.e({},Fu,r||{}));p.offset=a.pan.mult(y.amount/a.pan.mag()),p.center=this._map.transform.center,Ka(p,y)}if(a.zoom){const y=_s(a.zoom,u,Kl);p.zoom=this._map.transform.zoom+y.amount,Ka(p,y)}if(a.bearing){const y=_s(a.bearing,u,Xl);p.bearing=this._map.transform.bearing+d.ac(y.amount,-179,179),Ka(p,y)}if(a.pitch){const y=_s(a.pitch,u,Ou);p.pitch=this._map.transform.pitch+y.amount,Ka(p,y)}if(p.zoom||p.bearing){const y=a.pinchAround===void 0?a.around:a.pinchAround;p.around=y?this._map.unproject(y):this._map.getCenter()}return this.clear(),d.e(p,{noMoveStart:!0})}}function Ka(g,r){(!g.duration||g.duration<r.duration)&&(g.duration=r.duration,g.easing=r.easing)}function _s(g,r,a){const{maxSpeed:u,linearity:p,deceleration:y}=a,w=d.ac(g*p/(r/1e3),-u,u),T=Math.abs(w)/(y*p);return{easing:a.easing,duration:1e3*T,amount:w*(T/2)}}class hn extends d.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,a,u,p={}){const y=F.mousePos(a.getCanvas(),u),w=a.unproject(y);super(r,d.e({point:y,lngLat:w,originalEvent:u},p)),this._defaultPrevented=!1,this.target=a}}class vs extends d.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,a,u){const p=r==="touchend"?u.changedTouches:u.touches,y=F.touchPos(a.getCanvasContainer(),p),w=y.map(C=>a.unproject(C)),T=y.reduce((C,k,M,P)=>C.add(k.div(P.length)),new d.P(0,0));super(r,{points:y,point:T,lngLats:w,lngLat:a.unproject(T),originalEvent:u}),this._defaultPrevented=!1}}class Xd extends d.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,a,u){super(r,{originalEvent:u}),this._defaultPrevented=!1}}class $u{constructor(r,a){this._map=r,this._clickTolerance=a.clickTolerance}reset(){delete this._mousedownPos}wheel(r){return this._firePreventable(new Xd(r.type,this._map,r))}mousedown(r,a){return this._mousedownPos=a,this._firePreventable(new hn(r.type,this._map,r))}mouseup(r){this._map.fire(new hn(r.type,this._map,r))}click(r,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new hn(r.type,this._map,r))}dblclick(r){return this._firePreventable(new hn(r.type,this._map,r))}mouseover(r){this._map.fire(new hn(r.type,this._map,r))}mouseout(r){this._map.fire(new hn(r.type,this._map,r))}touchstart(r){return this._firePreventable(new vs(r.type,this._map,r))}touchmove(r){this._map.fire(new vs(r.type,this._map,r))}touchend(r){this._map.fire(new vs(r.type,this._map,r))}touchcancel(r){this._map.fire(new vs(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class fg{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(r){this._map.fire(new hn(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new hn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._ignoreContextMenu||this._map.fire(new hn(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ks{constructor(r){this._map=r}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(r){return this.transform.pointLocation(d.P.convert(r),this._map.terrain)}}class Xa{constructor(r,a){this._map=r,this._tr=new Ks(r),this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=a.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,a){this.isEnabled()&&r.shiftKey&&r.button===0&&(F.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)}mousemoveWindow(r,a){if(!this._active)return;const u=a;if(this._lastPos.equals(u)||!this._box&&u.dist(this._startPos)<this._clickTolerance)return;const p=this._startPos;this._lastPos=u,this._box||(this._box=F.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",r));const y=Math.min(p.x,u.x),w=Math.max(p.x,u.x),T=Math.min(p.y,u.y),C=Math.max(p.y,u.y);F.setTransform(this._box,`translate(${y}px,${T}px)`),this._box.style.width=w-y+"px",this._box.style.height=C-T+"px"}mouseupWindow(r,a){if(!this._active||r.button!==0)return;const u=this._startPos,p=a;if(this.reset(),F.suppressClick(),u.x!==p.x||u.y!==p.y)return this._map.fire(new d.k("boxzoomend",{originalEvent:r})),{cameraAnimation:y=>y.fitScreenCoordinates(u,p,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",r)}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(F.remove(this._box),this._box=null),F.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(r,a){return this._map.fire(new d.k(r,{originalEvent:a}))}}function Ya(g,r){if(g.length!==r.length)throw new Error(`The number of touches and points are not equal - touches ${g.length}, points ${r.length}`);const a={};for(let u=0;u<g.length;u++)a[g[u].identifier]=r[u];return a}class Yd{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(r,a,u){(this.centroid||u.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=r.timeStamp),u.length===this.numTouches&&(this.centroid=function(p){const y=new d.P(0,0);for(const w of p)y._add(w);return y.div(p.length)}(a),this.touches=Ya(u,a)))}touchmove(r,a,u){if(this.aborted||!this.centroid)return;const p=Ya(u,a);for(const y in this.touches){const w=p[y];(!w||w.dist(this.touches[y])>30)&&(this.aborted=!0)}}touchend(r,a,u){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),u.length===0){const p=!this.aborted&&this.centroid;if(this.reset(),p)return p}}}class Yl{constructor(r){this.singleTap=new Yd(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(r,a,u){this.singleTap.touchstart(r,a,u)}touchmove(r,a,u){this.singleTap.touchmove(r,a,u)}touchend(r,a,u){const p=this.singleTap.touchend(r,a,u);if(p){const y=r.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(p)<30;if(y&&w||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=p,this.count===this.numTaps)return this.reset(),p}}}class Jl{constructor(r){this._tr=new Ks(r),this._zoomIn=new Yl({numTouches:1,numTaps:2}),this._zoomOut=new Yl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,a,u){this._zoomIn.touchstart(r,a,u),this._zoomOut.touchstart(r,a,u)}touchmove(r,a,u){this._zoomIn.touchmove(r,a,u),this._zoomOut.touchmove(r,a,u)}touchend(r,a,u){const p=this._zoomIn.touchend(r,a,u),y=this._zoomOut.touchend(r,a,u),w=this._tr;return p?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:w.zoom+1,around:w.unproject(p)},{originalEvent:r})}):y?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:w.zoom-1,around:w.unproject(y)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class xs{constructor(r){this._enabled=!!r.enable,this._moveStateManager=r.moveStateManager,this._clickTolerance=r.clickTolerance||1,this._moveFunction=r.move,this._activateOnStart=!!r.activateOnStart,r.assignEvents(this),this.reset()}reset(r){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(r)}_move(...r){const a=this._moveFunction(...r);if(a.bearingDelta||a.pitchDelta||a.around||a.panDelta)return this._active=!0,a}dragStart(r,a){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(r)&&(this._moveStateManager.startMove(r),this._lastPoint=a.length?a[0]:a,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(r,a){if(!this.isEnabled())return;const u=this._lastPoint;if(!u)return;if(r.preventDefault(),!this._moveStateManager.isValidMoveEvent(r))return void this.reset(r);const p=a.length?a[0]:a;return!this._moved&&p.dist(u)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=p,this._move(u,p))}dragEnd(r){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(r)&&(this._moved&&F.suppressClick(),this.reset(r))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const mg={0:1,2:2};class Ql{constructor(r){this._correctEvent=r.checkCorrectEvent}startMove(r){const a=F.mouseButton(r);this._eventButton=a}endMove(r){delete this._eventButton}isValidStartEvent(r){return this._correctEvent(r)}isValidMoveEvent(r){return!function(a,u){const p=mg[u];return a.buttons===void 0||(a.buttons&p)!==p}(r,this._eventButton)}isValidEndEvent(r){return F.mouseButton(r)===this._eventButton}}class mr{constructor(){this._firstTouch=void 0}_isOneFingerTouch(r){return r.targetTouches.length===1}_isSameTouchEvent(r){return r.targetTouches[0].identifier===this._firstTouch}startMove(r){this._firstTouch=r.targetTouches[0].identifier}endMove(r){delete this._firstTouch}isValidStartEvent(r){return this._isOneFingerTouch(r)}isValidMoveEvent(r){return this._isOneFingerTouch(r)&&this._isSameTouchEvent(r)}isValidEndEvent(r){return this._isOneFingerTouch(r)&&this._isSameTouchEvent(r)}}const So=g=>{g.mousedown=g.dragStart,g.mousemoveWindow=g.dragMove,g.mouseup=g.dragEnd,g.contextmenu=r=>{r.preventDefault()}},oi=({enable:g,clickTolerance:r,bearingDegreesPerPixelMoved:a=.8})=>{const u=new Ql({checkCorrectEvent:p=>F.mouseButton(p)===0&&p.ctrlKey||F.mouseButton(p)===2});return new xs({clickTolerance:r,move:(p,y)=>({bearingDelta:(y.x-p.x)*a}),moveStateManager:u,enable:g,assignEvents:So})},ec=({enable:g,clickTolerance:r,pitchDegreesPerPixelMoved:a=-.5})=>{const u=new Ql({checkCorrectEvent:p=>F.mouseButton(p)===0&&p.ctrlKey||F.mouseButton(p)===2});return new xs({clickTolerance:r,move:(p,y)=>({pitchDelta:(y.y-p.y)*a}),moveStateManager:u,enable:g,assignEvents:So})};class Uu{constructor(r,a){this._clickTolerance=r.clickTolerance||1,this._map=a,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new d.P(0,0)}minTouchs(){return this._map.cooperativeGestures.isEnabled()?2:1}touchstart(r,a,u){return this._calculateTransform(r,a,u)}touchmove(r,a,u){if(this._active&&!(u.length<this.minTouchs()))return r.preventDefault(),this._calculateTransform(r,a,u)}touchend(r,a,u){this._calculateTransform(r,a,u),this._active&&u.length<this.minTouchs()&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,a,u){u.length>0&&(this._active=!0);const p=Ya(u,a),y=new d.P(0,0),w=new d.P(0,0);let T=0;for(const k in p){const M=p[k],P=this._touches[k];P&&(y._add(M),w._add(M.sub(P)),T++,p[k]=M)}if(this._touches=p,T<this.minTouchs()||!w.mag())return;const C=w.div(T);return this._sum._add(C),this._sum.mag()<this._clickTolerance?void 0:{around:y.div(T),panDelta:C}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class tc{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(r,a,u){this._firstTwoTouches||u.length<2||(this._firstTwoTouches=[u[0].identifier,u[1].identifier],this._start([a[0],a[1]]))}touchmove(r,a,u){if(!this._firstTwoTouches)return;r.preventDefault();const[p,y]=this._firstTwoTouches,w=To(u,a,p),T=To(u,a,y);if(!w||!T)return;const C=this._aroundCenter?null:w.add(T).div(2);return this._move([w,T],C,r)}touchend(r,a,u){if(!this._firstTwoTouches)return;const[p,y]=this._firstTwoTouches,w=To(u,a,p),T=To(u,a,y);w&&T||(this._active&&F.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function To(g,r,a){for(let u=0;u<g.length;u++)if(g[u].identifier===a)return r[u]}function Xs(g,r){return Math.log(g/r)/Math.LN2}class rc extends tc{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,a){const u=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(Xs(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Xs(this._distance,u),pinchAround:a}}}function ju(g,r){return 180*g.angleWith(r)/Math.PI}class Vu extends tc{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,a,u){const p=this._vector;if(this._vector=r[0].sub(r[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:ju(this._vector,p),pinchAround:a}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const a=25/(Math.PI*this._minDiameter)*360,u=ju(r,this._startVector);return Math.abs(u)<a}}function nc(g){return Math.abs(g.y)>Math.abs(g.x)}class qu extends tc{constructor(r){super(),this._currentTouchCount=0,this._map=r}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(r,a,u){super.touchstart(r,a,u),this._currentTouchCount=u.length}_start(r){this._lastPoints=r,nc(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,a,u){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const p=r[0].sub(this._lastPoints[0]),y=r[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(p,y,u.timeStamp),this._valid?(this._lastPoints=r,this._active=!0,{pitchDelta:(p.y+y.y)/2*-.5}):void 0}gestureBeginsVertically(r,a,u){if(this._valid!==void 0)return this._valid;const p=r.mag()>=2,y=a.mag()>=2;if(!p&&!y)return;if(!p||!y)return this._firstMove===void 0&&(this._firstMove=u),u-this._firstMove<100&&void 0;const w=r.y>0==a.y>0;return nc(r)&&nc(a)&&w}}const Jd={panStep:100,bearingStep:15,pitchStep:10};class Uo{constructor(r){this._tr=new Ks(r);const a=Jd;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let a=0,u=0,p=0,y=0,w=0;switch(r.keyCode){case 61:case 107:case 171:case 187:a=1;break;case 189:case 109:case 173:a=-1;break;case 37:r.shiftKey?u=-1:(r.preventDefault(),y=-1);break;case 39:r.shiftKey?u=1:(r.preventDefault(),y=1);break;case 38:r.shiftKey?p=1:(r.preventDefault(),w=-1);break;case 40:r.shiftKey?p=-1:(r.preventDefault(),w=1);break;default:return}return this._rotationDisabled&&(u=0,p=0),{cameraAnimation:T=>{const C=this._tr;T.easeTo({duration:300,easeId:"keyboardHandler",easing:Qd,zoom:a?Math.round(C.zoom)+a*(r.shiftKey?2:1):C.zoom,bearing:C.bearing+u*this._bearingStep,pitch:C.pitch+p*this._pitchStep,offset:[-y*this._panStep,-w*this._panStep],center:C.center},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Qd(g){return g*(2-g)}const Hu=4.000244140625;class Wu{constructor(r,a){this._onTimeout=u=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(u)},this._map=r,this._tr=new Ks(r),this._triggerRenderFrame=a,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!r&&r.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(r){if(!this.isEnabled()||this._map.cooperativeGestures.isEnabled()&&!r[this._map.cooperativeGestures._bypassKey])return;let a=r.deltaMode===WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const u=j.now(),p=u-(this._lastWheelEventTime||0);this._lastWheelEventTime=u,a!==0&&a%Hu==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":p>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(p*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),r.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=r,this._delta-=a,this._active||this._start(r)),r.preventDefault()}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const a=F.mousePos(this._map.getCanvas(),r),u=this._tr;this._around=a.y>u.transform.height/2-u.transform.getHorizon()?d.M.convert(this._aroundCenter?u.center:u.unproject(a)):d.M.convert(u.center),this._aroundPoint=u.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._tr.transform;if(this._delta!==0){const T=this._type==="wheel"&&Math.abs(this._delta)>Hu?this._wheelZoomRate:this._defaultZoomRate;let C=2/(1+Math.exp(-Math.abs(this._delta*T)));this._delta<0&&C!==0&&(C=1/C);const k=typeof this._targetZoom=="number"?r.zoomScale(this._targetZoom):r.scale;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(k*C))),this._type==="wheel"&&(this._startZoom=r.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const a=typeof this._targetZoom=="number"?this._targetZoom:r.zoom,u=this._startZoom,p=this._easing;let y,w=!1;if(this._type==="wheel"&&u&&p){const T=Math.min((j.now()-this._lastWheelEventTime)/200,1),C=p(T);y=d.z.number(u,a,C),T<1?this._frameId||(this._frameId=!0):w=!0}else y=a,w=!0;return this._active=!0,w&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!w,zoomDelta:y-r.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let a=d.b8;if(this._prevEase){const u=this._prevEase,p=(j.now()-u.start)/u.duration,y=u.easing(p+.01)-u.easing(p),w=.27/Math.sqrt(y*y+1e-4)*.01,T=Math.sqrt(.0729-w*w);a=d.b7(w,T,.25,1)}return this._prevEase={start:j.now(),duration:r,easing:a},a}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Gu{constructor(r,a){this._clickZoom=r,this._tapZoom=a}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ep{constructor(r){this._tr=new Ks(r),this.reset()}reset(){this._active=!1}dblclick(r,a){return r.preventDefault(),{cameraAnimation:u=>{u.easeTo({duration:300,zoom:this._tr.zoom+(r.shiftKey?-1:1),around:this._tr.unproject(a)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class tp{constructor(){this._tap=new Yl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(r,a,u){if(!this._swipePoint)if(this._tapTime){const p=a[0],y=r.timeStamp-this._tapTime<500,w=this._tapPoint.dist(p)<30;y&&w?u.length>0&&(this._swipePoint=p,this._swipeTouch=u[0].identifier):this.reset()}else this._tap.touchstart(r,a,u)}touchmove(r,a,u){if(this._tapTime){if(this._swipePoint){if(u[0].identifier!==this._swipeTouch)return;const p=a[0],y=p.y-this._swipePoint.y;return this._swipePoint=p,r.preventDefault(),this._active=!0,{zoomDelta:y/128}}}else this._tap.touchmove(r,a,u)}touchend(r,a,u){if(this._tapTime)this._swipePoint&&u.length===0&&this.reset();else{const p=this._tap.touchend(r,a,u);p&&(this._tapTime=r.timeStamp,this._tapPoint=p)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Zu{constructor(r,a,u){this._el=r,this._mousePan=a,this._touchPan=u}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Ys{constructor(r,a,u){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=a,this._mousePitch=u}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Ku{constructor(r,a,u,p){this._el=r,this._touchZoom=a,this._touchRotate=u,this._tapDragZoom=p,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class gi{constructor(r,a){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=r,this._options=a,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const r=this._map.getCanvasContainer();r.classList.add("maplibregl-cooperative-gestures"),this._container=F.create("div","maplibregl-cooperative-gesture-screen",r);let a=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(a=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const u=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),p=document.createElement("div");p.className="maplibregl-desktop-message",p.textContent=a,this._container.appendChild(p);const y=document.createElement("div");y.className="maplibregl-mobile-message",y.textContent=u,this._container.appendChild(y),this._container.setAttribute("aria-hidden","true")}_destoryUI(){this._container&&(F.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destoryUI()}isEnabled(){return this._enabled}touchmove(r){this._onCooperativeGesture(r.touches.length===1)}wheel(r){this._map.scrollZoom.isEnabled()&&this._onCooperativeGesture(!r[this._bypassKey])}_onCooperativeGesture(r){this._enabled&&r&&(this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const si=g=>g.zoom||g.drag||g.pitch||g.rotate;class rp extends d.k{}function yi(g){return g.panDelta&&g.panDelta.mag()||g.zoomDelta||g.bearingDelta||g.pitchDelta}class Ja{constructor(r,a){this.handleWindowEvent=p=>{this.handleEvent(p,`${p.type}Window`)},this.handleEvent=(p,y)=>{if(p.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const w=p.type==="renderFrame"?void 0:p,T={needsRenderFrame:!1},C={},k={},M=p.touches,P=M?this._getMapTouches(M):void 0,O=P?F.touchPos(this._map.getCanvas(),P):F.mousePos(this._map.getCanvas(),p);for(const{handlerName:J,handler:W,allowed:te}of this._handlers){if(!W.isEnabled())continue;let se;this._blockedByActive(k,te,J)?W.reset():W[y||p.type]&&(se=W[y||p.type](p,O,P),this.mergeHandlerResult(T,C,se,J,w),se&&se.needsRenderFrame&&this._triggerRenderFrame()),(se||W.isActive())&&(k[J]=W)}const V={};for(const J in this._previousActiveHandlers)k[J]||(V[J]=w);this._previousActiveHandlers=k,(Object.keys(V).length||yi(T))&&(this._changes.push([T,C,V]),this._triggerRenderFrame()),(Object.keys(k).length||yi(T))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:H}=T;H&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],H(this._map))},this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Nu(r),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(a);const u=this._el;this._listeners=[[u,"touchstart",{passive:!0}],[u,"touchmove",{passive:!1}],[u,"touchend",void 0],[u,"touchcancel",void 0],[u,"mousedown",void 0],[u,"mousemove",void 0],[u,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[u,"mouseover",void 0],[u,"mouseout",void 0],[u,"dblclick",void 0],[u,"click",void 0],[u,"keydown",{capture:!1}],[u,"keyup",void 0],[u,"wheel",{passive:!1}],[u,"contextmenu",void 0],[window,"blur",void 0]];for(const[p,y,w]of this._listeners)F.addEventListener(p,y,p===document?this.handleWindowEvent:this.handleEvent,w)}destroy(){for(const[r,a,u]of this._listeners)F.removeEventListener(r,a,r===document?this.handleWindowEvent:this.handleEvent,u)}_addDefaultHandlers(r){const a=this._map,u=a.getCanvasContainer();this._add("mapEvent",new $u(a,r));const p=a.boxZoom=new Xa(a,r);this._add("boxZoom",p),r.interactive&&r.boxZoom&&p.enable();const y=a.cooperativeGestures=new gi(a,r.cooperativeGestures);this._add("cooperativeGestures",y),r.cooperativeGestures&&y.enable();const w=new Jl(a),T=new ep(a);a.doubleClickZoom=new Gu(T,w),this._add("tapZoom",w),this._add("clickZoom",T),r.interactive&&r.doubleClickZoom&&a.doubleClickZoom.enable();const C=new tp;this._add("tapDragZoom",C);const k=a.touchPitch=new qu(a);this._add("touchPitch",k),r.interactive&&r.touchPitch&&a.touchPitch.enable(r.touchPitch);const M=oi(r),P=ec(r);a.dragRotate=new Ys(r,M,P),this._add("mouseRotate",M,["mousePitch"]),this._add("mousePitch",P,["mouseRotate"]),r.interactive&&r.dragRotate&&a.dragRotate.enable();const O=(({enable:se,clickTolerance:X})=>{const ce=new Ql({checkCorrectEvent:fe=>F.mouseButton(fe)===0&&!fe.ctrlKey});return new xs({clickTolerance:X,move:(fe,_e)=>({around:_e,panDelta:_e.sub(fe)}),activateOnStart:!0,moveStateManager:ce,enable:se,assignEvents:So})})(r),V=new Uu(r,a);a.dragPan=new Zu(u,O,V),this._add("mousePan",O),this._add("touchPan",V,["touchZoom","touchRotate"]),r.interactive&&r.dragPan&&a.dragPan.enable(r.dragPan);const H=new Vu,J=new rc;a.touchZoomRotate=new Ku(u,J,H,C),this._add("touchRotate",H,["touchPan","touchZoom"]),this._add("touchZoom",J,["touchPan","touchRotate"]),r.interactive&&r.touchZoomRotate&&a.touchZoomRotate.enable(r.touchZoomRotate);const W=a.scrollZoom=new Wu(a,()=>this._triggerRenderFrame());this._add("scrollZoom",W,["mousePan"]),r.interactive&&r.scrollZoom&&a.scrollZoom.enable(r.scrollZoom);const te=a.keyboard=new Uo(a);this._add("keyboard",te),r.interactive&&r.keyboard&&a.keyboard.enable(),this._add("blockableMapEvent",new fg(a))}_add(r,a,u){this._handlers.push({handlerName:r,handler:a,allowed:u}),this._handlersById[r]=a}stop(r){if(!this._updatingCamera){for(const{handler:a}of this._handlers)a.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[]}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!si(this._eventsInProgress)||this.isZooming()}_blockedByActive(r,a,u){for(const p in r)if(p!==u&&(!a||a.indexOf(p)<0))return!0;return!1}_getMapTouches(r){const a=[];for(const u of r)this._el.contains(u.target)&&a.push(u);return a}mergeHandlerResult(r,a,u,p,y){if(!u)return;d.e(r,u);const w={handlerName:p,originalEvent:u.originalEvent||y};u.zoomDelta!==void 0&&(a.zoom=w),u.panDelta!==void 0&&(a.drag=w),u.pitchDelta!==void 0&&(a.pitch=w),u.bearingDelta!==void 0&&(a.rotate=w)}_applyChanges(){const r={},a={},u={};for(const[p,y,w]of this._changes)p.panDelta&&(r.panDelta=(r.panDelta||new d.P(0,0))._add(p.panDelta)),p.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+p.zoomDelta),p.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+p.bearingDelta),p.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+p.pitchDelta),p.around!==void 0&&(r.around=p.around),p.pinchAround!==void 0&&(r.pinchAround=p.pinchAround),p.noInertia&&(r.noInertia=p.noInertia),d.e(a,y),d.e(u,w);this._updateMapTransform(r,a,u),this._changes=[]}_updateMapTransform(r,a,u){const p=this._map,y=p._getTransformForUpdate(),w=p.terrain;if(!(yi(r)||w&&this._terrainMovement))return this._fireEvents(a,u,!0);let{panDelta:T,zoomDelta:C,bearingDelta:k,pitchDelta:M,around:P,pinchAround:O}=r;O!==void 0&&(P=O),p._stop(!0),P=P||p.transform.centerPoint;const V=y.pointLocation(T?P.sub(T):P);k&&(y.bearing+=k),M&&(y.pitch+=M),C&&(y.zoom+=C),w?this._terrainMovement||!a.drag&&!a.zoom?a.drag&&this._terrainMovement?y.center=y.pointLocation(y.centerPoint.sub(T)):y.setLocationAtPoint(V,P):(this._terrainMovement=!0,this._map._elevationFreeze=!0,y.setLocationAtPoint(V,P)):y.setLocationAtPoint(V,P),p._applyUpdatedTransform(y),this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(a,u,!0)}_fireEvents(r,a,u){const p=si(this._eventsInProgress),y=si(r),w={};for(const P in r){const{originalEvent:O}=r[P];this._eventsInProgress[P]||(w[`${P}start`]=O),this._eventsInProgress[P]=r[P]}!p&&y&&this._fireEvent("movestart",y.originalEvent);for(const P in w)this._fireEvent(P,w[P]);y&&this._fireEvent("move",y.originalEvent);for(const P in r){const{originalEvent:O}=r[P];this._fireEvent(P,O)}const T={};let C;for(const P in this._eventsInProgress){const{handlerName:O,originalEvent:V}=this._eventsInProgress[P];this._handlersById[O].isActive()||(delete this._eventsInProgress[P],C=a[O]||V,T[`${P}end`]=C)}for(const P in T)this._fireEvent(P,T[P]);const k=si(this._eventsInProgress),M=(p||y)&&!k;if(M&&this._terrainMovement&&(this._map._elevationFreeze=!1,this._terrainMovement=!1,this._map.transform.recalculateZoom(this._map.terrain)),u&&M){this._updatingCamera=!0;const P=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),O=V=>V!==0&&-this._bearingSnap<V&&V<this._bearingSnap;!P||!P.essential&&j.prefersReducedMotion?(this._map.fire(new d.k("moveend",{originalEvent:C})),O(this._map.getBearing())&&this._map.resetNorth()):(O(P.bearing||this._map.getBearing())&&(P.bearing=0),P.freezeElevation=!0,this._map.easeTo(P,{originalEvent:C})),this._updatingCamera=!1}}_fireEvent(r,a){this._map.fire(new d.k(r,a?{originalEvent:a}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{delete this._frameId,this.handleEvent(new rp("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class gg extends d.E{constructor(r,a){super(),this._renderFrameCallback=()=>{const u=Math.min((j.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(u)),u<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=a.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new d.M(this.transform.center.lng,this.transform.center.lat)}setCenter(r,a){return this.jumpTo({center:r},a)}panBy(r,a,u){return r=d.P.convert(r).mult(-1),this.panTo(this.transform.center,d.e({offset:r},a),u)}panTo(r,a,u){return this.easeTo(d.e({center:r},a),u)}getZoom(){return this.transform.zoom}setZoom(r,a){return this.jumpTo({zoom:r},a),this}zoomTo(r,a,u){return this.easeTo(d.e({zoom:r},a),u)}zoomIn(r,a){return this.zoomTo(this.getZoom()+1,r,a),this}zoomOut(r,a){return this.zoomTo(this.getZoom()-1,r,a),this}getBearing(){return this.transform.bearing}setBearing(r,a){return this.jumpTo({bearing:r},a),this}getPadding(){return this.transform.padding}setPadding(r,a){return this.jumpTo({padding:r},a),this}rotateTo(r,a,u){return this.easeTo(d.e({bearing:r},a),u)}resetNorth(r,a){return this.rotateTo(0,d.e({duration:1e3},r),a),this}resetNorthPitch(r,a){return this.easeTo(d.e({bearing:0,pitch:0,duration:1e3},r),a),this}snapToNorth(r,a){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,a):this}getPitch(){return this.transform.pitch}setPitch(r,a){return this.jumpTo({pitch:r},a),this}cameraForBounds(r,a){r=br.convert(r);const u=a&&a.bearing||0;return this._cameraForBoxAndBearing(r.getNorthWest(),r.getSouthEast(),u,a)}_cameraForBoxAndBearing(r,a,u,p){const y={top:0,bottom:0,right:0,left:0};if(typeof(p=d.e({padding:y,offset:[0,0],maxZoom:this.transform.maxZoom},p)).padding=="number"){const ze=p.padding;p.padding={top:ze,bottom:ze,right:ze,left:ze}}p.padding=d.e(y,p.padding);const w=this.transform,T=w.padding,C=new br(r,a),k=w.project(C.getNorthWest()),M=w.project(C.getNorthEast()),P=w.project(C.getSouthEast()),O=w.project(C.getSouthWest()),V=d.b9(-u),H=k.rotate(V),J=M.rotate(V),W=P.rotate(V),te=O.rotate(V),se=new d.P(Math.max(H.x,J.x,te.x,W.x),Math.max(H.y,J.y,te.y,W.y)),X=new d.P(Math.min(H.x,J.x,te.x,W.x),Math.min(H.y,J.y,te.y,W.y)),ce=se.sub(X),fe=(w.width-(T.left+T.right+p.padding.left+p.padding.right))/ce.x,_e=(w.height-(T.top+T.bottom+p.padding.top+p.padding.bottom))/ce.y;if(_e<0||fe<0)return void d.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Ce=Math.min(w.scaleZoom(w.scale*Math.min(fe,_e)),p.maxZoom),Me=d.P.convert(p.offset),He=new d.P((p.padding.left-p.padding.right)/2,(p.padding.top-p.padding.bottom)/2).rotate(d.b9(u)),We=Me.add(He).mult(w.scale/w.zoomScale(Ce));return{center:w.unproject(k.add(P).div(2).sub(We)),zoom:Ce,bearing:u}}fitBounds(r,a,u){return this._fitInternal(this.cameraForBounds(r,a),a,u)}fitScreenCoordinates(r,a,u,p,y){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(d.P.convert(r)),this.transform.pointLocation(d.P.convert(a)),u,p),p,y)}_fitInternal(r,a,u){return r?(delete(a=d.e(r,a)).padding,a.linear?this.easeTo(a,u):this.flyTo(a,u)):this}jumpTo(r,a){this.stop();const u=this._getTransformForUpdate();let p=!1,y=!1,w=!1;return"zoom"in r&&u.zoom!==+r.zoom&&(p=!0,u.zoom=+r.zoom),r.center!==void 0&&(u.center=d.M.convert(r.center)),"bearing"in r&&u.bearing!==+r.bearing&&(y=!0,u.bearing=+r.bearing),"pitch"in r&&u.pitch!==+r.pitch&&(w=!0,u.pitch=+r.pitch),r.padding==null||u.isPaddingEqual(r.padding)||(u.padding=r.padding),this._applyUpdatedTransform(u),this.fire(new d.k("movestart",a)).fire(new d.k("move",a)),p&&this.fire(new d.k("zoomstart",a)).fire(new d.k("zoom",a)).fire(new d.k("zoomend",a)),y&&this.fire(new d.k("rotatestart",a)).fire(new d.k("rotate",a)).fire(new d.k("rotateend",a)),w&&this.fire(new d.k("pitchstart",a)).fire(new d.k("pitch",a)).fire(new d.k("pitchend",a)),this.fire(new d.k("moveend",a))}calculateCameraOptionsFromTo(r,a,u,p=0){const y=d.Y.fromLngLat(r,a),w=d.Y.fromLngLat(u,p),T=w.x-y.x,C=w.y-y.y,k=w.z-y.z,M=Math.hypot(T,C,k);if(M===0)throw new Error("Can't calculate camera options with same From and To");const P=Math.hypot(T,C),O=this.transform.scaleZoom(this.transform.cameraToCenterDistance/M/this.transform.tileSize),V=180*Math.atan2(T,-C)/Math.PI;let H=180*Math.acos(P/M)/Math.PI;return H=k<0?90-H:90+H,{center:w.toLngLat(),zoom:O,pitch:H,bearing:V}}easeTo(r,a){var u;this._stop(!1,r.easeId),((r=d.e({offset:[0,0],duration:500,easing:d.b8},r)).animate===!1||!r.essential&&j.prefersReducedMotion)&&(r.duration=0);const p=this._getTransformForUpdate(),y=this.getZoom(),w=this.getBearing(),T=this.getPitch(),C=this.getPadding(),k="bearing"in r?this._normalizeBearing(r.bearing,w):w,M="pitch"in r?+r.pitch:T,P="padding"in r?r.padding:p.padding,O=d.P.convert(r.offset);let V=p.centerPoint.add(O);const H=p.pointLocation(V),{center:J,zoom:W}=p.getConstrained(d.M.convert(r.center||H),(u=r.zoom)!==null&&u!==void 0?u:y);this._normalizeCenter(J);const te=p.project(H),se=p.project(J).sub(te),X=p.zoomScale(W-y);let ce,fe;r.around&&(ce=d.M.convert(r.around),fe=p.locationPoint(ce));const _e={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||W!==y,this._rotating=this._rotating||w!==k,this._pitching=this._pitching||M!==T,this._padding=!p.isPaddingEqual(P),this._easeId=r.easeId,this._prepareEase(a,r.noMoveStart,_e),this.terrain&&this._prepareElevation(J),this._ease(Ce=>{if(this._zooming&&(p.zoom=d.z.number(y,W,Ce)),this._rotating&&(p.bearing=d.z.number(w,k,Ce)),this._pitching&&(p.pitch=d.z.number(T,M,Ce)),this._padding&&(p.interpolatePadding(C,P,Ce),V=p.centerPoint.add(O)),this.terrain&&!r.freezeElevation&&this._updateElevation(Ce),ce)p.setLocationAtPoint(ce,fe);else{const Me=p.zoomScale(p.zoom-y),He=W>y?Math.min(2,X):Math.max(.5,X),We=Math.pow(He,1-Ce),ze=p.unproject(te.add(se.mult(Ce*We)).mult(Me));p.setLocationAtPoint(p.renderWorldCopies?ze.wrap():ze,V)}this._applyUpdatedTransform(p),this._fireMoveEvents(a)},Ce=>{this.terrain&&r.freezeElevation&&this._finalizeElevation(),this._afterEase(a,Ce)},r),this}_prepareEase(r,a,u={}){this._moving=!0,a||u.moving||this.fire(new d.k("movestart",r)),this._zooming&&!u.zooming&&this.fire(new d.k("zoomstart",r)),this._rotating&&!u.rotating&&this.fire(new d.k("rotatestart",r)),this._pitching&&!u.pitching&&this.fire(new d.k("pitchstart",r))}_prepareElevation(r){this._elevationCenter=r,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(r,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(r){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const a=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(r<1&&a!==this._elevationTarget){const u=this._elevationTarget-this._elevationStart;this._elevationStart+=r*(u-(a-(u*r+this._elevationStart))/(1-r)),this._elevationTarget=a}this.transform.elevation=d.z.number(this._elevationStart,this._elevationTarget,r)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(r){if(!this.transformCameraUpdate)return;const a=r.clone(),{center:u,zoom:p,pitch:y,bearing:w,elevation:T}=this.transformCameraUpdate(a);u&&(a.center=u),p!==void 0&&(a.zoom=p),y!==void 0&&(a.pitch=y),w!==void 0&&(a.bearing=w),T!==void 0&&(a.elevation=T),this.transform.apply(a)}_fireMoveEvents(r){this.fire(new d.k("move",r)),this._zooming&&this.fire(new d.k("zoom",r)),this._rotating&&this.fire(new d.k("rotate",r)),this._pitching&&this.fire(new d.k("pitch",r))}_afterEase(r,a){if(this._easeId&&a&&this._easeId===a)return;delete this._easeId;const u=this._zooming,p=this._rotating,y=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,u&&this.fire(new d.k("zoomend",r)),p&&this.fire(new d.k("rotateend",r)),y&&this.fire(new d.k("pitchend",r)),this.fire(new d.k("moveend",r))}flyTo(r,a){var u;if(!r.essential&&j.prefersReducedMotion){const $e=d.L(r,["center","zoom","bearing","pitch","around"]);return this.jumpTo($e,a)}this.stop(),r=d.e({offset:[0,0],speed:1.2,curve:1.42,easing:d.b8},r);const p=this._getTransformForUpdate(),y=this.getZoom(),w=this.getBearing(),T=this.getPitch(),C=this.getPadding(),k="bearing"in r?this._normalizeBearing(r.bearing,w):w,M="pitch"in r?+r.pitch:T,P="padding"in r?r.padding:p.padding,O=d.P.convert(r.offset);let V=p.centerPoint.add(O);const H=p.pointLocation(V),{center:J,zoom:W}=p.getConstrained(d.M.convert(r.center||H),(u=r.zoom)!==null&&u!==void 0?u:y);this._normalizeCenter(J);const te=p.zoomScale(W-y),se=p.project(H),X=p.project(J).sub(se);let ce=r.curve;const fe=Math.max(p.width,p.height),_e=fe/te,Ce=X.mag();if("minZoom"in r){const $e=d.ac(Math.min(r.minZoom,y,W),p.minZoom,p.maxZoom),dt=fe/p.zoomScale($e-y);ce=Math.sqrt(dt/Ce*2)}const Me=ce*ce;function He($e){const dt=(_e*_e-fe*fe+($e?-1:1)*Me*Me*Ce*Ce)/(2*($e?_e:fe)*Me*Ce);return Math.log(Math.sqrt(dt*dt+1)-dt)}function We($e){return(Math.exp($e)-Math.exp(-$e))/2}function ze($e){return(Math.exp($e)+Math.exp(-$e))/2}const De=He(!1);let Je=function($e){return ze(De)/ze(De+ce*$e)},_t=function($e){return fe*((ze(De)*(We(dt=De+ce*$e)/ze(dt))-We(De))/Me)/Ce;var dt},Fe=(He(!0)-De)/ce;if(Math.abs(Ce)<1e-6||!isFinite(Fe)){if(Math.abs(fe-_e)<1e-6)return this.easeTo(r,a);const $e=_e<fe?-1:1;Fe=Math.abs(Math.log(_e/fe))/ce,_t=()=>0,Je=dt=>Math.exp($e*ce*dt)}return r.duration="duration"in r?+r.duration:1e3*Fe/("screenSpeed"in r?+r.screenSpeed/ce:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0),this._zooming=!0,this._rotating=w!==k,this._pitching=M!==T,this._padding=!p.isPaddingEqual(P),this._prepareEase(a,!1),this.terrain&&this._prepareElevation(J),this._ease($e=>{const dt=$e*Fe,or=1/Je(dt);p.zoom=$e===1?W:y+p.scaleZoom(or),this._rotating&&(p.bearing=d.z.number(w,k,$e)),this._pitching&&(p.pitch=d.z.number(T,M,$e)),this._padding&&(p.interpolatePadding(C,P,$e),V=p.centerPoint.add(O)),this.terrain&&!r.freezeElevation&&this._updateElevation($e);const Tt=$e===1?J:p.unproject(se.add(X.mult(_t(dt))).mult(or));p.setLocationAtPoint(p.renderWorldCopies?Tt.wrap():Tt,V),this._applyUpdatedTransform(p),this._fireMoveEvents(a)},()=>{this.terrain&&r.freezeElevation&&this._finalizeElevation(),this._afterEase(a)},r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(r,a){var u;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const p=this._onEaseEnd;delete this._onEaseEnd,p.call(this,a)}return r||(u=this.handlers)===null||u===void 0||u.stop(!1),this}_ease(r,a,u){u.animate===!1||u.duration===0?(r(1),a()):(this._easeStart=j.now(),this._easeOptions=u,this._onEaseFrame=r,this._onEaseEnd=a,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(r,a){r=d.b2(r,-180,180);const u=Math.abs(r-a);return Math.abs(r-360-a)<u&&(r-=360),Math.abs(r+360-a)<u&&(r+=360),r}_normalizeCenter(r){const a=this.transform;if(!a.renderWorldCopies||a.lngRange)return;const u=r.lng-a.center.lng;r.lng+=u>180?-360:u<-180?360:0}queryTerrainElevation(r){return this.terrain?this.terrain.getElevationForLngLatZoom(d.M.convert(r),this.transform.tileZoom)-this.transform.elevation:null}}const np={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class ip{constructor(r=np){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=a=>{!a||a.sourceDataType!=="metadata"&&a.sourceDataType!=="visibility"&&a.dataType!=="style"&&a.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=r}getDefaultPosition(){return"bottom-right"}onAdd(r){return this._map=r,this._compact=this.options.compact,this._container=F.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=F.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=F.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){F.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(r,a){const u=this._map._getUIString(`AttributionControl.${a}`);r.title=u,r.setAttribute("aria-label",u)}_updateAttributions(){if(!this._map.style)return;let r=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=r.concat(this.options.customAttribution.map(p=>typeof p!="string"?"":p)):typeof this.options.customAttribution=="string"&&r.push(this.options.customAttribution)),this._map.style.stylesheet){const p=this._map.style.stylesheet;this.styleOwner=p.owner,this.styleId=p.id}const a=this._map.style.sourceCaches;for(const p in a){const y=a[p];if(y.used||y.usedForTerrain){const w=y.getSource();w.attribution&&r.indexOf(w.attribution)<0&&r.push(w.attribution)}}r=r.filter(p=>String(p).trim()),r.sort((p,y)=>p.length-y.length),r=r.filter((p,y)=>{for(let w=y+1;w<r.length;w++)if(r[w].indexOf(p)>=0)return!1;return!0});const u=r.join(" | ");u!==this._attribHTML&&(this._attribHTML=u,r.length?(this._innerContainer.innerHTML=u,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Xu{constructor(r={}){this._updateCompact=()=>{const a=this._container.children;if(a.length){const u=a[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&u.classList.add("maplibregl-compact"):u.classList.remove("maplibregl-compact")}},this.options=r}getDefaultPosition(){return"bottom-left"}onAdd(r){this._map=r,this._compact=this.options&&this.options.compact,this._container=F.create("div","maplibregl-ctrl");const a=F.create("a","maplibregl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://maplibre.org/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){F.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Qa{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const a=++this._id;return this._queue.push({callback:r,id:a,cancelled:!1}),a}remove(r){const a=this._currentlyRunning,u=a?this._queue.concat(a):this._queue;for(const p of u)if(p.id===r)return void(p.cancelled=!0)}run(r=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const a=this._currentlyRunning=this._queue;this._queue=[];for(const u of a)if(!u.cancelled&&(u.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var jo=d.X([{name:"a_pos3d",type:"Int16",components:3}]);class Xe extends d.E{constructor(r){super(),this.sourceCache=r,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,r.usedForTerrain=!0,r.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(r,a){this.sourceCache.update(r,a),this._renderableTilesKeys=[];const u={};for(const p of r.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:a}))u[p.key]=!0,this._renderableTilesKeys.push(p.key),this._tiles[p.key]||(p.posMatrix=new Float64Array(16),d.aO(p.posMatrix,0,d.W,0,d.W,0,1),this._tiles[p.key]=new on(p,this.tileSize));for(const p in this._tiles)u[p]||delete this._tiles[p]}freeRtt(r){for(const a in this._tiles){const u=this._tiles[a];(!r||u.tileID.equals(r)||u.tileID.isChildOf(r)||r.isChildOf(u.tileID))&&(u.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(r=>this.getTileByID(r))}getTileByID(r){return this._tiles[r]}getTerrainCoords(r){const a={};for(const u of this._renderableTilesKeys){const p=this._tiles[u].tileID;if(p.canonical.equals(r.canonical)){const y=r.clone();y.posMatrix=new Float64Array(16),d.aO(y.posMatrix,0,d.W,0,d.W,0,1),a[u]=y}else if(p.canonical.isChildOf(r.canonical)){const y=r.clone();y.posMatrix=new Float64Array(16);const w=p.canonical.z-r.canonical.z,T=p.canonical.x-(p.canonical.x>>w<<w),C=p.canonical.y-(p.canonical.y>>w<<w),k=d.W>>w;d.aO(y.posMatrix,0,k,0,k,0,1),d.H(y.posMatrix,y.posMatrix,[-T*k,-C*k,0]),a[u]=y}else if(r.canonical.isChildOf(p.canonical)){const y=r.clone();y.posMatrix=new Float64Array(16);const w=r.canonical.z-p.canonical.z,T=r.canonical.x-(r.canonical.x>>w<<w),C=r.canonical.y-(r.canonical.y>>w<<w),k=d.W>>w;d.aO(y.posMatrix,0,d.W,0,d.W,0,1),d.H(y.posMatrix,y.posMatrix,[T*k,C*k,0]),d.J(y.posMatrix,y.posMatrix,[1/2**w,1/2**w,0]),a[u]=y}}return a}getSourceTile(r,a){const u=this.sourceCache._source;let p=r.overscaledZ-this.deltaZoom;if(p>u.maxzoom&&(p=u.maxzoom),p<u.minzoom)return null;this._sourceTileCache[r.key]||(this._sourceTileCache[r.key]=r.scaledTo(p).key);let y=this.sourceCache.getTileByID(this._sourceTileCache[r.key]);if((!y||!y.dem)&&a)for(;p>=u.minzoom&&(!y||!y.dem);)y=this.sourceCache.getTileByID(r.scaledTo(p--).key);return y}tilesAfterTime(r=Date.now()){return Object.values(this._tiles).filter(a=>a.timeAdded>=r)}}class op{constructor(r,a,u){this.painter=r,this.sourceCache=new Xe(a),this.options=u,this.exaggeration=typeof u.exaggeration=="number"?u.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(r,a,u,p=d.W){var y;if(!(a>=0&&a<p&&u>=0&&u<p))return 0;const w=this.getTerrainData(r),T=(y=w.tile)===null||y===void 0?void 0:y.dem;if(!T)return 0;const C=function(H,J,W){var te=J[0],se=J[1];return H[0]=W[0]*te+W[4]*se+W[12],H[1]=W[1]*te+W[5]*se+W[13],H}([],[a/p*d.W,u/p*d.W],w.u_terrain_matrix),k=[C[0]*T.dim,C[1]*T.dim],M=Math.floor(k[0]),P=Math.floor(k[1]),O=k[0]-M,V=k[1]-P;return T.get(M,P)*(1-O)*(1-V)+T.get(M+1,P)*O*(1-V)+T.get(M,P+1)*(1-O)*V+T.get(M+1,P+1)*O*V}getElevationForLngLatZoom(r,a){const{tileID:u,mercatorX:p,mercatorY:y}=this._getOverscaledTileIDFromLngLatZoom(r,a);return this.getElevation(u,p%d.W,y%d.W,d.W)}getElevation(r,a,u,p=d.W){return this.getDEMElevation(r,a,u,p)*this.exaggeration}getTerrainData(r){if(!this._emptyDemTexture){const p=this.painter.context,y=new d.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new st(p,y,p.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new st(p,new d.R({width:1,height:1}),p.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(p.gl.NEAREST,p.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=d.an([])}const a=this.sourceCache.getSourceTile(r,!0);if(a&&a.dem&&(!a.demTexture||a.needsTerrainPrepare)){const p=this.painter.context;a.demTexture=this.painter.getTileTexture(a.dem.stride),a.demTexture?a.demTexture.update(a.dem.getPixels(),{premultiply:!1}):a.demTexture=new st(p,a.dem.getPixels(),p.gl.RGBA,{premultiply:!1}),a.demTexture.bind(p.gl.NEAREST,p.gl.CLAMP_TO_EDGE),a.needsTerrainPrepare=!1}const u=a&&a+a.tileID.key+r.key;if(u&&!this._demMatrixCache[u]){const p=this.sourceCache.sourceCache._source.maxzoom;let y=r.canonical.z-a.tileID.canonical.z;r.overscaledZ>r.canonical.z&&(r.canonical.z>=p?y=r.canonical.z-p:d.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const w=r.canonical.x-(r.canonical.x>>y<<y),T=r.canonical.y-(r.canonical.y>>y<<y),C=d.ba(new Float64Array(16),[1/(d.W<<y),1/(d.W<<y),0]);d.H(C,C,[w*d.W,T*d.W,0]),this._demMatrixCache[r.key]={matrix:C,coord:r}}return{u_depth:2,u_terrain:3,u_terrain_dim:a&&a.dem&&a.dem.dim||1,u_terrain_matrix:u?this._demMatrixCache[r.key].matrix:this._emptyDemMatrix,u_terrain_unpack:a&&a.dem&&a.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(a&&a.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:a}}getFramebuffer(r){const a=this.painter,u=a.width/devicePixelRatio,p=a.height/devicePixelRatio;return!this._fbo||this._fbo.width===u&&this._fbo.height===p||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new st(a.context,{width:u,height:p,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new st(a.context,{width:u,height:p,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=a.context.createFramebuffer(u,p,!0,!1),this._fbo.depthAttachment.set(a.context.createRenderbuffer(a.context.gl.DEPTH_COMPONENT16,u,p))),this._fbo.colorAttachment.set(r==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const r=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const a=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let y=0,w=0;y<this._coordsTextureSize;y++)for(let T=0;T<this._coordsTextureSize;T++,w+=4)a[w+0]=255&T,a[w+1]=255&y,a[w+2]=T>>8<<4|y>>8,a[w+3]=0;const u=new d.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(a.buffer)),p=new st(r,u,r.gl.RGBA,{premultiply:!1});return p.bind(r.gl.NEAREST,r.gl.CLAMP_TO_EDGE),this._coordsTexture=p,p}pointCoordinate(r){this.painter.maybeDrawDepthAndCoords(!0);const a=new Uint8Array(4),u=this.painter.context,p=u.gl,y=Math.round(r.x*this.painter.pixelRatio/devicePixelRatio),w=Math.round(r.y*this.painter.pixelRatio/devicePixelRatio),T=Math.round(this.painter.height/devicePixelRatio);u.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),p.readPixels(y,T-w-1,1,1,p.RGBA,p.UNSIGNED_BYTE,a),u.bindFramebuffer.set(null);const C=a[0]+(a[2]>>4<<8),k=a[1]+((15&a[2])<<8),M=this.coordsIndex[255-a[3]],P=M&&this.sourceCache.getTileByID(M);if(!P)return null;const O=this._coordsTextureSize,V=(1<<P.tileID.canonical.z)*O;return new d.Y((P.tileID.canonical.x*O+C)/V+P.tileID.wrap,(P.tileID.canonical.y*O+k)/V,this.getElevation(P.tileID,C,k,O))}depthAtPoint(r){const a=new Uint8Array(4),u=this.painter.context,p=u.gl;return u.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),p.readPixels(r.x,this.painter.height/devicePixelRatio-r.y-1,1,1,p.RGBA,p.UNSIGNED_BYTE,a),u.bindFramebuffer.set(null),(a[0]/16777216+a[1]/65536+a[2]/256+a[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const r=this.painter.context,a=new d.bb,u=new d.aY,p=this.meshSize,y=d.W/p,w=p*p;for(let P=0;P<=p;P++)for(let O=0;O<=p;O++)a.emplaceBack(O*y,P*y,0);for(let P=0;P<w;P+=p+1)for(let O=0;O<p;O++)u.emplaceBack(O+P,p+O+P+1,p+O+P+2),u.emplaceBack(O+P,p+O+P+2,O+P+1);const T=a.length,C=T+2*(p+1);for(const P of[0,1])for(let O=0;O<=p;O++)for(const V of[0,1])a.emplaceBack(O*y,P*d.W,V);for(let P=0;P<2*p;P+=2)u.emplaceBack(C+P,C+P+1,C+P+3),u.emplaceBack(C+P,C+P+3,C+P+2),u.emplaceBack(T+P,T+P+3,T+P+1),u.emplaceBack(T+P,T+P+2,T+P+3);const k=a.length,M=k+2*(p+1);for(const P of[0,1])for(let O=0;O<=p;O++)for(const V of[0,1])a.emplaceBack(P*d.W,O*y,V);for(let P=0;P<2*p;P+=2)u.emplaceBack(k+P,k+P+1,k+P+3),u.emplaceBack(k+P,k+P+3,k+P+2),u.emplaceBack(M+P,M+P+3,M+P+1),u.emplaceBack(M+P,M+P+2,M+P+3);return this._mesh={indexBuffer:r.createIndexBuffer(u),vertexBuffer:r.createVertexBuffer(a,jo.members),segments:d.$.simpleSegment(0,0,a.length,u.length)},this._mesh}getMeshFrameDelta(r){return 2*Math.PI*d.bc/Math.pow(2,r)/5}getMinTileElevationForLngLatZoom(r,a){var u;const{tileID:p}=this._getOverscaledTileIDFromLngLatZoom(r,a);return(u=this.getMinMaxElevation(p).minElevation)!==null&&u!==void 0?u:0}getMinMaxElevation(r){const a=this.getTerrainData(r).tile,u={minElevation:null,maxElevation:null};return a&&a.dem&&(u.minElevation=a.dem.min*this.exaggeration,u.maxElevation=a.dem.max*this.exaggeration),u}_getOverscaledTileIDFromLngLatZoom(r,a){const u=d.Y.fromLngLat(r.wrap()),p=(1<<a)*d.W,y=u.x*p,w=u.y*p,T=Math.floor(y/d.W),C=Math.floor(w/d.W);return{tileID:new d.Q(a,0,a,T,C),mercatorX:y,mercatorY:w}}}class el{constructor(r,a,u){this._context=r,this._size=a,this._tileSize=u,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const r of this._objects)r.texture.destroy(),r.fbo.destroy()}_createObject(r){const a=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),u=new st(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return u.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),a.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),a.colorAttachment.set(u.texture),{id:r,fbo:a,texture:u,stamp:-1,inUse:!1}}getObjectForId(r){return this._objects[r]}useObject(r){r.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(a=>r.id!==a),this._recentlyUsed.push(r.id)}stampObject(r){r.stamp=++this._stamp}getOrCreateFreeObject(){for(const a of this._recentlyUsed)if(!this._objects[a].inUse)return this._objects[a];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const r=this._createObject(this._objects.length);return this._objects.push(r),r}freeObject(r){r.inUse=!1}freeAllObjects(){for(const r of this._objects)this.freeObject(r)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(r=>!r.inUse)===!1}}const Qi={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class sp{constructor(r,a){this.painter=r,this.terrain=a,this.pool=new el(r.context,30,a.sourceCache.tileSize*a.qualityFactor)}destruct(){this.pool.destruct()}getTexture(r){return this.pool.getObjectForId(r.rtt[this._stacks.length-1].id).texture}prepareForRender(r,a){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=r._order.filter(u=>!r._layers[u].isHidden(a)),this._coordsDescendingInv={};for(const u in r.sourceCaches){this._coordsDescendingInv[u]={};const p=r.sourceCaches[u].getVisibleCoordinates();for(const y of p){const w=this.terrain.sourceCache.getTerrainCoords(y);for(const T in w)this._coordsDescendingInv[u][T]||(this._coordsDescendingInv[u][T]=[]),this._coordsDescendingInv[u][T].push(w[T])}}this._coordsDescendingInvStr={};for(const u of r._order){const p=r._layers[u],y=p.source;if(Qi[p.type]&&!this._coordsDescendingInvStr[y]){this._coordsDescendingInvStr[y]={};for(const w in this._coordsDescendingInv[y])this._coordsDescendingInvStr[y][w]=this._coordsDescendingInv[y][w].map(T=>T.key).sort().join()}}for(const u of this._renderableTiles)for(const p in this._coordsDescendingInvStr){const y=this._coordsDescendingInvStr[p][u.tileID.key];y&&y!==u.rttCoords[p]&&(u.rtt=[])}}renderLayer(r){if(r.isHidden(this.painter.transform.zoom))return!1;const a=r.type,u=this.painter,p=this._renderableLayerIds[this._renderableLayerIds.length-1]===r.id;if(Qi[a]&&(this._prevType&&Qi[this._prevType]||this._stacks.push([]),this._prevType=a,this._stacks[this._stacks.length-1].push(r.id),!p))return!0;if(Qi[this._prevType]||Qi[a]&&p){this._prevType=a;const y=this._stacks.length-1,w=this._stacks[y]||[];for(const T of this._renderableTiles){if(this.pool.isFull()&&(Wl(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(T),T.rtt[y]){const k=this.pool.getObjectForId(T.rtt[y].id);if(k.stamp===T.rtt[y].stamp){this.pool.useObject(k);continue}}const C=this.pool.getOrCreateFreeObject();this.pool.useObject(C),this.pool.stampObject(C),T.rtt[y]={id:C.id,stamp:C.stamp},u.context.bindFramebuffer.set(C.fbo.framebuffer),u.context.clear({color:d.aP.transparent,stencil:0}),u.currentStencilSource=void 0;for(let k=0;k<w.length;k++){const M=u.style._layers[w[k]],P=M.source?this._coordsDescendingInv[M.source][T.tileID.key]:[T.tileID];u.context.viewport.set([0,0,C.fbo.width,C.fbo.height]),u._renderTileClippingMasks(M,P),u.renderLayer(u,u.style.sourceCaches[M.source],M,P),M.source&&(T.rttCoords[M.source]=this._coordsDescendingInvStr[M.source][T.tileID.key])}}return Wl(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Qi[a]}return!1}}const Ve={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Yu=L,yg={hash:!1,interactive:!0,bearingSnap:7,attributionControl:np,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:d.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},ap=g=>{g.touchstart=g.dragStart,g.touchmoveWindow=g.dragMove,g.touchend=g.dragEnd},Ju={showCompass:!0,showZoom:!0,visualizePitch:!1};class lp{constructor(r,a,u=!1){this.mousedown=w=>{this.startMouse(d.e({},w,{ctrlKey:!0,preventDefault:()=>w.preventDefault()}),F.mousePos(this.element,w)),F.addEventListener(window,"mousemove",this.mousemove),F.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=w=>{this.moveMouse(w,F.mousePos(this.element,w))},this.mouseup=w=>{this.mouseRotate.dragEnd(w),this.mousePitch&&this.mousePitch.dragEnd(w),this.offTemp()},this.touchstart=w=>{w.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=F.touchPos(this.element,w.targetTouches)[0],this.startTouch(w,this._startPos),F.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),F.addEventListener(window,"touchend",this.touchend))},this.touchmove=w=>{w.targetTouches.length!==1?this.reset():(this._lastPos=F.touchPos(this.element,w.targetTouches)[0],this.moveTouch(w,this._lastPos))},this.touchend=w=>{w.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const p=r.dragRotate._mouseRotate.getClickTolerance(),y=r.dragRotate._mousePitch.getClickTolerance();this.element=a,this.mouseRotate=oi({clickTolerance:p,enable:!0}),this.touchRotate=(({enable:w,clickTolerance:T,bearingDegreesPerPixelMoved:C=.8})=>{const k=new mr;return new xs({clickTolerance:T,move:(M,P)=>({bearingDelta:(P.x-M.x)*C}),moveStateManager:k,enable:w,assignEvents:ap})})({clickTolerance:p,enable:!0}),this.map=r,u&&(this.mousePitch=ec({clickTolerance:y,enable:!0}),this.touchPitch=(({enable:w,clickTolerance:T,pitchDegreesPerPixelMoved:C=-.5})=>{const k=new mr;return new xs({clickTolerance:T,move:(M,P)=>({pitchDelta:(P.y-M.y)*C}),moveStateManager:k,enable:w,assignEvents:ap})})({clickTolerance:y,enable:!0})),F.addEventListener(a,"mousedown",this.mousedown),F.addEventListener(a,"touchstart",this.touchstart,{passive:!1}),F.addEventListener(a,"touchcancel",this.reset)}startMouse(r,a){this.mouseRotate.dragStart(r,a),this.mousePitch&&this.mousePitch.dragStart(r,a),F.disableDrag()}startTouch(r,a){this.touchRotate.dragStart(r,a),this.touchPitch&&this.touchPitch.dragStart(r,a),F.disableDrag()}moveMouse(r,a){const u=this.map,{bearingDelta:p}=this.mouseRotate.dragMove(r,a)||{};if(p&&u.setBearing(u.getBearing()+p),this.mousePitch){const{pitchDelta:y}=this.mousePitch.dragMove(r,a)||{};y&&u.setPitch(u.getPitch()+y)}}moveTouch(r,a){const u=this.map,{bearingDelta:p}=this.touchRotate.dragMove(r,a)||{};if(p&&u.setBearing(u.getBearing()+p),this.touchPitch){const{pitchDelta:y}=this.touchPitch.dragMove(r,a)||{};y&&u.setPitch(u.getPitch()+y)}}off(){const r=this.element;F.removeEventListener(r,"mousedown",this.mousedown),F.removeEventListener(r,"touchstart",this.touchstart,{passive:!1}),F.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),F.removeEventListener(window,"touchend",this.touchend),F.removeEventListener(r,"touchcancel",this.reset),this.offTemp()}offTemp(){F.enableDrag(),F.removeEventListener(window,"mousemove",this.mousemove),F.removeEventListener(window,"mouseup",this.mouseup),F.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),F.removeEventListener(window,"touchend",this.touchend)}}let Vo;function cp(g,r,a){const u=new d.M(g.lng,g.lat);if(g=new d.M(g.lng,g.lat),r){const p=new d.M(g.lng-360,g.lat),y=new d.M(g.lng+360,g.lat),w=a.locationPoint(g).distSqr(r);a.locationPoint(p).distSqr(r)<w?g=p:a.locationPoint(y).distSqr(r)<w&&(g=y)}for(;Math.abs(g.lng-a.center.lng)>180;){const p=a.locationPoint(g);if(p.x>=0&&p.y>=0&&p.x<=a.width&&p.y<=a.height)break;g.lng>a.center.lng?g.lng-=360:g.lng+=360}return g.lng!==u.lng&&a.locationPoint(g).y>a.height/2-a.getHorizon()?g:u}const Qu={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function qo(g,r,a){const u=g.classList;for(const p in Qu)u.remove(`maplibregl-${a}-anchor-${p}`);u.add(`maplibregl-${a}-anchor-${r}`)}class Qt extends d.E{constructor(r){if(super(),this._onKeyPress=a=>{const u=a.code,p=a.charCode||a.keyCode;u!=="Space"&&u!=="Enter"&&p!==32&&p!==13||this.togglePopup()},this._onMapClick=a=>{const u=a.originalEvent.target,p=this._element;this._popup&&(u===p||p.contains(u))&&this.togglePopup()},this._update=a=>{var u;if(!this._map)return;const p=this._map.loaded()&&!this._map.isMoving();((a==null?void 0:a.type)==="terrain"||(a==null?void 0:a.type)==="render"&&!p)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?cp(this._lngLat,this._flatPos,this._map.transform):(u=this._lngLat)===null||u===void 0?void 0:u.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let y="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?y=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(y=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let w="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?w="rotateX(0deg)":this._pitchAlignment==="map"&&(w=`rotateX(${this._map.getPitch()}deg)`),a&&a.type!=="moveend"||(this._pos=this._pos.round()),F.setTransform(this._element,`${Qu[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${w} ${y}`),j.frameAsync(new AbortController).then(()=>{this._updateOpacity(a&&a.type==="moveend")}).catch(()=>{})},this._onMove=a=>{if(!this._isDragging){const u=this._clickTolerance||this._map._clickTolerance;this._isDragging=a.point.dist(this._pointerdownPos)>=u}this._isDragging&&(this._pos=a.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new d.k("dragstart"))),this.fire(new d.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new d.k("dragend")),this._state="inactive"},this._addDragHandler=a=>{this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(this._pos).add(this._offset),this._pointerdownPos=a.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&r.pitchAlignment!=="auto"?r.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(r==null?void 0:r.opacity,r==null?void 0:r.opacityWhenCovered),r&&r.element)this._element=r.element,this._offset=d.P.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=F.create("div");const a=F.createNS("http://www.w3.org/2000/svg","svg"),u=41,p=27;a.setAttributeNS(null,"display","block"),a.setAttributeNS(null,"height",`${u}px`),a.setAttributeNS(null,"width",`${p}px`),a.setAttributeNS(null,"viewBox",`0 0 ${p} ${u}`);const y=F.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"stroke","none"),y.setAttributeNS(null,"stroke-width","1"),y.setAttributeNS(null,"fill","none"),y.setAttributeNS(null,"fill-rule","evenodd");const w=F.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"fill-rule","nonzero");const T=F.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"transform","translate(3.0, 29.0)"),T.setAttributeNS(null,"fill","#000000");const C=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const te of C){const se=F.createNS("http://www.w3.org/2000/svg","ellipse");se.setAttributeNS(null,"opacity","0.04"),se.setAttributeNS(null,"cx","10.5"),se.setAttributeNS(null,"cy","5.80029008"),se.setAttributeNS(null,"rx",te.rx),se.setAttributeNS(null,"ry",te.ry),T.appendChild(se)}const k=F.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"fill",this._color);const M=F.createNS("http://www.w3.org/2000/svg","path");M.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),k.appendChild(M);const P=F.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"opacity","0.25"),P.setAttributeNS(null,"fill","#000000");const O=F.createNS("http://www.w3.org/2000/svg","path");O.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),P.appendChild(O);const V=F.createNS("http://www.w3.org/2000/svg","g");V.setAttributeNS(null,"transform","translate(6.0, 7.0)"),V.setAttributeNS(null,"fill","#FFFFFF");const H=F.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"transform","translate(8.0, 8.0)");const J=F.createNS("http://www.w3.org/2000/svg","circle");J.setAttributeNS(null,"fill","#000000"),J.setAttributeNS(null,"opacity","0.25"),J.setAttributeNS(null,"cx","5.5"),J.setAttributeNS(null,"cy","5.5"),J.setAttributeNS(null,"r","5.4999962");const W=F.createNS("http://www.w3.org/2000/svg","circle");W.setAttributeNS(null,"fill","#FFFFFF"),W.setAttributeNS(null,"cx","5.5"),W.setAttributeNS(null,"cy","5.5"),W.setAttributeNS(null,"r","5.4999962"),H.appendChild(J),H.appendChild(W),w.appendChild(T),w.appendChild(k),w.appendChild(P),w.appendChild(V),w.appendChild(H),a.appendChild(w),a.setAttributeNS(null,"height",u*this._scale+"px"),a.setAttributeNS(null,"width",p*this._scale+"px"),this._element.appendChild(a),this._offset=d.P.convert(r&&r.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",a=>{a.preventDefault()}),this._element.addEventListener("mousedown",a=>{a.preventDefault()}),qo(this._element,this._anchor,"marker"),r&&r.className)for(const a of r.className.split(" "))this._element.classList.add(a);this._popup=null}addTo(r){return this.remove(),this._map=r,this._element.setAttribute("aria-label",r._getUIString("Marker.Title")),r.getCanvasContainer().appendChild(this._element),r.on("move",this._update),r.on("moveend",this._update),r.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),F.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=d.M.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const p=Math.abs(13.5)/Math.SQRT2;r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[p,-1*(38.1-13.5+p)],"bottom-right":[-p,-1*(38.1-13.5+p)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=r,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const r=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:r?(r.isOpen()?r.remove():(r.setLngLat(this._lngLat),r.addTo(this._map)),this):this}_updateOpacity(r=!1){var a,u;if(!(!((a=this._map)===null||a===void 0)&&a.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(r)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const p=this._map,y=p.terrain.depthAtPoint(this._pos),w=p.terrain.getElevationForLngLatZoom(this._lngLat,p.transform.tileZoom);if(p.transform.lngLatToCameraDepth(this._lngLat,w)-y<.006)return void(this._element.style.opacity=this._opacity);const T=-this._offset.y/p.transform._pixelPerMeter,C=Math.sin(p.getPitch()*Math.PI/180)*T,k=p.terrain.depthAtPoint(new d.P(this._pos.x,this._pos.y-this._offset.y)),M=p.transform.lngLatToCameraDepth(this._lngLat,w+C)-k>.006;!((u=this._popup)===null||u===void 0)&&u.isOpen()&&M&&this._popup.remove(),this._element.style.opacity=M?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(r){return this._offset=d.P.convert(r),this._update(),this}addClassName(r){this._element.classList.add(r)}removeClassName(r){this._element.classList.remove(r)}toggleClassName(r){return this._element.classList.toggle(r)}setDraggable(r){return this._draggable=!!r,this._map&&(r?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r&&r!=="auto"?r:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(r,a){return r===void 0&&a===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),r!==void 0&&(this._opacity=r),a!==void 0&&(this._opacityWhenCovered=a),this._map&&this._updateOpacity(!0),this}}const ic={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Js=0,Qs=!1;const up={maxWidth:100,unit:"metric"};function eh(g,r,a){const u=a&&a.maxWidth||100,p=g._container.clientHeight/2,y=g.unproject([0,p]),w=g.unproject([u,p]),T=y.distanceTo(w);if(a&&a.unit==="imperial"){const C=3.2808*T;C>5280?tl(r,u,C/5280,g._getUIString("ScaleControl.Miles")):tl(r,u,C,g._getUIString("ScaleControl.Feet"))}else a&&a.unit==="nautical"?tl(r,u,T/1852,g._getUIString("ScaleControl.NauticalMiles")):T>=1e3?tl(r,u,T/1e3,g._getUIString("ScaleControl.Kilometers")):tl(r,u,T,g._getUIString("ScaleControl.Meters"))}function tl(g,r,a,u){const p=function(y){const w=Math.pow(10,`${Math.floor(y)}`.length-1);let T=y/w;return T=T>=10?10:T>=5?5:T>=3?3:T>=2?2:T>=1?1:function(C){const k=Math.pow(10,Math.ceil(-Math.log(C)/Math.LN10));return Math.round(C*k)/k}(T),w*T}(a);g.style.width=r*(p/a)+"px",g.innerHTML=`${p}&nbsp;${u}`}const eo={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},oc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function tt(g){if(g){if(typeof g=="number"){const r=Math.round(Math.abs(g)/Math.SQRT2);return{center:new d.P(0,0),top:new d.P(0,g),"top-left":new d.P(r,r),"top-right":new d.P(-r,r),bottom:new d.P(0,-g),"bottom-left":new d.P(r,-r),"bottom-right":new d.P(-r,-r),left:new d.P(g,0),right:new d.P(-g,0)}}if(g instanceof d.P||Array.isArray(g)){const r=d.P.convert(g);return{center:r,top:r,"top-left":r,"top-right":r,bottom:r,"bottom-left":r,"bottom-right":r,left:r,right:r}}return{center:d.P.convert(g.center||[0,0]),top:d.P.convert(g.top||[0,0]),"top-left":d.P.convert(g["top-left"]||[0,0]),"top-right":d.P.convert(g["top-right"]||[0,0]),bottom:d.P.convert(g.bottom||[0,0]),"bottom-left":d.P.convert(g["bottom-left"]||[0,0]),"bottom-right":d.P.convert(g["bottom-right"]||[0,0]),left:d.P.convert(g.left||[0,0]),right:d.P.convert(g.right||[0,0])}}return tt(new d.P(0,0))}const ct=L;v.AJAXError=d.bf,v.Evented=d.E,v.LngLat=d.M,v.MercatorCoordinate=d.Y,v.Point=d.P,v.addProtocol=d.bg,v.config=d.a,v.removeProtocol=d.bh,v.AttributionControl=ip,v.BoxZoomHandler=Xa,v.CanvasSource=cs,v.CooperativeGesturesHandler=gi,v.DoubleClickZoomHandler=Gu,v.DragPanHandler=Zu,v.DragRotateHandler=Ys,v.EdgeInsets=Za,v.FullscreenControl=class extends d.E{constructor(g={}){super(),this._onFullscreenChange=()=>{var r;let a=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((r=a==null?void 0:a.shadowRoot)===null||r===void 0)&&r.fullscreenElement;)a=a.shadowRoot.fullscreenElement;a===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,g&&g.container&&(g.container instanceof HTMLElement?this._container=g.container:d.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(g){return this._map=g,this._container||(this._container=this._map.getContainer()),this._controlContainer=F.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){F.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const g=this._fullscreenButton=F.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);F.create("span","maplibregl-ctrl-icon",g).setAttribute("aria-hidden","true"),g.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const g=this._getTitle();this._fullscreenButton.setAttribute("aria-label",g),this._fullscreenButton.title=g}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new d.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new d.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},v.GeoJSONSource=Rt,v.GeolocateControl=class extends d.E{constructor(g){super(),this._onSuccess=r=>{if(this._map){if(this._isOutOfMapMaxBounds(r))return this._setErrorState(),this.fire(new d.k("outofmaxbounds",r)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=r,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(r),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(r),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new d.k("geolocate",r)),this._finish()}},this._updateCamera=r=>{const a=new d.M(r.coords.longitude,r.coords.latitude),u=r.coords.accuracy,p=this._map.getBearing(),y=d.e({bearing:p},this.options.fitBoundsOptions),w=br.fromLngLat(a,u);this._map.fitBounds(w,y,{geolocateSource:!0})},this._updateMarker=r=>{if(r){const a=new d.M(r.coords.longitude,r.coords.latitude);this._accuracyCircleMarker.setLngLat(a).addTo(this._map),this._userLocationDotMarker.setLngLat(a).addTo(this._map),this._accuracy=r.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=r=>{if(this._map){if(this.options.trackUserLocation)if(r.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(r.code===3&&Qs)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new d.k("error",r)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=r=>{if(this._map){if(this._container.addEventListener("contextmenu",a=>a.preventDefault()),this._geolocateButton=F.create("button","maplibregl-ctrl-geolocate",this._container),F.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",r===!1){d.w("Geolocation support is not available so the GeolocateControl will be disabled.");const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}else{const a=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=F.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Qt({element:this._dotElement}),this._circleElement=F.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Qt({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",a=>{a.geolocateSource||this._watchState!=="ACTIVE_LOCK"||a.originalEvent&&a.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new d.k("trackuserlocationend")),this.fire(new d.k("userlocationlostfocus")))})}},this.options=d.e({},ic,g)}onAdd(g){return this._map=g,this._container=F.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(){return d._(this,arguments,void 0,function*(r=!1){if(Vo!==void 0&&!r)return Vo;if(window.navigator.permissions===void 0)return Vo=!!window.navigator.geolocation,Vo;try{Vo=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Vo=!!window.navigator.geolocation}return Vo})}().then(r=>this._setupUI(r)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),F.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Js=0,Qs=!1}_isOutOfMapMaxBounds(g){const r=this._map.getMaxBounds(),a=g.coords;return r&&(a.longitude<r.getWest()||a.longitude>r.getEast()||a.latitude<r.getSouth()||a.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const g=this._map.getBounds(),r=g.getSouthEast(),a=g.getNorthEast(),u=r.distanceTo(a),p=Math.ceil(this._accuracy/(u/this._map._container.clientHeight)*2);this._circleElement.style.width=`${p}px`,this._circleElement.style.height=`${p}px`}trigger(){if(!this._setup)return d.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new d.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Js--,Qs=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new d.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new d.k("trackuserlocationstart")),this.fire(new d.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let g;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Js++,Js>1?(g={maximumAge:6e5,timeout:0},Qs=!0):(g=this.options.positionOptions,Qs=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,g)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},v.Hash=Bu,v.ImageSource=ei,v.KeyboardHandler=Uo,v.LngLatBounds=br,v.LogoControl=Xu,v.Map=class extends gg{constructor(g){d.bd.mark(d.be.create);const r=Object.assign(Object.assign({},yg),g);if(r.minZoom!=null&&r.maxZoom!=null&&r.minZoom>r.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(r.minPitch!=null&&r.maxPitch!=null&&r.minPitch>r.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(r.minPitch!=null&&r.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(r.maxPitch!=null&&r.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Du(r.minZoom,r.maxZoom,r.minPitch,r.maxPitch,r.renderWorldCopies),{bearingSnap:r.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Qa,this._controls=[],this._mapId=d.a3(),this._contextLost=a=>{a.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new d.k("webglcontextlost",{originalEvent:a}))},this._contextRestored=a=>{this._setupPainter(),this.resize(),this._update(),this.fire(new d.k("webglcontextrestored",{originalEvent:a}))},this._onMapScroll=a=>{if(a.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=r.interactive,this._maxTileCacheSize=r.maxTileCacheSize,this._maxTileCacheZoomLevels=r.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=r.failIfMajorPerformanceCaveat===!0,this._preserveDrawingBuffer=r.preserveDrawingBuffer===!0,this._antialias=r.antialias===!0,this._trackResize=r.trackResize===!0,this._bearingSnap=r.bearingSnap,this._refreshExpiredTiles=r.refreshExpiredTiles===!0,this._fadeDuration=r.fadeDuration,this._crossSourceCollisions=r.crossSourceCollisions===!0,this._collectResourceTiming=r.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Ve),r.locale),this._clickTolerance=r.clickTolerance,this._overridePixelRatio=r.pixelRatio,this._maxCanvasSize=r.maxCanvasSize,this.transformCameraUpdate=r.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=r.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=ae.addThrottleControl(()=>this.isMoving()),this._requestManager=new xe(r.transformRequest),typeof r.container=="string"){if(this._container=document.getElementById(r.container),!this._container)throw new Error(`Container '${r.container}' not found.`)}else{if(!(r.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=r.container}if(r.maxBounds&&this.setMaxBounds(r.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)).on("moveend",()=>this._update(!1)).on("zoom",()=>this._update(!0)).on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}).once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let a=!1;const u=Kd(p=>{this._trackResize&&!this._removed&&this.resize(p)._update()},50);this._resizeObserver=new ResizeObserver(p=>{a?u(p):a=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Ja(this,r),this._hash=r.hash&&new Bu(typeof r.hash=="string"&&r.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:r.center,zoom:r.zoom,bearing:r.bearing,pitch:r.pitch}),r.bounds&&(this.resize(),this.fitBounds(r.bounds,d.e({},r.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=r.localIdeographFontFamily,this._validateStyle=r.validateStyle,r.style&&this.setStyle(r.style,{localIdeographFontFamily:r.localIdeographFontFamily}),r.attributionControl&&this.addControl(new ip(typeof r.attributionControl=="boolean"?void 0:r.attributionControl)),r.maplibreLogo&&this.addControl(new Xu,r.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",a=>{this._update(a.dataType==="style"),this.fire(new d.k(`${a.dataType}data`,a))}),this.on("dataloading",a=>{this.fire(new d.k(`${a.dataType}dataloading`,a))}),this.on("dataabort",a=>{this.fire(new d.k("sourcedataabort",a))})}_getMapId(){return this._mapId}addControl(g,r){if(r===void 0&&(r=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new d.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const a=g.onAdd(this);this._controls.push(g);const u=this._controlPositions[r];return r.indexOf("bottom")!==-1?u.insertBefore(a,u.firstChild):u.appendChild(a),this}removeControl(g){if(!g||!g.onRemove)return this.fire(new d.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(g);return r>-1&&this._controls.splice(r,1),g.onRemove(this),this}hasControl(g){return this._controls.indexOf(g)>-1}calculateCameraOptionsFromTo(g,r,a,u){return u==null&&this.terrain&&(u=this.terrain.getElevationForLngLatZoom(a,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(g,r,a,u)}resize(g){var r;const a=this._containerDimensions(),u=a[0],p=a[1],y=this._getClampedPixelRatio(u,p);if(this._resizeCanvas(u,p,y),this.painter.resize(u,p,y),this.painter.overLimit()){const T=this.painter.context.gl;this._maxCanvasSize=[T.drawingBufferWidth,T.drawingBufferHeight];const C=this._getClampedPixelRatio(u,p);this._resizeCanvas(u,p,C),this.painter.resize(u,p,C)}this.transform.resize(u,p),(r=this._requestedCameraState)===null||r===void 0||r.resize(u,p);const w=!this._moving;return w&&(this.stop(),this.fire(new d.k("movestart",g)).fire(new d.k("move",g))),this.fire(new d.k("resize",g)),w&&this.fire(new d.k("moveend",g)),this}_getClampedPixelRatio(g,r){const{0:a,1:u}=this._maxCanvasSize,p=this.getPixelRatio(),y=g*p,w=r*p;return Math.min(y>a?a/y:1,w>u?u/w:1)*p}getPixelRatio(){var g;return(g=this._overridePixelRatio)!==null&&g!==void 0?g:devicePixelRatio}setPixelRatio(g){this._overridePixelRatio=g,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(g){return this.transform.setMaxBounds(br.convert(g)),this._update()}setMinZoom(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.minZoom=g,this._update(),this.getZoom()<g&&this.setZoom(g),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(g){if((g=g??22)>=this.transform.minZoom)return this.transform.maxZoom=g,this._update(),this.getZoom()>g&&this.setZoom(g),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.minPitch=g,this._update(),this.getPitch()<g&&this.setPitch(g),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(g){if((g=g??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(g>=this.transform.minPitch)return this.transform.maxPitch=g,this._update(),this.getPitch()>g&&this.setPitch(g),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(g){return this.transform.renderWorldCopies=g,this._update()}project(g){return this.transform.locationPoint(d.M.convert(g),this.style&&this.terrain)}unproject(g){return this.transform.pointLocation(d.P.convert(g),this.terrain)}isMoving(){var g;return this._moving||((g=this.handlers)===null||g===void 0?void 0:g.isMoving())}isZooming(){var g;return this._zooming||((g=this.handlers)===null||g===void 0?void 0:g.isZooming())}isRotating(){var g;return this._rotating||((g=this.handlers)===null||g===void 0?void 0:g.isRotating())}_createDelegatedListener(g,r,a){if(g==="mouseenter"||g==="mouseover"){let u=!1;return{layer:r,listener:a,delegates:{mousemove:y=>{const w=this.getLayer(r)?this.queryRenderedFeatures(y.point,{layers:[r]}):[];w.length?u||(u=!0,a.call(this,new hn(g,this,y.originalEvent,{features:w}))):u=!1},mouseout:()=>{u=!1}}}}if(g==="mouseleave"||g==="mouseout"){let u=!1;return{layer:r,listener:a,delegates:{mousemove:w=>{(this.getLayer(r)?this.queryRenderedFeatures(w.point,{layers:[r]}):[]).length?u=!0:u&&(u=!1,a.call(this,new hn(g,this,w.originalEvent)))},mouseout:w=>{u&&(u=!1,a.call(this,new hn(g,this,w.originalEvent)))}}}}{const u=p=>{const y=this.getLayer(r)?this.queryRenderedFeatures(p.point,{layers:[r]}):[];y.length&&(p.features=y,a.call(this,p),delete p.features)};return{layer:r,listener:a,delegates:{[g]:u}}}}on(g,r,a){if(a===void 0)return super.on(g,r);const u=this._createDelegatedListener(g,r,a);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(u);for(const p in u.delegates)this.on(p,u.delegates[p]);return this}once(g,r,a){if(a===void 0)return super.once(g,r);const u=this._createDelegatedListener(g,r,a);for(const p in u.delegates)this.once(p,u.delegates[p]);return this}off(g,r,a){return a===void 0?super.off(g,r):(this._delegatedListeners&&this._delegatedListeners[g]&&(u=>{const p=this._delegatedListeners[g];for(let y=0;y<p.length;y++){const w=p[y];if(w.layer===r&&w.listener===a){for(const T in w.delegates)this.off(T,w.delegates[T]);return p.splice(y,1),this}}})(),this)}queryRenderedFeatures(g,r){if(!this.style)return[];let a;const u=g instanceof d.P||Array.isArray(g),p=u?g:[[0,0],[this.transform.width,this.transform.height]];if(r=r||(u?{}:g)||{},p instanceof d.P||typeof p[0]=="number")a=[d.P.convert(p)];else{const y=d.P.convert(p[0]),w=d.P.convert(p[1]);a=[y,new d.P(w.x,y.y),w,new d.P(y.x,w.y),y]}return this.style.queryRenderedFeatures(a,r,this.transform)}querySourceFeatures(g,r){return this.style.querySourceFeatures(g,r)}setStyle(g,r){return(r=d.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},r)).diff!==!1&&r.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&g?(this._diffStyle(g,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._updateStyle(g,r))}setTransformRequest(g){return this._requestManager.setTransformRequest(g),this}_getUIString(g){const r=this._locale[g];if(r==null)throw new Error(`Missing UI string '${g}'`);return r}_updateStyle(g,r){if(r.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(g,r));const a=this.style&&r.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!g)),g?(this.style=new kl(this,r||{}),this.style.setEventedParent(this,{style:this.style}),typeof g=="string"?this.style.loadURL(g,r,a):this.style.loadJSON(g,r,a),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new kl(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(g,r){if(typeof g=="string"){const a=this._requestManager.transformRequest(g,"Style");d.h(a,new AbortController).then(u=>{this._updateDiff(u.data,r)}).catch(u=>{u&&this.fire(new d.j(u))})}else typeof g=="object"&&this._updateDiff(g,r)}_updateDiff(g,r){try{this.style.setState(g,r)&&this._update(!0)}catch(a){d.w(`Unable to perform style diff: ${a.message||a.error||a}.  Rebuilding the style from scratch.`),this._updateStyle(g,r)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():d.w("There is no style added to the map.")}addSource(g,r){return this._lazyInitEmptyStyle(),this.style.addSource(g,r),this._update(!0)}isSourceLoaded(g){const r=this.style&&this.style.sourceCaches[g];if(r!==void 0)return r.loaded();this.fire(new d.j(new Error(`There is no source with ID '${g}'`)))}setTerrain(g){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),g){const r=this.style.sourceCaches[g.source];if(!r)throw new Error(`cannot load terrain, because there exists no source with ID: ${g.source}`);this.terrain===null&&r.reload();for(const a in this.style._layers){const u=this.style._layers[a];u.type==="hillshade"&&u.source===g.source&&d.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new op(this.painter,r,g),this.painter.renderToTexture=new sp(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=a=>{a.dataType==="style"?this.terrain.sourceCache.freeRtt():a.dataType==="source"&&a.tile&&(a.sourceId!==g.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(a.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new d.k("terrain",{terrain:g})),this}getTerrain(){var g,r;return(r=(g=this.terrain)===null||g===void 0?void 0:g.options)!==null&&r!==void 0?r:null}areTilesLoaded(){const g=this.style&&this.style.sourceCaches;for(const r in g){const a=g[r]._tiles;for(const u in a){const p=a[u];if(p.state!=="loaded"&&p.state!=="errored")return!1}}return!0}removeSource(g){return this.style.removeSource(g),this._update(!0)}getSource(g){return this.style.getSource(g)}addImage(g,r,a={}){const{pixelRatio:u=1,sdf:p=!1,stretchX:y,stretchY:w,content:T,textFitWidth:C,textFitHeight:k}=a;if(this._lazyInitEmptyStyle(),!(r instanceof HTMLImageElement||d.b(r))){if(r.width===void 0||r.height===void 0)return this.fire(new d.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:M,height:P,data:O}=r,V=r;return this.style.addImage(g,{data:new d.R({width:M,height:P},new Uint8Array(O)),pixelRatio:u,stretchX:y,stretchY:w,content:T,textFitWidth:C,textFitHeight:k,sdf:p,version:0,userImage:V}),V.onAdd&&V.onAdd(this,g),this}}{const{width:M,height:P,data:O}=j.getImageData(r);this.style.addImage(g,{data:new d.R({width:M,height:P},O),pixelRatio:u,stretchX:y,stretchY:w,content:T,textFitWidth:C,textFitHeight:k,sdf:p,version:0})}}updateImage(g,r){const a=this.style.getImage(g);if(!a)return this.fire(new d.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const u=r instanceof HTMLImageElement||d.b(r)?j.getImageData(r):r,{width:p,height:y,data:w}=u;if(p===void 0||y===void 0)return this.fire(new d.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(p!==a.data.width||y!==a.data.height)return this.fire(new d.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const T=!(r instanceof HTMLImageElement||d.b(r));return a.data.replace(w,T),this.style.updateImage(g,a),this}getImage(g){return this.style.getImage(g)}hasImage(g){return g?!!this.style.getImage(g):(this.fire(new d.j(new Error("Missing required image id"))),!1)}removeImage(g){this.style.removeImage(g)}loadImage(g){return ae.getImage(this._requestManager.transformRequest(g,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(g,r){return this._lazyInitEmptyStyle(),this.style.addLayer(g,r),this._update(!0)}moveLayer(g,r){return this.style.moveLayer(g,r),this._update(!0)}removeLayer(g){return this.style.removeLayer(g),this._update(!0)}getLayer(g){return this.style.getLayer(g)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(g,r,a){return this.style.setLayerZoomRange(g,r,a),this._update(!0)}setFilter(g,r,a={}){return this.style.setFilter(g,r,a),this._update(!0)}getFilter(g){return this.style.getFilter(g)}setPaintProperty(g,r,a,u={}){return this.style.setPaintProperty(g,r,a,u),this._update(!0)}getPaintProperty(g,r){return this.style.getPaintProperty(g,r)}setLayoutProperty(g,r,a,u={}){return this.style.setLayoutProperty(g,r,a,u),this._update(!0)}getLayoutProperty(g,r){return this.style.getLayoutProperty(g,r)}setGlyphs(g,r={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(g,r),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(g,r,a={}){return this._lazyInitEmptyStyle(),this.style.addSprite(g,r,a,u=>{u||this._update(!0)}),this}removeSprite(g){return this._lazyInitEmptyStyle(),this.style.removeSprite(g),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(g,r={}){return this._lazyInitEmptyStyle(),this.style.setSprite(g,r,a=>{a||this._update(!0)}),this}setLight(g,r={}){return this._lazyInitEmptyStyle(),this.style.setLight(g,r),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(g,r){return this.style.setFeatureState(g,r),this._update()}removeFeatureState(g,r){return this.style.removeFeatureState(g,r),this._update()}getFeatureState(g){return this.style.getFeatureState(g)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let g=0,r=0;return this._container&&(g=this._container.clientWidth||400,r=this._container.clientHeight||300),[g,r]}_setupContainer(){const g=this._container;g.classList.add("maplibregl-map");const r=this._canvasContainer=F.create("div","maplibregl-canvas-container",g);this._interactive&&r.classList.add("maplibregl-interactive"),this._canvas=F.create("canvas","maplibregl-canvas",r),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const a=this._containerDimensions(),u=this._getClampedPixelRatio(a[0],a[1]);this._resizeCanvas(a[0],a[1],u);const p=this._controlContainer=F.create("div","maplibregl-control-container",g),y=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(w=>{y[w]=F.create("div",`maplibregl-ctrl-${w} `,p)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(g,r,a){this._canvas.width=Math.floor(a*g),this._canvas.height=Math.floor(a*r),this._canvas.style.width=`${g}px`,this._canvas.style.height=`${r}px`}_setupPainter(){const g={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let r=null;this._canvas.addEventListener("webglcontextcreationerror",u=>{r={requestedAttributes:g},u&&(r.statusMessage=u.statusMessage,r.type=u.type)},{once:!0});const a=this._canvas.getContext("webgl2",g)||this._canvas.getContext("webgl",g);if(!a){const u="Failed to initialize WebGL";throw r?(r.message=u,new Error(JSON.stringify(r))):new Error(u)}this.painter=new Dt(a,this.transform),me.testSupport(a)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(g){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(g){return this._update(),this._renderTaskQueue.add(g)}_cancelRenderFrame(g){this._renderTaskQueue.remove(g)}_render(g){const r=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(g),this._removed)return;let a=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const p=this.transform.zoom,y=j.now();this.style.zoomHistory.update(p,y);const w=new d.a8(p,{now:y,fadeDuration:r,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),T=w.crossFadingFactor();T===1&&T===this._crossFadingFactor||(a=!0,this._crossFadingFactor=T),this.style.update(w)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,r,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:r,showPadding:this.showPadding}),this.fire(new d.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,d.bd.mark(d.be.load),this.fire(new d.k("load"))),this.style&&(this.style.hasTransitions()||a)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const u=this._sourcesDirty||this._styleDirty||this._placementDirty;return u||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new d.k("idle")),!this._loaded||this._fullyLoaded||u||(this._fullyLoaded=!0,d.bd.mark(d.be.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var g;this._hash&&this._hash.remove();for(const a of this._controls)a.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),ae.removeThrottleControl(this._imageQueueHandle),(g=this._resizeObserver)===null||g===void 0||g.disconnect();const r=this.painter.context.gl.getExtension("WEBGL_lose_context");r!=null&&r.loseContext&&r.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),F.remove(this._canvasContainer),F.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),d.bd.clearMetrics(),this._removed=!0,this.fire(new d.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,j.frameAsync(this._frameRequest).then(g=>{d.bd.frame(g),this._frameRequest=null,this._render(g)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._update())}get showPadding(){return!!this._showPadding}set showPadding(g){this._showPadding!==g&&(this._showPadding=g,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,g?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._update())}get repaint(){return!!this._repaint}set repaint(g){this._repaint!==g&&(this._repaint=g,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(g){this._vertices=g,this._update()}get version(){return Yu}getCameraTargetElevation(){return this.transform.elevation}},v.MapMouseEvent=hn,v.MapTouchEvent=vs,v.MapWheelEvent=Xd,v.Marker=Qt,v.NavigationControl=class{constructor(g){this._updateZoomButtons=()=>{const r=this._map.getZoom(),a=r===this._map.getMaxZoom(),u=r===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=u,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",u.toString())},this._rotateCompassArrow=()=>{const r=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=r},this._setButtonTitle=(r,a)=>{const u=this._map._getUIString(`NavigationControl.${a}`);r.title=u,r.setAttribute("aria-label",u)},this.options=d.e({},Ju,g),this._container=F.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",r=>this._map.zoomIn({},{originalEvent:r})),F.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",r=>this._map.zoomOut({},{originalEvent:r})),F.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",r=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:r}):this._map.resetNorth({},{originalEvent:r})}),this._compassIcon=F.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(g){return this._map=g,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new lp(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){F.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(g,r){const a=F.create("button",g,this._container);return a.type="button",a.addEventListener("click",r),a}},v.Popup=class extends d.E{constructor(g){super(),this.remove=()=>(this._content&&F.remove(this._content),this._container&&(F.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new d.k("close"))),this),this._onMouseUp=r=>{this._update(r.point)},this._onMouseMove=r=>{this._update(r.point)},this._onDrag=r=>{this._update(r.point)},this._update=r=>{var a;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=F.create("div","maplibregl-popup",this._map.getContainer()),this._tip=F.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const T of this.options.className.split(" "))this._container.classList.add(T);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?cp(this._lngLat,this._flatPos,this._map.transform):(a=this._lngLat)===null||a===void 0?void 0:a.wrap(),this._trackPointer&&!r)return;const u=this._flatPos=this._pos=this._trackPointer&&r?r:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&r?r:this._map.transform.locationPoint(this._lngLat));let p=this.options.anchor;const y=tt(this.options.offset);if(!p){const T=this._container.offsetWidth,C=this._container.offsetHeight;let k;k=u.y+y.bottom.y<C?["top"]:u.y>this._map.transform.height-C?["bottom"]:[],u.x<T/2?k.push("left"):u.x>this._map.transform.width-T/2&&k.push("right"),p=k.length===0?"bottom":k.join("-")}let w=u.add(y[p]);this.options.subpixelPositioning||(w=w.round()),F.setTransform(this._container,`${Qu[p]} translate(${w.x}px,${w.y}px)`),qo(this._container,p,"popup")},this._onClose=()=>{this.remove()},this.options=d.e(Object.create(eo),g)}addTo(g){return this._map&&this.remove(),this._map=g,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new d.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(g){return this._lngLat=d.M.convert(g),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(g){return this.setDOMContent(document.createTextNode(g))}setHTML(g){const r=document.createDocumentFragment(),a=document.createElement("body");let u;for(a.innerHTML=g;u=a.firstChild,u;)r.appendChild(u);return this.setDOMContent(r)}getMaxWidth(){var g;return(g=this._container)===null||g===void 0?void 0:g.style.maxWidth}setMaxWidth(g){return this.options.maxWidth=g,this._update(),this}setDOMContent(g){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=F.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(g),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(g){return this._container&&this._container.classList.add(g),this}removeClassName(g){return this._container&&this._container.classList.remove(g),this}setOffset(g){return this.options.offset=g,this._update(),this}toggleClassName(g){if(this._container)return this._container.classList.toggle(g)}setSubpixelPositioning(g){this.options.subpixelPositioning=g}_createCloseButton(){this.options.closeButton&&(this._closeButton=F.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const g=this._container.querySelector(oc);g&&g.focus()}},v.RasterDEMTileSource=ls,v.RasterTileSource=Xi,v.ScaleControl=class{constructor(g){this._onMove=()=>{eh(this._map,this._container,this.options)},this.setUnit=r=>{this.options.unit=r,eh(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},up),g)}getDefaultPosition(){return"bottom-left"}onAdd(g){return this._map=g,this._container=F.create("div","maplibregl-ctrl maplibregl-ctrl-scale",g.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){F.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},v.ScrollZoomHandler=Wu,v.Style=kl,v.TerrainControl=class{constructor(g){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=g}onAdd(g){return this._map=g,this._container=F.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=F.create("button","maplibregl-ctrl-terrain",this._container),F.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){F.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},v.TwoFingersTouchPitchHandler=qu,v.TwoFingersTouchRotateHandler=Vu,v.TwoFingersTouchZoomHandler=rc,v.TwoFingersTouchZoomRotateHandler=Ku,v.VectorTileSource=be,v.VideoSource=Fo,v.addSourceType=(g,r)=>d._(void 0,void 0,void 0,function*(){if(Tn(g))throw new Error(`A source type called "${g}" already exists.`);((a,u)=>{ki[a]=u})(g,r)}),v.clearPrewarmedResources=function(){const g=Kr;g&&(g.isPreloaded()&&g.numActive()===1?(g.release(Lt),Kr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},v.getMaxParallelImageRequests=function(){return d.a.MAX_PARALLEL_IMAGE_REQUESTS},v.getRTLTextPluginStatus=function(){return ht().getRTLTextPluginStatus()},v.getVersion=function(){return ct},v.getWorkerCount=function(){return Zr.workerCount},v.getWorkerUrl=function(){return d.a.WORKER_URL},v.importScriptInWorkers=function(g){return un().broadcast("IS",g)},v.prewarm=function(){Xr().acquire(Lt)},v.setMaxParallelImageRequests=function(g){d.a.MAX_PARALLEL_IMAGE_REQUESTS=g},v.setRTLTextPlugin=function(g,r){return ht().setRTLTextPlugin(g,r)},v.setWorkerCount=function(g){Zr.workerCount=g},v.setWorkerUrl=function(g){d.a.WORKER_URL=g}});var x=s;return x})})(xT);var G_=xT.exports;const Yt=e0(G_);var _v={exports:{}},Xc=typeof Reflect=="object"?Reflect:null,Kb=Xc&&typeof Xc.apply=="function"?Xc.apply:function(n,s,c){return Function.prototype.apply.call(n,s,c)},Sf;Xc&&typeof Xc.ownKeys=="function"?Sf=Xc.ownKeys:Object.getOwnPropertySymbols?Sf=function(n){return Object.getOwnPropertyNames(n).concat(Object.getOwnPropertySymbols(n))}:Sf=function(n){return Object.getOwnPropertyNames(n)};function LL(e){console&&console.warn&&console.warn(e)}var wT=Number.isNaN||function(n){return n!==n};function cr(){cr.init.call(this)}_v.exports=cr;_v.exports.once=FL;cr.EventEmitter=cr;cr.prototype._events=void 0;cr.prototype._eventsCount=0;cr.prototype._maxListeners=void 0;var Xb=10;function Xm(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(cr,"defaultMaxListeners",{enumerable:!0,get:function(){return Xb},set:function(e){if(typeof e!="number"||e<0||wT(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");Xb=e}});cr.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};cr.prototype.setMaxListeners=function(n){if(typeof n!="number"||n<0||wT(n))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+n+".");return this._maxListeners=n,this};function ST(e){return e._maxListeners===void 0?cr.defaultMaxListeners:e._maxListeners}cr.prototype.getMaxListeners=function(){return ST(this)};cr.prototype.emit=function(n){for(var s=[],c=1;c<arguments.length;c++)s.push(arguments[c]);var f=n==="error",x=this._events;if(x!==void 0)f=f&&x.error===void 0;else if(!f)return!1;if(f){var v;if(s.length>0&&(v=s[0]),v instanceof Error)throw v;var d=new Error("Unhandled error."+(v?" ("+v.message+")":""));throw d.context=v,d}var L=x[n];if(L===void 0)return!1;if(typeof L=="function")Kb(L,this,s);else for(var U=L.length,Z=kT(L,U),c=0;c<U;++c)Kb(Z[c],this,s);return!0};function TT(e,n,s,c){var f,x,v;if(Xm(s),x=e._events,x===void 0?(x=e._events=Object.create(null),e._eventsCount=0):(x.newListener!==void 0&&(e.emit("newListener",n,s.listener?s.listener:s),x=e._events),v=x[n]),v===void 0)v=x[n]=s,++e._eventsCount;else if(typeof v=="function"?v=x[n]=c?[s,v]:[v,s]:c?v.unshift(s):v.push(s),f=ST(e),f>0&&v.length>f&&!v.warned){v.warned=!0;var d=new Error("Possible EventEmitter memory leak detected. "+v.length+" "+String(n)+" listeners added. Use emitter.setMaxListeners() to increase limit");d.name="MaxListenersExceededWarning",d.emitter=e,d.type=n,d.count=v.length,LL(d)}return e}cr.prototype.addListener=function(n,s){return TT(this,n,s,!1)};cr.prototype.on=cr.prototype.addListener;cr.prototype.prependListener=function(n,s){return TT(this,n,s,!0)};function RL(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function CT(e,n,s){var c={fired:!1,wrapFn:void 0,target:e,type:n,listener:s},f=RL.bind(c);return f.listener=s,c.wrapFn=f,f}cr.prototype.once=function(n,s){return Xm(s),this.on(n,CT(this,n,s)),this};cr.prototype.prependOnceListener=function(n,s){return Xm(s),this.prependListener(n,CT(this,n,s)),this};cr.prototype.removeListener=function(n,s){var c,f,x,v,d;if(Xm(s),f=this._events,f===void 0)return this;if(c=f[n],c===void 0)return this;if(c===s||c.listener===s)--this._eventsCount===0?this._events=Object.create(null):(delete f[n],f.removeListener&&this.emit("removeListener",n,c.listener||s));else if(typeof c!="function"){for(x=-1,v=c.length-1;v>=0;v--)if(c[v]===s||c[v].listener===s){d=c[v].listener,x=v;break}if(x<0)return this;x===0?c.shift():DL(c,x),c.length===1&&(f[n]=c[0]),f.removeListener!==void 0&&this.emit("removeListener",n,d||s)}return this};cr.prototype.off=cr.prototype.removeListener;cr.prototype.removeAllListeners=function(n){var s,c,f;if(c=this._events,c===void 0)return this;if(c.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):c[n]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete c[n]),this;if(arguments.length===0){var x=Object.keys(c),v;for(f=0;f<x.length;++f)v=x[f],v!=="removeListener"&&this.removeAllListeners(v);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(s=c[n],typeof s=="function")this.removeListener(n,s);else if(s!==void 0)for(f=s.length-1;f>=0;f--)this.removeListener(n,s[f]);return this};function IT(e,n,s){var c=e._events;if(c===void 0)return[];var f=c[n];return f===void 0?[]:typeof f=="function"?s?[f.listener||f]:[f]:s?BL(f):kT(f,f.length)}cr.prototype.listeners=function(n){return IT(this,n,!0)};cr.prototype.rawListeners=function(n){return IT(this,n,!1)};cr.listenerCount=function(e,n){return typeof e.listenerCount=="function"?e.listenerCount(n):ET.call(e,n)};cr.prototype.listenerCount=ET;function ET(e){var n=this._events;if(n!==void 0){var s=n[e];if(typeof s=="function")return 1;if(s!==void 0)return s.length}return 0}cr.prototype.eventNames=function(){return this._eventsCount>0?Sf(this._events):[]};function kT(e,n){for(var s=new Array(n),c=0;c<n;++c)s[c]=e[c];return s}function DL(e,n){for(;n+1<e.length;n++)e[n]=e[n+1];e.pop()}function BL(e){for(var n=new Array(e.length),s=0;s<n.length;++s)n[s]=e[s].listener||e[s];return n}function FL(e,n){return new Promise(function(s,c){function f(v){e.removeListener(n,x),c(v)}function x(){typeof e.removeListener=="function"&&e.removeListener("error",f),s([].slice.call(arguments))}AT(e,n,x,{once:!0}),n!=="error"&&OL(e,f,{once:!0})})}function OL(e,n,s){typeof e.on=="function"&&AT(e,"error",n,s)}function AT(e,n,s,c){if(typeof e.on=="function")c.once?e.once(n,s):e.on(n,s);else if(typeof e.addEventListener=="function")e.addEventListener(n,function f(x){c.once&&e.removeEventListener(n,f),s(x)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}var NL=_v.exports;const $L=e0(NL);function UL(){return typeof self<"u"?fetch.bind(self):typeof global<"u"&&global.fetch?global.fetch:null}class jL{constructor(){this._apiKey="",this._fetch=UL(),this.tileCacheSize=200}set apiKey(n){this._apiKey=n}get apiKey(){return this._apiKey}set fetch(n){this._fetch=n}get fetch(){return this._fetch}}const Yc=new jL,VL={AUTO:"auto",ALBANIAN:"sq",ARABIC:"ar",ARMENIAN:"hy",AZERBAIJANI:"az",BELORUSSIAN:"be",BOSNIAN:"bs",BRETON:"br",BULGARIAN:"bg",CATALAN:"ca",CHINESE:"zh",CROATIAN:"hr",CZECH:"cs",DANISH:"da",DUTCH:"nl",ENGLISH:"en",ESPERANTO:"eo",ESTONIAN:"et",FINNISH:"fi",FRENCH:"fr",FRISIAN:"fy",GEORGIAN:"ka",GERMAN:"de",GREEK:"el",HEBREW:"he",HUNGARIAN:"hu",ICELANDIC:"is",IRISH:"ga",ITALIAN:"it",JAPANESE:"ja",KANNADA:"kn",KAZAKH:"kk",KOREAN:"ko",ROMAN_LATIN:"la",LATVIAN:"lv",LITHUANIAN:"lt",LUXEMBOURGISH:"lb",MACEDONIAN:"mk",MALTESE:"mt",NORWEGIAN:"no",POLISH:"pl",PORTUGUESE:"pt",ROMANIAN:"ro",ROMANSH:"rm",RUSSIAN:"ru",SCOTTISH_GAELIC:"gd",SERBIAN_CYRILLIC:"sr",SLOVAK:"sk",SLOVENE:"sl",SPANISH:"es",SWEDISH:"sv",THAI:"th",TURKISH:"tr",UKRAINIAN:"uk",WELSH:"cy"};new Set(Object.values(VL));async function qL(e,n={}){if(Yc.fetch===null)throw new Error("The fetch function was not found. If on NodeJS < 18 please specify the fetch function with config.fetch");if(new URL(e).searchParams.get("key").trim()==="")throw new Error("The MapTiler Cloud API key is missing. Set it in `config.apiKey` or get one for free at https://maptiler.com");return Yc.fetch(e,n)}const PT={maptilerApiURL:"https://api.maptiler.com/",mapStyle:"streets-v2"};Object.freeze(PT);class HL extends Error{constructor(n,s=""){super(`Call to enpoint ${n.url} failed with the status code ${n.status}. ${s}`),this.res=n}}const Yb={403:"Key is missing, invalid or restricted"};async function WL(e={}){const n=new URL("geolocation/ip.json",PT.maptilerApiURL);n.searchParams.set("key",e.apiKey??Yc.apiKey);const s=n.toString(),c=await qL(s);if(!c.ok)throw new HL(c,c.status in Yb?Yb[c.status]:"");return await c.json()}const Jb={info:WL};function MT(e){const n=/^maptiler:\/\/(.*)/;let s;const c=e.trim();let f;return c.startsWith("http://")||c.startsWith("https://")?f=c:(s=n.exec(c))!==null?f=`https://api.maptiler.com/maps/${s[1]}/style.json`:f=`https://api.maptiler.com/maps/${c}/style.json`,f}class zT{constructor(n,s,c,f,x,v){this.name=n,this.variantType=s,this.id=c,this.referenceStyle=f,this.description=x,this.imageURL=v}getName(){return this.name}getFullName(){return`${this.referenceStyle.getName()} ${this.name}`}getType(){return this.variantType}getId(){return this.id}getDescription(){return this.description}getReferenceStyle(){return this.referenceStyle}hasVariant(n){return this.referenceStyle.hasVariant(n)}getVariant(n){return this.referenceStyle.getVariant(n)}getVariants(){return this.referenceStyle.getVariants().filter(n=>n!==this)}getImageURL(){return this.imageURL}getExpandedStyleURL(){return MT(this.getId())}}class LT{constructor(n,s){this.name=n,this.id=s,this.variants={},this.orderedVariants=[]}getName(){return this.name}getId(){return this.id}addVariant(n){this.variants[n.getType()]=n,this.orderedVariants.push(n)}hasVariant(n){return n in this.variants}getVariant(n){return n in this.variants?this.variants[n]:this.orderedVariants[0]}getVariants(){return Object.values(this.variants)}getDefaultVariant(){return this.orderedVariants[0]}}const Z_=[{referenceStyleID:"STREETS",name:"Streets",description:"",variants:[{id:"streets-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"streets-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"streets-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"streets-v2-night",name:"Night",variantType:"NIGHT",description:"",imageURL:""},{id:"streets-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OUTDOOR",name:"Outdoor",description:"",variants:[{id:"outdoor-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"outdoor-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"WINTER",name:"Winter",description:"",variants:[{id:"winter-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"winter-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"SATELLITE",name:"Satellite",description:"",variants:[{id:"satellite",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"HYBRID",name:"Hybrid",description:"",variants:[{id:"hybrid",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"BASIC",name:"Basic",description:"",variants:[{id:"basic-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"basic-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"basic-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BRIGHT",name:"Bright",description:"",variants:[{id:"bright-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"bright-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"bright-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"bright-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OPENSTREETMAP",name:"OpenStreetMap",description:"",variants:[{id:"openstreetmap",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"TOPO",name:"Topo",description:"",variants:[{id:"topo-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"topo-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"topo-v2-shiny",name:"Shiny",variantType:"SHINY",description:"",imageURL:""},{id:"topo-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""},{id:"topo-v2-topographique",name:"Topographique",variantType:"TOPOGRAPHIQUE",description:"",imageURL:""}]},{referenceStyleID:"VOYAGER",name:"Voyager",description:"",variants:[{id:"voyager-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"voyager-v2-darkmatter",name:"Darkmatter",variantType:"DARK",description:"",imageURL:""},{id:"voyager-v2-positron",name:"Positron",variantType:"LIGHT",description:"",imageURL:""},{id:"voyager-v2-vintage",name:"Vintage",variantType:"VINTAGE",description:"",imageURL:""}]},{referenceStyleID:"TONER",name:"Toner",description:"",variants:[{id:"toner-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"toner-v2-background",name:"Background",variantType:"BACKGROUND",description:"",imageURL:""},{id:"toner-v2-lite",name:"Lite",variantType:"LITE",description:"",imageURL:""},{id:"toner-v2-lines",name:"Lines",variantType:"LINES",description:"",imageURL:""}]},{referenceStyleID:"DATAVIZ",name:"Dataviz",description:"",variants:[{id:"dataviz",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"dataviz-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"dataviz-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BACKDROP",name:"Backdrop",description:"",variants:[{id:"backdrop",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"backdrop-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"backdrop-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"OCEAN",name:"Ocean",description:"",variants:[{id:"ocean",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]}];function GL(e){return new Proxy(e,{get(n,s,c){return n.hasVariant(s)?n.getVariant(s):s.toString().toUpperCase()===s?e.getDefaultVariant():Reflect.get(n,s,c)}})}function ZL(){const e={};for(let n=0;n<Z_.length;n+=1){const s=Z_[n],c=GL(new LT(s.name,s.referenceStyleID));for(let f=0;f<s.variants.length;f+=1){const x=s.variants[f],v=new zT(x.name,x.variantType,x.id,c,x.description,x.imageURL);c.addVariant(v)}e[s.referenceStyleID]=c}return e}const RT=ZL();let rf;const KL=new Uint8Array(16);function XL(){if(!rf&&(rf=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!rf))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return rf(KL)}const Mn=[];for(let e=0;e<256;++e)Mn.push((e+256).toString(16).slice(1));function YL(e,n=0){return Mn[e[n+0]]+Mn[e[n+1]]+Mn[e[n+2]]+Mn[e[n+3]]+"-"+Mn[e[n+4]]+Mn[e[n+5]]+"-"+Mn[e[n+6]]+Mn[e[n+7]]+"-"+Mn[e[n+8]]+Mn[e[n+9]]+"-"+Mn[e[n+10]]+Mn[e[n+11]]+Mn[e[n+12]]+Mn[e[n+13]]+Mn[e[n+14]]+Mn[e[n+15]]}const JL=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Qb={randomUUID:JL};function QL(e,n,s){if(Qb.randomUUID&&!n&&!e)return Qb.randomUUID();e=e||{};const c=e.random||(e.rng||XL)();return c[6]=c[6]&15|64,c[8]=c[8]&63|128,YL(c)}const DT="3.7.7",e3=DT,pu=typeof Buffer=="function",ew=typeof TextDecoder=="function"?new TextDecoder:void 0,tw=typeof TextEncoder=="function"?new TextEncoder:void 0,t3="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Oh=Array.prototype.slice.call(t3),nf=(e=>{let n={};return e.forEach((s,c)=>n[s]=c),n})(Oh),r3=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,Ln=String.fromCharCode.bind(String),rw=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):e=>new Uint8Array(Array.prototype.slice.call(e,0)),BT=e=>e.replace(/=/g,"").replace(/[+\/]/g,n=>n=="+"?"-":"_"),FT=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),OT=e=>{let n,s,c,f,x="";const v=e.length%3;for(let d=0;d<e.length;){if((s=e.charCodeAt(d++))>255||(c=e.charCodeAt(d++))>255||(f=e.charCodeAt(d++))>255)throw new TypeError("invalid character found");n=s<<16|c<<8|f,x+=Oh[n>>18&63]+Oh[n>>12&63]+Oh[n>>6&63]+Oh[n&63]}return v?x.slice(0,v-3)+"===".substring(v):x},vv=typeof btoa=="function"?e=>btoa(e):pu?e=>Buffer.from(e,"binary").toString("base64"):OT,K_=pu?e=>Buffer.from(e).toString("base64"):e=>{let s=[];for(let c=0,f=e.length;c<f;c+=4096)s.push(Ln.apply(null,e.subarray(c,c+4096)));return vv(s.join(""))},Tf=(e,n=!1)=>n?BT(K_(e)):K_(e),n3=e=>{if(e.length<2){var n=e.charCodeAt(0);return n<128?e:n<2048?Ln(192|n>>>6)+Ln(128|n&63):Ln(224|n>>>12&15)+Ln(128|n>>>6&63)+Ln(128|n&63)}else{var n=65536+(e.charCodeAt(0)-55296)*1024+(e.charCodeAt(1)-56320);return Ln(240|n>>>18&7)+Ln(128|n>>>12&63)+Ln(128|n>>>6&63)+Ln(128|n&63)}},i3=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,NT=e=>e.replace(i3,n3),nw=pu?e=>Buffer.from(e,"utf8").toString("base64"):tw?e=>K_(tw.encode(e)):e=>vv(NT(e)),Jc=(e,n=!1)=>n?BT(nw(e)):nw(e),iw=e=>Jc(e,!0),o3=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,s3=e=>{switch(e.length){case 4:var n=(7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3),s=n-65536;return Ln((s>>>10)+55296)+Ln((s&1023)+56320);case 3:return Ln((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return Ln((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},$T=e=>e.replace(o3,s3),UT=e=>{if(e=e.replace(/\s+/g,""),!r3.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(e.length&3));let n,s="",c,f;for(let x=0;x<e.length;)n=nf[e.charAt(x++)]<<18|nf[e.charAt(x++)]<<12|(c=nf[e.charAt(x++)])<<6|(f=nf[e.charAt(x++)]),s+=c===64?Ln(n>>16&255):f===64?Ln(n>>16&255,n>>8&255):Ln(n>>16&255,n>>8&255,n&255);return s},xv=typeof atob=="function"?e=>atob(FT(e)):pu?e=>Buffer.from(e,"base64").toString("binary"):UT,jT=pu?e=>rw(Buffer.from(e,"base64")):e=>rw(xv(e).split("").map(n=>n.charCodeAt(0))),VT=e=>jT(qT(e)),a3=pu?e=>Buffer.from(e,"base64").toString("utf8"):ew?e=>ew.decode(jT(e)):e=>$T(xv(e)),qT=e=>FT(e.replace(/[-_]/g,n=>n=="-"?"+":"/")),X_=e=>a3(qT(e)),l3=e=>{if(typeof e!="string")return!1;const n=e.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(n)||!/[^\s0-9a-zA-Z\-_]/.test(n)},HT=e=>({value:e,enumerable:!1,writable:!0,configurable:!0}),WT=function(){const e=(n,s)=>Object.defineProperty(String.prototype,n,HT(s));e("fromBase64",function(){return X_(this)}),e("toBase64",function(n){return Jc(this,n)}),e("toBase64URI",function(){return Jc(this,!0)}),e("toBase64URL",function(){return Jc(this,!0)}),e("toUint8Array",function(){return VT(this)})},GT=function(){const e=(n,s)=>Object.defineProperty(Uint8Array.prototype,n,HT(s));e("toBase64",function(n){return Tf(this,n)}),e("toBase64URI",function(){return Tf(this,!0)}),e("toBase64URL",function(){return Tf(this,!0)})},c3=()=>{WT(),GT()},u3={version:DT,VERSION:e3,atob:xv,atobPolyfill:UT,btoa:vv,btoaPolyfill:OT,fromBase64:X_,toBase64:Jc,encode:Jc,encodeURI:iw,encodeURL:iw,utob:NT,btou:$T,decode:X_,isValid:l3,fromUint8Array:Tf,toUint8Array:VT,extendString:WT,extendUint8Array:GT,extendBuiltins:c3},Ut={VISITOR:"visitor",VISITOR_ENGLISH:"visitor_en",STYLE:"style",AUTO:"auto",STYLE_LOCK:"style_lock",LATIN:"name:latin",NON_LATIN:"name:nonlatin",LOCAL:"name",INTERNATIONAL:"name_int",ALBANIAN:"name:sq",AMHARIC:"name:am",ARABIC:"name:ar",ARMENIAN:"name:hy",AZERBAIJANI:"name:az",BASQUE:"name:eu",BELORUSSIAN:"name:be",BENGALI:"name:bn",BOSNIAN:"name:bs",BRETON:"name:br",BULGARIAN:"name:bg",CATALAN:"name:ca",CHINESE:"name:zh",TRADITIONAL_CHINESE:"name:zh-Hant",SIMPLIFIED_CHINESE:"name:zh-Hans",CORSICAN:"name:co",CROATIAN:"name:hr",CZECH:"name:cs",DANISH:"name:da",DUTCH:"name:nl",ENGLISH:"name:en",ESPERANTO:"name:eo",ESTONIAN:"name:et",FINNISH:"name:fi",FRENCH:"name:fr",FRISIAN:"name:fy",GEORGIAN:"name:ka",GERMAN:"name:de",GREEK:"name:el",HEBREW:"name:he",HINDI:"name:hi",HUNGARIAN:"name:hu",ICELANDIC:"name:is",INDONESIAN:"name:id",IRISH:"name:ga",ITALIAN:"name:it",JAPANESE:"name:ja",JAPANESE_HIRAGANA:"name:ja-Hira",JAPANESE_KANA:"name:ja_kana",JAPANESE_LATIN:"name:ja_rm",JAPANESE_2018:"name:ja-Latn",KANNADA:"name:kn",KAZAKH:"name:kk",KOREAN:"name:ko",KOREAN_LATIN:"name:ko-Latn",KURDISH:"name:ku",ROMAN_LATIN:"name:la",LATVIAN:"name:lv",LITHUANIAN:"name:lt",LUXEMBOURGISH:"name:lb",MACEDONIAN:"name:mk",MALAYALAM:"name:ml",MALTESE:"name:mt",NORWEGIAN:"name:no",OCCITAN:"name:oc",PERSIAN:"name:fa",POLISH:"name:pl",PORTUGUESE:"name:pt",PUNJABI:"name:pa",WESTERN_PUNJABI:"name:pnb",ROMANIAN:"name:ro",ROMANSH:"name:rm",RUSSIAN:"name:ru",SCOTTISH_GAELIC:"name:gd",SERBIAN_CYRILLIC:"name:sr",SERBIAN_LATIN:"name:sr-Latn",SLOVAK:"name:sk",SLOVENE:"name:sl",SPANISH:"name:es",SWEDISH:"name:sv",TAMIL:"name:ta",TELUGU:"name:te",THAI:"name:th",TURKISH:"name:tr",UKRAINIAN:"name:uk",URDU:"name:ur",VIETNAMIAN_LATIN:"name:vi",WELSH:"name:cy"},h3=new Set(Object.values(Ut));function ow(e){return h3.has(e)}const d3=new Set(Object.values(Ut));function sw(){if(typeof navigator>"u")return`name:${Intl.DateTimeFormat().resolvedOptions().locale.split("-")[0]}`;const e=Array.from(new Set(navigator.languages.map(n=>`name:${n.split("-")[0]}`))).filter(n=>d3.has(n));return e.length?e[0]:Ut.LOCAL}const xi={maptilerLogoURL:"https://api.maptiler.com/resources/logo.svg",maptilerURL:"https://www.maptiler.com/",maptilerApiHost:"api.maptiler.com",rtlPluginURL:"https://cdn.maptiler.com/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.min.js",primaryLanguage:Ut.STYLE,secondaryLanguage:Ut.LOCAL,terrainSourceURL:"https://api.maptiler.com/tiles/terrain-rgb-v2/tiles.json",terrainSourceId:"maptiler-terrain"};Object.freeze(xi);const ZT=QL();class p3 extends $L{constructor(){super(...arguments),this.primaryLanguage=xi.primaryLanguage,this.session=!0,this.caching=!0,this._unit="metric",this._apiKey=""}set unit(n){this._unit=n,this.emit("unit",n)}get unit(){return this._unit}set apiKey(n){this._apiKey=n,Yc.apiKey=n,this.emit("apiKey",n)}get apiKey(){return this._apiKey}set fetch(n){Yc.fetch=n}get fetch(){return Yc.fetch}}const vi=new p3,Y_="localcache_source",J_="localcache",f3="maptiler_sdk",m3=1e3,g3=100,Q_=typeof caches<"u";function y3(e,n){if(Q_&&vi.caching&&vi.session&&e.host===xi.maptilerApiHost){if(n==="Source"&&e.href.includes("tiles.json"))return e.href.replace("https://",`${Y_}://`);if(n==="Tile"||n==="Glyphs")return e.href.replace("https://",`${J_}://`)}return e.href}let $y;async function KT(){return $y||($y=await caches.open(f3)),$y}let aw=0;async function _3(){const e=await KT(),n=await e.keys(),s=n.slice(0,Math.max(n.length-m3,0));for(const c of s)e.delete(c)}function v3(){G_.addProtocol(Y_,async(e,n)=>{if(!e.url)throw new Error("");e.url=e.url.replace(`${Y_}://`,"https://");const s=e;s.signal=n.signal;const c=await fetch(e.url,s),f=await c.json();return f.tiles&&f.tiles.length>0&&(f.tiles[0]+=`&last-modified=${c.headers.get("Last-Modified")}`),{data:f,cacheControl:c.headers.get("Cache-Control"),expires:c.headers.get("Expires")}}),G_.addProtocol(J_,async(e,n)=>{if(!e.url)throw new Error("");e.url=e.url.replace(`${J_}://`,"https://");const s=new URL(e.url),c=new URL(s);c.searchParams.delete("mtsid"),c.searchParams.delete("key");const f=c.toString(),x=new URL(s);x.searchParams.delete("last-modified");const v=x.toString(),d=async F=>({data:await F.arrayBuffer(),cacheControl:F.headers.get("Cache-Control"),expires:F.headers.get("Expires")}),L=await KT(),U=await L.match(f);if(U)return d(U);const Z=e;Z.signal=n.signal;const j=await fetch(v,Z);return j.status>=200&&j.status<300&&(L.put(f,j.clone()).catch(()=>{}),++aw>g3&&(_3(),aw=0)),d(j)})}function x3(){if(typeof window>"u")return;const e=Yt.getRTLTextPluginStatus();if(e==="unavailable"||e==="requested")try{Yt.setRTLTextPlugin(xi.rtlPluginURL,!0)}catch{}}function b3(e,n){for(const s of e)typeof n[s]=="function"&&(n[s]=n[s].bind(n))}function xa(e,n,s){const c=window.document.createElement(e);return n!==void 0&&(c.className=n),s&&s.appendChild(c),c}function XT(e){e.parentNode&&e.parentNode.removeChild(e)}function lw(e,n){let s=null;try{s=new URL(e)}catch{return{url:e}}return s.host===xi.maptilerApiHost&&(s.searchParams.has("key")||s.searchParams.append("key",vi.apiKey),vi.session&&s.searchParams.append("mtsid",ZT)),{url:y3(s,n)}}function cw(e){return(n,s)=>{if(e!=null){const c=e(n,s),f=lw((c==null?void 0:c.url)??"",s);return{...c,...f}}return lw(n,s)}}function w3(){return document.createElement("canvas").getContext("webgl2")?null:typeof WebGL2RenderingContext<"u"?"Graphic rendering with WebGL2 has been disabled or is not supported by your graphic card. The map cannot be displayed.":"Your browser does not support graphic rendering with WebGL2. The map cannot be displayed."}function S3(e){const n=w3();if(!n)return;let s=null;if(typeof e=="string"?s=document.getElementById(e):e instanceof HTMLElement&&(s=e),!s)throw new Error("The Map container must be provided.");const c=document.createElement("div");throw c.innerHTML=n,c.classList.add("no-webgl-support-div"),s.appendChild(c),new Error(n)}let T3=class extends Yt.Marker{addTo(n){return super.addTo(n)}};class V3 extends Yt.Popup{addTo(n){return super.addTo(n)}}class q3 extends Yt.Style{constructor(n,s={}){super(n,s)}}class H3 extends Yt.CanvasSource{onAdd(n){super.onAdd(n)}}class W3 extends Yt.GeoJSONSource{onAdd(n){super.onAdd(n)}}class G3 extends Yt.ImageSource{onAdd(n){super.onAdd(n)}}class Z3 extends Yt.RasterTileSource{onAdd(n){super.onAdd(n)}}class K3 extends Yt.RasterDEMTileSource{onAdd(n){super.onAdd(n)}}class X3 extends Yt.VectorTileSource{onAdd(n){super.onAdd(n)}}class Y3 extends Yt.VideoSource{onAdd(n){super.onAdd(n)}}class C3 extends Yt.NavigationControl{onAdd(n){return super.onAdd(n)}}class I3 extends Yt.GeolocateControl{onAdd(n){return super.onAdd(n)}}class J3 extends Yt.AttributionControl{onAdd(n){return super.onAdd(n)}}class E3 extends Yt.LogoControl{onAdd(n){return super.onAdd(n)}}class k3 extends Yt.ScaleControl{onAdd(n){return super.onAdd(n)}}class A3 extends Yt.FullscreenControl{onAdd(n){return super.onAdd(n)}}class Q3 extends Yt.TerrainControl{onAdd(n){return super.onAdd(n)}}class eR extends Yt.BoxZoomHandler{constructor(n,s){super(n,s)}}class tR extends Yt.ScrollZoomHandler{constructor(n,s){super(n,s)}}class rR extends Yt.CooperativeGesturesHandler{constructor(n,s){super(n,s)}}class nR extends Yt.KeyboardHandler{constructor(n){super(n)}}class iR extends Yt.TwoFingersTouchPitchHandler{constructor(n){super(n)}}class oR extends Yt.MapWheelEvent{constructor(n,s,c){super(n,s,c)}}class sR extends Yt.MapTouchEvent{constructor(n,s,c){super(n,s,c)}}class aR extends Yt.MapMouseEvent{constructor(n,s,c,f={}){super(n,s,c,f)}}class uw extends E3{constructor(n={}){super(n),this.logoURL="",this.linkURL="",this.logoURL=n.logoURL??xi.maptilerLogoURL,this.linkURL=n.linkURL??xi.maptilerURL}onAdd(n){this._map=n,this._compact=this.options.compact??!1,this._container=window.document.createElement("div"),this._container.className="maplibregl-ctrl";const s=window.document.createElement("a");return s.style.backgroundRepeat="no-repeat",s.style.cursor="pointer",s.style.display="block",s.style.height="23px",s.style.margin="0 0 -4px -4px",s.style.overflow="hidden",s.style.width="88px",s.style.backgroundImage=`url(${this.logoURL})`,s.style.backgroundSize="100px 30px",s.style.width="100px",s.style.height="30px",s.target="_blank",s.rel="noopener",s.href=this.linkURL,s.setAttribute("aria-label","MapTiler logo"),s.setAttribute("rel","noopener"),this._container.appendChild(s),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}}function hw(e){return e?typeof e=="string"||e instanceof String?!e.startsWith("http")&&e.toLowerCase().includes(".json")?e:MT(e):e instanceof zT?e.getExpandedStyleURL():e instanceof LT?e.getDefaultVariant().getExpandedStyleURL():e:RT[Z_[0].referenceStyleID].getDefaultVariant().getExpandedStyleURL()}class P3{constructor(){b3(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(n){return this._map=n,this._container=xa("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=xa("button","maplibregl-ctrl-terrain",this._container),xa("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){XT(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.hasTerrain()?this._map.disableTerrain():this._map.enableTerrain(),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.hasTerrain()?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))}}class M3 extends C3{constructor(){super({showCompass:!0,showZoom:!0,visualizePitch:!0}),this._rotateCompassArrow=()=>{const n=this.options.visualizePitch?`scale(${Math.min(1.5,1/Math.cos(this._map.transform.pitch*(Math.PI/180))**.5)}) rotateX(${Math.min(70,this._map.transform.pitch)}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=n},this._compass.removeEventListener("click",this._compass.clickFunction),this._compass.addEventListener("click",n=>{this._map.getPitch()===0?this._map.easeTo({pitch:Math.min(this._map.getMaxPitch(),80)}):this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:n}):this._map.resetNorth({},{originalEvent:n})})}_createButton(n,s){const c=super._createButton(n,s);return c.clickFunction=s,c}}const dw=Yt.Marker,pw=Yt.LngLat,z3=Yt.LngLatBounds;class L3 extends I3{constructor(){super(...arguments),this.lastUpdatedCenter=new pw(0,0),this._updateCamera=n=>{var U,Z;const s=new pw(n.coords.longitude,n.coords.latitude),c=n.coords.accuracy,x={bearing:this._map.getBearing(),...this.options.fitBoundsOptions,linear:!0},v=this._map.getZoom();v>(((Z=(U=this.options)==null?void 0:U.fitBoundsOptions)==null?void 0:Z.maxZoom)??30)&&(x.zoom=v),this._map.fitBounds(z3.fromLngLat(s,c),x,{geolocateSource:!0});let d=!1;const L=()=>{d=!0};this._map.once("click",L),this._map.once("dblclick",L),this._map.once("dragstart",L),this._map.once("mousedown",L),this._map.once("touchstart",L),this._map.once("wheel",L),this._map.once("moveend",()=>{this._map.off("click",L),this._map.off("dblclick",L),this._map.off("dragstart",L),this._map.off("mousedown",L),this._map.off("touchstart",L),this._map.off("wheel",L),!d&&(this.lastUpdatedCenter=this._map.getCenter())})},this._setupUI=n=>{if(this.lastUpdatedCenter=this._map.getCenter(),this._container.addEventListener("contextmenu",s=>s.preventDefault()),this._geolocateButton=xa("button","maplibregl-ctrl-geolocate",this._container),xa("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",n===!1){const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s)}else{const s=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=s,this._geolocateButton.setAttribute("aria-label",s)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=xa("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new dw({element:this._dotElement}),this._circleElement=xa("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new dw({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("move",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("moveend",s=>{const c=s.originalEvent&&s.originalEvent.type==="resize",f=this.lastUpdatedCenter.distanceTo(this._map.getCenter());!s.geolocateSource&&this._watchState==="ACTIVE_LOCK"&&!c&&f>1&&(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new Event("trackuserlocationend")))})},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}}_updateCircleRadius(){if(this._watchState!=="BACKGROUND"&&this._watchState!=="ACTIVE_LOCK")return;const n=[this._lastKnownPosition.coords.longitude,this._lastKnownPosition.coords.latitude],s=this._map.project(n),c=this._map.unproject([s.x,s.y]),f=this._map.unproject([s.x+20,s.y]),x=c.distanceTo(f)/20,v=Math.ceil(2*this._accuracy/x);this._circleElement.style.width=`${v}px`,this._circleElement.style.height=`${v}px`}}var YT=e=>{throw TypeError(e)},bv=(e,n,s)=>n.has(e)||YT("Cannot "+s),Ot=(e,n,s)=>(bv(e,n,"read from private field"),s?s.call(e):n.get(e)),da=(e,n,s)=>n.has(e)?YT("Cannot add the same private member more than once"):n instanceof WeakSet?n.add(e):n.set(e,s),Ac=(e,n,s,c)=>(bv(e,n,"write to private field"),n.set(e,s),s),Oi=(e,n,s)=>(bv(e,n,"access private method"),s),Ni,rs,hl,JT,vl,no,Cf,ci,QT,io,eC;class Uy{constructor(n,s){da(this,ci),da(this,Ni),da(this,rs),da(this,hl),da(this,JT),da(this,vl),da(this,no,!1),da(this,Cf),n.style!==void 0&&Ac(this,no,!0),Ac(this,Ni,{zoomAdjust:-4,position:"top-right",...s,forceNoAttributionControl:!0,attributionControl:!1,navigationControl:!1,geolocateControl:!1,maptilerLogo:!1,minimap:!1,hash:!1,pitchAdjust:!1,...n,containerStyle:{border:"1px solid #000",width:"400px",height:"300px",...n.containerStyle??{}}}),n.lockZoom!==void 0&&(Ot(this,Ni).minZoom=n.lockZoom,Ot(this,Ni).maxZoom=n.lockZoom)}setStyle(n,s){Ot(this,no)||this.map.setStyle(n,s),Oi(this,ci,io).call(this)}addLayer(n,s){return Ot(this,no)||this.map.addLayer(n,s),Oi(this,ci,io).call(this),this.map}moveLayer(n,s){return Ot(this,no)||this.map.moveLayer(n,s),Oi(this,ci,io).call(this),this.map}removeLayer(n){return Ot(this,no)||this.map.removeLayer(n),Oi(this,ci,io).call(this),this}setLayerZoomRange(n,s,c){return Ot(this,no)||this.map.setLayerZoomRange(n,s,c),Oi(this,ci,io).call(this),this}setFilter(n,s,c){return Ot(this,no)||this.map.setFilter(n,s,c),Oi(this,ci,io).call(this),this}setPaintProperty(n,s,c,f){return Ot(this,no)||this.map.setPaintProperty(n,s,c,f),Oi(this,ci,io).call(this),this}setLayoutProperty(n,s,c,f){return Ot(this,no)||this.map.setLayoutProperty(n,s,c,f),Oi(this,ci,io).call(this),this}setGlyphs(n,s){return Ot(this,no)||this.map.setGlyphs(n,s),Oi(this,ci,io).call(this),this}onAdd(n){Ac(this,rs,n),Ac(this,hl,xa("div","maplibregl-ctrl maplibregl-ctrl-group"));for(const[s,c]of Object.entries(Ot(this,Ni).containerStyle))Ot(this,hl).style.setProperty(s,c);return Ot(this,Ni).container=Ot(this,hl),Ot(this,Ni).zoom=n.getZoom()+Ot(this,Ni).zoomAdjust,this.map=new tC(Ot(this,Ni)),this.map.once("style.load",()=>{this.map.resize()}),this.map.once("load",()=>{Oi(this,ci,QT).call(this,Ot(this,Ni).parentRect),Ac(this,Cf,Oi(this,ci,eC).call(this))}),Ot(this,hl)}onRemove(){var n;(n=Ot(this,Cf))==null||n.call(this),XT(Ot(this,hl))}}Ni=new WeakMap;rs=new WeakMap;hl=new WeakMap;JT=new WeakMap;vl=new WeakMap;no=new WeakMap;Cf=new WeakMap;ci=new WeakSet;QT=function(e){e===void 0||e.linePaint===void 0&&e.fillPaint===void 0||(Ac(this,vl,{type:"Feature",properties:{name:"parentRect"},geometry:{type:"Polygon",coordinates:[[[],[],[],[],[]]]}}),this.map.addSource("parentRect",{type:"geojson",data:Ot(this,vl)}),(e.lineLayout!==void 0||e.linePaint!==void 0)&&this.map.addLayer({id:"parentRectOutline",type:"line",source:"parentRect",layout:{...e.lineLayout},paint:{"line-color":"#FFF","line-width":1,"line-opacity":.85,...e.linePaint}}),e.fillPaint!==void 0&&this.map.addLayer({id:"parentRectFill",type:"fill",source:"parentRect",layout:{},paint:{"fill-color":"#08F","fill-opacity":.135,...e.fillPaint}}),Oi(this,ci,io).call(this))};io=function(){if(Ot(this,vl)===void 0)return;const{devicePixelRatio:e}=window,n=Ot(this,rs).getCanvas(),s=n.width/e,c=n.height/e,f=Ot(this,rs).unproject.bind(Ot(this,rs)),x=f([0,0]),v=f([s,0]),d=f([0,c]),L=f([s,c]);Ot(this,vl).geometry.coordinates=[[d.toArray(),L.toArray(),v.toArray(),x.toArray(),d.toArray()]],this.map.getSource("parentRect").setData(Ot(this,vl))};eC=function(){const{pitchAdjust:e}=Ot(this,Ni),n=()=>{x("parent")},s=()=>{x("minimap")},c=()=>{Ot(this,rs).on("move",n),this.map.on("move",s)},f=()=>{Ot(this,rs).off("move",n),this.map.off("move",s)},x=v=>{f();const d=v==="parent"?Ot(this,rs):this.map,L=v==="parent"?this.map:Ot(this,rs),U=d.getCenter(),Z=d.getZoom()+(Ot(this,Ni).zoomAdjust??-4)*(v==="parent"?1:-1),j=d.getBearing(),F=d.getPitch();L.jumpTo({center:U,zoom:Z,bearing:j,pitch:e?F:0}),Oi(this,ci,io).call(this),c()};return c(),()=>{f()}};const R3={POINT:"POINT",COUNTRY:"COUNTRY"};let tC=class extends Yt.Map{constructor(n){S3(n.container),n.apiKey&&(vi.apiKey=n.apiKey);const s=hw(n.style),c=location.hash;vi.apiKey||console.warn("MapTiler Cloud API key is not set. Visit https://maptiler.com and try Cloud for free!");let f={compact:!1};n.customAttribution?f.customAttribution=n.customAttribution:n.attributionControl&&typeof n.attributionControl=="object"&&(f={...f,...n.attributionControl}),super({...n,style:s,maplibreLogo:!1,transformRequest:cw(n.transformRequest),attributionControl:n.forceNoAttributionControl===!0?!1:f}),this.isTerrainEnabled=!1,this.terrainExaggeration=1,this.terrainGrowing=!1,this.terrainFlattening=!1,this.isReady=!1,vi.caching&&!Q_&&console.warn("The cache API is only available in secure contexts. More info at https://developer.mozilla.org/en-US/docs/Web/API/Cache"),vi.caching&&Q_&&v3(),this.primaryLanguage=n.language??vi.primaryLanguage,this.forceLanguageUpdate=!(this.primaryLanguage===Ut.STYLE||this.primaryLanguage===Ut.STYLE_LOCK),this.languageAlwaysBeenStyle=this.primaryLanguage===Ut.STYLE,this.terrainExaggeration=n.terrainExaggeration??this.terrainExaggeration,this.once("styledata",async()=>{if(!n.geolocate||n.center||n.hash&&c)return;try{if(n.geolocate===R3.COUNTRY){await this.fitToIpBounds();return}}catch(j){console.warn(j.message)}let U;try{await this.centerOnIpPoint(n.zoom),U=this.getCameraHash()}catch(j){console.warn(j.message)}(await navigator.permissions.query({name:"geolocation"})).state==="granted"&&navigator.geolocation.getCurrentPosition(j=>{U===this.getCameraHash()&&(this.terrain?this.easeTo({center:[j.coords.longitude,j.coords.latitude],zoom:n.zoom||12,duration:2e3}):this.once("terrain",()=>{this.easeTo({center:[j.coords.longitude,j.coords.latitude],zoom:n.zoom||12,duration:2e3})}))},null,{maximumAge:24*3600*1e3,timeout:5e3,enableHighAccuracy:!1})}),this.on("styledata",()=>{this.setPrimaryLanguage(this.primaryLanguage)}),this.on("styledata",()=>{this.getTerrain()===null&&this.isTerrainEnabled&&this.enableTerrain(this.terrainExaggeration)}),this.once("load",async()=>{let U={logo:null};try{const Z=Object.keys(this.style.sourceCaches).map(me=>this.getSource(me)).filter(me=>me&&"url"in me&&typeof me.url=="string"&&(me==null?void 0:me.url.includes("tiles.json"))),j=new URL(Z[0].url);j.searchParams.has("key")||j.searchParams.append("key",vi.apiKey),U=await(await fetch(j.href)).json()}catch{}if(n.forceNoAttributionControl!==!0)if("logo"in U&&U.logo){const Z=U.logo;this.addControl(new uw({logoURL:Z}),n.logoPosition)}else n.maptilerLogo&&this.addControl(new uw,n.logoPosition);if(n.scaleControl){const Z=n.scaleControl===!0||n.scaleControl===void 0?"bottom-right":n.scaleControl,j=new k3({unit:vi.unit});this.addControl(j,Z),vi.on("unit",F=>{j.setUnit(F)})}if(n.navigationControl!==!1){const Z=n.navigationControl===!0||n.navigationControl===void 0?"top-right":n.navigationControl;this.addControl(new M3,Z)}if(n.geolocateControl!==!1){const Z=n.geolocateControl===!0||n.geolocateControl===void 0?"top-right":n.geolocateControl;this.addControl(new L3({positionOptions:{enableHighAccuracy:!0,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!0,showAccuracyCircle:!0,showUserLocation:!0}),Z)}if(n.terrainControl){const Z=n.terrainControl===!0||n.terrainControl===void 0?"top-right":n.terrainControl;this.addControl(new P3,Z)}if(n.fullscreenControl){const Z=n.fullscreenControl===!0||n.fullscreenControl===void 0?"top-right":n.fullscreenControl;this.addControl(new A3({}),Z)}this.isReady=!0,this.fire("ready",{target:this})});let x=!1,v=!1,d;this.once("ready",()=>{x=!0,v&&this.fire("loadWithTerrain",d)}),this.once("style.load",()=>{const{minimap:U}=n;if(typeof U=="object"){const{zoom:Z,center:j,style:F,language:me,apiKey:ye,maptilerLogo:pe,antialias:je,refreshExpiredTiles:re,maxBounds:ee,scrollZoom:ae,minZoom:xe,maxZoom:Ee,boxZoom:Pe,locale:Ae,fadeDuration:Ke,crossSourceCollisions:vt,clickTolerance:ot,bounds:st,fitBoundsOptions:Ft,pixelRatio:Et,validateStyle:zt}=n;this.minimap=new Uy(U,{zoom:Z,center:j,style:F,language:me,apiKey:ye,container:"null",maptilerLogo:pe,antialias:je,refreshExpiredTiles:re,maxBounds:ee,scrollZoom:ae,minZoom:xe,maxZoom:Ee,boxZoom:Pe,locale:Ae,fadeDuration:Ke,crossSourceCollisions:vt,clickTolerance:ot,bounds:st,fitBoundsOptions:Ft,pixelRatio:Et,validateStyle:zt}),this.addControl(this.minimap,U.position??"bottom-left")}else U===!0?(this.minimap=new Uy({},n),this.addControl(this.minimap,"bottom-left")):U!==void 0&&U!==!1&&(this.minimap=new Uy({},n),this.addControl(this.minimap,U))});const L=U=>{U.terrain&&(v=!0,d={type:"loadWithTerrain",target:this,terrain:U.terrain},this.off("terrain",L),x&&this.fire("loadWithTerrain",d))};this.on("terrain",L),n.terrain&&this.enableTerrain(n.terrainExaggeration??this.terrainExaggeration)}async onLoadAsync(){return new Promise(n=>{if(this.loaded())return n(this);this.once("load",()=>{n(this)})})}async onReadyAsync(){return new Promise(n=>{if(this.isReady)return n(this);this.once("ready",()=>{n(this)})})}async onLoadWithTerrainAsync(){return new Promise(n=>{if(this.isReady&&this.terrain)return n(this);this.once("loadWithTerrain",()=>{n(this)})})}setStyle(n,s){var c;return(c=this.minimap)==null||c.setStyle(n),this.forceLanguageUpdate=!0,this.once("idle",()=>{this.forceLanguageUpdate=!1}),super.setStyle(hw(n),s)}addLayer(n,s){var c;return(c=this.minimap)==null||c.addLayer(n,s),super.addLayer(n,s)}moveLayer(n,s){var c;return(c=this.minimap)==null||c.moveLayer(n,s),super.moveLayer(n,s)}removeLayer(n){var s;return(s=this.minimap)==null||s.removeLayer(n),super.removeLayer(n)}setLayerZoomRange(n,s,c){var f;return(f=this.minimap)==null||f.setLayerZoomRange(n,s,c),super.setLayerZoomRange(n,s,c)}setFilter(n,s,c){var f;return(f=this.minimap)==null||f.setFilter(n,s,c),super.setFilter(n,s,c)}setPaintProperty(n,s,c,f){var x;return(x=this.minimap)==null||x.setPaintProperty(n,s,c,f),super.setPaintProperty(n,s,c,f)}setLayoutProperty(n,s,c,f){var x;return(x=this.minimap)==null||x.setLayoutProperty(n,s,c,f),super.setLayoutProperty(n,s,c,f)}setGlyphs(n,s){var c;return(c=this.minimap)==null||c.setGlyphs(n,s),super.setGlyphs(n,s)}getStyleLanguage(){return!this.style.stylesheet.metadata||typeof this.style.stylesheet.metadata!="object"?null:"maptiler:language"in this.style.stylesheet.metadata&&typeof this.style.stylesheet.metadata["maptiler:language"]=="string"?this.style.stylesheet.metadata["maptiler:language"]:null}setLanguage(n){var s,c;(c=(s=this.minimap)==null?void 0:s.map)==null||c.setLanguage(n),this.onStyleReady(()=>{this.setPrimaryLanguage(n)})}setPrimaryLanguage(n){const s=this.getStyleLanguage();if(!(n===Ut.STYLE&&(s===Ut.AUTO||s===Ut.VISITOR))&&(n!==Ut.STYLE&&(this.languageAlwaysBeenStyle=!1),this.languageAlwaysBeenStyle||this.primaryLanguage===n&&!this.forceLanguageUpdate))return;if(!ow(n)){console.warn(`The language "${n}" is not supported.`);return}if(this.primaryLanguage===Ut.STYLE_LOCK){console.warn("The language cannot be changed because this map has been instantiated with the STYLE_LOCK language flag.");return}this.primaryLanguage=n;let c=n;if(n===Ut.STYLE){if(!s){console.warn("The style has no default languages.");return}if(!ow(s)){console.warn("The language defined in the style is not valid.");return}c=s}let f=Ut.LOCAL,x=`{${f}}`;c===Ut.VISITOR?(f=sw(),x=["case",["all",["has",f],["has",Ut.LOCAL]],["case",["==",["get",f],["get",Ut.LOCAL]],["get",Ut.LOCAL],["format",["get",f],{"font-scale":.8},`
`,["get",Ut.LOCAL],{"font-scale":1.1}]],["get",Ut.LOCAL]]):c===Ut.VISITOR_ENGLISH?(f=Ut.ENGLISH,x=["case",["all",["has",f],["has",Ut.LOCAL]],["case",["==",["get",f],["get",Ut.LOCAL]],["get",Ut.LOCAL],["format",["get",f],{"font-scale":.8},`
`,["get",Ut.LOCAL],{"font-scale":1.1}]],["get",Ut.LOCAL]]):c===Ut.AUTO?(f=sw(),x=["case",["has",f],["get",f],["get",Ut.LOCAL]]):c===Ut.LOCAL?(f=Ut.LOCAL,x=`{${f}}`):(f=c,x=["case",["has",f],["get",f],["get",Ut.LOCAL]]);const{layers:v}=this.getStyle();for(const d of v){if(d.type!=="symbol")continue;const L=d,U=this.getSource(L.source);if(!U||!("url"in U&&typeof U.url=="string")||new URL(U.url).host!==xi.maptilerApiHost)continue;const{id:j,layout:F}=L;if(!F||!("text-field"in F))continue;const me=this.getLayoutProperty(j,"text-field");typeof me=="string"&&(me.toLowerCase().includes("ref")||me.toLowerCase().includes("housenumber"))||this.setLayoutProperty(j,"text-field",x)}}getPrimaryLanguage(){return this.primaryLanguage}getTerrainExaggeration(){return this.terrainExaggeration}hasTerrain(){return this.isTerrainEnabled}growTerrain(n,s=1e3){if(!this.terrain)return;const c=performance.now(),f=this.terrain.exaggeration,x=n-f,v=()=>{if(!this.terrain||this.terrainFlattening)return;const d=(performance.now()-c)/s;if(d<.99){const L=1-(1-d)**4,U=f+L*x;this.terrain.exaggeration=U,requestAnimationFrame(v)}else this.terrainGrowing=!1,this.terrainFlattening=!1,this.terrain.exaggeration=n;this.triggerRepaint()};this.terrainGrowing=!0,this.terrainFlattening=!1,requestAnimationFrame(v)}enableTerrain(n=this.terrainExaggeration){if(n<0){console.warn("Terrain exaggeration cannot be negative.");return}const s=async f=>{!this.terrain||f.type!=="data"||f.dataType!=="source"||!("source"in f)||f.sourceId!=="maptiler-terrain"||f.source.type!=="raster-dem"||f.isSourceLoaded&&(this.off("data",s),this.growTerrain(n))},c=()=>{this.isTerrainEnabled=!0,this.terrainExaggeration=n,this.on("data",s),this.addSource(xi.terrainSourceId,{type:"raster-dem",url:xi.terrainSourceURL}),this.setTerrain({source:xi.terrainSourceId,exaggeration:0})};if(this.getTerrain()){this.isTerrainEnabled=!0,this.growTerrain(n);return}this.loaded()||this.isTerrainEnabled?c():this.once("load",()=>{this.getTerrain()&&this.getSource(xi.terrainSourceId)||c()})}disableTerrain(){if(!this.terrain)return;this.isTerrainEnabled=!1;const n=1*1e3,s=performance.now(),c=this.terrain.exaggeration,f=()=>{if(!this.terrain||this.terrainGrowing)return;const x=(performance.now()-s)/n;if(x<.99){const v=(1-x)**4,d=c*v;this.terrain.exaggeration=d,requestAnimationFrame(f)}else this.terrain.exaggeration=0,this.terrainGrowing=!1,this.terrainFlattening=!1,this.setTerrain(),this.getSource(xi.terrainSourceId)&&this.removeSource(xi.terrainSourceId);this.triggerRepaint()};this.terrainGrowing=!1,this.terrainFlattening=!0,requestAnimationFrame(f)}setTerrainExaggeration(n,s=!0){!s&&this.terrain?(this.terrainExaggeration=n,this.terrain.exaggeration=n,this.triggerRepaint()):this.enableTerrain(n)}onStyleReady(n){this.isStyleLoaded()?n():this.once("styledata",()=>{n()})}async fitToIpBounds(){const n=await Jb.info();this.fitBounds(n.country_bounds,{duration:0,padding:100})}async centerOnIpPoint(n){const s=await Jb.info();this.jumpTo({center:[(s==null?void 0:s.longitude)??0,(s==null?void 0:s.latitude)??0],zoom:n||11})}getCameraHash(){const n=new Float32Array(5),s=this.getCenter();return n[0]=s.lng,n[1]=s.lat,n[2]=this.getZoom(),n[3]=this.getPitch(),n[4]=this.getBearing(),u3.fromUint8Array(new Uint8Array(n.buffer))}getSdkConfig(){return vi}getMaptilerSessionId(){return ZT}setTransformRequest(n){return super.setTransformRequest(cw(n)),this}};function of(e){const n=e.toString(16);return n.length===1?`0${n}`:n}function D3(e){return`#${of(e[0])}${of(e[1])}${of(e[2])}${e.length===4?of(e[3]):""}`}class pt extends Array{constructor(n={}){super(),this.min=0,this.max=1,"min"in n&&(this.min=n.min),"max"in n&&(this.max=n.max),"stops"in n&&this.setStops(n.stops,{clone:!1})}static fromArrayDefinition(n){return new pt({stops:n.map(s=>({value:s[0],color:s[1]}))})}setStops(n,s={clone:!0}){const c=s.clone?this.clone():this;c.length=0;let f=Number.POSITIVE_INFINITY,x=Number.NEGATIVE_INFINITY;for(let v=0;v<n.length;v+=1)f=Math.min(f,n[v].value),x=Math.max(x,n[v].value),c.push({value:n[v].value,color:n[v].color.slice()});return c.sort((v,d)=>v.value<d.value?-1:1),this.min=f,this.max=x,c}scale(n,s,c={clone:!0}){const f=c.clone,x=this[0].value,d=this.at(-1).value-x,L=s-n,U=[];for(let Z=0;Z<this.length;Z+=1){const me=(this[Z].value-x)/d*L+n;f?U.push({value:me,color:this[Z].color.slice()}):this[Z].value=me}return f?new pt({stops:U}):this}at(n){return n<0?this[this.length+n]:this[n]}clone(){return new pt({stops:this.getRawColorStops()})}getRawColorStops(){const n=[];for(let s=0;s<this.length;s+=1)n.push({value:this[s].value,color:this[s].color});return n}reverse(n={clone:!0}){const s=n.clone?this.clone():this;for(let c=0;c<~~(s.length/2);c+=1){const f=s[c].color;s[c].color=s.at(-(c+1)).color,s.at(-(c+1)).color=f}return s}getBounds(){return{min:this.min,max:this.max}}getColor(n,s={smooth:!0}){if(n<=this[0].value)return this[0].color;if(n>=this.at(-1).value)return this.at(-1).color;for(let c=0;c<this.length-1;c+=1){if(n>this[c+1].value)continue;const f=this[c].color;if(!s.smooth)return f.slice();const x=this[c].value,v=this[c+1].value,d=this[c+1].color,L=(v-n)/(v-x);return f.map((U,Z)=>Math.round(U*L+d[Z]*(1-L)))}return[0,0,0]}getColorHex(n,s={smooth:!0,withAlpha:!1}){return D3(this.getColor(n,s))}getColorRelative(n,s={smooth:!0}){const c=this.getBounds();return this.getColor(c.min+n*(c.max-c.min),s)}getCanvasStrip(n={horizontal:!0,size:512,smooth:!0}){const s=document.createElement("canvas");s.width=n.horizontal?n.size:1,s.height=n.horizontal?1:n.size;const c=s.getContext("2d");if(!c)throw new Error("Canvs context is missing");const f=c.getImageData(0,0,s.width,s.height),x=f.data,v=n.size,d=this[0].value,Z=(this.at(-1).value-d)/v;for(let j=0;j<v;j+=1){const F=this.getColor(d+j*Z,{smooth:n.smooth});x[j*4]=F[0],x[j*4+1]=F[1],x[j*4+2]=F[2],x[j*4+3]=F.length>3?F[3]:255}return c.putImageData(f,0,0),s}resample(n,s=15){const c=this.getBounds(),f=this.scale(0,1),x=1/(s-1);let v;if(n==="ease-in-square")v=Array.from({length:s},(U,Z)=>{const j=Z*x,F=j**2,me=f.getColor(F);return{value:j,color:me}});else if(n==="ease-out-square")v=Array.from({length:s},(U,Z)=>{const j=Z*x,F=1-(1-j)**2,me=f.getColor(F);return{value:j,color:me}});else if(n==="ease-out-sqrt")v=Array.from({length:s},(U,Z)=>{const j=Z*x,F=j**.5,me=f.getColor(F);return{value:j,color:me}});else if(n==="ease-in-sqrt")v=Array.from({length:s},(U,Z)=>{const j=Z*x,F=1-(1-j)**.5,me=f.getColor(F);return{value:j,color:me}});else if(n==="ease-out-exp")v=Array.from({length:s},(U,Z)=>{const j=Z*x,F=1-2**(-10*j),me=f.getColor(F);return{value:j,color:me}});else if(n==="ease-in-exp")v=Array.from({length:s},(U,Z)=>{const j=Z*x,F=2**(10*j-10),me=f.getColor(F);return{value:j,color:me}});else throw new Error("Invalid ressampling method.");return new pt({stops:v}).scale(c.min,c.max)}transparentStart(){const n=this.getRawColorStops();n.unshift({value:n[0].value,color:n[0].color.slice()}),n[1].value+=.001;for(const s of n)s.color.length===3&&s.color.push(255);return n[0].color[3]=0,new pt({stops:n})}hasTransparentStart(){return this[0].color.length===4&&this[0].color[3]===0}}new pt({stops:[{value:0,color:[0,0,0,0]},{value:1,color:[0,0,0,0]}]}),new pt({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),new pt({stops:[{value:0,color:[0,0,131]},{value:.125,color:[0,60,170]},{value:.375,color:[5,255,255]},{value:.625,color:[255,255,0]},{value:.875,color:[250,0,0]},{value:1,color:[128,0,0]}]}),new pt({stops:[{value:0,color:[255,0,0]},{value:.169,color:[253,255,2]},{value:.173,color:[247,255,2]},{value:.337,color:[0,252,4]},{value:.341,color:[0,252,10]},{value:.506,color:[1,249,255]},{value:.671,color:[2,0,253]},{value:.675,color:[8,0,253]},{value:.839,color:[255,0,251]},{value:.843,color:[255,0,245]},{value:1,color:[255,0,6]}]}),new pt({stops:[{value:0,color:[0,0,0]},{value:.3,color:[230,0,0]},{value:.6,color:[255,210,0]},{value:1,color:[255,255,255]}]}),new pt({stops:[{value:0,color:[255,0,255]},{value:1,color:[255,255,0]}]}),new pt({stops:[{value:0,color:[0,128,102]},{value:1,color:[255,255,102]}]}),new pt({stops:[{value:0,color:[255,0,0]},{value:1,color:[255,255,0]}]}),new pt({stops:[{value:0,color:[0,0,255]},{value:1,color:[0,255,128]}]}),new pt({stops:[{value:0,color:[0,0,0]},{value:.376,color:[84,84,116]},{value:.753,color:[169,200,200]},{value:1,color:[255,255,255]}]}),new pt({stops:[{value:0,color:[0,0,0]},{value:.804,color:[255,160,102]},{value:1,color:[255,199,127]}]}),new pt({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),new pt({stops:[{value:0,color:[8,29,88]},{value:.125,color:[37,52,148]},{value:.25,color:[34,94,168]},{value:.375,color:[29,145,192]},{value:.5,color:[65,182,196]},{value:.625,color:[127,205,187]},{value:.75,color:[199,233,180]},{value:.875,color:[237,248,217]},{value:1,color:[255,255,217]}]}),new pt({stops:[{value:0,color:[0,68,27]},{value:.125,color:[0,109,44]},{value:.25,color:[35,139,69]},{value:.375,color:[65,171,93]},{value:.5,color:[116,196,118]},{value:.625,color:[161,217,155]},{value:.75,color:[199,233,192]},{value:.875,color:[229,245,224]},{value:1,color:[247,252,245]}]}),new pt({stops:[{value:0,color:[128,0,38]},{value:.125,color:[189,0,38]},{value:.25,color:[227,26,28]},{value:.375,color:[252,78,42]},{value:.5,color:[253,141,60]},{value:.625,color:[254,178,76]},{value:.75,color:[254,217,118]},{value:.875,color:[255,237,160]},{value:1,color:[255,255,204]}]}),new pt({stops:[{value:0,color:[0,0,255]},{value:1,color:[255,0,0]}]}),new pt({stops:[{value:0,color:[5,10,172]},{value:.35,color:[106,137,247]},{value:.5,color:[190,190,190]},{value:.6,color:[220,170,132]},{value:.7,color:[230,145,90]},{value:1,color:[178,10,28]}]}),new pt({stops:[{value:0,color:[0,0,255]},{value:.1,color:[51,153,255]},{value:.2,color:[102,204,255]},{value:.3,color:[153,204,255]},{value:.4,color:[204,204,255]},{value:.5,color:[255,255,255]},{value:.6,color:[255,204,255]},{value:.7,color:[255,153,255]},{value:.8,color:[255,102,204]},{value:.9,color:[255,102,102]},{value:1,color:[255,0,0]}]}),new pt({stops:[{value:0,color:[150,0,90]},{value:.125,color:[0,0,200]},{value:.25,color:[0,25,255]},{value:.375,color:[0,152,255]},{value:.5,color:[44,255,150]},{value:.625,color:[151,255,0]},{value:.75,color:[255,234,0]},{value:.875,color:[255,111,0]},{value:1,color:[255,0,0]}]}),new pt({stops:[{value:0,color:[12,51,131]},{value:.25,color:[10,136,186]},{value:.5,color:[242,211,56]},{value:.75,color:[242,143,56]},{value:1,color:[217,30,30]}]}),new pt({stops:[{value:0,color:[0,0,0]},{value:.2,color:[230,0,0]},{value:.4,color:[230,210,0]},{value:.7,color:[255,255,255]},{value:1,color:[160,200,255]}]}),new pt({stops:[{value:0,color:[0,0,130]},{value:.1,color:[0,180,180]},{value:.2,color:[40,210,40]},{value:.4,color:[230,230,50]},{value:.6,color:[120,70,20]},{value:1,color:[255,255,255]}]}),new pt({stops:[{value:0,color:[0,0,0]},{value:.15,color:[30,0,100]},{value:.4,color:[120,0,100]},{value:.6,color:[160,90,0]},{value:.8,color:[230,200,0]},{value:1,color:[255,250,220]}]}),new pt({stops:[{value:0,color:[68,1,84]},{value:.13,color:[71,44,122]},{value:.25,color:[59,81,139]},{value:.38,color:[44,113,142]},{value:.5,color:[33,144,141]},{value:.63,color:[39,173,129]},{value:.75,color:[92,200,99]},{value:.88,color:[170,220,50]},{value:1,color:[253,231,37]}]}),new pt({stops:[{value:0,color:[0,0,4]},{value:.13,color:[31,12,72]},{value:.25,color:[85,15,109]},{value:.38,color:[136,34,106]},{value:.5,color:[186,54,85]},{value:.63,color:[227,89,51]},{value:.75,color:[249,140,10]},{value:.88,color:[249,201,50]},{value:1,color:[252,255,164]}]}),new pt({stops:[{value:0,color:[0,0,4]},{value:.13,color:[28,16,68]},{value:.25,color:[79,18,123]},{value:.38,color:[129,37,129]},{value:.5,color:[181,54,122]},{value:.63,color:[229,80,100]},{value:.75,color:[251,135,97]},{value:.88,color:[254,194,135]},{value:1,color:[252,253,191]}]}),new pt({stops:[{value:0,color:[13,8,135]},{value:.13,color:[75,3,161]},{value:.25,color:[125,3,168]},{value:.38,color:[168,34,150]},{value:.5,color:[203,70,121]},{value:.63,color:[229,107,93]},{value:.75,color:[248,148,65]},{value:.88,color:[253,195,40]},{value:1,color:[240,249,33]}]}),new pt({stops:[{value:0,color:[125,0,179]},{value:.13,color:[172,0,187]},{value:.25,color:[219,0,170]},{value:.38,color:[255,0,130]},{value:.5,color:[255,63,74]},{value:.63,color:[255,123,0]},{value:.75,color:[234,176,0]},{value:.88,color:[190,228,0]},{value:1,color:[147,255,0]}]}),new pt({stops:[{value:0,color:[125,0,179]},{value:.13,color:[116,0,218]},{value:.25,color:[98,74,237]},{value:.38,color:[68,146,231]},{value:.5,color:[0,204,197]},{value:.63,color:[0,247,146]},{value:.75,color:[0,255,88]},{value:.88,color:[40,255,8]},{value:1,color:[147,255,0]}]}),new pt({stops:[{value:0,color:[125,0,179]},{value:.1,color:[199,0,180]},{value:.2,color:[255,0,121]},{value:.3,color:[255,108,0]},{value:.4,color:[222,194,0]},{value:.5,color:[150,255,0]},{value:.6,color:[0,255,55]},{value:.7,color:[0,246,150]},{value:.8,color:[50,167,222]},{value:.9,color:[103,51,235]},{value:1,color:[124,0,186]}]}),new pt({stops:[{value:0,color:[40,26,44]},{value:.13,color:[59,49,90]},{value:.25,color:[64,76,139]},{value:.38,color:[63,110,151]},{value:.5,color:[72,142,158]},{value:.63,color:[85,174,163]},{value:.75,color:[120,206,163]},{value:.88,color:[187,230,172]},{value:1,color:[253,254,204]}]}),new pt({stops:[{value:0,color:[47,15,62]},{value:.13,color:[87,23,86]},{value:.25,color:[130,28,99]},{value:.38,color:[171,41,96]},{value:.5,color:[206,67,86]},{value:.63,color:[230,106,84]},{value:.75,color:[242,149,103]},{value:.88,color:[249,193,135]},{value:1,color:[254,237,176]}]}),new pt({stops:[{value:0,color:[18,36,20]},{value:.13,color:[25,63,41]},{value:.25,color:[24,91,59]},{value:.38,color:[13,119,72]},{value:.5,color:[18,148,80]},{value:.63,color:[80,173,89]},{value:.75,color:[132,196,122]},{value:.88,color:[175,221,162]},{value:1,color:[215,249,208]}]}),new pt({stops:[{value:0,color:[54,14,36]},{value:.13,color:[89,23,80]},{value:.25,color:[110,45,132]},{value:.38,color:[120,77,178]},{value:.5,color:[120,113,213]},{value:.63,color:[115,151,228]},{value:.75,color:[134,185,227]},{value:.88,color:[177,214,227]},{value:1,color:[230,241,241]}]}),new pt({stops:[{value:0,color:[30,4,110]},{value:.13,color:[47,14,176]},{value:.25,color:[41,45,236]},{value:.38,color:[25,99,212]},{value:.5,color:[68,131,200]},{value:.63,color:[114,156,197]},{value:.75,color:[157,181,203]},{value:.88,color:[200,208,216]},{value:1,color:[241,237,236]}]}),new pt({stops:[{value:0,color:[60,9,18]},{value:.13,color:[100,17,27]},{value:.25,color:[142,20,29]},{value:.38,color:[177,43,27]},{value:.5,color:[192,87,63]},{value:.63,color:[205,125,105]},{value:.75,color:[216,162,148]},{value:.88,color:[227,199,193]},{value:1,color:[241,237,236]}]}),new pt({stops:[{value:0,color:[64,5,5]},{value:.13,color:[106,6,15]},{value:.25,color:[144,26,7]},{value:.38,color:[168,64,3]},{value:.5,color:[188,100,4]},{value:.63,color:[206,136,11]},{value:.75,color:[220,174,25]},{value:.88,color:[231,215,44]},{value:1,color:[248,254,105]}]}),new pt({stops:[{value:0,color:[51,20,24]},{value:.13,color:[90,32,35]},{value:.25,color:[129,44,34]},{value:.38,color:[159,68,25]},{value:.5,color:[182,99,19]},{value:.63,color:[199,134,22]},{value:.75,color:[212,171,35]},{value:.88,color:[221,210,54]},{value:1,color:[225,253,75]}]}),new pt({stops:[{value:0,color:[145,105,18]},{value:.13,color:[184,71,38]},{value:.25,color:[186,58,115]},{value:.38,color:[160,71,185]},{value:.5,color:[110,97,218]},{value:.63,color:[50,123,164]},{value:.75,color:[31,131,110]},{value:.88,color:[77,129,34]},{value:1,color:[145,105,18]}]}),new pt({stops:[{value:0,color:[42,24,108]},{value:.13,color:[33,50,162]},{value:.25,color:[15,90,145]},{value:.38,color:[40,118,137]},{value:.5,color:[59,146,135]},{value:.63,color:[79,175,126]},{value:.75,color:[120,203,104]},{value:.88,color:[193,221,100]},{value:1,color:[253,239,154]}]}),new pt({stops:[{value:0,color:[4,35,51]},{value:.13,color:[23,51,122]},{value:.25,color:[85,59,157]},{value:.38,color:[129,79,143]},{value:.5,color:[175,95,130]},{value:.63,color:[222,112,101]},{value:.75,color:[249,146,66]},{value:.88,color:[249,196,65]},{value:1,color:[232,250,91]}]}),new pt({stops:[{value:0,color:[34,31,27]},{value:.13,color:[65,50,41]},{value:.25,color:[98,69,52]},{value:.38,color:[131,89,57]},{value:.5,color:[161,112,59]},{value:.63,color:[185,140,66]},{value:.75,color:[202,174,88]},{value:.88,color:[216,209,126]},{value:1,color:[233,246,171]}]}),new pt({stops:[{value:0,color:[17,32,64]},{value:.13,color:[35,52,116]},{value:.25,color:[29,81,156]},{value:.38,color:[31,113,162]},{value:.5,color:[50,144,169]},{value:.63,color:[87,173,176]},{value:.75,color:[149,196,189]},{value:.88,color:[203,221,211]},{value:1,color:[254,251,230]}]}),new pt({stops:[{value:0,color:[23,35,19]},{value:.13,color:[24,64,38]},{value:.25,color:[11,95,45]},{value:.38,color:[39,123,35]},{value:.5,color:[95,146,12]},{value:.63,color:[152,165,18]},{value:.75,color:[201,186,69]},{value:.88,color:[233,216,137]},{value:1,color:[255,253,205]}]}),new pt({stops:[{value:0,color:[0,0,0]},{value:.07,color:[22,5,59]},{value:.13,color:[60,4,105]},{value:.2,color:[109,1,135]},{value:.27,color:[161,0,147]},{value:.33,color:[210,2,142]},{value:.4,color:[251,11,123]},{value:.47,color:[255,29,97]},{value:.53,color:[255,54,69]},{value:.6,color:[255,85,46]},{value:.67,color:[255,120,34]},{value:.73,color:[255,157,37]},{value:.8,color:[241,191,57]},{value:.87,color:[224,220,93]},{value:.93,color:[218,241,142]},{value:1,color:[227,253,198]}]}),new pt({stops:[{value:0,color:[0,32,77,255]},{value:.125,color:[5,54,110,255]},{value:.25,color:[65,77,108,255]},{value:.375,color:[97,100,111,255]},{value:.5,color:[125,124,121,255]},{value:.625,color:[156,149,120,255]},{value:.75,color:[190,175,111,255]},{value:.875,color:[225,204,94,255]},{value:1,color:[255,235,70,255]}]}),new pt({stops:[{value:0,color:[48,18,59,255]},{value:.125,color:[70,107,227,255]},{value:.25,color:[40,187,236,255]},{value:.375,color:[49,242,153,255]},{value:.5,color:[162,252,60,255]},{value:.625,color:[237,208,58,255]},{value:.75,color:[251,128,34,255]},{value:.875,color:[210,49,5,255]},{value:1,color:[122,4,3,255]}]}),new pt({stops:[{value:0,color:[250,235,221,0]},{value:.133,color:[250,235,221,255]},{value:.266,color:[246,170,130,255]},{value:.4,color:[240,96,67,255]},{value:.533,color:[203,27,79,255]},{value:.666,color:[132,30,90,255]},{value:.8,color:[63,27,68,255]},{value:1,color:[3,5,26,255]}]}),new pt({stops:[{value:0,color:[11,4,5,255]},{value:.125,color:[43,28,53,255]},{value:.25,color:[62,53,107,255]},{value:.375,color:[59,86,152,255]},{value:.5,color:[53,123,162,255]},{value:.625,color:[53,158,170,255]},{value:.75,color:[73,193,173,255]},{value:.875,color:[150,221,181,255]},{value:1,color:[222,245,229,255]}]});x3();const B3={MAPTILER_API_KEY:"qC6zBtR7VUaKtyyiLcJq"},F3=Ns("MuiBox",["root"]),O3=pT(),N3=zz({themeId:fT,defaultTheme:O3,defaultClassName:F3.root,generateClassName:hv.generate});function $3(){const e=Ge.useRef(null),n=Ge.useRef(null),s={lng:139.753,lat:35.6844},[c]=Ge.useState(14);return vi.apiKey=B3.MAPTILER_API_KEY,Ge.useEffect(()=>{n.current||(n.current=new tC({container:e.current,style:RT.STREETS,center:[s.lng,s.lat],zoom:c}),new T3({color:"#FF0000"}).setLngLat([139.7525,35.6846]).addTo(n.current))},[s.lng,s.lat,c]),qt.jsxs(N3,{sx:{display:"flex"},children:[qt.jsx(zL,{}),qt.jsx("div",{className:"container",children:qt.jsx("div",{ref:e,id:"map",className:"map"})})]})}function U3(){return qt.jsx("div",{className:"App",children:qt.jsx($3,{})})}Vy.createRoot(document.getElementById("root")).render(qt.jsx(dl.StrictMode,{children:qt.jsx(U3,{})}));
